<!-- $Id: ch16.sgm,v 1.11 2002/11/03 10:17:42 jjamor Exp $ -->
<!--
Nota legal:

   Linux Network Administration Guide, por Olaf Kirch et al.

   La traducción al español se publica bajo la licencia GFDL,
siendo texto de portada el siguiente:

Linux Network Administrator's Guide
by Olaf Kirch and Terry Dawson
Copyright  (c) 1993 Olaf Kirch
Copyright  (c) 2000 Terry Dawson
Copyright on O'Reilly printed version (c) 2000 O'Reilly & Associates

y siendo secciones invariantes, la sección de Agradecimientos,
la sección titulada «La traducción al español», el apéndice C; así
como esta nota.

Capítulo traducido por:

		Pedro Soria-Rodríguez, sorrodp@ece.wpi.edu
		
		Jose M. Fernández, elzo@iespana.es
Revisión 1 por Francisco Javier Fernandez serrador@arrakis.es
-->
<chapter id="X-087-2-uucp"><title>Administración de<?lb>Taylor UUCP</title>  
<indexterm id="idx-configuringUUCP-1" class="startofrange"><primary>configurar</primary><secondary>Taylor UUCP</secondary></indexterm>
<indexterm id="idx-UUCP-2" class="startofrange"><primary>Taylor UUCP</primary></indexterm>

<para>
UUCP fue diseñado a finales de los años setenta por Mike Lesk en los
laboratorios Bell de AT&amp;T con el objetivo de crear una simple red sobre
líneas de teléfonos para conectarse mediante llamadas telefónicas.  Dado
que la mayoría de la gente que quiere tener correo electrónico y
noticias de Usenet en sus ordenadores personales todavía se comunican
por módem, UUCP ha seguido siendo muy popular.  Aunque hay muchas
implementaciones funcionando en una gran variedad de plataformas
y sistemas operativos, todas son bastante compatibles.
</para>

<para>
Sin embargo, como con cualquier programa que se ha convertido en
&ldquo;estándar&rdquo; con el tiempo, no hay un UUCP que se pueda denominar
<emphasis>el</emphasis> UUCP.  Ha sufrido un continuo proceso de evolución 
desde la primera versión que fue implementada en 1976.  En la actualidad hay
dos especies principales que se diferencian principalmente en su
soporte del hardware y en su configuración.  A su vez, hay varias
implementaciones de estas dos clases, todas con ligeras diferencias
respecto a sus familiares.
</para>

<para>
Una de las clases es la llamada UUCP Versión 2, que es una
implementación de 1977 de Mike Lesk, David A. Novitz, y Greg Chesson.
Aunque es bastante antigua, todavía se usa frecuentemente.  Las
implementaciones más recientes de la Versión 2 ofrecen muchas de las
características de los tipos más nuevos de UUCP.
</para>

<para>
La segunda clase de UUCP se desarrolló en 1983, y se conoce comúnmente
como BNU (Utilidades Básicas de Red, Basic Network Utilities) o HoneyDanBer 
UUCP.  El último nombre deriva de los nombres de sus autores (P. Honeyman, 
D. A. Novitz, y B. E. Redman) y a menudo se abrevia en HDB, que es
el término que usaremos en este capítulo. HDB se creó para eliminar algunas 
deficiencias de la Versión 2. Por ejemplo, se añadieron nuevos protocolos de 
transferencia, y se dividió el directorio de cola de manera que ahora sólo
hay un directorio para cada ordenador con el que mantener tráfico UUCP.
</para>

<para>
<indexterm><primary>Taylor, Ian</primary></indexterm>
La implementación de UUCP que se distribuye con GNU Linux es Taylor
UUCP 1.06, versión en la que se está basado este capítulo.
<footnote id="X-087-2-FNUU01"><para>
Autoría y copyright de Ian Taylor, 1995.
</para>
</footnote>  La versión 1.06 de Taylor UUCP apareció en Agosto de 1995.
Aparte de los ficheros de configuración tradicionales, Taylor UUCP también
puede compilarse para entender los nuevos ficheros de configuración
&mdash;alias Taylor&mdash;.
</para>

<para>
Taylor UUCP se suele compilar con compatibilidad HDB, el esquema de 
configuración Taylor o ambos. Al ser el esquema de Taylor mucho más
flexible y probablemente más sencillo de entender que los ficheros de
configuración HDB a menudo bastante oscuros, describiremos más abajo
el esquema Taylor.
</para>

<para>
El propósito de este capítulo no es ofrecer una explicación exhaustiva
de las opciones de la línea de órdenes para las instrucciones de UUCP y lo
que hacen, sino darle una introducción sobre cómo poner en marcha
un nodo de UUCP.  La primera sección presenta una introducción
de cómo UUCP implementa ejecución remota y transmisión de ficheros.
Si usted tiene ya algunos conocimientos de UUCP, quizá desee saltarse esto y
continuar con la sección <xref linkend="X-087-2-uucp.config.files">&rdquo;, que 
explica los distintos ficheros usados para configurar UUCP.
</para>

<para>
Sin embargo, asumiremos que usted está familiarizado con los
programas de usuario del paquete UUCP.  Éstos son <command>uucp</command> y
<command>uux</command>. Si no los conoce suficientemente, consulte las
correspondientes páginas de manual.
</para>

<para>
<INDEXTERM><PRIMARY>uucico, orden</PRIMARY></INDEXTERM>
Aparte de los programas de usuario <command>uucp</command> y
<command>uux</command>, el paquete UUCP contiene algunas órdenes más
con fines únicamente administrativos. Se usan para monitorizar el tráfico
UUCP en su nodo, eliminar  ficheros antiguos de registro o crear estadísticas.
No describiremos ninguna de estas utilidades porque son periféricas a las
tareas principales de UUCP. Además, se encuentran bien documentadas y su
comprensión resulta bastante sencilla; acuda a las páginas del manual para
más información. De todos modos, hay una tercera categoría, que comprende
los &ldquo;motores&rdquo; del UUCP. Se las conoce como
<command>uucico</command> (donde <emphasis>cico</emphasis> significa copy-in
copy-out), y <command>uuxqt</command>, que ejecuta tareas enviadas desde
sistemas remotos. Nos concentraremos en estos dos importantes programas
en este capítulo.
</para>

<para>
Si no le satisface la manera en que cubriremos estos temas, debería leer
la documentación que viene con el paquete UUCP. Es un conjunto de ficheros
Texinfo en los que se describe la instalación usando el esquema de 
configuración Taylor. Puede convertir los ficheros Texinfo a un fichero
<command>dvi</command> con <command>texi2dvi</command> (que se encuentra
en el paquete Texinfo de su distribución) y visualizar el fichero <command>
dvi</command> por medio de la orden <command>xvi</command>.
</para>

<para>
<indexterm><primary>HOWTOs</primary><secondary>UUCP</secondary></indexterm>
El UUCP-HOWTO de Guylhem Aznar es otra buena fuente de información sobre
UUCP en un entorno GNU/Linux. Se encuentra disponibles en cualquier servidor
réplica del Linux Documentation Project y se envía con regularidad a
<systemitem role="newsgroup">comp.os.linux.answers</systemitem>.
</para>

<para>
<indexterm><primary>grupos de noticias</primary><secondary>comp.mail.uucp</secondary></indexterm> 
<INDEXTERM><PRIMARY>comp.mail.uucp</PRIMARY></INDEXTERM>
También hay un grupo de noticias para la discusión de UUCP llamado <systemitem
role="newsgroup">comp.mail.uucp</systemitem>. Si tiene preguntas específicas
sobre Taylor UUCP, será mejor que las haga allí en vez de en los grupos
<systemitem role="newsgroup">comp.os.linux.*</systemitem>.
</para>

<sect1 id="X-087-2-uucp.intro.grades"><title>Transferencias UUCP y ejecución remota</title>

<para>
<indexterm><primary>tareas (UUCP)</primary></indexterm> 
<INDEXTERM><PRIMARY>UUCP</PRIMARY><SECONDARY>tareas</SECONDARY></INDEXTERM>
<indexterm><primary>Taylor UUCP</primary><secondary>tarea</secondary></indexterm>
El concepto de tarea resulta vital para entender UUCP.
Cada transferencia que inicia un usuario con <command>uucp</command> o
<command>uux</command> se llama <command>tarea</command>. Consta de una orden
a ejecutar en un sistema remoto, una recopilación de ficheros a transferir
entre sitios o ambas cosas.
</para>

<para>
Por ejemplo, la siguiente orden hace que UUCP copie el fichero
<filename>netguide.ps</filename> a un sistema remoto llamado
<systemitem role="sitename">pablo</systemitem> y ejecute la orden
<command>lpr</command> en
<systemitem role="sitename">pablo</systemitem>
para imprimir el fichero:
</para>

<para>
<screen>
$ <userinput>uux -r pablo!lpr !netguide.ps</userinput>
</screen>
</para>

<para>
<indexterm><primary>directorio de cola</primary></indexterm> 
<indexterm><primary>encolar</primary></indexterm> 
<indexterm><primary>Taylor UUCP</primary><secondary>directorio de cola</secondary></indexterm>
Por lo general, UUCP no llama al sistema remoto de inmediato para llevar a
cabo una tarea (o cualquier otra cosa que pueda hacer con
<command>kermit</command>). En cambio, guarda la descripción de la tarea de
manera temporal. Esto se conoce como <emphasis>encolar</emphasis>. El árbol
de directorios bajo el que se guardan las tareas se llama por lo tanto
<emphasis>directorio de cola</emphasis> y se encuentra generalmente en
<filename>/var/spool/uucp</filename>. En nuestro ejemplo, la descripción de
la tarea contendría información sobre la orden remota a ejecutar
(<command>lpr</command>), el usuario que ordenó la ejecución y un par de
elementos más. Además de la descripción de la tarea, UUCP tiene que guardar
el fichero de entrada <filename>netguide.ps</filename>.
</para>

<para>
La localización y nomenclatura exactas de los ficheros de cola puede varias
dependiendo de algunas opciones en tiempo de compilación. Los UUCPs compatibles
con HDB guardan por lo general los ficheros de cola en el subdirectorio
<filename>/var/spool/uucp</filename> con el nombre del sistema remoto.
Cuando se compilan para la configuración Taylor, UUCP crea subdirectorios
bajo el directorio de cola específico del sitio para diferentes tipos de
ficheros de cola.
</para>

<para>
A intervalos regulares, UUCP llama al sistema remoto. Cuando se establece
una conexión con el sistema remoto, UUCP transfiere los ficheros en los que
se describe la tarea, además de los ficheros de entrada. Las tareas entrantes
no se ejecutarán de inmediato, sino sólo tras haber terminado la conexión.
La ejecución la gestion <command>uuxqt</command>, quien también se ocupa de
redirigir cualquier tarea designada a otro sitio.
</para>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>prioridades</secondary></indexterm>
<indexterm><primary>Taylor UUCP</primary><secondary>nivel de cola</secondary></indexterm>
<indexterm><primary>Taylor UUCP</primary><secondary>tareas</secondary></indexterm>
Para distinguir entre tareas más o menos importantes, UUCP asocia un
<emphasis>nivel</emphasis> a cada tarea. Se trata de un único dígito de 0 a 9,
de A a Z, y de a a z, en precedencia decreciente. El correo se suele colocar
en la cola con nivel B o C, mientras que las noticias se colocan con un nivel
N. Las tareas con niveles más altos se transfieren antes. Los niveles pueden
asignarse por medio de la opción <option>&ndash;g</option> al invocar a
<command>uucp</command> o <command>uux</command>.
</para>

<para>
También se puede prohibir la transferencia de trabajos bajo
un cierto nivel a horas determinadas.  Esto también se llama
<emphasis>máximo nivel de cola</emphasis> permitido durante una conversación
y el valor predeterminado es z.  Percátese de la ambigüedad
de esta terminología: un fichero se transfiere sólo si
es <emphasis>igual</emphasis> o <emphasis>mayor</emphasis> que el máximo nivel 
de cola.
</para>

<sect2 id="X-087-2-uucico.connect"><title>El funcionamiento interno de uucico</title>
<para>
<indexterm><primary>Taylor UUCP</primary><secondary>uucico</secondary></indexterm>
<indexterm><primary>uucico, orden</primary></indexterm> 
Para comprender por qué  <command>uucico</command> necesita saber ciertas
cosas, una rápida descripción de cómo se conecta realmente a un sistema remoto
resultará de ayuda.
</para>

<para>
<indexterm><primary>gethostbyname(&thinsp;)</primary><secondary>uucico y</secondary></indexterm> 
Cuando usted ejecuta <command>uucico -s <replaceable>sistema</replaceable>
</command> desde la línea de órdenes, primero tiene que conectarse físicamente.
Las acciones a tomar dependen del tipo de conexión a usar.  Por ejemplo, 
cuando se usa una línea telefónica, tiene que encontrar un módem, y marcar un 
número de teléfono.  Sobre TCP, tiene que llamar 
<function>gethostbyname(3)</function> para convertir el nombre a una dirección 
de red, averiguar qué puerto abrir, y conectar la dirección al puerto 
correspondiente.
</para>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>maestro</secondary></indexterm>
<indexterm><primary>Taylor UUCP</primary><secondary>esclavo</secondary></indexterm>
Una vez que se ha establecido la conexión, hay que pasar un proceso
de autorización.  Normalmente consiste en que el sistema remoto
pide un nombre de usuario y posiblemente una clave.  Esto se llama
el <emphasis>diálogo de entrada</emphasis>.  El proceso de autorización se lleva
a cabo mediante el usual <command>getty/login</command>, o en conexiones
TCP por el propio <command>uucico</command>.  Si la autorización es permitida,
la parte remota de la conexión ejecuta <command>uucico</command>. La copia 
local de <command>uucico</command> que inició la conexión se denomina 
<emphasis>maestro</emphasis>, y la copia remota se denomina <emphasis>esclavo</emphasis>.
</para>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>comprobación de la secuencia de llamada</secondary></indexterm>
<indexterm><primary>Taylor UUCP</primary><secondary>handshake</secondary></indexterm>
<indexterm><primary>Taylor UUCP</primary><secondary>protocolos</secondary></indexterm>
<indexterm><primary>comprobaciones de la secuencia de llamada</primary></indexterm> 
Ahora viene la <emphasis>fase de handshake</emphasis>&thinsp;: El maestro
envía su nombre, además de varias opciones.  El esclavo
comprueba el nombre para ver si tiene permiso para conectarse, para
enviar y recibir ficheros, etc.  Las opciones describen (entre otras cosas)
el nivel máximo de ficheros de cola que hay que transferir.  Si
esta opción está activada, tiene lugar una cuenta de conversación,
o <emphasis>comprobación de la secuencia de llamada</emphasis>.  Con esta 
característica, ambos ordenadores mantienen una cuenta de conexiones exitosas, 
que se comparan.  Si las cuentas no son iguales, la negociación de
protocolos no tendrá lugar. Esto es útil para protegerse de
impostores.
</para>

<para>
Finalmente los dos <command>uucico</command> tratan de ponerse de acuerdo en un
<emphasis>protocolo de transferencia</emphasis> común.  Este protocolo 
gobierna la manera en que los datos se transfieren, la manera en que se 
comprueba la consistencia de los datos, y la manera en que se retransmiten en
caso de error.  Hacen falta protocolos diferentes debido a los diferentes
tipos de conexiones que se soportan.  Por ejemplo, las líneas de teléfono
precisan un protocolo &ldquo;seguro&rdquo; que es pesimista respecto a errores,
mientras que una transmisión de TCP es fiable y puede usar un protocolo
más eficiente que carece de la mayoría de las comprobaciones de errores.
</para>

<para>
Una vez que las negociaciones se han completado, comienza la fase de la
verdadera transmisión.  Ambos extremos ponen en funcionamiento
el controlador del protocolo elegido.  Los controladores posiblemente
lleven a cabo alguna secuencia específica del protocolo para la
inicialización.
</para>

<para>
Primero el maestro envía todos los ficheros en la cola de este sistema
remoto cuyo nivel de cola es suficientemente alto.  Cuando ha finalizado,
informa al esclavo que ha terminado, y que el esclavo puede ahora colgar.
El esclavo puede entonces colgar, o tomar el control de la conversación.
Esto es un cambio de papeles: ahora el sistema remoto se convierte en
maestro y el local en esclavo.  El nuevo maestro envía ahora sus
ficheros.  Cuando ha terminado, ambos <command>uucico</command>&thinsp;s 
intercambian mensajes de terminación, y cierran la comunicación.
</para>

<para>
Si necesita información adicional sobre UUCP acuda al código fuente. También
hay un artículo bastante antiguo escrito por David A. Novitz pululando por la
red en el que se proporciona una descripción detallada del protocolo UUCP.
<footnote id="X-087-2-FNUU02"><para>
También se incluye en el <emphasis>Manual del Administrador de Sistemas</emphasis> 4.4BSD.
</para>
</footnote> En las PUF sobre Taylor UUCP también se discuten algunos detalles
de la implementación de UUCP. Se envía a 
<systemitem role="newsgroup">comp.mail.uucp</systemitem> con relativa
frecuencia.


</para>

</sect2>

<sect2><title>Opciones en la línea de órdenes para uucico</title>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>marcación de la llamada</secondary></indexterm>
<indexterm><primary>Taylor UUCP</primary><secondary>registro de actividad y resolución de problemas</secondary></indexterm>
<indexterm><primary>resolución de problemas</primary><secondary>configurar UUCP</secondary></indexterm>
<indexterm><primary>orden uucico</primary><secondary>opciones en la línea de órdenes</secondary></indexterm>
En esta sección describimos las opciones de la línea de órdenes más
importantes para
<command>uucico</command>&thinsp;:
</para>

<para>
<variablelist>

<varlistentry><term><option>&ndash; &ndash; system, &ndash;s <replaceable>sistema</replaceable></option></term>
<listitem><para>
Llama al <replaceable>sistema</replaceable> si no está prohibido por
restricciones en la hora de llamada.
</para>
</listitem>
</varlistentry>

<varlistentry><term><option>&ndash;S <replaceable>sistema</replaceable></option></term>
<listitem><para>
Llama al <replaceable>sistema</replaceable> sin condiciones.
</para>
</listitem>
</varlistentry>

<varlistentry><term><option>&ndash; &ndash;master, &ndash;r1</option></term>
<listitem><para>
Inicia <command>uucico</command> en modo maestro. Éste es el modo
predeterminado cuando se indica
<option>&ndash;s</option> o <option>&ndash;S</option>. Por sí misma,
la opción <option>&ndash;r1</option> provoca que  <command>uucico</command> intente
llamar a todos los sistemas en el fichero <filename>sys</filename> que se describe 
en la siguiente sección de este capítulo, a no ser que sea prohibido por las 
restricciones de la hora de llamada o las veces que se puede reintentar la misma.
</para>
</listitem>
</varlistentry>

<varlistentry><term><option>&ndash; &ndash;slave, &ndash;r0</option></term>
<listitem><para>
Inicia <command>uucico</command> en modo esclavo. Éste es el modo
predeterminado cuando no se indica <option>&ndash;s</option> ni 
<option>&ndash;S</option>. En modo esclavo, tanto la entrada como la salida
estándar se asume que están conectadas a un puerto serie, o al puerto TCP
especificado por la opción <option>&ndash;p</option> si se usa.
</para>
</listitem>
</varlistentry>

<varlistentry><term><option>&ndash; &ndash;ifwork, &ndash;C</option></term>
<listitem><para>
La opción suplementa <option>&ndash;s</option> o
<option>&ndash;S</option> y comunica a <command>uucico</command> que llame
al sistema mencionado sólo si hay tareas en la cola para él.
</para>
</listitem>
</varlistentry>

<varlistentry><term><option>&ndash; &ndash;debug <replaceable>tipo</replaceable>, &ndash;x <replaceable>tipo</replaceable></option>, <option>&ndash;X <replaceable>tipo</replaceable></option></term>
<listitem><para>
Activa la depuración del tipo especificado. Pueden proporcionarse muchos tipos
en forma de lista separada por comas. Los siguientes tipos son válidos.
<systemitem role="keyword">abnormal</systemitem>,
<systemitem role="keyword">chat</systemitem>,
<systemitem role="keyword">handshake</systemitem>,
<systemitem role="keyword">uucp-proto</systemitem>,
<systemitem role="keyword">proto</systemitem>,
<systemitem role="keyword">port</systemitem>,
<systemitem role="keyword">config</systemitem>,
<systemitem role="keyword">spooldir</systemitem>,
<systemitem role="keyword">execute</systemitem>,
<systemitem role="keyword">incoming</systemitem>, y
<systemitem role="keyword">outgoing</systemitem>.
Si usa <systemitem role="keyword">all</systemitem> activará todas las opciones.
Por compatibilidad con otras implementaciones de UUCP, también puede
especificar un número, que activará la depuración para los primeros
<replaceable>n</replaceable> elementos de la lista anterior.
</para>

<para>
Los mensajes de depuración se registrarán en el fichero
<filename>Debug</filename> bajo <filename>/var/spool/uucp</filename>.
</para>

</listitem>
</varlistentry>

</variablelist>
</para>

</sect2>

</sect1>

<sect1 id="X-087-2-uucp.config.files"><title>Ficheros de configuración de UUCP</title>

<para>
<indexterm id="chuu.config.files.uucp" class="startofrange"><primary>ficheros de configuración</primary><secondary>UUCP</secondary></indexterm>
<indexterm id="idx-UUCPconfigurationfiles-1" class="startofrange"><primary>Taylor UUCP</primary><secondary>ficheros de configuración</secondary></indexterm>
Al contrario que programas de transferencia de ficheros más simples,
UUCP fue diseñado para ser capaz de llevar a cabo todas las
tranferencias automáticamente.  Una vez que está correctamente
configurado, no es necesaria una constante participación del
administrador.  La información necesaria para esto se guarda en
un par de ficheros de configuración que residen en el directorio
<filename>/usr/lib/uucp</filename>.  La mayoría de estos ficheros se usan sólo 
para conectarse a otro ordenador.
</para>

<sect2><title>Una ligera introducción a Taylor UUCP</title>

<para>
Decir que la configuración de UUCP es difícil sería una descripción
insuficiente.  Es cierto que es un asunto peliagudo, y el formato
a veces demasiado conciso de los ficheros de configuración no hace
las cosas más fáciles (aunque el formato de Taylor es casi fácil
de leer comparado con los formatos más antiguos en HDB o Versión 2).
</para>

<para>
Para darle una idea de cómo se interactúa con estos ficheros, le
introduciremos
los más importantes, y echaremos un vistazo a algunos ejemplos.  No
explicaremos ahora todo en detalle; una explicación más precisa se
describe en secciones posteriores.  Si quiere configurar su
ordenador para UUCP, puede comenzar con los ficheros de ejemplo, y
adaptarlos gradualmente.  Puede elegir los que se muestran a continuación,
o los que se incluyen en su distribución de Linux preferida.
</para>

<para>
Todos los ficheros descritos en esta sección se guardan en
<filename>/etc/uucp</filename> o en un subdirectorio de éste. Algunas 
distribuciones de Linux contienen binarios de UUCP con soporte tanto para
la configuración HDB como Taylor activado, y emplean diferentes subdirectorios
para cada grupo de ficheros de configuración. Seguramente habrá un fichero
<filename>README</filename> en <filename>/usr/lib/uucp</filename>.
</para>

<para>
Para que UUCP funcione correctamente, estos ficheros tienen que
pertenecer al usuario <systemitem role="userid">uucp</systemitem>.  Algunos de 
ellos tienen claves y números de teléfono, y por lo tanto deberían tener 
permisos de 600. Aunque la mayoría de los comandos de UUCP tienen que tener el
setuid a <systemitem role="userid">uucp</systemitem>, tiene que asegurarse de 
que el programa <command>uuchk</command> <emphasis>no</emphasis> lo es.  Si no,
los usuarios serían capaces de ver las claves aunque tengan modo 600.
</para>

<para>
El principal fichero de configuración de UUCP es
<filename>/etc/uucp/config</filename>, que se usa para establecer las
variables generales. La más importante (y por ahora la única) es el nombre
UUCP de su máquina. En la Cervera Virtual, usan <systemitem role="sitename">
vstout</systemitem> como su pasarela UUCP:
</para>

<para>
<screen>
# /etc/uucp/config - principal fichero de configuración de UUCP
nodename         vstout
</screen>
</para>

<para>
<?troff .hw specific>
El siguiente fichero de configuración en importancia es el fichero
<filename>sys</filename>.  Éste contiene toda la información específica al 
sistema de los ordenadores con los que usted se conecta.  Esto incluye
el nombre del ordenador, e información sobre la propia conexión, tal
como el número de teléfono cuando se usa una conexión por módem.
Un ejemplo típico para un ordenador llamado <systemitem role="sitename">pablo
</systemitem> que se conecta por módem sería:
</para>

<para>
<screen>
# /usr/lib/uucp/sys - vecinos UUCP
# system: pablo
system          pablo
time            Any
phone           123--456
port            serial1
speed           38400
chat            ogin: vstout ssword: lorca
</screen>
</para>
<?troff .Nd 10>

<para>
<systemitem role="keyword">time</systemitem> especifica las horas a las
que puede llamarse al sistema remoto. <systemitem
role="keyword">chat</systemitem> describe la macro del diálogo de entrada
&mdash;la secuencia de caracteres que deben intercambiarse para permitir que
<command>uucico</command> entre en <systemitem
role="sitename">pablo</systemitem>. Volveremos a las macros más
tarde. El elemento <systemitem role="keyword">port</systemitem> simplemente
nombra una entrada en el fichero <filename>port</filename>.  (Acuda a <xref
linkend="X-087-2-uucp.fig.files">.) Puede asignar cualquier nombre siempre
que haga referencia a una entrada válida en <filename>port</filename>.
</para>

<para>
El fichero <filename>port</filename> contiene información específica a la propia
conexión.  Para conexiones por módem, describe el fichero de dispositivo
a usar, el conjunto de velocidades soportadas, y el tipo de equipo
de marcación conectado al puerto.  La entrada a continuación describe
<filename>/dev/ttyS1</filename> (o sea, el puerto COM 2), en el cual hay un 
módem NakWell conectado que es capaz de funcionar a velocidades de hasta 
38400 bps. El nombre de la entrada se puede elegir para que coincida con el
nombre usado en el fichero <filename>sys</filename>.
</para>

<para>
<screen>
# /etc/uucp/port - puertos de UUCP
# /dev/ttyS1 (COM2)
port            serial1
type            modem
device          /dev/ttyS1
speed           38400
dialer          nakwell
</screen>
</para>

<para>
La información que afecta al propio marcador se mantiene en otro fichero,
llamado &mdash;lo adivinaste&mdash;<filename>dial</filename>.  Para cada tipo 
de marcador, contiene básicamente la secuencia de instrucciones necesarias para 
llamar a otro ordenador, dado el número de teléfono.  Una vez más, esto se 
especifica como una macro de diálogo.  Por ejemplo, la entrada para el 
anterior NakWell puede parecerse a esta:
</para>

<para>
<screen>
# /etc/uucp/dial - información por marcador
# módems NakWell
dialer          nakwell
chat            "" AT&amp;F OK ATDT\T CONNECT
</screen>
</para>

<para>
La línea que empieza con <systemitem role="keyword">chat</systemitem> 
especifica el diálogo del módem, que no es sino la secuencia de órdenes 
enviadas y recibidas del módem para inicializarlo, y para hacerle marcar el 
número deseado.  La secuencia <systemitem role="keyword">\T</systemitem> será 
reemplazada con el número de teléfono por el programa <command>uucico</command>.
</para>

<para>
Para darle una idea a grandes rasgos de cómo utiliza <command>uucico</command> 
estos ficheros de configuración, suponga que utiliza la orden:

<screen>
$ <userinput>uucico -s pablo</userinput>
</screen>
</para>

<para>
Lo primero que hace <command>uucico</command> es buscar <systemitem
role="sitename">pablo</systemitem> en el fichero <filename>sys</filename>. 
A partir de la entrada en el fichero <filename>sys</filename> para <systemitem
role="sitename">pablo</systemitem>, el programa averigua que debería usar
el puerto <systemitem role="keyword">serial1</systemitem> para establecer la
conexión. El fichero <filename>port</filename> le dice a 
<command>uucico</command> que se trata de un puerto de módem al que hay
conectado un módem NakWell.
</para>

<para>
<command>uucico</command> busca ahora en <filename>dial</filename> la
entrada en la que se describe el módem NakWell, y al encontrarla, abre
el puerto serie <filename>/dev/ttyS1</filename> y ejecuta el diálogo de
marcación. Es decir, envía <command>AT&amp;F</command>, espera la respuesta
<command>OK</command>, etc. Cuando encuentra la cadena
<systemitem role="keyword">\T</systemitem>, la sustituye por el número
(123--456) extraído del fichero <filename>sys</filename>.
</para>

<para>
Cuando el módem devuelve <command>CONNECT</command>, la conexión se ha
establecido y el diálogo de marcación se ha completado.
<command>uucico</command> vuelve ahora al fichero
<filename>sys</filename> y ejecuta el diálogo de entrada. En nuestro ejemplo,
esperaría al <command>login:</command>, enviaría entonces su nombre de usuario
(<emphasis role=bold>vstout</emphasis>), esperaría a que se le solicitase el
<command>password:</command> y enviaría la contraseña
(<command>lorca</command>).
</para>

<para>
<?troff .hw section>
Tras completar la autorización, se supone que el sistema remoto ejecuta su
propio <command>uucico</command>. Entran los dos entonces en la fase de
negociación descrita en la sección previa.
</para>

<para>
<xref linkend="X-087-2-uucp.fig.files"> ilustra las dependencias entre los
ficheros de configuración.
</para>

<figure id="X-087-2-uucp.fig.files">
<title>Interacción entre los ficheros de configuración de Taylor UUCP</title>
<mediaobject>
  <imageobject><imagedata fileref="lag2_1601" format="eps"></imageobject>
  <imageobject><imagedata fileref="lag2_1601.jpg" format="jpg"></imageobject>
</mediaobject>
</figure>

</sect2>

<sect2 id="X-087-2-uucp.starting.parameters"><title>Lo que UUCP necesita saber</title>

<para>
Antes de empezar a escribir los ficheros de configuración, debe
conseguir cierta información que UUCP necesita.
</para>

<para>
Primero, tiene que averiguar a qué puerto serie está conectado su módem.
Normalmente, los puertos (DOS) COM1: a COM4: se corresponden con los ficheros
especiales de los dispositivos <filename>/dev/ttyS0</filename> a
<filename>/dev/ttyS3</filename>.  Algunas distribuciones, como Slackware,
crean un enlace llamado <filename>/dev/modem</filename> apuntando
al fichero del dispositivo <filename>ttyS*</filename> apropiado, y configuran
<command>kermit</command>, <command>seyon</command> y cualquier otro programa
de comunicaciones para usar este fichero genérico. En ese caso, debería usar
<filename>/dev/modem</filename> en la configuración de UUCP también.
</para>

<para>
La razón para esto es que todos los programas, para llamar por teléfono,
usan unos <emphasis>ficheros de bloqueo</emphasis> para indicar cuándo un 
puerto serie está en uso.  Los nombres de estos ficheros cerrojo son una 
concatenación del texto <filename>LCK..</filename> y el nombre del fichero 
de dispositivo, por ejemplo, <filename>LCK..ttyS1</filename>.  Si los programas
usasen nombres diferentes para un mismo dispositivo, no podrían reconocer los 
ficheros cerrojo de los otros programas.  En consecuencia, perturbarían la 
sesión de conexión de cada uno si se ejecutan a la vez.  Esto no es raro que
ocurra cuando organiza sus llamadas de UUCP usando una entrada en
el fichero <filename>crontab</filename>.
Para más detalles sobre la configuración de puertos serie, acuda a
<xref linkend="X-087-2-serial">.
</para>

<para>
A continuación tiene que averiguar a qué velocidad se comunicarán
su módem y GNU/Linux.  Tendrá que ajustar este valor a la velocidad
de transferencia efectiva máxima que espere obtener.  La velocidad
efectiva puede ser mucho mayor que la velocidad física de tranferencia
de su módem.  Por ejemplo, muchos modems envían y reciben datos a
56 kbps.  Usando protocolos de compresión como
V.42bis, la velocidad real de transferencia puede alcanzar los 100 kbps.
</para>

<para>
Por supuesto, si quiere que UUCP sirva de algo, necesitará el
número de teléfono al que llamar.  También necesitará un nombre de
usuario válido y probablemente una clave en el sistema remoto.<footnote
id="X-087-2-FNUU04"><para>
Si sólo quiere probar UUCP, obtenga el número de un sistema cercano
a usted.  Apunte el nombre de usuario y la clave&mdash; son públicos para 
permitir posibles transferencias anónimas.  En la mayoría de los casos, son 
algo como 
<systemitem role="userid">uucp/uucp</systemitem> o
<systemitem role="userid">nuucp/uucp</systemitem>.
</para>
</footnote>

</para>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>entrar al sistema</secondary></indexterm>
También necesitará saber <emphasis>exactamente</emphasis> cómo entrar en el 
sistema. Por ejemplo, ¿tiene que pulsar la tecla Enter antes de que aparezca
la pregunta de nombre de usuario?. ¿Muestra el sistema remoto un <literal>login:</literal> o <literal>user</literal>?.  
Esto es necesario para escribir la <emphasis>macro de diálogo</emphasis>, que es un <emphasis>guión</emphasis> que le 
dice a <command>uucico</command> cómo entrar.
Si no lo sabe, o si la macro de diálogo normal no funciona, intente
llamar al sistema con un programa como <command>kermit</command> o 
<command>minicom</command>, y apunte exactamente lo que tiene que hacer.
</para>
</sect2>

<sect2 id="X-087-2-uucp.starting.sitename"><title>Nomenclatura de nodos</title>

<para>
<indexterm><primary>direcciones</primary><secondary>nombre de nodo UUCP</secondary></indexterm>
<indexterm><primary>elegir</primary><secondary>nombre de nodo UUCP</secondary></indexterm>
<indexterm><primary>Taylor UUCP</primary><secondary>nombre de nodo</secondary></indexterm>
<indexterm><primary>nombre de nodo</primary><secondary>UUCP</secondary></indexterm>
Al igual que en redes basadas en TCP/IP, todas las máquinas necesitan
tener un nombre para la red de UUCP.  Mientras sólo quiera usar UUCP
para transferencia de ficheros desde y hacia ordenadores que usted llama
directamente, o en una red local, el nombre no tiene que ajustarse
a ninguna regla.<footnote id="X-087-2-FNUU05"><para>
La única limitación es que no puede ser más largo que siete caracteres,
para no confundir a algunos nodos con sistemas de ficheros que imponen
un estrecho límite en los nombres de ficheros.
</para>
</footnote>

</para>

<para>
De todas formas, si usa UUCP para una conexión de correo o noticias, debería
pensar en registrar el nombre en el Proyecto de Mapeado UUCP.
<footnote id="X-087-2-FNUU06"><para> El Proyecto de Mapeado UUCP
registra los nombres de nodos UUCP en todo el mundo y asegurándose de que
sean únicos.
</para></footnote> El Proyecto de Mapeado UUCP se describe en
<xref linkend="X-087-2-mail">. Incluso aunque forme parte de un dominio,
debería considerar tener un nombre UUCP oficial para su sitio.
</para>

<para>
Con frecuencia la gente elige su nombre UUCP de forma que coincida con el
primer elemento de su nombre de dominio completamente cualificado. Suponga
que la dirección de su dominio es
<systemitem role="sitename">swim.twobirds.com</systemitem>; entonces el nombre
de su nodo UUCP sería <systemitem role="sitename">swim</systemitem>. Piense
en los nodos UUCP como si sólo se conociesen entre ellos por sus respectivos
nombres propios. Por supuesto, también puede usar un nombre UUCP que no tenga
nada que ver con su nombre de dominio completamente cualificado.
</para>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>Mapping Project</secondary></indexterm>
No obstante, asegúrese de no emplear un nombre de sitio no cualificado en 
direcciones de correo a menos que lo haya registrado como su nombre UUCP
oficial. En el mejor de los casos, el correo a una máquina UUCP no registrada
se perderá en algún enorme agujero negro digital. Si emplea un nombre que
alguien ya esté usando, el correo se dirigirá a ese lugar causando al 
administrador del correo de ese lugar un sinfín de dolores de cabeza.
</para>

<para>
De manera predeterminada, UUCP usa el nombre especificado como
<command>hostname</command> como el nombre UUCP del sitio. Este nombre suele
adjudicarlo una orden en los guiones <filename>rc</filename> durante el
arranque del sistema, y se suele guardar en
<filename>/etc/hostname</filename>. Si su nombre UUCP difiere del de su
máquina, tendrá que usar la opción <command>hostname</command> en el fichero
<filename>config</filename> para comunicarle a <command>uucico</command> su
nombre UUCP. Esto se describe más tarde.
</para>
</sect2>

<sect2><title>Ficheros de configuración de Taylor</title>
<para>
<indexterm><primary>ficheros de configuración</primary><secondary>Taylor UUCP</secondary></indexterm> 
Volvemos ahora a los ficheros de configuración. Taylor UUCP obtiene su 
información de los siguientes ficheros:

<variablelist>
<varlistentry><term><filename>config</filename></term>
<listitem><para>
Éste es el principal fichero de configuración. Aquí puede definir el nombre de
su sitio UUCP.
</para>
</listitem>
</varlistentry>

<varlistentry><term><filename>sys</filename></term>
<listitem><para>
En este fichero se describen todos los sitios conocidos. Para cada sitio se
especifica su nombre, a qué horas llamarlo, qué número marcar (si es el caso),
qué tipo de dispositivo usar, y cómo entrar en él.
</para>
</listitem>
</varlistentry>

<varlistentry><term><filename>port</filename></term>
<listitem><para>
Este fichero contiene entradas en las que se describe cada puerto disponible, 
junto a la velocidad de la línea soportada y las instrucciones de marcación.
</para>
</listitem>
</varlistentry>

<varlistentry><term><filename>dial</filename></term>
<listitem><para>
En este fichero se describen los marcadores a usar para establecer una 
conexión telefónica.
</para>
</listitem>
</varlistentry>

<varlistentry><term><filename>dialcode</filename></term>
<listitem><para>
Este fichero contiene expansiones para códigos de marcación simbólicos.
</para>
</listitem>
</varlistentry>

<varlistentry><term><filename>call</filename></term>
<listitem><para>
Este fichero contiene el nombre y la contraseña a utilizar cuando se llama
a un sistema. Raramente se usa.
</para>
</listitem>
</varlistentry>

<varlistentry><term><filename>passwd</filename></term>
<listitem><para>
Este fichero contiene los nombres y las contraseñas que pueden usar los
sistemas al conectarse. Sólo se usa cuando <command>uucico</command> lleva a
cabo su propia validación de contraseñas.
</para>
</listitem>
</varlistentry>
</variablelist>
</para>

<para>
Los ficheros de configuración de Taylor se componen generalmente de líneas
que contienen pares clave-valor. Una almohadilla inicia un comentario que se
extiende hasta el final de la línea. Para emplear el signo de la almohadilla
como tal, escápelo con una barra invertida de esta manera: 
<literal>\#</literal>.
</para>

<para>
Hay unas cuantas opciones que puede ajustar con estos ficheros
de configuración.  No podemos repasar todos los parámetros, sino
que cubriremos sólo los más importantes.  Con éstos usted podrá
configurar una conexión de UUCP por módem.  Otras secciones describirán
las modificaciones necesarias si quiere usar UUCP en TCP/IP o sobre
una línea serie.  Junto con el código fuente de Taylor UUCP se incluye
una referencia de órdenes completa en los documentos Texinfo.
</para>

<para>
<indexterm><primary>mostrar</primary><secondary>configuración de UUCP</secondary></indexterm>
<indexterm><primary>comprobar</primary><secondary>UUCP</secondary></indexterm>
<indexterm><primary>Taylor UUCP</primary><secondary>comprobar</secondary></indexterm>
Cuando crea haber configurado su sistema UUCP completamente, puede compobar
su configuración con la herramienta <command>uuchk</command> (que puede
encontrar en <filename>/usr/lib/uucp</filename>). <command>uuchk</command> lee
sus ficheros de configuración y le muestra un informe detallado de los valores
de configuración usados para cada sistema.
</para>

</sect2>

<sect2><title>Opciones generales de configuración usando el fichero config</title>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>ficheros de configuración</secondary></indexterm>
<indexterm><primary>Taylor UUCP</primary><secondary>nombre del nodo</secondary></indexterm>
Normalmente no usará este fichero para otra cosa que especificar el nombre de
su nodo UUCP. De manera predeterminada, UUCP usará el nombre que haya
establecido con la orden <command>hostname</command>, pero por lo general
resulta una buena idea especificar el nombre UUCP explícitamente. He aquí un
fichero <filename>config</filename> de ejemplo:

<screen>
# /usr/lib/uucp/config - principal fichero de configuración UUCP
hostname        vstout
</screen>
</para>

<para>
Por supuesto, también existen otros parámetros configurables aquí, como los
referentes al nombre del directorio de colas, o los nombres de acceso para el
UUCP anónimo. Esto último se describirá posteriormente en este capítulo, en
la sección &ldquo;UUCP anónimo.&rdquo;
</para>

</sect2>

<sect2 id="X-087-2-uucp.systems.file"><title>Cómo informar a UUCP sobre otros sistemas mediante el fichero <?lb>sys</title>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>fichero sys</secondary></indexterm>
<indexterm id="idx-UUCPremotesystem-1" class="startofrange"><primary>Taylor UUCP</primary><secondary>sistema remoto</secondary></indexterm>
En el fichero <filename>sys</filename> se describen los sistemas que conoce
su máquina. La clave <systemitem role="keyword">system</systemitem> nos 
presenta una nueva entrada; las líneas siguientes hasta la próxima directiva 
<systemitem role="keyword">system</systemitem> detallan las variables 
específicas de cada sitio. Comúnmente, una entrada de sistema define variables 
como el número de teléfono y el diálogo de entrada.
</para>

<para>
Las variables anteriores a la primera línea <systemitem
role="keyword">system</systemitem> especifican valores predeterminados a usar
en todos los sistemas. Normalmente, colocará en esta sección variables del 
protocolo y similares.
</para>
<para>
Los campos más importantes se tratan en detalle en las siguientes secciones.
</para>
<?troff .Nd 10>

<sect3><title>Nombre del sistema</title>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>sistema remoto</secondary></indexterm>
La orden <emphasis>system</emphasis> nombra el sistema remoto. Debe
especificar el nombre correcto del sistema remoto, no un alias que se invente,
porque <command>uucico</command> lo comparará con la identificación que reciba
del sistema remoto una vez se conecte a él.
<footnote id="X-087-2-FNUU07"><para>
Los UUCPs Versión 2 antiguos no hacen saber su nombre cuando se les llama; de
todos modos, sí lo hacen las implementaciones más recientes, y así lo hace
Taylor UUCP.
</para>
</footnote>

</para>

<para>
Cada nombre de sistema puede aparecer una sola vez.  Si quiere usar
varias configuraciones para un mismo sistema (por ejemplo, números
de teléfono diferentes que <command>uucico</command> puede usar 
alternativamente), puede especificar <emphasis>alternativas</emphasis>,
que se describen más adelante.
</para>

</sect3>

<sect3><title>Número de teléfono</title>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>número de teléfono</secondary></indexterm>
Si va a conectarse con el sistema remoto por vía telefónica, en el campo
<systemitem role="keyword">phone</systemitem> se especifica el número que
debería marcar el módem. Puede contener varios separadores que interpretará
el procedimiento de marcado de <command>uucico</command>. Un signo de igual (=)
significa esperar un tono de marcado secundario y un guión (-) genera una
pausa de un segundo. Algunas instalaciones telefónicas pueden atrancarse si
no se realizan pausas entre códigos de acceso especiales y los números de
teléfono.<footnote id="X-087-2-FNUU08"><para>
Por ejemplo, muchas instalaciones de compañías privadas requieren que marque
un 0 o un 9 para obtener línea hacia el exterior.
</para>
</footnote>

</para>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>dialcode fichero</secondary></indexterm>
A menudo resulta conveniente usar nombres en vez de números para describir los
códigos de marcado según la zona. El fichero <filename>dialcode</filename> 
le permite asociar un nombre con un código que use al especificar números 
de teléfono para las máquinas remotas. Suponga que tiene el siguiente fichero
<filename>dialcode</filename>:
</para>

<para>
<screen>
# /usr/lib/uucp/dialcode - traducción de los códigos de marcación
Bogoham         024881
Coxton          035119
</screen>
</para>

<para>
Con estas traducciones, puede usar un número de teléfono tal que
<systemitem role="keyword">Bogoham7732</systemitem> en el fichero
<filename>sys</filename>, que lo hará probablemente algo más legible y mucho
será mucho más fácil actualizar el código de marcación para Bogoham cada vez
que cambie.
</para>

</sect3>

<sect3><title>puerto y velocidad</title>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>dispositivo</secondary></indexterm>
Las opciones de <systemitem role="keyword">puerto</systemitem> y <systemitem
role="keyword">velocidad</systemitem> se usan para elegir el dispositivo a
usar para llamar al sistema remoto y la velocidad máxima a la que debería
ajustarse el dispositivo.<footnote id="X-087-2-FNUU09"><para>
La velocidad en baudios del terminal <emphasis>tty</emphasis> debe configurarse
al menos como la máxima velocidad de transferencia.
</para>
</footnote>
En una entrada de <systemitem role="keyword">system</systemitem> se puede usar
una opción o varias de manera conjunta. Cuando se busca un dispositivo
adecuado en el fichero <filename>port</filename>, sólo se eligen los 
dispositivos con un nombre de puerto y/o rango de velocidad que coincidan con 
los especificados.
</para>

<para>
Por lo general debería ser suficiente utilizar únicamente la opción 
<systemitem role="keyword">speed</systemitem>. Si sólo dispone de un
dispositivo serie definido en <filename>port</filename>,
<command>uucico</command> siempre toma el adecuado por lo que sólo tiene que
especificar la velocidad deseada. Si tiene varios módems conectados a sus
sistemas, con frecuencia no querrá nombrar un puerto concreto, porque si
<command>uucico</command> encuentra que muchos coinciden prueba con cada
dispositivo hasta que encuentra uno que no se esté usando.
</para>

</sect3>

<sect3><title>El diálogo de entrada</title>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>entrar</secondary></indexterm>
<indexterm><primary>Taylor UUCP</primary><secondary>diálogo de entrada</secondary></indexterm>
<indexterm><primary>Taylor UUCP</primary><secondary>guiones de entrada</secondary></indexterm>
<indexterm><primary>script de entrada</primary><secondary>UUCP</secondary></indexterm>
Antes ya nos encontramos con la macro del diálogo de entrada, que le
dice a <command>uucico</command> cómo entrar en el sistema remoto.  
Consiste de una lista de palabras clave, que especifican el texto que se 
espera y el que se envía por el proceso local de <command>uucico</command>.  
El objetivo es hacer que <command>uucico</command> espere hasta que la máquina 
remota envíe una línea pidiendo el nombre de usuario, y entonces enviar el nombre de
usuario, luego esperar a que pida la palabre clave, y enviar dicha
clave.  Los textos de espera y de envío se dan alternativamente.
<command>uucico</command> automáticamente añade un avance de línea
(<systemitem role="keyword">\r</systemitem>) a cualquier texto enviado.  Por lo tanto, una macro de diálogo sencilla sería parecida a esta:

<screen>
 ogin: vstout ssword: catch22
</screen>
</para>

<para>
Dése cuenta de que los campos de texto de espera probablemente no
contendrán el texto completo.  Esto es así para
asegurarse de que el proceso de entrada se lleve a cabo aunque el
sistema remoto nos envíe <command>Login:</command> en vez de 
<command>login:</command>. Si la cadena que está esperando o enviando
contiene espacios u otros caracteres de espacios en blanco, debe usar 
comillas para delimitar el texto.
</para>

<para>
<command>uucico</command> también permite usar estructuras condicionales, por 
ejemplo en el caso de que el programa <command>getty</command> de la máquina 
remota necesite ser reinicializado antes de enviar una pregunta.  Por esta
razón, usted puede añadir un sub-diálogo a un texto de espera, separado
con un guión.  El sub-diálogo se ejecuta sólo si el primer texto de espera
falla, ej. si expira un temporizador.  Una manera de usar esta característica
es enviar un BREAK si el sistema remoto no envía una pregunta de
nombre de usuario.  El siguiente ejemplo muestra un ejemplo de una macro
de diálogo que debería funcionar también en el caso de que usted tenga
que pulsar Enter antes de que aparezca la pregunta de entrada. El primer
parámetro vacío, <literal>""</literal>, comunica a UUCP que no espere nada
sino que continúe con la siguiente cadena de envío:

<screen>
 "" \n\r\d\r\n\c ogin:-BREAK-ogin: vstout ssword: catch22
</screen>
</para>

<para>
Hay un par de cadenas de caracteres especiales y caracteres de escape
que pueden aparecer en la macro de diálogo.  Esta es una lista incompleta
de caracteres legales en la pregunta de espera:

<variablelist>
<varlistentry><term><literal>""</literal></term>
<listitem><para>
La cadena vacía comunica a <command>uucico</command> que no espere nada,
sino que siga de inmediato con la siguiente cadena enviada.
</para>
</listitem>
</varlistentry>

<varlistentry><term><systemitem role="keyword">\t</systemitem></term>
<listitem><para>
Carácter de tabulador.
</para>
</listitem>
</varlistentry>
<?troff .wcon_off>
<varlistentry><term><systemitem role="keyword">\r</systemitem></term>
<listitem><para>
Carácter de retorno de línea.
</para>
</listitem>
</varlistentry>

<varlistentry><term><systemitem role="keyword">\s</systemitem></term>
<listitem><para>
Carácter de espacio. Se necesita para incluir espacios en un diálogo.
</para>
</listitem>
</varlistentry>

<varlistentry><term><systemitem role="keyword">\n</systemitem></term>
<listitem><para>
Carácter de línea nueva.
</para>
</listitem>
</varlistentry>

<varlistentry><term><systemitem role="keyword">\\</systemitem></term>
<listitem><para>
Carácter de barra invertida.
</para>
</listitem>
</varlistentry>
</variablelist>
</para>

<para>
En cadenas de caracteres de envío se pueden incluir, además de los
mencionados anteriormente, los siguientes caracteres:

<variablelist>
<varlistentry><term><systemitem role="keyword">EOT</systemitem></term>
<listitem><para>
Carácter de fin de transmisión (<command>^D</command>).
</para>
</listitem>
</varlistentry>

<varlistentry><term><systemitem role="keyword">BREAK</systemitem></term>
<listitem><para>
Carácter Break.
</para>
</listitem>
</varlistentry>

<varlistentry><term><systemitem role="keyword">\c</systemitem></term>
<listitem><para>
Suprime el envío del carácter del línea nueva al final de cada cadena de
caracteres.
</para>
</listitem>
</varlistentry>

<varlistentry><term><systemitem role="keyword">\d</systemitem></term>
<listitem><para>
Retrasa el envío 1 segundo.
</para>
</listitem>
</varlistentry>

<varlistentry><term><systemitem role="keyword">\E</systemitem></term>
<listitem><para>
Activa la comprobación de eco.  De esta forma, <command>uucico</command>
esperará a leer el eco de todo lo que escribe en el dispositivo
antes de que continúe con el diálogo.  Se usa principalmente
en diálogos de modems (que veremos más adelante).
La comprobación de eco está desactivada por omisión.
</para></listitem>
</varlistentry>

<varlistentry><term><systemitem role="keyword">\e</systemitem></term>
<listitem><para>
Desactiva la comprobación del eco.
</para></listitem>
</varlistentry>

<varlistentry><term><systemitem role="keyword">\K</systemitem></term>
<listitem><para>
Lo mismo que <systemitem role="keyword">BREAK</systemitem>.
</para></listitem>
</varlistentry>

<varlistentry><term><systemitem role="keyword">\p</systemitem></term>
<listitem><para>
Pausa de una fracción de segundo.
</para></listitem>
</varlistentry>
</variablelist>
</para>

</sect3>

<sect3><title>Alternativas</title>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>alternativas</secondary></indexterm>
A veces es deseable tener múltiples entradas para un mismo sistema,
por ejemplo si se puede acceder al sistema en diferentes líneas de
módem.  Con Taylor UUCP se puede hacer esto definiendo una
<emphasis>alternativa</emphasis>
</para>

<para>
Una entrada alternativa mantiene todas las características de la entrada
principal, y especifica solamente aquellos valores que tienen que ser
cambiados, o añadidos.  Una alternativa está separada de la entrada
principal por una línea que contiene la palabre clave
<systemitem role="keyword">alternate</systemitem>
</para>

<para>
Para usar dos números de teléfono para 
<systemitem role="sitename">pablo</systemitem>, habría que modificar su
entrada <filename>sys</filename> de la siguiente manera:

<screen>
system       pablo
phone        123-456
.. lo mismo de antes ...
alternate
phone        123-455
</screen>
</para>

<para>
Ahora, cuando llame a <systemitem role="sitename">pablo</systemitem>, el 
programa <command>uucico</command> marcará primero el 123-456, y si no 
funciona, probará la alternativa.  La entrada alternativa retiene toda la otra 
información de la entrada de sistema principal, y altera sólo el número de 
teléfono.
</para>
</sect3>

<sect3><title>Restringir horas de llamada</title>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>restringir</secondary><tertiary>horas de llamada</tertiary></indexterm>
<indexterm><primary>Taylor UUCP</primary><secondary>horas de llamada</secondary></indexterm>
Taylor UUCP proporciona varios métodos para restringir las horas
a las que se pueden efectuar llamadas a un sistema remoto.  Una razón
para hacer esto sería por las limitaciones que el sistema remoto
impone en sus servicios durante horas de oficina, o simplemente para
evitar las horas más caras.  Siempre se pueden desactivar las restricciones
con la opción <option>&ndash;S</option> o <option>&ndash;f</option> en el 
programa <command>uucico</command>.
</para>

<para>
Por defecto, Taylor UUCP no permite conexiones a ninguna hora, así que
usted <emphasis>tiene que</emphasis> especificar algún horario
en el fichero <filename>sys</filename>.  Si no le importan las restricciones, 
puede especificar la opción <command>time</command> con un valor de 
<systemitem role="keyword">Any</systemitem> en su fichero 
<filename>sys</filename>.
</para>

<para>
La manera más sencilla de restringir los horarios de las llamadas es incluir
una entrada <systemitem role="keyword">time</systemitem> seguida de una cadena
formada por los subcampos día y hora. Día puede ser una combinación de
<systemitem role="keyword">Mo, Tu, We, Th, Fr, Sa,</systemitem> y <systemitem role="keyword">Su</systemitem>. También puede especificar 
<systemitem role="keyword">Any</systemitem>,
<systemitem role="keyword">Never</systemitem>, o
<systemitem role="keyword">Wk</systemitem> para los días laborables. 
La hora está formada por dos valores de reloj de 24 horas separados por un
guión. Especifican las horas durante las que pueden efectuarse llamadas.
La combinación de estos elementos se escribe sin espacios en blanco entre 
ellos. Se pueden especificar varios pares día-hora separados por comas,
tal y como se muestra en esta línea:

<screen>
time            MoWe0300-0730,Fr1805-2200
</screen>
</para>

<para>
En este ejemplo se permiten llamadas en Lunes y Miércoles, de 3 de la mañana 
a 7:30, y los Viernes entre las 6:05 y las 8:00 de la tarde.  Cuando un campo
de hora incluye la medianoche, como 
<systemitem role="keyword">Mo1830-0600</systemitem>, en realidad
quiere decir el Lunes, entre medianoche y las 6 de la mañana, y entre
las 6:30 de la tarde y medianoche.
</para>

<para>
Las palabras especiales <systemitem role="keyword">Any</systemitem> y 
<systemitem role="keyword">Never</systemitem> significan
que se pueden hacer llamadas siempre o nunca, respectivamente.
</para>

<para>
Taylor UUCP también tiene algunos elementos especiales que puede usar en
cadenas de tiempo como
<systemitem role="keyword">NonPeak</systemitem> y
<systemitem role="keyword">Night</systemitem>.  Estos elementos especiales son
abreviaturas de
<systemitem role="keyword">Any2300-0800,SaSu0800-1700</systemitem> y
<systemitem role="keyword">Any1800-0700,SaSu</systemitem> respectivamente.
</para>  

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>intervalo para reintentar</secondary></indexterm>
La orden <emphasis>time</emphasis> tiene una segunda variable opcional que 
describe el tiempo a esperar para reintentar en minutos.  Cuando un intento de
conexión falla, <command>uucico</command> no permitirá otro intento de llamar
al ordenador remoto hasta que transcurra un cierto tiempo.
De manera predeterminada, <command>uucico</command> usa un algoritmo de espera 
exponencial, según el cual el intervalo de espera se incrementa con cada 
intento fallido. Por ejemplo, si especifica un tiempo de reintento de 5 minutos,
<command>uucico</command> no aceptará llamar otra vez en los 5 minutos después del ultimo intento fallido.
</para>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>prioridades</secondary></indexterm>
<indexterm><primary>Taylor UUCP</primary><secondary>rango de cola</secondary></indexterm>
La orden <command>timegrade</command> le permite 
adjuntar un rango máximo de cola a un calendario. Por ejemplo, asuma que tiene
las siguientes órdenes <command>timegrade</command> en una entrada
<systemitem role="keyword">system</systemitem>:

<screen>
timegrade           N Wk1900-0700,SaSu 
timegrade           C Any
</screen>
</para>
<?troff .Nd 10>

<para>
Esto permite que los trabajos con rango de cola de C o mayor (normalmente
el correo se pone en la cola con rango B o C) sean transferidos siempre que
se establece una comunicación, mientras que las noticias (normalmente con 
rango N) serán transferidas sólo durante la noche y los fines de semana.

</para>

<para>
Al igual que <command>time</command>, la orden <command>timegrade</command> 
toma un intervalo entre reintentos de minutos como una tercera variable 
opcional.
</para>

<para>
De todas formas, hay que hacer una observación sobre los rangos de la cola.
Primero, la opción <command>timegrade</command> sólo se afecta a lo que 
<emphasis>sus</emphasis> sistemas envían; el sistema remoto puede transferir
lo que quiera. Puede usar la opción <command>call-timegrade</command> para
solicitarle de manera explícita que envíe solamente tareas por encima de
un determinado rango de cola; pero no hay hay ninguna garantía de que vaya a
obedecer a su petición.<footnote id="X-087-2-FNUU10"><para>
Si el sistema remoto usa también Taylor UUCP es seguro que obedecerá.
</para></footnote>
</para>

<para>
De manera similar, el campo <replaceable>timegrade</replaceable> no se 
comprueba cuando llama un sistema remoto, por lo que se le enviará cualquier
tarea de la cola que sea para él. De todos modos, el sistema remoto puede
solicitar explícitamente a su <command>uucico</command> que se ocupe
únicamente de cierto rango de la cola.
<indexterm class="endofrange" startref="idx-UUCPremotesystem-1">
</para>

</sect3>

</sect2>

<sect2><title>Identificar dispositivos disponibles mediante el fichero port</title>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>fichero port</secondary></indexterm>
<indexterm><primary>Taylor UUCP</primary><secondary>dispositivo</secondary></indexterm>
<indexterm><primary>Taylor UUCP</primary><secondary>módem</secondary></indexterm>
El fichero <filename>port</filename> hace saber a <command>uucico</command> los
puertos disponibles. Se trata normalmente de puertos de módem, pero también
se soportan otros tipos como las líneas serie y los sockets de TCP.
</para>

<para>
Al igual que el fichero <filename>sys</filename>, <filename>port</filename>
está formado por entradas separadas que comienzan con la palabra clave
<systemitem role="keyword">port</systemitem> seguida del nombre del puerto. 
Este nombre también puede usarse en la sentencia
<systemitem role="keyword">port</systemitem> del fichero
<filename>sys</filename>. No es necesario que el nombre sea único; si hay
muchos puertos con el mismo nombre, <command>uucico</command> probará con
cada uno hasta que encuentre alguno que pueda usar.
</para>

<para>
La orden <command>port</command> debería estar seguida inmediatamente por
la sentencia <systemitem role="keyword">type</systemitem>, que indica qué
tipo de puerto se describe. Tipos válidos son
<systemitem role="keyword">modem</systemitem>,
<systemitem role="keyword">direct</systemitem> para conexiones directas y
<systemitem role="keyword">tcp</systemitem> para sockets de TCP. De no
existir la orden <command>port</command> se usará de manera predeterminada
módem como tipo de puerto.
</para>

<para>
En esta sección sólo hablaremos de puertos de módem; los puertos TCP y las
líneas directas se tratarán en una sección posterior.
</para>
<?troff .wcon_off>
<para>
Tanto para el módem como para los puertos directos, debe especificar el
dispositivo para llamar por medio de la directiva
<systemitem role="keyword">device</systemitem>. Normalmente,
se trata del nombre del fichero especial de dispositivo del directorio
<filename>/dev</filename>, como <filename>/dev/ttyS1</filename>.
</para>

<para>
En el caso de un módem, la entrada del puerto también determina qué tipo de
módem hay conectado al puerto. Los diferentes tipos de módem tienen que
configurarse de manera diferente. Incluso los módems que dicen ser compatibles
con Hayes no son siempre realmente compatibles unos con otros. Por lo tanto,
tiene que comunicarle a <command>uucico</command> cómo inicializar el módem
y hacerle marcar el número deseado. Taylor UUCP mantiene las descripciones
de todos los marcadores en un
<?troff .ne 10>
fichero llamado <filename>dial</filename>.  Para usar cualquiera de éstos, 
tiene que especificar el nombre del marcador mediante la orden 
<command>dialer</command>.
</para>

<para>
A veces querrá usar un módem de diferentes maneras dependiendo de a qué sistema
llame. Por ejemplo, algunos módems antiguos no entienden cuando un módem
rápido trata de conectar a 56 kbps; simplementen dejan caer la línea en vez
de negociar una conexión a 9.600 bps, por ejemplo. Cuando sabe que el sitio
<systemitem role="sitename">pesado</systemitem> usa un módem tan tonto, tiene
que configurar su módem de una manera diferente cuando le llame. Para esto,
necesita una entrada de puerto adicional en el fichero
<filename>port</filename> en la que especificar un marcador diferente. Ahora
puede darle al nuevo puerto un nombre diferente, como
<systemitem role="keyword">serie1-lento</systemitem> y usar la directiva
<systemitem role="keyword">port</systemitem> en la entrada del sistema
<systemitem role="sitename">pesado</systemitem> en
<filename>sys</filename>.
</para>

<para>
Otra manera de distinguir los puertos es por la velocidad que usan.
Por ejemplo, las dos entradas de puerto de la situación anterior
pueden ser así:

<screen>
# módem Nakwell; conectar a alta velocidad
port            serie1         # port name
type            modem           # modem port
device          /dev/ttyS1      # this is COM2
speed           115200          # supported speed
dialer          nakwell         # normal dialer
# módem Nakwell; conectar a baja velocidad
port            serie1         # port name
type            modem           # modem port
device          /dev/ttyS1      # this is COM2
speed           9600            # supported speed
dialer          nakwell-slow    # don't attempt fast connect
</screen>
</para>

<para>
La entrada de sistema para el sitio 
<systemitem role="sitename">pesado</systemitem> daría ahora
<systemitem role="keyword">serie1</systemitem> como el nombre del
puerto, pero solicitaría usarlo sólo a 9.600 bps. <command>uucico</command> usa
entonces automáticamente la segunda entrada de puerto. Al resto de sitios
que tengan una entrada de 115.200 bps en la entrada del sistema se les llamará
usando la primera entrada de puerto. De manera predeterminada, se usará la
primera entrada con una velocidad que coincida.
</para>

</sect2>

<sect2><title>Cómo marcar un número usando el fichero dial</title>

<para>

<indexterm><primary>Taylor UUCP</primary><secondary>fichero dial</secondary></indexterm>
<indexterm id="idx-UUCPmodem-1" class="startofrange"><primary>Taylor UUCP</primary><secondary>módem</secondary></indexterm>
En el fichero <filename>dial</filename> se describen las maneras de utilizar
diferentes marcadores. Tradicionalmente, UUCP habla de marcadores y no tanto
de módems, porque antaño era habitual disponer de un (caro) dispositivo de
marcado automático que servía a un completo banco de módems. Hoy en día
la mayoría de los módems llevan ya el soporte de marcación integrado, por
lo que esta distinción ha tendido a desvanecerse.
</para>
<?troff .wcon_off>

<para>
No obstante, marcadores o módems diferentes pueden requerir una configuración
diferente. Puede describir cada uno de ellos en el fichero
<filename>dial</filename>. Las entradas de <filename>dial</filename>
comienzan con la orden <command>dialer</command> que proporciona el nombre
del marcador.
</para>

<para>
La entrada más importante aparte de <command>dialer</command> es el diálogo
del módem, especificado por la orden <command>chat</command>. Similar al
diálogo de entrada en el sistema, consta de una secuencia de cadenas que
<command>uucico</command> envía al marcador y las respuestas que espera como
respuesta. Suele usarse para reiniciar el módem a algún estado conocido y 
marcar el número. En la siguiente entrada de <systemitem
role="keyword">dialer</systemitem> de ejemplo se muestra un típico diálogo
de módem para un módem compatible con Hayes:
</para>

<screen>
# módem NakWell; conectar a alta velocidad
dialer          nakwell         # nombre del marcador
chat            "" AT&amp;F OK\r ATH1E0Q0 OK\r ATDT\T CONNECT
chat-fail       BUSY
chat-fail       ERROR
chat-fail       NO\sCARRIER
dtr-toggle      true
</screen>

<para>
El diálogo comienza con <literal>""</literal>, la cadena vacía esperada.
<command>uucico</command> envía entonces la primera orden
<command>AT&amp;F</command>. <command>AT&amp;F</command> es la orden Hayes
para reiniciar el módem a la configuración predeterminada de fábrica.
<command>uucico</command> espera entonces hasta que el módem haya enviado
<literal>OK</literal> y envía la siguiente orden, que desactiva el eco local
y cosas así. Tras devolver el módem <literal>OK</literal> nuevamente,
<command>uucico</command> envía la orden de marcado
<command>ATDT</command>.  La secuencia de escape
<literal>\T</literal> de esta cadena se sustituye por el número de teléfono
tomado de la entrada de sistema del fichero <filename>sys</filename>. 
<command>uucico</command> espera entonces a que el módem le devuelva la cadena
<literal>CONNECT</literal>, que indica que se ha establecido con éxito la
conexión con el módem remoto.
</para>

<para>
A veces el módem falla al conectar con el sistema remoto; por ejemplo,
si el otro sistema está comunicándose con alguien más y la línea está ocupada.
En este caso, el módem devuelve un mensaje de error indicando la razón.
Los diálogos de módem son incapaces de detectar este tipo de mensajes;
<command>uucico</command> sigue esperando la cadena esperada hasta que se
agota el temporizador. El fichero de registro de UUCP sólo muestra entonces
un &ldquo;tiempo agotado en el guión de diálogo&rdquo; en vez de la razón
específica.
</para>

<para>
No obstante, Taylor UUCP le permite informar a <command>uucico</command> sobre 
estos mensajes de error usando la orden <command>chat-fail</command> como se 
ve en el ejemplo.  Cuando <command>uucico</command> detecta una cadena de 
caracteres de error en el diálogo mientras lo ejecuta, interrumpe la llamada y
anota el error en el fichero de registro de UUCP.
</para>

<para>
En la última orden del ejemplo anterior se comunica a UUCP que cambie la línea
de control DTR (Terminal de Datos Preparado) antes de iniciar el diálogo del
módem. Normalmente, el controlador serie levanta DTR cuando un proceso abre
el dispositivo para decirle al módem conectado que alguien quiere hablar con
él. La prestación <systemitem role="keyword">dtr-toggle</systemitem> deja caer
DTR, espera un momento, y lo levanta de nuevo. Muchos módems pueden
configurarse para reaccionar ante una caída de DTR entrando en "off-hook", 
entrando en estado de órdenes o reiniciándose ellos mismos.
<footnote id="X-087-2-FNUU11"><para>
A algunos módems parece no gustarles esto y se cuelgan ocasionalmente.
</para>
</footnote>

</para>

<indexterm class="endofrange" startref="idx-UUCPmodem-1">

</sect2>

<sect2><title>UUCP sobre TCP</title>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>sobre TCP/IP</secondary></indexterm>
<indexterm><primary>TCP (Protocolo de Control de Transmisiones)</primary><secondary>UUCP</secondary></indexterm>

Por muy absurdo que suene en principio, el uso de UUCP para transferir datos
sobre TCP no es una idea tan mala, especialmente cuando se transfieren
grandes cantidades de datos como los grupos de noticias Usenet.  En
conexiones basadas en TCP, los grupos de noticias se transmiten generalmente
usando el protocolo NNTP, según el cual los artículos se piden y se
transmiten individualmente, sin compresión ni ninguna otra optimización.
Aunque es una técnica adecuada para ordenadores grandes con varias fuentes
de grupos de noticias simultáneas, esta técnica no es favorable para
pequeños sistemas que reciben los grupos a través de una conexión lenta,
como RDSI.  Estos ordenadores normalmente desean combinar las cualidades de
TCP con las ventajas de enviar artículos en grandes lotes, que se pueden
comprimir y por lo tanto transferir con muy poco gasto.  Un método estándar
de enviar estos lotes es usando UUCP sobre TCP.
</para>

<para>
En <filename>sys</filename>, especificaríamos que se llamase a un sistema por
TCP de esta manera:

<screen>
system          gmu
address         news.groucho.edu
time            Any
port            tcp-conn
chat            ogin: vstout word: clouseau
</screen>
</para>

<para>
La orden <command>address</command> da la dirección IP de la máquina o su
nombre de dominio completamente cualificado. La entrada
<filename>port</filename> correspondiente sería tal que así:

<screen>
port            tcp-conn
type            tcp
service         540
</screen>
</para>

<para>
En la entrada se afirma que debería usarse una conexión TCP cuando una entrada
<filename>sys</filename> hiciese referencia a
<systemitem role="keyword">tcp-conn</systemitem>, y que
<command>uucico</command> debería intentar conectarse al puerto 540 de la red 
TCP en la máquina remota. Éste es el número de puerto predeterminado del 
servicio UUCP. En vez del número de puerto, también puede proporcionar un
nombre de puerto simbólico a la orden <command>service</command>. El número
de puerto correspondiente a este nombre se buscará en 
<filename>/etc/services</filename>. El nombre común para el servicio UUCP es 
<systemitem role="keyword">uucpd</systemitem>.
</para>

</sect2>

<sect2><title>Usar una conexión directa</title>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>líneas directas</secondary></indexterm>
Supongamos que usa una línea directa para conectar su sistema
<systemitem role="sitename">vstout</systemitem> con
<systemitem role="sitename">tiny</systemitem>. Al igual que en el caso del
módem tiene que escribir una entrada de sistema en el fichero
<filename>sys</filename>. La orden
<command>port</command> identifica el puerto serie en el que está conectado
<systemitem role="keyword">tiny</systemitem>:

<screen>
system          tiny
time            Any
port            direct1
speed           38400
chat            ogin: cathcart word: catch22
</screen>
</para>

<para>
En el fichero <filename>port</filename>, tiene que describir el puerto 
serie para la conexión directa. Una entrada
<systemitem role="keyword">dialer</systemitem> no es necesaria porque no hay
necesidad de marcar:

<screen>
port            direct1
type            direct
speed           38400
device		    /dev/ttyS1
</screen>
</para>

<indexterm class="endofrange" startref="idx-UUCPconfigurationfiles-1">
<indexterm class="endofrange" startref="chuu.config.files.uucp"> 
</sect2>
</sect1>

<sect1 id="X-087-2-uucp.permissions"><title>Controlar el acceso a las prestaciones de UUCP</title>

<para>
<indexterm id="idx-securityUUCP-1" class="startofrange"><primary>seguridad</primary><secondary>UUCP</secondary></indexterm>
<indexterm id="idx-accessUUCP-1" class="startofrange"><primary>acceso</primary><secondary>UUCP</secondary></indexterm>
UUCP es un sistema bastante flexible. Con esa flexibilidad viene la necesidad
de controlar cuidadosamente el acceso a sus prestaciones para prevenir abusos,
tanto intencionados como accidentales. Las principales propiedades a tener
en cuenta por el administrador de UUCP son la ejecución de órdenes remotas,
la transferencia de ficheros y el reenvío. Taylor UUCP proporciona medios para
limitar la libertad de máquinas UUCP remotas al aprovechar cada una de estas
prestaciones. Con una cuidadosa selección de los permisos, el administrador de
UUCP puede asegurarse de preservar la seguridad de la máquina.
</para>

<sect2><title>Ejecución de órdenes</title>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>restringir</secondary><tertiary>ejecución de órdenes</tertiary></indexterm>
<indexterm><primary>Taylor UUCP</primary><secondary>ejecución de órdenes</secondary></indexterm>
Es tarea de UUCP copiar ficheros de un sistema a otro y solicitar la ejecución
de ciertas órdenes en sistemas remotos. Evidentemente, usted como
administrador querrá controlar qué derechos garantiza a otros sistemas&mdash;
permitirles ejecutar cualquier orden que elijan en su sistema
definitivamente no es una buena idea.
</para>

<para>
<indexterm><primary>SMTP (Protocolo Sencillo para la Transferencia de Correo)</primary><secondary>por lotes</secondary></indexterm>
<indexterm><primary>orden rmail</primary></indexterm>
<indexterm><primary>orden rnews</primary></indexterm>
<indexterm><primary>rsmtp</primary><secondary>orden</secondary></indexterm>
<indexterm><primary>Taylor UUCP</primary><secondary>correo</secondary></indexterm>
<indexterm><primary>Taylor UUCP</primary><secondary>noticias</secondary></indexterm>
De manera predeterminada, las únicas órdenes que permite ejecutar Taylor UUCP
a otros sistemas en su máquina son <command>rmail</command> y
<command>rnews</command>, que se usan habitualmente para intercambiar correo-e
y noticias de Usenet sobre UUCP. Para cambiar el conjunto de órdenes para
un sistema en particular, puede usar la palabra clave
<systemitem role="keyword">commands</systemitem> en el fichero
<filename>sys</filename>. De manera similar, puede querer limitar la ruta de
búsqueda a los directorios que contengan las órdenes permitidas. Puede cambiar
la ruta de búsqueda permitida para una máquina remota con la sentencia
<systemitem role="keyword">command-path</systemitem> . Por ejemplo,
puede querer permitir al sistema
<systemitem role="sitename">pablo</systemitem> ejecutar la orden
<command>bsmtp</command> además de <command>rmail</command>
y <command>rnews</command>:<footnote id="X-087-2-FNUU12"><para>
<command>bsmtp</command> se usa para enviar correo con SMTP por lotes.
</para>
</footnote>

<screen>
system          pablo
...
commands        rmail rnews bsmtp
</screen>
</para>

</sect2>

<sect2><title>Transferencias de ficheros</title>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>restringir</secondary><tertiary>transferencia de ficheros</tertiary></indexterm>
<indexterm><primary>Taylor UUCP</primary><secondary>transferencia de ficheros</secondary></indexterm>
Taylor UUCP también le permite ajustar las transferencias de ficheros con un
gran detalle. De manera extrema, puede desactivar las transferencias hacia y 
desde un sistema en particular. Simplemente configure
<systemitem role="keyword">request</systemitem> como <systemitem
role="keyword">no</systemitem>, y el sistema remoto no podrá ni descargar
ficheros de su sistema ni enviarle fichero alguno. De manera similar, puede
prohibir a sus usuarios que transfieran ficheros hacia o desde un sistema
configurando <systemitem
role="keyword">transfer</systemitem> como <systemitem
role="keyword">no</systemitem>. De manera predeterminada, se permite a los 
usuarios de los sistemas local y remoto tanto cargar como descargar ficheros.
</para>

<para>
Además, puede configurar hacia y desde qué directorios pueden copiarse
ficheros. Normalmente querrá restringir el acceso desde los sistemas remotos
a una jerarquía de un único directorio, pero permitiendo a sus usuarios el
envío de ficheros desde sus directorios de usuario. Comúnmente, se permite
a los usuarios remotos recibir ficheros sólo desde el directorio UUCP público
<filename>/var/spool/uucppublic</filename>.  Éste es el lugar tradicional
donde poner los ficheros disposición pública, de manera similar a los 
servidores FTP en Internet.
<footnote id="X-087-2-uucp-FNUU13"><para> Puede usar una
tilde (<literal>~</literal>) para referirse al directorio público de UUCP,
pero sólo en los ficheros de configuración de UUCP; fuera de ellos suele
traducirse en el directorio principal del usuario.
</para>
</footnote>
</para>

<para>
Taylor UUCP ofrece cuatro órdenes diferentes para configurar
los directorios de envío y recepción de ficheros. Se trata de:
<command>local-send</command>, que especifica la lista de
directorios desde los que un usuario puede solicitar a UUCP que envíe ficheros; 
<command>local-receive</command>, que proporciona una lista de
directorios desde los que un usuario puede solicitar recibir ficheros; y
<command>remote-send</command> y <command>remote-receive</command>, 
que se comportan de manera análoga desde un sistema externo. Observe el
siguiente ejemplo:

<screen>
system          pablo
...
local-send      /home ~
local-receive   /home ~/receive
remote-send     ~ !~/incoming !~/receive
remote-receive  ~/incoming
</screen>
</para>

<para>
La orden <command>local-send</command> permite a los usuarios de su máquina
enviar cualquier fichero bajo <filename>/home</filename> y desde el directorio
público de UUCP hacia <systemitem role="sitename">pablo</systemitem>. 
La orden <command>local-receive</command> les permite entonces recibir tanto
en el directorio
<filename>receive</filename> de
<filename>uucppublic</filename> en el que cualquiera puede escribir,
o en cualquier fichero con permisos de escritura universal bajo
<filename>/home</filename>. La directiva <command>remote-send</command>
permite a <systemitem role="sitename">pablo</systemitem> solicitar ficheros
desde <filename>/var/spool/uucppublic</filename>, excepto los de los
directorios <filename>incoming</filename> y <filename>receive</filename>.
Esto se le señala a <command>uucico</command> precediendo los nombres de los
directorios con signos de exclamación. Finalmente, la última línea permite a
<systemitem role="sitename">pablo</systemitem> subir ficheros a
<systemitem role="sitename">incoming</systemitem>.
</para>

<para>
Uno de los mayores problemas con la transferencia de ficheros usando UUCP
es que sólo recibe ficheros en los directorios con permiso de escritura
universal.  Esto puede tentar a algunos usuarios a poner trampas para otros
usuarios, etc.  Sin embargo, no hay salida a este problema excepto la
desactivación total de la transferencia de ficheros por UUCP.
</para>

</sect2>

<sect2><title>Reenviar</title>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>restringir</secondary><tertiary>reenvío</tertiary></indexterm>
<indexterm><primary>Taylor UUCP</primary><secondary>reenviar</secondary></indexterm>
UUCP ofrece un mecanismo para que otros sistemas lleven a cabo transferencias
de ficheros por usted. Por ejemplo, suponga que su sistema tiene acceso por
<command>uucp</command> a un sistema llamado 
<systemitem role="sitename">seci</systemitem>, pero no a otro sistema llamado 
<systemitem role="sitename">uchile</systemitem>. Esto le permite hacer que 
<systemitem role="sitename">seci</systemitem> descague un fichero
desde <systemitem role="sitename">uchile</systemitem> por usted y se lo
envíe a su sistema. La siguiente orden lograría esto:

<screen>
$ <userinput>uucp -r seci!uchile!~/find-ls.gz ~/uchile.files.gz</userinput>
</screen>
</para>

<para>
A esta técnica de pasar una tarea a través de muchos sistemas se la conoce
como <emphasis>reenvío</emphasis>. En su propio sistema UUCP,
querrá limitar el servicio de reenvío a unas pocas máquinas en las que confíe
para no acabar con una monstruosa factura telefónica tras descargar por ellas
las fuentes de la última versión de X11R6.
</para>

<para>
De manera predeterminada, Taylor UUCP prohibe el reenvío. Para habilitar
el reenvío en un sistema en particular, puede usar la orden
<command>forward</command>. Esta orden especifica una lista de sitios hacia
o desde los que el sistema puede solicitarle reenviar tareas. Por ejemplo,
el administrador UUCP de <systemitem
role="sitename">seci</systemitem> tendría que añadir las siguientes líneas
al fichero <filename>sys</filename> para permitir a <systemitem
role="sitename">pablo</systemitem> solicitar ficheros desde <systemitem
role="sitename">uchile</systemitem>:

<screen>
####################
# pablo
system          pablo
...
forward         uchile
####################
# uchile
system          uchile
...
forward-to      pablo
</screen>
</para>

<para>
La entrada <systemitem role="keyword">forward-to</systemitem> para
<systemitem role="sitename">uchile</systemitem> es necesaria para que
cualquier fichero devuelto por él se pase realmente a
<systemitem role="sitename">pablo</systemitem>. De otra manera, UUCP se
desharía de ellos. Esta entrada usa una variación de la orden
<command>forward</command> que permite a
<systemitem role="sitename">uchile</systemitem> enviar ficheros sólo a
<systemitem role="sitename">pablo</systemitem> a través de
<systemitem role="sitename">seci</systemitem> y no a la inversa.
</para>

<para>
Para permitir el reenvío a cualquier sistema, use la palabra clave especial
<systemitem role="keyword">ANY</systemitem> (las mayúsculas son necesarias).
</para>

</sect2>

</sect1>

<sect1 id="X-087-2-uucp.dialin"><title>Configuración de su sistema para recibir llamadas</title>

<para>
<indexterm id="idx-UUCPconfigureasserver-1" class="startofrange"><primary>Taylor UUCP</primary><secondary>configurar como servidor</secondary></indexterm>
<indexterm><primary>Taylor UUCP</primary><secondary>recibir llamadas</secondary></indexterm>
<indexterm id="idx-serverUUCP-1" class="startofrange"><primary>servidores</primary><secondary>UUCP</secondary></indexterm>
Si quiere configurar su sitio para recibir llamadas tendrá que permitir 
conexiones por su puerto serie y personalizar algunos ficheros del sistema
para ofrecer cuentas UUCP, lo que cubriremos en esta sección.
</para>

<sect2 id="X-087-2-uucp.dialin.accounts"><title>Proporcionar cuentas UUCP</title>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>cuentas</secondary></indexterm>
<indexterm><primary>Taylor UUCP</primary><secondary>configurar entradas</secondary></indexterm>
A continuación tiene que configurar las cuentas de usuarios que permiten
a sistemas remotos entrar en su sistema y establecer una conexión de UUCP.
Generalmente tendrá que suministrar un nombre de usuario para cada sistema
que se conecte con usted.  Cuando configura una cuenta para el sistema
<systemitem role="sitename">pablo</systemitem>, puede darle el nombre de 
usuario <systemitem role="userid">Upablo</systemitem>. No hay ninguna política
sobre los nombres de entrada; pueden ser cualquier cosa, pero le convendrá
que el nombre de entrada pueda relacionarse fácilmente con el nombre del sitio
remoto.
</para>

<para>
Para los sistemas que se conectan con el suyo a través de puerto serie,
normalmente tendrá que añadir estas cuentas al fichero de contraseñas del
sistema <filename>/etc/passwd</filename>. Una buena práctica es poner todas
las entradas de UUCP en un grupo especial como <systemitem
role="userid">uuguest</systemitem>. El directorio principal de la cuenta
debería configurarse como el directorio público de la cola 
<filename>/var/spool/uucppublic</filename>&thinsp;; su intérprete de órdenes
de entrada debe ser <command>uucico</command>.
</para>

<para>
<indexterm><primary SORTAS="etc/inetd.conf file">fichero /etc/inetd.conf</primary></indexterm>
Para servir a sistemas UUCP que se conecten con su sitio sobre TPC, tendrá
que configurar <command>inetd</command> de forma que gestione las conexiones
entrantes por el puerto <systemitem role="keyword">uucp</systemitem> 
añadiendo la siguiente línea a su
<filename>/etc/inetd.conf</filename>&thinsp;:<footnote
id="X-087-2-FNUU14"><para> Tenga en cuenta que <command>tcpd</command> 
normalmente tiene el modo 700, por lo que debe invocarlo como usuario <systemitem role="userid">root</systemitem>, no <systemitem
role="userid">uucp</systemitem>. <command>tcpd</command> se discute con mayor
detalle en <xref linkend="X-087-2-appl">.
</para>
</footnote>

<screen>
uucp   stream  tcp   nowait  root  /usr/sbin/tcpd  /usr/lib/uucp/uucico -l
</screen>
</para>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>fichero passwd</secondary></indexterm>
<indexterm><primary sortas="usr/lib/uucp/passwd file">fichero /usr/lib/uucp/passwd</primary></indexterm> 
<?troff .ffn>
La opción <option>&ndash;l</option> hace que <command>uucico</command> lleve
a cabo su propia autorización de entrada. Solicitará un nombre de entrada y
una contraseña igual que el programa <command>login</command> estándar, pero
basándose en su propia base de datos privada con las claves en vez de en
<filename>/etc/passwd</filename>. Este fichero privado de contraseñas se
conoce como <filename>/etc/uucp/passwd</filename> y contiene pares de nombres
de entrada y contraseñas:

<screen>
Upablo  IslaNegra
Ulorca  co'rdoba
</screen>
</para>

<para>
Este fichero tiene que ser propiedad de
<systemitem role="userid">uucp</systemitem> y tener 600 como permiso.
</para>

<para>
<indexterm><primary>programa mgetty</primary></indexterm>
¿Le parece esta base de datos una idea tan buena que le gustaría en las 
entradas al sistema por serie también? Bien, en algunos casos puede hacerlo.
Lo que necesita es un programa <command>getty</command> al que pueda pedirle
que invoque a <command>uucico</command> en vez de a
<command>/bin/login</command> para sus usuarios UUCP.
<footnote id="X-087-2-FNUU15"><para>
El <command>mgetty</command> de Gert Doering es una bestia de esa calaña. 
Corre sobre varias plataformas, incluyendo SCO Unix, AIX, SunOS, HP-UX y
GNU/Linux.
</para>
</footnote> La invocación de
<command>uucico</command> sería de esta forma:

<screen>
/usr/lib/uucp/uucico -l -u <replaceable>usuario</replaceable>
</screen>

La opción <option>&ndash;u</option> le dice que use el nombre de usuario
especificado en vez de preguntarlo.<footnote id="X-087-2-FNUU16"><para>
Esta opción no se encuentra presente en la versión 1.04.
</para>
</footnote>

</para>

<para>
Para proteger a sus usuarios de UUCP de otros que den un nombre de sistema
falso y les lean todo el correo, tiene que añadir órdenes
<command>called-login</command> a cada entrada de sistema en el fichero 
<filename>sys</filename>. Esto se describe en la sección siguiente.
</para>

</sect2>

<sect2 id="X-087-2-uucp.security.called-login"><title>Protegerse uno mismo de los estafadores</title>

<para>
<indexterm id="idx-UUCPloginsecurity-1" class="startofrange"><primary>Taylor UUCP</primary><secondary>seguridad de entrada</secondary></indexterm>
<indexterm id="chuu.uucp.security" class="startofrange"><primary>UUCP</primary><secondary>seguridad</secondary></indexterm> 
Uno de los mayores problemas con UUCP es que el sistema que nos llama
puede mentir acerca de su nombre;  comunica su nombre al sistema que llama
después de entrar, pero el servidor no tiene manera de comprobarlo.  Por
consiguiente, un atacante podría entrar con su propia cuenta de UUCP,
pretender ser otra persona, y coger el correo de esa otra persona.  Esto
representa un grave problema, especialmente si usted ofrece entrada mediante
UUCP anónimo, que tiene una clave pública.
</para>
<?troff .Nd 10>

<para>
Usted <emphasis>debe</emphasis> protegerse de estos impostores. La cura
de esta enfermedad va a requerir que cada sistema un nombre de entrada en
particular especificando un
<systemitem role="keyword">called-login</systemitem> en
<filename>sys</filename>. Una entrada de sistema de ejemplo sería algo así:

<screen>
system          pablo
... usual options ...
called-login    Upablo
</screen>
</para>

<para>
La ventaja es que cuando un sistema entre y finja ser
<systemitem role="sitename">pablo</systemitem>,
<command>uucico</command> comprobará si ha entrado como
<systemitem role="userid">Upablo</systemitem>. De no ser así, se desconectará
al sistema que haya llamado. Debería acostumbrarse a añadir la orden
<command>called-login</command> a cada entrada de sistema que añada a su
fichero <filename>sys</filename>. Es importante que haga esto
en <emphasis>todos</emphasis> los sistemas de su fichero
<command>sys</command>, independientemente de si van a llamar a su sistema
o no. Para los sitios que nunca le llamen, probablemente debería asignar
<systemitem role="keyword">called-login</systemitem> a algún nombre de 
usuario totalmente ficticio, como <systemitem role="userid">nuncaentras</systemitem>.
</para>

</sect2>

<sect2><title>Sea un paranoico: comprobación de la secuencia de llamadas</title>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>comprobación de la secuencia de llamadas</secondary></indexterm>
Otra manera de detectar y rechazar a los impostores es usar <command>comprobaciones de la secuencia de llamada</command>. Éstas le ayudan a protegerse de 
intrusos que hayan logrado averiguar de alguna manera una contraseña con la
que entrar a su sistema UUCP.
</para>

<para>
Cuando usa comprobación de secuencia de llamadas, ambas máquinas mantienen
una cuenta del número de conexiones establecidas hasta el momento.  Se
incrementa con cada conexión.  Después de entrar, el llamador envía su
número de secuencia de llamadas y el sistema llamado lo comprueba con su
propio número.  Si no son iguales, el intento de conexión es rechazado.  Si
el número inicial se elige aleatoriamente, los atacantes lo tendrán más
dificil para adivinar el número de secuencia de llamadas correcto.
</para>

<para>
Pero la comprobación de la secuencia de llamada sirve para más que esto:
aunque una persona muy inteligente descubriese su número de secuencia de
llamada así como su clave, usted sabrá que esto ha ocurrido.  Cuando el
atacante llama al sistema de UUCP que le provee el correo a usted
y roba su correo, esto incrementa el número de secuencia de llamada en uno.
La siguiente vez que <emphasis>usted</emphasis> se conecte con su proveedor 
de correo e intenta entrar, el <command>uucico</command> remoto le rechazará, 
porque los números de secuencia ya no son iguales.
</para>

<para>
Si ha activado la comprobación de las secuencias de llamadas, debería mirar
sus ficheros de registro de manera regular en busca de mensajes de error
que apunten a posibles ataques. Si su sistema rechaza el número de secuencias
de llamadas que le ofrece el sistema que llama, <command>uucico</command>
pondrá un mensaje en el fichero de registro diciendo algo como
&ldquo;Out of sequence call rejected.&rdquo; (Llamada fuera de secuencia
rechazada). Si su sistema es rechazado por quien le suministra porque los 
números de la secuencia no están sincronizados, pondrá un mensaje diciendo 
&ldquo;Handshake failed (RBADSEQ)&rdquo; (Negociación fallida (RBADSEQ)).
</para>

<para>
Para activar la comprobación de secuencias de llamada, añada la siguiente
orden a la entrada del sistema:

<screen>
# activar comprobación de secuencias de llamada
sequence        true
</screen>
</para>

<para>
<indexterm><primary SORTAS="Sequence file">Fichero .Sequence</primary></indexterm>
Además, tiene que crear el fichero que contiene el número de secuencias en sí.
Taylor UUCP guarda el número de secuenciasen un fichero llamado
<filename>.Sequence</filename> en el directorio de cola del sitio remoto.
<emphasis>Debe</emphasis> ser propiedad de <systemitem
role="userid">uucp</systemitem> y debe estar en modo 600 (esto es, sólo
<systemitem role="userid">uucp</systemitem> puede leerlo y modificarlo). Lo
mejor es inicializar este fichero con un valor que ambas partes hayan acordado
previamente. Una manera sencilla de crear este fichero es:

<screen>
# <userinput>cd /var/spool/uucp/pablo</userinput>
# <userinput>echo 94316 > .Sequence</userinput>
# <userinput>chmod 600 .Sequence</userinput>
# <userinput>chown uucp.uucp .Sequence</userinput>
</screen>
</para>

<para>
Evidentemente, el sitio remoto tiene que habilitar igualmente la comprobación
de secuencias de llamadas y comenzar usando exactamente el mismo número de
secuencia.
</para>

<indexterm class="endofrange" startref="idx-UUCPloginsecurity-1">
<indexterm class="endofrange" startref="chuu.uucp.security"> 

<indexterm class="endofrange" startref="idx-serverUUCP-1">
<indexterm class="endofrange" startref="idx-securityUUCP-1">
<indexterm class="endofrange" startref="idx-accessUUCP-1">

</sect2>

<sect2><title>UUCP anónimo</title>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>anónimo</secondary></indexterm>
<indexterm><primary>UUCP anónimo</primary></indexterm>
<indexterm><primary>UUCP</primary><secondary>anónimo</secondary></indexterm>
Si quiere ofrecer acceso a su sistema por UUCP anónimo primero tendrá que
configurar una cuenta especial para ello como se describe anteriormente.
Una práctica común es proporcionar a la cuenta anónima 
<systemitem role="userid">uucp</systemitem> como nombre de entrada y 
contraseña.
</para>

<para>
Además, tiene que configurar unas pocas opciones de seguridad para sistemas
desconocidos. Por ejemplo, puede querer prohibir que ejecuten cualquier orden
en su sistema. De todas maneras, no puede ajustar estas variables en una 
entrada del fichero <filename>sys</filename> porque la orden 
<command>system</command> requiere el nombre del sistema, que usted no tiene.
Taylor UUCP resuelve este dilema mediante la orden
<command>unknown</command>. <command>unknown</command> puede usarse en el
fichero <filename>config</filename> para especificar cualquier orden que pueda
aparecer de manera habitual en una entrada de sistema:

<screen>
unknown         remote-receive ~/incoming
unknown         remote-send ~/pub
unknown         max-remote-debug none
unknown         command-path /usr/lib/uucp/anon-bin
unknown         commands rmail
</screen>
</para>

<para>
Esto restringirá la descarga de ficheros desde sistemas desconocidos 
bajo el directorio
<filename>pub</filename> y la carga de ficheros en el directorio
<filename>incoming</filename> bajo
<filename>/var/spool/uucppublic</filename>. La próxima línea hará que
<command>uucico</command> ignore cualquier petición desde el sistema remoto
para activar la depuración localmente. Las dos últimas líneas permiten a 
sistemas descnocidos ejecutar <command>rmail</command>&thinsp;; pero la ruta
especificada hace que <command>uucico</command> busque la orden
<command>rmail</command> únicamente en un directoro privado llamado 
<filename>anon-bin</filename>. Esta restricción le permite ofrecer un
<command>rmail</command> que, por ejemplo, reenvíe todo el correo al 
superusuario para que lo examine. Esto permite a los usuarios anónimos ponerse
en contacto con el administrador del sistema previniéndoles al mismo tiempo
de inyectar correo en otros sitios.
</para>

<para>
Para habilitar el UUCP anónimo debe especificar al menos una sentencia
<systemitem role="keyword">unknown</systemitem> en
<filename>config</filename>. De otra manera <command>uucico</command> 
rechazará todos los sistemas desconocidos.
</para>

<indexterm class="endofrange" startref="idx-UUCPconfigureasserver-1">

</sect2>
</sect1>

<sect1 id="X-087-2-uucp.protocols"><title>Protocolos UUCP de bajo nivel</title>

<para>
<indexterm id="idx-UUCPprotocol-1" class="startofrange"><primary>UUCP</primary><secondary>protocolos</secondary></indexterm>
Para negociar el control de la sesión y las transferencias de ficheros con
el sistema remoto, <command>uucico</command> usa un grupo de mensajes estándar.
Esto es lo que se llama normalmente <command>protocolo de alto nivel</command>.
Durante la fase de inicialización y la fase de desconexión éstos se envían
simplemente como cadenas de caracteres.  Sin embargo, durante la fase de 
transferencia, se usa también un protocolo de bajo nivel, que resulta
transparente para los niveles superiores. De esta manera es posible
comprobar errores cuando se usan líneas poco fiables, por ejemplo.
</para>

<sect2><title>Descripción del protocolo</title>

<para>
<indexterm><primary>protocolos</primary><secondary>UUCP</secondary></indexterm>
Dado que UUCP se usa sobre diferentes tipos de conexiones, como líneas
serie, TCP, o incluso X.25, es preciso usar protocolos de bajo nivel
específicos.  Además, varias implementaciones de UUCP han introducido
diferentes protocolos para hacer lo mismo.
</para>

<para>
Los protocolos se pueden dividir en dos categorías:  de flujo
<command>streaming</command> y por <command>paquetes</command>. La primera 
clase de protocolos transfiere un fichero entero, posiblemente calculando una 
suma de comprobación.  Esto apenas supone un gasto extra de tiempo, 
pero precisa una conexión fiable, porque cualquier error causaría que todo el 
fichero tenga que volver a ser enviado.
Estos protocolos se suelen usar sobre conexiones de TCP, pero no
sobre líneas telefónicas.  Aunque los modems modernos hacen un
buen trabajo corrigiendo errores, no son perfectos, y tampoco lo es la
detección de errores entre el ordenador y el módem.
</para>

<para>
Por otra parte, los protocolos por paquetes parten el fichero en varias
partes de igual tamaño.  Cada paquete se envía y recibe por separado,
se realiza una suma de comprobación, y se devuelve al origen un
paquete de confirmación.
Para que sea más eficiente, se inventaron protocolos de ventanas deslizantes, 
que permiten un número limitado (una ventana) de paquetes sin esperar 
confirmación en un momento dado.  Esto reduce considerablemente la cantidad de 
tiempo que <command>uucico</command> tiene que esperar durante una transmisión.
Aún así, todos los cálculos extra necesarios en comparación a un protocolo de 
flujo hace que los protocolos de paquetes sean ineficientes sobre TCP pero 
ideales para las líneas telefónicas.
</para>

<para>
El caudal del flujo de datos también supone una diferencia. A veces enviar 
caracteres de 8 bits sobre una conexión serie puedes resultar imposible; por
ejemplo, si la conexión atraviesa un estúpido servidor de terminales que se
deshace del octavo bit. Cuando transmite caracteres de 8 bits sobre una 
conexión de 7 bits tienen que codificarse. En el peor caso posible, la
codificación duplica la cantidad de datos a transmitir aunque la compresión 
por hardware pueda compensarlo. Las líneas por las que se pueden transmitir 
caracteres de 8 bits arbitrarios suelen llamarse <emphasis>preparadas para 8 
bits</emphasis>. Éste es el caso de todas las conexiones por TCP, así como de 
la mayoría de las conexiones por módem.
</para>

<para>
Taylor UUCP 1.06 soporta una amplia variedad de protocolos UUCP. Los más 
comunes son éstos:

<variablelist>
<varlistentry><term><emphasis>g</emphasis></term>
<listitem><para>
Éste es el protocolo más común y deberían entenderlo prácticamente todos los
<command>uucico</command>s. Al estar dotado de una potente comprobación de 
errores resulta especialmente apropiado para conexiones telefónicas con
interferencias. <emphasis>g</emphasis> requiere una conexión preparada para 
8 bits. Es un protocolo orientado a paquetes que usa una técnica de ventana
deslizante.
</para></listitem>
</varlistentry>

<varlistentry><term><emphasis>i</emphasis></term>
<listitem><para>
Éste es un protocolo de paquete bidireccionales por el que pueden enviar y
recibirse ficheros al mismo tiempo. Requiere una conexión full-duplex y un
flujo de datos preparado para 8 bits. Actualmente sólo lo entiende Taylor
UUCP.
</para></listitem>
</varlistentry>

<varlistentry><term><emphasis>t</emphasis></term>
<listitem><para>
Este protocolo está pensado para usarse sobre una conexión TCP u otras redes
realmente libres de errores. Usa paquetes de 1.024 bytes y requiere una 
conexión preparada para 8 bits.
</para></listitem>
</varlistentry>

<varlistentry><term><emphasis>e</emphasis></term>
<listitem><para>
<?troff .hw connections>
Éste debería hacer básicamente lo mismo que <emphasis>t</emphasis>. La 
principal diferencia reside en que <emphasis>e</emphasis> es un protocolo
de flujo por lo que está orientado únicamente a conexiones de red eficientes.
</para></listitem>
</varlistentry>

<varlistentry><term><emphasis>f</emphasis></term>
<listitem><para>
Este protocolo está orientado a conexiones X.25 eficientes. Es un protocolo de
flujo y espera un flujo de datos de 7 bits. Los caracters de 8 bits tienen que
codificarse, lo que puede hacerlo muy poco eficiente.
</para></listitem>
</varlistentry>

<varlistentry><term><emphasis>G</emphasis></term>
<listitem><para>
Ésta es la versión 4 System V del protocolo <emphasis>g</emphasis>. También
lo entienden otras versiones de UUCP.
</para></listitem>
</varlistentry>

<varlistentry><term><emphasis>a</emphasis></term>
<listitem><para>
Este protocolo es similar al ZMODEM. Requiere una conexión de 8 bits pero
codifica ciertos caracterse de control como XON y XOFF.
</para></listitem>
</varlistentry>
</variablelist>
</para>

</sect2>

<sect2><title>Afinar el protocolo de transmisión</title>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>protocolos</secondary><tertiary>afinar</tertiary></indexterm>
Todos los protocolos permiten alguna variación en el tamaño de los paquetes,
el cronómetro y similares.  Usualmente, los valores por omisión funcionan
bien, pero puede no ser óptimo para su configuración.  El protocolo 
<emphasis>g</emphasis>, por ejemplo, usa tamaños de ventanas de 1 a 7, y 
tamaños de paquetes en potencias de 2 desde 64 a 4096. Si su línea telefónica 
es tan ruidosa que ignora el 5 por ciento de los paquetes, probablemente 
debería disminuir el tamaño de los paquetes y de la ventana.  Sin embargo, en 
líneas de teléfono muy buenas el hecho de enviar acuses de recibo por cada 
128 bytes puede resultar un desperdicio, así que podría incrementar el tamaño 
de los paquetes a 512 o incluso 1024. La mayoría de los binarios que se 
incluyen en las distribuciones de Linux usan de manera predeterminada un
tamaño de ventana 7 y paquetes de 128 bytes.
</para>

<para>
Taylor UUCP le permite ajustar los parámetros con la orden 
<command>protocol-parameter</command> en el fichero
<filename>sys</filename>. Por ejemplo, para ajustar el tamaño de paquete a 512
en el protocolo <emphasis>g</emphasis> cuando se hable con
<systemitem role="sitename">pablo</systemitem>, tendrá que añadir:

<screen>
system          pablo
...
protocol-parameter g  packet-size  512
</screen>
</para>

<para>
Los parámetros configurables y sus nombres varian de un protocolo a otro. Para
una lista completa de ellos acuda a la documentación que acompaña a las 
fuentes de Taylor UUCP.
</para>

</sect2>

<sect2><title>Elegir protocolos específicos</title>

<para>
<indexterm><primary>UUCP</primary><secondary>protocolos</secondary><tertiary>selección</tertiary></indexterm>
No todas las implementaciones de <command>uucico</command> son capaces de
comunicarse por medio de todos los protocolos, por lo que durante la fase de
negociación inicial ambos procesos tienen que ponerse de acuerdo en la
elección de un protocolo común. El <command>uucico</command> maestro
proporciona al esclavo una lista de protocolos soportados enviándole
<literal>P</literal><replaceable>protlist</replaceable>, de la cual el esclavo
elegirá uno.
</para>

<para>
Basándose en el tipo de puerto usado (módem, TCP o conexión directa)
<command>uucico</command> compondrá una lista de protocolos predeterminados.
Para la conexión directa o por módem esta lista suele constar de
<emphasis>i</emphasis>, <emphasis>a</emphasis>,
<emphasis>g</emphasis>, <emphasis>G</emphasis> y
<emphasis>j</emphasis>.  Para las conexiones por TCP la lista suele ser
<emphasis>t</emphasis>, <emphasis>e</emphasis>,
<emphasis>i</emphasis>, <emphasis>a</emphasis>,
<emphasis>g</emphasis>, <emphasis>G</emphasis>,
<emphasis>j</emphasis> y <emphasis>f</emphasis>. Puede sobreescribrir esta
lista predeterminada con la orden <command>protocols</command>, que puede 
especificarse en una entrada de sistema así como en una entrada de puerto.
Por ejemplo, puede editar la entrada de su módem en el fichero
<filename>port</filename> de esta manera:

<screen>
port            serial1
...
protocols       igG
</screen>
</para>

<para>
Esto requerirá que cualquier conexión entrante o saliente por este puerto use
<emphasis>i</emphasis>, <emphasis>g</emphasis> o <emphasis>G</emphasis>. Si
el sistema remoto no soporta ninguno de éstos la negociación fallará.
</para>

<indexterm class="endofrange" startref="idx-UUCPprotocol-1">
</sect2>
</sect1>

<sect1 id="X-087-2-uucp.misc.faq"><title>Resolución de problemas</title>

<para>
<indexterm><primary>UUCP</primary><secondary>resolución de problemas</secondary></indexterm>
En esta sección se describe lo que puede ir mal con su conexión UUCP y se 
sugieren lugares donde corregir el error. Aunque estos problemas suelen 
aparecer con frecuencia hay muchas más cosas que pueden fallar de las que
hemos listado.
</para>

<para>
<indexterm><primary>UUCP</primary><secondary>comprobar</secondary></indexterm>
Si tiene algún problema active la depuración con <option>&ndash;xall</option>,
y mire la salida de <filename>Debug</filename> en el directorio de cola.
Este fichero debería ayudarle a reconocer rápidamente el problema. A menudo
resulta de ayuda activar el altavoz del módem cuando no se conecta.
Con módems compatibles con Hayes puede activar el altavoz añadiendo
<literal>ATL1M1 OK</literal> al diálogo de módem en el fichero
<filename>dial</filename>.
</para>

<para>
La primera comprobación debería ser siempre si todos los permisos de ficheros
son los correctos. <command>uucico</command> debería ser setuid <systemitem
role="userid">uucp</systemitem> y todos los ficheros de
<filename>/usr/lib/uucp</filename>,
<filename>/var/spool/uucp</filename> y
<filename>/var/spool/uucppublic</filename> debería tener a 
<systemitem role="userid">uucp</systemitem> como propietario. Hay también
algunos ficheros ocultos en el directorio de cola de los que <systemitem
role="userid">uucp</systemitem> debe ser propietario igualmente.<footnote
id="X-087-2-FNUU17"><para> Es decir, con nombres que empiezan con un punto.
Esos ficheros no suele mostrarlos la orden <command>ls</command>.
</para>
</footnote>
</para>

<para>
Cuando esté seguro de que los permisos de todos los ficheros son los correctos
y siga teniendo problemas podrá empezar entonces a interpretar los mensajes
de error de una manera más literal. Echaremos ahora un vistazo a los problemas
y errores más comunes.
</para>

<sect2><title>uucico sigue diciendo &ldquo;Wrong Time to Call&rdquo;</title>
<para>
Esto probablemente signfica que en la entrada de sistema en 
<filename>sys</filename> no especificó una orden <command>time</command> 
que determina cuándo se puede llamar al sistema remoto o especificó unas
horas que en realidad prohíben llamar en ese momento. Si no se especifica
cuándo se puede llamar <command>uucico</command> asume que nunca se puede
llamar al sistema.
</para>

</sect2>

<sect2><title>uucico se queja de que el sistema ya está en uso</title>

<para>
Esto significa que <command>uucico</command> detecta un fichero de bloqueo
para el sistema remoto en <filename>/var/spool/uucp</filename>. El fichero
de bloqueo puede provenir de una llamada anterior al sistema que hubiese 
fallado o se hubiera interrumpido. Otra posible explicación es que hubiera otro
proceso <command>uucico</command> intentando llamar al sistema remoto y se
hubiese atascado en una macro de diálogo o se hubiese detenido por cualquier
otra razón.
</para>

<para>
Para corregir este error mate todos los procesos <command>uucico</command>
abiertos para el sitio con una señal hangup y elimine todos los ficheros de
bloqueo que hayan podido dejar.
</para>

</sect2>

<sect2><title>Puede conectar con el sistema remoto pero falla la macro de diálogo</title>
<para>
Mire el texto que recibe del sistema remoto.  Si está salteado, esto
puede ser un problema relacionado con la velocidad.  Si no, confirme que
realmente envía lo que su macro de diálogo espera recibir.  Recuerde,
la macro de diálogo empieza con una cadena de caracteres esperada.  Si usted
recibe la invitación de entrada al sistema (login), después
envía su nombre pero luego no se le pregunta por la clave de
acceso, inserte un retraso antes de enviarlo, o
incluido entre las letras.  Puede ser que usted sea demasiado rápido para su
módem.
</para>

</sect2>

<sect2><title>Su módem no marca</title>
<para>
Si su módem no indica que la línea DTR se ha levantado al hacer
<command>uucico</command> una llamada, posiblemente no le ha especificado
el dispositivo correcto a <command>uucico</command>. Si su módem reconoce
DTR, compruebe un programa de terminal que puede enviar órdenes al módem.
Si esto funciona, active el eco con la orden <systemitem
role="keyword">\E</systemitem> al comienzo del diálogo del módem. Si el
módem no genera el eco de las órdenes durante el diálogo compruebe que la
velocidad de su línea no sea demasiado alta o baja. Si ve el eco, compruebe
que no haya desacticado la respuesta del módem o la haya configurado como
un código numérico. Verifique que la macro de diálogo en sí misma sea válida.
Recuerde que tiene que escribir dos barras invertidas para enviar una al
módem.
</para>

</sect2>

<sect2><title>Su módem intenta marcar pero no lo consigue</title>
<para>
Inserte una pausa en el número de teléfono, especialmente si tiene que marcar
una secuencia especial para obtener el acceso a una línea exterior desde una
red telefónica corporativa. Asegúrese de estar usando el tipo de marcado 
correcto, ya que algunas redes telefónicas sólo soportan un tipo de marcado.
De manera adicional, compruebe un par de veces el número de teléfono para
asegurarse de que es el correcto.
</para>

</sect2>

<sect2><title>Se entra con éxito pero falla la negociación</title>
<para>
Esta situación puede deberse a diversos problemas. Debería poder obtener 
bastante información de la salida del fichero de registro. Mire qué protocolos
ofrece el sitio remoto (envía una cadena <literal>P</literal>
<replaceable>protlist</replaceable> durante la negociación). Para que la 
negociación se lleve a cabo con éxito ambas máquinas deben soportar al menos
un protocolo común, así que compruebe que efectivamente esto sea así.
</para>

<para>
Si el sistema remoto envía <command>RLCK</command> significa que hay un 
fichero de bloqueo suyo en el sistema remoto. Si no está conectado a él por
otra línea solicite al administrador del sistema remoto que lo elimine.
</para>

<para>
Si el sistema remoto envía <command>RBADSEQ</command>, significa que la 
comprobación de secuencias de llamada está activada para usted pero los
números no coinciden. Si le envía <command>RLOGIN</command> es que no le
permite entrar bajo esa identidad.
</para>

</sect2>

</sect1>

<sect1><title>Ficheros de registro y depuración</title>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>registrar y depurar</secondary></indexterm>
<INDEXTERM><PRIMARY>Fichero de registro (UUCP)</PRIMARY></INDEXTERM>
<INDEXTERM><PRIMARY>ficheros de registro, depurar</PRIMARY></INDEXTERM>
Cuando compile UUCP para registrar los eventos a la Taylor, dispondrá de tres
ficheros globales únicamente, todos ellos bajo el directorio de cola.
El fichero de registro principal es <filename>Log</filename> y contiene toda
la información sobre las conexiones establecidas y los ficheros transferidos.
Un extracto típico podría ser algo como esto (tras formatearlo un poco para
que quede bien en la página):

<screen>
uucico pablo - (1994-05-28 17:15:01.66 539) Calling system pablo (port cua3)
uucico pablo - (1994-05-28 17:15:39.25 539) Login successful
uucico pablo - (1994-05-28 17:15:39.90 539) Handshake successful
               (protocol 'g' packet size 1024 window 7)
uucico pablo postmaster (1994-05-28 17:15:43.65 539) Receiving D.pabloB04aj
uucico pablo postmaster (1994-05-28 17:15:46.51 539) Receiving X.pabloX04ai
uucico pablo postmaster (1994-05-28 17:15:48.91 539) Receiving D.pabloB04at
uucico pablo postmaster (1994-05-28 17:15:51.52 539) Receiving X.pabloX04as
uucico pablo postmaster (1994-05-28 17:15:54.01 539) Receiving D.pabloB04c2
uucico pablo postmaster (1994-05-28 17:15:57.17 539) Receiving X.pabloX04c1
uucico pablo - (1994-05-28 17:15:59.05 539) Protocol 'g' packets: sent 15,
                resent 0, received 32
uucico pablo - (1994-05-28 17:16:02.50 539) Call complete (26 seconds)
uuxqt pablo postmaster (1994-05-28 17:16:11.41 546) Executing X.pabloX04ai
               (rmail okir)
uuxqt pablo postmaster (1994-05-28 17:16:13.30 546) Executing X.pabloX04as
               (rmail okir)
uuxqt pablo postmaster (1994-05-28 17:16:13.51 546) Executing X.pabloX04c1
               (rmail okir)
</screen>
</para>
<?troff .Nd 10>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>estadísticas</secondary></indexterm>
El siguiente fichero de registro importante es <filename>Stats</filename>,
que lista estadísticas de transferencia de ficheros. La sección de <filename>
Stats</filename> correspondiente a la transferencia anterior sería algo
similar a esto (de nuevo, las líneas se han partido para que cuadren en la
página):

<screen>
postmaster pablo (1994-05-28 17:15:44.78)
                  received 1714 bytes in 1.802 seconds (951 bytes/sec)
postmaster pablo (1994-05-28 17:15:46.66)
                  received 57 bytes in 0.634 seconds (89 bytes/sec)
postmaster pablo (1994-05-28 17:15:49.91)
                  received 1898 bytes in 1.599 seconds (1186 bytes/sec)
postmaster pablo (1994-05-28 17:15:51.67)
                  received 65 bytes in 0.555 seconds (117 bytes/sec)
postmaster pablo (1994-05-28 17:15:55.71)
                  received 3217 bytes in 2.254 seconds (1427 bytes/sec)
postmaster pablo (1994-05-28 17:15:57.31)
                  received 65 bytes in 0.590 seconds (110 bytes/sec)
</screen>
</para>

<para>
El tercer fichero es <filename>Debug</filename>. La información de depuración
se escribe aquí. Si usa la depuración asegúrese de que este fichero tenga
el modo de protección 600. Dependiendo del modo de depuración que elija
puede contener el nombre de usuario y la contraseña que use para conectarse
al sistema remoto.
</para>

<para>
<indexterm><primary>Taylor UUCP</primary><secondary>HDB</secondary></indexterm>
Si dispone de herramientas que esperan que sus ficheros de registro estén en 
el formato tradicional que usan las implementaciones de UUCP compatibles con
HDB, también puede compilar Taylor UUCP de forma que genere registros al
estilo HDB. Es simplemente cuestión de activar una opción en tiempo
compilación en el fichero <filename>config.h</filename>.
</para>

<indexterm class="endofrange" startref="idx-UUCP-2">
<indexterm class="endofrange" startref="idx-configuringUUCP-1">
</sect1>
</chapter>

<!--REVISION1:Finalizada sin comentarios-->









