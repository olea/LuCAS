<?xml version='1.0' encoding="ISO-8859-1"?>
<!-- <!DOCTYPE article
  PUBLIC "-//OASIS//DTD DocBook XML V4.1.2//EN"
  "http://www.oasis-open.org/docbook/xml/4.0/docbookx.dtd">
-->
<article lang="es" id="java-y-mas">

<articleinfo>
	<title>Applets de <productname>Java</productname> y Controles <productname>ActiveX</productname></title>
	<date>12 de Marzo de 2002</date>
	<author>
		<firstname>Jorge</firstname>
		<surname>Ferrer</surname>
	</author>
	<author>
		<firstname>Rodrigo</firstname>
		<surname>García</surname>
	</author>
	<abstract>
		<para>Si en el capítulo anterior vimos el cambio radical que sufría el WWW con la inserción de contenido multimedia la revolución llevada a cabo por la tecnología <productname>Java</productname> y los controles <productname>ActiveX</productname> no se queda atrás. Estos dos nuevos elementos permiten, no sólo insertar contenidos activos, sino además llegar a interactuar con el navegante de una manera antes impensable.</para>
	</abstract>
	<editor>
		<firstname>Jorge</firstname>
		<surname>Ferrer</surname>
	</editor>
	<releaseinfo>Versión 1.0</releaseinfo>
	<orgname>Conquista la Web</orgname>
	<legalnotice>
		<para>Copyright Jorge Ferrer y Rodrigo García. Se otorga permiso para copiar, distribuir y/o modificar este documento bajo los términos de la Licencia de Documentación Libre GNU, Versión 1.1 o cualquier otra versión posterior publicada por la Free Software Foundation. Puede consultar una copia de la licencia en: http://www.gnu.org/copyleft/fdl.html</para>
	</legalnotice>
</articleinfo>

<sect1>
	<title><productname>Java</productname> en las Páginas Web.</title>
	<para>Hasta ahora hemos visto una serie de métodos que nos permiten incluir sonido, vídeo y otros contenidos multimedia así como multitud de archivos de diferentes formatos en una página Web. Al insertar alguno de estos objetos conseguimos incluso tener cierta interactividad con el visitante de las páginas y gracias a ellos quedan cubiertas gran parte de nuestras necesidades, pero seguimos teniendo algunas limitaciones. Gracias al lenguaje <productname>Java</productname> podremos insertar contenido multimedia con mucha mayor libertad y, lo que es más importante, conseguiremos interactividad completa con los navegantes.</para>
	<para><productname>Java</productname> es un lenguaje de programación desarrollado por la empresa Sun Microsystems. En la actualidad esta misma empresa se encarga, junto con otras empresas asociadas, de su desarrollo. En la página <productname>Java</productname>.sun.com (figura 11.1) podemos encontrar gran cantidad de recursos relacionados con <productname>Java</productname>, incluyendo tutoriales, libros o código algunos de los cuales se distribuye gratuitamente. Centrándonos en el lenguaje, éste es muy similar a los usados para realizar las aplicaciones que usamos habitualmente en nuestros ordenadores (<productname>Word</productname>, Netscape, <productname>Explorer</productname> o el propio <productname>Windows</productname>). La gran diferencia de <productname>Java</productname> con respecto a otros lenguajes consiste en la posibilidad de hacer pequeños programas y ejecutarlos desde una página Web. Estos programas reciben el nombre de <emphasis>applets</emphasis> Cada día hay más páginas en Internet que los usan consiguiendo lo que hasta hace poco era imposible. En la página de <emphasis>Gamelan</emphasis>(www.Gamelan.com) podemos encontrar gran cantidad relacionada con la tecnología <productname>Java</productname>, en la figura 11.2 podemos ver una muestra de esta página. En una de sus páginas de su nueva ubicación: www.developer.com/directories/pages/dir.<productname>Java</productname>.sites.html nos ofrecen un listado de las mejores Webs que podemos encontrar hoy en día que usen la tecnología <productname>Java</productname>, es muy recomendable visitar alguna de ellas para hacernos una idea real de lo que puede llegar a conseguirse usando este excelente lenguaje.</para>
	<figure label="11.1">
		<title>En la página Web de Sun Microsystems, creadora del lenguaje <productname>Java</productname>, podemos encontrar gran cantidad de documentación y ejemplos de sus posibilidades.</title>
		<graphic fileref="img/fig11-1.png"/>
	</figure>
	<figure label="11.2">
		<title>Gamela es una excelente fuente de recursos <productname>Java</productname> conocida desde hace tiempo. En la actualidad su dirección está en proceso de cambio a: www.developer.com.</title>
		<graphic fileref="img/fig11-2.png"/>
	</figure>
	<para>El conocimiento del lenguaje <productname>Java</productname> se muestra cada vez más importante para todos aquellos programadores de Internet. Más adelante en esta obra abordaremos ampliamente su estudio y aprenderemos a crear nuestras propias aplicaciones y applets. Sin embargo no es necesario conocer este lenguaje para aprovechar sus características en nuestras páginas Web. Existen gran cantidad de applets gratuitos que se distribuyen a través del WWW y que pueden ser usados libremente en nuestras páginas. En esta sección aprenderemos a insertarlos en nuestras páginas y a usarlos adecuadamente para aprovechar las posibilidades de esta nueva tecnología.</para>
	<note>
		<para>La propia compañía Sun Microsystems ha creado una página en la que se muestran ejemplos y se distribuyen gratuitamente gran cantidad de applets. La dirección es: <productname>Java</productname>.sun.com/applets/index.html. Otra forma de buscar applets gratuitos en el WWW consiste en dirigirse al índice Yahoo y buscar la cadena "<productname>Java</productname> applets".</para>
	</note>
</sect1>

<sect1>
	<title>Inserción de Applets <productname>Java</productname>.</title>
	<para>De ahora en adelante consideraremos que ya tenemos un applet, bien porque lo hemos programado nosotros mismos, bien porque estamos usando un applet de distribución gratuita, es hora de aprender a insertarlo en nuestra página Web. Para ello usaremos una nueva etiqueta: <emphasis><sgmltag>APPLET</sgmltag></emphasis>. Esta etiqueta está formada por una instrucción de inicio, <sgmltag>&lt;APPLET&gt;</sgmltag>, y una instrucción de fin, <sgmltag>&lt;/APPLET&gt;</sgmltag>.</para>
	<note>
		<para>La etiqueta <sgmltag>APPLET</sgmltag> fue introducida por Netscape en la versión 2.0 de <productname>Navigator</productname> fruto de un acuerdo con Sun para soportar la tecnología <productname>Java</productname>. Todos sus navegadores posteriores también la soportan. El otro gran navegador, Microsoft Internet <productname>Explorer</productname>, soporta la tecnología <productname>Java</productname> desde la versión 3.0. En cuanto al estándar se refiere, esta etiqueta se incluye en la especificación HTML 3.2, aunque no podemos asegurar que los navegadores posteriores que respetan la norma HTML 3.2 soporten la tecnología <productname>Java</productname>, simplemente entienden la etiqueta, pero no son capaces de ejecutar un applet.</para>
	</note>
	<para>La inserción de un applet en una página es similar a la inserción de una imagen, a lo cual ya estamos muy acostumbrados. Deberemos especificar el archivo donde se encuentra el applet y las dimensiones (anchura y altura) que este debe ocupar en la página. Al igual que ocurría con las imágenes el applet se introducirá en el lugar exacto donde indique su código, si es necesario se insertará entre el texto, pero no pasará a una nueva línea, como sucedía con las marquesinas, si no lo indicamos específicamente (con la etiqueta <sgmltag>&lt;BR&gt;</sgmltag>). Para indicar el archivo en el que se encuentra el applet usaremos el atributo <emphasis><sgmltag>CODE</sgmltag></emphasis> y para especificar la anchura y altura en pixeles usaremos <emphasis><sgmltag>WIDTH</sgmltag></emphasis> y <emphasis><sgmltag>HEIGHT</sgmltag></emphasis> respectivamente. En resumen, para insertar un applet debemos usar el siguiente código en cualquier lugar de la página:</para>
	<programlisting>
		&lt;APPLET CODE="nombre_applet.class" WIDTH="ancho" HEIGHT="alto"&gt;
		&lt;/APPLET&gt;
	</programlisting>
	<para>Los tres atributos que hemos usado deben incluirse <emphasis>obligatoriamente</emphasis> siempre que insertemos un applet. Esto parece obvio con el atributo <sgmltag>CODE</sgmltag>, ya que no se podría insertar el applet sin indicar donde está, pero resulta más extraño con los atributos <sgmltag>WIDTH</sgmltag> y <sgmltag>HEIGHT</sgmltag>. Aun así, si no especificamos el tamaño que debe ocupar el applet en la página no será mostrado ni ejecutado por el navegador. Debemos estar muy atentos a este detalle ya que hasta ahora estos dos atributos eran totalmente optativos y por ello es un error común olvidarlos y no ser capaz de descubrir porqué no funciona el applet.</para>
	<para>Y aquí vemos como insertar un applet de ejemplo:</para>
	<programlisting>
		&lt;HTML&gt;
		&lt;HEAD&gt;
			&lt;TITLE&gt;Applet sonoro&lt;/TITLE&gt;
		&lt;/HEAD&gt;
		&lt;BODY&gt;
			&lt;APPLET CODE="SoundExample.class" WIDTH=450 HEIGHT=50&gt;&lt;/APPLET&gt;
		&lt;/BODY&gt;
		&lt;/HTML&gt;
	</programlisting>
	<warning>
		<para>Los applets de <productname>Java</productname> son sensibles a las mayúsculas y a las minúsculas, si no ponemos el nombre del archivo exactamente igual, incluyendo mayúsculas o minúsculas, no hubiera funcionado. Por ejemplo, si hubiéramos escrito <sgmltag>CODE="soundexample.class"</sgmltag> el código anterior no hubiera funcionado.  Este es un ejemplo muy común por lo que debemos tener cuidado.</para>
	</warning>
	<para>Si visualizamos este archivo con un navegador que soporte la tecnología <productname>Java</productname> debemos obtener el resultado de la figura 11.3.</para>
	<figure label="11.3">
		<title>Este es el aspecto que muestra nuestro primer applet insertado en una página Web. En un navegador con soporte <productname>Java</productname> podemos pulsar sobre los botones para obtener diferentes sonidos.</title>
		<graphic fileref="img/fig11-3.png"/>
	</figure>
	<note>
		<para>Los applets <productname>Java</productname> tienen la terminación <emphasis>.class</emphasis>, como ya hemos comentado antes, esto exige que para poder usar un applet debemos utilizar un sistema operativo que soporte nombres largos. Desgraciadamente los usuarios de <productname>Windows</productname> 3.1 no podrán probar esta tecnología localmente en su ordenador. Afortunadamente esto no significa que no puedan disfrutar los applets que estén publicados en el WWW.</para>
	</note>
	<para>Pasemos a explicar que ocurre cuando el navegador se encuentra con el código anterior. En primer lugar busca el archivo <filename>SoundExample.class</filename> en la misma dirección URL y en el mismo directorio donde se encuentre la página actual y lo baja a nuestro ordenador (este es un ejemplo en el que ambos archivos ya están en nuestro ordenador, con lo que este paso no sería necesario). Mientras reserva un rectángulo, con las dimensiones especificadas por los atributos <sgmltag>WIDTH</sgmltag> y <sgmltag>HEIGHT</sgmltag>, donde será mostrado el applet. Una vez ha llegado el archivo anterior el navegador llama a lo que se conoce como <emphasis>máquina virtual <productname>Java</productname></emphasis> (también llamada JVM, <emphasis><productname>Java</productname> Virtual Machine</emphasis>) que pasará a ejecutar el applet. A partir de ese momento el applet se ejecutará como cualquier otro programa de nuestro ordenador, aunque lo hará en el interior de la página Web. De esta forma cuando nuestro cursos este dentro del rectángulo de 450x50 creado el control pasará al applet y si pulsamos los botones el propio applet será el encargado de realizar las acciones oportunas. La Máquina Virtual <productname>Java</productname> implementa además ciertas medidas de seguridad para que el applet no pueda, por ejemplo, borrar nuestro disco duro. Una vez conocemos el funcionamiento de los applets podemos adentrarnos más a fondo en las diferentes características de estos que pueden ser modificadas con el lenguaje HTML.</para>
	<sect2>
		<title>Especificando la dirección del applet.</title>
		<para>Dejando a un lado el ejemplo y volviendo al código general es obvio que el código es, todavía, muy sencillo. Para empezar el archivo con el applet (que siempre tiene la extensión <emphasis>.class</emphasis>) se encuentra en el mismo directorio que el documento HTML de la página actual. Lo habitual, sin embargo, es agrupar todos los applets <productname>Java</productname> en un directorio dedicado de la misma manera que hacíamos con las imágenes. Podríamos pensar que para reflejar este cambio no tendríamos más que cambiar ligeramente el código y escribir:</para>
		<programlisting>
			&lt;APPLET CODE="applets/nombre_applet.class" WIDTH="ancho" HEIGHT="alto"&gt;
			&lt;/APPLET&gt;
		</programlisting>
		<para>Por desgracia, este código es <emphasis>incorrecto</emphasis>. El atributo <sgmltag>CODE</sgmltag> permite únicamente especificar el nombre del archivo donde se encuentra el applet, pero no podemos incluir un directorio ni, por supuesto, una dirección de Internet. ¿Significa esto que es imposible? Afortunadamente no, los diseñadores de esta etiqueta pensaron en ello e introdujeron un nuevo atributo, <emphasis><sgmltag>CODEBASE</sgmltag></emphasis>, que nos permitirá indicar la dirección URL o ruta de directorios donde se encuentre el archivo especificado en el atributo <sgmltag>CODE</sgmltag>. Usando <sgmltag>CODEBASE</sgmltag> podemos reescribir el código anterior de manera correcta:</para>
		<programlisting>
			&lt;APPLET CODEBASE="applets/" CODE="nombre_applet.class" WIDTH="ancho" HEIGHT="alto"&gt;
			&lt;/APPLET&gt;
		</programlisting>
		<para>Sin embargo podemos ir más allá. Podemos usar en nuestra página un applet que se encuentre en cualquier otro lugar del WWW sin tener que copiarlo a nuestro servidor. Para ello no tendremos más que usar el atributo <sgmltag>CODEBASE</sgmltag> para especificar la dirección base. Por ejemplo:</para>
		<programlisting>
			&lt;APPLET code=TicTacToe.class width=120 height=120 CODEBASE="http://<productname>Java</productname>.sun.com/applets/TicTacToe/1.1/"&gt;
			&lt;/APPLET&gt;
		</programlisting>
		<para>Esta dirección es real, si incluimos este código en una página habremos insertado un juego de las tres en raya como el que vemos en la figura 11.4 en el que cualquier visitante de nuestra página podrá jugar (contra el ordenador). Si vemos en cualquier página un applet que nos gusta y sus autores permiten que sea utilizado en páginas ajenas (esto es muy importante) no debemos dudarlo y usarlo. La carga del applet no será más lenta que si estuviera en nuestro mismo servidor y además tendremos a nuestra disposición una mayor cantidad de applets, ya que muchos autores permiten el uso de applets siempre y cuando estos no sean copiados de su servidor sino usados directamente desde él.</para>
		<figure label="11.4">
			<title>Usando applets <productname>Java</productname> podemos insertar juegos interactivos como en este caso. Usando el atributo <sgmltag>CODEBASE</sgmltag> no es necesario que el applet esté en nuestro servidor.</title>
			<graphic fileref="img/fig11-4.png"/>
		</figure>
	</sect2>
	<sect2>
		<title>Otros atributos de la etiqueta <sgmltag>APPLET</sgmltag>.</title>
		<para>Además de los cuatro atributos que hemos vistos hasta ahora, que suelen usarse prácticamente siempre, existen otros que pueden resultarnos muy útiles. Todos ellos se encuentran incluidos en el estándar HTML 3.2:</para>
		<variablelist>
			<varlistentry>
				<term><emphasis><sgmltag>NAME="nombre del applet"</sgmltag>:</emphasis></term>
				<listitem>
					<para>Este atributo es usado para identificar el applet entre el resto de elementos u otros applets de la página. Poner el nombre del applet no es necesario, pero los buenos programadores aconsejan hacerlo por una cuestión de estilo. Por otro lado tener el applet identificado es tremendamente útil o incluso obligatorio si posteriormente queremos que este se comunique, por ejemplo, con código <productname>Java</productname>Script.</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term><emphasis><sgmltag>ALIGN</sgmltag></emphasis>:</term>
				<listitem>
					<para>Con esta etiqueta podremos controlar el alineamiento horizontal de la página. Puede tomar tres valores: <emphasis><sgmltag>left</sgmltag></emphasis>, <emphasis><sgmltag>right</sgmltag></emphasis> y <emphasis><sgmltag>center</sgmltag></emphasis> para conseguir que el applet esté alineado a la izquierda, a la derecha o esté centrado respectivamente. El funcionamiento de estos tres valores es similar al de las imágenes y si especificamos un alineamiento a cualquiera de los dos lados el texto circundante envolverá al applet.</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term><emphasis><sgmltag>VSPACE="pixeles"</sgmltag></emphasis>:</term>
				<listitem>
					<para>Con este atributo establecemos un margen vertical del tamaño en pixeles especificado. El margen vertical se refiere a la distancia entre la parte superior del applet y los elementos de la página que estén sobre él y entre la parte inferior y los elementos situados debajo.</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term><emphasis><sgmltag>HSPACE="pixeles"</sgmltag></emphasis>:</term>
				<listitem>
					<para>Este atributo nos permite establecer el ancho del margen horizontal, es decir el espacio entre el applet y los elementos que estén situados a su derecha y a su izquierda.</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term><emphasis><sgmltag>ALT="texto alternativo"</sgmltag></emphasis>:</term>
				<listitem>
					<para>Esta etiqueta es usada por aquellos navegadores que <emphasis>sí entienden</emphasis> la etiqueta <sgmltag>APPLET</sgmltag>, pero no soportan la tecnología <productname>Java</productname>. Todos los navegadores que cumplan la norma HTML 3.2 entienden esta etiqueta, pero eso no quiere decir que sean capaces de ejecutar un applet. Esto ocurre, por ejemplo, con los navegadores de sólo texto, ya que al ser los applets gráficos en su mayoría no son capaces de mostrarlos en pantalla. Este texto también es mostrado si en un navegador con soporte de tecnología <productname>Java</productname> tiene algún problema y no es capaz de ejecutar el applet.</para>
				</listitem>
			</varlistentry>
		</variablelist>
		<para>Continuando con el ejemplo anteriormente mostrado podemos usar estos atributos para obtener un código más completo. Para empezar es muy recomendable usar siempre los atributos <sgmltag>NAME</sgmltag> y <sgmltag>ALT</sgmltag>, con lo que quedaría (mostramos únicamente el código correspondiente a la inserción del applet):</para>
		<programlisting>
			&lt;APPLET CODE="SoundExample.class" WIDTH=450 HEIGHT=50 ALT="Su navegador soporta la tecnología <productname>Java</productname>, pero por algún error no es capaz de mostrar este applet" NAME="Ejemplo Sonoro"&gt;
			&lt;/APPLET&gt;
		</programlisting>
		<para>Por otro lado podemos usar el atributo <sgmltag>ALIGN</sgmltag> para que el texto bordee el applet. En este caso es recomendable usar también <sgmltag>VSPACE</sgmltag> y <sgmltag>HSPACE</sgmltag> para crear un margen:</para>
		<programlisting>
			&lt;APPLET CODEBASE="ej1/" CODE="SoundExample.class" WIDTH=450 HEIGHT=50 ALIGN="left" HSPACE=15 VSPACE=15&gt;
			&lt;/APPLET&gt;
		</programlisting>
		<para>Escribiendo texto antes y después de esta etiqueta obtenemos el resultado de la figura 11.5.</para>
		<figure label="11.5">
			<title>Usando los atributos <sgmltag>ALIGN</sgmltag>, <sgmltag>VSPACE</sgmltag> y <sgmltag>HSPACE</sgmltag> podemos insertar un applet rodeado de texto.</title>
			<graphic fileref="img/fig11-5.png"/>
		</figure>
		<para>Los atributos anteriores son los que aparecieron inicialmente junto con la etiqueta APPLET y que fueron adoptados por el estándar HTML 3.2 pero además de estas, tanto Microsoft como Netscape han ido incorporando otros nuevos en sus navegadores:</para>
		<variablelist>
			<varlistentry>
				<term><emphasis><sgmltag>ARCHIVE="archivo_comprimido"</sgmltag>:</emphasis></term>
				<listitem>
					<para>Permite especificar un archivo auxiliar al applet de <productname>Java</productname> donde pueden ser insertados todas las imágenes, sonidos y cualquier otro archivo auxiliar que pueda ser necesario para la ejecución del applet. La existencia de este atributo ha sido pensada para comprimir todos los archivos auxiliares en uno sólo de menor tamaño para que el tiempo de carga sea menor. Cualquier otro fichero que necesite el applet que no este incluido en este archivo comprimido será buscado por los métodos habituales. Este atributo es exclusivo del navegador Netscape <productname>Navigator</productname>.</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term><emphasis><sgmltag>MAYSCRIPT</sgmltag>:</emphasis></term>
				<listitem>
					<para>Este atributo se usa por si sólo, sin ningún valor, y su presencia significa que el applet <productname>Java</productname> puede ser accedido usando código <productname>Java</productname>Script.</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term><emphasis><sgmltag>TITLE="texto"</sgmltag>:</emphasis></term>
				<listitem>
					<para>Este atributo exclusivo de Internet <productname>Explorer</productname> 4.0 permite indicar un texto que será mostrado en un bocadillo cuando el navegante pase el ratón por encima del applet. Aunque el contenido de este atributo sólo es entendido por <productname>Explorer</productname> puede ser usado con total libertad, ya que no perjudica nada a los usuarios del resto de navegadores.</para>
				</listitem>
			</varlistentry>
		</variablelist>
		<para>Estos son todos los atributos que pueden ser usados en la etiqueta <sgmltag>APPLET</sgmltag>, pero existe otro método adicional para especificar parámetros particulares de cada uno de estos programas escritos en <productname>Java</productname>: la etiqueta <sgmltag>PARAM</sgmltag>.</para>
	</sect2>
	<sect2>
		<title>La etiqueta <sgmltag>PARAM</sgmltag>.</title>
		<para>Esta etiqueta consta de una única instrucción, <sgmltag>&lt;PARAM&gt;</sgmltag>, que debe ser insertada en el interior de la etiqueta <sgmltag>APPLET</sgmltag> (entre la instrucción de inicio y la instrucción de fin) y cuya función será definir parámetros para el applet. Los parámetros son propiedades específicas de cada applet que permiten modificar sus características. Los parámetros constan de un nombre y un valor que son indicados usando los atributos <emphasis><sgmltag>NAME</sgmltag></emphasis> y <emphasis><sgmltag>VALUE</sgmltag></emphasis> de la siguiente manera:</para>
		<programlisting>
			&lt;APPLET CODE="nombre_applet.class" WIDTH="ancho" HEIGHT="alto"&gt;
			&lt;PARAM NAME="nombre_parámetro" VALUE="valor_parámetro"&gt;
			&lt;/APPLET&gt;
		</programlisting>
		<para>La etiqueta <sgmltag>PARAM</sgmltag> puede ser usada tantas veces sea necesario para un mismo applet siendo necesario usarla una vez para cada uno de los parámetros. En general los applets que se distribuyen gratuitamente constan de gran número de parámetros, para poder adaptarse a las necesidades de los distintos usuarios que vayan a utilizarlo. Por esta razón siempre van acompañados de documentación. Quizá el applet más conocido es <filename>Animator.class</filename>, este applet toma un conjunto de imágenes y las va mostrando ordenadamente para crear un efecto de animación. Este era el único método existente para crear animaciones antes de la aparición de los GIFS animados. Tras la aparición de estos la utilización de este applet ha decrecido, pero sigue siendo útil en ciertas ocasiones y nos servirá como excelente ejemplo para mostrar el uso de la etiqueta <sgmltag>PARAM</sgmltag>. Para insertar el applet debemos copiar el contenido de este directorio a otra ubicación y crear un documento HTML con el siguiente código:</para>
		<programlisting>
			&lt;HTML&gt;
			&lt;HEAD&gt;
				&lt;TITLE&gt;El saludo de Duke&lt;/TITLE&gt;
			&lt;/HEAD&gt;
			&lt;BODY&gt;
				&lt;APPLET CODE="Animator.class" WIDTH=55 HEIGHT=68&gt;
     			&lt;PARAM NAME="imagesource" VALUE="."&gt;
     			&lt;PARAM NAME=ENDIMAGE VALUE=10&gt;
     			&lt;PARAM NAME=PAUSE VALUE=100&gt;
     			&lt;PARAM NAME=PAUSES VALUE="2500|100|100|100|100|100|100|100|100|100"&gt;
				&lt;/APPLET&gt;
			&lt;/BODY&gt;
			&lt;/HTML&gt;
		</programlisting>
		<para>En este caso hemos usado 4 parámetros del applet, aunque en realidad tiene muchos más. Los explicaremos brevemente. El parámetro <emphasis><sgmltag>imagesource</sgmltag></emphasis> nos permite indicar el directorio donde se encuentran las imágenes, un punto significa el directorio actual. Estas imágenes deben llamarse obligatoriamente <filename>T1.gif</filename>, <filename>T2.gif</filename>, <filename>T3.gif</filename>, etc. El parámetro <emphasis><sgmltag>endimage</sgmltag></emphasis> indica el número de imágenes de los que consta la animación y en esta ocasión serán 10, desde <filename>T1.gif</filename> hasta <filename>T2.gif</filename>. Los parámetros <emphasis><sgmltag>pause</sgmltag></emphasis> y <emphasis><sgmltag>pauses</sgmltag></emphasis> nos permiten controlar las pausas entre las imágenes, con el último controlamos de manera independiente las pausas que se realizan entre cada una de las imágenes de manera individual. Al visualizar este código con un navegador con soporte <productname>Java</productname> veremos la mascota de <productname>Java</productname>, Duke, saludando. En la  figura 11.6 podemos apreciar una captura del resultado. Una gran ventaja de este método para crear animaciones es que simplemente cambiando las imágenes <filename>T1.gif</filename>, <filename>T2.gif</filename>, etc. por unas propias podemos crear otra animación distinta sin necesitar ninguna aplicación como era el caso de los GIFs animados.</para>
		<figure label="11.6">
			<title>El applet <filename>Animator.class</filename> es uno de los más conocidos y usados en las páginas Web por la facilidad que ofrece para crear animaciones.</title>
			<graphic fileref="img/fig11-6.png"/>
		</figure>
		<note>
			<para>Para obtener más información sobre el applet <filename>Animator.class</filename> o sobre muchos otros applets de distribución gratuita podemos visitar la página antes mencionada <productname>Java</productname>.sun.com.</para>
		</note>
	</sect2>
	<sect2>
		<title>Alternativas a los applets <productname>Java</productname>.</title>
		<para>Dado que la tecnología <productname>Java</productname> es relativamente nueva y requiere grandes recursos por parte del navegador, sólo algunos como Netscape <productname>Navigator</productname> 2.0 o superior y Internet <productname>Explorer</productname> 3.0 o superior la soportan. Dado que no sabemos que navegadores usarán los visitantes de nuestras páginas es conveniente añadir alternativas para aquellos que no sean capaces de mostrar el applet. Anteriormente hemos visto la existencia del atributo <sgmltag>ALT</sgmltag> que permite especificar un texto alternativo. Sin embargo tiene dos inconvenientes:</para>
		<itemizedlist>
			<listitem>
				<para>Este atributo sólo será entendido por aquellos navegadores que entiendan la etiqueta <sgmltag>APPLET</sgmltag>, con lo que seguimos sin tener una alternativa para el resto de navegadores.</para>
			</listitem>
			<listitem>
				<para>Con <sgmltag>ALT</sgmltag> únicamente podemos insertar un texto, ni imágenes ni ningún otro elemento HTML, con lo que nuestras posibilidades para ofrecer alternativas quedan muy menguadas.</para>
			</listitem>
		</itemizedlist>
		<para>Afortunadamente existe otro método. Como hemos indicado al principio de esta sección, y como ya hemos comprobado por los ejemplos, la etiqueta <sgmltag>APPLET</sgmltag> consta de una instrucción de inicio y de una instrucción de fin. Vimos que entre ellas podíamos insertar una o varias etiquetas <sgmltag>PARAM</sgmltag> para especificar los parámetros específicos de cada applet. Pero además podemos insertar otras etiquetas HTML que serán ignoradas por aquellos navegadores con soporte <productname>Java</productname>, pero serán mostradas por todos aquellos que no soporten esta tecnología, con lo que nos servirá como contenido alternativo al applet:</para>
		<programlisting>
			&lt;APPLET CODE="nombre_applet.class" WIDTH="ancho" HEIGHT="alto"&gt;
			&lt;PARAM NAME="nombre_parámetro" VALUE="valor_parámetro"&gt;
			... Código HTML alternativo ...
			&lt;/APPLET&gt;
		</programlisting>
		<para>Siguiendo con el ejemplo de la mascota de <productname>Java</productname>, si queremos que nuestra página este preparada para todos los navegadores debemos añadir el atributo <sgmltag>ALT</sgmltag> así como contenido alternativo antes de la instrucción <sgmltag>&lt;/APPLET&gt;</sgmltag>. He aquí un ejemplo:</para>
		<programlisting>
			&lt;APPLET CODE="Animator.class" WIDTH=55 HEIGHT=68 ALT="Lo siento no puede ver el applet"&gt;
     			&lt;PARAM NAME="imagesource" VALUE="."&gt;
     			&lt;PARAM NAME=ENDIMAGE VALUE=10&gt;
     			&lt;PARAM NAME=PAUSE VALUE=100&gt;
     			&lt;PARAM NAME=PAUSES VALUE="2500|100|100|100|100|100|100|100|100|100"&gt;
  			&lt;IMG SRC="T5.gif" WIDTH=55 HEIGHT=68 ALT="Duke te saluda"&gt;
			&lt;/APPLET&gt;
		</programlisting>
		<para>En este caso los usuarios de navegadores sin soporte <productname>Java</productname> verán una imagen de Duke saludando (aunque sin movimiento) del mismo tamaño que el applet. Si en el texto de la página hemos hecho referencia a que los navegantes van a ver un applet en acción debemos insertar también junto con la imagen un texto que advierta que el applet no puede ser visualizado con ese navegador y que a cambio se muestra una imagen. En la figura 11.7 vemos el ejemplo anterior visto con el navegador <productname>Opera</productname>, que no soporta la tecnología <productname>Java</productname>. En un medio estático como este no se aprecia la diferencia, pero esta existe, ya que en este caso la imagen no tiene movimiento.</para>
		<figure label="11.7">
			<title>El navegador <productname>Opera</productname> no soporta la tecnología <productname>Java</productname>, por lo que mostrará el código alternativo, en este caso uno de los GIFs de la animación.</title>
			<graphic fileref="img/fig11-7.png"/>
		</figure>
		<para>Con este ejemplo damos por concluido el aprendizaje de la etiqueta <sgmltag>APPLET</sgmltag>. En la figura 11.8 podemos ver un ejemplo.</para>
		<figure label="11.8">
			<title>Resumen de todos los atributos de la etiqueta <sgmltag>APPLET</sgmltag> y de su subetiqueta <sgmltag>PARAM</sgmltag>.</title>
			<graphic fileref="img/fig11-8.png"/>
		</figure>
	</sect2>
	<sect2>
		<title>El nuevo estándar: la etiqueta <sgmltag>OBJECT</sgmltag>.</title>
		<para>Hasta ahora hemos aprendido a insertar diferentes tipos de objetos en las páginas Web, para insertar imágenes usábamos la etiqueta <sgmltag>IMG</sgmltag>, para insertar objetos para plug-ins usábamos <sgmltag>EMBED</sgmltag>, para insertar frames flotantes <sgmltag>IFRAME</sgmltag>, para insertar applets <productname>Java</productname> <sgmltag>APPLET</sgmltag>, etc. Observando esta diversidad y viendo que cada desarrollador de navegadores creaba sus propios métodos para incluir objetos en las páginas el consorcio W3C creo un grupo de trabajo para buscar una solución que englobará y unificara todos los métodos actualmente existentes. La solución fue la creación de una nueva etiqueta para el lenguaje HTML: <emphasis><sgmltag>OBJECT</sgmltag></emphasis>, que fue introducida en el estándar HTML 3.2, aunque es a partir de la versión <emphasis>HTML 4.0</emphasis> cuando se está empezando a darle la importancia que merece.</para>
		<para>Usando esta etiqueta es posible incluir varios tipos de ficheros multimedia (vídeo y sonido MPEG, ficheros <productname>Shockwave</productname>/<productname>Director</productname>, etc.), applets de <productname>Java</productname>, controles <productname>ActiveX</productname> (que veremos en la siguiente sección), documentos HTML o prácticamente cualquier otro tipo de objeto. Por ejemplo para incluir un vídeo AVI debemos usar el siguiente código:</para>
		<programlisting>
			&lt;OBJECT DATA="flores.avi" TYPE="video/avi" WIDTH=100 HEIGHT=100&gt;
			&lt;IMG SRC="flores.gif" WIDTH=100 HEIGHT=100 ALT="[FLORES]"&gt;
			&lt;/OBJECT&gt;
		</programlisting>
		<para>En este caso el funcionamiento es muy similar al de la etiqueta EMBED y ahora el código alternativo deberá ser mostrado entre <sgmltag>&lt;OBJECT&gt;</sgmltag> y <sgmltag>&lt;/OBJECT&gt;</sgmltag>. Este código será ignorado por los navegadores que entiendan la etiqueta <sgmltag>OBJECT</sgmltag>.</para>
		<para>¿Qué navegadores soportan este nuevo estándar? Las versiones 4.0 y posteriores de Internet <productname>Explorer</productname> y Netscape <productname>Navigator</productname> entienden la etiqueta, aunque todavía no soportan todas las posibilidades que ofrece. Sin embargo el Web Consortium le esta dando un fuerte impulso, con lo es de suponer que las futuras versiones de estos navegadores si no hagan y que poco a poco se tenderá hacia un mayor uso de la etiqueta <sgmltag>OBJECT</sgmltag>.</para>
		<para>Esta sección es sólo una introducción a este nuevo estándar. Hemos considerado que un estudio detallado no era apropiado porque esta etiqueta no puede ser usada todavía de manera fiable(excepto para insertar controles <productname>ActiveX</productname> que enseguida veremos). El lector interesado puede adquirir más información a través del Web Consortium en las siguientes direcciones:</para>
		<itemizedlist>
			<listitem>
				<para>http://www.w3.org/pub/www/TR/WD-object.html</para>
			</listitem>
			<listitem>
				<para>http://www.w3.org/TR/WD-html40/struct/objects.html#h-14.3</para>
			</listitem>
		</itemizedlist>
		<para>En la figura 11.9 hemos incluido de modo informativo la página del Web Consortium que explica el funcionamiento del atributo <sgmltag>OBJECT</sgmltag> y todos sus atributos.</para>
		<figure label="11.9">
			<title>La etiqueta <sgmltag>OBJECT</sgmltag> ha sido creada por los expertos del Web Consortium para englobar la inclusión de todo tipo de objetos en las páginas Web.</title>
			<graphic fileref="img/fig11-9.png"/>
		</figure>
		<para>Una sección que si hemos considerado importante explicar es la inserción de los applets <productname>Java</productname> recién vistos usando la etiqueta applet, ya que aunque actualmente este método sea operativo, se irá imponiendo con el tiempo.</para>
	</sect2>
	<sect2>
		<title>Inserción de un applet <productname>Java</productname>.</title>
		<para>El objetivo actual del Web Consortium es que la etiqueta <sgmltag>OBJECT</sgmltag> conviva por un tiempo con la etiqueta <sgmltag>APPLET</sgmltag> para sustituirla más adelante. Hoy en día el uso de la etiqueta <sgmltag>OBJECT</sgmltag> no está muy extendido con lo que la forma más segura de insertar un applet sigue siendo usando la etiqueta <sgmltag>APPLET</sgmltag>, sin embargo la siguiente generación de navegadores permitirá también el uso de <sgmltag>OBJECT</sgmltag> que acabará siendo el único método aceptado y como buenos programadores nosotros debemos estar preparados.</para>
		<para>Para poder llevar a cabo todas las funciones de la etiqueta <sgmltag>APPLET</sgmltag> también es posible usar la etiqueta <emphasis><sgmltag>&lt;PARAM&gt;</sgmltag></emphasis> para especificar parámetros para los applets u otros objetos que los necesiten. Aunque esta etiqueta debe ser insertada entre <sgmltag>&lt;OBJECT&gt;</sgmltag> y <sgmltag>&lt;/OBJECT&gt;</sgmltag> no será ignorado por los navegadores que entiendan esta etiqueta.</para>
		<para>Además la etiqueta <sgmltag>PARAM</sgmltag> tiene dos nuevos atributos al ser usada en el interior de <sgmltag>OBJECT</sgmltag>, estos son:</para>
		<variablelist>
			<varlistentry>
				<term><emphasis><sgmltag>VALUETYPE="..."</sgmltag>:</emphasis></term>
				<listitem>
					<para>Este atributo especifica que tipo de valor recibirá el parámetro. Hay tres posibles valores:</para>
					<variablelist>
						<varlistentry>
							<term><emphasis><sgmltag>Data</sgmltag>:</emphasis></term>
							<listitem>
								<para>El valor especificado será pasado al objeto como una cadena de caracteres. Este es el valor por defecto y antes de la existencia del atributo <sgmltag>VALUETYPE</sgmltag> era la única posibilidad.</para>
							</listitem>
						</varlistentry>
					</variablelist>
					<variablelist>
						<varlistentry>
							<term><emphasis><sgmltag>Ref</sgmltag>:</emphasis></term>
							<listitem>
								<para>El valor especificado es una dirección URL que indica donde están almacenados los valores para dicho parámetro. La dirección debe ser pasada tal cual al objeto.</para>
							</listitem>
						</varlistentry>
					</variablelist>
					<variablelist>
						<varlistentry>
							<term><emphasis><sgmltag>Object</sgmltag>:</emphasis></term>
							<listitem>
								<para>El valor es el nombre de otro objeto del mismo documento precedido del símbolo '#'.</para>
							</listitem>
						</varlistentry>
					</variablelist>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term><emphasis><sgmltag>TYPE="tipo_mime"</sgmltag>:</emphasis></term>
				<listitem>
					<para>Este atributo especifica el tipo mime del valor asignado a este atributo con <sgmltag>VALUE</sgmltag>.</para>
				</listitem>
			</varlistentry>
		</variablelist>
		<para>Exceptuando estas diferencias, el funcionamiento es idéntico. Por ejemplo, para insertar el applet del segundo de nuestros ejemplos ('El saludo de Duke') usando la etiqueta <sgmltag>OBJECT</sgmltag> debemos escribir:</para>
		<programlisting>
			&lt;OBJECT codetype="application/octet-stream"
        			classid="<productname>Java</productname>:Animator.class"
        			width=55 height=68
 				ALT="Lo siento, no puede ver el applet"&gt;
			&lt;PARAM NAME="imagesource" VALUE="."&gt;
			&lt;PARAM NAME=ENDIMAGE VALUE=10&gt;
			&lt;PARAM NAME=PAUSE VALUE=100&gt;
			&lt;PARAM NAME=PAUSES VALUE="2500|100|100|100|100|100|100|100|100|100"&gt;
			&lt;IMG SRC="T5.gif" WIDTH=55 HEIGHT=68 ALT="Duke te saluda"&gt;
			&lt;/OBJECT&gt;
		</programlisting>
		<para>Como vemos la diferencia con la etiqueta <sgmltag>APPLET</sgmltag> es pequeña, con la única complejidad añadida de indicar en el atributo CODETYPE el tipo <sgmltag>MIME</sgmltag> del applet, que es el indicado en este ejemplo siempre. Esto es necesario para indicar al navegador que se trata de un applet de modo que si no soporta esta tecnología este pueda ser capaz de decidir no bajar el archivo.</para>
		</sect2>
</sect1>

<sect1>
	<title><productname>ActiveX</productname>, la tecnología del futuro.</title>
	<para>La, denominada, tecnología <productname>ActiveX</productname> desarrollada por Microsoft hizo su aparición en Internet con el navegador Internet <productname>Explorer</productname> 3.0. Su objetivo es similar al de los plug-ins, insertar objetos de diferente tipo en una página Web, aunque va mucho más allá al añadir mayores posibilidades de interacción y comunicación con programas externos. Existen páginas en Internet que basan toda su presentación en controles <productname>ActiveX</productname> para crear Webs realmente impactantes. En la figura 11.10 vemos la página de ForecastX que ofrece el parte meteorológico en tiempo real usando esta novedosa tecnología.</para>
	<figure label="11.10">
		<title>ForecastX ofrece un servicio meteorológico en tiempo real gracias a la tecnología <productname>ActiveX</productname>.</title>
		<graphic fileref="img/fig11-10.png"/>
	</figure>
	<para><productname>ActiveX</productname> esta compuesto por dos tipos de objetos: <emphasis>controles Activos</emphasis> (<emphasis>Active controls</emphasis>) y <emphasis>documentos Activos</emphasis> (<emphasis>Active documents</emphasis>). Estos últimos permiten insertar documentos con formato <productname>PDF</productname>, <productname>DOC</productname>, etc. La tecnología <productname>ActiveX</productname> funciona de una manera similar al mecanismo de Microsoft <productname>OLE</productname> (Object Linking and Embedding, Enlazado e incrustación de objetos) que usa su sistema operativo <productname>Windows</productname>, por lo que los usuarios de éste les resultará familiar, lo realmente novedoso es la aplicación de esta tecnología al WWW.</para>
	<para>Los controles <productname>ActiveX</productname> guardan parecidos con los objetos para plug-ins y con los applets <productname>Java</productname>, aunque presenta algunas mejoras con respecto a ambos. Como ocurría con los plug-ins, los controles y documentos de <productname>ActiveX</productname> pueden ser insertados en un página Web, sin embargo no requieren un pequeño programilla para cada tipo de objeto <productname>ActiveX</productname>, esta nueva tecnología ha sido denominada como <sgmltag>auto-contenida</sgmltag> porque cada objeto tiene suficiente información para ejecutarse él mismo sin ayuda de ninguna aplicación.</para>
	<para>Tal y como ocurre con los applets podemos crear nuestros propios controles o usar los creados por otros programadores que nos los venden o distribuyen gratuítamente. Si optamos por programarlos nosotros mismos existen herramientas que lo convierten prácticamente en un juego de niños, entre ellas destaca las creadas para este fin por Microsoft y que distribuye a través de su Web (www.microsoft.com/ie/).</para>
	<para>Hoy por hoy el único inconveniente de la tecnología <productname>ActiveX</productname> consiste en que sólo puede ser visto desde es sistema operativo <productname>Windows</productname> y con el Navegador Internet <productname>Explorer</productname>, aunque afortunadamente parece que esto cambiará pronto.</para>
	<sect2>
		<title>Inserción de un control <productname>ActiveX</productname>.</title>
		<para>El código HTML necesario para insertar un control o documento <productname>ActiveX</productname> en una página Web fue desarrollado por Microsoft en colaboración con el Web Consortium, con lo que se acordó el uso del estándar <sgmltag>OBJECT</sgmltag> que hemos visto en la sección anterior. A continuación veremos un sencillo ejemplo que no requiere ningún archivo especial, el único requisito para poder visualizarlo consistirá en tener instalado el navegador Internet <productname>Explorer</productname> 3.0 o superior. El código usado para insertar el control <productname>ActiveX</productname> será:</para>
		<programlisting>
			&lt;OBJECT WIDTH=250 HEIGHT=340
			CLASSID="clsid:99B42120-6EC7-11CF-A6C7-00AA00A47DD2"&gt;
			&lt;PARAM NAME="angle" VALUE="55"&gt;
			&lt;PARAM NAME="alignment" VALUE="2"&gt;
			&lt;PARAM NAME="BackStyle" VALUE="3"&gt;
			&lt;PARAM NAME="caption" VALUE="Curso WEBMASTER"&gt;
			&lt;PARAM NAME="FontName" VALUE="Arial"&gt;
			&lt;PARAM NAME="FontSize" VALUE="30"&gt;
			&lt;PARAM NAME="FontBold" VALUE="1"&gt;
			&lt;PARAM NAME="Backcolor" VALUE="#006600"&gt;
			&lt;PARAM NAME="Forecolor" VALUE="#FFFFFF"&gt;
			Para visualizar el control <productname>ActiveX</productname> necesita <productname>Explorer</productname> 3.0 o posterior.
			&lt;/OBJECT&gt;
		</programlisting>
		<para>En la figura 11.11 podemos ver el resultado obtenido tal y como se ve con Internet <productname>Explorer</productname> 4.0. Pasemos a explicar el este código: El valor del atributo <sgmltag>CLASSID</sgmltag> es el que identifica el tipo de control <productname>ActiveX</productname> que estamos insertando. Este código es complejo y se sale de los objetivos de esta obra.</para>
		<figure label="11.11">
			<title>Usando este control <productname>ActiveX</productname> podemos crear efectos variados con texto, con lo que pueden sustituir el uso de imágenes con la consiguiente disminución tiempo de carga de nuestras páginas.</title>
			<graphic fileref="img/fig11-11.png"/>
		</figure>
		<para>Volviendo a nuestro ejemplo, entre los principales parámetros usados en la inserción de este control <productname>ActiveX</productname> encontramos:</para>
		<variablelist>
			<varlistentry>
				<term><emphasis>Caption<sgmltag></sgmltag>:</emphasis></term>
				<listitem>
					<para>Es el texto que debe insertarse con las características que se indican con el resto de parámetros.</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term><emphasis><sgmltag>Angle</sgmltag>:</emphasis></term>
				<listitem>
					<para>Es el ángulo del texto con la horizontal en grados. Si le damos el valor 90 el control mostrará el texto en vertical.</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term><emphasis><sgmltag>FontSize</sgmltag>:</emphasis></term>
				<listitem>
					<para>Es el tamaño del texto.</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term><emphasis><sgmltag>FontName</sgmltag>:</emphasis></term>
				<listitem>
					<para>Es el tipo de letra.</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term><emphasis><sgmltag>Backcolor</sgmltag> y <sgmltag>Forecolor</sgmltag>:</emphasis></term>
				<listitem>
					<para>Son el color del fondo y el color del texto respectivamente.</para>
				</listitem>
			</varlistentry>
		</variablelist>
		<para>Invitamos al lector a hacer pruebas modificando los valores de estos y el resto atributos y cambiando el texto para adaptarlo a nuestras necesidades y poder incorporarlo en sus propias páginas. Vemos un ejemplo en la figura 11.12.</para>
		<figure label="11.12">
			<title>Usando el mismo control <productname>ActiveX</productname> que en la figura 11.25 pero con un código algo más complejo podemos crear este efecto tan atractivo.</title>
			<graphic fileref="img/fig11-12.png"/>
		</figure>
		<para>Por último nos queda resaltar que existe un plug-in para Netscape <productname>Navigator</productname>, <emphasis>Ncompass</emphasis>, que añade a este navegador la posibilidad de entender controles y documentos <productname>ActiveX</productname>. Este plug-in puede ser obtenido en la página Web de Ncompass en el WWW: www.ncompasslabas.com. Si pensamos incorporar la tecnología <productname>ActiveX</productname> a nuestras páginas es muy recomendable incluir una enlace a esta página para que todos los usuarios de Netscape que las visiten puedan adquirirlo y disfrutar, también, de los controles que hayamos usado. También es importante destacar que Microsoft ha llegado a acuerdos con diversas compañías para exportar la tecnología <productname>ActiveX</productname> a <productname>Mac</productname> y UNIX, con lo que es de esperara que en poco tiempo se convierta en un método estándar para insertar objetos multi-plataforma aunque hoy por hoy no se puede decir que la sea, al contrario que <productname>Java</productname>.</para>
	</sect2>
</sect1>
	
</article>
	
