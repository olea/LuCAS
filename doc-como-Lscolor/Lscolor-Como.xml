<?xml version="1.0" encoding="iso-8859-1" ?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook V4.1.2//EN"
"http://www.oasis-open.org/docbook/xml/4.1.2/docbookx.dtd">

<article>

<articleinfo>

<title>LS en Color COMO</title>

<author>
<firstname>V. Inglesa: Thorbjoern Ravn Andersen <ulink
url="mailto:ravn@imada.ou.dk"
>ravn@imada.ou.dk</ulink
>

V. Española: Tomás Hidalgo, Guy Paul Gallardo <ulink
url="mailto:thidalgo@alboran.ualm.es"
>thidalgo@alboran.ualm.es</ulink
></firstname>
</author>

<pubdate>v1.0, 15 de Noviembre 1996</pubdate>

<abstract>

<para>
 El comando <literal remap="tt">ls</literal> incluído en la distribución Slackware de
linux permite color. (Slackware 2.0.2 y núcleo 1.1.54 de
Linux. Funciona también con agetty, o bien con mgetty_ps). Puede que los
colores por defecto no le gusten o que les haya cogido manía. Este documento
tiene como objetivo explicar el principio de funcionamiento y
configuración de colores usados por este comando. 
</para>

</abstract>

</articleinfo>

<sect1>
<title>¿Cómo seleccionar los colores?</title>

<para>
Existen dos métodos:
</para>

<para>

<itemizedlist>
<listitem>

<para>
<emphasis remap="bf">Primer método:</emphasis> 

Utilizar el programa <literal remap="tt">setterm</literal> que es válido para
una modificación rápida y simple de la configuración por defecto. Los manuales
y ayudas de este comando están escritos de forma farragosa y no intentaré de 
ninguna manera traducirlos más claros ;-).

Las selecciones se realizan de la forma:


<screen>
         setterm -foreground black -background white -store
</screen>


donde <literal remap="tt">-store</literal> significa que dicha configuración es grabada por
defecto en la consola activa. Sería necesario repetir esta operación para
cada consola virtual nueva, por lo que parece una buena idea colocar esta
línea en el <literal remap="tt">.login</literal> (en <literal remap="tt">csh</literal> o <literal remap="tt">tcsh</literal>) o en el <literal remap="tt">.profile</literal>
(<literal remap="tt">sh</literal>, <literal remap="tt">ksh</literal> o <literal remap="tt">bash</literal>). En adelante sabrá tanto sobre el comando 
<literal remap="tt">setterm</literal> como yo :-).

</para>
</listitem>
<listitem>

<para>
<emphasis remap="bf">Segundo método:</emphasis> Linux usa códigos de escape <literal remap="tt">ANSI</literal> del tipo:
<literal remap="tt">ESC[&lt;parámetros&gt;m</literal> donde <literal remap="tt">ESC</literal> es el carácter ASCII 27 y 
<literal remap="tt">&lt;parámetros&gt;m</literal> es uno o varios números separados por puntos y 
comas. Por ejemplo:


<itemizedlist>
<listitem>

<para>
<literal remap="tt">"&bsol;033[41;33;1m"</literal> que da un aspecto amarillo sobre fondo rojo.
</para>
</listitem>
<listitem>

<para>
<literal remap="tt">"&bsol;033[30;47m"</literal> que da un aspecto blanco sobre fondo negro.
</para>
</listitem>
<listitem>

<para>
<literal remap="tt">"&bsol;033[m"</literal> que restablece el aspecto por defecto.
</para>
</listitem>

</itemizedlist>


Estos ejemplos necesitan un shell que reconozca las construcciones del
tipo <literal remap="tt">&bsol;xxx</literal>. Si no es el caso, inserte directamente un carácter de
escape en la cadena. En <literal remap="tt">bash/vi</literal> teclee <literal remap="tt">Ctrl-V ESC</literal>, y
bajo <literal remap="tt">tcsh/emacs</literal> teclee <literal remap="tt">Ctrl-Q ESC.</literal>

</para>
</listitem>

</itemizedlist>

</para>

</sect1>

<sect1>
<title>¿Cuáles son las combinaciones de colores posibles?</title>

<para>
Este es un script en <emphasis remap="it">C-shell</emphasis> que muestra en la consola el conjunto de
combinaciones de colores:
</para>

<para>

<programlisting>

 #!/bin/csh
 #
 # Muestra los colores ANSI
 #
 set esc="\033["
 foreach fore (30 31 32 33 34 35 36 37)
 set line1="\*(dRfore " line2="  "
 foreach back (40 41 42 43 44 45 46 47)
 set line1="\*(dR{line1}\*(dR{esc}\*(dR{back};\*(dR{fore}m Normal \*(dR{esc}0m"
 set line2="\*(dR{line2}\*(dR{esc}\*(dR{back};\*(dR{fore}1m \*(dR{back} Bold \*(dR{esc}0m"
 end
 echo "\*(dRline1\n\*(dRline2"
 end


</programlisting>

</para>

<para>
El número de colores <emphasis remap="it">foreground</emphasis> crece hacia la izquierda, y el número de
colores <emphasis remap="it">background</emphasis> sigue la misma norma. Si desea una intensidad alta
coloque <literal remap="tt">01</literal> como primer parámetro. Ponga un punto y coma entre cada parámetro
y toda la secuencia de parámetros seguida.
</para>

<sect2>
<title>Inciso del traductor español.</title>

<para>
Para una mayor facilidad a la hora de poder elegir el aspecto de colores para
el comando ls se describen a continuación la correspondencia entre los números
y los colores de las secuencias de escape.
</para>

<para>
<emphasis remap="bf">Funciones Gráficas</emphasis>

<itemizedlist>
<listitem>

<para>
0............Desactivar todos los atributos
</para>
</listitem>
<listitem>

<para>
1............Activar negrita (alta intensidad)
</para>
</listitem>
<listitem>

<para>
4............Subrayar (sólo en adaptadores monocromo)
</para>
</listitem>
<listitem>

<para>
5............Activar parpadeo
</para>
</listitem>
<listitem>

<para>
7............Activar vídeo inverso
</para>
</listitem>
<listitem>

<para>
8............Activar ocultamiento
</para>
</listitem>

</itemizedlist>

</para>

<para>

<screen>
Colores Primer Plano (Foreground)            Colores de Fondo (Background)

         30.....................Negro....................40
         31.....................Rojo.....................41
         32.....................Verde....................42
         33.....................Amarillo.................43
         34.....................Azul.....................44
         35.....................Magenta..................45
         36.....................Azul verdoso.............46
         37.....................Blanco...................47

</screen>

</para>

</sect2>

</sect1>

<sect1>
<title>Aspecto por tipos de ficheros.</title>

<para>
El comando <literal remap="tt">ls</literal> comienza por mirar la definición de asociaciones de 
color en el fichero <literal remap="tt">&tilde;/.dir_colors</literal> y si no existe usa el fichero 
<literal remap="tt">/etc/DIR_COLORS</literal>. Dichos ficheros contienen entradas del tipo:
</para>

<para>

<screen>

       LINK 36;1      # enlace simbolico
       FIFO 40;33     # pipeline
       SOCK 41;01;35  # socket
       BLK 41;33;01   # gestor en modo bloque
       CHR 41;33;01   # gestor en modo caracter

       EXEC 32;1      # ficheros ejecutables

       .tar 01;31     # ficheros y archivos comprimidos
       .tgz 01;31
       .zip 01;31
       .z   01;31
       .Z   01;31
       .gz  01;31

</screen>

</para>

<para>
Las secuencias de escape dadas en parámetros aquí poseen exactamente la
misma sintaxis que para el comando <literal remap="tt">setterm</literal>. Modifique esto a su gusto y 
verá el resultado ejecutando un <literal remap="tt">ls</literal> en <literal remap="tt">/sbin</literal>, <literal remap="tt">/etc</literal> o 
<literal remap="tt">/etc/dev</literal>.
</para>

<para>
Con el fin de que el fichero <literal remap="tt">/etc/DIR_COLORS</literal> o <literal remap="tt">&tilde;/.dir_colors</literal>
sea tomado en cuenta es necesario añadir en <literal remap="tt">/etc/profile</literal> o 
<literal remap="tt">&tilde;/.profile</literal> (<literal remap="tt">sh/bash</literal>) o <literal remap="tt">/etc/csh.login</literal> o
<literal remap="tt">&tilde;/.login</literal> (<literal remap="tt">csh/tcsh</literal>) la línea:
</para>

<para>

<screen>
eval '/bin/dircolors'
</screen>

</para>

<para>
ATENCIÓN: Esta línea debe ser colocada antes de cualquier definición de alias
para el comando ls. Este comando lee el fichero <literal remap="tt">/etc/DIR_COLORS</literal> o
<literal remap="tt">&tilde;/.dir_colors</literal> y une las variables de entorno <literal remap="tt">LS_COLORS</literal> y 
<literal remap="tt">LS_OPTIONS</literal> así como  los alias <literal remap="tt">ls, dir, vdir, d</literal> y <literal remap="tt">v</literal>.
</para>

</sect1>

<sect1>
<title>Cómo dar una configuración por defecto.</title>

<para>
Esto es realizado individualmente para cada consola virtual con la ayuda de la
secuencia ANSI. (Esta información ha sido encontrada estudiando el código
fuente del núcleo. No puedo decir que se trate de un estándar.)
</para>

<para>

<screen>
ESC [8]
</screen>

</para>

<para>
que especifica los valores por defecto de colores <literal remap="tt">foreground</literal> y
<literal remap="tt">background</literal>. La secuencia ANSI de recomposición de atributos,
<literal remap="tt">ESC[m</literal>, permite entonces tener en cuenta esos colores antes que el
blanco sobre fondo negro. 
</para>

<para>
El método descrito aquí se ha supuesto para sistemas aislados, donde los
accesos se hacen sólo en la consola. Esto no funciona para <literal remap="tt">logins</literal>
realizados desde terminales remotos, conexiones por módem o desde otras
máquinas, ya que no interpretarían las secuencias. La interpretación de
códigos ANSI es una propiedad de las consolas Linux y que sólo existe en
pocos programas de terminal. 
</para>

<para>
Si se encuentra en un sistema aislado, un buen medio de tener en cuenta
los colores para cada consola es la de modificar el fichero
<literal remap="tt">/etc/issue</literal>, y ver el resultado generado. Generalmente (y en
particular en las distribuciones Slackware) este fichero es leído y
mostrado en cada inicialización del sistema. Así si su
<literal remap="tt">/etc/rc.d/rc.S</literal> contiene (alrededor de la línea 75): 
</para>

<para>

<screen>
    # Inicializa /etc/issue y etc/motd para dar la version del nucleo usado
    # ATENCION: los ficheros /etc/issue y /etc/motd son creados en cada inicio
    # Ponga esto en comentario si desea personalizar para siempre todos
    # estos ficheros.
    echo ""&#62;/etc/issue
    echo Bienvenido al mundo maravilloso de Linux \
         '/bin/uname -a | /bin/cut -d\ -f3'.&#62;&#62;/etc/issue
    echo &#62;&#62; /etc/issue
</screen>

</para>

<para>
Coloque estas líneas en comentario o modifíquelas como sigue:
</para>

<para>

<screen>
    # Ponga esto en comentario si desea personalizar para siempre todos
    # estos ficheros.
    ESCAPE="&#60;sustituir esto por un solo caracter de escape&#62;"
    echo "${ESCAPE}[H${ESCAPE}[37;44m${ESCAPE}[8]${ESCAPE}[2J"&#62;/etc/issue
</screen>

</para>

<para>
Mi shell de arranque no entiende el <literal remap="tt">&bsol;033</literal>, debo especificar el código ASCII 27
en mi script como indiqué en el primer párrafo. La línea posee el aspecto:

<screen>
ESCAPE="^[".
</screen>

</para>

<para>
Este código tiene por objeto colocar el cursor al principio de la
ventana, cambiar los colores, salvar la selección y borrar la pantalla.
Dicha modificación solo tendrá efecto al reinicializar la máquina. 
</para>

<para>
Si su máquina Linux no está aislada, puede que aparezcan diversos
problemas en las conexiones con usuarios remotos. Esto es debido al hecho
de que su terminal no interpreta las secuencias de escape ANSI. 
</para>

<para>
Debe entonces ajustar a nivel de usuario:
</para>

<para>

<screen>
 if ["\*(dRTERM"="console"]; then
   echo "\033[37;44m\033[8]"
 fi
</screen>

</para>

<para>
o bien,
</para>

<para>

<screen>
 if ("\*(dRTERM"=="console") then
   echo "\033[37;44m\033[8]"
 endif
</screen>

</para>

<para>
Si se desea que la modificación afecte a todos los usuarios del sistema,
basta tan sólo con que el <literal remap="tt">root</literal> modifique los ficheros
<literal remap="tt">/etc/profile</literal> o <literal remap="tt">/etc/csh.login</literal>. (Reitero una vez más que
si el shell no puede interpretar los <literal remap="tt">&bsol;0xx</literal>, en particular el
código <literal remap="tt">&bsol;033</literal>, basta con sustituir este ultimo por "<literal remap="tt">ESC</literal>". 
</para>

</sect1>

<sect1 id="copyright">
<title>Copyright</title>

<para>
Esta versión bajo copyright (c)1995 es propiedad de Pierre Vassellerie.
</para>

<para>
Como todo documento HOWTO
<footnote>

<para>
N del T: COMOs
</para>

</footnote>
, este
documento puede ser reproducido y distribuido en su integridad o en parte,
por cualquier medio físico. A pesar de todo queda sujeto a las condiciones
siguientes: 
</para>

<para>

<itemizedlist>
<listitem>

<para>
La mención del copyright debe ser conservada, y la presente sección
debe preservarse en su integridad en toda copia, tanto completa como en parte.

</para>
</listitem>
<listitem>

<para>
Las traducciones y trabajos derivados deben ser aprobadas por el autor 
antes de la distribución.

</para>
</listitem>
<listitem>

<para>
Si distribuye este trabajo parcialmente, debe mencionarse como obtener una
versión completa de este documento y estar en condiciones de suministrarla.

</para>
</listitem>
<listitem>

<para>
Pueden ser usadas pequeñas porciones de este documento como 
ilustraciones de una revista o como reseñas sin autorización previa siempre 
que se cite a los autores.

</para>
</listitem>

</itemizedlist>

</para>

<para>
Pueden ser acordadas excepciones a estas reglas con fines educativos;
escriba al autor y pregunte. Estas restricciones tiene como único objetivo
proteger a los autores y su trabajo. Toda aportación educativa a este
documento será valorada positivamente. 
</para>

</sect1>

<sect1>
<title>La traducción.</title>

<para>
Este documento ha sido traducido por Tomás Hidalgo Salvador para el grupo de
usuarios de Linux INSFLUG coordinado por Francisco José Montilla.
</para>

<para>
Dicha traducción se encuentra amparada por los mismos derechos expresados en
la sección <xref linkend="copyright"/>.
</para>

<para>
Tomás Hidalgo Salvador, <ulink
url="mailto:thidalgo@alboran.ualm.es"
>thidalgo@alboran.ualm.es</ulink
>
</para>

</sect1>

<sect1 id="Grupos">
<title>Anexo: El INSFLUG </title>

<para>
El <emphasis>INSFLUG</emphasis> forma parte del grupo internacional 
<emphasis remap="it">Linux Documentation Project</emphasis>, 
encargándose de las traducciones al castellano de los Howtos (Comos),
así como la producción de documentos originales en aquellos casos
en los que no existe análogo en inglés.
</para>

<para>
En el <emphasis remap="bf">INSFLUG</emphasis> se orienta preferentemente a la traducción de documentos
breves, como los <emphasis>COMOs</emphasis> y <emphasis>PUFs</emphasis> (<emphasis remap="bf">P</emphasis>reguntas de
<emphasis remap="bf">U</emphasis>so <emphasis remap="bf">F</emphasis>recuente, las <emphasis remap="it">FAQs</emphasis>. <literal remap="tt">:)</literal> ), etc.
</para>

<para>
Diríjase a la sede del INSFLUG para más información al respecto.
</para>

<para>
En la sede del INSFLUG encontrará siempre las <emphasis remap="bf">últimas</emphasis> versiones 
de las traducciones:  <literal remap="tt"><ulink
url="http://www.insflug.org"
>www.insflug.org</ulink
></literal>. Asegúrese de comprobar cuál es la última versión 
disponible en el Insflug antes de bajar un documento de un servidor réplica.
</para>

<para>
Se proporciona también una lista de los servidores
réplica (<emphasis remap="it">mirror</emphasis>) del Insflug más cercanos a Vd.,  
e información relativa a otros recursos en castellano.
</para>

<para>
Francisco José Montilla, <literal remap="tt"><ulink
url="mailto:pacopepe@insflug.org"
>pacopepe@insflug.org</ulink
></literal>.
</para>

</sect1>

</article>
