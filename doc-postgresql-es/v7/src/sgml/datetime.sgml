<!--
$Header: /home/cvs/lucas/doc-postgresql-es/v7/src/sgml/datetime.sgml,v 1.2 2001/10/11 21:46:25 rssantos Exp $
Date/time details

$Log: datetime.sgml,v $
Revision 1.2  2001/10/11 21:46:25  rssantos

 viene de la 7.0.1

Revision 1.6  2001/04/21 22:12:31  olea
No más retornos de carro de msdos... ódiolos.

Revision 1.5  2001/04/21 21:57:13  olea
Esta es la guarrada que me ha pedido que haga Roberto. Que dios nos coja
confesaos.

Revision 2.6  2000/02/02 16:21:06  thomas
Add detailed information on Australian time zones.

Revision 2.5  1999/10/12 13:57:04  thomas
Sequence of date interpretation not quite right.

Revision 2.4  1999/06/23 06:17:51  thomas
Clarify input/output timezone information.
Add detail on exact interpretation of "concatenated date"
 for various lengths.

Revision 2.3  1999/05/26 17:30:28  thomas
Add chapters on CVS access, MVCC, SQL theory to the docs.
Add an appendix with more details on date/time attributes and handling.
Update most references to Postgres version numbers to 6.5,
 *except* for the porting list which will require a report
 from a successful installation to be updated.

Revision 2.2  1999/05/22 02:27:23  thomas
Finish initial markup of cvs.sgml, and include it in the programmer's guide
 and the integrated doc. Clean up other markup.

-->

<appendix label="UG1" id="datetime-appendix">
 <title id="datetime-appendix-title">ayuda de fecha/hora</title>

 <sect1>
  <title>Zonas horarias</title>

  <para>
   <productname>Postgres</productname>debe tener información tabular interna para decodificar la zona horaria, desde que no hay un sistema estandar de interface *nix para proveer acceso a lo general, información de zona de tiempo cruzada. El SO subyacente <emphasis>es </emphasis> usado para proveer información de zona de tiempo para<emphasis>salidas</emphasis>.

   <table tocentry="1">
    <title>Zonas de tiempo reconocidas por<productname>Postgres</productname></title>
    <titleabbrev>Zonas de tiempo</titleabbrev>
    <tgroup cols="3">
     <thead>
      <row>
       <entry>Zona de Tiempo</entry>
       <entry>fuera de UTC</entry>
       <entry>descripción</entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>NZDT</entry>
       <entry>+13:00</entry>
       <entry>Hora de luz del día de nueva Zelanda</entry>
      </row>
      <row>
       <entry>IDLE</entry>
       <entry>+12:00</entry>
       <entry>Fecha internacional lineal, Este</entry>
      </row>
      <row>
       <entry>NZST</entry>
       <entry>+12:00</entry>
       <entry>Hora Std de Nueva Zelanda</entry>
      </row>
      <row>
       <entry>NZT</entry>
       <entry>+12:00</entry>
       <entry>Hora de Nueva Zelanda</entry>
      </row>
      <row>
       <entry>AESST</entry>
       <entry>+11:00 </entry>
       <entry>Hora de verano Std de Australia del este</entry>
      </row>
      <row>
       <entry>ACSST</entry>
       <entry>+10:30 </entry>
       <entry>Hora de verano Std de Australia Central</entry>
      </row>
      <row>
       <entry>CADT</entry>
       <entry>+10:30 </entry>
       <entry>Hora de luz del día de Australia</entry>
      </row>
      <row>
       <entry>SADT</entry>
       <entry>+10:30</entry>
       <entry>Hora de luz del día de Australia del sur</entry>
      </row>
      <row>
       <entry>AEST</entry>
       <entry>+10:00 </entry>
       <entry>Hora Std de Australia del este</entry>
      </row>
      <row>
       <entry>EAST</entry>
       <entry>+10:00 </entry>
       <entry>Hora Std de Australia del Este</entry>
	</row>
      <row>
       <entry>GST</entry>
       <entry>+10:00</entry>
       <entry>Hora de Guam Std, Zona 9 de USSR </entry>
      </row>
      <row>
       <entry>LIGT</entry>
       <entry>+10:00</entry>
       <entry>Melbourne, Australia</entry>
      </row>
      <row>
       <entry>ACST</entry>
       <entry>+09:30 </entry>
       <entry>Hora Std de Australia Central</entry>
      </row>
      <row>
       <entry>CAST</entry>
       <entry>+09:30 </entry>
       <entry>Hora Std de Australia Central</entry>
      </row>
      <row>
       <entry>SAT</entry>
       <entry>+9:30</entry>
       <entry>Hora Std de Australia del sur</entry>
      </row>
      <row>
       <entry>AWSST</entry>
       <entry>+9:00 </entry>
       <entry>Hora Std de verano de Austrialia del oeste</entry>
      </row>
      <row>
       <entry>JST</entry>
       <entry>+9:00</entry>
       <entry>Hora Std de Japón, Zona 8 de USSR</entry>
      </row>
      <row>
       <entry>KST</entry>
       <entry>+9:00</entry>
       <entry>Hora estandart de Korea</entry>
      </row>
      <row>
       <entry>WDT</entry>
       <entry>+9:00</entry>
       <entry>Hora de luz del día del Oste de Australia</entry>
      </row>
      <row>
       <entry>MT</entry>
       <entry>+8:30</entry>
       <entry>Hora de Moluccas</entry>
      </row>
      <row>
       <entry>AWST</entry>
       <entry>+8:00 </entry>
       <entry>Hora Std de Australia del oeste</entry>
      </row>
      <row>
       <entry>CCT</entry>
       <entry>+8:00 </entry>
       <entry>Hora de la costa de China</entry>
      </row>
      <row>
       <entry>WADT</entry>
	 <entry>+8:00</entry>
       <entry>Hora de luz del día del oeste de australia</entry>
      </row>
      <row>
       <entry>WST</entry>
       <entry>+8:00</entry>
       <entry>Hora Std del Oeste de Australia</entry>
      </row>
      <row>
       <entry>JT</entry>
       <entry>+7:30</entry>
       <entry>Hora de Java</entry>
      </row>
      <row>
       <entry>WAST</entry>
       <entry>+7:00</entry>
       <entry>Hora Std del Oeste de Australia</entry>
	</row>
      <row>
       <entry>IT</entry>
	 <entry>+3:30</entry>
       <entry>Hora de Irán</entry>
      </row>
      <row>
       <entry>BT</entry>
       <entry>+3:00 </entry>
       <entry>Hora de Baghdad</entry>
      </row>
      <row>
       <entry>EETDST</entry>
       <entry>+3:00 </entry>
       <entry>Hora de luz del día en Europa del este</entry>
      </row>
      <row>
       <entry>CETDST</entry>
       <entry>+2:00 </entry>
       <entry>Hora de luz del día en Europa Central</entry>
      </row>
      <row>
       <entry>EET</entry>
       <entry>+2:00 </entry>
       <entry>Europa del Este,Zona 1 de USSR</entry>
      </row>
      <row>
       <entry>FWT</entry>
       <entry>+2:00</entry>
       <entry>Hora de invierno Frances</entry>
      </row>
      <row>
       <entry>IST</entry>
       <entry>+2:00</entry>
       <entry>Hora Std de Israel</entry>
      </row>
      <row>
       <entry>MEST</entry>
       <entry>+2:00</entry>
       <entry>Hora de verano de Europa del centro</entry>
      </row>
	<row>
       <entry>METDST</entry>
       <entry>+2:00</entry>
       <entry>Hora de luz del día en Europa del centro</entry>
      </row>
      <row>
       <entry>SST</entry>
       <entry>+2:00</entry>
       <entry>Hora de verano de Suecia</entry>
      </row>
      <row>
       <entry>BST</entry>
       <entry>+1:00 </entry>
       <entry>Hora de verano de Inglaterra</entry>
      </row>
      <row>
       <entry>CET</entry>
       <entry>+1:00 </entry>
       <entry>Hora de Europa central</entry>
      </row>
      <row>
       <entry>DNT</entry>
       <entry>+1:00 </entry>
       <entry>Hora normal de Dansk</entry>
      </row>
      <row>
       <entry>DST</entry>
       <entry>+1:00 </entry>
       <entry>Hora estandart de Dansk(?)</entry>
      </row>
      <row>
       <entry>FST</entry>
       <entry>+1:00 </entry>
       <entry>Hora de verano Francesa</entry>
	</row>
      <row>
       <entry>MET</entry>
       <entry>+1:00</entry>
       <entry>Hora de Europa del Centro</entry>
      </row>
      <row>
       <entry>MEWT</entry>
       <entry>+1:00</entry>
       <entry>Hora de invierno de Europa del Centro</entry>
	</row>
      <row>
       <entry>MEZ</entry>
       <entry>+1:00</entry>
       <entry>Zona de Europa del Centro</entry>
      </row>
      <row>
       <entry>NOR</entry>
       <entry>+1:00</entry>
       <entry>Hora estandart de Norway</entry>
      </row>
      <row>
       <entry>SET</entry>
       <entry>+1:00</entry>
       <entry>Hora de Seychelles</entry>
      </row>
      <row>
       <entry>SWT</entry>
       <entry>+1:00</entry>
       <entry>Hora de invierno de Suecia</entry>
      </row>
      <row>
       <entry>WETDST</entry>
       <entry>+1:00</entry>
       <entry>Hora de luz del día del Oeste de Europa</entry>
      </row>
      <row>
       <entry>GMT</entry>
       <entry>0:00</entry>
       <entry>Hora principal de Greenwish</entry>
      </row>
      <row>
       <entry>WET</entry>
       <entry>0:00</entry>
       <entry>Europa del Oeste</entry>
      </row>
      <row>
       <entry>WAT</entry>
       <entry>-1:00</entry>
       <entry>Hora del oeste de Africa</entry>
      </row>
      <row>
       <entry>NDT</entry>
       <entry>-2:30</entry>
       <entry>Hora de luz del día de Newfoundland</entry>
      </row>
      <row>
       <entry>ADT</entry>
       <entry>-03:00 </entry>
       <entry>Hora de luz del día de Atlantic</entry>
      </row>
      <row>
       <entry>NFT</entry>
       <entry>-3:30</entry>
       <entry>Hora estandart de Newfoundland</entry>
      </row>
      <row>
       <entry>NST</entry>
       <entry>-3:30</entry>
       <entry>Hora estandart de Newfoundland</entry>
      </row>
      <row>
       <entry>AST</entry>
       <entry>-4:00 </entry>
       <entry>Hora Std de Atlantic(Canada)</entry>
      </row>
      <row>
       <entry>EDT</entry>
       <entry>-4:00 </entry>
       <entry>Hora de luz del día del este</entry>
      </row>
      <row>
       <entry>ZP4</entry>
       <entry>-4:00</entry>
       <entry>GMT +4 hours</entry>
      </row>
      <row>
       <entry>CDT</entry>
       <entry>-5:00 </entry>
       <entry>Hora de luz del día Central</entry>
      </row>
      <row>
       <entry>EST</entry>
       <entry>-5:00 </entry>
       <entry>Hora estandart del este</entry>
      </row>
      <row>
       <entry>ZP5</entry>
       <entry>-5:00</entry>
       <entry>GMT +5  hours</entry>
      </row>
      <row>
       <entry>CST</entry>
       <entry>-6:00 </entry>
       <entry>Hora Std Central</entry>
      </row>
      <row>
       <entry>MDT</entry>
       <entry>-6:00</entry>
       <entry>Hora de luz del día de la Montaña</entry>
      </row>
      <row>
       <entry>ZP6</entry>
       <entry>-6:00</entry>
       <entry>GMT +6  hours</entry>
      </row>
      <row>
       <entry>MST</entry>
       <entry>-7:00</entry>
       <entry>Hora estandart de la montaña</entry>
      </row>
      <row>
       <entry>PDT</entry>
       <entry>-7:00</entry>
       <entry>Hora de luz del día del Pacífico</entry>
      </row>
      <row>
       <entry>PST</entry>
       <entry>-8:00</entry>
       <entry>Hora Std del Pacífico</entry>
      </row>
      <row>
       <entry>YDT</entry>
       <entry>-8:00</entry>
       <entry>Hora de luz del día de Yukon</entry>
      </row>
      <row>
       <entry>HDT</entry>
       <entry>-9:00</entry>
       <entry>Hora de luz del día en Hawaii/Alaska</entry>
      </row>
      <row>
       <entry>YST</entry>
       <entry>-9:00</entry>
       <entry>Hora estandart de Yukon</entry>
      </row>
      <row>
       <entry>AHST</entry>
       <entry>-10:00 </entry>
       <entry>Hora Std de Alaska-Hawaii</entry>
      </row>
      <row>
       <entry>CAT</entry>
       <entry>-10:00 </entry>
       <entry>Hora de Alaska Central</entry>
      </row>
      <row>
       <entry>NT</entry>
       <entry>-11:00</entry>
       <entry>Hora Nome</entry>
      </row>
      <row>
       <entry>IDLW</entry>
	 <entry>-12:00</entry>
       <entry>Linea de Fecha Internacional, Oeste</entry>
      </row>
     </tbody>
    </tgroup>
   </table>
  </para>

<sect2>
   <title>Zonas Horarias Australianas</title>

   <para>
    Las zonas horarias Australianas y sus variantes de denominación
    cuentan con un curato de la totalidad de las zonas horarias de la tabla de búsqueda 
    de las zonas horarias de <productname>Postgres</productname>.
    Hay dos conflictos de denominación con zonas horarias en común definidas 
    en los Estados Unidos, <literal>CST</literal> y <literal>EST</literal>.
   </para>

   <para>
    Si la opción del compilador USE_AUSTRALIAN_RULES esta activa 
    entonces <literal>CST</literal> y <literal>EST</literal> se interpretaran siguiendo
    los convenios Australianos.

    <table tocentry="1">
     <title>Zonas Horarias Australianas de <productname>Postgres</productname></title>
     <titleabbrev>zonas horarias Australianas</titleabbrev>
     <tgroup cols="3">
      <thead>
       <row>
	<entry>Zona Horaria</entry>
	<entry>Desplazamiento desde UTC</entry>
	<entry>Descripción</entry>
       </row>
      </thead>
      <tbody>
       <row>
	<entry>CST</entry>
	<entry>+10:30</entry>
	<entry>Tiempo Estándar Central de Australia</entry>
       </row>
       <row>
	<entry>EST</entry>
	<entry>+10:00</entry>
	<entry>Tiempo Estándar Oriental de Australia</entry>
       </row>
      </tbody>
     </tgroup>
    </table>
   </para>
  </sect2>

  <sect2>
   <title>Interpretación de las entradas de Fecha/tiempo</title>

   <para>
Los tipos de fecha/tiempo son todos decodificados usando un conjunto de rutinas comunes.
   </para>

   <procedure>
    <title>Interpretación de las entradas de Fecha/tiempo</title>

    <step>
     <para>
Partiendo la cadena de entrada en muestras y clasificando cada uno de las marcas
como cadena, tiempo, zona horaria, o número.
     </para>

     <substeps>
      <step>
       <para>
	Si la muestra contiene dos puntos (":"), esto es una cadena de tiempo.
       </para>
      </step>

      <step>
       <para>
	si la muestra contiene un guión ("-"), barra ("/"), o un punto ("."),
	esto es una cadena de fecha que puede tener el nombre del mes.
       </para>
      </step>

      <step>
       <para>
	Si la muestra es solamente numérica, entonces es cualquiera de estas opciones 
        un campo sencillo un fecha concatenada ISO-8601 (p.e. "19990113" para 13 Enero del 1999)
	o tiempo (p. e. 141516 para 14:15:16).
       </para>
      </step>
      <step>
       <para>
	Si la muestra comienza con un mas ("+") o un menos ("-"),
	entonces es o una zona horaria o un campo especial.
       </para>
      </step>
     </substeps>
    </step>

    <step>
     <para>
        Si la muestra es una cadena de texto, compara con posibles cadenas.
     </para>
     
     <substeps>
      <step>
       <para>
	Hacer un búsqueda binaria en la tabla de consulta de la muestra
	para cada cadena especial (p. e. <literal>today</literal>),
	day (p. e. <literal>Thursday</literal>),
	month (p. e. <literal>January</literal>),
	o noise word (p. e. <literal>on</literal>).
       </para>
       <para>
	Pone los valores del campo y la mascara de bit para los campos.
	Por ejemplo, pone año, mes, día para <literal>today</literal>, 
	y adicionalmente hora, minutos, segundos para <literal>now</literal>.
       </para>
      </step>
      
      <step>
       <para>
	Si no lo encuentra, hace una búsqueda binaria similar en la tabla de consulta 
        para encontrar la muestra a la zona horaria.
       </para>
      </step>

      <step>
       <para>
	Si no lo encuentra, lanza un error.
       </para>
      </step>
     </substeps>
    </step>
    
    <step>
     <para>
      La muestra es un número o un campo numérico.
     </para>

     <substeps>
      <step>
       <para>
	Si hay más de 4 dígitos, 
	y si no se ha leído con posterioridad otro campo de tipo fecha, entonces lo interpretará 
	como un "fecha concatenada" (e.g. <literal>19990118</literal>). Con 8
	y 6 dígito se interpreta como año, mes, y día, mientras que con 7
	y 5 dígitos se interpreta como año, día del año, respectivamente.
       </para>
      </step>

      <step>
       <para>
	Si la muestra tiene 3 dígitos
	y un año ha sido decodificado, entonces se interpreta como día del año.
       </para>
      </step>
      
      <step>
       <para>
	Si es más largo que dos dígitos, entonces se interpreta como el año.
       </para>
      </step>

      <step>
       <para>
	Si está en modo fecha Europea, y si el campo día no ha sido leído todavía,
	y si el valor es más pequeño o igual a 31, entonces se interpreta como un día.
       </para>
      </step>

      <step>
       <para>
	Si el campo mes no ha sido leído todavía,
	y si el valor es más pequeño o igual que 12, entonces se interpreta como un mes.
       </para>
      </step>

      <step>
       <para>
	Si el campo día no ha sido leído todavía,
	y si el valor es más pequeño o igual que 31, entonces se interpreta como un día.
       </para>
      </step>

      <step>
       <para>
	Si no, se interpreta como un año.
       </para>
      </step>
     </substeps>
    </step>

    <step>
     <para>
      Si se ha especificado AC, anula el año y desplaza uno al almacenado interno
      (no hay año cero en el calendario Gregoriano, pero numéricamente 1AC es el año cero).
     </para>
    </step>

    <step>
     <para>
      Si no se ha especificado, y si el campo año tiene dos dígitos de longitud, entonces
      ajustamos el año a 4 dígitos. Si el campo no es más pequeño que 70, entonces sumamos 2000;
      si no, sumamos 1900.

      <tip>
       <para>
	Los años Gregorianos 1-99AD pueden ser introducidos usando 4 dígitos precedidos
	por ceros (p. e. 0099 es 99AD). Los tres dígitos también son aceptados como un 
	año bajo muchas circunstancias, sin embargo dependiendo de la posición la cadena numérica 
        puede ser interpreta en lugar de un día.
       </para>
      </tip>
     </para>
    </step>
   </procedure>
  </sect2>
 </sect1>

 <sect1>
  <title>Historia</title>

  <note>
   <para>
    Contrido por 
    <ulink url="jose@sferacarta.com">José Soares</ulink>.
   </para>
  </note>

  <para>
   El día Juliano fue inventado por erudito francés Joseph Justus Scaliger (1540-1609)
   y probablemente coge su nombre del padre Scaliger, el erudito italiano Julius 
   Caesar Scaliger (1484-1558).
   los astrónomos tienen que usar el periodo Juliano para asignar un único número 
   cada día desde 1 de Enero de 4713 AC. Esto es el llamado Día Juliano (JD). 
   JD 0 designa 24 horas, del mediodía UTC del 1 de Enero de 4713 AC 
   hasta el mediodía UTC del 2 Enero 4713 AC.
  </para>

  <para>
   <quote>Día Juliano</quote> es diferente que <quote>Fecha Juliana</quote>.

   El calendario Juliano fue introducido por Julius Caesar en 45 AC. Fue usado comúnmente
   hasta el 1582, donde países empezaron a cambiarse al calendario Gregoriano.
   
   en el calendario Juliano, el año tropical es aproximadamente como 365 1/4
   días = 365.25 días. Esto da un error de un día en aproximadamente 128 días.
   El error acumulado del calendario movió al Papa Gregorio XIII ha reformar el calendario
   acorde con las instrucciones del Concilio de Trento.
  </para>

  <para>   
   En el calendario Gregoriano, el año tropical es aproximadamente 
   365 + 97 / 400 días = 365.2425 días. Así coge aproximadamente 3300
   años para el año tropical se desplace un día con respecto al calendario Gregoriano.
  </para>

  <para>
   La aproximación 365+97/400 esta lograda mediante 97 años bisiestos cada 400 años, 
   usando las siguientes reglas:

   <simplelist>
    <member>
     Cada año divisible por 4 es un año bisiesto.
    </member>
    <member>
     Sin embargo, cada año divisible por 100 no es un año bisiesto.
    </member>
    <member>
     Sin embargo, cada año divisible por 400 es un año bisiesto después de todo.
    </member>
   </simplelist>

   De este modo, 1700, 1800, 1900, 2100, y 2200 no son años bisiestos. pero 1600,
   2000, y 2400 son años bisiestos.

   Por el contrario, en el viejo calendario Juliano sólo los años divisibles por 4 son años bisiestos.
  </para>

  <para>
   La bula papal de Febrero del 1582 decretó que se debía quitar 10 días a Octubre de 1582, 
   así que el 15 de Octubre debe seguir inmediatamente después del 4 de Octubre.
   Esto se observó en Italia, Polonia, Portugal, y España. Los otros países Católicos
   lo siguieron poco después, pero los países Protestantes se resistieron al cambio,
   y los países ortodoxos griegos no cambiaron hasta que no empezó este siglo.

   La reforma fue observada por Gran Bretaña y sus Colonias (incluido lo que ahora es USA) en 1752.
   Así el 2 Septiembre 1752 fue seguido por el 14 Septiembre 1752.

   Esto es lo que tiene <application>cal</application> de los sistemas UNIX
   produciendo lo siguiente:

   <programlisting>
% cal 9 1752
   Septiembre 1752
 S  M Tu  W Th  F  S
       1  2 14 15 16
17 18 19 20 21 22 23
24 25 26 27 28 29 30
   </programlisting>
  </para>

  <note>
   <para>
    SQL92 dista que 
    <quote>Dentro de la definición del <sgmltag> fecha/tiempo literal </sgmltag>,
     los <sgmltag>valores fecha/tiempo </sgmltag> están restringidos por las reglas
    naturales para las fechas y los tiempos acorde con el calendario Gregoriano
    </quote>.
    Las Fechas entre 1752-09-03 y 1752-09-13, aunque se han eliminado en algunos países
    por el "fiat" Papal, conforme a las <quote>reglas naturales</quote> y 
    son por lo tanto fechas validas.
   </para>
  </note>

  <para>
   Diferentes calendarios han sido desarrollados en varios lugares del mundo,  muchos proceden 
   del sistema Gregoriano.

   Por ejemplo,
   Los principios del calendario Chino pueden remontarse hasta el siglo 14 AC. 
   La leyenda dice que el Emperador Huangdi inventó el calendario  en 2637 AC.
   
   La gente de la República de China usa el calendario Gregoriano para uso civil.
   El calendario Chino es utilizado para las fiestas.
  </para>
 </sect1>
</appendix>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:nil
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
sgml-parent-document:nil
sgml-default-dtd-file:"./reference.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:"/usr/lib/sgml/catalog"
sgml-local-ecat-files:nil
End:
-->

