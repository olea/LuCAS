<!--
$Header: /home/cvs/lucas/doc-postgresql-es/v6/Postgresql-es/src/sgml/ref/explain.sgml,v 1.6 2001/09/17 19:27:19 emaldonadog Exp $
Postgres documentation
-->

<refentry id="SQL-EXPLAIN">
 <refmeta>
  <refentrytitle id="SQL-EXPLAIN-TITLE">
   EXPLAIN
  </refentrytitle>
  <refmiscinfo>SQL - Language Statements</refmiscinfo>
 </refmeta>
 <refnamediv>
  <refname>
   EXPLAIN
  </refname>
  <refpurpose>
   Muestra el plan de ejecución de la sentencia
  </refpurpose>
 </refnamediv>

 <refsynopsisdiv>
  <refsynopsisdivinfo>
   <date>1999-07-20</date>
  </refsynopsisdivinfo>
  <synopsis>
EXPLAIN [ VERBOSE ] <replaceable class="PARAMETER">consulta</replaceable>        
  </synopsis>

  <refsect2 id="R2-SQL-EXPLAIN-1">
   <refsect2info>
    <date>1998-09-01</date>
   </refsect2info>
   <title>
    Entradas
   </title>
   <para>

    <variablelist>
     <varlistentry>
      <term>VERBOSE</term>
      <listitem>
       <para>
	Bandera para mostrar el plan detallado de la consulta.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable class="PARAMETER">consulta</replaceable></term>
      <listitem>
       <para>
	Cualquier <replaceable class="PARAMETER">consulta</replaceable>.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </para>
  </refsect2>

  <refsect2 id="R2-SQL-EXPLAIN-2">
   <refsect2info>
    <date>1998-04-15</date>
   </refsect2info>
   <title>
    Salidas
   </title>
   <para>

    <variablelist>
     <varlistentry>
      <term><computeroutput>
NOTICE:  QUERY PLAN:
<replaceable>plan</replaceable>
      </computeroutput></term>
      <listitem>
       <para>
        Plan de consulta explícito del backend <productname>Postgres</productname>.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><computeroutput>
EXPLAIN
       </computeroutput></term>
      <listitem>
       <para>
        Bandera enviada luego de mostrarse el plan.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </para>
  </refsect2>
 </refsynopsisdiv>

 <refsect1 id="R1-SQL-EXPLAIN-1">
  <refsect1info>
   <date>1998-04-15</date>
  </refsect1info>
  <title>
   Descripción
  </title>

  <para>
   Este comando muestra el plan de ejecución que el planificador Postgres
   genera para la consulta dada.  El plan de ejecución muestra la manera
   en que serán escaneadas las tablas referenciadas --- ya sea escaneo
   secuencial plano, escaneo por índice, etc. --- y si se referencian
   varias tablas, los algoritmos de unión que serán utilizados para
   agrupar las tuplas requeridas para cada tabla de entrada.
  </para>

  <para>
   La parte más critica de la presentación es el costo estimado de
   ejecución de la consulta, que es la suposición del planificador sobre
   el tiempo que tomará correr la consulta (medido en unidades de captura
   de páginas de disco). En realidad se muestran dos números: el tiempo
   inicial que toma devolverse la primer tupla, y el tiempo total para
   devolver todas las tuplas.  Para la mayoría de las consultas lo que
   importa es el tiempo total, pero en algunos casos como una sub-consulta
   EXISTS el planificador escogerá el menor tiempo inicial en vez del menor
   tiempo total (ya que en todo caso el ejecutor se detendrá después de
   obtener la primer tupla).
   También, si Ud. limita el número de tuplas a devolver con una cláusula
   LIMIT, el planificador realiza una interpolación apropiada entre los
   dos costos finales para estimar cuál de los planes es realmente el menos
   costoso.
  </para>

  <para>
   La opción VERBOSE emite la representación interna completa del árbol del
   plan, en vez de un resumen (y lo envía al archivo log del postmaster
   también). Usualmente esta opción es únicamente útil para la corrección de
   errores (debug) de Postgres.
  </para>

  <refsect2 id="R2-SQL-EXPLAIN-3">
   <refsect2info>
    <date>1998-04-15</date>
   </refsect2info>
   <title>
    Notas
   </title>
   <para>
    Existe escasa documentación en <productname>Postgres</productname> con
    respecto a la utilización por parte del optimizador de la información de
    costos.
    Información general sobre la estimación de costos para la optimización de
    las consultas puede encontrarse en libros de textos de bases de datos.
    Refiérase a los capítulos sobre índices y el optimizador genético de
    consultas de la <citetitle>Guía del Programador</citetitle> para mayor
    información.
   </para>
  </refsect2>
 </refsect1>

 <refsect1 id="R1-SQL-EXPLAIN-2">
  <title>
   Uso
  </title>

  <para>
   Para mostrar un plan de consulta para una consulta simple sobre una tabla
   con una única columna de tipo <type>int4</type> y 128 filas:

   <programlisting>
EXPLAIN SELECT * FROM foo;
    <computeroutput>
NOTICE:  QUERY PLAN:

Seq Scan on foo  (cost=0.00..2.28 rows=128 width=4)

EXPLAIN
    </computeroutput>
   </programlisting>
  </para>

  <para>
   Para la misma tabla con un índice para lograr una condición
   <firstterm>equijoin</firstterm> en la consulta, <command>EXPLAIN</command>
   mostrará un plan distinto:

   <programlisting>
EXPLAIN SELECT * FROM foo WHERE i = 4;
    <computeroutput>
NOTICE:  QUERY PLAN:

Index Scan using fi on foo  (cost=0.00..0.42 rows=1 width=4)

EXPLAIN
    </computeroutput>
   </programlisting>
  </para>

  <para>
   Y para terminar, para la misma tabla con un índice para lograr una
   condición <firstterm>equijoin</firstterm> en la consulta,
   <command>EXPLAIN</command> mostrará lo siguiente para una consulta que
   utilice una función de agregación:

   <programlisting>
EXPLAIN SELECT sum(i) FROM foo WHERE i = 4;
    <computeroutput>
NOTICE:  QUERY PLAN:

Aggregate  (cost=0.42..0.42 rows=1 width=4)
  ->  Index Scan using fi on foo  (cost=0.00..0.42 rows=1 width=4)
    </computeroutput>
   </programlisting>
  </para>

  <para>
   Nótese que los números específicos mostrados, y aún la estrategia de
   consulta seleccionada, pueden variar entre dos versiones de Postgres
   debido al mejoramiento del planificador.
  </para>
 </refsect1>

 <refsect1 id="R1-SQL-EXPLAIN-3">
  <title>
   Compatibilidad
  </title>

  <refsect2 id="R2-SQL-EXPLAIN-4">
   <refsect2info>
    <date>1998-09-01</date>
   </refsect2info>
   <title>
    SQL92
   </title>
   <para>
    No existe una sentencia <command>EXPLAIN</command> definida en SQL92.
   </para>
  </refsect2>
 </refsect1>
</refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:nil
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
sgml-parent-document:nil
sgml-default-dtd-file:"../reference.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:"/usr/lib/sgml/catalog"
sgml-local-ecat-files:nil
End:
-->
