<?xml version="1.0" encoding="iso-8859-1" ?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook V4.1.2//EN"
"http://www.oasis-open.org/docbook/xml/4.1.2/docbookx.dtd">

<article>

<articleinfo>

<title>Terminales Serie COMO</title>

<author>
<firstname>Marc Malagelada Duch marc@hades.udg.es

Maquetador Linuxdoc-SGML: Antonio Ismael Olea González, 

<ulink
url="mailto:olea@poboxes.com"
>olea@poboxes.com</ulink
>2:345/108.9@fidonet.org</firstname>
</author>

<pubdate> v2.0 13 Septiembre 96</pubdate>

<abstract>

<para>
 Todo sobre la instalación y configuración de terminales en sistemas Linux,
desde diagramas y técnicas de soldadura de los cables, hasta los detalles
de configuración del hardware y software. 
</para>

</abstract>

</articleinfo>

<sect1>
<title>Introducción</title>

<para>
Creo que conectar un terminal a un <emphasis remap="bf">Linux</emphasis> es una de las experiencias
más bonitas que se pueden hacer para ver cómo tu PC monousuario se
convierte en una auténtica estación de trabajo multiusuario, además de
poder aprovechar tu viejo PC-XT o PC-AT para terminal. 
</para>

<para>
Lo que hace falta es un PC con <emphasis remap="bf">Linux</emphasis>, que supongo que ya tenéis, que
disponga de un puerto serie libre. <emphasis remap="it">Cuidadín cuidadín</emphasis> con esas
máquinas con COM3 y COM4 que suelen compartir IRQ con COM1 y COM2, de
forma que suelen traer problemas cuando se usa por ejemplo COM1 y COM3 o
COM2 y COM4.
</para>

<para>
También hace falta un terminal, que debe disponer de un puerto serie. Lo
mismo dicho antes para los COM3 y los COM4, es también aplicable aquí si
ese terminal va a ser vuestro viejo PC-XT o cualquier otro PC.
</para>

<para>
Igualmente le va a hacer falta un software de emulación de terminal para
poder cumplir su misión. Ese software puede ser el mismo software que se
usa para llamar por el módem, por ejemplo el TELIX, el PROCOMM+, o el
<emphasis remap="it">Terminal</emphasis> del <emphasis>Ventanucos</emphasis>. Si el terminal es realmente un
terminal, por ejemplo un DEC VT220 o similar, va a ser más fácil, aunque
no todo el mundo tiene un terminal en su casa, es más frecuente encontrar
un viejo 8088. 
</para>

<para>
Para poder transmitir los datos hace falta un cable de los llamados
<emphasis remap="it">null-módem</emphasis> o de <emphasis remap="it">líneas cruzadas</emphasis>, habiéndolos de muchos tipos. El
que yo tengo montado es el mismo que el que recomienda el MSDOS para usar
el INTERLNK/INTERSVR, que además funciona de maravilla en <emphasis remap="bf">Linux</emphasis>.
</para>

<para>
Por último, hacen falta unas pocas ganas de hacer pruebas.
</para>

</sect1>

<sect1>
<title>Hardware</title>

<sect2>
<title>Puertos serie</title>

<para>
Puertos serie hay de 2 tipos: Los DB25 y los DB9.
</para>

<para>
Los DB9 son los vulgarmente (e incorrectamente) conocidos como puertos de
mouse. Tienen 9 patillas y son "macho" es decir: que las
patillas son pinchos. En los conectores "hembra", las patillas
son orificios para que entren los pinchos. Cualquier semejanza con el sexo
real está hecha con toda la intencionalidad. <literal remap="tt">:-)</literal>
</para>

<para>
&ensp;

</para>

<para>
&ensp;

</para>

<sect3>
<title>Puerto serie DB9</title>

<para>
A continuación os pongo un "gráfico" cutre para que sepáis que
es lo que hay que ver detrás del PC para localizar el puerto serie: 

<screen>
                             .---------------.
                             \   o o o o o   /
                              \   o o o o   /
                               `-----------'
</screen>

</para>

<para>
Si localizáis alguno, que además tiene que ser macho (pinchos) 
seguramente se trata de un puerto serie. 
</para>

<para>
Si lo encontráis en su versión "hembra" (con orificios) se
trata de el adaptador de VÍDEO (CGA, Hércules, EGA o VGA-digital). 
</para>

</sect3>

<sect3>
<title>Puerto serie DB25</title>

<para>
También podéis encontrar su versión de 25 pines:
</para>

<para>

<screen>
                     .-------------------------------.
                     \   o o o o o o o o o o o o o   /
                      \   o o o o o o o o o o o o   /
                       `---------------------------' 
</screen>

</para>

<para>
Igualmente, las patillas tienen que ser pinchos. Si son orificios, se
trata de un puerto de impresora. 
</para>

<para>
Debéis localizar uno de los dos en cada uno de los PCs (<emphasis remap="bf">Linux</emphasis> y
terminal)  Seguramente vais a encontrar que en alguno de ellos hay de los
dos. Para saber si se trata del COM1 o del COM2 lo más práctico es
conectar un ratón y cargar el driver para COM1 o para COM2 y ver si
funciona. 
</para>

<para>
Las situaciones más normales son:
</para>

<para>

<itemizedlist>
<listitem>

<para>
Si sólo se encuentra uno de ellos, es el COM1;
</para>
</listitem>
<listitem>

<para>
Si se encuentran los dos, normalmente el pequeño es el COM1 y el
otro es el COM2; 

</para>
</listitem>
<listitem>

<para>
Si hay 2 pequeños hay que descifrar cuál es el COM1 y cuál el COM2. 
Esto sucede con equipos <emphasis remap="it">HP</emphasis> y <emphasis remap="it">COMPAQ</emphasis>, y suele venir indicado cuál
es el 1 y cuál es el 2. Si no, a por un ratón serie y hacer pruebas. 

</para>
</listitem>
<listitem>

<para>
<emphasis remap="it">¡No los encuentro!</emphasis>: Mejor pasar un programa de información del
PC para saber si hay puertos serie disponibles. Uno de fácil localización
es el <literal remap="tt">msd.exe</literal> del MSDOS6.2 (Teclear <literal remap="tt">msd</literal> y pulsar la C). 
</para>
</listitem>

</itemizedlist>

</para>

<para>
Una vez localizados los puertos serie de cada PC, voy a escribir algunas
recomendaciones: 
</para>

<para>

<itemizedlist>
<listitem>

<para>
Mejor no utilizar el COM3 si se usa el COM1. Igualmente no usar el
COM4 si se usa el COM2
<footnote>

<para>
N. del Revisor: 
 
Podremos usar dichos puertos siempre que: 

a) Configuremos el hardware (por BIOS o por <emphasis remap="it">jumpers</emphasis>) para
usar alguna otra IRQ libre, y 
 
b) Configuremos el Linux para que los inicialice al arrancar con
el comando <literal remap="tt">setserial</literal>, ver <emphasis remap="it">Serie-Como</emphasis>.
</para>

</footnote>


</para>
</listitem>
<listitem>

<para>
<emphasis remap="it">Cuidadín cuidadín</emphasis> con los tornillos que hay en los lados de los
conectores; hay que comprobar que están bien atornillados ya que de lo
contrario podría caer la tuerca interior dentro de la caja del PC y
provocar un desastre. 

</para>
</listitem>

</itemizedlist>

</para>

</sect3>

</sect2>

</sect1>

<sect1>
<title>Cableado</title>

<sect2 id="nllmdm">
<title>Cables NULL MÓDEM </title>

<para>
Bueno, voy a explicar qué son las líneas (patillas) del puerto serie: 
</para>

<para>
<variablelist>

<varlistentry>
<term>GND</term>
<listitem>
<para>
Es la masa. Como toda señal, tiene que estar referida a una masa. 
</para>
</listitem></varlistentry>
<varlistentry>
<term>RX</term>
<listitem>
<para>
Señal de recepción. Son los datos que se reciben. (entrada)
</para>
</listitem></varlistentry>
<varlistentry>
<term>TX</term>
<listitem>
<para>
Señal de transmisión. Por aquí salen los datos. (salida)
</para>
</listitem></varlistentry>
<varlistentry>
<term>DTR</term>
<listitem>
<para>
<emphasis remap="it">Data Terminal Ready</emphasis>. Indica que el terminal está encendido. 
(salida) 
</para>
</listitem></varlistentry>
<varlistentry>
<term>DSR</term>
<listitem>
<para>
<emphasis remap="it">Data Set Ready</emphasis>. Se ha establecido conexión. (entrada)
</para>
</listitem></varlistentry>
<varlistentry>
<term>CTS</term>
<listitem>
<para>
<emphasis remap="it">Clear To Send</emphasis>. El terminal está aceptando datos. (salida)
</para>
</listitem></varlistentry>
<varlistentry>
<term>RTS</term>
<listitem>
<para>
<emphasis remap="it">Request to Send</emphasis>. Aquí se introduce una señal cuando se
pide un dato. (in)
</para>
</listitem></varlistentry>
</variablelist>
</para>

<para>
Esto que hay aquí no puedo decir que sea correcto del todo. Eso es lo que
me he deducido yo después de hojearme el manual del chip 8250 (UART) y
leer alguna cosa sobre transmisiones RS232.
</para>

<sect3>
<title>NULL MÓDEM de 3 hilos</title>

<para>
El cable Null-módem más básico que existe es el siguiente:
</para>

<para>

<screen>
GND---------------------------------------------------GND
RX----------------------------------------------------TX
TX----------------------------------------------------RX
</screen>

</para>

<para>
Ese mismo ya funciona con el <emphasis remap="bf">Linux</emphasis>. Sólo 3 cables. Para controlar el
flujo de datos se usa el protocolo por software <emphasis remap="bf">XON/XOFF</emphasis>
</para>

</sect3>

<sect3>
<title>NULL MÓDEM de 3 hilos con protocolo por hardware emulado</title>

<para>
Otro cable null-módem es el siguiente:
</para>

<para>

<screen>
GND --------------------------------------------------GND
RX----------------------------------------------------TX
TX----------------------------------------------------RX
RTS--------.                                 .--------RTS
            )                               (
CTS--------'                                 `--------CTS
DSR--------.                                 .--------DSR
            )                               (  
DTR--------'                                 `--------DTR
</screen>

</para>

<para>
Este emula el protocolo <emphasis remap="bf">CTS/RTS</emphasis> y <emphasis remap="bf">DSR/DTR</emphasis> por hardware,
aunque sólo es eso, una emulación. Para controlar el flujo de datos se
sigue recurriendo al protocolo software <emphasis remap="bf">XON/XOFF</emphasis>. 
</para>

</sect3>

<sect3>
<title>NULL MÓDEM de 7 hilos con protocolo por hardware</title>

<para>

<screen>
GND --------------------------------------------------GND
RX----------------------------------------------------TX
TX----------------------------------------------------RX
RTS---------------------------------------------------CTS
CTS---------------------------------------------------RTS
DSR---------------------------------------------------DTR
DTR---------------------------------------------------DSR
</screen>

</para>

<para>
Este cable usa el protocolo <emphasis remap="bf">CTS/RTS</emphasis> para controlar el flujo por
hardware e incluye las líneas <emphasis remap="bf">DSR-DTR</emphasis> para saber si el terminal
está conectado.  Sigue funcionando si se usa protocolo por software. 
</para>

<para>
Yo creo que es el más flexible; además, ese mismo cable es el que se
usa para el INTERLNK/INTERSVR de MSDOS, o el LAPLINK (WIN o DOS).  
Es el que tengo yo montado. 
</para>

</sect3>

</sect2>

<sect2>
<title>Construcción física del cable</title>

<sect3>
<title>Listado de las patillas</title>

<para>
Las patillas físicas en los pines son las siguientes:
</para>

<para>

<screen>
Segnal              Patilla en DB9           Patilla en DB25
--------------------------------------------------------------
GND:..................patilla 5................patilla 7
RX:...................patilla 2................patilla 3
TX:...................patilla 3................patilla 2
RTS:..................patilla 7................patilla 4
CTS:..................patilla 8................patilla 5
DSR:..................patilla 6................patilla 6
DTR:..................patilla 4................patilla 20
</screen>

</para>

</sect3>

<sect3>
<title>Localización física de las patillas en un DB9</title>

<para>
Los conectores suelen llevar una chuleta numerando los pines en el
plástico que rodea a los susodichos, ese plástico que a veces es azul, o a
veces en negro o a veces es blanco.  Vista desde el LADO DE FUERA DEL PC,
que también concuerda con la vista desde la CARA DE LAS SOLDADURAS de un
DB9 Hembra usado para construir el cable: 
</para>

<para>

<screen>
      			    .---------------.
 			    \   1 2 3 4 5   /
			     \   6 7 8 9   /
    			      `-----------'
</screen>

</para>

<para>
Vista desde el lado de fuera de un DB9 Hembra usado para construir el
cable:
</para>

<para>

<screen>
  			    .---------------.
   			    \   5 4 3 2 1   /
    			     \   9 8 7 6   /
    			      `-----------'
</screen>
  
</para>

</sect3>

<sect3>
<title>Localización física de las patillas de un DB25</title>

<para>
  
</para>

<para>
Vista desde el <emphasis remap="bf">exterior del PC</emphasis>, que también concuerda con la vista
desde la <emphasis remap="bf">cara de las soldaduras</emphasis> de un DB25 hembra usado para construir
el cable: 
</para>

<para>

<screen>
             .-----------------------------------------------.
             \   13  12  11  10  9  8  7  6  5  4  3  2  1   /
              \    25  24  23  22 21 20 19 18 17 16 15 14   /
               `-------------------------------------------'
</screen>
 
</para>

<para>
Vista desde el lado de fuera de un DB25 hembra usado para construir el
cable: 
</para>

<para>

<screen>
             .-----------------------------------------------.
             \   1  2  3  4  5  6  7  8  9  10  11  12  13   /
              \   14 15 16 17 18 19 20 21 22  23  24  25    /
               `-------------------------------------------'
</screen>

</para>

</sect3>

<sect3>
<title><emphasis remap="it">Soldar-Como</emphasis></title>

<para>
Hay que soldar, de manera que deberíais procuraros un poco de estaño
(metal para hacer la soldadura) y un pequeño soldador de más de 15W. 
</para>

<para>
Recomendaciones para soldar:
</para>

<para>
Calentar con la punta del soldador los extremos de los cables a soldar y
mientras estén calientes, depositar en la punta un poco de estaño. Parece
que hacen falta 3 manos para hacer esa operación, una para aguantar el
cable, otra para el soldador y la tercera para aguantar el estaño. Hacedlo
de la siguiente manera: 
</para>

<para>

<orderedlist>
<listitem>

<para>
Primero pelar las puntas de los cables de colores para dejar el
cobre al descubierto. 

</para>
</listitem>
<listitem>

<para>
Después, con una mano aguantar el cable, y con la otra el soldador,
tras haber estañado previamente la punta del mismo. Para eliminar el
exceso de estaño de la punta, introducirla en un trozo de esponja
inservible humedecida. 

</para>
</listitem>
<listitem>

<para>
Calentar la punta del cable y mientras se hace eso, acercar el
conjunto soldador-cable al hilo de estaño y fundir un poco. 

</para>
</listitem>
<listitem>

<para>
Esperar a que el estaño fluya por la superficie del cable y entonces
apartar el soldador. 
</para>
</listitem>

</orderedlist>

</para>

<para>
Esa operación se debe repetir para todos los cables de colores. No tengáis
miedo de quemar los cables con la temperatura del soldador. Los cables
deberían estar preparados. 
</para>

<para>
Con esa operación estáis <emphasis remap="bf">estañando</emphasis> el cable.
</para>

<para>
Hay que estañar también los pines de los conectores DB25 y/o DB9, que es
más fácil: con el conector apoyado encima de la mesa, y el soldador en una
mano, se toca el pin en el que deberá ir soldado un cable, y se espera un
momentito a que se caliente; con la otra mano se acerca el estaño, que con
la temperatura va a fundirse dejando la superficie del pin a soldar
<emphasis remap="it">forrada</emphasis> de estaño. 
</para>

<para>
Por último, con el conector apoyado encima de la mesa, con una mano se
coge el soldador y con la otra se acerca el cable que debe ir soldado en
el pin, se ponen en contacto cable y pin (los dos bien estañados) y se
toca con el soldador alguna de las dos partes (mejor las dos). El estaño
se va a fundir y va a poner en contacto cable y pin. Entonces se retira el
soldador y se espera que el estaño se enfríe. No soplar para acelerar el
enfriamiento, ya que podría dar lugar a soldaduras frías. Ya está hecha la
soldadura. 
</para>

<para>
Para los que quieran pasarse de listos y no quieran "perder el
tiempo" estañando las cosas, se van a dar cuenta que para soldar un
cable a un conector les harán falta 4 manos: 
</para>

<para>

<itemizedlist>
<listitem>

<para>
Una para aguantar el soldador;
</para>
</listitem>
<listitem>

<para>
Otra para aguantar el estaño;
</para>
</listitem>
<listitem>

<para>
Otra para aguantar el cable;
</para>
</listitem>
<listitem>

<para>
Y la última para aguantar el conector.
</para>
</listitem>

</itemizedlist>
  
</para>

<para>
Así que no os lo recomiendo a no ser que dispongáis de 4 manos.
</para>

<para>
Ánimo que es <emphasis remap="bf">MUY</emphasis> fácil; saber soldar os va a solucionar muchos
problemas, y además vais a poder solucionar muchas averías por culpa de
soldaduras rotas o defectuosas.
</para>

</sect3>

<sect3>
<title>Ejemplos de cables: DB25-DB25</title>

<para>
Conexión de un PC-<emphasis remap="bf">Linux</emphasis> con conector DB25 y un terminal con conector
DB25. 
</para>

<para>
Material necesario: 
</para>

<para>

<itemizedlist>
<listitem>

<para>
2 conectores DB25 hembra;
</para>
</listitem>
<listitem>

<para>
2 carcasas para DB25;
</para>
</listitem>
<listitem>

<para>
Cable de 7 hilos (o más) con malla, comprar los metros necesarios.
</para>
</listitem>

</itemizedlist>

</para>

<para>
La longitud del cable no debe sobrepasar los 30 metros. 
</para>

<para>
Precio aproximado:
</para>

<para>

<itemizedlist>
<listitem>

<para>
400 ptas para los 2 conectores con carcasa y
</para>
</listitem>
<listitem>

<para>
100 ptas el metro en Girona para el cable.
</para>
</listitem>

</itemizedlist>

</para>

<para>
Conexiones:
</para>

<para>

<screen>
  7 (GND) -----------------------------------------7 (GND)
  2 (TX) ------------------------------------------3 (RX)
  3 (RX) ------------------------------------------2 (TX)
  5 (CTS) -----------------------------------------4 (RTS)
  4 (RTS) -----------------------------------------5 (CTS)
  6 (DSR) -----------------------------------------20 (DTR)
  20 (DTR)-----------------------------------------6 (DSR)
  CHASIS-------------------(malla)-------------------CHASIS
</screen>

</para>

<para>
La malla del cable (tejido de cobre que envuelve los cablecillos finos) 
debe conectarse al chasis (parte metálica) del conector. 
</para>

<para>
La conexión de la malla establece el mismo nivel de potencial (voltaje) 
entre los 2 PCs y evita que grandes cargas de electricidad estática fluyan
a través de las líneas y fundan el chip del puerto serie. Además, se
produce un efecto de apantallamiento, que evita que señales
electromagnéticas interfieran en la información que circula por la línea. 
</para>

<para>
Eso va sobre todo para la gente que en su casa no dispone de toma de
tierra o que tiene el PC sobre una superficie de moqueta o alfombra. Si al
tocar tu PC recibes calambres, asegúrate que la malla esta conectada o
<emphasis remap="bf">seguro</emphasis> que vas a fundir el puerto serie de tu PC o terminal. 
</para>

<para>
Igual que en otro documento, también voy a decir que algunas veces he oído
que el chip del puerto serie explota, literalmente vuela por los aires, al
conectar un cable sin malla. 
</para>

<para>
Por eso os recomiendo que CONECTÉIS <emphasis remap="bf">SIEMPRE</emphasis> LA MALLA.
</para>

</sect3>

<sect3>
<title>Ejemplos de Cables: DB9-DB9</title>

<para>
Conexión de un PC-<emphasis remap="bf">Linux</emphasis> con conector DB9 y un terminal con conector
DB9.  
</para>

<para>
Material necesario:
</para>

<para>

<itemizedlist>
<listitem>

<para>
2 conectores DB9 hembra;
</para>
</listitem>
<listitem>

<para>
2 Carcasas para DB9;
</para>
</listitem>
<listitem>

<para>
Cable de 7 hilos (o más) con malla, comprar los metros necesarios. 
</para>
</listitem>

</itemizedlist>

</para>

<para>
La longitud del cable no debe sobrepasar los 30 metros. 
</para>

<para>
Precio aproximado: 
</para>

<para>

<itemizedlist>
<listitem>

<para>
350 ptas para los 2 conectores con carcasa, y
</para>
</listitem>
<listitem>

<para>
100 ptas el metro en Girona para el cable.
</para>
</listitem>

</itemizedlist>

</para>

<para>
Conexiones:
</para>

<para>

<screen>
  5 (GND) -----------------------------------------5 (GND)
  3 (TX) ------------------------------------------2 (RX)
  2 (RX) ------------------------------------------3 (TX)
  8 (CTS) -----------------------------------------7 (RTS)
  7 (RTS) -----------------------------------------8 (CTS)
  6 (DSR) -----------------------------------------4 (DTR)
  4 (DTR)------------------------------------------6 (DSR)
  CHASIS-------------------(malla)------------------CHASIS
</screen>

</para>

<para>
La malla del cable (tejido de cobre que envuelve los cablecillos finos) 
debe conectarse al chasis (parte metálica) del conector. 
</para>

<para>
La conexión de la malla establece el mismo nivel de potencial (voltaje) 
entre los 2 PCs y evita que grandes cargas de electricidad estática fluyan
a través de las líneas y fundan el chip del puerto serie. Además, se
produce un efecto de apantallamiento, que evita que señales
electromagnéticas interfieran en la información que circula por la línea. 
</para>

<para>
Eso va sobre todo para la gente que en su casa no dispone de toma de
tierra o que tiene el PC sobre una superficie de moqueta o alfombra. Si al
tocar tu PC recibes calambres, asegúrate que la malla esta conectada o
<emphasis remap="bf">seguro</emphasis> que vas a fundir el puerto serie de tu PC o terminal.
</para>

<para>
Igual que en otro documento, también voy a decir que algunas veces he oído
que el chip del puerto serie explota, literalmente vuela por los aires, al
conectar un cable sin malla. 
</para>

<para>
Por eso os recomiendo que CONECTÉIS <emphasis remap="bf">SIEMPRE</emphasis> LA MALLA.
</para>

</sect3>

<sect3>
<title>Ejemplos de cables: DB25-DB9 o DB9-DB25</title>

<para>
Conexión de un PC-<emphasis remap="bf">Linux</emphasis> con conector DB25 y un terminal con conector
DB9, o de un PC-<emphasis remap="bf">Linux</emphasis> con conector DB9 y un terminal con conector
DB25. (es el mismo cable)
</para>

<para>
Material necesario:
</para>

<para>

<itemizedlist>
<listitem>

<para>
1 conector DB9 hembra;
</para>
</listitem>
<listitem>

<para>
1 conector DB25 hembra;
</para>
</listitem>
<listitem>

<para>
1 carcasa para DB25;
</para>
</listitem>
<listitem>

<para>
1 carcasa para DB9;
</para>
</listitem>
<listitem>

<para>
Cable de 7 hilos (o más) con malla, comprar los metros necesarios. 
</para>
</listitem>

</itemizedlist>

</para>

<para>
La longitud del cable no debe sobrepasar los 30 metros.
</para>

<para>
Precio aproximado: 
</para>

<para>

<itemizedlist>
<listitem>

<para>
375 ptas para los 2 conectores con carcasa, y 
</para>
</listitem>
<listitem>

<para>
100 ptas el metro en Girona para el cable.
</para>
</listitem>

</itemizedlist>

</para>

<para>
Conexiones:
</para>

<para>

<screen>
Conector DB9                                    Conector DB25
  7 (GND) -----------------------------------------7 (GND)
  3 (TX) ------------------------------------------3 (RX)
  2 (RX) ------------------------------------------2 (TX)
  8 (CTS) -----------------------------------------4 (RTS)
  7 (RTS) -----------------------------------------5 (CTS)
  6 (DSR) -----------------------------------------20 (DTR)
  2 (DTR)------------------------------------------6 (DSR)
  CHASIS-------------------(malla)-----------------CHASIS
</screen>

</para>

<para>
La malla del cable (tejido de cobre que envuelve los cablecillos finos) 
debe conectarse al chasis (parte metálica) del conector. 
</para>

<para>
La conexión de la malla establece el mismo nivel de potencial (voltaje)
entre los 2 PCs y evita que grandes cargas de electricidad estática fluyan
a través de las líneas y fundan el chip del puerto serie. Además, se
produce un efecto de apantallamiento, que evita que señales
electromagnéticas interfieran en la información que circula por la línea.
</para>

<para>
Eso va sobre todo para la gente que en su casa no dispone de toma de
tierra o que tiene el PC sobre una superficie de moqueta o alfombra. Si al
tocar tu PC recibes calambres, asegúrate que la malla esta conectada o
<emphasis remap="bf">seguro</emphasis> que vas a fundir el puerto serie de tu PC o terminal.
</para>

<para>
Igual que en otro, documento también voy a decir que algunas veces he
oído que el chip del puerto serie explota, literalmente vuela por los
aires, al conectar un cable sin malla.
</para>

<para>
Por eso os recomiendo que CONECTÉIS <emphasis remap="bf">SIEMPRE</emphasis> LA MALLA.
</para>

</sect3>

</sect2>

<sect2>
<title>Compra del cable ya hecho</title>

<sect3>
<title>Cables NULL-MÓDEM </title>

<para>
Hay que pedir un cable tipo NULL-MÓDEM en alguna tienda de
electrónica o de ordenadores. Alguna gente también los conoce como cables
cruzados o cables de <emphasis remap="it">LAPLINK</emphasis>. 
</para>

<para>
Es bastante difícil encontrar un cable ya montado con la conexión de los
pines que nos conviene, aunque como este montaje es bastante frecuente, es
posible encontrarlo; no obstante, no os quejéis después si no funciona,
porque bajo la denominación "null-módem" hay un montón de
cables diferentes, como los que se comentaban en la sección <xref linkend="nllmdm"/>. 
</para>

<para>
Si has ido a parar a esta sección porque no sabes soldar, te recomiendo
que lo pruebes, es bastante fácil. Léete las recomendaciones, y si las
cumples el éxito esta asegurado. 
</para>

<para>
Además, los cables ya hechos valen bastante dinero.
</para>

<para>
Para el <emphasis remap="bf">Linux</emphasis> os va a funcionar casi cualquier tipo de null-módem,
pero el INTERLNK/INTERSVR requiere la configuración exacta. 
</para>

</sect3>

<sect3>
<title>Solución con cajitas NULL-MÓDEM y cable de módem</title>

<para>
Si no encontráis cables null-módem, podéis hacer lo siguiente:
</para>

<para>
Comprar un cable de módem (pin a pin) y luego insertar entre el PC y uno
de los cabos del cable de módem una caja de empalmes con configuración
NULL-MÓDEM. 
</para>

<para>
Caja de empalmes:
</para>

<para>

<screen>
                    _____.-----------------------------.____
                   !     !    --------------------     !    !
                   !     !    !                  !     !    !
                   !     !    !                  !     !    !
           DB25-&#62;  !     !    !    NULL-MODEM    !     !    !  &#60;-DB25
                   !     !    !                  !     !    !
                   !     !    !                  !     !    !
                   !     !    --------------------     !    !
                   `----.!_____________________________!.---'
</screen>

</para>

<para>
Que se monta de la siguiente manera:
</para>

<para>

<screen>
                    caja
            ----    null                                   -------
                !   modem                                  !
            PC  !_.------._  _      cable de modem        _! PC
                !  nllmdm  || `==========================' !
                !-.______.-'`-'      (pin a pin)         `-!
             ___!                                          !------
</screen>

</para>

<para>
Esa opción en bastante cara, ya que un cable de módem ya vale al menos 600
ptas, y si le añadimos el coste de la caja mull-módem (1000ptas), te puede
salir bastante caro. Te sigo recomendando que pruebes a hacer la soldadura
tú mismo.
</para>

</sect3>

</sect2>

<sect2>
<title>Conectores DIGITAL VT320 y 420</title>

<para>
El conector de <emphasis remap="it">DIGITAL EQUIPMENT CORPORATION</emphasis> (DEC) para la serie de
terminales <emphasis remap="it">VT320</emphasis> y <emphasis remap="it">VT420</emphasis> no es tan raro como parece.
</para>

<para>
Ese conector se llama <emphasis remap="it">DEC-423 MMJ</emphasis> (<emphasis remap="it">Modified Modular Jack</emphasis>) y se
parece a un RJ45 pero con la lengüeta descentrada
<footnote>

<para>
Nota del
maquetador 
 
Los RJ45 son esos conectores transparentes de 8 hilos algo
más gordos que los RJ11 del teléfono, también llamados <emphasis remap="it">Giant Modular
Jack</emphasis>, empleados en los cables de red de par trenzado. 
<literal remap="tt">:-)</literal>
</para>

</footnote>

</para>

<para>
&emsp; 

</para>

<para>
&emsp; 

</para>

<para>
&emsp; 

</para>

<para>
&emsp; 

</para>

<para>
El patillaje es el siguiente:
</para>

<para>

<screen>
                      DTR   TX    GND   GND   RX    DSR
                  ----------------------------------------
                  !   !_!   !_!   !_!   !_!   !_!   !_!   !
                  !                                       !
                  !                                       !
                  !                                       !
                  !                                       !
                  !                                       !
                  !                                       !
                  !                                       !
                  !                                       !
                  !_____________________                  !
                                        !                 !
                                        !                 !
                                        !_________________!
</screen>

</para>

</sect2>

</sect1>

<sect1>
<title>Configuración del software</title>

<sect2>
<title>Linux</title>

<para>
Entra como superusuario y modifica el <literal remap="tt">/etc/inittab</literal> de la
siguiente manera: 
</para>

<para>

<itemizedlist>
<listitem>

<para>
Tienes que buscar la sección <literal remap="tt">#Serial lines</literal> y añadir
una línea como la siguiente: 


<screen>
s2:45:respawn:/sbin/agetty -L 38400 ttyS1
</screen>


En la que habrá que cambiar algunas cosas dependiendo del puerto serie del
PC-<emphasis remap="bf">Linux</emphasis> en donde tengas el terminal conectado: 

<variablelist>

<varlistentry>
<term>Si tienes el terminal en el COM1:</term>
<listitem>
<para>
<literal remap="tt">s1:45:respawn:/sbin/agetty -L 9600 ttyS0</literal>
</para>
</listitem></varlistentry>
<varlistentry>
<term>Si tienes el terminal en el COM2:</term>
<listitem>
<para>
<literal remap="tt">s2:45:respawn:/sbin/agetty -L 9600 ttyS1</literal>
</para>
</listitem></varlistentry>
<varlistentry>
<term>Si tienes el terminal en el COM3:</term>
<listitem>
<para>
<literal remap="tt">s3:45:respawn:/sbin/agetty -L 9600 ttyS2</literal>
</para>
</listitem></varlistentry>
<varlistentry>
<term>Si tienes el terminal en COM4:</term>
<listitem>
<para>
<literal remap="tt">s4:45:respawn:/sbin/agetty -L 9600 ttyS3</literal>
</para>
</listitem></varlistentry>
</variablelist>

</para>
</listitem>
<listitem>

<para>
Una vez insertada esa línea en <literal remap="tt">/etc/inittab</literal>, hay que hacer
que el proceso <literal remap="tt">init</literal> relea el fichero <literal remap="tt">inittab</literal>; para ello
ejecutaremos la orden: 


<screen>
init q
</screen>


</para>
</listitem>

</itemizedlist>

</para>

</sect2>

<sect2>
<title>El terminal.</title>

<para>
Cargar el MSDOS y entrar en el programa de emulación de terminales. 
</para>

<para>
Debes elegir el tipo de terminal ANSI o, VT100, VT102, VT220, VT52.  
</para>

<para>
Cualquiera de ellos debería funcionar como mínimo para comprobar que la
línea funciona. 
</para>

<para>
Los parámetros del puerto serie deben ser 9600,N,8,1. 
</para>

<para>
Apretando un par de <emphasis remap="it">ENTER</emphasis>s debería salir en la pantalla del terminal
el texto de LOGIN. 
</para>

<para>
Si eso no funciona, algo está pasando en las líneas serie.
</para>

</sect2>

<sect2>
<title>Afinando Linux para la conexión</title>

<para>
Espero que hayáis llegado hasta aquí sin mucha dificultad.
</para>

<sect3>
<title>Explicación de la línea del <literal remap="tt">inittab</literal></title>

<para>
Aquí voy a explicar esa línea que hay que añadir al <literal remap="tt">inittab</literal>.
</para>

<para>
&emsp; 

</para>

<para>
&emsp; 

</para>

<para>
&emsp; 

</para>

<para>
&emsp; 

</para>

<para>
&emsp; 

</para>

<para>
&emsp; 

</para>

<para>
&emsp; 

</para>

<para>
&emsp; 

</para>

<para>
&emsp; 

</para>

<para>
&emsp; 

</para>

<para>
&emsp; 

</para>

<para>
&emsp; 

</para>

<para>
&emsp; 

</para>

<para>
&emsp; 

</para>

<para>
&emsp; 

</para>

<para>
&emsp; 

</para>

<para>
Qué significa cada cosa:

<screen>
s2:45:respawn:/sbin/agetty -L 9600 ttyS1  
^  ^     ^             ^      ^      ^ 
|  |     |             |      |      |
|  |     |             |      |      `---- /dev/ttyS1 es decir COM2:
|  |     |             |      |            es el dispositivo que soporta
|  |     |   	       |      |            la conexion. Se puede cambiar
|  |     |             |      |            por ttyS0, ttyS2 o ttyS3.
|  |     |             |      |
|  |     |             |      |
|  |     |             |      `------- Baudios a los que se efectua la 
|  |     |             |               conexion: puede ser uno de los
|  |     |             |               siguientes: 300, 600, 1200, 2400
|  |     |             |               9600, 19200, 38400, 57600, 115200
|  |     |             |               Si tienes una UART tipo 8250 o 
|  |     |             |               16450 mejor que no pases de 9600
|  |     |             |               so pena de freir el PC a interrup-
|  |     |             |               ciones. En el terminal da igual
|  |     |             |               porque no tiene que hacer nada mas,
|  |     |             |               pero en el PC-Linux importa no 
|  |     |             |               pasarse so pena de perder potencia
|  |     |             |               de multiproceso.
|  |     |             |               Recomiendo 19200 baudios.
|  |     |             |
|  |     |             |
|  |     |             `-- Programa que va a controlar la comunicacion por
|  |     |                 la parte Linux. Existen el controlador 
|  |     |                 agetty, otro es el uugetty. Tambien esta el getty
|  |     |                 Aqui hay que jugar un poco. Yo uso agetty, que no
|  |     |                 quiere decir que sea el mejor, pero funciona.
|  |     |
|  |     |
|  |     `----- No puedo asegurar que eso sea cierto, pero me parece que 
|  |            sirve para que el proceso agetty se auto-restaure cuando
|  |            por alguna razon muera.
|  |
|  |
|  `----- No puedo asegurar que sea cierto, pero me parece que son los
|         runlevels validos para que funcione ese terminal.
|
`----- Identificacion. Cuando por ejemplo se hace 'top' salen los procesos
       que estan funcionando en la maquina. Una de las columnas del top 
       es la del terminal donde se estan ejecutando. En los procesos
       ejecutados desde este terminal va a salir el 's2' o lo que se
       escriba aqui.
</screen>

</para>

</sect3>

<sect3>
<title>Parámetros de <literal remap="tt">agetty</literal></title>

<para>
Fijáos que en la línea que estamos estudiando, le paso el parámetro
<literal remap="tt">-L</literal> a <literal remap="tt">agetty</literal>. Si hacéis <literal remap="tt">man agetty</literal> podréis comprobar porqué
hago eso: estoy forzando a que la línea sea local, es decir, que no se
haga la la comprobación del pin de <literal remap="tt">CD</literal> (<emphasis remap="it">Carrier Detect</emphasis>). Ese pin
debería estar conectado en el cable, pero no lo hago para mantener la
compatibilidad con el INTERLNK/INTERSVR de Microsoft MSDOS. Una vez más el
<emphasis remap="bf">Linux</emphasis> se adapta a las necesidades del usuario. (¿¡Me suena esa frase
a WIN95!?) 
</para>

<para>
También podéis activar el protocolo de hardware <emphasis remap="bf">RTS/CTS</emphasis>, que
acelerará un poco la comunicación. Para hacer eso necesitáis que el cable
os soporte esa función; además deberéis configurar el terminal o mejor
dicho, El software de terminal para que lo haga. Yo no lo tengo
habilitado.  Para activar el protocolo por hardware <emphasis remap="bf">CTS/RTS</emphasis>
pasadle el parámetro '<literal remap="tt">-h</literal>' a <literal remap="tt">agetty</literal>, por ejemplo: 
</para>

<para>

<screen>
s2:45:respawn:/sbin/agetty -hL 9600 ttyS1  
</screen>

</para>

</sect3>

</sect2>

<sect2>
<title>Afinando el terminal</title>

<para>
Aquí más que un afinamiento os voy a explicar cómo instalar el
Telix 3.22 para DOS para que haga de terminal.
</para>

<para>

<itemizedlist>
<listitem>

<para>
 Primero tenéis que conseguir los archivos vía FTP o vía
algún cdrom de Shareware
<footnote>

<para>
N. del R. 
 O de cualquier
BBS
</para>

</footnote>
. Yo voy a explicar la versión 3.22, que no es la última,
pero tampoco es vieja. 

Los archivos se llaman: 


<itemizedlist>
<listitem>

<para>
<literal remap="tt">tlx322-1.zip</literal>
</para>
</listitem>
<listitem>

<para>
<literal remap="tt">tlx322-2.zip</literal>
</para>
</listitem>
<listitem>

<para>
<literal remap="tt">tlx322-3.zip</literal>
</para>
</listitem>
<listitem>

<para>
<literal remap="tt">tlx322-4.zip</literal>
</para>
</listitem>

</itemizedlist>
 

De los cuales sólo vais a necesitar los dos primeros.

</para>
</listitem>
<listitem>

<para>
 Descomprimid los ZIPs <literal remap="tt">tlx322-1.zip</literal> y <literal remap="tt">tlx322-1.zip</literal> en un
directorio. Una vez descomprimidos, ejecutad '<literal remap="tt">MODEMCFG.EXE</literal>' y escoged
alguno de los de 1200 baudios (para que no quiera grabar la RAM del
módem). Seleccionas el puerto correspondiente y sales del programa. 

</para>
</listitem>
<listitem>

<para>
 Si te falta espacio (o quieres tener el Telix en un disquete
porque no tienes disco duro o por comodidad) puedes cargarte el
<literal remap="tt">CS.EXE</literal> y el <literal remap="tt">CSS.EXE</literal>.

Yo tengo Telix322 + MSDOS6.2 + <literal remap="tt">KERMIT.EXE</literal> en 1 disco de 720K.

</para>
</listitem>
<listitem>

<para>
Ejecutar <literal remap="tt">TELIX.EXE</literal> y una vez haya intentado sin resultado
inicializar el módem, pulsas <emphasis remap="it">ALT-O</emphasis> (opciones).

</para>
</listitem>
<listitem>

<para>
Te vas a <emphasis remap="it">Modem and dialing</emphasis> y en el módem <emphasis remap="it">init string</emphasis> le
pones un par de <emphasis remap="it">control-M</emphasis> (se hace poniendo un acento circunflejo &circ; y
una M).

</para>
</listitem>
<listitem>

<para>
Te vas al <emphasis remap="it">Terminal options</emphasis> y pones lo pertinente en la opción
A: por ejemplo COM2, 19200, None, 8, 1. 

</para>
</listitem>
<listitem>

<para>
El el mismo menú de <emphasis remap="it">Terminal Options</emphasis>, la opción <emphasis remap="it">C</emphasis> debería
estar en ANSI o en VT102.

</para>
</listitem>
<listitem>

<para>
En el mismo menú de <emphasis remap="it">Terminal Options</emphasis>, la opción <emphasis remap="it">I</emphasis> debería
estar en: <emphasis remap="it">Backspace key sends DEL</emphasis>.

</para>
</listitem>
<listitem>

<para>
En el mismo menú de <emphasis remap="it">Terminal Options</emphasis>, vas a encontrar la
opción <emphasis remap="it">K</emphasis> que sirve para controlar el flujo por hardware. (<literal remap="tt">agetty
-h</literal>).

</para>
</listitem>
<listitem>

<para>
Finalmente te vas a <emphasis remap="it">Write Setup to Disk</emphasis>.

</para>
</listitem>
<listitem>

<para>
Sales del Telix: <emphasis remap="it">ALT-X</emphasis>

</para>
</listitem>
<listitem>

<para>
Vuelves a entrar. Te debería salir el login en la pantalla.
</para>
</listitem>

</itemizedlist>

</para>

</sect2>

<sect2>
<title>Solución a posibles problemas</title>

<para>
Siempre se pueden tener problemas, aunque conozco a bastante gente que ha
montado este cable y le ha funcionado. 
</para>

<para>
Qué hacer si no funciona: 
</para>

<sect3>
<title>Comprobación del cable</title>

<para>
Para probar el cable, coges los 2 PCs, les pones en marcha un Telix y
pulsas en ambos <emphasis remap="it">ALT-P</emphasis>. 
</para>

<para>
Configura ambos PCs a una velocidad de 1200 baudios, N, 8,1.
</para>

<para>
Configura en cada PC el COM correspondiente.
</para>

<para>
Escribe desde un PC y tendrás que ver el texto en la pantalla del otro.
</para>

<para>
Prueba desde ambos PCs. Puede ser que la comunicación sólo sea
mono-direccional por algún defecto del cable o del hardware.
</para>

<para>
Si el cable está bien construido y el hardware no falla eso debería ir
bien. 
</para>

</sect3>

<sect3>
<title>El cable funciona pero Linux no.</title>

<para>
¿Qué velocidad escogiste? Prueba desde 9600 baudios a ver qué tal. 
</para>

<para>
Puede ser que tengas problemas de velocidad. Ejecuta MSD en ambos
ordenadores para ver qué UARTs tienen. Seguramente el PC viejo tendrá una
8250, por lo que no es recomendable pasar de 9600, aunque he probado a
19200 y suele funcionar.
</para>

<para>
Nuestro terminal en <literal remap="tt">hades.udg.es</literal> es un 286-12 con UART 8250 y le
podemos sacar 38400, aunque a veces falla.
</para>

<para>
¿Las velocidades son las mismas? 
</para>

<para>
La velocidad que escojas en el Telix o el programa que utilices para
emular un terminal tiene que ser la misma que configures en la línea del
<literal remap="tt">/etc/inittab</literal>.
</para>

<para>
¿Habilitaste algún protocolo por hardware? 
</para>

<para>
Algunos puertos serie no llevan todas las líneas, así que aunque el cable
las tenga, no llegan hasta el <emphasis remap="bf">Linux</emphasis> o el programa de terminal. 
Prueba deshabilitando el protocolo por hardware, es decir, quitando el
parámetro '<literal remap="tt">-h</literal>' del <literal remap="tt">agetty</literal> en <literal remap="tt">/etc/inittab</literal>, y
habilitando el protocolo <emphasis remap="bf">XON/XOFF</emphasis> por software en el programa de
comunicaciones.
</para>

<para>
¿Estás seguro que pusiste <literal remap="tt">ttyS0</literal> para COM1, <literal remap="tt">ttyS1</literal> para COM2,
<literal remap="tt">ttyS2</literal> para COM3 y <literal remap="tt">ttyS3</literal> para COM4? Es muy fácil colarse, el
<literal remap="tt">ttySx</literal> es siempre uno menos que el COMx. 
</para>

<para>
Puede que tengas algún problema de IRQs. ¿Estás compartiendo IRQ
con algún otro dispositivo?
</para>

<para>
Haz pruebas con el <literal remap="tt">minicom</literal> (clónico del Telix para <emphasis remap="bf">Linux</emphasis>) para
saber si los datos al menos llegan.
</para>

<para>
Comprueba los <emphasis remap="it">majors</emphasis> y los <emphasis remap="it">minors</emphasis> de los puertos de
comunicaciones: 
</para>

<para>

<screen>
/dev/ttyS0: crw-rw-rw-   X  USER GROUP  4,  64  xxx xx xx:xx ttyS0
/dev/ttyS1: crw-rw-rw-   X  USER GROUP  4,  65  xxx xx xx:xx ttyS1
/dev/ttyS2: crw-rw-rw-   X  USER GROUP  4,  66  xxx xx xx:xx ttyS2
/dev/ttyS3: crw-rw-rw-   X  USER GROUP  4,  67  xxx xx xx:xx ttyS3
                                        ^    ^
                                        |    |
                                        |    |
                                        |    `------MINOR
                                        `-----------MAJOR
</screen>

</para>

</sect3>

</sect2>

</sect1>

<sect1>
<title>Contacto</title>

<para>
 
</para>

<para>
Alguna sugerencia, o preguntas, dudas, cuestiones varias, etc a 
<literal remap="tt"><ulink
url="mailto:marc@hades.udg.es"
>marc@hades.udg.es</ulink
></literal>
o también a 
</para>

<para>

<itemizedlist>
<listitem>

<para>
<literal remap="tt"><ulink
url="mailto:mm6344@pluto.udg.es"
>mm6344@pluto.udg.es</ulink
></literal>
</para>
</listitem>
<listitem>

<para>
<literal remap="tt"><ulink
url="mailto:mm6344@speedy.udg.es"
>mm6344@speedy.udg.es</ulink
></literal>
</para>
</listitem>
<listitem>

<para>
<literal remap="tt"><ulink
url="mailto:marc@abu.udg.es"
>marc@abu.udg.es</ulink
></literal>
</para>
</listitem>

</itemizedlist>

</para>

<sect2>
<title>Agradecimientos</title>

<para>
 
</para>

<para>
A Paco (<literal remap="tt">paco@hades.udg.es</literal>) por poner la lista de <emphasis remap="bf">Linux</emphasis> en marcha
y por la ayuda recibida, que fue él quien me enseñó a conectar terminales
al <emphasis remap="bf">Linux</emphasis>. 
</para>

</sect2>

</sect1>

<sect1 id="Grupos">
<title>Anexo: El INSFLUG </title>

<para>
El <emphasis>INSFLUG</emphasis> forma parte del grupo internacional 
<emphasis remap="it">Linux Documentation Project</emphasis>, 
encargándose de las traducciones al castellano de los Howtos (Comos),
así como la producción de documentos originales en aquellos casos
en los que no existe análogo en inglés.
</para>

<para>
En el <emphasis remap="bf">INSFLUG</emphasis> se orienta preferentemente a la traducción de documentos
breves, como los <emphasis>COMOs</emphasis> y <emphasis>PUFs</emphasis> (<emphasis remap="bf">P</emphasis>reguntas de
<emphasis remap="bf">U</emphasis>so <emphasis remap="bf">F</emphasis>recuente, las <emphasis remap="it">FAQs</emphasis>. <literal remap="tt">:)</literal> ), etc.
</para>

<para>
Diríjase a la sede del INSFLUG para más información al respecto.
</para>

<para>
En la sede del INSFLUG encontrará siempre las <emphasis remap="bf">últimas</emphasis> versiones 
de las traducciones:  <literal remap="tt"><ulink
url="http://www.insflug.org"
>www.insflug.org</ulink
></literal>. Asegúrese de comprobar cuál es la última versión 
disponible en el Insflug antes de bajar un documento de un servidor réplica.
</para>

<para>
Se proporciona también una lista de los servidores
réplica (<emphasis remap="it">mirror</emphasis>) del Insflug más cercanos a Vd.,  
e información relativa a otros recursos en castellano.
</para>

<para>
Francisco José Montilla, <literal remap="tt"><ulink
url="mailto:pacopepe@insflug.org"
>pacopepe@insflug.org</ulink
></literal>.
</para>

</sect1>

</article>
