<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta name="generator" content="HTML Tidy for Linux/x86 (vers 1st July 2002), see www.w3.org" />
    <link rel="stylesheet" href="hoja-estilo.css" type="text/css" />

    <title>Trabajando con Docbook</title>
  </head>

  <body>
    <center>
      <h1>Trabajando con Docbook</h1>

      <p><a href="http://es.tldp.org"><img src="pinguipanza.png" title="La prohibida mascota lucasiana" border="0" /></a></p>

      <p>Por Ismael Olea &lt;<a href="mailto:ismael@olea.org">ismael@olea.org</a>&gt;<br />
      <font size="+1">Una conferencia <a href="http://hispalinux.es/cacle.php">CACLE</a></font></p>

      <p><a href="http://tldp.org"><img border="0" src="ldp-link.jpg" title="logo TLDP" /></a> <a href="http://hispalinux.es"><img src="hispalinux.png" title="Logo HL" border="0" /></a></p>
    </center>

    <h2>Objetivos</h2>

    <ul>
      <li>Conocer la DTD Docbook para crear documentación informática.</li>

      <li>Conocer las herramientas, el entorno de trabajo de docbook y los problemas más típicos.</li>
    </ul>

    <h2>Los documentos tienen estructura</h2>

    <p>Se presupone conocer los principios de la estructuración de documentos.</p>

    <h2>Presentación de Docbook</h2>

    <ul>
      <li>DTD técnica de informática</li>

      <li>libros, artículos, páginas de manual y colecciones de los mismos</li>

      <li>diseñado por la industria</li>

      <li>actualizado</li>

      <li>SGML/XML</li>

      <li>DSSSL/XSL</li>

      <li><a href="http://www.oreilly.com/pub/a/oreilly/frank/oscon_summit.html">estandarizado en todos los proyectos de soft libre importantes</a></li>

      <li>incluido en todas las distribuciones modernas</li>
    </ul>

    <h2>Recursos de trabajo mínimos</h2>

    <ul>
      <li>Manual de referencia: <a href="http://www.oasis-open.org/docbook/documentation/reference/">Docbook: The Definitive Guide</a></li>

      <li><a href="http://www.jclark.com/jade/">jade</a>/<a href="http://openjade.sourceforge.net/">openjade</a></li>

      <li>juego de dtds</li>

      <li>juegos de caracteres ISO</li>

      <li>docbook utils</li>

      <li>jadetex + TeX («opcional» para imprimir)</li>
    </ul>

    <h2>Paquetes para RH 7.*</h2>

    <p>Básicos:</p>

    <ul>
      <li>docbook-dtds</li>

      <li>docbook-style-dsssl</li>

      <li>docbook-utils</li>

      <li>docbook-utils-pdf</li>

      <li>jadetex</li>

      <li>tetex-*</li>

      <li>openjade</li>

      <li>sgml-common</li>

      <li>passivetex</li>

      <li>docbook-style-xsl</li>

      <li>xmlto</li>
    </ul>
    Opcional: 

    <ul>
      <li>psgml</li>
    </ul>

    <h2>Paquetes para Debian Woody/Linex</h2>

    <p>Método básico:</p>

    <ul>
      <li>apt-get install docbook-utils</li>

      <li><a href="http://tldp.org/authors/tools/ldp.dsl">http://tldp.org/authors/tools/ldp.dsl</a></li>
    </ul>

    <h2>Configuraciones: catálogos</h2>

    <dl>
      <dt>DOCTYPE</dt>

      <dd>
        <ul>
          <li>tipo de documento</li>

          <li>PUBLIC|PRIVATE</li>

          <li>Id de la versión de la DTD</li>
        </ul>
      </dd>
    </dl>
    Los catálogos son los directorios de recursos SGML/XML para su localización automática por parte del sistema. Deben funcionar de forma transparente para el usuario. En proceso de estandarización. 

    <ul>
      <li><a href="file:///etc/sgml">/etc/sgml</a></li>

      <li><a href="file:///etc/xml">/etc/xml</a></li>
    </ul>

    <h2>Configuraciones relacionadas con TeX</h2>

    <p>Para obtener los mejores resultados de impresión posibles, antes es preciso configurar o comprobar algunos puntos.</p>

    <p>Se usa TeX para la obtención de formatos de impresión PDF/PS. Jadetex/pdfjadetex es un intérprete TeX de macros para jade/openjade.</p>

    <ul>
      <li>
        Patrones de guionado de TeX 

        <ol>
          <li># texconfig</li>

          <li>-&gt;HYPHEN</li>

          <li>-&gt;pdflatex</li>

          <li>descomentar «%spanish sphyph.tex» (o los idiomas que tercien)</li>

          <li>salir de texconfig</li>
        </ol>
      </li>

      <li>
        Jadetex 

        <ul>
          <li>Configuración de los <a href="http://jadetex.sf.net">buffers de TeX</a></li>

          <li>Configuración del idioma español: jadetex.dtx \RequirePackage[german,frenchb,english]{babel}[1997/01/23]</li>
        </ul>
      </li>
    </ul>

    <h2>Estudio de un documento de ejemplo</h2>

    <p>A continuación examinaremos un ejemplo completo y funcional explicando cada parte paso a paso.</p>

    <center>
      <a href="ejemplos/apannao.txt">apannao.xml</a>
    </center>

    <h2>Usando el manual de referencia</h2>

    <p><a href="http://www.oasis-open.org/docbook/documentation/reference/html/docbook.html">Presentación de The Definitive Guide</a>.</p>

    <ul>
      <li>
        estructura del libro: 

        <ul>
          <li><a href="http://www.oasis-open.org/docbook/documentation/reference/html/part1.html">introducción</a></li>

          <li>
            <a href="http://www.oasis-open.org/docbook/documentation/reference/html/part2.html">referencia</a> 

            <ul>
              <li><a href="http://www.oasis-open.org/docbook/documentation/reference/html/refelem.html">marcas</a></li>

              <li><a href="http://www.oasis-open.org/docbook/documentation/reference/html/refpent.html">entidades parámetro</a></li>

              <li><a href="http://www.oasis-open.org/docbook/documentation/reference/html/refchar.html">entidades de juegos de caracteres</a></li>
            </ul>
          </li>

          <li><a href="http://www.oasis-open.org/docbook/documentation/reference/html/part3.html">apéndices</a></li>
        </ul>
      </li>

      <li>Explicación rápida de los juegos de caracteres (por qué hay que tenerlos en cuenta).</li>

      <li>Explicación de las secciones de una página de referencia de un elemento.</li>

      <li>Explicación de metodología propuesta de uso.</li>
    </ul>

    <h2>Trabajando: definición de entidades y descomposición en varios ficheros fuente</h2>

    <p>Las entidades tienen varios usos diferentes. Los más corrientes son:</p>

    <dl>
      <dt>Codificación de caracteres</dt>

      <dd>sirven para codificar, en ascii, caracteres nacionales o de difícil representación.</dd>

      <dt>Entidades generales internas</dt>

      <dd>sirven para crear acrónimos o macros.</dd>

      <dt>Entidades generales externas</dt>

      <dd>se usan para partir el código fuente en varios ficheros.</dd>
    </dl>
    Encontrarán información más detallada en <a href="file:///mnt/taca3/docbook/tdg/1.0.3/en/html/ch01.html#S-ENTITIES">The Definitive Guide</a>. 

    <h2>Trabajando: equivalencias prácticas entre Docbook SGML y Docbook XML</h2>

    <ul>
      <li>Con alguna rara excepción ambas DTD son iguales.</li>

      <li>Como XML es compatible con SGML es posible usar el ciclo de producción SGML sin inconveniente (la vía DSSSL).</li>
    </ul>

    <h2>Trabajando: diferencias prácticas entre Docbook SGML y Docbook XML</h2>

    <ul>
      <li>El sufijo :-)</li>

      <li>El código XML permitiría usar las herramientas XSL (no estudiadas en este curso).</li>

      <li>Con XML los elementos (las marcas) siempre estarán en minúsculas.</li>

      <li>Con XML siempre se escribirá el contenido de los atributos entre comillas.</li>

      <li>Con XML las marcas que no necesitan ser cerradas se escriben &lt;marca/&gt;.</li>

      <li>Con XML la primera línea siempre será una declaración XML explicando la versión de XML y el juego de caracteres.</li>
    </ul>

    <h2>Trabajando: usando un corrector ortográfico</h2>

    <center>
      aspell --lang=español -c -H fichero.xml
    </center>

    <h2>Trabajando: generando formatos de reproducción/impresión</h2>

    <dl>
      <dt><a href="ejemplos/apannao.pdf">Obtener PDF</a>:</dt>

      <dd>docbook2pdf <a href="ejemplos/apannao.txt">apannao.xml</a></dd>

      <dt><a href="ejemplos/html/art-apannao-desc.html">Obtener un documento HTML descompuesto en ficheros</a>:</dt>

      <dd>docbook2html -u <a href="ejemplos/apannao.txt">apannao.xml</a></dd>

      <dt><a href="ejemplos/apannao.html">Obtener HTML</a>:</dt>

      <dd>docbook2html <a href="ejemplos/apannao.txt">apannao.xml</a></dd>
    </dl>
    Otros filtros: docbook2dvi docbook2man docbook2ps docbook2tex docbook2txt docbook2rtf docbook2texi. 

    <h2>Trabajando: personalización de DTD</h2>

    <p>SGML y XML están concebidos para poder hacer modificaciones o extensiones a las DTD.</p>

    <p>En la práctica esta necesidad es muy rara. Además, al modificar la DTD perdemos facilidades de portabilidad entre sistemas y exige la ampliación o modificación de las hojas de estilo.</p>

    <p>Por todo ello no se considerará en este curso.</p>

    <h2>Trabajando: personalización de hojas de estilo DSSSL</h2>

    <p>Es posible personalizar el comportamiento de las hojas de estilo sin modificarlas usando un <a href="ldp.dsl">«driver»</a> DSSSL.</p>

    <p>Este «driver» sirve para <em>matizar</em> a las hojas actuales y deben incluir una referencia a las mismas para que el procesador DSSSL las localice.</p>

    <p>El driver se invocaría, por ejemplo:</p>

    <center>
      docbook2pdf -d ldp.dsl#print fichero.xml
    </center>

    <h2>Trabajando: personalización de hojas de estilo XSL</h2>

    <p>Dado que el ciclo de producción XSL no está tan maduro como el DSSSL no consideraremos en este curso la personalización de sus hojas de estilo.</p>

    <h2>Trabajando: personalización de hojas de estilo CSS</h2>

    <h2>Trabajando: uso de otras herramientas</h2>

    <p>Es posible usar herramientas que aumentan la productividad. Por ejemplo:</p>

    <dl>
      <dt>CVS</dt>

      <dd>Control de versiones y trabajo en grupo.</dd>

      <dt>Make</dt>

      <dd>Control del código fuente.</dd>
    </dl>

    <h2>Trabajando: experiencia: DocBook vs OpenOffice</h2>

    <p>Un <a href="https://listas.hispalinux.es/pipermail/docbook-ayuda/2003-May/000919.html">ejemplo real de uso en grupo</a> partiendo de cero, contada por J.Manrique Lopez.</p>

    <ul>
      <li>El director del grupo, partiendo de un desconocimiento técnico total, decide usar DocBook para el documento del anteproyecto.</li>

      <li>La coordinación del grupo, 13 personas, fue muy complicada, (mucha gente y muy acostumbrados al formato DOC).</li>

      <li>La única queja en la entrega, PDF, fue sobre el tamaño de la letra, el desconocimiento impidió crear un driver .dsl a tiempo.</li>

      <li>Para la segunda parte, a pesar de tener el driver .dsl y por problemas ajenos al desarrollo del proyecto, se debió cambiar a otra opción y el director del grupo optó por OpenOffice.</li>

      <li>
        Hubo quejas de todo tipo: 

        <ul>
          <li>Falta de enumeración en los títulos.</li>

          <li>No hay manera de dejar 2 tablas iguales: cada miembro del equipo las hizo como le vino en gana [...] y eso que se había acordado que se hiciesen con hoja de cálculo.</li>
        </ul>
        Los defectos fueron atribuidos a haber utilizado Software Libre, como si con Word no hubiera podido hacer lo mismo (de hecho Word necesita Acrobat para exportar PDF). 

        <p>Lo más doloroso fue oir a un profesor de universidad comentar: <cite>Parafraseando al Ministro de Tecnología sobre estos temas (SL), los experimentos en casa y con gaseosa</cite>.<br />
         Y matizó: <cite>Con lo bien que os había quedado el Anteproyecto</cite>.</p>
      </li>
    </ul>

    <h2>Complicaciones más comunes: errata Debian/Linex</h2>

    <p>Una errata en las hojas de estilo de la actual versión de Linex impide que algunas imágenes se incluyan en los ficheros pdf de salida. Esto puede resolverse fácilmente usando un «driver», como por ejemplo: <a href="http://tldp.org/authors/tools/ldp.dsl">http://tldp.org/authors/tools/ldp.dsl</a>. El modo de uso sería:</p>

    <center>
      docbook2pdf -d ldp.dsl#print fichero.xml
    </center>

    <h2>Complicaciones más comunes: juegos de caracteres</h2>

    <p>Hasta ahora el juego de caracteres predeterminado en Linux para el español ha sido Latin1 (iso-8859-1). La nueva versión adaptada al Euro es Latin9 (iso-8859-15).<br />
    Ambos juegos son muy parecidos. Como el sistema funciona siempre funciona con uno y otro no es fácil que se puedan mezclar.</p>

    <p>Sin embargo el juego predeterminado en la tecnología XML es UTF-8 y es probable que nos encontremos muchos ficheros así codificados. A la hora de modificar un fichero XML hay que tener presente que la codificación del fichero y la que usa la aplicación coincidan. Si no es así se pueden hacer transformaciones con programas como el analizador xmllint o <strong>recode</strong>, un poderoso conversor de codificaciones.</p>

    <h2>Complicaciones más comunes: usando ilustraciones en PS/PDF</h2>

    <p>Como hemos visto TeX es el motor de composición para los formatos de reproducción «impresa».</p>

    <p>Hay dos motores TeX, el clásico que crea ficheros PostScript (y el intermedio DVI) y PDFTeX que crea PDF.<br />
    Curiosamente ambos motores no manejan los mismos formatos gráficos para ilustraciones. El lío aumenta al tener en cuenta la salida vía web.</p>

    <p>Hay varias formas de sortear este problema pero la más sencilla es optar siempre por la salida PDF y HTML y utilizar los formatos gráficos PNG y JPG. Y no especificar nunca el atributo <strong>format</strong>.</p>

    <h2>Complicaciones más comunes: usando ilustraciones en HTML</h2>

    <dl>
      <dt>Ilustraciones</dt>

      <dd>Algunas versiones de docbook-utils varían de comportamiento al crear documentos HTML descompuestos en varios ficheros. Así en unos casos todos los ficheros html se crearán en el directorio actual y en otros lo hará en un subdirectorio. En este segundo caso será necesario copiar las imágenes a una ruta relativa igual a la que se introdujo en el código fuente para su correcta visualización en el navegador.</dd>

      <dt>Adornos de estilo</dt>

      <dd>Según la configuración de las hojas de estilo éstas podrán podrán usar adornos con forma de fichero gráfico. Si usa esta opción deberá copiar a mano estas imágenes (en mi caso en /usr/share/sgml/docbook/dsssl-stylesheets-1.74b/images/) al subdirectorio adecuado.</dd>
    </dl>

    <h2>Editores estructurados</h2>

    <p>El código Docbook es bastante prolijo. Puede que prefiera usar un editor estructurado más avanzado y cómodo. Algunas alternativas libres o gratis:</p>

    <dl>
      <dt>vim</dt>

      <dd>dispone de un modo de coloreado para XML, pero no asiste a la escritura.</dd>

      <dt>jedit</dt>

      <dd>Es un editor java, portable, con modos de edición de XML, XSLT, etc.</dd>

      <dt>emacs+psgml</dt>

      <dd>Es un muy poderoso editor estructurado. Una versión más acabada de psgml es psgmlx.</dd>

      <dt>xxe</dt>

      <dd>Es un editor estructurado en java.</dd>
    </dl>

    <h2>Referencias</h2>

    <dl>
      <dt>Docbook: The Definitive Guide</dt>

      <dd><a href="http://www.oasis-open.org/docbook/documentation/reference/">http://www.oasis-open.org/docbook/documentation/reference/</a></dd>

      <dt>Referencia principal</dt>

      <dd><a href="http://www.docbook.org">http://www.docbook.org</a></dd>

      <dt>Docbook Open Repository Project:</dt>

      <dd><a href="http://docbook.sourceforge.net">http://docbook.sourceforge.net</a></dd>

      <dt>Otro relacionado de Norman Walsh</dt>

      <dd><a href="http://www.nwalsh.com">http://www.nwalsh.com</a></dd>

      <dt>Tutorial de Docbook (usado en este tutorial):</dt>

      <dd><a href="http://olea.org/conferencias/doc-conf-tutorial-docbook/slide001.html">http://olea.org/conferencias/doc-conf-tutorial-docbook/slide001.html</a></dd>

      <dt>Otra presentación sobre Docbook</dt>

      <dd><a href="http://es.tldp.org/Presentaciones/0000otras/conf-jdavila1/html/index.html">http://es.tldp.org/Presentaciones/0000otras/conf-jdavila1/html/index.html</a></dd>

      <dt>Tutorial en español</dt>

      <dd><a href="http://es.tldp.org/Tutoriales/DOCBOOK/doctut/single-html/dbktut.html">http://es.tldp.org/Tutoriales/DOCBOOK/doctut/single-html/dbktut.html</a></dd>

      <dt>Docbook Howto (inglés):</dt>

      <dd><a href="http://www.ibiblio.org/godoy/sgml/docbook/howto/index.html">http://www.ibiblio.org/godoy/sgml/docbook/howto/index.html</a></dd>
    </dl>

    <h2>Foros de ayuda</h2>

    <dl>
      <dt>Listas oficiales de consulta sobre Docbook y aplicaciones Docbook (inglés)</dt>

      <dd><a href="http://www.oasis-open.org/docbook/mailinglist/index.shtml">http://www.oasis-open.org/docbook/mailinglist/index.shtml</a></dd>

      <dt>Lista de ayuda en español</dt>

      <dd><a href="http://listas.hispalinux.es/mailman/listinfo/docbook-ayuda/">http://listas.hispalinux.es/mailman/listinfo/docbook-ayuda/</a></dd>
    </dl>

    <h2>Preguntas</h2>

    <center>
      Atrévase a preguntar todo lo que siempre quiso saber sobre Docbook
    </center>

    <h2>Despedida y cierre</h2>

    <center>
      ¡Esto es to... esto es to... esto es todo amigos!
    </center>
  </body>
</html>

