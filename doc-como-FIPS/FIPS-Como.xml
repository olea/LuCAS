<?xml version="1.0" encoding="iso-8859-1" ?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook V4.1.2//EN"
"http://www.oasis-open.org/docbook/xml/4.1.2/docbookx.dtd">

<article>

<articleinfo>

<title>FIPS El primer Fragmentador Interactivo de ParticioneS de disco </title>

<author>
<firstname>de Arno Schaefer. Traducción de Juan José Montesinos Castellanos </firstname>

<authorblurb>

<para>
<ulink url="mailto:johncy@ibm.net">johncy@ibm.net
</ulink>
</para>

</authorblurb>
</author>

<pubdate>Versión 1.5, 22 de agosto de 1995 </pubdate>

<abstract>

<para>
FIPS es un programa capaz de hacer nuevas particiones en el disco duro sin tener que borrar necesariamente los datos. Es especialmente útil para hacer una/s partición/es para LINUX a partir de una única partición DOS. 
</para>

</abstract>

</articleinfo>

<sect1>
<title>Introducción </title>

<para>
El programa está inspirado por el Proyecto Linux. Al instalar Linux en un PC que ha sido empleado por DOS/Windows, mucha gente querrá conservar una partición más pequeña para los programas DOS. Sin embargo, como la mayoría de los discos tienen una única partición, normalmente se necesitaría hacer una copia completa, borrar la partición y rehacer dos (o más) particiones. En los actuales sistemas con capacidades por lo general de 500 MB o más, hacer una copia entera es una tarea prácticamente inviable si no se dispone de grandes medios como cintas de backup una vez que la unidad se ha llenado hasta una considerable fracción. Aunque incluso mucha gente graba su datos más preciados (un práctica que recomiendo encarecidamente en cualquier caso), el proceso de reinstalar todos los paquetes de software puede llevar muchas horas o incluso días. FIPS se escribió para remediar este problema. Se puede dividir un partición sin pérdida de datos con tal que haya suficiente espacio libre en el disco para la nueva partición a continuación de la anterior.
</para>

</sect1>

<sect1>
<title>¿Que se necesita para usar FIPS? </title>

<para>
Necesitas un programa de defragmentación de archivos para mover todo los datos al principio del disco duro. FIPS soló dividirá la partición si se dispone de suficiente espacio al final del disco. Las versiones DOS a partir de la 6.0 incluyen <literal remap="tt">DEFRAG</literal> que es adecuado para este propósito. Hay otros programas también válidos como <literal remap="tt">Norton Speedisk</literal> (efectivamente <literal remap="tt">DEFRAG es speedisk</literal> con menos funciones, con licencia Norton), <literal remap="tt">PCTools Compress, DISKOPT</literal> en Novel DOS 7, o programas shareware <literal remap="tt">ORG, DOG o SAFPAK </literal>(disponibles vía FTP anónimo de cualquier mirror en el directorio de utilidades de disco). No he probado estas últimas, o sea no me culpen si no les funcionan. También se debería usar un programa como <literal remap="tt">Doctor Norton Disk</literal> (o <literal remap="tt">SCANDISK </literal>en DOS 6.2) para comprobar el estado del disco antes de usar FIPS.
</para>

<para>
FIPS fue desarrollado bajo la versión 5.0 de DOS. Debería funcionar bien con cualquier versión a partir de la 3.0, tal vez incluso la 2.0. Sin embargo no será  muy útil con versiones mas antiguas del DOS ya que sólo se dispone de particiones de gran tamaño a partir de DOS 4. Funciona bien con DOS 6.0 y 6..2 y Novell DOS 7. También me han informado sobre su empleo satisfactorio con particiones de Windows95. Obsérvese que los nombres de fichero largos no son un problema para FIPS, porque funciona en un nivel más bajo donde la estructura de directorios no es importante. Es probablemente muy sensato probar un disquete de arranque DOS antes de usar FIPS.
</para>

</sect1>

<sect1>
<title>¿Qué hace FIPS?</title>

<para>
FIPS reduce el tamaño de la partición cambiando unos valores de la tabla de partición (partition table) del sector de arranque (boot sector). No modifica el formato de la partición, especialmente del tamaño del cluster y de la FAT (Tabla de Asignación de Ficheros). Por lo tanto la partición reducida tendrá una FAT que está en parte sin usar, pero esto no es problema para DOS. Con el espacio libre que se gana de esta forma FIPS crea una nueva partición primaria DOS. Si quiere emplear esta nueva partición para una sistema operativo diferente (por ejemplo Linux), use el programa <literal remap="tt">fdisk</literal> para hacer los cambios oportunos (consultar los manuales del sistema operativo). Si quiere usar la nueva partición bajo DOS/Windows, puede usarla como tal (después de formatear), pero tenga en cuenta lo siguiente: según las referencias oficiales, DOS sólo puede tener un única partición primaria. Todas las versiones de DOS ( al menos desde la versión 5.0) trabajan bien con múltiples particiones primarias, pero esto es una característica indocumentada. Si se quieren seguir las reglas oficiales, se puede borrar la nueva partición con fdisk y crear una partición extendida en su lugar. Hay razones para tener varias particiones primarias, entre ellas la posibilidad de arrancar desde distintas particiones cambiando la partición activa con fdisk.
</para>

<para>
Los problemas que se encuentran con configuraciones de varias particiones primarias son:
</para>

<para>
- si accidentalmente se borra una partición primaria del disco, no se podrá reconstruir fácilmente, ya que fdisk no lo hará. Hay otros programas fdisk por ahí que lo harán, y si todo eso falla pueden arrancar desde un disquete de arranque Linux para ejecutar el fdisk de Linux, pero es siempre un lío. 
</para>

<para>
- Hay algunos paquetes de software que emplean la tabla de partición y se pueden confundir con varias particiones primarias. Entre ellos esta <literal remap="tt">SFS</literal>, el 'Sistema de Ficheros Seguro' de Peter Gutmann. Creo que Peter ha realizado cambios a su programa para aceptar configuraciones inusuales, pero puede haber otros programas que pueden tener problemas.
</para>

</sect1>

<sect1>
<title>Seguridad</title>

<para>
FIPS fue especialmente diseñado para proporcionar el máximo de seguridad. Al empezar chequea las posibles incoherencias en la tabla de partición, sector de arranque y en la FAT. Si encuentra algo sospechoso, lo indicará. Si hay algún error FIPS no continuará. Se tiene la posibilidad de copia de seguridad del sector raíz y del de arranque a un floppy disk antes de empezar. Si algo va mal estos datos se pueden recuperar con el programa <literal remap="tt">RESTORRB.EXE</literal> (ver sección 5). Recomiendo encarecidamente hacer uso de dicha característica. También le permite recuperar la partición más tarde, por lo tanto es buena idea guardar los sectores de arranque y raíz en un lugar seguro. FIPS chequea el espacio libre en la partición y le dejará escoger de esta forma el comienzo del nuevo cilindro. Una vez calculada la nueva tabla de partición y de sector de arranque FIPS comprobará todo de nuevo, de forma que se puedan detectar posibles errores en el cálculo. Sólo si todo va bien, FIPS le pedirá permiso para escribir el nuevo sector de arranque y raíz.
</para>

</sect1>

<sect1>
<title>Restricciones</title>

<para>
FIPS sólo trabajará con los discos duros que usen la interrupción 13h para acceso de disco de bajo nivel. Esto es así para casi todos los PCs. He recibido un informe de un viejo controlador ADAPTEC SCSI que tenía un driver de software que trabajaba en un nivel más alto. En tal caso lo único que puedes hacer es conseguir un nuevo driver de ADAPTEC. Esto ya no es problema para los nuevos ADAPTECs (yo personalmente uso uno). FIPS trabaja sólo en discos con un tamaño de sector de 512 bytes. Parece que DOS esta preparado para trabajar con distintos tamaños de sector, pero hasta ahora no lo he visto. FIPS no dividirá particiones con FATs de 12 bits (no querrás dividir una partición con menos de 10 Mbytes verdad?). FIPS sólo dividirá particiones DOS. La tabla de partición y el sector de arranque deben estar de acuerdo a las convenciones de MS-DOS 3. Esto se marca por medio del byte indicador del sistema en la tabla de partición, debe tener el valor 4 (número de sector de 16 bits) o 6 (número de sector de 32 bits). FIPS NO DIVIDIRÁ PARTICIONES LINUX.
</para>

<para>
FIPS todavía no actúa sobre particiones DOS extendidas. Está planeado dar soporte a estas particiones a largo plazo, pero no puedo decir cuando. FIPS no trabajará si hay ya cuatro particiones, ya que necesita una partición libre. FIPS no reducirá la partición original a un tamaño menor de 4085 cluster, porque esto implicaría reescribir la FAT de 16 bits a una de 32. 
</para>

</sect1>

<sect1>
<title>Antes de comenzar</title>

<para>
Ejecute <literal remap="tt">chkdsk</literal> o <literal remap="tt">scandisk</literal> en la partición que quieres dividir. Como alternativa puede emplear <literal remap="tt">NORTON DISK DOCTOR</literal>. Asegúrese que no quedan clusters muertos en el disco. Prepare un disquete de arranque en a:. Bajo DOS este se puede hacer con el comando <emphasis>format a: /s</emphasis>, bajo WINDOWS NT o OS/2 esto puede ser distinto, en caso de duda consultar el manual o arrancar con un disco de arranque. Copiar a este disquete los siguientes archivos de FIPS: <literal remap="tt">restorrb.exe, unerros.txt</literal>. 
</para>

<para>
A continuación, COMPRUEBE el disco de arranque. Lea el manual o pregunte al guru más próximo si no puede arrancar con el disquete o no puede acceder al disco duro (Comprobar esto con el comando <emphasis>dir c:</emphasis>, deberías de ver el directorio raíz de tu disco duro). Si todo esto falla intente usar FIPS después de arrancar normalmente desde el disco duro (un poco más arriesgado pero a veces el último recurso). Cuando ejecute FIPS se podrán escribir copias de seguridad de los sectores de arranque y raíz a un archivo en la unidad a: llamado <literal remap="tt">rootboot.00X</literal> (donde X es un número entre 0 y 9). Si algo va mal se puede recuperar la configuración original arrancando desde el disquete y ejecutando <literal remap="tt">RESTORRB.EXE</literal>. Por favor fíjense: si usa FIPS más de una vez (esto no es frecuente pero puede ocurrir), se escribirá mas de un rootboot. <literal remap="tt">RESTORRB</literal> le permitirá elegir que archivo de configuración recuperar. El archivo <literal remap="tt">restorrb.000</literal> contiene la configuración original. Procure no confundir las versiones. Necesitará este disco de seguridad (<literal remap="tt">rootboot.00X</literal>) si quiere deshacer la partición más tarde. Pero antes de comenzar con FIPS deberá defragmentar el disco. Todo el espacio que se vaya a usar para la nueva partición deber estar vacio. Tenga en cuenta que el archivo de windows de swapping o fichero de intercambio de la memoria virtual no será movido por la mayoría de los defragmentadores. Deberá desinstalarlo (en el icono <emphasis>Extendido 386</emphasis> del panel de control de windows). Reinstalarlo después de usar FIPS. Si usa <literal remap="tt">IMAGE o MIRROR,</literal> el último sector del disco contiene un archivo oculto que señala a tus archivos mirror o copia. Debe borrar este archivo antes de usar FIPS. Se creará la próxima vez que ejecute mirror). Ejecuta <emphasis>attrib -r -s -h image.idx </emphasis>ó <emphasis>attrib -r -s -h mirorsasv.fil</emphasis> en el directorio raíz, borrar a continuación el archivo. Si FIPS no ofrece tanto espacio como cabría esperar puede ser que ocurra lo siguiente:

<itemizedlist>
<listitem>

<para>
a.Todavía hay demasiados datos en la partición. Considere borrar parte de los datos o hacer una partición más pequeña.
</para>
</listitem>
<listitem>

<para>
b. Hay archivos ocultos en el espacio para la nueva partición que no han sido movidos por el programa de defragmentación. Se pueden ver los archivos ocultos con el comando<emphasis> dir /a:h /s</emphasis>. Compruebe a qué programa pertenecen. Si es un archivo de intercambio de un programa es posible eliminarlo de una forma segura y será recuperado automáticamente; mire el manual para más detalles. Si el archivo pertenece a alguna clase de protección de copia debes desinstalar el programa.
</para>
</listitem>

</itemizedlist>

</para>

<para>
YA no puedo ofrecer más ayuda sobre esto. 
</para>

<para>
ATENCIÓN no intentes mover ningún archivo oculto del DOS (<literal remap="tt">msdos.sys, io.sys</literal>). Pueden acabar con un disco duro que no arranque nunca más. No es necesario mover estos archivos ya que se encuentran el primer sector del disco. A partir de la versión DOS 5.0, por lo menos uno de los archivos del sistema puede se movido, no obstante no es una buena idea dejarlo sólo. 
</para>

<para>
Una vez haya ejecutado FIPS tendrá que rearrancar el ordenador, asegúrate de desactivar cualquier programa del <literal remap="tt">config.sys</literal> o del <literal remap="tt">autoexec.bat</literal> que escriba al disco, en concreto mirror o imagen. Considere cambiar temporalmente el nombre de estos ficheros. Tenga presente que la ubicación de sus particiones DOS en la tabla de partición puede cambiar después de usar FIPS. Si usa la partición nueva bajo DOS y tiene una partición extendida y/ dos unidades de disco, esto significa que los nombres de las particiones pueden cambiar (ejemplo D: se puede convertir en E:). He procurado que C: permanezca siempre como C:, de forma que podrá arrancar. De igual forma, si tiene un CD-ROM cambiará, en la mayoría de casos la letra de unidad. Si usa el parámetro /L con el comando <literal remap="tt">MSCDEX</literal> en el fichero autoexec.bat, tendrá que cambiarlo en concordancia. Si no usa el modificador<emphasis> /L</emphasis>, <literal remap="tt">MSCDEX</literal> escogerá automáticamente la primera letra libre, de forma que no es necesario cambiar nada
</para>

<para>
En relación a las letras de unidades, el DOS usa el orden siguiente para asignarlas:

<orderedlist>
<listitem>

<para>
La primera partición de cada unidad 
</para>
</listitem>
<listitem>

<para>
Los volúmenes dentro de las particiones extendidas en cada unidad 
</para>
</listitem>
<listitem>

<para>
Las restantes particiones primarias de todas las demás unidades.
</para>
</listitem>

</orderedlist>

</para>

<para>
Ejemplo:
</para>

<para>
C: primera partición primaria en el primer disco duro 
</para>

<para>
D: primera partición primaria en segundo disco duro 
</para>

<para>
E: primer volumen en la partición extendida del primer disco duro 
</para>

<para>
F: segundo volumen en la partición extendida del primer disco 
</para>

<para>
G: primer volumen en la partición extendida del segundo disco 
</para>

<para>
H: segunda partición primaria del segundo disco 
</para>

<para>
I: CD ROM
</para>

<para>
No conozco una manera fácil cambiar este esquema. Concretamente no se puede asignar arbitrariamente una letra a una partición. Puede, sin embargo, influir en la ordenación cambiando una partición primaria en una extendida. 
</para>

<para>
Para usuarios LINUX: El posible cambio en la ubicación de la partición DOS en la tabla de partición también significa que el número que designa la esta partición bajo LINUX puede cambiar ( e.g /dev/hda3 se puede convertir en /dev/hda1). Cualquier partición Linux existente no cambiará, razón por la que no habrá problema al arrancar. Sólo es necesario editar el archivo /etc/fstab si usted monta su partición DOS al arrancar.
</para>

</sect1>

<sect1>
<title>Empleo con un Sistema Operativo Multitarea</title>

<para>
No se debe usar FIPS en sistemas multitarea como OS/2, Desqview, Windows, Novell Task Manager o el emulador DOS de Linux. Estos sistemas pueden escribir en el disco después de que FIPS haya cambiado la estructura del disco duro, que podría acabar corrompiendo el disco, aunque no ha de ser así necesariamente. Pero como la seguridad es mi preocupación prioritaria, recomendaría arrancar desde un disco de arranque DOS y ejecutar FIPS a continuación, eso sí sería seguro. En la versión 1.0 he agregado un código de Dave McCaldon para detectar Desqview y Windows (gracias, Dave!). OS/ 2 y Novell Task Manager no son detectados todavía. Tuve que quitar los códigos para descubrir el emulador DOS de Linux porque causaba cuelgues en muchos máquinas.
</para>

</sect1>

<sect1>
<title>Usar FIPS</title>

<para>
Si ya ha preparado un floppy de arranque como se describió en la sección 6, arranque con el ahora mismo.
</para>

<para>
Importante. Asegúrese que no tiene un disco con un programa como <literal remap="tt">Smartdrive</literal> ejecutándose. Ha habido casos en que los cambios que FIPS hizo se escribieron al disco sólo en parte, lo que resultó en la posterior corrupción del disco. Creo que esto puede ser causado por el uso de Smartdrive, en cuya configuración estándar se retrasa la escritura al disco por unos segundos. Si se rearranca demasiado rápido, se pueden perder algunos de los cambios. Ejecute FIPS tecleando <emphasis>fips</emphasis> desde DOS, a continuación <emphasis>&lt;ENTER&gt;</emphasis>. Se puede detener la ejecución del programa en cualquier momento presionando simultáneamente <emphasis>&lt;CTRL-C&gt;.</emphasis>
</para>

<para>
FIPS intentará, en primer lugar, detectar bajo que sistema operativa se está ejecutando. Si es Windows o Desqview, se quejará e indicará que se arranque desde un disquete. No obstante, se puede continuar pero bajo su responsabilidad (ver sección 9). A continuación, FIPS detectará los discos duros y si tuviese más de uno pedirá sobre cual actuar. En versiones anteriores, FIPS fallaba al detectar el número correcto de discos duros con algunas BIOS (especialmente en Pentium). Espero haber corregido esto. Si fallase al detectar el número de discos, por favor hágamelo saber. Mientras tanto puede usar el la opción <emphasis>-n</emphasis> para seleccionar manualmente el disco (ver a continuación). FIPS lee el sector raíz del disco y muestra la tabla de partición.
</para>

<para>
Ejemplo: 
</para>

<para>
|     Start               |      End        | Start 
</para>

<para>
|Number of|
</para>

<para>
Part.|bootable  |Head Cyl. Sector|System|Head Cyl. Sector  | Sector  |  Sector  |  MB
</para>

<para>
-----+----------------+------------------------+--------+--------------------------+-----------+---------------+-------
</para>

<para>
1    |   yes    | 0   148       1|   83h | 15  295     63  |  149184|    149184 | 72
</para>

<para>
2    |     no   |   1   0       1|   06h | 15  139     63         63|    141057 |  68
</para>

<para>
3    |     no   |     140       1|   06h | 15  147     63  |  141120|      8064 |   3
</para>

<para>
4    |     no   |   0   0       0|   00h |  0    0      0  |       0|         0 |   0
</para>

<para>
Si no sabe que significa esto no importa demasiado. Sencillamente use el número de Megabytes para identificar las particiones. Se comprueba si hay errores en el sector raíz. Si hay más de una partición el disco, será preguntado cual será dividida. El sector de arranque de la partición es leído y se indica alguna información.
</para>

<para>
Ejemplo:

<itemizedlist>
<listitem>

<para>
Bytes per sector: 512 
</para>
</listitem>
<listitem>

<para>
Sectors per cluster: 8 
</para>
</listitem>
<listitem>

<para>
Reserved sectors: 1 
</para>
</listitem>
<listitem>

<para>
Number of FATs: 2 
</para>
</listitem>
<listitem>

<para>
Number of rootdirectory entries: 512 
</para>
</listitem>
<listitem>

<para>
Number of sectors (short): 0 
</para>
</listitem>
<listitem>

<para>
Media descriptor byte: f8h 
</para>
</listitem>
<listitem>

<para>
Sectors per FAT: 145 
</para>
</listitem>
<listitem>

<para>
Sectors per track: 63 Drive heads: 16 
</para>
</listitem>
<listitem>

<para>
Hidden sectors: 63 
</para>
</listitem>
<listitem>

<para>
Number of sectors (long): 141057 
</para>
</listitem>
<listitem>

<para>
Physical drive number: 80h 
</para>
</listitem>
<listitem>

<para>
Signature: 29h
</para>
</listitem>

</itemizedlist>

</para>

<para>
FIPS comprueba si la información es coherente con la tabla de partición e intenta detectar otros errores. A continuación verifica que las dos copias de la FAT son idénticos, si no lo son, FIPS abortará con un mensaje de error.
</para>

<para>
Si todo esta bien, FIPS buscará ahora espacio libre al final de la partición. La nueva partición debe tener al menos un cilindro, por lo que si el último cilindro no está libre, no hay posibilidad de dividir la partición: FIPS abortará con un mensaje de error. Probablemente olvido eliminar un mirror o un fichero image. Ahora debe indicar en cual cilindro debe comenzar la nueva partición. Use las flechas del teclado para aumentar o disminuir el número. Durante el proceso se muestra el tamaño de la partición actual y la nueva, por lo que no habrá problema en seleccionar el cilindro adecuado. Con la tecla arriba/abajo se pude cambiar la cuenta es saltos de 10. Cuando esté listo, teclee <emphasis>enter</emphasis> para continuar.
</para>

<para>
FIPS comprobará nuevamente si el espacio para la nueva partición estará vacío -este es un paso de seguridad adicional y nunca debería mostrar un error, ya que el espacio libre fue determinado anteriormente. Después de esto, FIPS calculará los cambios en el sector raíz, chequeará los cambios y mostrará la nueva tabla de partición. Podrá elegir ahora entre reescribir la tabla (por lo que regresará al punto donde se seleccionó la partición) o continuar. Si teclea 'c', FIPS calculará el sector de arranque, lo comprobará y le pedirá confirmación para proceder. Si teclea 'y' entonces, FIPS escribirá los cambios al disco y finalizará la ejecución.
</para>

</sect1>

<sect1>
<title>Después de fraccionar la partición </title>

<para>
Asegúrese que los cambios han sido escritos en el disco. Si se ha empleado una caché de disco como <literal remap="tt">Smartdrive</literal> (a pesar de mi recomendación explícita de no hacerlo), espere unos segundos para que la memoria caché se vuelque al disco. La nueva partición será reconocida por DOS después de reinicializar el ordenador. NO ESCRIBA NADA AL DISCO ANTES DE ARRANCAR. Después de rearrancar use <literal remap="tt">CHKDSK</literal> or <literal remap="tt">Norton Disk Doctor</literal> para asegurarse que su vieja ( y ahora más pequeña) partición esta bien. Ha habido casos donde las modificaciones realizadas por FIPS no fueron escritas correctamente. Para asegurarse que éste no es el caso, ejecuta FIPS con la opción -t (modo prueba) después de reinicializar. Seleccione la unidad y la partición que ha fragmentado. Si FIPS no muestra ningún error hasta la sección de elección del cilindro, no hay ningún problema y puede detener el programa con CTRL-C. En caso contrario debe deshacer los cambios con <literal remap="tt">RESTORRB </literal>y ponerte en contacto conmigo vía E-mail.
</para>

<para>
Si no ve ningún error ya puede ahora arrancar con los ficheros habituales <literal remap="tt">autoexec.bat y config.sys</literal>. Ejecute algunos programas y asegúrese que todavía puede leer su datos. Si queres usar la nueva partición bajo DOS, debes formatearla. Si tiene varias particiones, asegúrese de formatear la unidad correcta, las letras pueden haber cambiado.
</para>

<para>
Si quiere usar la partición bajo Linux, debe cambiar el byte indicador del sistema con el fdisk de Linux, use a continuación <literal remap="tt">MKFS</literal>. Si quiere fragmentar la nueva partición de nuevo en dos más pequeñas, deberá formatearla bajo DOS, en caso contrario FIPS se quejará.
</para>

</sect1>

<sect1>
<title>Opciones ajustables </title>

<para>
Esta es la explicación de los modificadores de linea de FIPS. Si prefiere el estilo DOS, puede usar '/ ' en lugar de '-' como el carácter indicador de la opción. Las opciones se pueden combinar de forma arbitraria. Teclee <emphasis>fips -help</emphasis> para obtener un listado de las opciones. A continuación una explicación más detallada:

<itemizedlist>
<listitem>

<para>
<emphasis>-t -test</emphasis>: modo prueba (no escribe a disco) No requiere mucha explicación.
</para>
</listitem>
<listitem>

<para>
<emphasis>-d o -debug</emphasis>: modo depuración. En este modo, se escribe una completa transcripción de la sesión en el archivo <literal remap="tt">FIPSINFO.DBG</literal> en el directorio de trabajo. Puede enviar este fichero en caso de problemas (ver abajo). 
</para>
</listitem>
<listitem>

<para>
<emphasis>-h o -help</emphasis>: Página de ayuda, un corto resumen de las opciones. 
</para>
</listitem>
<listitem>

<para>
<emphasis>-n &lt;num</emphasis>&gt;: seleccione unidad &lt;num&gt; . Preseleccione el número de unidad con esta opción. Los números válidos se encuentra entre 128 y 255. Esto también se puede usar para obviar la detección automática de la unidad, si por cualquier causa FIPS no encuentra la unidad, puede probar esta opción.
</para>
</listitem>
<listitem>

<para>
<emphasis>-p &lt;num&gt;</emphasis>: seleccionar la partición &lt;numero&gt;. 
</para>
</listitem>
<listitem>

<para>
<emphasis>-c &lt;num&gt;</emphasis>: primer cilindro &lt;numero&gt;
</para>
</listitem>
<listitem>

<para>
-omb: eliminar "More than one Invalid bootable-flag". Hay algunos programas que admiten mas de una partición de arranque, simplemente usa la primera. Si tiene un programa así en el sector raíz y el PC arranca normalmente, debe usar esta opción para evitar el mensaje de error. Le recomiendo, sin embargo, borrar las banderas (flags) erróneas, si tiene el programa adecuado.
</para>
</listitem>
<listitem>

<para>
<emphasis>-obf:</emphasis> eliminar "Invalid bootable-flag"'bandera de arranque inválido'. Al modificar la bandera de arranque es teóricamente posible arrancar desde un segundo disco. Si tiene esta configuración, emplee esta opción para evitar el mensaje de error.
</para>
</listitem>
<listitem>

<para>
<emphasis>-ore</emphasis>: eliminar "Number of Rootdir entries must be multiple of 16" El DOS acepta un número inválido de entradas del directorio raíz. Si no tiene otro medio para corregir la entrada, debe usar esta opción para evitar este mensaje de error.
</para>
</listitem>
<listitem>

<para>
<emphasis>-olf</emphasis>: eliminar "FAT too large". Como el número de sectores por FAT es un número de 2 bytes, es teóricamente posible tener hasta 65535 sectores por FAT. Esto es aceptado por DOS, pero un número mayor de 256 no es útil, ya que las FAT más grandes tienen 256 sectores.  
</para>
</listitem>
<listitem>

<para>
<emphasis>- osf: </emphasis>eliminar "FAT too small". Si el número de clusters en la partición es mayor que las entradas en la FAT, DOS sólo usa parte de la partición. Algo ha ido muy mal con esta partición, pero no todo esta perdido: usa esta opción y reduce la nueva partición a un tamaño para que sea usada adecuadamente.
</para>
</listitem>
<listitem>

<para>
<emphasis>-omd</emphasis>: eliminar 'Wrong Media Descriptor Byte in FAT/Bootsector'. El byte descriptivo del medio debería ser F8h para discos duros, pero DOS acepta otros valores, así que puedes olvidarte de este mensaje con esta opción.
</para>
</listitem>

</itemizedlist>

</para>

</sect1>

<sect1>
<title>Localizando errores</title>

<para>
FIPS tiene todavía, de alguna forma, un carácter experimental, aunque ha sido usado por mucha gente con éxito y sin problemas. En caso de duda, yo generalmente me fijo en los mensajes de error cuando encuentro configuraciones sospechosas. Algunos de los errores menores puede ser obviados. léase este documento cuidadosamente. Mire también el documento de Preguntas Frecuentes (PREF) incluido en este documento.
</para>

<para>
Si no puede resolver por sí mismo un problema, o tiene una configuración no soportada por FIPS, o si sospecha de un error en FIPS, haga una transcripción de la sesión mediante el comando <emphasis>-d</emphasis> y envíe el archivo <literal remap="tt">FIPSINFO.DBG</literal> completo con un breve comentario a <ulink
url="mailto:schaefer@rbg.informatik.th-darmstadt.de"
>schaefer@rbg.informatik.th-darmstadt.de</ulink
> Posiblemente su problema haya sido resulto con anterioridad.
</para>

</sect1>

<sect1>
<title>Créditos</title>

<para>
FIPS está basado en el procedimiento descrito por Drew Eckhardt en el Linux digest 132. La mayoría de lo que sé acerca de la estructura de los discos duros viene de un excelente libro alemán 'Scheibenkleister II' (¿algún voluntario para traducirlo?) de Claus Brod y Anton Stepper. Está dirigido a el Atari ST, pero muchos cosas aplican a PCs también. La información sobre las interrupciones del disco fue recogida del listado de interrupciones de Ralf Brown. Gracias a Hamish Coleman por su informaciones y a Paul Smith por sus sugerencias. Gunnar Hilmarsson sugirió el procedimiento de discos apilados y Miguel Álvarez me ayudó a mejorar la clasificación de la partición. ChetanPatil, Rand Phares y Eric Jung me indicaron fallos en la programación y la documentación del programa. Stefan Andreasen aportó datos importantes sobre OS/ 2. Keith Crews sugirió adendas a la documentación relativa al disco de arranque y las características de DOS 6.x. Dave McCaldon escribió el código para detectar el OS. Scott Ellentuch y Billy Patton aportaron información acerca de OnTrack Disco Manager. Una información muy valiosa sobre discos EIDE y traducción de dirección se encuentra en el Linux-EIDE-Mini-HOWTO de Patrick LoPresti. Gracias a todos los que me han enviado sugerencias. FIPS no sería lo mismo sin los innumerables emails recibidos. Arno Schaeferschaefer <ulink
url="mailto:schaefer@rbg.informatik.th-darmstadt.de"
>schaefer@rbg.informatik.th-darmstadt.de</ulink
>
</para>

<para>
FIPS es gratuito; se puede redistribuir y/o modificar bajo los términos expuestos en la Licencia Pública General de la G N U (GNU) publicados por la Free Software Foundation; ya sea la versión 2 o cualquier otra posterior. FIPS se distribuye con la esperanza de que sea útil, pero SIN NINGUNA GARANTÍA; sin ni si quiera garantía implícita de su COMERCIALIZACIÓN o CONVENIENCIA PARA UN USO PARTICULAR. En la  Licencia Pública General de la GNU hay más detalles que debería haber recibido junto con FIPS. Si no es así, escribir a 
</para>

<para>
Free Software Foundation 
</para>

<para>
675 Mass Ave, Cambridge 
</para>

<para>
MA 02139, USA 
</para>

<para>
Se pueden dirigir comentarios y problemas a: <ulink
url="mailto:schaefer@rbg.informatik.th-darmstadt.de"
>schaefer@rbg.informatik.th-darmstadt.de</ulink
>
</para>

</sect1>

<sect1>
<title>Preguntas más frecuentes sobre FIPS </title>

<para>
Aquí hay unas preguntas que la gente me preguntó por &lsqb;email]. Este archivo puede ayudarle con algunos problemas comunes. Por favor léalo cuidadosamente antes de mandarlo. Si quiere saber de que se trata FIPS, lea el archivo <literal remap="tt">README.1ST.</literal>Están las respuestas a las siguientes preguntas: 
</para>

<para>
Q01. Ya que se puede dividir las participaciones con FIPS ¿sería posible unir las particiones? 
</para>

<para>
Q02. ¿Puedo invertir los cambios que FIPS hizo a mi disco duro? 
</para>

<para>
Q03. ¿Qué pasaría si no mantengo el sector raíz y de arranque? ¿Puedo todavía deshacer la partición? 
</para>

<para>
Q04. He oído que el cluster depende del tamaño de la partición y que el uso del espacio es mejor con tamaños pequeños de cluster. ¿Puedo usar FIPS para disminuir el tamaño del cluster de mi disco duro? 
</para>

<para>
Q05. Quiero dividir una partición grande en tres o cuatro más pequeñas. ¿puedo usar FIPS varias veces? 
</para>

<para>
Q06. FIPS crea por defecto una segunda partición DOS primaria. ¿Está esto permitido? 
</para>

<para>
Q07. ¿Que significa el mensaje " Info: partition table inconsistency"?
</para>

<para>
Q08. FIPS muestra un mensaje de error y se niega a trabajar. ¿Qué debo hacer? 
</para>

<para>
Q09. FIPS no reconoce mi disco SCSI. 
</para>

<para>
Q10. FIPS sólo reconoce una partición tipo 56h y ninguna DOS
</para>

<para>
Q11. FIPS parece trabajar bien, y DOS reconoce la nueva partición, pero el fdisk de Linux reconoce una sola partición.
</para>

<para>
Q12. ¿Funciona FIPS con Windows 95? 
</para>

<para>
<emphasis remap="bf">Q01. Ya que se puede dividir las participaciones con FIPS ¿sería posible unir las particiones? </emphasis>
</para>

<para>
<emphasis remap="bf">A01.a</emphasis> 
</para>

<para>
NO en general. No quiero meterme en detalles técnicos, sólo un poco: Cada partición formada por DOS tiene una FAT que contiene las entradas para cada Cluster de la partición. Actualmente la FAT no es lo suficientemente grande como para sostener ambas particiones, por lo que esas particiones no serán unidas fácilmente. Es factible, pero no voy a incorporarlo dentro de FIPS. Hasta ahora he oído de dos paquetes de Software que dicen expandir las particiones. Uno es un programa gratuito llamado"Partition Resizer" (busca un archivo llamado<literal remap="tt"> presz???.zip</literal> en tu servicio favorito de BBS o FTP), el otro es un producto comercial llamado, PartitionMagic by Power quest. No la he probado todavía.
</para>

<para>
<emphasis remap="bf">A01.b </emphasis>
</para>

<para>
SI, si dividiste antes las particiones con FIPS. Como te esperabas el problema con FAT no existe en ese caso, desde que fuera originalmente formateado. En efecto la única cosa requerida es restablecer el original root y boot sector (mientras tanto no importa como cambien los datos en la partición). Esto puede hacerse con el programa <literal remap="tt">restorrb</literal> que viene con FIPS. Por favor ten en cuenta lo siguiente: 

<itemizedlist>
<listitem>

<para>
Debes tener la imagen original de root and boot sector. Para eso debes salvarles con el Floppy disk Cuando FIPS te lo muestre. 
</para>
</listitem>
<listitem>

<para>
no debes formatear la primera partición (porque cuando es generado un nuevo FAT generalmente es muy pequeño). 
</para>
</listitem>
<listitem>

<para>
Los datos de la segunda partición (uno de los que fueron creados por FIPS están perdidos , por supuesto. Los datos de la primera partición están guardados.
</para>
</listitem>

</itemizedlist>

</para>

<para>
<emphasis remap="bf">Q02. ¿Puedo invertir los cambios que FIPS, hizo a mi disco duro </emphasis>?
</para>

<para>
<emphasis remap="bf">A02.</emphasis> 
</para>

<para>
Sí, ver la respuesta-A01.b. Asegúrate de que guardas los sectores de arranque y raíz originales en un floppy disk con FIPS.
</para>

<para>
<emphasis remap="bf">Q03. ¿Qué pasaría si no mantengo el sector raíz y de arranque? ¿Puedo todavía deshacer la partición? </emphasis>
</para>

<para>
<emphasis remap="bf">A03 </emphasis>Difícil. Por el momento tu única opción es leer el archivo que <literal remap="tt">TECHINFO.TXT</literal> y aprender acerca del formato del disco duro, recalcula las particiones antiguas y formatear info a mano y usa un editor disco para cambiarlos. Debes proceder con astucia como indico a continuación (llamaré a la partición que fue dividida de la partición original la "segunda" partición, quedando la partición original como la "primera") :

<orderedlist>
<listitem>

<para>
Asegúrate de que no hay un dato importante a la izquierda de la segunda partición ya que podría ser borrado. Haz copias de todos los roots and boots sectors (¡en Floppy disk!) por si cometieras algún fallo. También asegúrate de que tienes un disco de arranque DOS, que funcione, con el editor disco en él .¡Haz una copia de seguridad de los datos! 
</para>
</listitem>
<listitem>

<para>
Elige ' edit physical drive' y edit participation table ' en el menú del editor disk (en el caso de que tu editor disk lo soporte) 
</para>
</listitem>
<listitem>

<para>
Examina la tabla para asegurarte a que dos particiones, quieres unirte. 
</para>
</listitem>
<listitem>

<para>
Apunta la cabeza, cilindro y sector de la segunda partición e introduce los valores en los correspondientes campos de la primera partición. 
</para>
</listitem>
<listitem>

<para>
Suma al numero de sectores de la primera partición el número de sectores de la segunda e introduce el nuevo valor en el campo de sectores de la primera partición. 
</para>
</listitem>
<listitem>

<para>
Borra completamente la entrada para la segunda partición (sobrescribiendo con ceros). 
</para>
</listitem>
<listitem>

<para>
Busca el boot sector de la primera partición e introduce el nuevo número de sectores en el campo de sectores del boot sector.
</para>
</listitem>

</orderedlist>

</para>

<para>
Por favor asegúrate de que sabes lo que estas haciendo . Yo no me hago responsable de los líos de su disco duro. Léete el archivo <literal remap="tt">TECHINFO.TXT</literal> cuidadosamente.
</para>

<para>
<emphasis remap="bf">Q04. He oído que el cluster depende del tamaño de la partición y que el uso del espacio es mejor con tamaños pequeños de cluster. ¿Puedo usar FIPS para disminuir el tamaño del cluster de mi disco duro</emphasis>? 
</para>

<para>
A04. En la partición que dividiste de la partición original, el tamaño del cluster se adapta automáticamente al nuevo tamaño cuando lo formateaste. En la partición original no se puede cambiar el tamaño del cluster sin reformatear y, por lo tanto, borrando todos los datos. Si tu nueva partición es lo bastante grande, debes copiar los datos de la nueva partición y formatear los antiguos, pero ten en cuenta dos cosas:

<orderedlist>
<listitem>

<para>
No seras capaz de recuperar la partición antigua (ver A1.a). 
</para>
</listitem>
<listitem>

<para>
Los programas más nuevos chequean para ver si la partición ha sido ya formateada y en este caso preservan el formato (para que la recuperación de los datos sea mas fácil en el caso de que los formatos tengan algún fallo). Tienes que hacer engañar al Programa haciéndole creer que la partición es nueva. Posiblemente el modificador /u hará esto (No tengo posibilidad de chequear esto, por favor dime si funciona), pero si no, tienes que usar un editor de disco y sobrescribir el boot sector de la partición con ceros para anularlo.
</para>
</listitem>

</orderedlist>

</para>

<para>
Nota: He recibido un informe que sobreescribiendo el boot sector no era bastante. Sólo se me ocurre pensar que había bastante información en las tablas de la BIOS sobre el viejo formato -recomiendo rearrancar después de sobreescribir el boot sector y borrar todas las tablas. A veces las herramientas de DOS son demasiado inteligentes (si tienes problemas mándame un mensaje).
</para>

<para>
El tamaño normal de una partición es aproximadamente el siguiente:
</para>

<para>
0 - 32 MB 512 BYTES 
</para>

<para>
32 - 64 MB 1024 BYTES 
</para>

<para>
64 - 128 MB 2048 BYTES 
</para>

<para>
128 - 256 MB 4096 BYTES 
</para>

<para>
256 - 512 MB 8192 BYTES 
</para>

<para>
512 -1024 MB 16384 BYTES
</para>

<para>
<emphasis remap="bf">Q05. Quiero dividir una partición grande en tres o cuatro más pequeñas. ¿puedo usar FIPS varias veces?</emphasis>
</para>

<para>
A05. Si. Debes formatear las particiones nuevamente creadas entre sucesivos usos de FIPS. A propósito para el tamaño deberás tener en cuenta el siguiente ejemplo:
</para>

<para>
- Suponte que quieres dividir un 1GB hard disk en cuatro particiones de 256K cada una.
</para>

<para>
- La partición original es formateada con un tamaño del cluster de 16KB.
</para>

<para>
- La primera división es dividida en 256KB / 768KB. El tamaño del cluster de la primera partición quedan 16KB, aunque 4 KB serán suficientes, Solo pueden ser cambiadas reformateándolas, ver A04.
</para>

<para>
- La nueva partición de 768KB es formateada, todavía con un tamaño del cluster de 16KB.
</para>

<para>
- La segunda división es hecha en 256KB / 256KB / 256KB.
</para>

<para>
-La tercera partición es formateada con un cluster de un tamaño de 8KB.
</para>

<para>
- La tercera división es hecha en 256KB / 256KB / 256KB.
</para>

<para>
- La cuarta partición es formateada con un cluster de un tamaño de 4KB.
</para>

<para>
- Ahora tienes los cluster de los tamaños: 16K - 16K - 8K - 4K.
</para>

<para>
- Como las particiones segunda y tercera están todavía vacias, esto es posible reformateándolas a un tamaño de cluster de 4K. Ver A04 para detalles sobre el formateo.
</para>

<para>
<emphasis remap="bf">Q06. FIPS crea por defecto una segunda partición DOS primaria. ¿Está esto permitido? </emphasis>
</para>

<para>
A06. Hecha un vistazo a la sección " que hace FIPS " en FIPS.DOC para debatir este punto.
</para>

<para>
<emphasis remap="bf">Q07. ¿Que significa el mensaje " Info: partition table inconsistency"?</emphasis>
</para>

<para>
A07. La partición de la tabla en el sector de arranque maestra está formado por cuatro entradas con diferentes campos cada una . Lo raro sobre esta tabla es que algunos de los datos son redundantes.
</para>

<para>
Los valores del principio y del final (Head/ cylinder/ sector) pueden ser calculadas a partir del sector de arranque y el número de sectores (después de preguntar sobre el número de BIOS de cabezas y el número de sectores por pista), de hecho esto es lo que hace DOS. Este campo está completamente en desuso por DOS ( y los otros sistemas operativos que conozco ), entonces podrán ponerlos a cero. Sin embargo, no hace daño tenerlos de forma coherente. 
</para>

<para>
Cuando fdisk crea una partición de la tabla de entrada, debería introducir los valores correctos en estos campos. Ahora, ¿como puede existir una inconsistencia? Hay por lo menos dos posibilidades:

<orderedlist>
<listitem>

<para>
Algunos programas de fdisk parecen escribir valores incorrectos, especialmente el final de los cilindros que están fuera por uno o dos. 
</para>
</listitem>
<listitem>

<para>
Puedes tener un EIDE drive que emplee traducción de direcciones. Los discos modernos normalmente tienen mas de 1024 cilindros, pero DOS no permite usar más de 1024. Esto hizo a los fabricantes de controladoras de disco emplear un truco: Reducen el numero de cilindros y aumentan el número de cabezas cuando el DOS pregunta por la geometría del disco. Entonces DOS piensa que tiene un drive con, por ejemplo 63 sectores, 32 cabezales y 1000 cilindros, cuando los valores correctos son 63 sectores, 16 heads, 2000 cilindros. Ahora, si DOS pregunta por el primer sector del cilindro 500, realmente consigue el primer sector del cilindro 1000. Este truco se llama address translation. Algunos de las unidades más nuevas de discos EIDE permiten que la address translation se conecte y se anule en la BIOS. En algunos casos esto cambia después que el disco es formateado. Esto significa que la geometría que el DOS obtiene cuando consulta al controlador de disco difiere de la geometría con la que la unidad fue formateada y que se refleja en la tabla de partición. Esto no es un problema para DOS, pero si lo era para FIPS hasta la versión 1.4. En la versión actual, si FIPS detecta esta clase de problemas, adaptará la tabla de partición a la geometría de disco alterada. 
</para>
</listitem>

</orderedlist>

</para>

<para>
<emphasis remap="bf">Q08. FIPS muestra un mensaje de error y se niega a trabajar. ¿Qué debo hacer? </emphasis>
</para>

<para>
A08. Aunque esta completamente resuelto en <literal remap="tt">FIPS.DOC</literal>, no puedo realzarlo suficientemente: si me mandas correo , por favor incluye el _DEBUG SCRIPT_ que puedes producir con la opción<emphasis> -d</emphasis>. Si no tendré que pedírsela, y me llevará mucho tiempo resolver tu problema.
</para>

<para>
<emphasis remap="bf">Q09. FIPS no reconoce mi disco SCSI. </emphasis>
</para>

<para>
A09. Existen unos adaptadores SCSI antiguos que necesita un driver que se carga en el <literal remap="tt">config.sys</literal> antes de acceder al disco. Este dispositivo ó driver no proporciona una conexión a nivel de la BIOS si no que lo realiza a nivel DOS con el disco duro (para los técnicos : se cuelga de la interrupción 21h en lugar de la interrupción de la BIOS 13h). Esto significa que la tabla de partición solo puede ser accesible por un programa fdisk especial que sepa sobre adaptadores internos. FIPS no trabajará con estos drivers (de hecho DOS tampoco). Posiblemente existen drivers nuevos para el adaptador que proporcionen un interface a nivel de la BIOS. pregunta al fabricante.
</para>

<para>
<emphasis remap="bf">Q10. FIPS sólo reconoce una partición tipo 56h y ninguna DOS</emphasis>
</para>

<para>
A10. Tienes Ontrack disk manager instalado. Lee la sección adecuada en <literal remap="tt">SPECIAL.DOC.</literal>
</para>

<para>
<emphasis remap="bf">Q11. FIPS parece trabajar bien, y DOS reconoce la nueva partición, pero el fdisk de Linux reconoce una sola partición.</emphasis>
</para>

<para>
A11. De alguna manera DOS monta una tabla de partición distinta a la del disco maestro.
</para>

<para>
Hay dos posibles razones :

<orderedlist>
<listitem>

<para>
usas un mecanismo driver como ontrack disk manager. Ver el documento <literal remap="tt">SPECIALDOC</literal>. 
</para>
</listitem>
<listitem>

<para>
Tienes un virus en el boot record maestro. Esto no suele pasar, pero es posible. Algunos de los virus se instalan ellos solos en el MBR y copian el MBR original a otro sitio. Cuando DOS intenta acceder a la tabla de partición, el virus intercepta el BIOS llamando y devolviendo la copia de seguridad, para esconderse de una posible detección. Comprueba esto con un scanner de virus después de arrancar con un disco de arranque DOS limpio. Puedes quitar un virus desde el MBR usando el fdisk del DOS con la opción /mbr, pero ten cuidado en caso de que la tabla de partición de seguridad no sea recuperada. Por esta razón el boot sector tendrá la nueva información cambiada por FIPS, pero la tabla de partición tendrá la configuración original. Esta incoherencia deberá ser corregida ( e.g con un editor de discos).
</para>
</listitem>

</orderedlist>

</para>

<para>
<emphasis remap="bf">Q12. ¿Funciona FIPS con Windows 95?</emphasis> 
</para>

<para>
A.12 Sí. El sistema de archivo para Windows 95 es el mismo que para DOS. La única diferencia es que los nombres de archivo son más largos, pero FIPS trabaja en un nivel inferior al de los
directorios, por lo que no es problema. Algunas personas han informado que FIPS ha funcionado sin problemas con particiones windows95. 
</para>

</sect1>

<sect1 id="Grupos">
<title>Anexo: El INSFLUG </title>

<para>
El <emphasis>INSFLUG</emphasis> forma parte del grupo internacional 
<emphasis remap="it">Linux Documentation Project</emphasis>, 
encargándose de las traducciones al castellano de los Howtos (Comos),
así como la producción de documentos originales en aquellos casos
en los que no existe análogo en inglés.
</para>

<para>
En el <emphasis remap="bf">INSFLUG</emphasis> se orienta preferentemente a la traducción de documentos
breves, como los <emphasis>COMOs</emphasis> y <emphasis>PUFs</emphasis> (<emphasis remap="bf">P</emphasis>reguntas de
<emphasis remap="bf">U</emphasis>so <emphasis remap="bf">F</emphasis>recuente, las <emphasis remap="it">FAQs</emphasis>. <literal remap="tt">:)</literal> ), etc.
</para>

<para>
Diríjase a la sede del INSFLUG para más información al respecto.
</para>

<para>
En la sede del INSFLUG encontrará siempre las <emphasis remap="bf">últimas</emphasis> versiones 
de las traducciones:  <literal remap="tt"><ulink
url="http://www.insflug.org"
>www.insflug.org</ulink
></literal>. Asegúrese de comprobar cuál es la última versión 
disponible en el Insflug antes de bajar un documento de un servidor réplica.
</para>

<para>
Se proporciona también una lista de los servidores
réplica (<emphasis remap="it">mirror</emphasis>) del Insflug más cercanos a Vd.,  
e información relativa a otros recursos en castellano.
</para>

<para>
Francisco José Montilla, <literal remap="tt"><ulink
url="mailto:pacopepe@insflug.org"
>pacopepe@insflug.org</ulink
></literal>.
</para>

</sect1>

</article>
