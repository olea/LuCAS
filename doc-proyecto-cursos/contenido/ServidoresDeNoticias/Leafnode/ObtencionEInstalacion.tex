\porcion{Obtención e Instalación}
\autor{Carlos Pérez Pérez}
\colaborador{\SGG}
\revisor{}
\traductor{}

Se puede obtener Leafnode desde la página
oficial del programa \sitio{http://www.leafnode.org}.
Si se quieren bajar paquetes en formato rpm se
puede acudir a \sitio{http://rpmfind.net} para el
formato Debian se deberá acudir a \sitio{http://www.debian.org}.
Aunque normalmente el paquete de Leafnode viene con
la mayoría de las distribuciones.\\

\figura{Página de Leafnode}{leafnode.org}

Su instalación es sencilla:\\
\begin{itemize}
\item Paquetes RPM: desde la línea de comandos ejecutaremos
la orden \comando{rpm -i leafnode-1.9.17-1.rpm}, teniendo
en cuenta que la versión puede ser distinta, en este caso, 1.9.17-1.
\item Paquetes Deb: desde la línea de comandos ejecutamos
\comando{apt-get install leafnode} y con esto nos aseguramos
que se instalan todas las dependencias necesarias.
\item Código fuente: procederemos a desempaquetar el archivo
con las fuentes con la orden \comando{tar xvzf archivo} y
buscaremos el fichero README para ver la información de
compilación.
\end{itemize}
Una vez realizada la instalación, habrá que verificar la existencia del usuario news.
Dentro del fichero /etc/inetd.conf debe existir:\\
\comando{nntp stream tcp nowait news /usr/sbin/tcpd /usr/local/sbin/leafnode}

Estas comprobaciones no son necesarias porque el sistema de instalación las
trae automatizadas, pero servirán para descartar problemas si el servicio
no funciona correctamente.


Si estamos utilizando xinet en lugar de inet, deberemos crear un fichero llamado
\comando{leafnode} dentreo del directorio \comando{/etc/xinetd.d}, con el siguiente
contenido:

\begin{vscreen}
service nntp
{
	disable	= no
	socket_type		= stream
	wait			= no
	user			= root
	server			= /usr/sbin/leafnode
	log_on_success		+= USERID
	log_on_failure		+= USERID
}
\end{vscreen}


El siguiente paso lógico es editar el fichero de configuración con el
objeto de adpatar el servicio a nustras necesidades e indicarle a
Leafnode una información vital para su correcto funcionamiento.

El último paso sería automatizar los comandos para bajar los grupos
y las noticias. Para esto se puede poner el \comando{fetchnews} dentro
del script ip-up para bajarlos cuando hagamos la conexión a Internet
o bien añadiendo una línea dentro del cron. Aunque siempre nos queda
el método manual, esto es, ejecutarlo desde la línea de comandos.

Reiniciamos el demonio inetd o xinetd:\\
\comando{kill -HUP `cat /var/run/inetd.pid`} \\
\comando{kill -HUP `cat /var/run/xinetd.pid`} \\
o bien:\\
\comando{/etc/init.d/xinetd reload}

En el fichero /etc/hosts.deny pondremos:\\
\comando{leafnode: ALL EXCEPT LOCAL}\\
Ejecutamos \comando{fetchnews} después de haber hecho los
cambios en el fichero de configuración, con lo que se
bajarán la lista de grupos disponibles. Luego nos conectaremos
desde nuestro cliente favorito, teniendo en cuenta que el
servidor será local y no se necesitará usuario ni contraseña.
Ejecutamos \comando{fetchnews} por segunda vez y comenzarán
a bajar las noticias de los grupos suscritos hasta un máximo
que ha sido definido en el ficher de configuración.