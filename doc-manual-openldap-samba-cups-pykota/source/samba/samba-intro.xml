<?xml version="1.0" encoding="ISO-8859-1" ?>

<chapter id="samba-conceptos-teoricos">

<chapterinfo>
	<keywordset>
		<keyword>Samba</keyword>
	</keywordset>
</chapterinfo>

<title>Conceptos teóricos</title>

<sect1 id="samba-conceptos-teoricos-introduccion">
	<title>Introducción</title>

	<note><para>Este capítulo se ha basado en las introducciones de las entradas bibliográficas
	<xref linkend="bibliografia-eckstein-collier-brown-kelly-01"/>,
	<xref linkend="bibliografia-ts-eckstein-collier-brown-01"/> y
	<xref linkend="bibliografia-sharpe-01"/>. También se ha de notar que
	las imágenes y los ejemplos utilizados en este apartado han sido obtenidos o basados
	en dichos documentos.</para></note>
	
	<para>
	Samba es una herramienta de red extremadamente útil para cualquier persona que posea en su red
	sistemas Unix y Windows. Samba se ejecuta en un sistema Unix, permitiendo a los sistemas Windows
	compartir
	archivos e impresoras en la máquina Unix, a la vez que los usuarios de Unix tienen acceso a los
	recursos compartidos en los sistemas Windows.
	</para>
	
	<para>
	Aunque parece natural hacer uso de servidores Windows para servir archivos e impresoras en una red
	donde haya clientes Windows, hay buenas razones para elegir un servidor Samba para estos servicios.
	Samba es un software confiable que corre en un sistema operativo confiable como Unix, dando como
	resultado
	la obtención de menos problemas y bajo coste de mantenimiento. A parte de esto, Samba ofrece mejor
	rendimiento ante cargas de trabajo extremadamente duras, sobrepasando a un servidor Windows 2000
	en un factor de 2 a 1 en un <acronym>PC</acronym> con la misma configuración de hardware, de acuerdo
	con unos <emphasis>benchmarks</emphasis> publicados por terceros. Cuando un <acronym>PC</acronym>
	ya no pueda acometer las peticiones de los clientes, debido a la alta carga, el servidor Samba
	se puede trasladar fácilmente a un mainframe Unix propietario, el cual puede sobrepasar en mucho
	a un <acronym>PC</acronym> corriendo Windows. Si todo esto no fuese suficiente, Samba posee
	una ventaja muy buena en relación al coste: es libre. No sólo el software está a su disposición
	libremente, sino que no necesita ningún tipo de licencia para los clientes, ejecutándose en
	sistemas operativos de gran calidad y libres, como <acronym>GNU</acronym>/Linux y FreeBSD.
	</para>
</sect1>

<sect1 id="samba-que-es">
	<title>¿Qué es Samba?</title>

	<para>
	Samba es una suite de aplicaciones Unix que habla el protocolo <acronym>SMB</acronym>
	(Server Message Block). Los sistemas operativos Microsoft Windows y OS/2 utilizan
	<acronym>SMB</acronym> para compartir por red archivos e impresoras y para realizar
	tareas asociadas. Gracias al soporte de este protocolo, Samba permite a las máquinas
	Unix <emphasis>entrar en el juego</emphasis>, comunicándose con el mismo protocolo de
	red que Microsoft Windows y aparecer como otro sistema Windows en la red (desde la perspectiva
	de un cliente Windows). El servidor Samba ofrece los siguientes servicios:
	</para>

	<itemizedlist mark='fillcircle'>
		<listitem>
			<para>Compartir uno o varios sistemas de archivos</para>
		</listitem>
		<listitem>
			<para>Compartir uno o varios sistemas de archivos distribuidos</para>
		</listitem>
		<listitem>
			<para>Compartir impresoras instaladas en el servidor entre los clientes
			Windows de la red</para>
		</listitem>
		<listitem>
			<para>Ayudar a los clientes permitiéndoles navegar por la red</para>
		</listitem>
		<listitem>
			<para>Autentificar a los clientes que ingresan en un dominio Windows</para>
		</listitem>
		<listitem>
			<para>Proveer o ayudar con un servidor de resolución de nombres Windows
			(<acronym>WINS</acronym>) <footnote><para>En inglés <emphasis>Windows Internet
			Name Service</emphasis></para></footnote>.</para>
		</listitem>
	</itemizedlist>

	<para>
	La suite Samba también incluye herramientas para los clientes, que permiten a los usuarios de un
	sistema Unix acceder a los directorios e impresoras que los sistemas Windows y servidores
	Samba comparten en la red.
	</para>

	<para>
	Samba es la idea de Andrew Tridgell, quien actualmente lidera el equipo de desarrollo de Samba.
	El proyecto nació en 1991 mientras Andrew trabajaba con la suite de <emphasis>Digital Equipment
	Corporation</emphasis> (<acronym>DEC</acronym>) llamada Pathworks, creada para conectar
	ordenadores <acronym>VAX</acronym> <acronym>DEC</acronym> con los de otras compañías. Sin
	conocer la transcendencia de lo que estaba haciendo, Andrew creó un programa servidor de archivos
	para un extraño protocolo que formaba parte de la suite Pathworks. Este protocolo pasó a llamarse
	más tarde <acronym>SMB</acronym>. Unos años más tarde, lo liberó como su servidor
	<acronym>SMB</acronym> particular y lo comenzó a distribuir por Internet bajo el nombre de
	<quote>SMB Server</quote>. Sin embargo, Andrew no pudo mantener ese nombre -este pertenecía a
	un producto de otra compañía-, así que intentó lo siguiente para buscarle un nuevo nombre desde Unix:
	</para>

<screen><prompt>$</prompt> <userinput>grep -i '^s.*m.*b' /usr/dict/words</userinput></screen>


	<para>
	Obteniendo como respuesta:
	</para>

<screen><computeroutput>salmonberry
samba
sawtimber
scramble</computeroutput></screen>


	<para>
	De ésta manera nació el nombre de Samba.
	</para>

	<para>
	Hoy en día, la suite Samba gira alrededor de un par de demonios Unix que permiten la compartición
	de recursos entre los clientes <acronym>SMB</acronym> de una red. Estos demonios son:
	</para>

	<variablelist>
		<varlistentry>
			<term><command>smbd</command></term>
			<listitem><para>Demonio que permite la compartición de archivos e impresoras
			sobre una red <acronym>SMB</acronym> y proporciona autentificación y
			autorización de acceso para clientes <acronym>SMB</acronym>.</para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>nmbd</command></term>
			<listitem><para>Demonio que soporta el servicio de nombres
			<acronym>NetBIOS</acronym> y <acronym>WINS</acronym>, que es una implementación
			de Microsoft del servicio de nombres <acronym>NetBIOS</acronym>
			(<acronym>NBNS</acronym>). Este demonio también ayuda añadiendo la posibilidad
			de navegar por la red.</para></listitem>
		</varlistentry>
	</variablelist>

	<para>
	Samba actualmente está mantenido y es ampliado por un grupo de voluntarios bajo la supervisión
	activa de Andrew Tridgell. Al igual que el núcleo <xref linkend="nucleos-linux"/>, los autores
	de Samba lo distribuyen como software <emphasis><ulink url="http://opensource.org">open
	source</ulink></emphasis>, bajo los términos de la licencia <acronym>GPL</acronym>
	(<acronym>GNU</acronym> General Public License).
	Desde su concepción, el desarrollo de Samba ha sido patrocinado en parte por la <emphasis>Australian
	National University</emphasis>, donde Andrew Tridgell hizo su doctorado. A partir de entonces,
	muchas otras organizaciones han patrocinado a los desarrolladores de Samba, incluyendo
	LinuxCare, VA Linux Systems, Hewlett-Packard e <acronym>IBM</acronym>. Es algo verdaderamente
	testimonial el que entidades tanto comerciales como no comerciales estén dispuestas a gastar
	dinero para dar soporte a un esfuerzo Open Source.
	</para>

	<para>
	Microsoft también ha contribuido ofreciendo la definición de su protocolo <acronym>SBM</acronym>
	al grupo <acronym>IETF</acronym> (Internet Engineering Task Force) en 1996, cuyo nombre es
	<emphasis>Common Internet File System</emphasis> (<acronym>CIFS</acronym>).
	</para>
</sect1>

<sect1 id="samba-que-puede-hacer-por-mi">
	<title>¿Qué puede hacer Samba por mí?</title>
	<para>
	Como se explicó anteriormente, Samba puede ayudar la coexistencia de máquinas Windows y Unix en la
	misma red. Sin embargo, existen algunas razones por las cuales podría desear instalar
	un servidor Samba en su red: 
	</para>

	<itemizedlist mark='fillcircle'>
		<listitem>
			<para>No quiere pagar -o no puede disponer- de un servidor Windows completo, pero
			todavía necesita la funcionalidad que provee</para>
		</listitem>
		<listitem>
			<para>Qué las licencias de acceso a los clientes<footnote><para>En inglés
			<emphasis>Client Access Licenses</emphasis>
			(<acronym>CALs</acronym>)</para></footnote> que Microsoft solicita para que
			cada cliente Windows pueda acceder al servidor Windows sean incosteables</para>
		</listitem>
		<listitem>
			<para>Tal vez quiera proporcionar un área común para datos o directorios de usuarios
			en orden a realizar una transición desde un servidor Windows hacia uno Unix,
			o viceversa</para>
		</listitem>
		<listitem>
			<para>Desea compartir impresoras entre clientes Windows y Unix</para>
		</listitem>
		<listitem>
			<para>Tenga que dar soporte a un grupo de usuarios cuyos ordenadores posean
			una mezcla de sistemas operativos, Windows y Unix</para>
		</listitem>
		<listitem>
			<para>Quiera integrar la autentificación de Unix y Windows, manteniendo
			una única base de datos para las cuentas de los usuarios que funcione
			en ambos sistemas</para>
		</listitem>
		<listitem>
			<para>Quiera establecer una red entre sistemas Unix, Windows, Macintosh
			(<acronym>OS</acronym> X) y otros, utilizando un único protocolo</para>
		</listitem>
	</itemizedlist>

	<para>
	A continuación se verá a Samba en acción. Se asume la siguiente configuración
	de red: un servidor Samba sobre una máquina Unix, cuyo <emphasis>hostname</emphasis> es
	<acronym><emphasis>toltec</emphasis></acronym>, y un par de clientes Windows, denominados
	<emphasis>maya</emphasis> y <emphasis>aztec</emphasis>, todos los equipos están conectados
	gracias a una red de área local (<acronym>LAN</acronym>). Se asume también que
	<acronym><emphasis>toltec</emphasis></acronym> tiene una impresora de inyección de tinta
	conectada, <emphasis>lp</emphasis>, y un disco compartido <emphasis>spirit</emphasis>
	-ambos recursos están disponibles para las otras dos máquinas-. Un gráfico de esta red se
	  muestra en la <xref linkend="samba-configuracion-red-simple-con-servidor-samba"/>. 
	  </para>

	  <figure id="samba-configuracion-red-simple-con-servidor-samba">
		  <title>Configuración de red simple con un servidor Samba<footnote><para>Si quiere obtener
		  el código fuente de esta imagen realizada con <xref linkend="dia"/> pulse
		  <ulink url="./imagenes/samba-configuracion-red-simple-con-servidor-samba.dia">aquí</ulink>.
		  </para></footnote></title>

		  <mediaobject>
			  <imageobject>
				  <imagedata fileref="./imagenes/samba-configuracion-red-simple-con-servidor-samba.png" format="PNG"/>
			</imageobject>
		</mediaobject>
	</figure>

	<para>
	En esta red, cada ordenador comparte el mismo grupo de trabajo (<emphasis>workgroup</emphasis>).
	Un grupo de trabajo no es más que una etiqueta que identifica a un determinado grupo de
	ordenadores y sus recursos en una red <acronym>SBM</acronym>. Pueden existir varios grupos de
	trabajo sobre la red al mismo tiempo, pero para el ejemplo sólo se tiene uno: el grupo de
	trabajo <emphasis>METRAN</emphasis>. 
	</para>

<sect2 id="samba-compartiendo-un-disco">
	<title>Compartiendo un disco</title>
	<para>
	Si todo está bien configurado, se debería ver el servidor Samba, <emphasis>toltec</emphasis>,
	a través del entorno de red de la máquina Windows denominada <emphasis>maya</emphasis>. De hecho,
	la <xref linkend="samba-entorno-de-red"/> muestra el entorno de red de la <emphasis>maya</emphasis>,
	incluyendo a <emphasis>toltec</emphasis> y a cada una de las máquinas que residen en el grupo
	de trabajo <emphasis>METRAN</emphasis>. Dese cuenta del icono <quote>Entire Network</quote>
	al principio de la lista. Como se mencionó anteriormente, pueden existir más grupos de
	trabajo sobre una red <acronym>SBM</acronym> al mismo tiempo. Si un usuario hace
	<emphasis>click</emphasis> sobre ese icono, verá la lista de todos los grupos de trabajo
	que actualmente existen en la red. 
	</para>

	<figure id="samba-entorno-de-red">
		<title>Entorno de red</title>
		
		<mediaobject>
			<imageobject>
				<imagedata fileref="./imagenes/samba-entorno-de-red.png" format="PNG"/>
			</imageobject>
		</mediaobject>
	</figure>

	<para>
	Se puede ver con más detalle los recursos compartidos por <emphasis>toltec</emphasis> haciendo
	doble <emphasis>click</emphasis> sobre su icono. Esta acción provoca un contacto con
	<emphasis>toltec</emphasis>, solicitándole la lista de sus recursos compartidos -la impresora
	y el disco- que proporciona. En este caso, existe una impresora denominada
	<emphasis>lp</emphasis>, un directorio personal denominado <emphasis>jay</emphasis> y el
	disco compartido llamado <emphasis>spirit</emphasis> en el servidor, como se muestra en la
	<xref linkend="samba-recursos-compartidos-en-toltec-vistos-desde-maya"/>. Tenga en cuenta que
	Windows muestra los <emphasis>hostnames</emphasis> con letras mayúsculas/minúsculas
	(<emphasis>Toltec</emphasis>). La distinción entre mayúsculas y minúsculas es irrelevantes
	en los nombres de las máquinas (<emphasis>hostname</emphasis>), por lo que puede ver
	<emphasis>toltec</emphasis>, <emphasis>Toltec</emphasis> y <emphasis>TOLTEC</emphasis> como
	resultado de algunas órdenes o en distintas pantallas, pero todos se refieren al mismo
	sistema. Gracias a Samba, Windows 98 ve al servidor Unix como a un servidor <acronym>SBM</acronym>
	válido, y puede acceder al directorio <emphasis>spirit</emphasis> como si fuese un directorio
	más del sistema.
	</para>

	<figure id="samba-recursos-compartidos-en-toltec-vistos-desde-maya">
		<title>Recursos compartidos por <emphasis>toltec</emphasis> vistos desde
		<emphasis>maya</emphasis></title>
		
		<mediaobject>
			<imageobject>
				<imagedata fileref="./imagenes/samba-recursos-compartidos-en-toltec-vistos-desde-maya.png" format="PNG"/>
			</imageobject>
		</mediaobject>
	</figure>

	<para>
	Una característica interesante de Windows es la capacidad de mapear una letra de unidad (como
	E:, F: o Z:) hacia un directorio compartido usando la opción <quote>Conectar a Unidad de Red</quote>
	(<emphasis>Map Network Drive</emphasis>) desde el explorador de Windows
	<footnote><para>También puede hacer <emphasis>click</emphasis> con el botón derecho
	en el recurso compartido y seleccionar la entrada del menú <quote>Conectar a Unidad
	de Red</quote> (<emphasis>Map Network Drive</emphasis>).</para></footnote>. Una vez hecho esto,
	las aplicaciones podrán acceder a la carpeta compartida utilizando la letra de la unidad de
	disco asignada. Se pueden almacenar datos en ella, instalar y ejecutar programas desde ella e
	incluso protegerla con una contraseña para evitar accesos no deseados. La
	<xref linkend="samba-mapeo-de-una-unidad-de-red-en-una-letra-de-unidad-windows"/>
	muestra un ejemplo de mapeado de un directorio compartido hacia una letra de una unidad.
	</para>

	<figure id="samba-mapeo-de-una-unidad-de-red-en-una-letra-de-unidad-windows">
		<title>Mapeo de una unidad de red en una letra de unidad Windows</title>
		
		<mediaobject>
			<imageobject>
				<imagedata fileref="./imagenes/samba-mapeo-de-una-unidad-de-red-en-una-letra-de-unidad-windows.png" format="PNG"/>
			</imageobject>
		</mediaobject>
	</figure>

	<para>
	Eche un vistazo a la línea que aparece al lado de la ruta (<emphasis>Path</emphasis>) en la
	imagen <xref linkend="samba-mapeo-de-una-unidad-de-red-en-una-letra-de-unidad-windows"/>.
	Una forma equivalente de representar un directorio en una máquina de la red es utilizando
	dos barras invertidas (\\), seguidas del nombre de la máquina de red, otra barra invertida
	(\), y el directorio de red de la máquina, como se muestra en el
	<xref linkend="samba-ejemplo-representacion-directorio-maquina-de-red"/>:
	</para>


<example id="samba-ejemplo-representacion-directorio-maquina-de-red">
	<title>Representación de un directorio en una máquina de red</title>

	<screen>\\maquina-de-red\directorio</screen>
</example>

	<para>
	Esto se conoce como notación <acronym>UNC</acronym> (<emphasis>Universal Naming
	Convention</emphasis>) en el mundo Windows. Por ejemplo, la caja de diálogo de la
	<xref linkend="samba-mapeo-de-una-unidad-de-red-en-una-letra-de-unidad-windows"/>
	representa el directorio de red del servidor <emphasis>toltec</emphasis> como
	en el <xref linkend="samba-ejemplo-notacion-unc"/>:
	</para>
	
<example id="samba-ejemplo-notacion-unc">
	<title>Notación <acronym>UNC</acronym> (<emphasis>Universal Naming
	Convention</emphasis>)</title>

	<screen>\\toltec\spirit</screen>
</example>

	<para>
	Si esto le resulta familiar, probablemente esté pensando en <emphasis>uniform
	resource locator</emphasis> (<acronym>URL</acronym>), que es la notación que utilizan
	los navegadores web como <ulink url="http://www.mozilla.org/">Mozilla</ulink> o
	<ulink url="http://konqueror.kde.org/">Konqueror</ulink> para acceder a las máquinas a través
	de Internet. Asegúrese de no confundir ambas notaciones, las <acronym>URL</acronym>s
	utilizan barras inclinadas hacia la derecha en vez de barras invertidas, y están precedidas
	por el nombre del protocolo de transferencia de datos (por ejemplo: <acronym>ftp</acronym>,
	<acronym>http</acronym>) y dos puntos (:). En realidad, <acronym>URL</acronym>
	y <acronym>UNC</acronym> son dos cosas completamente distintas, aunque algunas veces
	se pueda especificar un recurso <acronym>SBM</acronym> haciendo uso de la notación
	<acronym>URL</acronym> en vez de la notación <acronym>UNC</acronym>. Para especificar
	la siguiente dirección, <emphasis>\\toltec\spirit</emphasis>, en notación
	<acronym>URL</acronym>, se ha de escribir: <emphasis>smb://toltec/spirit</emphasis>.
	</para>

	<para>
	Una vez que la unidad de red está configurada, Windows y sus programas la verán como una unidad
	de disco más. Si tiene alguna aplicación multiusuario, puede instalarla sobre una unidad de
	red<footnote><para>Tenga en cuenta que muchas veces la aceptación de la licencia de usuario
	final prohibe instalar un programa en red, de forma que varios clientes puedan acceder a el.
	Compruebe el acuerdo legal que acompaña al producto para asegurarse.</para></footnote>.
	La <xref linkend="samba-directorio-de-red-mapeado-como-la-unidad-J-en-el-cliente"/>
	muestra la unidad de red resultante, como si fuese una unidad más
	en el cliente Windows 98. Advierta la tubería de enlace en el icono de la unidad
	<quote>J:</quote>; esto indica que es una unidad de red, en lugar de una unidad física.
	</para>

	<figure id="samba-directorio-de-red-mapeado-como-la-unidad-J-en-el-cliente">
		<title>Un directorio de red mapeado como la unidad J en el cliente</title>
		
		<mediaobject>
			<imageobject>
				<imagedata fileref="./imagenes/samba-directorio-de-red-mapeado-como-la-unidad-J-en-el-cliente.png" format="PNG"/>
			</imageobject>
		</mediaobject>
	</figure>

	<para>
	Dependiendo del sistema operativo Widows que utilice (Windows Me, Windows 2000 o Windows XP),
	el entorno de red funcionará de una forma distinta. Es necesario pulsar sobre algunos iconos más,
	pero se puede ver el servidor <emphasis>toltec</emphasis> como se muestra en la
	<xref linkend="samba-recursos-compartidos-disponibles-en-toltec-vistos-desde-aztec"/>.
	Esta captura está realizada desde un sistema Windows 2000. Haciendo uso de la opción
	<quote>Conectar a unidad de red</quote> (<emphasis>Map Network Drive</emphasis>), obtendríamos el
	mismo resultado en otras versiones de Windows.
	</para>

	<figure id="samba-recursos-compartidos-disponibles-en-toltec-vistos-desde-aztec">
		<title>Recursos compartidos en <emphasis>toltec</emphasis> (vistos desde
		<emphasis>aztec</emphasis>)</title>
		
		<mediaobject>
			<imageobject>
				<imagedata fileref="./imagenes/samba-recursos-compartidos-disponibles-en-toltec-vistos-desde-aztec.png" format="PNG"/>
			</imageobject>
		</mediaobject>
	</figure>

</sect2>

<sect2 id="samba-compartiendo-una-impresora">
	<title>Compartiendo una impresora</title>
	<para>
	Probablemente se haya fijado en la impresora <emphasis>lp</emphasis> que aparece en la lista
	de recursos de <emphasis>toltec</emphasis> en la
	<xref linkend="samba-recursos-compartidos-en-toltec-vistos-desde-maya"/>. Esto indica que el
	servidor Unix posee una impresora que puede ser compartida con los clientes <acronym>SBM</acronym>
	del grupo de trabajo. Los datos enviados a la impresora desde cualquier cliente será
	colocado en la cola de impresión del servidor Unix, para seguidamente ser impresos en el
	orden de llegada.
	</para>

	<para>
	Configurar una impresora para que sea accesible a través de Samba a los clientes Windows es,
	si cabe más sencillo que configurar una unidad de disco. Haciendo doble <emphasis>click</emphasis>
	sobre la impresora e identificando el fabricante y modelo de la misma, puede instalar el controlador
	para esa impresora en el cliente Windows. Desde ese momento, Windows podrá formatear cualquier
	información enviada a la impresora de red y acceder a ella como si fuese una impresora local.
	En Windows 98, al hacer doble <emphasis>click</emphasis> sobre el icono de impresoras que aparece
	en el <emphasis>Panel de Control</emphasis>, abre la ventana de impresoras que se muestra en
	la <xref linkend="samba-impresora-en-red-disponible-en-toltec"/>. Una vez más, note la
	tubería colocada bajo la impresora, lo que indica que se trata de una impresora en red.
	</para>

	<figure id="samba-impresora-en-red-disponible-en-toltec">
		<title>Impresora en red disponible en <emphasis>toltec</emphasis></title>
		
		<mediaobject>
			<imageobject>
				<imagedata fileref="./imagenes/samba-impresora-en-red-disponible-en-toltec.png" format="PNG"/>
			</imageobject>
		</mediaobject>
	</figure>

</sect2>

<sect2 id="samba-viendo-las-cosas-desde-unix">
	<title>Viendo las cosas desde Unix</title>
	<para>
	Como se mencionó anteriormente, Samba no es más que un conjunto de demonios. Puede verlos
	haciendo uso de la orden <command>ps</command>; puede ver cualquier mensaje que generen
	a través de archivos de depuración personalizados o a través del <application>syslog</application>
	(dependiendo de como se haya configurado Samba); y puede configurarlos desde un único archivo
	de configuración: <filename>smb.conf</filename>. A parte de esto, si quiere saber que están
	haciendo los demonios en un determinado momento, Samba posee un programa denominado
	<command>smbstatus</command> que muestra la información requerida. El
	<xref linkend="samba-ejemplo-salida-smbstatus"/> muestra su salida:
	</para>

<example id="samba-ejemplo-salida-smbstatus">
	<title>Muestra de la salida de la orden <command>smbstatus</command></title>

<screen><prompt>#</prompt> <userinput>/usr/bin/smbstatus</userinput>
<computeroutput>Processing section "[homes]"
Processing section "[printers]"
Processing section "[spirit]"

Samba version 2.2.6
Service     uid    gid    pid     machine
-----------------------------------------
spirit      jay    jay    7735    maya     (172.16.1.6) Sun Aug 12 12:17:14 2002
spirit      jay    jay    7779    aztec    (172.16.1.2) Sun Aug 12 12:49:11 2002
jay         jay    jay    7735    maya     (172.16.1.6) Sun Aug 12 12:56:19 2002

Locked files:
Pid    DenyMode   R/W        Oplock     Name
--------------------------------------------------
7735   DENY_WRITE RDONLY     NONE       /u/RegClean.exe   Sun Aug 12 13:01:22 2002

Share mode memory usage (bytes):
   1048368(99%) free + 136(0%) used + 72(0%) overhead = 1048576(100%) total</computeroutput></screen>
</example>

	<para>
	El informe de estado de Samba proporciona tres grupos de datos, cada uno de ellos dividido en
	secciones separadas. La primera sección identifica los sistemas que han conectado con el servidor
	Samba, identificando a cada cliente por su nombre de máquina (<emphasis>maza</emphasis> y
	<emphasis>aztec</emphasis>)  y su dirección <acronym>IP</acronym>. La segunda sección
	informa del nombre y estado de los ficheros compartidos por el servidor que están actualmente
	en uso, incluyendo el estado de lectura/escritura o cualquier bloqueo que estos posean.
	Finalmente, Samba informa sobre la memoria en uso por los recursos que administra,
	incluyendo la cantidad de memoria que se está utilizando por los recursos compartidos más
	el gasto fijo de memoria. (Tenga en cuenta que esta no es la misma cantidad de memoria que el
	total de memoria utilizada por los procesos <command>smbd</command> y <command>nmbd</command>.)
	</para>
</sect2>
</sect1>

<sect1 id="samba-familiarizandose-con-una-red-smb">
	<title>Familiarizándose con una red <acronym>SMB</acronym></title>
	<para>
	Ahora que ya posee una breve visión sobre Samba, tómese algún tiempo para familiarizarse con
	el entorno que ha adoptado Samba: una red <acronym>SBM</acronym>. Trabajar con redes
	<acronym>SBM</acronym> es significativamente diferente a trabajar con protocolos comunes
	de <acronym>TCP/IP</acronym>, como <acronym>FTP</acronym> o <acronym>SSH</acronym>, debido a
	que hay bastantes conceptos nuevos que aprender y mucha información a cubrir. Primero, se
	discutirán los conceptos básicos existentes tras una red <acronym>SBM</acronym>, seguido
	de algunas implementaciones de Microsoft sobre <acronym>SBM</acronym>, para finalmente
	mostrar donde puede encajar un servidor Samba y dónde no.
	</para>

	<sect2 id="samba-comprendiendo-netbios">
		<title>Comprendiendo <acronym>NetBIOS</acronym></title>
		<para>
		Para comenzar, echemos la vista atrás. En 1984, <acronym>IBM</acronym> diseñó una
		<acronym>API</acronym> (<emphasis>Application Programming Interface</emphasis>) simple
		para conectar en red sus ordenadores, llamada <emphasis>Network Basic Input/Output
		System</emphasis> (<acronym>NetBIOS</acronym>). La <acronym>API</acronym>
		<acronym>NetBIOS</acronym> proporcionaba un diseño rudimentario para que una
		aplicación se conectase y compartiese datos con otros ordenadores. 
		</para>

		<para>
		Es útil pensar en la <acronym>API</acronym> <acronym>NetBIOS</acronym> como una
		extensión de red para las llamadas de la <acronym>API</acronym>
		<acronym>BIOS</acronym> estándar. La <acronym>BIOS</acronym> contiene código de bajo
		nivel para realizar operaciones en el sistema de archivos de un ordenador
		local. Originalmente, <acronym>NetBIOS</acronym> tenía que intercambiar instrucciones
		con los ordenadores a través de redes <emphasis><acronym>IBM</acronym>
		<acronym>PC</acronym></emphasis> o <emphasis>Token Ring</emphasis>. Esto
		exigió un protocolo de transporte de bajo nivel para transportar las peticiones
		de un ordenador al siguiente. 
		</para>

		<para>
		A finales de 1985, <acronym>IBM</acronym> liberó dicho protocolo, combinándolo con
		la <acronym>API</acronym> <acronym>NetBIOS</acronym> para convertirse en
		<emphasis><acronym>NetBIOS</acronym> Extended User Interface</emphasis>
		(<acronym>NetBEUI</acronym>). <acronym>NetBEUI</acronym> fue diseñado para pequeñas
		redes de área local (<acronym>LAN</acronym>s), permitiendo a cada ordenador usar un
		nombre (de hasta 15 caracteres) que no estuviese siendo utilizado en la red.
		Se entiende por una <quote><acronym>LAN</acronym> pequeña</quote>, una red de
		menos de 255 nodos -¡Esto se consideraba un número generoso en 1985!-. 
		</para>

		<para>
		El protocolo <acronym>NetBEUI</acronym> se volvió muy popular en las aplicaciones
		de red, incluyendo aquellas que corrían bajo <emphasis>Windows for Workgroups</emphasis>.
		Más tarde, aparecieron implementaciones de <acronym>NetBIOS</acronym> sobre los
		protocolos <acronym>IPX</acronym> de Novell, los cuales competían con
		<acronym>NetBEUI</acronym>. Sin embargo, los protocolos de red escogidos por la
		floreciente comunidad de Internet fueron <acronym>TCP/IP</acronym> y
		<acronym>UDP/IP</acronym>, así como las implementaciones de las
		<acronym>API</acronym>s <acronym>NetBIOS</acronym> sobre dichos protocolos, que
		pronto se convirtieron en una necesidad.
		</para>


		<para>
		Recuerde que <acronym>TCP/IP</acronym> hace uso de números para representar las
		direcciones de los ordenadores (192.168.220.100, por ejemplo), mientras que
		<acronym>NetBIOS</acronym> usa sólo nombres. Este fue el mayor problema encontrado
		a la hora de juntar los dos protocolos. En 1987, el grupo <acronym>IETF</acronym>
		(<emphasis>Internet Engineering Task Force</emphasis>) publicó una serie de documentos
		de estandarización, titulados <acronym>RFC</acronym> 1001 y 1002, que perfilaban cómo
		<acronym>NetBIOS</acronym> podría trabajar sobre una red <acronym>TCP/UDP</acronym>.
		Este conjunto de documentos todavía lidera las implementaciones que existen hoy en día,
		incluyendo aquellas proporcionadas por Microsoft para sus sistemas operativos Windows,
		así como a la suite Samba.
		</para> 

		<para>
		Desde entonces, el estándar que estos documentos lideran se ha convertido en
		<acronym>NetBIOS</acronym> sobre <acronym>TCP/IP</acronym>, o
		<acronym>NBT</acronym><footnote><para>También se puede ver la abreviación
		<acronym>NetBT</acronym>, utilizada comúnmente en la literatura de
		Microsoft.</para></footnote> para abreviar.
		</para>

		<para>
		El estándar <acronym>NBT</acronym> (<acronym>RFC</acronym> 1001/1002) actualmente
		establece un trio de servicios sobre una red: 
		</para>

		<itemizedlist mark='fillcircle'>
			<listitem>
				<para>Un Servicio de Nombres</para>
			</listitem>
			<listitem>
				<para>Dos Servicios de Comunicación:</para>

				<itemizedlist mark='opencircle'>
					<listitem>
						<para>Datagramas</para>
					</listitem>
					<listitem>
						<para>Sesiones</para>
					</listitem>
				</itemizedlist>
			</listitem>
		</itemizedlist>

		<para>
		El servicio de nombres resuelve el problema del paso de un nombre a una dirección
		anteriormente comentado; permite a cada ordenador proclamar un nombre específico
		en la red que puede se puede convertir en una dirección IP legible, como hacen hoy
		en día los <acronym>DNS</acronym> en Internet. Los servicios de datagramas y sesiones
		son protocolos secundarios de comunicación, usados para transmitir datos desde y
		hacia máquinas <acronym>NetBIOS</acronym> a través de la red.
		</para>

		<para>
		Como se ha visto hasta este momento, <acronym>SMB</acronym> puede correr sobre
		múltiples protocolos. El siguiente diagrama muestra este
		hecho<footnote><para>El gráfico ha sido obtenido de la entrada bibliográfica
		<xref linkend="bibliografia-sharpe-01"/>.</para></footnote>:
		</para>

		<figure id="samba-protocolos-sobre-los-que-se-ejecuta-sbm">
			<title>Protocolos sobre los que corre <acronym>SMB</acronym><footnote><para>Si
			quiere obtener el código fuente de esta imagen realizada con
			<xref linkend="dia"/> pulse
			<ulink url="./imagenes/samba-protocolos-sobre-los-que-se-ejecuta-sbm.dia">aquí</ulink>
			.</para></footnote></title>
			  
			<mediaobject>
				<imageobject>
					<imagedata fileref="./imagenes/samba-protocolos-sobre-los-que-se-ejecuta-sbm.png" format="PNG"/>
				</imageobject>
			</mediaobject>
		</figure>

	</sect2>

	<sect2 id="samba-obteniendo-un-nombre">
		<title>Obteniendo un nombre</title>
		<para>
		En el mundo <acronym>NetBIOS</acronym>, cuando cada ordenador se activa, quiere
		reclamar un nombre para sí; esto se denomina registro de nombre. Sin embargo,
		dos máquinas en el mismo grupo de trabajo no podrían solicitar el mismo nombre;
		ya que esto confundiría a una máquina que quisiese comunicarse con cualquiera de
		esas dos. Existen dos métodos diferentes para asegurarse de que esto no ocurrirá: 
		</para>

		<itemizedlist mark='fillcircle'>
			<listitem>
				<para>Hacer uso de <acronym>NBNS</acronym> para controlar el
				registro de nombres NetBIOS por parte de las máquinas</para>
			</listitem>
			<listitem>
				<para>Permitir la defensa de su nombre a cada máquina de la red,
				en el caso de que otra máquina intente usarlo</para>
			</listitem>
		</itemizedlist>

		<para>
		La <xref linkend="samba-registro-de-nombres-broadcast-vs-NBNS"/> ilustra un registro
		de nombre (fallido), con y sin <acronym>NBNS</acronym>.
		</para>

		<figure id="samba-registro-de-nombres-broadcast-vs-NBNS">
			<title>Registro de nombres Broadcast versus <acronym>NBNS</acronym><footnote><para>Si
			quiere obtener el código fuente de esta imagen realizada con
			<xref linkend="dia"/> pulse
			<ulink url="./imagenes/samba-registro-de-nombres-broadcast-vs-NBNS.dia">aquí</ulink>
			.</para></footnote></title>
			  
			<mediaobject>
				<imageobject>
					<imagedata fileref="./imagenes/samba-registro-de-nombres-broadcast-vs-NBNS.png" format="PNG"/>
				</imageobject>
			</mediaobject>
		</figure>
 
		<para>
		Como se mencionó anteriormente, debería existir alguna forma de resolver nombres
		<acronym>NetBIOS</acronym> a la dirección <acronym>IP</acronym> correspondiente;
		a esto se le conoce como <emphasis>resolución de nombres</emphasis>. Existen
		dos estrategias diferentes con <acronym>NBT</acronym> aquí también:
		</para>

		<itemizedlist mark='fillcircle'>
			<listitem>
				<para>Que cada ordenador comunique su dirección <acronym>IP</acronym>
				cuando <quote>escuche</quote> una petición broadcast para
				su nombre <acronym>NetBIOS</acronym></para>
			</listitem>
			<listitem>
				<para>Usar el <acronym>NBNS</acronym> para ayudar a resolver los nombres
				<acronym>NetBIOS</acronym> a direcciones <acronym>IP</acronym></para>
			</listitem>
		</itemizedlist>

		<para>
		La <xref linkend="samba-resolucion-de-nombres-broadcast-vs-NBNS"/> ilustra los dos
		tipos de resolución de nombres.
		</para>

		<figure id="samba-resolucion-de-nombres-broadcast-vs-NBNS">
			<title>Resolución de nombres Broadcast versus
			<acronym>NBNS</acronym><footnote><para>Si quiere obtener el código fuente
			de esta imagen realizada con <xref linkend="dia"/> pulse
			<ulink url="./imagenes/samba-resolucion-de-nombres-broadcast-vs-NBNS.dia">aquí</ulink>
			.</para></footnote></title>
			  
			<mediaobject>
				<imageobject>
					<imagedata fileref="./imagenes/samba-resolucion-de-nombres-broadcast-vs-NBNS.png" format="PNG"/>
				</imageobject>
			</mediaobject>
		</figure>

		<para>
		Como se podría esperar, tener un <acronym>NBNS</acronym> en su red puede ayudar
		enormemente. Para ver exactamente por qué, eche un vistazo al método broadcast.
		</para>

		<para>
		Aquí, cuando un cliente arranca, envía un mensaje broadcast manifestando su deseo
		de registrar un nombre <acronym>NetBIOS</acronym> específico para el. Si nadie pone
		objeción al uso del nombre, el obtiene el nombre. Por otro lado, si otra máquina en
		la subred local está actualmente usando ese nombre, enviará un mensaje de respuesta
		al cliente solicitante indicando que ese nombre ya está siendo usado. Esto es conocido
		como <emphasis>defender el nombre del host</emphasis>. Este tipo de sistema es útil
		cuando un cliente se ha caído inesperadamente de la red -otro puede tomar su nombre-,
		pero se incurre en un importante aumento del tráfico de la red para algo tan simple
		como el registro de un nombre.
		</para>

		<para>
		Con un <acronym>NBNS</acronym>, ocurre lo mismo, pero con la diferencia de que la
		comunicación está confinada a la máquina solicitante y al servidor de nombres
		<acronym>NBNS</acronym>. No se produce un broadcast cuando una máquina desea registrar
		su nombre; el mensaje de registro es simplemente enviado desde el cliente hacia el
		servidor <acronym>NBNS</acronym>, y el servidor <acronym>NBNS</acronym> responde si
		el nombre está o no libre. A esto se le denomina como <emphasis>comunicación
		punto-a-punto</emphasis>, y es beneficioso en redes con más de una subred. Esto se debe
		a que los routers suelen estar preconfigurados para bloquear los paquetes broadcast
		entrantes. 
		</para>

		<para>
		Los mismos principios se aplican a la resolución de nombres. Sin un servidor
		<acronym>NBNS</acronym>, la resolución de nombres <acronym>NetBIOS</acronym> se
		podría realizar mediante broadcast. Todos los paquetes se enviarían a cada
		ordenador de la red, con la esperanza de que el ordenador afectado por la petición
		responda directamente a la máquina solicitante. El uso de un servidor
		<acronym>NBNS</acronym> y la comunicación punto-a-punto para este propósito carga
		mucho menos la red que inundar la red con peticiones broadcast para cada petición
		de resolución de nombres que se produzca.
		</para>

		<para>
		Se puede discutir que los paquetes broadcast no causan problemas significativos en las
		redes modernas y de gran ancho de banda compuestas por máquinas con <acronym>CPU</acronym>s
		muy rápidas, si sólo un grupo reducido de ordenadores están presentes en la red, o
		la demanda de ancho de banda es pequeña. Hay muchos casos en los que la anterior
		suposición es cierta; sin embargo, se aconseja no confiar en el broadcast tanto como
		se pueda. Esta es una regla a seguir en redes grandes y saturadas, y si se sigue este
		consejo a la hora de configurar redes pequeñas, estas podrán crecer sin problemas
		en el futuro.
		</para>

	</sect2>

	<sect2 id="samba-tipos-de-nodos">
		<title>Tipos de nodos</title>
		<para>
		¿Cómo informo a los clientes sobre la estrategia a seguir para realizar el registro
		y la resolución de nombres? Cada máquina en una red <acronym>NBT</acronym> gana
		una de las siguientes designaciones, dependiendo de cómo se maneje el registro y
		la resolución de nombres: b-node, p-node, m-node y h-node. El comportamiento de
		cada tipo de nodo se resumen en la <xref linkend="samba-tipos-de-nodo-netbios"/>. 
		</para>

		<table frame="all" id="samba-tipos-de-nodo-netbios">
			<title>Tipos de nodo <acronym>NetBIOS</acronym></title>

			<tgroup cols='2' align='left' colsep='1' rowsep='1'>
				<thead>
					<row>
					  <entry align="center">Rol</entry>
					  <entry align="center">Valor</entry>
					</row>
				</thead>

				<tbody>
					<row>
						<entry>b-node</entry>
						<entry>Hace uso de registro y resolución broadcast
						únicamente</entry>
					</row>
					<row>
						<entry>p-node</entry>
						<entry>Hace uso de registro y resolución punto-a-punto
						únicamente</entry>
					</row>
					<row>
						<entry>m-node (mixto)</entry>
						<entry>Hace uso de broadcast para el registro. Si
						lo consigue, notifica al servidor
						<acronym>NBNS</acronym> el resultado. Hace uso de
						broadcast para la resolución; utiliza
						<acronym>NBNS</acronym> si el broadcast no ha
						tenido éxito</entry>
					</row>
					<row>
						<entry>h-node (híbrido)</entry>
						<entry>Hace uso del servidor <acronym>NBNS</acronym>
						para el registro y la resolución; utiliza broadcast
						si el servidor <acronym>NBNS</acronym> no responde
						o no está operativo</entry>
					</row>
				</tbody>
			</tgroup>
		</table>

		<para>
		Los clientes Windows suelen encontrarse como <emphasis>h-nodes</emphasis> o nodos híbridos.
		Los tres primeros tipos de nodos aparecen el los <acronym>RFC</acronym>s 1001/1002, y
		los <emphasis>h-nodes</emphasis> fueron inventados más tarde por Microsoft, como un
		método más tolerable a fallos.
		</para>

		<para>
		Puede encontrar el tipo de nodo de un ordenador Windows 95/98/Me ejecutando la orden
		<command>winipcfg</command> y pulsando sobre el botón de <emphasis>Más
		información</emphasis>. En Windows <acronym>NT</acronym>/2000/<acronym>XP</acronym>,
		puede hacer uso de la orden
		<command>ipconfig /all</command> en el prompt de una ventana de comandos. En cualquier
		caso, busque la línea que diga <emphasis>Node Type</emphasis>.
		</para>
	</sect2>

	<sect2 id="samba-que-hay-en-un-nombre">
		<title>¿Qué hay en un nombre?</title>
		<para>
		Los nombres utilizados en <acronym>NetBIOS</acronym> son ligeramente diferentes de los
		nombres empleados en los <acronym>DNS</acronym>, con los que estará familiarizado. En
		primer lugar, los nombres <acronym>NetBIOS</acronym> existen en un espacio de nombres
		único. En otras palabras, no existen niveles jerárquicos como en samba.org (dos
		niveles) o en ftp.samba.org (tres niveles). Los nombres <acronym>NetBIOS</acronym>
		están formados por una única cadena como <emphasis>toltec</emphasis> o
		<emphasis>maya</emphasis>, cada uno de ellos pertenecientes a un grupo de trabajo o
		un dominio. En segundo lugar, los nombres <acronym>NetBIOS</acronym> sólo pueden contener
		15 caracteres y están compuestos únicamente por los caracteres alfanuméricos estándar
		(a-z, A-Z, 0-9) y los siguientes:
		</para>

<programlisting><![CDATA[!  @  #  $  %  ^  &  (  )  -  '  {  }  .  ~]]></programlisting>

		<para>
		Aunque se puede hacer uso del punto (.) en un nombre <acronym>NetBIOS</acronym>, no
		es recomendable, debido a que esos nombres puede que no funcionen en futuras
		versiones de <acronym>NBT</acronym>. 
		</para>

		<para>
		No es una coincidencia que todos los nombres <acronym>DNS</acronym> válidos también
		sean válidos en <acronym>NetBIOS</acronym>. De hecho, el nombre <acronym>DNS</acronym>
		para un servidor Samba es frecuentemente usado como su nombre <acronym>NetBIOS</acronym>.
		Por ejemplo, si tiene un sistema con el siguiente nombre:
		<emphasis>toltec.ora.com</emphasis>, su nombre <acronym>NetBIOS</acronym> podría
		ser TOLTEC (seguido de 9 espacios en blanco). 
		</para>
	
		<sect3 id="samba-nombres-de-recursos-y-tipos">
			<title>Nombres de recursos y tipos</title>
			<para>
			Con <acronym>NetBIOS</acronym>, un ordenador no sólo anuncia su presencia,
			sino que también comunica a las otras máquinas que tipo de servicios ofrece.
			Por ejemplo, <emphasis>toltec</emphasis> puede indicar que no es únicamente una
			estación de trabajo, sino que también es un servidor de ficheros y puede
			recibir mensajes Windows Messenger. Esto se consigue añadiendo el byte
			décimosexto al final del nombre de la máquina (recurso), denominado tipo de
			recurso, y registrando el nombre más de una vez, una vez por cada servicio
			que ofrece. Observe la <xref linkend="samba-estructura-de-nombres-netbios"/>.
			</para>

			<figure id="samba-estructura-de-nombres-netbios">
				<title>Estructura de nombres <acronym>NetBIOS</acronym><footnote><para>Si
				quiere obtener el código fuente de esta imagen realizada con
				<xref linkend="dia"/> pulse
				<ulink url="./imagenes/samba-estructura-de-nombres-netbios.dia">aquí</ulink>.
				</para></footnote></title>
				  
				<mediaobject>
					<imageobject>
						<imagedata fileref="./imagenes/samba-estructura-de-nombres-netbios.png" format="PNG"/>
					</imageobject>
				</mediaobject>
			</figure>

			<para>
			El tipo de recurso de 1 byte indica el único servicio que el ordenador ofrece.
			La notación empleada a partir de este momento para mostrar el tipo de
			servicio ofrecido por un determinado ordenador estará enmarcada entre los
			símbolos de mayor y menor que (&lt;&gt;) después del nombre
			<acronym>NetBIOS</acronym>, como se muestra en el
			<xref linkend="samba-ejemplo-notacion-tipo-servicio"/>: 
			</para>

<example id="samba-ejemplo-notacion-tipo-servicio">
	<title>Notación empleada para mostrar el tipo de servicio <acronym>NetBIOS</acronym>
	ofrecido por un ordenador</title>

	<programlisting>TOLTEC&lt;00&gt;</programlisting>
</example>

			<para>
			Puede saber qué nombres están registrados para una máquina <acronym>NBT</acronym>
			determinada usando la orden de Windows <command>nbtstat</command>. Debido a
			que estos servicios son únicos (no puede haber más de uno registrado),
			aparecerán listados como tipo ÚNICO (UNIQUE) en la salida. Por ejemplo,
			el <xref linkend="samba-ejemplo-ejecucion-nbtstat"/>
			describe al servidor <emphasis>toltec</emphasis>: 
			</para>

<example id="samba-ejemplo-ejecucion-nbtstat">
	<title>Ejecución de la orden <command>nbtstat</command></title>

<screen><prompt>D:\></prompt> <userinput>nbtstat -a toltec</userinput>
<computeroutput><![CDATA[       NetBIOS Remote Machine Name Table
   Name               Type         Status
---------------------------------------------
TOLTEC          <00>  UNIQUE      Registered
TOLTEC          <03>  UNIQUE      Registered
TOLTEC          <20>  UNIQUE      Registered
...]]></computeroutput></screen>
</example>

			<para>
			Esto indica que el servidor ha registrado el nombre <acronym>NetBIOS</acronym>
			<emphasis>toltec</emphasis> como nombre de máquina, como un receptor
			de mensajes desde el servicio Messenger de Windows y como un servidor de
			archivos. Algunos de los posibles atributos que un nombre puede tener se
			listan en la <xref linkend="samba-tipos-de-recursos-unicos-netbios"/>. 
			</para>

			<table frame="all" id="samba-tipos-de-recursos-unicos-netbios">
				<title>Tipos de recursos únicos <acronym>NetBIOS</acronym></title>

				<tgroup cols='2' align='left' colsep='1' rowsep='1'>
					<thead>
						<row>
						  <entry align="center">Nombre del Recurso</entry>
						  <entry>Valor en hexadecimal del byte</entry>
						</row>
					</thead>

					<tbody>
						<row>
							<entry>Standard Workstation Service</entry>
							<entry>00</entry>
						</row>
						<row>
							<entry>Messenger Service</entry>
							<entry>03</entry>
						</row>
						<row>
							<entry>RAS Server Service</entry>
							<entry>06</entry>
						</row>
						<row>
							<entry>Domain Master Browser Service (associated
							with primary domain controller)</entry>
							<entry>1B</entry>
						</row>
						<row>
							<entry>Master Browser name</entry>
							<entry>1D</entry>
						</row>
						<row>
							<entry>NetDDE Service</entry>
							<entry>1F</entry>
						</row>
						<row>
							<entry>Fileserver (including printer server)</entry>
							<entry>20</entry>
						</row>
						<row>
							<entry>RAS Client Service</entry>
							<entry>21</entry>
						</row>
						<row>
							<entry>Network Monitor Agent</entry>
							<entry>BE</entry>
						</row>
						<row>
							<entry>Network Monitor Utility</entry>
							<entry>BF</entry>
						</row>
					</tbody>
				</tgroup>
			</table>

		</sect3>

		<sect3 id="samba-nombres-de-grupos-y-tipos">
			<title>Nombres de grupos y tipos</title>
			<para>
			<acronym>SMB</acronym> también usa el concepto de grupos, con los cuales
			los ordenadores se pueden registras ellos mismos. Anteriormente se mencionó
			que los ordenadores del ejemplo pertenecían a un grupo de trabajo, el cual es
			una partición de ordenadores en la misma red. Por ejemplo, una empresa podría
			tener fácilmente un grupo de trabajo ADMINISTRACIÓN y otro VENTAS, cada uno
			con diferentes servidores e impresoras. En el mundo Windows, un grupo de
			trabajo y un grupo <acronym>SMB</acronym> son la misma cosa. 
			</para>

			<para>
			Continuando con el ejemplo sobre <command>nbtstat</command>, el servidor Samba
			<emphasis>toltec</emphasis> es también un miembro del grupo de trabajo
			<emphasis>METRAN</emphasis> (el atributo GROUP hex 00), y participará
			en la elección del buscador (browser) maestro (atributo GROUP 1E). Observe el
			<xref linkend="samba-ejemplo-nbtstat-muestra-de-los-grupos"/>>: 
			</para>

<example id="samba-ejemplo-nbtstat-muestra-de-los-grupos">
	<title>Muestra de los grupos a los que pertenece un servidor con <command>nbtstat</command></title>

<screen><computeroutput><![CDATA[       NetBIOS Remote Machine Name Table
   Name               Type         Status
---------------------------------------------
METRAN         <00>   GROUP       Registered
METRAN         <1E>   GROUP       Registered
..__MSBROWSE__.<01>   GROUP       Registered]]></computeroutput></screen>
</example>

			<para>
			Los posibles atributos de grupo que puede tener una máquina se ilustran en la
			<xref linkend="samba-tipos-de-recursos-de-grupo-netbios"/>. Existe más
			información disponible en el libro
			<quote>Windows NT in a Nutshell</quote> de Eric Pearce, publicado por O'Reilly. 
			</para>

			<table frame="all" id="samba-tipos-de-recursos-de-grupo-netbios">
				<title>Tipos de Recursos de Grupo <acronym>NetBIOS</acronym></title>

				<tgroup cols='2' align='left' colsep='1' rowsep='1'>
					<thead>
						<row>
						  <entry align="center">Nombre del Recurso</entry>
						  <entry>Valor en hexadecimal del byte</entry>
						</row>
					</thead>

					<tbody>
						<row>
							<entry>Standard Workstation group</entry>
							<entry>00</entry>
						</row>
						<row>
							<entry>Logon server</entry>
							<entry>1C</entry>
						</row>
						<row>
							<entry>Master Browser name</entry>
							<entry>1D</entry>
						</row>
						<row>
							<entry>Normal Group name (used in browser
							elections)</entry>
							<entry>1E</entry>
						</row>
						<row>
							<entry>Internet Group name (administrative)</entry>
							<entry>20</entry>
						</row>
						<row>
							<entry><![CDATA[<01><02>_ _MSBROWSE_ _<02>]]></entry>
							<entry>01</entry>
						</row>
					</tbody>
				</tgroup>
			</table>

			<para>
			La entrada final, _ _ MSBROWSE _ _, es utilizada para anunciar un grupo a otros
			buscadores maestros. Los caracteres no imprimibles en el nombre se
			muestran como guiones bajos en una salida de <command>nbtstat</command>. No
			se preocupe si no comprende todos los recursos o tipos de grupos. Algunos de
			ellos no los necesitará con Samba, y sobre los otros se verá más en el resto
			del capítulo. Lo importante aquí es recordar la lógica del mecanismo de nombres.
			</para>
		</sect3>
	</sect2>

	<sect2 id="samba-scope-id">
		<title><emphasis>Scope</emphasis> <acronym>ID</acronym></title>
		<para>
		En los años oscuros del funcionamiento en red de <acronym>SMB</acronym>, antes de la
		introducción de los grupos <acronym>NetBIOS</acronym>, se debía utilizar una
		estrategia muy primitiva para aislar grupos de ordenadores del resto de la red.
		Cada paquete <acronym>SMB</acronym> contenía un campo denominado
		<emphasis>scope ID</emphasis>, la idea era que los sistemas de la red se pudiesen
		configurar de forma que sólo aceptasen los paquetes con el <emphasis>scope ID</emphasis>
		que coincidiese con su configuración. Esta característica fue apenas utilizada y
		desgraciadamente aun pervive en las implementaciones modernas. Algunas de las
		utilidades incluidas en la distribución de Samba permite establecer el
		<emphasis>scope ID</emphasis>. El establecimiento del <emphasis>scope ID</emphasis>
		en una red es sinónimo de problemas, sólo se ha mencionado para evitar confusiones
		cuando aparezca el término más adelante.
		</para>
	</sect2>

	<sect2 id="samba-datagramas-y-sesiones">
		<title>Datagramas y sesiones</title>
		<para>
		En este punto, se hará un paréntesis para abordar la responsabilidad de
		<acronym>NBT</acronym>: proporcionar servicios de conexión entre dos máquinas
		<acronym>NetBIOS</acronym>. <acronym>NBT</acronym> ofrece dos servicios: el servicio
		de sesión y el servicio de datagramas. Comprender cómo funcionan estos servicios no
		es vital para usar Samba, pero le dará una idea sobre cómo trabaja
		<acronym>NBT</acronym> y cómo arreglar problemas cuando Samba no funcione. 
		</para>

		<para>
		El servicio de datagramas no proporciona una conexión estable entre ordenadores.
		Los paquetes de datos se envían o difunden (broadcast) de una máquina a otra, sin
		tener en cuenta el orden en que estos llegan al destino, o incluso si han llegado
		todos. El uso de datagramas requiere menos procesamiento que las sesiones, aunque
		la confiabilidad de la conexión puede sufrir. Los datagramas, por tanto, son
		empleados para enviar rápidamente bloques no vitales de datos a una o más
		máquinas. El servicio de datagramas se comunica usando las primitivas que se
		muestran en la <xref linkend="samba-primitivas-de-datagramas"/>. 
		</para>

		<table frame="all" id="samba-primitivas-de-datagramas">
			<title>Primitivas de datagrama</title>

			<tgroup cols='2' align='left' colsep='1' rowsep='1'>
				<thead>
					<row>
					  <entry align="center">Primitiva</entry>
					  <entry>Descripción</entry>
					</row>
				</thead>

				<tbody>
					<row>
						<entry>Send Datagram</entry>
						<entry>Envía un paquete datagrama a un ordenador
						o grupo de ordenadores</entry>
					</row>
					<row>
						<entry>Send Broadcast Datagram</entry>
						<entry>Difunde (broadcast) datagramas a cualquier
						ordenador, esperando por un <emphasis>Receive
						Broadcast datagram</emphasis> (datagrama de
						acuse de recibo)</entry>
					</row>
					<row>
						<entry>Receive Datagram</entry>
						<entry>Recibe un datagrama desde un ordenador</entry>
					</row>
					<row>
						<entry>Receive Broadcast Datagram</entry>
						<entry>Espera por un datagrama de difusión
						(broadcast)</entry>
					</row>
				</tbody>
			</tgroup>
		</table>

		<para>
		El servicio de sesiones es más complejo. Las sesiones son un método de comunicación que,
		en teoría, ofrece la capacidad de detectar conexiones problemáticas o inoperativas entre
		dos aplicaciones <acronym>NetBIOS</acronym>. Esto lleva a pensar en una sesión
		<acronym>NBT</acronym> en términos de una llamada telefónica, analogía que obviamente
		influyó en el diseño del estándar <acronym>CIFS</acronym>.
		</para>

		<para>
		Una vez que se establece la conexión, permanece abierta durante toda la
		<emphasis>conversación</emphasis>, cada lado conoce quien es el ordenador emisor y receptor,
		y cada uno se puede comunicar haciendo uso de las primitivas mostradas en la
		<xref linkend="samba-primitivas-de-sesion"/>.
		</para>

		<table frame="all" id="samba-primitivas-de-sesion">
			<title>Primitivas de sesión</title>

			<tgroup cols='2' align='left' colsep='1' rowsep='1'>
				<thead>
					<row>
					  <entry align="center">Primitiva</entry>
					  <entry>Descripción</entry>
					</row>
				</thead>

				<tbody>
					<row>
						<entry>Call</entry>
						<entry>Inicia una sesión con un ordenador que está
						escuchando bajo un nombre determinado</entry>
					</row>
					<row>
						<entry>Listen</entry>
						<entry>Espera por una llamada desde un emisor
						conocido o cualquier emisor</entry>
					</row>
					<row>
						<entry>Hang-up</entry>
						<entry>Finaliza una conversación</entry>
					</row>
					<row>
						<entry>Send</entry>
						<entry>Envía datos al otro ordenador</entry>
					</row>
					<row>
						<entry>Receive</entry>
						<entry>Recibe datos del otro ordenador</entry>
					</row>
					<row>
						<entry>Session Status</entry>
						<entry>Obtiene información de las sesiones solicitadas</entry>
					</row>
				</tbody>
			</tgroup>
		</table>

		<para>
		Las sesiones son el <emphasis>backbone</emphasis> de la compartición de recursos en
		una red <acronym>NBT</acronym>. Se utilizan normalmente para establecer conexiones
		estables desde los clientes a unidades de disco o impresoras compartidas en un servidor.
		El cliente <quote>llama</quote> al servidor y comienza a negociar la información,
		como los archivos que desea abrir, los datos que desea intercambiar, etc. Estas llamadas
		pueden durar mucho tiempo -horas, incluso días- y todo esto ocurre dentro del contexto
		de una única conexión. Si se produce un error, el software de sesión
		(<acronym>TCP</acronym>) retransmitirá los datos hasta que se reciban
		correctamente, a diferencia del método <quote>envía-y-reza</quote> del servicio
		de datagramas (<acronym>UDP</acronym>). 
		</para>

		<para>
		En realidad, mientras que las sesiones se supone que están para manejar
		comunicaciones problemáticas, algunas veces no lo hacen. Si la conexión es
		interrumpida, la información de sesión que está abierta entre dos ordenadores
		puede volverse inválida. Si esto ocurre, la única forma de restablecer
		la sesión entre los dos ordenadores es llamar de nuevo y comenzar desde cero. 
		</para>

		<para>
		Si desea más información sobre estos servicios, eche un vistazo al
		<acronym>RFC</acronym> 1001. Sin embargo, hay dos cosas importantes a recordar aquí: 
		</para>

		<itemizedlist mark='fillcircle'>
			<listitem>
				<para>Las sesiones siempre ocurren entre dos máquinas
				<acronym>NetBIOS</acronym>. Si una sesión se interrumpe, se supone
				que el cliente ha almacenado suficiente información de estado
				para restablecerla. Sin embargo, en la práctica, normalmente
				esto no ocurre.</para>
			</listitem>
			<listitem>
				<para>Los datagramas pueden ser difundidos (broadcast)
				hacia múltiples ordenadores, pero no son confiables. En otras palabras,
				no hay manera de que el emisor sepa si los datagramas que ha enviado
				han llegado correctamente a sus destinos.</para>
			</listitem>
		</itemizedlist>
	</sect2>
</sect1>

<sect1 id="samba-grupos-de-trabajo-y-dominios-windows">
	<title>Grupos de trabajo y dominios Windows</title>
	<para>
	Hasta ahora se ha cubierto la tecnología básica <acronym>SMB</acronym>, que sería todo lo que
	necesitaría saber si su red estuviese compuesta únicamente de clientes <acronym>MS-DOS</acronym>.
	Se asumirá que posee clientes Windows, especialmente las versiones más recientes, por lo
	que en las siguientes secciones se describirán las mejoras que Microsoft ha introducido en
	en las redes <acronym>SMB</acronym> -denominadas: <emphasis>Windows para grupos de
	trabajo</emphasis> y <emphasis>Dominios Windows</emphasis>.
	</para>

	<sect2 id="samba-grupos-de-trabajo-windows">
		<title>Grupos de trabajo Windows</title>
		<para>
		Los grupos de trabajo de Windows son muy similares a los grupos <acronym>SMB</acronym>
		ya descritos. Pero necesita saber algunas cosas adicionales.
		</para>
	</sect2>

	<sect2 id="samba-navegando">
		<title>Navegando</title>
		<para>
		La navegación es el proceso de buscar otros ordenadores o recursos compartidos en la
		red Windows. Tenga en cuenta que no tiene ningún parecido con un navegador web,
		a parte de la idea general de <quote>descubrir que hay</quote>. Por otro lado,
		navegar por la red de Windows es parecido a hacerlo por la web, en el sentido de que
		todo lo que existe pude cambiar sin previo aviso.
		</para>

		<para>
		Antes de la existencia del navegador, los usuarios debían conocer el nombre
		del ordenador al que se querían conectar, luego tenían que teclear manualmente
		una dirección <acronym>UNC</acronym> en el gestor de archivos o la aplicación implicada
		para poder acceder al recurso. La dirección <acronym>UNC</acronym> era algo
		parecido a lo que se muestra en el <xref linkend="samba-ejemplo-notacion-unc-2"/>:		
		</para>

<example id="samba-ejemplo-notacion-unc-2">
	<title>Notación <acronym>UNC</acronym></title>

	<screen>\\toltec\spirit\</screen>
</example>

		<para>
		La navegación es mucho más conveniente, ya que permite examinar los contenidos de la red
		haciendo uso de una interfaz <quote>apunta-y-pulsa</quote> del entorno de red de los
		clientes Windows.
		</para>

		<para>
		Encontrará dos tipos de navegación en una red <acronym>SMB</acronym>:
		</para>

		<itemizedlist mark='fillcircle'>
			<listitem>
				<para>Navegar por una lista de ordenadores y sus recursos compartidos</para>
			</listitem>
			<listitem>
				<para>Navegar por los recursos compartidos de un determinado ordenador</para>
			</listitem>
		</itemizedlist>

		<para>
		A continuación se profundizará un poco en el primer tipo. En cada <acronym>LAN</acronym>
		(o subred) con un grupo de trabajo o dominio Windows, un ordenador tiene la responsabilidad
		de mantener la lista de ordenadores que están en un momento dado accesibles a través
		de la red. Este ordenador se denomina buscador (browser) maestro local, y la lista
		que mantiene se denomina lista de búsqueda. Los ordenadores de una red utilizan la
		lista de búsqueda para minimizar el tráfico de datos necesario para realizar una
		búsqueda. En vez de que cada ordenador pregunte por la lista de ordenadores actualmente
		disponibles, estos pueden preguntar al buscador maestro local para obtener una
		lista completa y actualizada.
		</para>

		<para>
		Para navegar por los recursos de un determinado ordenador, el usuario debe conectar
		a dicho ordenador; esta información no se puede obtener de la lista de búsqueda.
		La navegación por la lista de recursos compartidos de un ordenador se realiza haciendo
		doble <emphasis>click</emphasis> sobre el icono del ordenador que se presenta en el
		entorno de red. Como se veía al principio del capítulo, el ordenador responderá con
		una lista de los recursos que están accesibles una vez que el usuario se haya autentificado.
		</para>

		<para>
		Cada servidor en un grupo de trabajo Windows necesita anunciar su presencia al brower
		maestro local, una vez que ha registrado su nombre <acronym>NetBIOS</acronym>, y
		(teóricamente) anuncia que va a dejar el grupo de trabajo cuando es desconectado.
		Es responsabilidad del buscador maestro local almacenar los servidores que se han anunciado.
		</para>

		<warning><para>El entorno de red de Windows puede comportarse de manera extraña:
		hasta que se selecciona un ordenador, el entorno de red de Windows puede
		contener información no actualizada. Esto significa que el entorno de red de
		Windows puede mostrar ordenadores que se han caído o no informar de aquellos
		ordenadores que todavía no se han anunciado. Resumiendo, una vez seleccionado un
		servidor y realizada la conexión con el, puede estar seguro de que los
		recursos compartidos así como las impresoras existen realmente en la red.</para></warning>

		<para>
		A parte de los roles vistos con anterioridad, casi cualquier sistema Windows
		(incluyendo Windows para grupos de trabajo y Windows 95/98/Me o Windows
		<acronym>NT</acronym>/2000/<acronym>XP</acronym>)
		puede actuar como un buscador maestro local. Un buscador maestro local puede tener uno
		o más buscadores de respaldo en la subred local, que tomarán el relevo al buscador
		maestro local en el caso de que este falle o se vuelva inaccesible. Para asegurar
		operaciones fluidas, los buscadores de respaldo actualizarán frecuentemente su lista
		con la del buscador maestro local.
		</para>

		<para>
		A continuación se muestra como calcular el número mínimo de buscadores de respaldo que
		se pueden asignar en un grupo de trabajo:
		</para>

		<itemizedlist mark='fillcircle'>
			<listitem>
				<para>Si la red está formada por hasta 32 máquinas Windows
				<acronym>NT</acronym>/2000/<acronym>XP</acronym>,
				o hasta 16 máquinas Windows 95/98/Me, el buscador maestro local
				asigna un buscador de respaldo a mayores del buscador maestro local</para>
			</listitem>
			<listitem>
				<para>Si el número de máquinas Windows
				<acronym>NT</acronym>/2000/<acronym>XP</acronym> está comprendido
				entre 33 y 64, o el número de máquinas Windows 95/98/Me está
				comprendido entre 17 y 32, el buscador maestro local asigna
				dos buscadores de respaldo</para>
			</listitem>
			<listitem>
				<para>Para cada grupo de 32 máquinas Windows
				<acronym>NT</acronym>/2000/<acronym>XP</acronym> o
				16 ordenadores  Windows 95/98/Me además de esto, el buscador
				maestro local asigna otro buscador de respaldo</para>
			</listitem>
		</itemizedlist>

		<para>
		No existe límite en cuanto al número máximo de buscadores de respaldo que pueden ser
		asignados por un buscador maestro local.
		</para>
	</sect2>

	<sect2 id="samba-elecciones-para-navegación">
		<title>Elecciones para la navegación</title>
		<para>
		La navegación es un aspecto crítico en cualquier grupo de trabajo Windows. Sin embargo,
		no todo funciona correctamente en todas las redes. Sirva el siguiente ejemplo para
		ilustrar este hecho: imagínese un ordenador con Windows ubicado en el despacho de
		un <acronym>CEO</acronym> de una pequeña compañía actúa como buscador maestro local
		-esto quiere decir, que será un buscador maestro local hasta que el <acronym>CEO</acronym>
		lo desconecte para recibir su masaje-. En este momento, la máquina Windows
		<acronym>NT</acronym> ubicada en la sección de piezas de recambio de un departamento
		está dispuesta a tomar el control del trabajo. Sin embargo, dicho ordenador está
		ejecutando un programa extremadamente grande y mal escrito que está consumiendo
		los recursos del procesador. La moraleja: los navegadores han de ser muy tolerantes
		con las idas y venidas de los servidores. Debido a que casi cualquier sistema
		Windows puede servir como buscador, ha de haber alguna forma de decidir en cualquier
		momento quien toma el trabajo. El proceso de decisión se denomina
		<emphasis>elección</emphasis>.
		</para>

		<para>
		Casi cualquier sistema Windows tiene un algoritmo de elección, de forma que
		los sistemas se puedan poner de acuerdo en quien será el buscador maestro local y
		quien el buscador de respaldo local. Una elección puede ser forzada en cualquier momento.
		Por ejemplo, imagine que el <acronym>CEO</acronym> ha finalizado su masaje y
		reinicia el servidor. Como el servidor vuelve a estar disponible, anuncia su presencia,
		y tendrá lugar una elección para ver si el <acronym>PC</acronym> ubicado en la
		sección de piezas de recambio todavía continua siendo el buscador maestro local.
		</para>

		<para>
		Cuando se ejecuta una elección, cada ordenador difunde información sobre sí mismo
		haciendo uso de datagramas. Esta información incluye:
		</para>

		<itemizedlist mark='fillcircle'>
			<listitem>
				<para>La versión del protocolo de elección utilizado</para>
			</listitem>
			<listitem>
				<para>El sistema operativo del ordenador</para>
			</listitem>
			<listitem>
				<para>La cantidad de tiempo que el ordenador ha estado conectado a la
				red</para>
			</listitem>
			<listitem>
				<para>El <emphasis>hostname</emphasis> del cliente</para>
			</listitem>
		</itemizedlist>

		<para>
		Estos valores determinan que sistema operativo tiene la veteranía y pueda cumplir
		con el rol de buscador maestro local<footnote><para>El capítulo 7 de la entrada
		bibliográfica <xref linkend="bibliografia-ts-eckstein-collier-brown-01"/>
		describe en más detalle el proceso de elección.</para></footnote>.
		La estructura desarrollada para lograr esto
		no es elegante y tiene problemas de seguridad implícitos. Mientras que un dominio
		de búsqueda puede ser integrado con un dominio de seguridad, el algoritmo de elección
		no tiene en cuenta que ordenadores van a ser buscadores. Esto es posible para cualquier
		ordenador que ejecute un servicio de búsqueda y se haya registrado como participante
		en la elección del buscador, una vez ha ganado es capaz de cambiar la lista de
		búsqueda. No obstante, la navegación es una característica llave en el funcionamiento
		de la red de Windows, y las características de compatibilidad hacia atrás garantizarán
		que seguirá en uso durante los años venideros.
		</para>
	</sect2>

	<sect2 id="samba-autentificacion-windows-95-98-me">
		<title>Autentificación de Windows 95/98/Me</title>
		<para>
		Existen tres tipos de claves cuando un sistema Windows 95/98/Me está interactuando
		en un grupo de trabajo Windows:
		</para>

		<itemizedlist mark='fillcircle'>
			<listitem>
				<para>Una clave de Windows</para>
			</listitem>
			<listitem>
				<para>Una clave de red Windows</para>
			</listitem>
			<listitem>
				<para>Una clave para cada uno de los recursos compartidos a los que
				se le ha asignado protección con contraseña</para>
			</listitem>
		</itemizedlist>

		<para>
		Las claves de Windows funcionan de tal forma que son la fuente de confusión para
		los administradores de sistemas Unix. No hay manera de prevenir el uso de los
		ordenadores por parte de usuarios sin autorización. (Si no se lo cree, pulse
		sobre el botón <emphasis>Cancelar</emphasis> del cuadro de diálogo de
		autentificación y compruebe lo que ocurre). En lugar de eso, la clave de Windows
		se utiliza para poder acceder a los archivos y recursos compartidos disponibles
		en la red de Windows que están protegidos con clave. Existe un archivo por cada
		usuario registrado en el sistema, este se puede encontrar en el directorio
		<filename class="directory">C:\Windows</filename> y su nombre será el de
		la cuenta del usuario, seguido por la extensión <emphasis>.pwl</emphasis>.
		Por ejemplo, si la cuenta de usuario es <emphasis>sara</emphasis>, el archivo
		será <filename>C:\Windows\sara.pwl</filename>. Este archivo está cifrado
		con la clave de Windows como llave de cifrado.
		</para>

		<tip><para>Como medida de seguridad, debería comprobar la existencia de
		archivos <emphasis>.pwl</emphasis> en los clientes Windows 95/98/Me,
		ya que pueden haber sido creados debido a los intentos de acceso fallidos
		por parte de los usuarios. Un archivo <emphasis>.pwl</emphasis> se puede
		romper con facilidad y puede contener claves válidas de cuentas Samba
		o recursos compartidos.</para></tip>

		<para>
		La primera vez que se accede a la red, Windows intenta utilizar la clave de Windows
		como clave de red. Si hay éxito, no se le preguntará al usuario por una clave
		de acceso a la red, de esta forma, los siguientes ingresos en el sistema Windows
		ingresarán automáticamente a su vez en la red de Windows, haciendo las cosas
		más sencillas al usuario.
		</para>

		<para>
		Los recursos compartidos en un grupo de trabajo pueden tener asignados a su vez
		claves que limitan el acceso a los mismos. La primera vez que un usuario intenta acceder
		a este tipo de recursos, se le solicitará una clave, pudiendo seleccionar una
		opción en el cuadro de diálogo de autentificación para añadir la clave a su
		lista de claves. Esta opción está marcada por defecto; si se acepta, Windows
		almacenará la clave en el fichero <emphasis>.pwl</emphasis> del usuario,
		siendo manejadas automáticamente por Windows ulteriores autentificaciones para dicho
		recurso.
		</para>

		<para>
		La estrategia de Samba para la autentificación en los grupos de trabajo es un poco
		diferente, y ha sido el resultado de mezclar el modelo de grupos de trabajo de
		Windows con el modelo Unix, donde se ejecuta Samba<footnote><para>Para más detalles,
		vea el capítulo 9 de la entrada bibliográfica
		<xref linkend="bibliografia-ts-eckstein-collier-brown-01"/></para></footnote>.
		</para>
	</sect2>

	<sect2 id="samba-dominios-de-windows-nt">
		<title>Dominios de Windows NT</title>
		<para>
		El modelo de red punto-a-punto de los grupos de trabajo Windows funciona bastante bien
		siempre y cuando el número de ordenadores de la red sea pequeño y haya una comunidad
		de usuarios muy restringida. Sin embargo, en grandes redes la simplicidad de los grupos
		de trabajo llega a ser un factor limitador. Los grupos de trabajo ofrecen sólo el nivel
		más básico de seguridad, y debido a que cada recurso compartido puede tener su propia
		clave, es un inconveniente (por decir lo mínimo) para los usuarios tener que
		recordar la clave de cada recurso en una red de gran envergadura. Incluso si esto
		no fuese un problema, mucha gente encuentra frustrante tener que interrumpir
		su proceso de trabajo para teclear la clave del recurso compartido en el cuadro de
		diálogo cada vez que se accede a otro recurso de red.
		</para>

		<para>
		Para soportar las necesidades de las grandes redes, tales como las que se encuentran
		en los departamentos computacionales, Microsoft introdujo los dominios con la versión
		3.51 de Windows <acronym>NT</acronym>. Un dominio Windows <acronym>NT</acronym> es
		en esencia un grupo de trabajo de un ordenador <acronym>SMB</acronym> que tiene
		una característica añadida: el servidor que actúa como controlador de dominio
		(vea la <xref linkend="samba-un-simple-dominio-windows"/>).
		</para>

		<figure id="samba-un-simple-dominio-windows">
			<title>Un simple dominio Windows<footnote><para>Si quiere obtener
			el código fuente de esta imagen realizada con <xref linkend="dia"/> pulse
			<ulink url="./imagenes/samba-un-simple-dominio-windows.dia">aquí</ulink>.
			</para></footnote></title>
			  
			<mediaobject>
				<imageobject>
					<imagedata fileref="./imagenes/samba-un-simple-dominio-windows.png" format="PNG"/>
				</imageobject>
			</mediaobject>
		</figure>

		<sect3 id="samba-controladores-de-dominio">
			<title>Controladores de dominio</title>
			<para>
			Un controlador de dominio en un dominio Windows <acronym>NT</acronym> funciona
			de manera muy similar a un servidor <acronym>NIS</acronym> en una red Unix,
			manteniendo una base de datos del dominio que contiene la información
			de los usuarios y grupos, así como sus servicios asociados. Las responsabilidades
			de un controlador de dominio están principalmente centradas en la seguridad,
			incluyendo la autentificación o la tarea de permitir o denegar el acceso
			a los recursos del dominio a un determinado usuario. Esto se realiza
			normalmente gracias al uso de un nombre de usuario y una clave. El servicio
			que mantiene la base de datos en los controladores de dominio se denomina
			<emphasis>Security Account Manager</emphasis> (<acronym>SAM</acronym>).
			</para>

			<para>
			El modelo de seguridad de Windows <acronym>NT</acronym> gira en torno a los
			identificadores de seguridad (<acronym>SID</acronym>s) y las listas de
			control de acceso (<acronym>ACL</acronym>s). Los identificadores de seguridad
			son utilizados para representar objetos en un dominio, que incluyen (pero
			no limitan) a los usuarios, los grupos, los ordenadores y los procesos.
			Los <acronym>SID</acronym>s se escriben normalmente en un formulario
			<acronym>ASCII</acronym> como campos separados por guiones, tal y como
			se muestra en el <xref linkend="samba-ejemplo-sid"/>:
			</para>

<example id="samba-ejemplo-sid">
	<title>Muestra de un <acronym>SID</acronym> (<emphasis>Security IDentifier</emphasis>)</title>

	<screen>S-1-5-21-1638239387-7675610646-9254035128-545</screen>
</example>

			<para>
			Un <acronym>SID</acronym> comienza con el carácter <quote>S</quote>, seguido
			de un guión. El número inmediatamente posterior al primer guión se denomina
			<emphasis>identificador relativo</emphasis> (<acronym>RID</acronym>)
			y es un número único dentro del dominio que identifica a un usuario,
			un grupo, un ordenador o cualquier otro objeto. El número <acronym>RID</acronym>
			es análogo al <emphasis>user <acronym>ID</acronym></emphasis>
			(<acronym>UID</acronym>) o al <emphasis>group <acronym>ID</acronym></emphasis>
			(<acronym>GID</acronym>) en un sistema Unix o dentro de un dominio
			<acronym>NIS</acronym>.
			</para>

			<para>
			Las <acronym>ACL</acronym>s proveen la misma funcionalidad que los permisos
			de los archivos <quote>rwx</quote> comunes en los sistemas Unix. Sin embargo,
			las <acronym>ACL</acronym>s son más versátiles. Los permisos de los archivos
			Unix sólo pueden establecer permisos para el propietario y el grupo al que
			el fichero pertenece, y <quote>otros</quote>, significa que cualquier
			otro usuario. Las <acronym>ACL</acronym>s de Windows
			<acronym>NT</acronym>/2000/<acronym>XP</acronym> permiten establecer
			permisos individuales para cualquier número arbitrario de usuarios y/o
			grupos. Las <acronym>ACL</acronym>s están constituidas por una o más
			entradas de control de acceso (<acronym>ACE</acronym> - Access Control Entries),
			cada una de las cuales contienen un <acronym>SID</acronym> y derechos
			de acceso asociados a este.
			</para>

			<para>
			El soporte de <acronym>ACL</acronym>s ha sido incluido como una característica
			estándar en algunas variantes de Unix y están disponibles como añadidos para
			otras. Samba soporta el mapeo de las <acronym>ACL</acronym>s entre Windows
			y Unix<footnote><para>Para más información, consulte el capítulo 8 de la
			entrada bibliográfica
			<xref linkend="bibliografia-ts-eckstein-collier-brown-01"/></para></footnote>.
			</para>
		</sect3>

		<sect3 id="samba-controladores-de-dominio-primarios-y-secundarios">
			<title>Controladores de dominio primarios y secundarios</title>
			<para>
			Ya se ha hablado sobre buscadores maestros y de respaldo. Los controladores de
			dominio se parecen a estos en que un dominio tiene un controlador primario
			(<acronym>PDC</acronym>) y puede tener uno o más controladores secundarios
			de dominio (<acronym>BDC</acronym>s). Si un <acronym>PDC</acronym> falla
			o no está accesible, sus tareas son automáticamente traspasadas a uno
			de los <acronym>BDC</acronym>s. Los <acronym>BDC</acronym>s sincronizan
			frecuentemente sus datos <acronym>SAM</acronym> con el <acronym>PDC</acronym>,
			por lo que si surge la necesidad cualquiera de ellos puede desempeñar
			inmediatamente los servicios del controlador primario, sin ningún tipo
			de impacto para los clientes. Sin embargo, tenga en cuenta que los
			<acronym>BDC</acronym>s tienen copias de solo lectura de la base de datos
			<acronym>SAM</acronym>; estos sólo pueden actualizar sus datos mediante
			la sincronización con un <acronym>PDC</acronym>. Un servidor en un dominio
			Windows puede hacer uso de la <acronym>SAM</acronym> de cualquier
			<acronym>PDC</acronym> o <acronym>BDC</acronym> para autentificar a un
			usuario que intente acceder a sus recursos e ingresar en el dominio.
			</para>

			<para>
			Todas las versiones recientes de Windows pueden ingresar en un dominio
			como clientes para tener acceso a los recursos de los servidores de dominio.
			Los sistemas que son considerados miembros del dominio son una clase más
			exclusiva, compuesta de un <acronym>PDC</acronym> y uno o varios
			<acronym>BDC</acronym>s, así como los servidores miembros del dominio,
			que no son más que sistemas que se han unido como miembros al domino,
			y son conocidos por los controladores de dominio debido a la cuenta
			existente para ellos en la base de datos <acronym>SAM</acronym>.
			</para>
		</sect3>

		<sect3 id="samba-autentificacion">
			<title>Autentificación</title>
			<para>
			Cuando un usuario teclea su usuario y clave para ingresar en un dominio Windows,
			se invoca un <emphasis>desafío</emphasis> de seguridad y un protocolo
			de respuesta entre el ordenador cliente y el controlador de dominio para
			verificar que el usuario y la clave son válidos. Seguidamente el controlador
			de dominio envía el <acronym>SID</acronym> de nuevo al cliente, quien lo
			utilizará para crear un <acronym>SAT</acronym>
			(<emphasis>Security Access Token</emphasis>) que es válido únicamente para este
			sistema, que será utilizado para autentificaciones ulteriores. Esta
			señal de acceso contiene la información sobre el usuario codificada en su interior,
			la cual incluye el nombre de usuario, el grupo y los permisos que el usuario
			posee en el dominio. En este momento, el usuario está autentificado en el
			dominio.
			</para>

			<para>
			Posteriormente, cuando el cliente intenta acceder a un recurso compartido dentro
			del dominio, el sistema cliente entra en un <emphasis>desafío</emphasis>
			de seguridad y un intercambio de respuestas con el servidor del recurso.
			Seguidamente el servidor entra en otro <emphasis>desafío</emphasis> de seguridad
			y conversación de respuesta con el controlador de dominio, para comprobar
			que el cliente es válido. (Lo que ocurre realmente es que el servidor utiliza
			la información que ha obtenido del cliente para hacerse pasar por este y
			autentificarse el mismo ante el controlador de dominio. Si el controlador
			de dominio valida sus credenciales, envía un <acronym>SID</acronym>
			al servidor, que utilizará para crear su propio <acronym>SAT</acronym>
			para el cliente, de esta forma habilita el acceso a sus recursos locales
			en beneficio del cliente.) En este punto, el cliente se encuentra autentificado
			para los recursos del servidor y se le permite acceder a ellos. El servidor
			utiliza el <acronym>SID</acronym> almacenado en el <acronym>SAT</acronym> para
			determinar que permisos de modificación y uso posee el cliente para el recurso
			en cuestión, esto lo consigue comparándolo con las entradas de las
			<acronym>ACL</acronym>s	del recurso.
			</para>

			<para>
			Aunque este método de autentificación pueda parecer demasiado complicado, permite
			a los clientes la autentificación sin enviar las claves en texto plano a través
			de la red, y es mucho más difícil de romper que la endeble seguridad que
			proporcionan los grupos de trabajo descritos anteriormente.
			</para>
		</sect3>

		<sect3 id="samba-servicio-de-nombres-con-wins-y-dns">
			<title>Servicio de nombres con <acronym>WINS</acronym>
			y <acronym>DNS</acronym></title>
			<para>
			El servicio de nombres de Internet de Windows (<acronym>WINS</acronym>) es una
			implementación de Microsoft del servidor de nombres <acronym>NetBIOS</acronym>
			(<acronym>NBNS</acronym>). Como tal, <acronym>WINS</acronym> hereda muchas de
			las características de <acronym>NetBIOS</acronym>. En primer lugar,
			<acronym>WINS</acronym> sólo puede tener nombres nombres simples o llanos
			para las máquinas, tales como <emphasis>inca</emphasis>, <emphasis>mixtec</emphasis>
			o <acronym>navaho</acronym>, y grupos de trabajo como PERU, MEXICO o USA.
			Otra característica es que <acronym>WINS</acronym> es dinámico: cuando un
			un cliente se conecta inicialmente a la red, este solicita un nombre,
			una dirección y un grupo de trabajo al servidor <acronym>WINS</acronym> local.
			Este servidor <acronym>WINS</acronym> almacenará la información mientras
			el cliente refresque periódicamente su registro <acronym>WINS</acronym>, lo que
			indicará que todavía está conectado a la red. Advierta que los servidores
			<acronym>WINS</acronym> no son específicos de un grupo de trabajo o un
			dominio; pueden contener información sobre múltiples dominios y/o grupos
			de trabajo, y pueden estar presentes en más de una subred. 
			</para>

			<para>
			Se pueden configurar múltiples servidores <acronym>WINS</acronym> para que
			se sincronicen unos con otros. Esto permite que las entradas de los ordenadores
			que aparecen y desaparecen de la red se propagarse de un servidor
			<acronym>WINS</acronym> a otro. Aunque que en teoría esto parece eficiente,
			podría volverse rápidamente problemático si hay varios servidores
			<acronym>WINS</acronym> en la red. Debido a que los servicios
			<acronym>WINS</acronym> pueden atravesar múltiples subredes (puede
			especificar la dirección del servidor <acronym>WINS</acronym> en cada
			uno de los clientes u obtenerla vía <acronym>DHCP</acronym>), normalmente
			es más eficiente tener a cada cliente Windows, no importa cuántos dominios
			Windows haya, apuntando a un mismo servidor <acronym>WINS</acronym>. De esa
			forma, sólo habrá un servidor <acronym>WINS</acronym> dominante con la
			información correcta, en lugar de tener varios servidores <acronym>WINS</acronym>
			esforzándose por mantenerse sincronizados con los cambios más recientes. 
			</para>

			<para>
			El servidor <acronym>WINS</acronym> activo en un determinado momento es conocido
			como el servidor <acronym>WINS</acronym> primario. También puede instalar un
			servidor <acronym>WINS</acronym> secundario, el cual entrará en acción en
			el caso de que el primario falle o se vuelva inaccesible. Tanto el servidor
			primario como cualquier otro servidor <acronym>WINS</acronym> sincronizarán
			sus bases de datos de direcciones periódicamente.
			</para>

			<para>
			En la familia de sistemas operativos Windows, sólo la edición de servidor Windows
			<acronym>NT</acronym>/2000 puede actuar como servidor <acronym>WINS</acronym>.
			Samba 2.2 puede funcionar como servidor <acronym>WINS</acronym> primario,
			pero no puede actualizar su base de datos con otros servidores
			<acronym>WINS</acronym>. Por este motivo, no puede actuar como servidor secundario
			<acronym>WINS</acronym> o como un servidor primario <acronym>WINS</acronym>
			de un servidor secundario <acronym>WINS</acronym> Windows.
			</para>

			<para>
			<acronym>WINS</acronym> maneja el servicio de nombres por defecto, aunque
			Microsoft añadió el <acronym>DNS</acronym> con Windows <acronym>NT</acronym>
			Server 4. Este es compatible con los <acronym>DNS</acronym>s que son
			estándar en virtualmente todos los sistemas Unix, y un servidor Unix
			(como el host Samba) puede ser utilizado para actuar de <acronym>DNS</acronym>.
			</para>
		</sect3>

		<sect3 id="samba-relaciones-de-confianza">
			<title>Relaciones de confianza</title>
			<para>
			Un aspecto adicional de los dominios Windows <acronym>NT</acronym>, que todavía
			no está soportado en Samba 2.2, es la posibilidad de configurar una relación
			de confianza entre dominios, permitiendo a los clientes de un dominio acceder
			a los recursos de otro sin necesidad de cualquier tipo de autentificación. El
			protocolo que está detrás de esto se denomina <emphasis>pass-through
			authentication</emphasis>, mediante el cual las credenciales de un usuario
			son pasadas de un cliente, en el primer dominio, a un servidor en el segundo
			dominio, quien consultará al controlador de dominio del primer dominio (de
			confianza) para comprobar que el usuario es válido antes de permitir
			el acceso a los recursos.
			</para>

			<para>
			Ha de notar que en muchos aspectos, el comportamiento de un Windows para grupos
			de trabajo y un Windows <acronym>NT</acronym> concuerdan. Por ejemplo,
			el buscador maestro y de respaldo en un dominio son siempre el
			<acronym>PDC</acronym> y <acronym>BDC</acronym>, respectivamente. A continuación
			se actualizará el diagrama de dominios Windows para incluir tanto al buscador
			maestro local como el de respaldo. El resultado se muestra en la
			<xref linkend="samba-dominio-windows-con-un-buscador-maestro-local-y-de-respaldo"/>.
			</para>

			<figure id="samba-dominio-windows-con-un-buscador-maestro-local-y-de-respaldo">
				<title>Un dominio Windows con un buscador maestro local y uno de
				respaldo<footnote><para>Si quiere obtener el código fuente de esta
				imagen realizada con <xref linkend="dia"/> pulse
				<ulink url="./imagenes/samba-dominio-windows-con-un-buscador-maestro-local-y-de-respaldo.dia">aquí</ulink>.</para></footnote></title>
			
				<mediaobject>
					<imageobject>
						<imagedata fileref="./imagenes/samba-dominio-windows-con-un-buscador-maestro-local-y-de-respaldo.png" format="PNG"/>
					</imageobject>
				</mediaobject>
			</figure>

			<para>
			El parecido entre los grupos de trabajo y los dominios <acronym>NT</acronym> no
			es accidental, ya que el concepto de dominio Windows no se desarrolló
			hasta la versión 3.5 de Windows NT, y los dominios Windows se vieron forzados
			a mantener la compatibilidad hacia atrás con los grupos de trabajo presentes
			en Windows para grupos de trabajo.
			</para>

			<para>
			Samba puede actuar como un controlador primario de dominio para clientes
			Windows 95/98/Me y Windows <acronym>NT</acronym>/2000/<acronym>XP</acronym>,
			con la única limitación de que sólo puede actuar de <acronym>PDC</acronym>,
			no de <acronym>BDC</acronym>.
			</para>

			<para>
			Samba también puede funcionar como un servidor miembro de dominio, esto significa
			que tendrá una cuenta de equipo en la base de datos del <acronym>PDC</acronym>
			y por tanto será reconocido como parte del dominio. Un servidor miembro del
			dominio no puede autentificar a los usuarios que ingresan en el dominio,
			pero puede manejar funciones de seguridad (como los permisos de los archivos)
			para los usuarios del dominio que acceden a sus recursos.
			</para>

		</sect3>

		<sect3 id="samba-dominios-de-active-directory">
			<title>Dominios de <emphasis>Active Directory</emphasis></title>
			<para>
			Dando comienzo con Windows 2000, Microsoft introdujo el <emphasis>Active
			Directory</emphasis> (Directorio Activo), el siguiente camino más allá
			de los dominios de Windows <acronym>NT</acronym>. No se va a entrar
			en mucho detalle con <emphasis>Active Directory</emphasis>, ya que es
			un tema extremadamente amplio. Samba 2.2 no soporta ninguna característica de
			<emphasis>Active Directory</emphasis>, y el soporte de la versión 3.0
			de Samba se limita a actuar como un cliente. Desde ahora, sea consciente
			de que con <emphasis>Active Directory</emphasis>, el modelo de autentificación
			está centrado al rededor de <acronym>LDAP</acronym>, y el servicio de
			nombres lo suministra un <acronym>DNS</acronym> en lugar de un
			servidor <acronym>WINS</acronym>. Los dominios en <emphasis>Active
			Directory</emphasis> se pueden organizar en una estructura jerárquica en
			árbol, en la cual, cada controlador de dominio es fijo, no hay distinción
			entre controlador primario y secundario, como en los dominios Windows
			<acronym>NT</acronym>.
			</para>

			<para>
			Los sistemas Windows 2000/<acronym>XP</acronym> pueden configurar un simple
			grupo de trabajo o un dominio de clientes Windows <acronym>NT</acronym>
			(que funcionaría con Samba). La edición <emphasis>Server</emphasis> de
			Windows 2000 puede configurarse para que ejecute
			<emphasis>Active Directory</emphasis> y dominios Windows
			<acronym>NT</acronym> para mantener la compatibilidad hacia atrás (modo
			mixto). En este caso, Samba 2.2 trabaja con los servidores Windows 2000
			de la misma forma que lo hacía con los servidores Windows <acronym>NT</acronym>
			4.0. Cuando se configura para que opere en modo nativo, los servidores
			Windows 2000 sólo soportan <emphasis>Active Directory</emphasis>.
			Incluso así, Samba 2.2 puede operar como un servidor en un dominio
			albergado por un servidor Windows 2000 en modo nativo, haciendo uso
			del modo emulación <acronym>PDC</acronym> de un servidor Windows 2000. Sin
			embargo, no es posible para Samba 2.2 o 3.0 operar como un controlador de
			dominio en un un dominio <emphasis>Active Directory</emphasis> de Windows
			2000.
			</para>
		</sect3>

		<sect3 id="samba-puede-un-grupo-de-trabajo-abarcar-multiples-subredes">
			<title>¿Puede un grupo de trabajo abarcar múltiples subredes?</title>
			<para>
			Sí, pero la mayoría de la gente que ha hecho esto ha tenido muchos
			quebraderos de cabeza. Abarcar múltiples subredes no era parte del diseño inicial
			de Windows <acronym>NT</acronym> 3.5 o de Windows para grupos de trabajo.
			Como resultado, un dominio Windows que abarca dos o más subredes es,
			en realidad, un "encolado" de dos o más grupos de trabajo que comparten
			un nombre idéntico. La buena noticia es que todavía se puede hacer uso de un
			controlador primario de dominio para el control de autentificación a lo largo
			de cada subred. La mala noticia es que las cosas no son tan sencillas en
			la navegación. 
			</para>

			<para>
			Como se mencionó anteriormente, cada subred ha de tener su propio buscador
			maestro local. Cuando un dominio Windows abarca múltiples subredes,
			un administrador del sistema tendrá que asignar una de las máquinas como
			buscador maestro de dominio. El buscador maestro de dominio mantendrá una
			lista de búsqueda para todo el dominio Windows. Esta lista de búsqueda
			es creada por la sincronización periódica de la lista de búsqueda de
			cada buscador maestro local con la lista de búsqueda del buscador maestro
			de dominio. Después de la sincronización, el buscador maestro local y
			el buscador maestro de dominio deberían contener entradas idénticas. Observe
			la <xref linkend="samba-grupo-de-trabajo-que-abarca-mas-de-una-subred"/>
			para ver un ejemplo.
			</para>

			<figure id="samba-grupo-de-trabajo-que-abarca-mas-de-una-subred">
				<title>Grupo de trabajo que abarca más de una subred<footnote><para>Si
				quiere obtener el código fuente de esta imagen realizada con
				<xref linkend="dia"/> pulse
				<ulink url="./imagenes/samba-grupo-de-trabajo-que-abarca-mas-de-una-subred.dia">aquí</ulink>.</para></footnote></title>
			
				<mediaobject>
					<imageobject>
						<imagedata fileref="./imagenes/samba-grupo-de-trabajo-que-abarca-mas-de-una-subred.png" format="PNG"/>
					</imageobject>
				</mediaobject>
			</figure>

			<para>
			¿Suena bien? pues no se acerca al "cielo" por las siguientes razones: 
			</para>

			<itemizedlist mark='fillcircle'>
				<listitem>
					<para>Si existe, un <acronym>PDC</acronym> siempre juega el
					papel de buscador maestro de dominio. Debido al diseño de
					Microsoft, los dos siempre comparten el tipo de recurso
					<acronym>NetBIOS</acronym> &lt;1B&gt; y (desafortunadamente)
					no se pueden separar.</para>
				</listitem>
				<listitem>
					<para>En los equipos Windows 95/98/Me no pueden llegar a ser
					ni siquiera contactar con un buscador maestro de dominio. Esto
					significa que necesariamente se ha de tener, al menos, un sistema
					Windows <acronym>NT</acronym>/2000/<acronym>XP</acronym>
					(o un servidor Samba) en cada subred del grupo de
					trabajo multi-red</para>
				</listitem>
			</itemizedlist>

			<para>
			Cada buscador maestro local de cada subred continua manteniendo la lista de
			búsqueda para su subred, para la cual se vuelve dominante. De esta forma,
			si un ordenador desease ver la lista de los servidores de su propia subred,
			el buscador maestro local de esa subred sería interrogado. Si un ordenador
			quisiese ver una lista de servidores fuera de su subred, sólo podrá llegar
			hasta donde le lleve el buscador maestro local. Esto funciona debido a los
			intervalos fijados, la lista de búsqueda dominante del buscador maestro local
			de una subred se sincroniza con el buscador maestro de dominio, quien está
			sincronizado con el buscador maestro local de las otras subredes pertenecientes
			al dominio. Esto se denomina propagación de la lista de búsqueda. 
			</para>

			<para>
			Samba puede actuar como buscador maestro de dominio en un dominio Windows
			<acronym>NT</acronym>, o puede actuar como un buscador maestro local para
			una subred, sincronizando su lista de búsqueda con el buscador maestro
			de dominio.
			</para>

		</sect3>
	</sect2>
</sect1>

<sect1 id="samba-novedades-de-samba-2.2">
	<title>Novedades de Samba 2.2</title>
	<para>
	En la versión 2.2, Samba posee un soporte más avanzado para el sistema de red Windows, incluyendo
	la posibilidad de desempeñar las tareas más importantes necesarias para interactuar en un
	dominio Windows <acronym>NT</acronym>. A parte de esto, Samba 2.2 tiene algún soporte para las
	tecnologías que Microsoft introdujo en Windows 2000, aunque el grupo de desarrollo de Samba
	ha dejado el soporte de <emphasis>Active Directory</emphasis> para la versión 3.0.
	</para>

	<sect2 id="samba-soporte-pdc-para-clientes-w2k-xp">
		<title>Soporte <acronym>PDC</acronym> para clientes Windows 2000/<acronym>XP</acronym></title>
		<para>
		Anteriormente, Samba podía actuar como un <acronym>PDC</acronym> para autentificar
		sistemas Windows 95/98/Me y Windows <acronym>NT</acronym> 4. Esta funcionalidad ha sido
		extendida en la versión 2.2 para incluir a los sistemas Windows 2000 y Windows
		<acronym>XP</acronym>. De esta manera es posible disponer de un servidor Samba
		con soporte de autentificación en el dominio para los clientes Windows de la red,
		incluyendo las versiones más recientes. El resultado es una red más estable,
		de alto rendimiento y mucho más segura, con el beneficio de no tener que comprar
		Windows <acronym>CAL</acronym>s a Microsoft.
		</para>
	</sect2>

	<sect2 id="samba-soporte-dfs">
		<title>Soporte <acronym>Dfs</acronym> de Microsoft</title>
		<para>
		Microsoft <acronym>Dfs</acronym> permite que los recursos compartidos por
		un número determinado de servidores dispersos a lo largo de la red se junten
		y aparezcan, a los ojos de los usuarios, como si todos ellos existiesen
		en un sólo árbol de directorios de un servidor. Este método de organización
		hace la vida más fácil a los usuarios. En lugar de tener que buscar por la red,
		como si se tratase de un tesoro oculto, para encontrar un determinado
		recurso, los usuarios pueden ir directamente al servidor <acronym>Dfs</acronym>
		y coger lo que necesiten. Samba 2.2 ofrece soporte para servir <acronym>Dfs</acronym>,
		por lo que no se necesita un servidor Windows para este propósito.
		</para>
	</sect2>

	<sect2 id="samba-soporte-de-impresion-en-windows-nt-2000-xp">
		<title>Soporte de impresión en Windows
		<acronym>NT</acronym>/2000/<acronym>XP</acronym></title>
		<para>
		Windows <acronym>NT</acronym>/2000/<acronym>XP</acronym> poseen una interface de
		impresión basada en <acronym>RPC</acronym> diferente a la interfaz que poseen
		los sistemas Windows 95/98/Me. En la versión 2.2 de Samba, la interfaz de
		Windows <acronym>NT</acronym>/2000/<acronym>XP</acronym> está soportada. Junto con
		esto, el equipo de desarrollo de Samba ha añadido soporte para bajarse automáticamente
		el controlador de impresión desde un servidor Samba mientras se añade una nueva
		impresora desde un cliente Windows.
		</para>
	</sect2>

	<sect2 id="samba-acls">
		<title><acronym>ACL</acronym>s</title>
		<para>
		Samba ahora soporta <acronym>ACL</acronym>s en aquellos sistemas Unix que las
		tienen incorporadas. Esta lista incluye Solaris 2.6, 7 y 8, Irix, AIX,
		<acronym>GNU</acronym>/Linux (con cualquiera de los parches
		de soporte de <acronym>ACL</acronym>s
		para los sistemas de archivos ext2/ext3, disponible en
		<ulink url="http://acl.bestbits.at/">http://acl.bestbits.at</ulink> o cuando
		se hace uso del sistema de archivos <acronym>XFS</acronym> y FreeBSD (versión
		5.0 y posterior). Cuando se hace uso del soporte de <acronym>ACL</acronym>s,
		Samba traduce entre las <acronym>ACL</acronym>s de Unix y las de Windows
		<acronym>NT</acronym>/2000/<acronym>XP</acronym>, haciendo al equipo que ejecuta
		samba parecer y actuar más parecido a un servidor Windows
		<acronym>NT</acronym>/2000/<acronym>XP</acronym> desde el punto de vista de los
		clientes Windows.
		</para>
	</sect2>

	<sect2 id="samba-soporte-herramientas-de-administracion-de-clientes">
		<title>Soporte de las herramientas de administración de clientes Windows</title>
		<para>
		Windows vienen con una herramienta que puede ser utilizada desde un cliente para
		administrar los recursos compartidos en un servidor Windows remotamente. Samba
		2.2 permite a esas herramientas manejar los recursos compartidos en un servidor
		Samba también.
		</para>
	</sect2>

	<sect2 id="samba-integracion-con-winbind">
		<title>Integración con Winbind</title>
		<para>
		Windbind es una ayuda que permite a los usuarios cuya información de autentificación
		está almacenada en una base de datos de dominio Windows, poder autentificarse
		en un sistema Unix. El resultado es un entorno unificado de autentificación, en el
		cual una cuenta de usuario se puede conservar entre un sistema Unix o un controlador de
		dominio Windows <acronym>NT</acronym>/2000/<acronym>XP</acronym>. Esto facilita
		enormemente la administración de cuentas, debido a que los administradores ya no
		necesitarán mantener los dos sistemas sincronizados, permitiendo a los usuarios
		cuyas cuentas estén asociadas a un dominio Windows, autentificarse cuando accedan
		a un recurso compartido por Samba.
		</para>
	</sect2>

	<sect2 id="samba-extensiones-cifs-en-unix">
		<title>Extensiones <acronym>CIFS</acronym> en Unix</title>
		<para>
		Las extensiones <acronym>CIFS</acronym> de Unix fue desarrollado por Hewlett-Packard
		e introducido en la versión 2.2.4 de Samba. Estas permiten a los servidores Samba
		soportar los atributos de los sistemas de archivos Unix, como los enlaces y los permisos,
		cuando se comparten archivos con otros sistemas Unix. Esta característica permite utilizar
		Samba como una alternativa a <acronym>NFS</acronym> para la compartición de archivos
		entre sistemas Unix. La ventaja de utilizar Samba es que autentifica a usuarios
		individualmente, mientras que <acronym>NFS</acronym> autentifica solamente clientes
		(basándose en su dirección <acronym>IP</acronym>, que es un modelo muy pobre en
		cuanto a la seguridad). Esto da un empujón en el área de seguridad a Samba, a parte
		de su gran capacidad de configuración. Consulte el capítulo 5 de la entrada
		bibliográfica <xref linkend="bibliografia-ts-eckstein-collier-brown-01"/>
		para ver como operar con los sistemas Unix como clientes Samba.
		</para>
	</sect2>

	<sect2 id="samba-y-mas">
		<title>Y más...</title>
		<para>
		Como ya viene siendo habitual, el código posee muchas mejoras que no se ven a un
		nivel administrativo de forma inmediata u obvia. Actualmente Samba funciona
		mejor en los sistemas que utilizan <acronym>PAM</acronym>, y existe un
		nuevo soporte para perfiles. El soporte de Samba para los <emphasis>oplocks</emphasis>
		ha sido reforzado, ofreciendo mejor integración con los servidores
		<acronym>NFS</acronym> (actualmente sólo en Irix y <acronym>GNU</acronym>/Linux)
		y en el sistema
		de archivos local, con los bloqueos <acronym>SMB</acronym> mapeados a bloqueos
		<acronym>POSIX</acronym> (que es dependiente la implementación de los bloqueos
		<acronym>POSIX</acronym> de cada variante Unix). Y por supuesto, también han tenido
		lugar las correcciones normales de <emphasis>bugs</emphasis>.
		</para>
	</sect2>

</sect1>

<sect1 id="samba-novedades-de-samba-3.0">
	<title>Novedades de Samba 3.0</title>
	<para>
	La principal característica que distingue a la versión 3.0 de Samba es que incluye soporte para
	la autentificación mediante Kerberos 5 y <acronym>LDAP</acronym>, que es imprescindible
	para actuar como un cliente en un dominio <emphasis>Active Directory</emphasis>. Otra nueva
	característica es el soporte de Unicode, lo que simplificará mucho el soporte de
	lenguajes internacionales.
	</para>
</sect1>

<sect1 id="samba-que-puede-hacer-samba">
	<title>¿Qué puede hacer Samba?</title>
	<para>
	A continuación se verá donde puede ayudar Samba y cuales son sus limitaciones. La
	<xref linkend="samba-roles-de-samba"/> resume los roles que Samba puede o no puede jugar
	en un dominio Windows <acronym>NT</acronym> o <emphasis>Active Directory</emphasis> o
	en un grupo de trabajo. Muchos de los protocolos del dominio de Windows son propietarios
	y no han sido documentados por Microsoft, por este motivo el equipo de desarrollo de
	Samba ha tenido que utilizar la ingeniería inversa para poder soportarlos. En la versión
	3.0, Samba no puede actuar como servidor secundario en muchos de los roles y todavía no
	soporta completamente <emphasis>Active Directory</emphasis>.
	</para>

	<table frame="all" id="samba-roles-de-samba">
		<title>Roles de Samba en la versión 3.0</title>

		<tgroup cols='2' align='left' colsep='1' rowsep='1'>
			<thead>
				<row>
				  <entry align="center">Rol</entry>
				  <entry align="center">¿Puede desempeñarlo?</entry>
				</row>
			</thead>

			<tbody>
				<row>
					<entry>Servidor de archivos</entry>
					<entry>Sí</entry>
				</row>
				<row>
					<entry>Servidor de impresión</entry>
					<entry>Sí</entry>
				</row>
				<row>
					<entry>Servidor Dfs de Microsoft</entry>
					<entry>Sí</entry>
				</row>
				<row>
					<entry>Controlador de dominio primario</entry>
					<entry>Sí</entry>
				</row>
				<row>
					<entry>Controlador de dominio secundario</entry>
					<entry>No</entry>
				</row>
				<row>
					<entry>Controlador de dominio <emphasis>Active
					Directory</emphasis></entry>
					<entry>No</entry>
				</row>
				<row>
					<entry>Autentificación de clientes Windows 95/98/Me</entry>
					<entry>Sí</entry>
				</row>
				<row>
					<entry>Autentificación de clientes Windows
					<acronym>NT</acronym>/2000/<acronym>XP</acronym></entry>
					<entry>Sí</entry>
				</row>
				<row>
					<entry>Buscador maestro local</entry>
					<entry>Sí</entry>
				</row>
				<row>
					<entry>Buscador de respaldo local</entry>
					<entry>Sí</entry>
				</row>
				<row>
					<entry>Buscador maestro de dominio</entry>
					<entry>Sí</entry>
				</row>
				<row>
					<entry>Servidor primario <acronym>WINS</acronym></entry>
					<entry>Sí</entry>
				</row>
				<row>
					<entry>Servidor secundario <acronym>WINS</acronym></entry>
					<entry>No</entry>
				</row>
			</tbody>
		</tgroup>
	</table>

</sect1>

<sect1 id="samba-vision-general-de-samba">
	<title>Visión general de la distribución Samba</title>
	<para>
	Como se mencionó anteriormente, actualmente Samba contiene muchos programas que prestan distintos
	servicios pero que tienen propósitos relacionados. A continuación se hará una breve
	introducción a cada uno de ellos y se describirá como trabajan en conjunción.</para>

	<para>
	La mayoría de los programas que vienen con Samba se centran en sus dos demonios. Las siguientes
	líneas mostrarán las responsabilidades de cada demonio:
	</para>

	<variablelist>
		<varlistentry>
			<term><command>nmbd</command></term>
			<listitem><para>El demonio <command>nmbd</command> es un simple servidor
			de nombres que suministra la funcionalidad de <acronym>WINS</acronym>.
			Este demonio espera peticiones del servidor de nombres y proporciona la
			dirección <acronym>IP</acronym> apropiada cuando se le requiere. También
			provee una lista de búsqueda para el entorno de red y participa
			en la elección de búsqueda.</para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>smbd</command></term>
			<listitem><para>El demonio <command>smbd</command> maneja los recursos
			compartidos entre el servidor Samba y sus clientes. Provee los servicios
			de servidor de archivos, impresión y búsqueda a los clientes
			<acronym>SMB</acronym> a través de una o más redes y maneja todas
			las notificaciones entre el servidor Samba y la red de clientes. A parte
			de esto, es el responsable de la autentificación de usuarios, bloqueo
			de recursos y compartición de datos a través del protocolo
			<acronym>SMB</acronym>.</para></listitem>
		</varlistentry>
	</variablelist>

	<para>
	Añadido en la versión 2.2, hay otro nuevo demonio:
	</para>

	<variablelist>
		<varlistentry>
			<term><command>winbind</command></term>
			<listitem><para>Este demonio se utiliza junto con el servicio de nombres
			para obtener la información de los usuarios y grupos desde un servidor
			Windows <acronym>NT</acronym> y permitir a Samba autorizar a los usuarios
			dentro de un servidor Windows <acronym>NT</acronym>/2000.</para></listitem>
		</varlistentry>
	</variablelist>

	<para>
	La distribución de samba también viene con un conjunto de pequeñas herramientas para consola:
	</para>

	<variablelist>
		<varlistentry>
			<term><command>findsmb</command></term>
			<listitem><para>Un programa que realiza búsquedas de ordenadores en la red local
			que respondan al protocolo <acronym>SMB</acronym> e imprime información
			sobre los mismos.</para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>make_smbcodepage</command></term>
			<listitem><para>Un programa utilizado cuando se trabaja con la característica
			de internacionalización de Samba para informarle sobre como convertir
			entre mayúsculas y minúsculas en los distintos conjuntos de
			caracteres.</para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>make_unicodemap</command></term>
			<listitem><para>Otro programa de internacionalización utilizado con
			Samba para compilar un mapa Unicode que utilizará Samba
			para traducir los códigos de páginas de <acronym>DOS</acronym>
			o los conjuntos de caracteres de Unix en formato Unicode de 16
			bits.</para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>net</command></term>
			<listitem><para>Un nuevo programa distribuido con Samba 3.0 que puede
			ser utilizado para realizar una administración remota de los
			servidores.</para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>nmblookup</command></term>
			<listitem><para>Un programa que realiza búsquedas de nombres
			sobre <acronym>NBT</acronym> para encontrar direcciones
			<acronym>IP</acronym> de ordenadores cuando se da su nombre
			de máquina.</para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>pdbedit</command></term>
			<listitem><para>Nuevo programa distribuido con la versión
			3.0 de Samba que ayuda en el manejo de las cuentas de usuario
			almacenadas en las bases de datos <acronym>SAM</acronym>.</para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>rpcclient</command></term>
			<listitem><para>Un programa que se puede utilizar para ejecutar las
			funciones <acronym>MS-RPC</acronym> en los clientes Windows.</para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>smbcacls</command></term>
			<listitem><para>Un programa que se utiliza para establecer o mostrar
			<acronym>ACL</acronym>s en un sistema de archivos Windows
			<acronym>NT</acronym></para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>smbclient</command></term>
			<listitem><para>Un cliente Unix similar a un cliente ftp, que se puede utilizar
			para conectarse a los recursos compartidos <acronym>SMB</acronym> y operar
			con ellos. El capítulo 5 de la entrada bibliográfica
			<xref linkend="bibliografia-ts-eckstein-collier-brown-01"/>
			discute esta orden con más detalle.</para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>smbcontrol</command></term>
			<listitem><para>Una simple utilidad de administración que envía
			mensajes a <command>nmbd</command> o <command>smbd</command>.</para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>smbgroupedit</command></term>
			<listitem><para>Una orden que se puede utilizar para definir
			mapeos entre los grupos de Windows <acronym>NT</acronym> y los de Unix.
			Esta es una funcionalidad nueva en Samba 3.0.</para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>smbmnt</command></term>
			<listitem><para>Una utilidad utilizada junto con
			<command>smbmount</command>.</para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>smbmount</command></term>
			<listitem><para>Un programa que monta un sistema de archivos
			<emphasis>smbfs</emphasis>, permitiendo que recursos remotos
			<acronym>SMB</acronym> sean montados en el sistema de archivos local
			de la máquina Samba.</para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>smbpasswd</command></term>
			<listitem><para>Un programa que permite a un administrador cambiar la
			clave utilizada por Samba.</para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>smbsh</command></term>
			<listitem><para>Una herramienta que funciona de manera similar a una
			shell, permitiendo el acceso a sistemas de archivos <acronym>SMB</acronym>
			remotos, y permite a las herramientas de Unix operar con ellos. Esta
			orden se describe con mayor profundidad en el capítulo 5 de la
			entrada bibliográfica
			<xref linkend="bibliografia-ts-eckstein-collier-brown-01"/></para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>smbspool</command></term>
			<listitem><para>Un programa de cola de impresión que se utiliza para
			enviar archivos a impresoras remotas que están compartidas en la
			red <acronym>SMB</acronym>.</para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>smbstatus</command></term>
			<listitem><para>Un programa que reporta las conexiones de red
			realizadas a los recursos compartidos en el servidor Samba
			actualmente.</para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>smbtar</command></term>
			<listitem><para>Un programa similar a la orden <command>tar</command>
			de Unix, que permite archivar datos en los recursos compartidos
			de <acronym>SMB</acronym>.</para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>smbumount</command></term>
			<listitem><para>Un programa que trabaja junto con
			<command>smbmount</command> para desmontar los sistemas de
			archivos <emphasis>smbfs</emphasis>.</para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>testparm</command></term>
			<listitem><para>Un programa que comprueba el archivo de configuración
			de Samba.</para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>testprns</command></term>
			<listitem><para>Un programa que comprueba si las impresoras en la
			máquina Samba están reconocidas por el demonio <command>smbd</command>
			</para></listitem>
		</varlistentry>
		<varlistentry>
			<term><command>wbinfo</command></term>
			<listitem><para>Una utilidad utilizada para realizar peticiones
			al demonio <command>winbind</command>.</para></listitem>
		</varlistentry>
	</variablelist>

	<para>
	Cada liberación mayor de Samba se somete a un chequeo intensivo antes de anunciarla. A parte
	de esto, se actualiza rápidamente después de liberada si ocurren problemas o se encuentran
	efectos inesperados.
	</para>
</sect1>

<sect1 id="samba-informacion-adicional-sobre-el-proyecto">
	<title>Información adicional sobre el proyecto</title>

	<sect2 id="samba-pagina-principal">
		<title>Página principal</title>

		<para>El Proyecto Samba dispone de una página principal,
                <ulink url="http://www.samba.org/">http://www.samba.org/</ulink>, desde donde
                puede obtener mucha información sobre el proyecto. De hecho, para elaborar esta sección
                ha utilizado la información allí disponible.</para>
	</sect2>

	<sect2 id="samba-obtener-samba">
		<title>Cómo obtener Samba</title>
	
		<para>
		Las distribuciones del código fuente y de los binarios de Samba están disponibles en muchos
		mirrors a lo largo de Internet. La página principal de Samba es
		<ulink url="http://www.samba.org/">http://www.samba.org/</ulink>. Desde allí, se puede
		seleccionar un mirror que esté geográficamente cerca de usted.
		</para>

		<para>Las distintas formas de distribución de Samba desde la página oficial se pueden
		ver en <ulink url="http://www.samba.org/download.html">http://www.samba.org/download.html</ulink>.
		</para>
	
		<para>
		La mayoría de las distribuciones de <acronym>GNU</acronym>/Linux y muchos distribuidores de
		Unix disponen de paquetes binarios de Samba. Suele ser más conveniente hacer uso
		de esos paquetes antes que el código fuente o los binarios del equipo de desarrollo de Samba,
		ya que los distribuidores se esfuerzan en suministrar paquetes que se adapten a las
		especificaciones de sus productos.
		</para>
	</sect2>

	<sect2 id="samba-documentacion">
		<title>Documentación</title>

		<para>Desde la página principal del proyecto Samba se puede acceder a distintos enlaces
		con documentación sobre el proyecto. Hay dos grandes formas de obtener la documentación:</para>

		<itemizedlist>
			<listitem>
				<para>en formato electrónico, para lo cual hay que acceder a:
				<ulink url="http://www.samba.org/docs/">http://www.samba.org/docs/</ulink></para>
			</listitem>
			<listitem>
				<para>comprando alguno de los libros disponibles sobre el tema. Para obtener
				un listado de algunos de ellos, visite:
				<ulink url="http://www.samba.org/books.html">http://www.samba.org/books.html</ulink></para>
			</listitem>
		</itemizedlist>
	</sect2>

	<sect2 id="samba-informacion-de-soporte">
		<title>Información de soporte</title>

		<para>La página dedicada al <ulink url="http://www.samba.org/support/index.html">soporte</ulink>
		y al <ulink url="http://www.samba.org/contacts.html">contacto</ulink> de Samba,
		informa sobre los distintos métodos existentes para obtener
		ayuda en un determinado momento. Los métodos más importantes para obtener ayuda
		son los siguientes:</para>

		<formalpara>
			<title>Listas de correo:</title>

			<para>El proyecto Samba dispone de varias listas de correo, desde donde se puede
			obtener información fiable y directa. El las siguientes páginas se pueden ver las
			listas disponibles y la forma de inscribirse a las mismas:
			<ulink url="http://www.samba.org/archives.html">http://www.samba.org/archives.html</ulink>
			y <ulink url="http://lists.samba.org/">http://lists.samba.org/</ulink>.</para>
		</formalpara>

		<formalpara>
			<title>Grupos de news:</title>

			<para>Otro de los métodos disponibles para obtener ayuda, es el grupo de news
			<ulink url="news:comp.protocols.smb">comp.protocols.smb</ulink>.</para>
		</formalpara>

		<formalpara>
			<title>Canales de <acronym>IRC</acronym>:</title>

			<para>Samba también dispone de dos canales en el servidor de <acronym>IRC</acronym>
			<ulink url="http://freenode.net/">http://freenode.net/</ulink>. El canal dedicado
			al desarrollo de Samba es #samba-technical y el dedicado a las preguntas de los
			usuarios y la discusión en general es el #samba.</para>
		</formalpara>

		<formalpara>
			<title>Servicio técnico de terceros:</title>

			<para>Muchas empresas ofrecen servicio técnico a la comunidad de Samba, un
			listado de las mismas se puede obtener desde:
			<ulink url="http://www.samba.org/support/countries.html">http://www.samba.org/support/countries.html</ulink>.</para>
		</formalpara>
	</sect2>

	<sect2 id="samba-reporte-de-bugs">
		<title>Reporte de bugs</title>

		<para>Samba dispone de un <ulink url="https://bugzilla.samba.org">Sistema
        de seguimiento de tareas</ulink>, desde donde se pueden reportar errores y bugs relacionados
        con Samba (tanto en lo relativo al software como a la documentación) y hacer
        peticiones de nuevas características.</para>

		<para>Si se quiere reportar un error grave de seguridad, lo más conveniente es utilizar
		el correo: <ulink url="mailto:security%40samba.org">security%40samba.org</ulink>.</para>

		<para>Si lo que se quiere es remitir un parche o una mejora para Samba, se ha de enviar
		un correo a <ulink url="mailto:samba-technical@samba.org">samba-technical@samba.org</ulink>
		o bien visitar:
		<ulink url="http://samba.org/samba-patches/">http://samba.org/samba-patches/</ulink>.</para>

		<para>Más detalles de las formas de reportar errores y parches en el siguiente enlace:
		<ulink url="http://www.samba.org/bugreports.html">http://www.samba.org/bugreports.html</ulink>.</para>
	</sect2>

	<sect2 id="samba-como-contactar">
		<title>Cómo contactar</title>
	
		<para>Para obtener más información sobre Samba, puede contactar con el Proyecto
		en la siguiente dirección:</para>
	
<screen>Samba Team
26 Carstensz st
Griffith, ACT
2603 Australia</screen>
	</sect2>

</sect1>
</chapter>

