<?xml version="1.0" encoding="ISO-8859-1" ?>

<appendix id="samba-instalacion-configuracion-swat">

	<title>Instalación y configuración de <application>SWAT</application></title>

<sect1 id="samba-instalacion-swat-introduccion">
	<title>Introducción</title>

	<para><acronym>SWAT</acronym> es una herramienta de configuración de Samba vía web. En las siguientes
	secciones se verán los pasos para ponerla en funcionamiento.</para>
</sect1>

<sect1 id="samba-instalacion-swat">
	<title>Instalación de <application>SWAT</application></title>

	<para>En el siguiente ejemplo se muestra la información relativa al paquete swat y la forma
	de instalarlo:</para>

	<example id="samba-instalacion-configuracion-swat-ejemplo1">
		<title>Instalación de <application>SWAT</application> (primera parte)</title>

<screen><prompt>$</prompt> <userinput>/usr/bin/apt-cache show swat</userinput>
<computeroutput><![CDATA[Package: swat
Priority: optional
Section: net
Installed-Size: 8968
Maintainer: Eloy A. Paris <peloy@debian.org>
Architecture: i386
Source: samba
Version: 3.0.7-1
Depends: debconf, samba (= 3.0.7-1), libc6 (>= 2.3.2.ds1-4),
libcomerr2 (>= 1.33-3), libcupsys2-gnutls10 (>= 1.1.20final-1),
libkrb53 (>= 1.3.2), libldap2 (>= 2.1.17-1), libpam0g (>= 0.76),
libpopt0 (>= 1.7)
Recommends: samba-doc
Filename: pool/main/s/samba/swat_3.0.7-1_i386.deb
Size: 3964890
MD5sum: d84a020935c85831d8d81321b7391ed4
Description: Samba Web Administration Tool
 The Samba software suite is a collection of programs that
 implements the SMB protocol for unix systems, allowing you to serve
 files and printers to Windows, NT, OS/2 and DOS clients. This protocol
 is sometimes also referred to as the LanManager or NetBIOS protocol.
 .
 This package contains the components of the Samba suite that are needed
 for Web administration of the Samba server.
 .
 Note: if you want to use the on-line documentation that is accesible
 through the Swat front-end you must install the samba-doc package.
Task: file-server, print-server

]]></computeroutput>
<prompt>#</prompt><userinput>/usr/bin/apt-get install swat</userinput>
<computeroutput><![CDATA[Leyendo lista de paquetes... Hecho
Creando árbol de dependencias... Hecho
Se instalarán los siguientes paquetes NUEVOS:
  swat
0 actualizados, 1 se instalarán, 0 para eliminar y 1 no actualizados.
Se necesita descargar 0B/3965kB de archivos.
Se utilizarán 9183kB de espacio de disco adicional después de desempaquetar.
Preconfiguring packages ...]]></computeroutput>
</screen>
	</example>

	<figure>
		<title>Aviso de sobreescritura del archivo <filename>/etc/samba/smb.conf</filename></title>
		<mediaobject>
			<imageobject>
				<imagedata fileref="./imagenes/samba-instalacion-swat.png" format="PNG"/>
			</imageobject>
	
			<caption>
				<para>El programa <application>SWAT</application> sobreescribe el archivo de configuración
				de Samba, eliminado los comentarios, entre otras cosas. Esta pantalla avisa de este
				hecho, y recomienda no utilizar <application>SWAT</application> en aquellos casos en los
				que se tenga muy personalizado el archivo de configuración de Samba.</para>
			</caption>
		</mediaobject>
	</figure>

	<example id="samba-instalacion-configuracion-swat-ejemplo2">
		<title>Instalación de <application>SWAT</application> (segunda parte)</title>

<screen><computeroutput><![CDATA[Seleccionando el paquete swat previamente no seleccionado.
(Leyendo la base de datos ...
133905 ficheros y directorios instalados actualmente.)
Desempaquetando swat (de .../archives/swat_3.0.7-1_i386.deb) ...
Configurando swat (3.0.7-1) ...
--------- IMPORTANT INFORMATION FOR XINETD USERS ----------
The following line will be added to your /etc/inetd.conf file:

#<off># swat\t\tstream\ttcp\tnowait.400\troot\t/usr/sbin/tcpd\t/usr/sbin/swat

If you are indeed using xinetd, you will have to convert the
above into /etc/xinetd.conf format, and add it manually. See
/usr/share/doc/xinetd/README.Debian for more information.
-----------------------------------------------------------


localepurge: checking system for new locale ...
localepurge: processing locale files ...
localepurge: processing man pages ...]]></computeroutput></screen>
	</example>
</sect1>

<sect1 id="samba-configuracion-swat-x-inetd">
	<title>Gestión de <application>SWAT</application> desde un superservidor
	<application>(x)inetd</application></title>

	<para>A continuación se verá la forma de configurar <application>SWAT</application>
	para que sea gestionado desde los superservidores <application>inetd</application>
	y <application>xinetd</application>:</para>

	<sect2 id="samba-configuracion-swat-inetd">
		<title>Gestión de <application>SWAT</application> desde <application>inetd</application></title>
	
		<para>Tras la instalación de <application>SWAT</application>, se ha de activar en el
		archivo de configuración de <application>inetd</application>:</para>
	
		<example id="samba-configuracion-swat-inetd-ejemplo1">
			<title>Activación de <application>SWAT</application> en <application>inetd</application></title>
	
<screen><prompt>#</prompt> <userinput>/usr/sbin/update-inetd --verbose --enable swat</userinput>
<computeroutput>Processing /etc/inetd.conf
Processing service `swat' ... enabled</computeroutput></screen>
		</example>
	
		<para>Ahora se hace que el superservidor <application>inetd</application> relea su configuración,
		quedando el servicio <application>SWAT</application> disponible en el sistema:</para>
	
		<example id="samba-configuracion-swat-inetd-ejemplo2">
			<title>Haciendo que el superservidor <application>inetd</application>
			relea su configuración</title>
	
<screen><prompt>#</prompt> <userinput>/usr/bin/killall --verbose -HUP inetd</userinput>
<computeroutput>Killed inetd(3005) with signal 1</computeroutput></screen>
		</example>

		<para>Como se puede ver en el <xref linkend="samba-configuracion-swat-inetd-ejemplo3"/>,
		<application>SWAT</application> está a la espera de peticiones:</para>
	
		<example id="samba-configuracion-swat-inetd-ejemplo3">
			<title>Mostrando las conexiones de <application>SWAT</application></title>
	
<screen><prompt>#</prompt> <userinput>/bin/netstat -puta | /bin/grep swat</userinput>
<computeroutput>Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 *:swat                  *:*                     LISTEN     1265/inetd</computeroutput></screen>
		</example>

	</sect2>
	
	<sect2 id="samba-configuracion-swat-xinetd">
		<title>Gestión de <application>SWAT</application> desde <application>xinetd</application></title>
	
		<para>Para ejecutar <application>SWAT</application> desde el superservidor
		<application>xinetd</application> se ha de crear la configuración para este servicio
		en dicho superservidor. Esto se realiza creando un nuevo archivo denominado
		<filename>swat</filename> bajo el directorio <filename class="directory">/etc/xinetd.d</filename>,
		cuyo contenido sea:</para>
	
		<example id="samba-configuracion-swat-xinetd-ejemplo1">
			<title>Contenido del archivo <filename>/etc/xinetd.d/swat</filename></title>
	
<programlisting>service swat
{
        disable         = no <co id="xinetd-servicio-swat-disable"/>
        socket_type     = stream
        protocol        = tcp
        wait            = no
        user            = root
        server          = /usr/sbin/swat
#       server_args     = -a <co id="xinetd-opciones-servicio-swat"/>
}</programlisting>
		</example>
	
		<calloutlist>
			<callout arearefs="xinetd-servicio-swat-disable">
				<para>Variable que controla si el servicio está o no activo. Si su valor
				es igual a <quote>yes</quote>, el servicio estará deshabilitado,
				si es <quote>no</quote>, estará habilitado.</para>
			</callout>
			<callout arearefs="xinetd-opciones-servicio-swat">
				<para>Esta línea, en caso de estar descomentada, está destinada al paso de parámetros
				para el servidor <application>swat</application>. La opción <quote>-a</quote>
				deshabilitaría la autentificación, permitiendo a cualquier persona modificar la
				configuración de Samba. ¡Tenga cuidado con su uso!</para>
			</callout>
		</calloutlist>
	
		<para>Ahora haga que el superservidor <application>xinetd</application>
		relea su configuración de la siguiente manera:</para>
	
		<example id="samba-configuracion-swat-xinetd-ejemplo2">
			<title>Releyendo la configuración de <application>xinetd</application></title>
	
<screen><prompt>#</prompt> <userinput>/etc/init.d/xinetd reload</userinput>
<computeroutput>Reloading internet superserver configuration: xinetd.</computeroutput></screen>
		</example>
	
		<para>Una vez ejecutada la orden del <xref linkend="samba-configuracion-swat-xinetd-ejemplo2"/>,
		el superservidor <application>xinetd</application> pasaría a gestionar las
		conexiones a Samba:</para>
	
		<example id="samba-configuracion-swat-xinetd-ejemplo3">
			<title>Mostrando las conexiones de <application>SWAT</application></title>
	
<screen><prompt>#</prompt> <userinput>/bin/netstat -puta | /bin/grep swat</userinput>
<computeroutput>Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 *:swat                  *:*                     LISTEN     4687/xinetd</computeroutput></screen>
		</example>
	</sect2>
</sect1>

<sect1 id="samba-accediendo-swat">
	<title>Accediendo a <application>SWAT</application></title>

	<para>Para ejecutar <application>SWAT</application>, teclee en su navegador favorito la siguiente
	dirección: http://localhost:901/ y verá algo similar a:</para>

	<figure>
		<title>Acceso a <application>SWAT</application></title>
		<mediaobject>
			<imageobject>
				<imagedata fileref="./imagenes/samba-swat1.png" format="PNG"/>
			</imageobject>
	
			<caption>
				<para>Ventana de ejecución de <acronym>KDE</acronym>, aparece tecleando:
				<keycombo action='simul'><keycap>Alt</keycap><keycap>F2</keycap></keycombo>.</para>
			</caption>
		</mediaobject>
	</figure>

	<figure>
		<title>Autentificación</title>
		<mediaobject>
			<imageobject>
				<imagedata fileref="./imagenes/samba-swat2.png" format="PNG"/>
			</imageobject>
	
			<caption>
				<para>Si no se ha utilizado el parámetro <quote>-a</quote> en el arranque de
				<application>SWAT</application>, será necesario autentificarse antes de poder
				entrar en la herramienta.</para>
			</caption>
		</mediaobject>
	</figure>

	<figure>
		<title>Pantalla principal de <application>SWAT</application></title>
		<mediaobject>
			<imageobject>
				<imagedata fileref="./imagenes/samba-swat3.png" format="PNG"/>
			</imageobject>
	
			<caption>
				<para>Pantalla principal de <application>SWAT</application>, desde aquí se puede acceder
				a todas las partes de la configuración de Samba.</para>
			</caption>
		</mediaobject>
	</figure>

</sect1>

</appendix>
