% \linux Installation and Getting Started    -*- TeX -*-
% links.tex
% Copyright (c) 1992, 1993 by Matt Welsh <mdw@sunsite.unc.edu>
%
% This file is freely redistributable, but you must preserve this copyright 
% notice on all copies, and it must be distributed only as part of "\linux 
% Installation and Getting Started". This file's use is covered by the 
% copyright for the entire document, in the file "copyright.tex".
%
% Copyright (c) 1998 by Specialized Systems Consultants Inc. 
% <ligs@ssc.com>

%\section{Managing file links.}\label{sec-manage-links}
%Revisión 1 Francisco Javier Fernández Serrador <serrador@arrakis.es>
%Gold
\section{Gestión  de enlaces a ficheros}
\label{sec-manage-links}
\markboth{Tutorial de {\linux}}{Gestión de enlaces a ficheros}
\index{ficheros!enlaces|(}
\index{enlaces|(}
\index{número de inode!definición}
\index{ficheros!número de inodo de}
\index{inodos!definición}
Los enlaces permiten darle a un fichero más de un nombre. Realmente, el
sistema identifica los ficheros por su {\bf número de inodo}, que es
el único identificador del fichero para el sistema de ficheros.
Un directorio es en realidad una lista de números de inodos con sus
correspondientes nombres de fichero. Cada nombre de fichero dentro de un directorio
es un {\bf enlace} a un inodo concreto.

%\subsection{Hard links.}
\subsection{Enlaces rígidos}
\index{enlaces!duros}
\index{enlaces!rígidos}
La orden {\tt ln} se utiliza para crear múltiples enlaces a un
fichero. Por ejemplo, digamos que tiene un fichero llamado {\tt foo} en 
un directorio. Usando {\tt ls -i}, puede ver el número de inodo
de este fichero.
\begin{tscreen}
/home/larry\# ls -i foo \\
22192 foo \\
/home/larry\#
\end{tscreen}
Aquí, {\tt foo} tiene un número de inodo de 22192 en el
sistema de ficheros. Puede crear otro enlace a {\tt foo}, llamado {\tt bar}, como sigue:
\begin{tscreen}
/home/larry\# ln foo bar 
\end{tscreen}
Con {\tt ls -i}, puede comprobar que los dos ficheros tienen el mismo número de inodo.
\begin{tscreen}
/home/larry\# ls -i foo bar \\
22192 bar\ \ \ 22192 foo \\
/home/larry\#
\end{tscreen}
Ahora, especificando tanto {\tt foo} como {\tt bar} se accederá
al mismo fichero. Si hace cambios en {\tt foo}, esos cambios
aparecen también en {\tt bar}. A todos los efectos, {\tt foo}
y {\tt bar} son el mismo fichero.

A este tipo de enlaces se les conoce como {\bf enlaces rígidos\/} porque directamente
crean el enlace al inodo. Tenga en cuenta que puede crear enlaces rígidos sólo
cuando estén en el mismo sistema de ficheros; los enlaces simbólicos (ver debajo) no tienen
esta restricción.

Cuando borra un fichero con {\tt rm}, realmente sólo está
borrando uno de los enlaces a ese fichero. Si usa la orden
\begin{tscreen}
/home/larry\# rm foo
\end{tscreen}
entonces sólo el enlace llamado {\tt foo} se borra, {\tt bar}
todavía existirá. Un fichero sólo se borra realmente del sistema
cuando no tiene enlaces. Normalmente, los ficheros tienen un
único enlace, por lo que usando la orden {\tt rm} se borra el fichero. Sin embargo,
si un fichero tiene múltiples enlaces, usando {\tt rm} sólo se borrará
un enlace simple; para borrar el fichero, deberá borrar todos los enlaces a él.

\index{enlaces!mostrar número de}
La orden {\tt ls -l} muestra el número de enlaces a un fichero
(entre otra información).
\begin{tscreen}
/home/larry\# ls -l foo bar \\
\verb!-rw-r--r--   2 root     root          12 Aug  5 16:51 bar! \\
\verb!-rw-r--r--   2 root     root          12 Aug  5 16:50 foo! \\
/home/larry\#
\end{tscreen}
La segunda columna del listado, ''{\tt 2}'', especifica el número de
enlaces al fichero.

Asi resulta que un directorio no es realmente más que un fichero que contiene información
sobre asociaciones enlaces-a-inodos. Además, cada directorio contiene al menos dos
enlaces rígidos: ''{\tt .}'' (un enlace apuntando a él mismo) y 
''{\tt ..}'' (un enlace
apuntando a su directorio padre). El enlace ''{\tt ..}'' del directorio raíz ({\tt /}) 
simplemente vuelve a apuntar a {\tt /}.  (En otras palabras, el directorio padre del
directorio raíz es él mismo.)

%\subsection{Symbolic links.}
\subsection{Enlaces simbólicos.}
\index{enlaces!simbólicos}
Los enlaces simbólicos son otro tipo de enlace, diferente
al enlace rígido. Un enlace simbólico permite dar otro nombre
a un fichero, pero no enlaza el fichero mediante el inodo.

La orden {\tt ln -s} crea un enlace simbólico a un fichero.
Por ejemplo, si utiliza la orden
\begin{tscreen}
/home/larry\# ln -s foo bar
\end{tscreen} 
creará un enlace simbólico llamado {\tt bar} que apunte al fichero
{\tt foo}. Si utiliza {\tt ls -i}, verá que los dos ficheros
tienen diferentes inodos.
\begin{tscreen}
/home/larry\# {\em ls -i foo bar} \\
22195 bar\ \ \ 22192 foo \\
/home/larry\#
\end{tscreen}
Sin embargo, usando {\tt ls -l}, vemos que el fichero {\tt bar}
es un enlace simbólico apuntando a {\tt foo}.
\begin{tscreen}
/home/larry\# ls -l foo bar \\
\verb!lrwxrwxrwx   1 root     root           3 Aug  5 16:51 bar -> foo! \\
\verb!-rw-r--r--   1 root     root          12 Aug  5 16:50 foo! \\
/home/larry\#
\end{tscreen}

Los permisos de fichero de un enlace simbólico no se utilizan (siempre
aparecen como {\tt rxwrxwrxw}). En su lugar, los permisos del enlace simbólico
están determinados por los permisos del destino del enlace simbólico (en nuestro
ejemplo, el fichero {\tt foo}).

Funcionalmente, los enlaces rígidos y simbólicos son similares, pero hay diferencias.
Por un lado, se pueden crear enlaces simbólicos a ficheros que no existen, cosa
que no sucede con los enlaces rígidos. Los enlaces simbólicos son
procesados de manera distinta a los rígidos por el núcleo, lo que constituye una
mera diferencia técnica pero que a veces puede resultar importante. Los enlaces
simbólicos son de ayuda porque identifican al fichero al que apuntan; con enlaces
rígidos, no hay una manera fácil de determinar qué ficheros están enlazados al
mismo inodo.

Los enlaces se utilizan en muchos lugares dentro de un sistema \linux. Los
enlaces simbólicos son especialmente importantes para las bibliotecas compartidas
en {\tt /lib}. Consulte la página~\pageref{sec-upgrade-libs} para más información.
\index{ficheros!enlaces|)}
\index{enlaces|)}
