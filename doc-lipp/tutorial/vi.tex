% \linux: Instalación y primeros pasos    -*- TeX -*-
% vi.tex
% Copyright (c) 1992, 1993 by Matt Welsh <mdw@sunsite.unc.edu>
%
% Este fichero puede redistribuirse libremente, pero debe conservarse este distintivo 
% de copyright en todas las copias, y sólo debe ser distribuido como parte de 
% "\linux: Instalación y primeros pasos". El uso de este archvi está cubierto por el 
% copyright para todo el documento, en el arhcivo "copyright.tex"
%
% Copyright (c) 1998 by Specialized Systems Consultants Inc. 
% <ligs@ssc.com>

%\section{Using the {\tt vi} editor.}\label{sec-vi}
\section{Uso del editor {\tt vi}}\label{sec-vi}
\markboth{Tutorial de {\linux}}{Uso del editor {\tt vi}}

\index{vi@{\tt vi}|(}
\index{editor de texto!definición}
\index{editor!definición}
Un {\bf editor de texto} es un programa que se usa para editar ficheros que 
se componen con texto: una carta, un programa en C o un fichero de 
configuración del sistema. Aunque para {\linux} hay disponibles muchos 
editores de texto, el único editor que es seguro que vas a encontrar en cualquier 
sistema UNIX o {\linux} es  {\tt vi} --- el ``editor visual\NT{visual editor}.'' 
El editor {\tt vi} no es el editor más fácil de usar, ni es muy autoexplicativo.
 Sin embargo, como {\tt vi} es tan común en el mundo UNIX/Linux, y algunas veces 
necesario, merece un tratamiento aquí.

\index{editor de texto!comparación}
\index{Emacs}
\index{GNU/Emacs}
La elección de su editor es más que nada una cuestión de gusto y 
estilo personal. Muchos usuarios prefieren el barroco, autoexplicativo y potente 
{\tt GNU emacs} ---un editor con más posibilidades que cualquier otro programa 
en el mundo UNIX. Por ejemplo, {\tt GNU emacs} tiene su propio dialecto interno del 
lenguaje de programación LISP, y tiene muchas extensiones (una de las 
cuales es un programa de inteligencia artificial similar a Eliza). Sin 
embargo, como {\tt GNU emacs} y sus ficheros de soporte son relativamente extensos, 
puede que no esté instalado en algunos sistemas. Por otro lado,{\tt vi}
es pequeño y potente pero más difícil de usar. De todas formas, una vez 
que conozca la forma de funcionamiento de {\tt vi}, será realmente muy fácil.

Esta sección presenta una introducción a {\tt vi} ---no hablaremos 
sobre todas sus características, sólo las necesarias para 
empezar. Puede consultar la página del manual de {\tt vi} si 
está interesado en aprender más sobre las características del 
editor. Otra alternativa es leer el libro {\em Learning the vi Editor} 
de O'Reilly y asociados, o el {\em Vi Tutorial} de Specialized Systems 
Consultants (SSC) Inc. Mire el Apéndice~\ref{app-info} para informarse.

%\subsection{Concepts.}
\subsection{Conceptos}
Mientras se usa {\tt vi}, en cualquier instante estará en uno de los tres modos 
de operación. Estos modos se llaman {\em modo orden}, {\em modo inserción}, 
y {\em modo última línea}. 

\index{vi@{\tt vi}!modo orden}
Cuando arranca {\tt vi}, está en el {\em modo orden}. Este modo le 
permite usar órdenes para editar ficheros o cambiar a otros modos. 
Por ejemplo, tecleando ``{\tt x}'' en modo órdenes se borra el carácter 
que está sobre el cursor. Las teclas con flechas mueven el cursor por 
el documento que está editando. Normalmente, las órdenes usadas en este 
modo tienen uno o dos caracteres de longitud.

\index{vi@{\tt vi}!modo edición}
Usted realmente inserta o edita texto en el {\em modo inserción}. Cuando 
use {\tt vi}, probablemente pasará la mayor parte del tiempo en 
este modo. Se comienza el modo de inserción usando una orden como 
``{\tt i}'' ( de ``insertar'') desde el modo órdenes. Cuando está 
en el modo de inserción, puede insertar texto en el documento en 
la posición actual del cursor. Para terminar el modo de inserción y 
volver al modo  órdenes, presione \key{Esc}.

\index{vi@{\tt vi}!modo última línea}
El {\em modo última línea} es un modo especial usado para dar ciertas 
órdenes extendidas a {\tt vi}. Mientras teclea estas órdenes, 
aparecen en la última línea de la pantalla (de aquí su nombre). Por 
ejemplo, cuando teclea ``{\tt :}'' en modo orden, salta al modo 
última línea y puedes usar órdenes como ``{\tt wq}'' ( para escribir 
el fichero y salir de {\tt vi}), o ``{\tt q!}'' (para salir de 
{\tt vi} sin guardar los cambios). El modo última línea es usado 
normalmente para las órdenes de {\tt vi} que son más largas de un 
carácter. En el modo última línea, escribe una orden de una sóla 
línea y pulsa {\ret} para ejecutarla. 

%\subsection{Starting {\tt vi}.}
\subsection{Comenzando con {\tt vi}}
\index{vi@{\tt vi}!empezando}
La mejor forma de comprender estos conceptos es arrancar {\tt vi} y 
editar un fichero. El ejemplo ``screens'' de abajo muestra sólo unas 
pocas líneas de texto, como si la pantalla tuviera seis líneas de 
longitud en vez de 24.

La sintaxis de {\tt vi} es 
\begin{tscreen}
vi \cparam{fichero}
\end{tscreen}
donde \textsl{fichero} es el nombre del fichero a editar.

Arranque {\tt vi} tecleando
\begin{tscreen}
/home/larry\# vi test
\end{tscreen}
para editar el fichero {\tt test}. Debería ser algo como:
\begin{tscreen}\fbox{\begin{minipage}{0.8\textwidth}
\underline{\~{}} \\
\~{} \\
\~{} \\
\~{} \\
\~{} \\
\~{} \\
"test" [New file]
\end{minipage}}\end{tscreen}

La columna de caracteres ``{\tt \~{}}'' le indica que está al final 
del fichero. El  \underline{\ } representa el cursor.

%\subsection{Inserting text.}
\subsection{Insertando texto}

\index{vi@{\tt vi}!inserción de texto|(}
El programa {\tt vi} está ahora en modo orden. Inserte texto en el 
fichero pulsando \key{i}, que pone al editor en el modo inserción, y 
empiece a teclear.
\begin{tscreen}\fbox{\begin{minipage}{0.8\textwidth}
Now is the time for all good men to come to the aid of the party\underline{.} \\
\~{} \\
\~{} \\
\~{} \\
\~{} \\
\~{} 
\end{minipage}}\end{tscreen}

Teclee cuantas líneas quiera (pulsando {\ret} después de cada una). 
Tal vez quiera corregir fallos con la tecla \key{Backspace}.

Para finalizar el modo de inserción y volver al modo orden pulse \key{Esc}.

En el modo orden puede usar las teclas de flecha para moverse 
por el fichero. (Si sólo tiene una línea de texto, el intentar usar 
las teclas de flechas de arriba y abajo probablemente causará que 
{\tt vi} emita un pitido.) 

Hay diversas formas de insertar texto además de la orden  {\tt i}. 
La orden {\tt a} inserta texto empezando después de la posición 
actual del cursor, en vez de en la posición actual del cursor. Por 
ejemplo, use la tecla de flecha izquierda para mover el cursor entre 
las palabras ``good'' y ``men.''
\begin{tscreen}\fbox{\begin{minipage}{0.8\textwidth}
Now is the time for all good\underline{\ }men to come to the aid of the party. \\
\~{} \\
\~{} \\
\~{} \\
\~{} \\
\~{} 
\end{minipage}}\end{tscreen}
Pulse \key{a} para empezar el modo inserción, teclee ``{\tt wo}'', y 
luego pulse \key{Esc} para volver al modo orden.
\begin{tscreen}\fbox{\begin{minipage}{0.8\textwidth}
Now is the time for all good wo\underline{m}en to come to the aid of the party. \\
\~{} \\
\~{} \\
\~{} \\
\~{} \\
\~{} 
\end{minipage}}\end{tscreen}

Para empezar insertando texto en la siguiente línea, use
la orden {\tt o}. Pulse \key{o} e inserte una o dos líneas:
\begin{tscreen}\fbox{\begin{minipage}{0.8\textwidth}
Now is the time for all good humans to come to the aid of the party. \\
Afterwards, we'll go out for pizza and beer\underline{.} \\
\~{} \\
\~{} \\
\~{} \\
\~{}
\end{minipage}}\end{tscreen}

% Remember that at any time you're in command mode (where commands such
% as {\tt i}, {\tt a}, or {\tt o} are valid), in insert mode (where
% you're inserting text, followed by \key{esc} to return to command
% mode), or in last line mode (where you're entering extended commands,
% as discussed below).
\index{vi@{\tt vi}!inserción de texto|)}

%\subsection{Deleting text.}
\subsection{Borrando texto}
\index{vi@{\tt vi}!borrando texto|(}
En modo orden, la orden {\tt x} borra el carácter debajo del cursor. 
Si pulsa \key{x} cinco veces, terminará con:
\begin{tscreen}\fbox{\begin{minipage}{0.8\textwidth}
Now is the time for all good humans to come to the aid of the party. \\
Afterwards, we'll go out for pizza and\underline{\ } \\
\~{} \\
\~{} \\
\~{} \\
\~{} 
\end{minipage}}\end{tscreen}
Ahora pulse \key{a} e inserte algo de texto, seguido por \key{esc}:
\begin{tscreen}\fbox{\begin{minipage}{0.8\textwidth}
Now is the time for all good humans to come to the aid of the party. \\
Afterwards, we'll go out for pizza and Diet Coke\underline{.} \\
\~{} \\
\~{} \\
\~{} \\
\~{} 
\end{minipage}}\end{tscreen}
Puede borrar líneas enteras usando la orden {\tt dd} (esto es, 
pulsar \key{d} dos veces en una fila). Si el cursor está en la segunda 
línea y teclea {\tt dd}, verá: 
\begin{tscreen}\fbox{\begin{minipage}{0.8\textwidth}
\underline{N}ow is the time for all good humans to come to the aid of the party. \\
\~{} \\
\~{} \\
\~{} \\
\~{} \\
\~{} 
\end{minipage}}\end{tscreen}

Para borrar la palabra sobre la que está el cursor, use la orden {\tt dw}.
Coloque el cursor en la palabra ``good'', y teclee {\tt dw}.
\begin{tscreen}\fbox{\begin{minipage}{0.8\textwidth}
Now is the time for all \underline{h}umans to come to the aid of the party. \\
\~{} \\
\~{} \\
\~{} \\
\~{} \\
\~{}
\end{minipage}}\end{tscreen}
\index{vi@{\tt vi}!borrado de texto|)}

%\subsection{Changing text.}
\subsection{Cambiando texto}
\index{vi@{\tt vi}!cambio de texto|(}
Puede reemplazar secciones de texto usando la orden  {\tt R} . 
Ponga el cursor en la primera letra de ``party'', pulse \key{R}, y teclee la 
palabra ``hungry''.
\begin{tscreen}\fbox{\begin{minipage}{0.8\textwidth}
Now is the time for all humans to come to the aid of the hungry\underline{.} \\
\~{} \\
\~{} \\
\~{} \\
\~{} \\
\~{} 
\end{minipage}}\end{tscreen}
Usar {\tt R} para editar texto es como las órdenes {\tt i} y {\tt a} , pero 
{\tt R} sobreescribe, mejor que insertar, texto.

La orden {\tt r} reemplaza el único carácter debajo del cursor. Por ejemplo 
mueva el cursor al principio de la palabra ``Now'', y presione {\tt r} 
seguido de {\tt C}, verá:
\begin{tscreen}\fbox{\begin{minipage}{0.8\textwidth}
\underline{C}ow is the time for all humans to come to the aid of the hungry. \\ 
\~{} \\
\~{} \\
\~{} \\
\~{} \\
\~{} 
\end{minipage}}\end{tscreen}

La orden ``{\tt \~{}}'' cambia la letra bajo el cursor de mayúsculas a 
minúsculas y viceversa. Por ejemplo, si coloca el cursor en la ``o'' de 
``Cow'' arriba y presiona repetidamente \key{\~{}}, terminará con:
\begin{tscreen}\fbox{\begin{minipage}{0.8\textwidth}
COW IS THE TIME FOR ALL WOMEN TO COME TO THE AID OF THE HUNGRY\underline{.}\\
\~{} \\
\~{} \\
\~{} \\
\~{} \\
\~{} 
\end{minipage}}\end{tscreen}
\index{vi@{\tt vi}!cambiar texto|)}


%\subsection{Commands for moving the cursor.}
\subsection{Órdenes para mover el cursor}
\index{vi@{\tt vi}!mover el cursor}
Ya conoce cómo usar las teclas de las flechas para moverse por el 
documento. Además puede usar las órdenes {\tt h}, {\tt j}, {\tt k}, 
y {\tt l} para mover el cursor a la izquierda, abajo, arriba y 
derecha, respectivamente. Esto es útil cuando (por alguna razón) sus 
teclas de flechas no estén funcionando correctamente.

La orden {\tt w} mueve el cursor al principio de la siguiente palabra. 
La orden {\tt b} lo mueve al principio de la palabra anterior. 

La orden {\tt 0} (la tecla cero) mueve el cursor al principio de la línea 
actual, y la orden {\tt \$} lo mueve hasta al final de la línea. 

Cuando se está editando un fichero largo, querrá moverse hacia 
delante o hacia detrás por el fichero una pantalla de una vez. 
Presionando \key{Ctrl-F} se mueve el cursor una pantalla hacia 
delante, y \key{Ctrl-B} lo mueve una pantalla hacia atrás. 

Para mover el cursor al final del fichero, presione {\tt G}. Puede 
moverse también a una línea arbitraria; por ejemplo, tecleando la 
orden {\tt 10G} el cursor se moverá a la línea 10 del fichero. 
Para moverse al principio del fichero, use {\tt 1G}. 

Puede emparejar órdenes de movimientos con otras órdenes, tales como 
aquellas para borrar texto. Por ejemplo, la orden {\tt d\$} borra 
todo desde el cursor hasta el final de la línea; {\tt dG} borra todo 
desde el cursor hasta el final del fichero, y así todas. 

%\subsection{Saving files and quitting {\tt vi}.}
\subsection{Guardandando ficheros y saliendo de {\tt vi}}
\index{vi@{\tt vi}!guardar cambios}
\index{vi@{\tt vi}!escribir cambios}
\index{vi@{\tt vi}!salir}
Para abandonar {\tt vi} sin hacer cambios al fichero, usa la orden 
{\tt :q!}. Cuando pulsa ``{\tt :}'', el cursor se mueve a la última 
línea de la pantalla y estará en el modo última línea. 
\begin{tscreen}\fbox{\begin{minipage}{0.8\textwidth}
COW IS THE TIME FOR ALL WOMEN TO COME TO THE AID OF THE HUNGRY. \\
\~{} \\
\~{} \\
\~{} \\
\~{} \\
\~{} \\
:\underline{\ }
\end{minipage}}\end{tscreen}
En el modo última línea, hay disponibles ciertas órdenes extendidas 
Una de ellos es {\tt q!}, que sale de {\tt vi} sin guardar. La orden 
{\tt :wq} guarda el fichero y entonces sale de {\tt vi}. La orden 
{\tt ZZ} (desde el modo orden, sin el ``{\tt :}'') es equivalente a 
{\tt :wq}. Si el fichero no ha sido cambiado desde la última vez que 
se guardó, simplemente sale, guardando la hora de modificación del 
último cambio. Recuerde que debe presionar \ret después de 
una orden introducida en el modo última línea. 

Para guardar el fichero sin salir de vi, use {\tt :w}. 

%\subsection{Editing another file.}
\subsection{Edición de otro fichero}
\index{vi@{\tt vi}!cambiar a otros ficheros}
Para editar otro fichero, use la orden {\tt :e}. Por ejemplo, 
para parar de editar {\tt test} y editar el fichero {\tt foo} en su 
lugar, use la orden 
\begin{tscreen}\fbox{\begin{minipage}{0.8\textwidth}
COW IS THE TIME FOR ALL WOMEN TO COME TO THE AID OF THE HUNGRY. \\
\~{} \\
\~{} \\
\~{} \\
\~{} \\
\~{} \\
:e foo\underline{\ }
\end{minipage}}\end{tscreen}
Si usa {\tt :e} sin guardar el fichero primero, obtendrás el mensaje 
de error 
\begin{tscreen}\fbox{\begin{minipage}{0.8\textwidth}
No write since last change (":edit!" overrides)
\end{minipage}}\end{tscreen}
que significa que {\tt vi} no quiere editar otro fichero hasta que 
guarde el primero. En este punto, puede usar {\tt :w} para guardar 
el fichero original, y entonces usar {\tt :e}, o puede usar la 
orden 
\begin{tscreen}\fbox{\begin{minipage}{0.8\textwidth}
COW IS THE TIME FOR ALL WOMEN TO COME TO THE AID OF THE HUNGRY. \\
\~{} \\
\~{} \\
\~{} \\
\~{} \\
\~{} \\
:e! foo\underline{\ }
\end{minipage}}\end{tscreen}
La orden ``{\tt !}'' le dice a {\tt vi} lo que realmente quiere hacer usted --- 
editar el nuevo fichero sin salvar los cambios del primero. 

%\subsection{Including other files.}
\subsection{Inclusión de otros ficheros}
\index{vi@{\tt vi}!incluir ficheros}
Si usa la orden {\tt :r}, puede incluir los contenidos de otro fichero 
en el fichero actual. Por ejemplo, la orden
\begin{tscreen}
:r foo.txt
\end{tscreen}
inserta los contenidos del fichero {\tt foo.txt} en el texto en la posición 
del cursor.

%\subsection{Running shell commands.}
\subsection{Ejecución de órdenes del intérprete}
\index{vi@{\tt vi}!órdenes shell desde  }
También puede ejecutar órdenes del intérprete de ordenes dentro de {\tt vi}.
La orden {\tt :r!} funciona como {\tt :r}, pero en lugar de leer un fichero, 
inserta la salida de una determinada orden en la posición actual del cursor. Por 
ejemplo, si usa la orden 
\begin{tscreen}
:r! ls -F
\end{tscreen}
terminará con
\begin{tscreen}\fbox{\begin{minipage}{0.8\textwidth}
COW IS THE TIME FOR ALL WOMEN TO COME TO THE AID OF THE HUNGRY. \\
letters/ \\
misc/ \\
papers\underline{/} \\
\~{} \\
\~{} 
\end{minipage}}\end{tscreen}
También puede salir a un intérprete de ordenes desde {\tt vi}, en otras 
palabras, ejecutar una orden desde dentro de {\tt vi}, y volver al editor cuando 
haya terminado. 
Por ejemplo, si usa la orden
\begin{tscreen}
:! ls -F
\end{tscreen}
la orden {\tt ls -F} será ejecutada y los resultados se mostrarán en la 
pantalla, pero no insertados en el fichero que está editando.
Si usa la orden 
\begin{tscreen}
:shell
\end{tscreen}
{\tt vi} empieza una instancia (copia) de la shell, permitiendole temporalmente 
poner vi ``en suspenso'' mientras ejecuta otras órdenes. Sólo tiene que 
salir de la shell (usando la orden {\tt exit} ) para volver a {\tt vi}.

%\subsection{Getting {\tt vi} help.}
\subsection{Obtención de  ayuda}
El editor {\tt vi} no proporciona demasiada ayuda interactiva (la mayoría de 
los programas {\linux} no lo hacen), pero siempre puede leer las páginas 
del manual de {\tt vi}. 
Como {\tt vi} es un ``front-end'' visual del editor {\tt ex} que maneja muchas 
de las órdenes del modo última línea de {\tt vi}, además de leer la 
página del manual de {\tt vi}, mire también la de {\tt ex}.
\index{vi@{\tt vi}|)}
