% \linux: Instalación y primeros pasos    -*- TeX -*-
% perms.tex
% Copyright (c) 1992, 1993 by Matt Welsh, Larry Greenfield and Karl Fogel
%
% Este fichero puede redistribuirse libremente, pero debe conservarse este distintivo 
% de copyright en todas las copias, y sólo debe ser distribuido como parte de 
% "\linux: Instalación y primeros pasos". El uso de este fichero está cubierto por el 
% copyright para todo  el documento, en el fichero "copyright.tex".
%
% Copyright (c) 1998 by Specialized Systems Consultants Inc. 
% <ligs@ssc.com>

%\section{File permisos.}
\section{Permisos de fichero}
\markboth{Tutorial de {\linux} }{Permisos de fichero}
\label{sec-file-perms}\label{sec-perms}

\index{ficheros!permisos de|(}
\index{permisos!de fichero|(}
\subsection{Conceptos de permisos de fichero}

\index{ficheros!permisos!definición}
\index{permisos!definición}
\index{ficheros!propiedad del usuario}
Como normalmente hay más de un usuario en un sistema {\linux}, éste
proporciona un mecanismo conocido como {\bf permisos de fichero}, 
que protege los ficheros de los usuarios de las intromisiones de otros
usuarios.  Este mecanismo permite que los ficheros y directorios "sean 
propiedad" de un usuario en concreto. Por ejemplo, como Larry creó los
ficheros en su directorio de usuario, Larry es el dueño de esos 
ficheros y tiene acceso a ellos.

{\linux} también permite que los ficheros sean compartidos por usuarios y 
grupos de usuarios. Si Larry quisiera, podría denegar el acceso a sus ficheros
de forma que ningún otro usuario tuviera acceso a ellos. Sin embargo, en la
mayoría de sistemas está predefinido el permitir a otros usuarios la lectura de sus 
ficheros, pero nunca modificarlos o borrarlos.

\index{ficheros!propiedad del grupo}
Todo fichero es propiedad de un usuario particular. Sin embargo, los
ficheros también son propiedad de un {\bf grupo}, que es un grupo definido
de usuarios del sistema. Cada usuario se coloca en, al menos, un grupo al 
crearse su cuenta de usuario. Sin embargo, el administrador del sistema 
puede conceder al usuario el acceso a más de un grupo.

\index{usuarios!en grupos}
\index{grupos}
Los grupos se definen normalmente por el tipo de usuarios que accede a la
máquina. Por ejemplo, en un sistema {\linux} universitario los usuarios pueden
ser situados en los grupos {\tt student}, {\tt staff}, {\tt faculty} o {\tt
guest}. También hay unos pocos grupos definidos por el sistema (como {\tt bin} 
y {\tt admin}) usados por el propio sistema para controlar el acceso a 
los recursos --- es muy raro que usuarios de verdad pertenezcan a estos grupos
de sistemas.

Hay tres clases principales de permisos: de lectura, escritura y ejecución.
Estos permisos pueden ser concedidos a tres tipos de usuarios: al propietario 
del fichero, al grupo al que pertenece el fichero y a todos los usuarios, 
independientemente del grupo.

\index{permisos!lectura}
\index{ficheros!permisos!lectura}
\index{directorio!permisos!lectura}
\index{permisos!escritura}
\index{ficheros!permisos!escritura}
\index{directorio!permisos!escritura}
\index{permisos!ejecución}
\index{ficheros!permisos!ejecución}
\index{directorio!permisos!ejecución}
Los permisos de lectura permiten a un usuario leer el contenido de un
fichero, o, en el caso de un directorio, listar su contenido (usando 
{\tt ls}). Los permisos de escritura permiten a los usuarios escribir 
y modificar un fichero. Para directorios, los permisos de escritura 
permiten al usuario crear nuevos ficheros o borrar ficheros dentro de
ese directorio. Finalmente, los permisos de ejecución permiten al usuario
ejecutar el fichero como un programa o guión de intérprete de órdenes (si el fichero es
un programa o un guión del intérprete de órdenes). En cuanto a los directorios, tener 
permisos de ejecución permite al usuario hacer un {\tt cd} al directorio
en cuestión.


\subsection{Interpretando los permisos de fichero}
\index{permisos!interpretación}
\index{ficheros!permisos!interpretación}
\index{ficheros!listado de permisos con ls@listando permisos con {\tt ls}}
\index{ls@{\tt ls}!listado permisos de fichero con}
Veamos un ejemplo de demostración de los permisos de fichero. Usando 
la orden {\tt ls} con la opción {\tt -l} se muestra un listado de ficheros 
en formato largo, incluyendo los permisos de los ficheros.
\begin{tscreen}
/home/larry/foo\# ls -l stuff
\begin{verbatim}
-rw-r--r--   1 larry    users         505 Mar 13 19:05 stuff
\end{verbatim}
/home/larry/foo\#
\end{tscreen}

El primer campo en el listado representa los permisos del fichero. El 
tercer campo es el propietario del fichero ({\tt larry}) y el cuarto
campo es el grupo al que pertenece el fichero ({\tt users}). Obviamente, 
el último campo es el nombre del fichero ({\tt stuff}). Explicaremos los 
demás campos después.

El propietario de este fichero es {\tt larry}, y pertenece al grupo 
{\tt users}. La cadena {\tt -rw-r--r--} lista, en orden, los permisos 
concedidos al propietario del fichero, al grupo al que pertenece el fichero
y a todos los demás.

El primer carácter de la cadena de permisos (``{\tt -}'') representa el tipo
de fichero. Un ``{\tt -}''  significa que es un fichero normal (a diferencia 
de un directorio o un controlador de dispositivo). Los tres caracteres 
siguientes (``{\tt rw-}'') representan  los permisos concedidos al dueño del
fichero, {\tt larry}. La ``{\tt r}'' viene de  ``read'' (lectura) y la ``{\tt w}''
viene de ``escritura'' (escritura). Así, {\tt larry} tiene permisos de lectura y 
escritura al fichero {\tt stuff}. 

Como ya se ha dicho, además de los permisos de lectura y escritura, hay también 
un permiso de ejecución, representado por una ``{\tt x}''. Sin embargo, 
un ``{\tt -}'' es listado aquí en el lugar de una ``{\tt x}'', así que Larry no
tiene permiso de ejecución de este fichero. Esto está bien, ya que el fichero
{\tt stuff} no es un programa de ningún tipo. Naturalmente, como Larry es el 
propietario del fichero, se puede conceder a sí mismo el permiso de ejecución 
si así lo desea.
(Esto será descrito en breve)

Los tres caracteres siguientes,(``{\tt r--}''), representan los permisos del 
grupo sobre el fichero. El grupo al que pertenece este fichero es {\tt users}. 
Como sólo aparece una `{\tt r}'' aquí, cualquier usuario que pertenezca al grupo
{\tt users} podrá leer este fichero.

Los tres últimos caracteres, también (``{\tt r--}''), representan los permisos
concedidos al resto de usuarios en el sistema (otros que no sean el propietario 
del fichero ni los del grupo {\tt users}). De nuevo, como sólo está presente la
``{\tt r}'', los otros usuarios podrán leer el fichero, pero no escribir en él 
o ejecutarlo.

Aquí hay algunos otros ejemplos de permisos:
\begin{dispitems}
\ditem{{\tt -rwxr-xr-x}}
El propietario del fichero puede leer, escribir, y ejecutar el fichero. Los 
usuarios del grupo del fichero, y todos los demás usuarios, pueden leer y 
ejecutar el fichero.

\ditem{{\tt -rw-------}}
El dueño del fichero puede leer y escribir en el fichero. Ningún otro usuario 
puede acceder a este fichero.

\ditem{{\tt -rwxrwxrwx}}
Todos los usuarios pueden leer, escribir y ejecutar el fichero.
\end{dispitems}

\subsection{Dependencias}
\index{permisos!dependencias de}
\index{ficheros!permisos!dependencias de}
\index{directorio!permisos!dependencias de}
Los permisos concedidos a un fichero dependen también de los permisos del 
directorio en el que esté localizado el fichero. Por ejemplo, aunque un
fichero esté fijado a {\tt -rwxrwxrwx}, otros usuarios no podrán acceder al
fichero si no tienen acceso de lectura y de ejecución al directorio en el que
se encuentra el fichero. Por ejemplo si Larry quisiera restringir el acceso 
a todos sus ficheros, podría fijar los permisos de su directorio principal 
de usuario {\tt /home/larry} a {\tt -rwx------}. De esta forma, ningún otro
usuario tendrá acceso a su directorio, ni a todos los ficheros y directorios 
dentro de él. Larry no tiene que preocuparse de los permisos individuales de 
cada fichero.

En otras palabras, para que todos pueden acceder a un fichero, se debe 
tener acceso en ejecución para todos los directorios a lo largo del camino 
del fichero, y acceso en lectura (o en ejecución) para el propio fichero.

Normalmente, los usuarios de un sistema {\linux} son muy abiertos con sus
ficheros. Los permisos típicos que se le dan a los ficheros son 
{\tt -rw-r--r--}, que permiten a otros usuarios leer el fichero pero nunca
cambiarlo. A los directorios se les suele dar los permisos 
{\tt -rwxr-xr-x}, que permiten a otros usuarios mirar por tus directorios, 
pero no crear o borrar ficheros dentro de ellos.

Sin embargo, muchos usuarios desean mantener a los demás lejos de sus ficheros.
Si se establecen los permisos de un fichero a {\tt -rw-------} se conseguirá 
que cualquier otro usuario no puede acceder al fichero. De la misma forma, al 
fijarse los permisos de un directorio como {\tt -rwx------} se mantiene a 
otros usuario fuera del directorio en cuestión.


\subsection{Cambio de permisos}
\index{permisos!cambiando}
\index{ficheros!permisos!cambiando}
\index{directorio!permisos!cambiando}
\index{chmod@{\tt chmod}}
La instrucción {\tt chmod} se usa para establecer los permisos de un fichero. Sólo 
el propietario de un fichero puede cambiar los permisos de ese fichero.
La sintaxis de {\tt chmod} es
\begin{tscreen}
chmod \{a,u,g,o\}\{+,-\}\{r,w,x\} \cparam{nombre\_fichero}
\end{tscreen}

Brevemente, puede poner uno o más de estos: {\bf a}ll (todos), {\bf u}ser 
(usuario), {\bf g}roup (grupo), u {\bf o}ther (otros).Después especifica 
si estás añadiendo derechos ({\tt +}) o quitándolos ({\tt -}). Finalmente,
especifica uno o más de estos: {\bf r}ead (lectura), {\bf w}rite (escritura), 
y e{\bf x}ecute (ejecución). Algunos ejemplos de instrucciones correctas son:

\begin{dispitems}
\ditem{{\tt chmod a+r stuff}}
Da a todos los usuarios permiso de lectura al fichero.
\ditem{{\tt chmod +r stuff}}
Lo mismo que arriba---si ninguno de {\tt a}, {\tt u}, {\tt g}, o {\tt o} se
especifica, se toma {\tt a} como predeterminado.
\ditem{{\tt chmod og-x stuff}}
Quita el permiso de ejecución de todos los usuarios menos del propietario.
\ditem{{\tt chmod u+rwx stuff}}
Permite al propietario, leer, escribir y ejecutar el fichero.
\ditem{{\tt chmod o-rwx stuff}}
Quita los permisos de lectura, escritura y ejecución de los usuarios que no
son el dueño ni los usuarios del grupo del fichero.
\end{dispitems}

\index{ficheros!permisos de|)}
\index{permisos!de ficheros|)}
